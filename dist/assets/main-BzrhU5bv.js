var Gi=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports);var zi=Gi((exports,module)=>{(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))e(c);new MutationObserver(c=>{for(const a of c)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function s(c){const a={};return c.integrity&&(a.integrity=c.integrity),c.referrerPolicy&&(a.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?a.credentials="include":c.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(c){if(c.ep)return;c.ep=!0;const a=s(c);fetch(c.href,a)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var jquery={exports:{}};/*!
 * jQuery JavaScript Library v3.7.1
 * https://jquery.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-08-28T13:37Z
 */(function(t){(function(n,s){t.exports=n.document?s(n,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return s(e)}})(typeof window<"u"?window:commonjsGlobal,function(n,s){var e=[],c=Object.getPrototypeOf,a=e.slice,i=e.flat?function(f){return e.flat.call(f)}:function(f){return e.concat.apply([],f)},o=e.push,l=e.indexOf,r={},d=r.toString,h=r.hasOwnProperty,v=h.toString,p=v.call(Object),m={},A=function(k){return typeof k=="function"&&typeof k.nodeType!="number"&&typeof k.item!="function"},y=function(k){return k!=null&&k===k.window},x=n.document,P={type:!0,src:!0,nonce:!0,noModule:!0};function L(f,k,O){O=O||x;var j,te,ne=O.createElement("script");if(ne.text=f,k)for(j in P)te=k[j]||k.getAttribute&&k.getAttribute(j),te&&ne.setAttribute(j,te);O.head.appendChild(ne).parentNode.removeChild(ne)}function T(f){return f==null?f+"":typeof f=="object"||typeof f=="function"?r[d.call(f)]||"object":typeof f}var g="3.7.1",_=/HTML$/i,u=function(f,k){return new u.fn.init(f,k)};u.fn=u.prototype={jquery:g,constructor:u,length:0,toArray:function(){return a.call(this)},get:function(f){return f==null?a.call(this):f<0?this[f+this.length]:this[f]},pushStack:function(f){var k=u.merge(this.constructor(),f);return k.prevObject=this,k},each:function(f){return u.each(this,f)},map:function(f){return this.pushStack(u.map(this,function(k,O){return f.call(k,O,k)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(u.grep(this,function(f,k){return(k+1)%2}))},odd:function(){return this.pushStack(u.grep(this,function(f,k){return k%2}))},eq:function(f){var k=this.length,O=+f+(f<0?k:0);return this.pushStack(O>=0&&O<k?[this[O]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:e.sort,splice:e.splice},u.extend=u.fn.extend=function(){var f,k,O,j,te,ne,le=arguments[0]||{},Ee=1,ye=arguments.length,ke=!1;for(typeof le=="boolean"&&(ke=le,le=arguments[Ee]||{},Ee++),typeof le!="object"&&!A(le)&&(le={}),Ee===ye&&(le=this,Ee--);Ee<ye;Ee++)if((f=arguments[Ee])!=null)for(k in f)j=f[k],!(k==="__proto__"||le===j)&&(ke&&j&&(u.isPlainObject(j)||(te=Array.isArray(j)))?(O=le[k],te&&!Array.isArray(O)?ne=[]:!te&&!u.isPlainObject(O)?ne={}:ne=O,te=!1,le[k]=u.extend(ke,ne,j)):j!==void 0&&(le[k]=j));return le},u.extend({expando:"jQuery"+(g+Math.random()).replace(/\D/g,""),isReady:!0,error:function(f){throw new Error(f)},noop:function(){},isPlainObject:function(f){var k,O;return!f||d.call(f)!=="[object Object]"?!1:(k=c(f),k?(O=h.call(k,"constructor")&&k.constructor,typeof O=="function"&&v.call(O)===p):!0)},isEmptyObject:function(f){var k;for(k in f)return!1;return!0},globalEval:function(f,k,O){L(f,{nonce:k&&k.nonce},O)},each:function(f,k){var O,j=0;if(b(f))for(O=f.length;j<O&&k.call(f[j],j,f[j])!==!1;j++);else for(j in f)if(k.call(f[j],j,f[j])===!1)break;return f},text:function(f){var k,O="",j=0,te=f.nodeType;if(!te)for(;k=f[j++];)O+=u.text(k);return te===1||te===11?f.textContent:te===9?f.documentElement.textContent:te===3||te===4?f.nodeValue:O},makeArray:function(f,k){var O=k||[];return f!=null&&(b(Object(f))?u.merge(O,typeof f=="string"?[f]:f):o.call(O,f)),O},inArray:function(f,k,O){return k==null?-1:l.call(k,f,O)},isXMLDoc:function(f){var k=f&&f.namespaceURI,O=f&&(f.ownerDocument||f).documentElement;return!_.test(k||O&&O.nodeName||"HTML")},merge:function(f,k){for(var O=+k.length,j=0,te=f.length;j<O;j++)f[te++]=k[j];return f.length=te,f},grep:function(f,k,O){for(var j,te=[],ne=0,le=f.length,Ee=!O;ne<le;ne++)j=!k(f[ne],ne),j!==Ee&&te.push(f[ne]);return te},map:function(f,k,O){var j,te,ne=0,le=[];if(b(f))for(j=f.length;ne<j;ne++)te=k(f[ne],ne,O),te!=null&&le.push(te);else for(ne in f)te=k(f[ne],ne,O),te!=null&&le.push(te);return i(le)},guid:1,support:m}),typeof Symbol=="function"&&(u.fn[Symbol.iterator]=e[Symbol.iterator]),u.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(f,k){r["[object "+k+"]"]=k.toLowerCase()});function b(f){var k=!!f&&"length"in f&&f.length,O=T(f);return A(f)||y(f)?!1:O==="array"||k===0||typeof k=="number"&&k>0&&k-1 in f}function S(f,k){return f.nodeName&&f.nodeName.toLowerCase()===k.toLowerCase()}var M=e.pop,R=e.sort,C=e.splice,D="[\\x20\\t\\r\\n\\f]",B=new RegExp("^"+D+"+|((?:^|[^\\\\])(?:\\\\.)*)"+D+"+$","g");u.contains=function(f,k){var O=k&&k.parentNode;return f===O||!!(O&&O.nodeType===1&&(f.contains?f.contains(O):f.compareDocumentPosition&&f.compareDocumentPosition(O)&16))};var Z=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function J(f,k){return k?f==="\0"?"ï¿½":f.slice(0,-1)+"\\"+f.charCodeAt(f.length-1).toString(16)+" ":"\\"+f}u.escapeSelector=function(f){return(f+"").replace(Z,J)};var q=x,z=o;(function(){var f,k,O,j,te,ne=z,le,Ee,ye,ke,Ne,Oe=u.expando,Pe=0,ze=0,at=hn(),ht=hn(),ot=hn(),wt=hn(),yt=function(me,Te){return me===Te&&(te=!0),0},Lt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",It="(?:\\\\[\\da-fA-F]{1,6}"+D+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",dt="\\["+D+"*("+It+")(?:"+D+"*([*^$|!~]?=)"+D+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+It+"))|)"+D+"*\\]",Vt=":("+It+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+dt+")*)|.*)\\)|)",ft=new RegExp(D+"+","g"),bt=new RegExp("^"+D+"*,"+D+"*"),an=new RegExp("^"+D+"*([>+~]|"+D+")"+D+"*"),kn=new RegExp(D+"|>"),Nt=new RegExp(Vt),sn=new RegExp("^"+It+"$"),Dt={ID:new RegExp("^#("+It+")"),CLASS:new RegExp("^\\.("+It+")"),TAG:new RegExp("^("+It+"|[*])"),ATTR:new RegExp("^"+dt),PSEUDO:new RegExp("^"+Vt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+D+"*(even|odd|(([+-]|)(\\d*)n|)"+D+"*(?:([+-]|)"+D+"*(\\d+)|))"+D+"*\\)|)","i"),bool:new RegExp("^(?:"+Lt+")$","i"),needsContext:new RegExp("^"+D+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+D+"*((?:-\\d)?\\d*)"+D+"*\\)|)(?=[^-]|$)","i")},zt=/^(?:input|select|textarea|button)$/i,jt=/^h\d$/i,Tt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Mn=/[+~]/,Ut=new RegExp("\\\\[\\da-fA-F]{1,6}"+D+"?|\\\\([^\\r\\n\\f])","g"),Bt=function(me,Te){var Me="0x"+me.slice(1)-65536;return Te||(Me<0?String.fromCharCode(Me+65536):String.fromCharCode(Me>>10|55296,Me&1023|56320))},Ii=function(){Ht()},Ni=pn(function(me){return me.disabled===!0&&S(me,"fieldset")},{dir:"parentNode",next:"legend"});function Di(){try{return le.activeElement}catch{}}try{ne.apply(e=a.call(q.childNodes),q.childNodes),e[q.childNodes.length].nodeType}catch{ne={apply:function(Te,Me){z.apply(Te,a.call(Me))},call:function(Te){z.apply(Te,a.call(arguments,1))}}}function gt(me,Te,Me,Le){var Fe,We,Je,tt,Ze,ct,rt,st=Te&&Te.ownerDocument,ut=Te?Te.nodeType:9;if(Me=Me||[],typeof me!="string"||!me||ut!==1&&ut!==9&&ut!==11)return Me;if(!Le&&(Ht(Te),Te=Te||le,ye)){if(ut!==11&&(Ze=Tt.exec(me)))if(Fe=Ze[1]){if(ut===9)if(Je=Te.getElementById(Fe)){if(Je.id===Fe)return ne.call(Me,Je),Me}else return Me;else if(st&&(Je=st.getElementById(Fe))&&gt.contains(Te,Je)&&Je.id===Fe)return ne.call(Me,Je),Me}else{if(Ze[2])return ne.apply(Me,Te.getElementsByTagName(me)),Me;if((Fe=Ze[3])&&Te.getElementsByClassName)return ne.apply(Me,Te.getElementsByClassName(Fe)),Me}if(!wt[me+" "]&&(!ke||!ke.test(me))){if(rt=me,st=Te,ut===1&&(kn.test(me)||an.test(me))){for(st=Mn.test(me)&&Pn(Te.parentNode)||Te,(st!=Te||!m.scope)&&((tt=Te.getAttribute("id"))?tt=u.escapeSelector(tt):Te.setAttribute("id",tt=Oe)),ct=on(me),We=ct.length;We--;)ct[We]=(tt?"#"+tt:":scope")+" "+fn(ct[We]);rt=ct.join(",")}try{return ne.apply(Me,st.querySelectorAll(rt)),Me}catch{wt(me,!0)}finally{tt===Oe&&Te.removeAttribute("id")}}}return ai(me.replace(B,"$1"),Te,Me,Le)}function hn(){var me=[];function Te(Me,Le){return me.push(Me+" ")>k.cacheLength&&delete Te[me.shift()],Te[Me+" "]=Le}return Te}function $t(me){return me[Oe]=!0,me}function Jt(me){var Te=le.createElement("fieldset");try{return!!me(Te)}catch{return!1}finally{Te.parentNode&&Te.parentNode.removeChild(Te),Te=null}}function Fi(me){return function(Te){return S(Te,"input")&&Te.type===me}}function Oi(me){return function(Te){return(S(Te,"input")||S(Te,"button"))&&Te.type===me}}function ii(me){return function(Te){return"form"in Te?Te.parentNode&&Te.disabled===!1?"label"in Te?"label"in Te.parentNode?Te.parentNode.disabled===me:Te.disabled===me:Te.isDisabled===me||Te.isDisabled!==!me&&Ni(Te)===me:Te.disabled===me:"label"in Te?Te.disabled===me:!1}}function Kt(me){return $t(function(Te){return Te=+Te,$t(function(Me,Le){for(var Fe,We=me([],Me.length,Te),Je=We.length;Je--;)Me[Fe=We[Je]]&&(Me[Fe]=!(Le[Fe]=Me[Fe]))})})}function Pn(me){return me&&typeof me.getElementsByTagName<"u"&&me}function Ht(me){var Te,Me=me?me.ownerDocument||me:q;return Me==le||Me.nodeType!==9||!Me.documentElement||(le=Me,Ee=le.documentElement,ye=!u.isXMLDoc(le),Ne=Ee.matches||Ee.webkitMatchesSelector||Ee.msMatchesSelector,Ee.msMatchesSelector&&q!=le&&(Te=le.defaultView)&&Te.top!==Te&&Te.addEventListener("unload",Ii),m.getById=Jt(function(Le){return Ee.appendChild(Le).id=u.expando,!le.getElementsByName||!le.getElementsByName(u.expando).length}),m.disconnectedMatch=Jt(function(Le){return Ne.call(Le,"*")}),m.scope=Jt(function(){return le.querySelectorAll(":scope")}),m.cssHas=Jt(function(){try{return le.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),m.getById?(k.filter.ID=function(Le){var Fe=Le.replace(Ut,Bt);return function(We){return We.getAttribute("id")===Fe}},k.find.ID=function(Le,Fe){if(typeof Fe.getElementById<"u"&&ye){var We=Fe.getElementById(Le);return We?[We]:[]}}):(k.filter.ID=function(Le){var Fe=Le.replace(Ut,Bt);return function(We){var Je=typeof We.getAttributeNode<"u"&&We.getAttributeNode("id");return Je&&Je.value===Fe}},k.find.ID=function(Le,Fe){if(typeof Fe.getElementById<"u"&&ye){var We,Je,tt,Ze=Fe.getElementById(Le);if(Ze){if(We=Ze.getAttributeNode("id"),We&&We.value===Le)return[Ze];for(tt=Fe.getElementsByName(Le),Je=0;Ze=tt[Je++];)if(We=Ze.getAttributeNode("id"),We&&We.value===Le)return[Ze]}return[]}}),k.find.TAG=function(Le,Fe){return typeof Fe.getElementsByTagName<"u"?Fe.getElementsByTagName(Le):Fe.querySelectorAll(Le)},k.find.CLASS=function(Le,Fe){if(typeof Fe.getElementsByClassName<"u"&&ye)return Fe.getElementsByClassName(Le)},ke=[],Jt(function(Le){var Fe;Ee.appendChild(Le).innerHTML="<a id='"+Oe+"' href='' disabled='disabled'></a><select id='"+Oe+"-\r\\' disabled='disabled'><option selected=''></option></select>",Le.querySelectorAll("[selected]").length||ke.push("\\["+D+"*(?:value|"+Lt+")"),Le.querySelectorAll("[id~="+Oe+"-]").length||ke.push("~="),Le.querySelectorAll("a#"+Oe+"+*").length||ke.push(".#.+[+~]"),Le.querySelectorAll(":checked").length||ke.push(":checked"),Fe=le.createElement("input"),Fe.setAttribute("type","hidden"),Le.appendChild(Fe).setAttribute("name","D"),Ee.appendChild(Le).disabled=!0,Le.querySelectorAll(":disabled").length!==2&&ke.push(":enabled",":disabled"),Fe=le.createElement("input"),Fe.setAttribute("name",""),Le.appendChild(Fe),Le.querySelectorAll("[name='']").length||ke.push("\\["+D+"*name"+D+"*="+D+`*(?:''|"")`)}),m.cssHas||ke.push(":has"),ke=ke.length&&new RegExp(ke.join("|")),yt=function(Le,Fe){if(Le===Fe)return te=!0,0;var We=!Le.compareDocumentPosition-!Fe.compareDocumentPosition;return We||(We=(Le.ownerDocument||Le)==(Fe.ownerDocument||Fe)?Le.compareDocumentPosition(Fe):1,We&1||!m.sortDetached&&Fe.compareDocumentPosition(Le)===We?Le===le||Le.ownerDocument==q&&gt.contains(q,Le)?-1:Fe===le||Fe.ownerDocument==q&&gt.contains(q,Fe)?1:j?l.call(j,Le)-l.call(j,Fe):0:We&4?-1:1)}),le}gt.matches=function(me,Te){return gt(me,null,null,Te)},gt.matchesSelector=function(me,Te){if(Ht(me),ye&&!wt[Te+" "]&&(!ke||!ke.test(Te)))try{var Me=Ne.call(me,Te);if(Me||m.disconnectedMatch||me.document&&me.document.nodeType!==11)return Me}catch{wt(Te,!0)}return gt(Te,le,null,[me]).length>0},gt.contains=function(me,Te){return(me.ownerDocument||me)!=le&&Ht(me),u.contains(me,Te)},gt.attr=function(me,Te){(me.ownerDocument||me)!=le&&Ht(me);var Me=k.attrHandle[Te.toLowerCase()],Le=Me&&h.call(k.attrHandle,Te.toLowerCase())?Me(me,Te,!ye):void 0;return Le!==void 0?Le:me.getAttribute(Te)},gt.error=function(me){throw new Error("Syntax error, unrecognized expression: "+me)},u.uniqueSort=function(me){var Te,Me=[],Le=0,Fe=0;if(te=!m.sortStable,j=!m.sortStable&&a.call(me,0),R.call(me,yt),te){for(;Te=me[Fe++];)Te===me[Fe]&&(Le=Me.push(Fe));for(;Le--;)C.call(me,Me[Le],1)}return j=null,me},u.fn.uniqueSort=function(){return this.pushStack(u.uniqueSort(a.apply(this)))},k=u.expr={cacheLength:50,createPseudo:$t,match:Dt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(me){return me[1]=me[1].replace(Ut,Bt),me[3]=(me[3]||me[4]||me[5]||"").replace(Ut,Bt),me[2]==="~="&&(me[3]=" "+me[3]+" "),me.slice(0,4)},CHILD:function(me){return me[1]=me[1].toLowerCase(),me[1].slice(0,3)==="nth"?(me[3]||gt.error(me[0]),me[4]=+(me[4]?me[5]+(me[6]||1):2*(me[3]==="even"||me[3]==="odd")),me[5]=+(me[7]+me[8]||me[3]==="odd")):me[3]&&gt.error(me[0]),me},PSEUDO:function(me){var Te,Me=!me[6]&&me[2];return Dt.CHILD.test(me[0])?null:(me[3]?me[2]=me[4]||me[5]||"":Me&&Nt.test(Me)&&(Te=on(Me,!0))&&(Te=Me.indexOf(")",Me.length-Te)-Me.length)&&(me[0]=me[0].slice(0,Te),me[2]=Me.slice(0,Te)),me.slice(0,3))}},filter:{TAG:function(me){var Te=me.replace(Ut,Bt).toLowerCase();return me==="*"?function(){return!0}:function(Me){return S(Me,Te)}},CLASS:function(me){var Te=at[me+" "];return Te||(Te=new RegExp("(^|"+D+")"+me+"("+D+"|$)"))&&at(me,function(Me){return Te.test(typeof Me.className=="string"&&Me.className||typeof Me.getAttribute<"u"&&Me.getAttribute("class")||"")})},ATTR:function(me,Te,Me){return function(Le){var Fe=gt.attr(Le,me);return Fe==null?Te==="!=":Te?(Fe+="",Te==="="?Fe===Me:Te==="!="?Fe!==Me:Te==="^="?Me&&Fe.indexOf(Me)===0:Te==="*="?Me&&Fe.indexOf(Me)>-1:Te==="$="?Me&&Fe.slice(-Me.length)===Me:Te==="~="?(" "+Fe.replace(ft," ")+" ").indexOf(Me)>-1:Te==="|="?Fe===Me||Fe.slice(0,Me.length+1)===Me+"-":!1):!0}},CHILD:function(me,Te,Me,Le,Fe){var We=me.slice(0,3)!=="nth",Je=me.slice(-4)!=="last",tt=Te==="of-type";return Le===1&&Fe===0?function(Ze){return!!Ze.parentNode}:function(Ze,ct,rt){var st,ut,it,mt,St,xt=We!==Je?"nextSibling":"previousSibling",kt=Ze.parentNode,Ft=tt&&Ze.nodeName.toLowerCase(),Zt=!rt&&!tt,Et=!1;if(kt){if(We){for(;xt;){for(it=Ze;it=it[xt];)if(tt?S(it,Ft):it.nodeType===1)return!1;St=xt=me==="only"&&!St&&"nextSibling"}return!0}if(St=[Je?kt.firstChild:kt.lastChild],Je&&Zt){for(ut=kt[Oe]||(kt[Oe]={}),st=ut[me]||[],mt=st[0]===Pe&&st[1],Et=mt&&st[2],it=mt&&kt.childNodes[mt];it=++mt&&it&&it[xt]||(Et=mt=0)||St.pop();)if(it.nodeType===1&&++Et&&it===Ze){ut[me]=[Pe,mt,Et];break}}else if(Zt&&(ut=Ze[Oe]||(Ze[Oe]={}),st=ut[me]||[],mt=st[0]===Pe&&st[1],Et=mt),Et===!1)for(;(it=++mt&&it&&it[xt]||(Et=mt=0)||St.pop())&&!((tt?S(it,Ft):it.nodeType===1)&&++Et&&(Zt&&(ut=it[Oe]||(it[Oe]={}),ut[me]=[Pe,Et]),it===Ze)););return Et-=Fe,Et===Le||Et%Le===0&&Et/Le>=0}}},PSEUDO:function(me,Te){var Me,Le=k.pseudos[me]||k.setFilters[me.toLowerCase()]||gt.error("unsupported pseudo: "+me);return Le[Oe]?Le(Te):Le.length>1?(Me=[me,me,"",Te],k.setFilters.hasOwnProperty(me.toLowerCase())?$t(function(Fe,We){for(var Je,tt=Le(Fe,Te),Ze=tt.length;Ze--;)Je=l.call(Fe,tt[Ze]),Fe[Je]=!(We[Je]=tt[Ze])}):function(Fe){return Le(Fe,0,Me)}):Le}},pseudos:{not:$t(function(me){var Te=[],Me=[],Le=In(me.replace(B,"$1"));return Le[Oe]?$t(function(Fe,We,Je,tt){for(var Ze,ct=Le(Fe,null,tt,[]),rt=Fe.length;rt--;)(Ze=ct[rt])&&(Fe[rt]=!(We[rt]=Ze))}):function(Fe,We,Je){return Te[0]=Fe,Le(Te,null,Je,Me),Te[0]=null,!Me.pop()}}),has:$t(function(me){return function(Te){return gt(me,Te).length>0}}),contains:$t(function(me){return me=me.replace(Ut,Bt),function(Te){return(Te.textContent||u.text(Te)).indexOf(me)>-1}}),lang:$t(function(me){return sn.test(me||"")||gt.error("unsupported lang: "+me),me=me.replace(Ut,Bt).toLowerCase(),function(Te){var Me;do if(Me=ye?Te.lang:Te.getAttribute("xml:lang")||Te.getAttribute("lang"))return Me=Me.toLowerCase(),Me===me||Me.indexOf(me+"-")===0;while((Te=Te.parentNode)&&Te.nodeType===1);return!1}}),target:function(me){var Te=n.location&&n.location.hash;return Te&&Te.slice(1)===me.id},root:function(me){return me===Ee},focus:function(me){return me===Di()&&le.hasFocus()&&!!(me.type||me.href||~me.tabIndex)},enabled:ii(!1),disabled:ii(!0),checked:function(me){return S(me,"input")&&!!me.checked||S(me,"option")&&!!me.selected},selected:function(me){return me.parentNode&&me.parentNode.selectedIndex,me.selected===!0},empty:function(me){for(me=me.firstChild;me;me=me.nextSibling)if(me.nodeType<6)return!1;return!0},parent:function(me){return!k.pseudos.empty(me)},header:function(me){return jt.test(me.nodeName)},input:function(me){return zt.test(me.nodeName)},button:function(me){return S(me,"input")&&me.type==="button"||S(me,"button")},text:function(me){var Te;return S(me,"input")&&me.type==="text"&&((Te=me.getAttribute("type"))==null||Te.toLowerCase()==="text")},first:Kt(function(){return[0]}),last:Kt(function(me,Te){return[Te-1]}),eq:Kt(function(me,Te,Me){return[Me<0?Me+Te:Me]}),even:Kt(function(me,Te){for(var Me=0;Me<Te;Me+=2)me.push(Me);return me}),odd:Kt(function(me,Te){for(var Me=1;Me<Te;Me+=2)me.push(Me);return me}),lt:Kt(function(me,Te,Me){var Le;for(Me<0?Le=Me+Te:Me>Te?Le=Te:Le=Me;--Le>=0;)me.push(Le);return me}),gt:Kt(function(me,Te,Me){for(var Le=Me<0?Me+Te:Me;++Le<Te;)me.push(Le);return me})}},k.pseudos.nth=k.pseudos.eq;for(f in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})k.pseudos[f]=Fi(f);for(f in{submit:!0,reset:!0})k.pseudos[f]=Oi(f);function ri(){}ri.prototype=k.filters=k.pseudos,k.setFilters=new ri;function on(me,Te){var Me,Le,Fe,We,Je,tt,Ze,ct=ht[me+" "];if(ct)return Te?0:ct.slice(0);for(Je=me,tt=[],Ze=k.preFilter;Je;){(!Me||(Le=bt.exec(Je)))&&(Le&&(Je=Je.slice(Le[0].length)||Je),tt.push(Fe=[])),Me=!1,(Le=an.exec(Je))&&(Me=Le.shift(),Fe.push({value:Me,type:Le[0].replace(B," ")}),Je=Je.slice(Me.length));for(We in k.filter)(Le=Dt[We].exec(Je))&&(!Ze[We]||(Le=Ze[We](Le)))&&(Me=Le.shift(),Fe.push({value:Me,type:We,matches:Le}),Je=Je.slice(Me.length));if(!Me)break}return Te?Je.length:Je?gt.error(me):ht(me,tt).slice(0)}function fn(me){for(var Te=0,Me=me.length,Le="";Te<Me;Te++)Le+=me[Te].value;return Le}function pn(me,Te,Me){var Le=Te.dir,Fe=Te.next,We=Fe||Le,Je=Me&&We==="parentNode",tt=ze++;return Te.first?function(Ze,ct,rt){for(;Ze=Ze[Le];)if(Ze.nodeType===1||Je)return me(Ze,ct,rt);return!1}:function(Ze,ct,rt){var st,ut,it=[Pe,tt];if(rt){for(;Ze=Ze[Le];)if((Ze.nodeType===1||Je)&&me(Ze,ct,rt))return!0}else for(;Ze=Ze[Le];)if(Ze.nodeType===1||Je)if(ut=Ze[Oe]||(Ze[Oe]={}),Fe&&S(Ze,Fe))Ze=Ze[Le]||Ze;else{if((st=ut[We])&&st[0]===Pe&&st[1]===tt)return it[2]=st[2];if(ut[We]=it,it[2]=me(Ze,ct,rt))return!0}return!1}}function $n(me){return me.length>1?function(Te,Me,Le){for(var Fe=me.length;Fe--;)if(!me[Fe](Te,Me,Le))return!1;return!0}:me[0]}function Ui(me,Te,Me){for(var Le=0,Fe=Te.length;Le<Fe;Le++)gt(me,Te[Le],Me);return Me}function gn(me,Te,Me,Le,Fe){for(var We,Je=[],tt=0,Ze=me.length,ct=Te!=null;tt<Ze;tt++)(We=me[tt])&&(!Me||Me(We,Le,Fe))&&(Je.push(We),ct&&Te.push(tt));return Je}function Rn(me,Te,Me,Le,Fe,We){return Le&&!Le[Oe]&&(Le=Rn(Le)),Fe&&!Fe[Oe]&&(Fe=Rn(Fe,We)),$t(function(Je,tt,Ze,ct){var rt,st,ut,it,mt=[],St=[],xt=tt.length,kt=Je||Ui(Te||"*",Ze.nodeType?[Ze]:Ze,[]),Ft=me&&(Je||!Te)?gn(kt,mt,me,Ze,ct):kt;if(Me?(it=Fe||(Je?me:xt||Le)?[]:tt,Me(Ft,it,Ze,ct)):it=Ft,Le)for(rt=gn(it,St),Le(rt,[],Ze,ct),st=rt.length;st--;)(ut=rt[st])&&(it[St[st]]=!(Ft[St[st]]=ut));if(Je){if(Fe||me){if(Fe){for(rt=[],st=it.length;st--;)(ut=it[st])&&rt.push(Ft[st]=ut);Fe(null,it=[],rt,ct)}for(st=it.length;st--;)(ut=it[st])&&(rt=Fe?l.call(Je,ut):mt[st])>-1&&(Je[rt]=!(tt[rt]=ut))}}else it=gn(it===tt?it.splice(xt,it.length):it),Fe?Fe(null,tt,it,ct):ne.apply(tt,it)})}function Ln(me){for(var Te,Me,Le,Fe=me.length,We=k.relative[me[0].type],Je=We||k.relative[" "],tt=We?1:0,Ze=pn(function(st){return st===Te},Je,!0),ct=pn(function(st){return l.call(Te,st)>-1},Je,!0),rt=[function(st,ut,it){var mt=!We&&(it||ut!=O)||((Te=ut).nodeType?Ze(st,ut,it):ct(st,ut,it));return Te=null,mt}];tt<Fe;tt++)if(Me=k.relative[me[tt].type])rt=[pn($n(rt),Me)];else{if(Me=k.filter[me[tt].type].apply(null,me[tt].matches),Me[Oe]){for(Le=++tt;Le<Fe&&!k.relative[me[Le].type];Le++);return Rn(tt>1&&$n(rt),tt>1&&fn(me.slice(0,tt-1).concat({value:me[tt-2].type===" "?"*":""})).replace(B,"$1"),Me,tt<Le&&Ln(me.slice(tt,Le)),Le<Fe&&Ln(me=me.slice(Le)),Le<Fe&&fn(me))}rt.push(Me)}return $n(rt)}function Bi(me,Te){var Me=Te.length>0,Le=me.length>0,Fe=function(We,Je,tt,Ze,ct){var rt,st,ut,it=0,mt="0",St=We&&[],xt=[],kt=O,Ft=We||Le&&k.find.TAG("*",ct),Zt=Pe+=kt==null?1:Math.random()||.1,Et=Ft.length;for(ct&&(O=Je==le||Je||ct);mt!==Et&&(rt=Ft[mt])!=null;mt++){if(Le&&rt){for(st=0,!Je&&rt.ownerDocument!=le&&(Ht(rt),tt=!ye);ut=me[st++];)if(ut(rt,Je||le,tt)){ne.call(Ze,rt);break}ct&&(Pe=Zt)}Me&&((rt=!ut&&rt)&&it--,We&&St.push(rt))}if(it+=mt,Me&&mt!==it){for(st=0;ut=Te[st++];)ut(St,xt,Je,tt);if(We){if(it>0)for(;mt--;)St[mt]||xt[mt]||(xt[mt]=M.call(Ze));xt=gn(xt)}ne.apply(Ze,xt),ct&&!We&&xt.length>0&&it+Te.length>1&&u.uniqueSort(Ze)}return ct&&(Pe=Zt,O=kt),St};return Me?$t(Fe):Fe}function In(me,Te){var Me,Le=[],Fe=[],We=ot[me+" "];if(!We){for(Te||(Te=on(me)),Me=Te.length;Me--;)We=Ln(Te[Me]),We[Oe]?Le.push(We):Fe.push(We);We=ot(me,Bi(Fe,Le)),We.selector=me}return We}function ai(me,Te,Me,Le){var Fe,We,Je,tt,Ze,ct=typeof me=="function"&&me,rt=!Le&&on(me=ct.selector||me);if(Me=Me||[],rt.length===1){if(We=rt[0]=rt[0].slice(0),We.length>2&&(Je=We[0]).type==="ID"&&Te.nodeType===9&&ye&&k.relative[We[1].type]){if(Te=(k.find.ID(Je.matches[0].replace(Ut,Bt),Te)||[])[0],Te)ct&&(Te=Te.parentNode);else return Me;me=me.slice(We.shift().value.length)}for(Fe=Dt.needsContext.test(me)?0:We.length;Fe--&&(Je=We[Fe],!k.relative[tt=Je.type]);)if((Ze=k.find[tt])&&(Le=Ze(Je.matches[0].replace(Ut,Bt),Mn.test(We[0].type)&&Pn(Te.parentNode)||Te))){if(We.splice(Fe,1),me=Le.length&&fn(We),!me)return ne.apply(Me,Le),Me;break}}return(ct||In(me,rt))(Le,Te,!ye,Me,!Te||Mn.test(me)&&Pn(Te.parentNode)||Te),Me}m.sortStable=Oe.split("").sort(yt).join("")===Oe,Ht(),m.sortDetached=Jt(function(me){return me.compareDocumentPosition(le.createElement("fieldset"))&1}),u.find=gt,u.expr[":"]=u.expr.pseudos,u.unique=u.uniqueSort,gt.compile=In,gt.select=ai,gt.setDocument=Ht,gt.tokenize=on,gt.escape=u.escapeSelector,gt.getText=u.text,gt.isXML=u.isXMLDoc,gt.selectors=u.expr,gt.support=u.support,gt.uniqueSort=u.uniqueSort})();var w=function(f,k,O){for(var j=[],te=O!==void 0;(f=f[k])&&f.nodeType!==9;)if(f.nodeType===1){if(te&&u(f).is(O))break;j.push(f)}return j},N=function(f,k){for(var O=[];f;f=f.nextSibling)f.nodeType===1&&f!==k&&O.push(f);return O},G=u.expr.match.needsContext,V=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function H(f,k,O){return A(k)?u.grep(f,function(j,te){return!!k.call(j,te,j)!==O}):k.nodeType?u.grep(f,function(j){return j===k!==O}):typeof k!="string"?u.grep(f,function(j){return l.call(k,j)>-1!==O}):u.filter(k,f,O)}u.filter=function(f,k,O){var j=k[0];return O&&(f=":not("+f+")"),k.length===1&&j.nodeType===1?u.find.matchesSelector(j,f)?[j]:[]:u.find.matches(f,u.grep(k,function(te){return te.nodeType===1}))},u.fn.extend({find:function(f){var k,O,j=this.length,te=this;if(typeof f!="string")return this.pushStack(u(f).filter(function(){for(k=0;k<j;k++)if(u.contains(te[k],this))return!0}));for(O=this.pushStack([]),k=0;k<j;k++)u.find(f,te[k],O);return j>1?u.uniqueSort(O):O},filter:function(f){return this.pushStack(H(this,f||[],!1))},not:function(f){return this.pushStack(H(this,f||[],!0))},is:function(f){return!!H(this,typeof f=="string"&&G.test(f)?u(f):f||[],!1).length}});var X,Q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,ce=u.fn.init=function(f,k,O){var j,te;if(!f)return this;if(O=O||X,typeof f=="string")if(f[0]==="<"&&f[f.length-1]===">"&&f.length>=3?j=[null,f,null]:j=Q.exec(f),j&&(j[1]||!k))if(j[1]){if(k=k instanceof u?k[0]:k,u.merge(this,u.parseHTML(j[1],k&&k.nodeType?k.ownerDocument||k:x,!0)),V.test(j[1])&&u.isPlainObject(k))for(j in k)A(this[j])?this[j](k[j]):this.attr(j,k[j]);return this}else return te=x.getElementById(j[2]),te&&(this[0]=te,this.length=1),this;else return!k||k.jquery?(k||O).find(f):this.constructor(k).find(f);else{if(f.nodeType)return this[0]=f,this.length=1,this;if(A(f))return O.ready!==void 0?O.ready(f):f(u)}return u.makeArray(f,this)};ce.prototype=u.fn,X=u(x);var pe=/^(?:parents|prev(?:Until|All))/,_e={children:!0,contents:!0,next:!0,prev:!0};u.fn.extend({has:function(f){var k=u(f,this),O=k.length;return this.filter(function(){for(var j=0;j<O;j++)if(u.contains(this,k[j]))return!0})},closest:function(f,k){var O,j=0,te=this.length,ne=[],le=typeof f!="string"&&u(f);if(!G.test(f)){for(;j<te;j++)for(O=this[j];O&&O!==k;O=O.parentNode)if(O.nodeType<11&&(le?le.index(O)>-1:O.nodeType===1&&u.find.matchesSelector(O,f))){ne.push(O);break}}return this.pushStack(ne.length>1?u.uniqueSort(ne):ne)},index:function(f){return f?typeof f=="string"?l.call(u(f),this[0]):l.call(this,f.jquery?f[0]:f):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(f,k){return this.pushStack(u.uniqueSort(u.merge(this.get(),u(f,k))))},addBack:function(f){return this.add(f==null?this.prevObject:this.prevObject.filter(f))}});function xe(f,k){for(;(f=f[k])&&f.nodeType!==1;);return f}u.each({parent:function(f){var k=f.parentNode;return k&&k.nodeType!==11?k:null},parents:function(f){return w(f,"parentNode")},parentsUntil:function(f,k,O){return w(f,"parentNode",O)},next:function(f){return xe(f,"nextSibling")},prev:function(f){return xe(f,"previousSibling")},nextAll:function(f){return w(f,"nextSibling")},prevAll:function(f){return w(f,"previousSibling")},nextUntil:function(f,k,O){return w(f,"nextSibling",O)},prevUntil:function(f,k,O){return w(f,"previousSibling",O)},siblings:function(f){return N((f.parentNode||{}).firstChild,f)},children:function(f){return N(f.firstChild)},contents:function(f){return f.contentDocument!=null&&c(f.contentDocument)?f.contentDocument:(S(f,"template")&&(f=f.content||f),u.merge([],f.childNodes))}},function(f,k){u.fn[f]=function(O,j){var te=u.map(this,k,O);return f.slice(-5)!=="Until"&&(j=O),j&&typeof j=="string"&&(te=u.filter(j,te)),this.length>1&&(_e[f]||u.uniqueSort(te),pe.test(f)&&te.reverse()),this.pushStack(te)}});var Y=/[^\x20\t\r\n\f]+/g;function F(f){var k={};return u.each(f.match(Y)||[],function(O,j){k[j]=!0}),k}u.Callbacks=function(f){f=typeof f=="string"?F(f):u.extend({},f);var k,O,j,te,ne=[],le=[],Ee=-1,ye=function(){for(te=te||f.once,j=k=!0;le.length;Ee=-1)for(O=le.shift();++Ee<ne.length;)ne[Ee].apply(O[0],O[1])===!1&&f.stopOnFalse&&(Ee=ne.length,O=!1);f.memory||(O=!1),k=!1,te&&(O?ne=[]:ne="")},ke={add:function(){return ne&&(O&&!k&&(Ee=ne.length-1,le.push(O)),function Ne(Oe){u.each(Oe,function(Pe,ze){A(ze)?(!f.unique||!ke.has(ze))&&ne.push(ze):ze&&ze.length&&T(ze)!=="string"&&Ne(ze)})}(arguments),O&&!k&&ye()),this},remove:function(){return u.each(arguments,function(Ne,Oe){for(var Pe;(Pe=u.inArray(Oe,ne,Pe))>-1;)ne.splice(Pe,1),Pe<=Ee&&Ee--}),this},has:function(Ne){return Ne?u.inArray(Ne,ne)>-1:ne.length>0},empty:function(){return ne&&(ne=[]),this},disable:function(){return te=le=[],ne=O="",this},disabled:function(){return!ne},lock:function(){return te=le=[],!O&&!k&&(ne=O=""),this},locked:function(){return!!te},fireWith:function(Ne,Oe){return te||(Oe=Oe||[],Oe=[Ne,Oe.slice?Oe.slice():Oe],le.push(Oe),k||ye()),this},fire:function(){return ke.fireWith(this,arguments),this},fired:function(){return!!j}};return ke};function ie(f){return f}function ae(f){throw f}function de(f,k,O,j){var te;try{f&&A(te=f.promise)?te.call(f).done(k).fail(O):f&&A(te=f.then)?te.call(f,k,O):k.apply(void 0,[f].slice(j))}catch(ne){O.apply(void 0,[ne])}}u.extend({Deferred:function(f){var k=[["notify","progress",u.Callbacks("memory"),u.Callbacks("memory"),2],["resolve","done",u.Callbacks("once memory"),u.Callbacks("once memory"),0,"resolved"],["reject","fail",u.Callbacks("once memory"),u.Callbacks("once memory"),1,"rejected"]],O="pending",j={state:function(){return O},always:function(){return te.done(arguments).fail(arguments),this},catch:function(ne){return j.then(null,ne)},pipe:function(){var ne=arguments;return u.Deferred(function(le){u.each(k,function(Ee,ye){var ke=A(ne[ye[4]])&&ne[ye[4]];te[ye[1]](function(){var Ne=ke&&ke.apply(this,arguments);Ne&&A(Ne.promise)?Ne.promise().progress(le.notify).done(le.resolve).fail(le.reject):le[ye[0]+"With"](this,ke?[Ne]:arguments)})}),ne=null}).promise()},then:function(ne,le,Ee){var ye=0;function ke(Ne,Oe,Pe,ze){return function(){var at=this,ht=arguments,ot=function(){var yt,Lt;if(!(Ne<ye)){if(yt=Pe.apply(at,ht),yt===Oe.promise())throw new TypeError("Thenable self-resolution");Lt=yt&&(typeof yt=="object"||typeof yt=="function")&&yt.then,A(Lt)?ze?Lt.call(yt,ke(ye,Oe,ie,ze),ke(ye,Oe,ae,ze)):(ye++,Lt.call(yt,ke(ye,Oe,ie,ze),ke(ye,Oe,ae,ze),ke(ye,Oe,ie,Oe.notifyWith))):(Pe!==ie&&(at=void 0,ht=[yt]),(ze||Oe.resolveWith)(at,ht))}},wt=ze?ot:function(){try{ot()}catch(yt){u.Deferred.exceptionHook&&u.Deferred.exceptionHook(yt,wt.error),Ne+1>=ye&&(Pe!==ae&&(at=void 0,ht=[yt]),Oe.rejectWith(at,ht))}};Ne?wt():(u.Deferred.getErrorHook?wt.error=u.Deferred.getErrorHook():u.Deferred.getStackHook&&(wt.error=u.Deferred.getStackHook()),n.setTimeout(wt))}}return u.Deferred(function(Ne){k[0][3].add(ke(0,Ne,A(Ee)?Ee:ie,Ne.notifyWith)),k[1][3].add(ke(0,Ne,A(ne)?ne:ie)),k[2][3].add(ke(0,Ne,A(le)?le:ae))}).promise()},promise:function(ne){return ne!=null?u.extend(ne,j):j}},te={};return u.each(k,function(ne,le){var Ee=le[2],ye=le[5];j[le[1]]=Ee.add,ye&&Ee.add(function(){O=ye},k[3-ne][2].disable,k[3-ne][3].disable,k[0][2].lock,k[0][3].lock),Ee.add(le[3].fire),te[le[0]]=function(){return te[le[0]+"With"](this===te?void 0:this,arguments),this},te[le[0]+"With"]=Ee.fireWith}),j.promise(te),f&&f.call(te,te),te},when:function(f){var k=arguments.length,O=k,j=Array(O),te=a.call(arguments),ne=u.Deferred(),le=function(Ee){return function(ye){j[Ee]=this,te[Ee]=arguments.length>1?a.call(arguments):ye,--k||ne.resolveWith(j,te)}};if(k<=1&&(de(f,ne.done(le(O)).resolve,ne.reject,!k),ne.state()==="pending"||A(te[O]&&te[O].then)))return ne.then();for(;O--;)de(te[O],le(O),ne.reject);return ne.promise()}});var ve=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;u.Deferred.exceptionHook=function(f,k){n.console&&n.console.warn&&f&&ve.test(f.name)&&n.console.warn("jQuery.Deferred exception: "+f.message,f.stack,k)},u.readyException=function(f){n.setTimeout(function(){throw f})};var ee=u.Deferred();u.fn.ready=function(f){return ee.then(f).catch(function(k){u.readyException(k)}),this},u.extend({isReady:!1,readyWait:1,ready:function(f){(f===!0?--u.readyWait:u.isReady)||(u.isReady=!0,!(f!==!0&&--u.readyWait>0)&&ee.resolveWith(x,[u]))}}),u.ready.then=ee.then;function se(){x.removeEventListener("DOMContentLoaded",se),n.removeEventListener("load",se),u.ready()}x.readyState==="complete"||x.readyState!=="loading"&&!x.documentElement.doScroll?n.setTimeout(u.ready):(x.addEventListener("DOMContentLoaded",se),n.addEventListener("load",se));var K=function(f,k,O,j,te,ne,le){var Ee=0,ye=f.length,ke=O==null;if(T(O)==="object"){te=!0;for(Ee in O)K(f,k,Ee,O[Ee],!0,ne,le)}else if(j!==void 0&&(te=!0,A(j)||(le=!0),ke&&(le?(k.call(f,j),k=null):(ke=k,k=function(Ne,Oe,Pe){return ke.call(u(Ne),Pe)})),k))for(;Ee<ye;Ee++)k(f[Ee],O,le?j:j.call(f[Ee],Ee,k(f[Ee],O)));return te?f:ke?k.call(f):ye?k(f[0],O):ne},I=/^-ms-/,U=/-([a-z])/g;function oe(f,k){return k.toUpperCase()}function ge(f){return f.replace(I,"ms-").replace(U,oe)}var Se=function(f){return f.nodeType===1||f.nodeType===9||!+f.nodeType};function Ce(){this.expando=u.expando+Ce.uid++}Ce.uid=1,Ce.prototype={cache:function(f){var k=f[this.expando];return k||(k={},Se(f)&&(f.nodeType?f[this.expando]=k:Object.defineProperty(f,this.expando,{value:k,configurable:!0}))),k},set:function(f,k,O){var j,te=this.cache(f);if(typeof k=="string")te[ge(k)]=O;else for(j in k)te[ge(j)]=k[j];return te},get:function(f,k){return k===void 0?this.cache(f):f[this.expando]&&f[this.expando][ge(k)]},access:function(f,k,O){return k===void 0||k&&typeof k=="string"&&O===void 0?this.get(f,k):(this.set(f,k,O),O!==void 0?O:k)},remove:function(f,k){var O,j=f[this.expando];if(j!==void 0){if(k!==void 0)for(Array.isArray(k)?k=k.map(ge):(k=ge(k),k=k in j?[k]:k.match(Y)||[]),O=k.length;O--;)delete j[k[O]];(k===void 0||u.isEmptyObject(j))&&(f.nodeType?f[this.expando]=void 0:delete f[this.expando])}},hasData:function(f){var k=f[this.expando];return k!==void 0&&!u.isEmptyObject(k)}};var Re=new Ce,qe=new Ce,Ge=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ye=/[A-Z]/g;function He(f){return f==="true"?!0:f==="false"?!1:f==="null"?null:f===+f+""?+f:Ge.test(f)?JSON.parse(f):f}function Xe(f,k,O){var j;if(O===void 0&&f.nodeType===1)if(j="data-"+k.replace(Ye,"-$&").toLowerCase(),O=f.getAttribute(j),typeof O=="string"){try{O=He(O)}catch{}qe.set(f,k,O)}else O=void 0;return O}u.extend({hasData:function(f){return qe.hasData(f)||Re.hasData(f)},data:function(f,k,O){return qe.access(f,k,O)},removeData:function(f,k){qe.remove(f,k)},_data:function(f,k,O){return Re.access(f,k,O)},_removeData:function(f,k){Re.remove(f,k)}}),u.fn.extend({data:function(f,k){var O,j,te,ne=this[0],le=ne&&ne.attributes;if(f===void 0){if(this.length&&(te=qe.get(ne),ne.nodeType===1&&!Re.get(ne,"hasDataAttrs"))){for(O=le.length;O--;)le[O]&&(j=le[O].name,j.indexOf("data-")===0&&(j=ge(j.slice(5)),Xe(ne,j,te[j])));Re.set(ne,"hasDataAttrs",!0)}return te}return typeof f=="object"?this.each(function(){qe.set(this,f)}):K(this,function(Ee){var ye;if(ne&&Ee===void 0)return ye=qe.get(ne,f),ye!==void 0||(ye=Xe(ne,f),ye!==void 0)?ye:void 0;this.each(function(){qe.set(this,f,Ee)})},null,k,arguments.length>1,null,!0)},removeData:function(f){return this.each(function(){qe.remove(this,f)})}}),u.extend({queue:function(f,k,O){var j;if(f)return k=(k||"fx")+"queue",j=Re.get(f,k),O&&(!j||Array.isArray(O)?j=Re.access(f,k,u.makeArray(O)):j.push(O)),j||[]},dequeue:function(f,k){k=k||"fx";var O=u.queue(f,k),j=O.length,te=O.shift(),ne=u._queueHooks(f,k),le=function(){u.dequeue(f,k)};te==="inprogress"&&(te=O.shift(),j--),te&&(k==="fx"&&O.unshift("inprogress"),delete ne.stop,te.call(f,le,ne)),!j&&ne&&ne.empty.fire()},_queueHooks:function(f,k){var O=k+"queueHooks";return Re.get(f,O)||Re.access(f,O,{empty:u.Callbacks("once memory").add(function(){Re.remove(f,[k+"queue",O])})})}}),u.fn.extend({queue:function(f,k){var O=2;return typeof f!="string"&&(k=f,f="fx",O--),arguments.length<O?u.queue(this[0],f):k===void 0?this:this.each(function(){var j=u.queue(this,f,k);u._queueHooks(this,f),f==="fx"&&j[0]!=="inprogress"&&u.dequeue(this,f)})},dequeue:function(f){return this.each(function(){u.dequeue(this,f)})},clearQueue:function(f){return this.queue(f||"fx",[])},promise:function(f,k){var O,j=1,te=u.Deferred(),ne=this,le=this.length,Ee=function(){--j||te.resolveWith(ne,[ne])};for(typeof f!="string"&&(k=f,f=void 0),f=f||"fx";le--;)O=Re.get(ne[le],f+"queueHooks"),O&&O.empty&&(j++,O.empty.add(Ee));return Ee(),te.promise(k)}});var Qe=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,je=new RegExp("^(?:([+-])=|)("+Qe+")([a-z%]*)$","i"),W=["Top","Right","Bottom","Left"],re=x.documentElement,ue=function(f){return u.contains(f.ownerDocument,f)},he={composed:!0};re.getRootNode&&(ue=function(f){return u.contains(f.ownerDocument,f)||f.getRootNode(he)===f.ownerDocument});var we=function(f,k){return f=k||f,f.style.display==="none"||f.style.display===""&&ue(f)&&u.css(f,"display")==="none"};function $e(f,k,O,j){var te,ne,le=20,Ee=j?function(){return j.cur()}:function(){return u.css(f,k,"")},ye=Ee(),ke=O&&O[3]||(u.cssNumber[k]?"":"px"),Ne=f.nodeType&&(u.cssNumber[k]||ke!=="px"&&+ye)&&je.exec(u.css(f,k));if(Ne&&Ne[3]!==ke){for(ye=ye/2,ke=ke||Ne[3],Ne=+ye||1;le--;)u.style(f,k,Ne+ke),(1-ne)*(1-(ne=Ee()/ye||.5))<=0&&(le=0),Ne=Ne/ne;Ne=Ne*2,u.style(f,k,Ne+ke),O=O||[]}return O&&(Ne=+Ne||+ye||0,te=O[1]?Ne+(O[1]+1)*O[2]:+O[2],j&&(j.unit=ke,j.start=Ne,j.end=te)),te}var fe={};function be(f){var k,O=f.ownerDocument,j=f.nodeName,te=fe[j];return te||(k=O.body.appendChild(O.createElement(j)),te=u.css(k,"display"),k.parentNode.removeChild(k),te==="none"&&(te="block"),fe[j]=te,te)}function Ae(f,k){for(var O,j,te=[],ne=0,le=f.length;ne<le;ne++)j=f[ne],j.style&&(O=j.style.display,k?(O==="none"&&(te[ne]=Re.get(j,"display")||null,te[ne]||(j.style.display="")),j.style.display===""&&we(j)&&(te[ne]=be(j))):O!=="none"&&(te[ne]="none",Re.set(j,"display",O)));for(ne=0;ne<le;ne++)te[ne]!=null&&(f[ne].style.display=te[ne]);return f}u.fn.extend({show:function(){return Ae(this,!0)},hide:function(){return Ae(this)},toggle:function(f){return typeof f=="boolean"?f?this.show():this.hide():this.each(function(){we(this)?u(this).show():u(this).hide()})}});var De=/^(?:checkbox|radio)$/i,Ve=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ke=/^$|^module$|\/(?:java|ecma)script/i;(function(){var f=x.createDocumentFragment(),k=f.appendChild(x.createElement("div")),O=x.createElement("input");O.setAttribute("type","radio"),O.setAttribute("checked","checked"),O.setAttribute("name","t"),k.appendChild(O),m.checkClone=k.cloneNode(!0).cloneNode(!0).lastChild.checked,k.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!k.cloneNode(!0).lastChild.defaultValue,k.innerHTML="<option></option>",m.option=!!k.lastChild})();var Be={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Be.tbody=Be.tfoot=Be.colgroup=Be.caption=Be.thead,Be.th=Be.td,m.option||(Be.optgroup=Be.option=[1,"<select multiple='multiple'>","</select>"]);function Ie(f,k){var O;return typeof f.getElementsByTagName<"u"?O=f.getElementsByTagName(k||"*"):typeof f.querySelectorAll<"u"?O=f.querySelectorAll(k||"*"):O=[],k===void 0||k&&S(f,k)?u.merge([f],O):O}function Ue(f,k){for(var O=0,j=f.length;O<j;O++)Re.set(f[O],"globalEval",!k||Re.get(k[O],"globalEval"))}var et=/<|&#?\w+;/;function nt(f,k,O,j,te){for(var ne,le,Ee,ye,ke,Ne,Oe=k.createDocumentFragment(),Pe=[],ze=0,at=f.length;ze<at;ze++)if(ne=f[ze],ne||ne===0)if(T(ne)==="object")u.merge(Pe,ne.nodeType?[ne]:ne);else if(!et.test(ne))Pe.push(k.createTextNode(ne));else{for(le=le||Oe.appendChild(k.createElement("div")),Ee=(Ve.exec(ne)||["",""])[1].toLowerCase(),ye=Be[Ee]||Be._default,le.innerHTML=ye[1]+u.htmlPrefilter(ne)+ye[2],Ne=ye[0];Ne--;)le=le.lastChild;u.merge(Pe,le.childNodes),le=Oe.firstChild,le.textContent=""}for(Oe.textContent="",ze=0;ne=Pe[ze++];){if(j&&u.inArray(ne,j)>-1){te&&te.push(ne);continue}if(ke=ue(ne),le=Ie(Oe.appendChild(ne),"script"),ke&&Ue(le),O)for(Ne=0;ne=le[Ne++];)Ke.test(ne.type||"")&&O.push(ne)}return Oe}var lt=/^([^.]*)(?:\.(.+)|)/;function vt(){return!0}function Ct(){return!1}function Gt(f,k,O,j,te,ne){var le,Ee;if(typeof k=="object"){typeof O!="string"&&(j=j||O,O=void 0);for(Ee in k)Gt(f,Ee,O,j,k[Ee],ne);return f}if(j==null&&te==null?(te=O,j=O=void 0):te==null&&(typeof O=="string"?(te=j,j=void 0):(te=j,j=O,O=void 0)),te===!1)te=Ct;else if(!te)return f;return ne===1&&(le=te,te=function(ye){return u().off(ye),le.apply(this,arguments)},te.guid=le.guid||(le.guid=u.guid++)),f.each(function(){u.event.add(this,k,te,j,O)})}u.event={global:{},add:function(f,k,O,j,te){var ne,le,Ee,ye,ke,Ne,Oe,Pe,ze,at,ht,ot=Re.get(f);if(Se(f))for(O.handler&&(ne=O,O=ne.handler,te=ne.selector),te&&u.find.matchesSelector(re,te),O.guid||(O.guid=u.guid++),(ye=ot.events)||(ye=ot.events=Object.create(null)),(le=ot.handle)||(le=ot.handle=function(wt){return typeof u<"u"&&u.event.triggered!==wt.type?u.event.dispatch.apply(f,arguments):void 0}),k=(k||"").match(Y)||[""],ke=k.length;ke--;)Ee=lt.exec(k[ke])||[],ze=ht=Ee[1],at=(Ee[2]||"").split(".").sort(),ze&&(Oe=u.event.special[ze]||{},ze=(te?Oe.delegateType:Oe.bindType)||ze,Oe=u.event.special[ze]||{},Ne=u.extend({type:ze,origType:ht,data:j,handler:O,guid:O.guid,selector:te,needsContext:te&&u.expr.match.needsContext.test(te),namespace:at.join(".")},ne),(Pe=ye[ze])||(Pe=ye[ze]=[],Pe.delegateCount=0,(!Oe.setup||Oe.setup.call(f,j,at,le)===!1)&&f.addEventListener&&f.addEventListener(ze,le)),Oe.add&&(Oe.add.call(f,Ne),Ne.handler.guid||(Ne.handler.guid=O.guid)),te?Pe.splice(Pe.delegateCount++,0,Ne):Pe.push(Ne),u.event.global[ze]=!0)},remove:function(f,k,O,j,te){var ne,le,Ee,ye,ke,Ne,Oe,Pe,ze,at,ht,ot=Re.hasData(f)&&Re.get(f);if(!(!ot||!(ye=ot.events))){for(k=(k||"").match(Y)||[""],ke=k.length;ke--;){if(Ee=lt.exec(k[ke])||[],ze=ht=Ee[1],at=(Ee[2]||"").split(".").sort(),!ze){for(ze in ye)u.event.remove(f,ze+k[ke],O,j,!0);continue}for(Oe=u.event.special[ze]||{},ze=(j?Oe.delegateType:Oe.bindType)||ze,Pe=ye[ze]||[],Ee=Ee[2]&&new RegExp("(^|\\.)"+at.join("\\.(?:.*\\.|)")+"(\\.|$)"),le=ne=Pe.length;ne--;)Ne=Pe[ne],(te||ht===Ne.origType)&&(!O||O.guid===Ne.guid)&&(!Ee||Ee.test(Ne.namespace))&&(!j||j===Ne.selector||j==="**"&&Ne.selector)&&(Pe.splice(ne,1),Ne.selector&&Pe.delegateCount--,Oe.remove&&Oe.remove.call(f,Ne));le&&!Pe.length&&((!Oe.teardown||Oe.teardown.call(f,at,ot.handle)===!1)&&u.removeEvent(f,ze,ot.handle),delete ye[ze])}u.isEmptyObject(ye)&&Re.remove(f,"handle events")}},dispatch:function(f){var k,O,j,te,ne,le,Ee=new Array(arguments.length),ye=u.event.fix(f),ke=(Re.get(this,"events")||Object.create(null))[ye.type]||[],Ne=u.event.special[ye.type]||{};for(Ee[0]=ye,k=1;k<arguments.length;k++)Ee[k]=arguments[k];if(ye.delegateTarget=this,!(Ne.preDispatch&&Ne.preDispatch.call(this,ye)===!1)){for(le=u.event.handlers.call(this,ye,ke),k=0;(te=le[k++])&&!ye.isPropagationStopped();)for(ye.currentTarget=te.elem,O=0;(ne=te.handlers[O++])&&!ye.isImmediatePropagationStopped();)(!ye.rnamespace||ne.namespace===!1||ye.rnamespace.test(ne.namespace))&&(ye.handleObj=ne,ye.data=ne.data,j=((u.event.special[ne.origType]||{}).handle||ne.handler).apply(te.elem,Ee),j!==void 0&&(ye.result=j)===!1&&(ye.preventDefault(),ye.stopPropagation()));return Ne.postDispatch&&Ne.postDispatch.call(this,ye),ye.result}},handlers:function(f,k){var O,j,te,ne,le,Ee=[],ye=k.delegateCount,ke=f.target;if(ye&&ke.nodeType&&!(f.type==="click"&&f.button>=1)){for(;ke!==this;ke=ke.parentNode||this)if(ke.nodeType===1&&!(f.type==="click"&&ke.disabled===!0)){for(ne=[],le={},O=0;O<ye;O++)j=k[O],te=j.selector+" ",le[te]===void 0&&(le[te]=j.needsContext?u(te,this).index(ke)>-1:u.find(te,this,null,[ke]).length),le[te]&&ne.push(j);ne.length&&Ee.push({elem:ke,handlers:ne})}}return ke=this,ye<k.length&&Ee.push({elem:ke,handlers:k.slice(ye)}),Ee},addProp:function(f,k){Object.defineProperty(u.Event.prototype,f,{enumerable:!0,configurable:!0,get:A(k)?function(){if(this.originalEvent)return k(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[f]},set:function(O){Object.defineProperty(this,f,{enumerable:!0,configurable:!0,writable:!0,value:O})}})},fix:function(f){return f[u.expando]?f:new u.Event(f)},special:{load:{noBubble:!0},click:{setup:function(f){var k=this||f;return De.test(k.type)&&k.click&&S(k,"input")&&_t(k,"click",!0),!1},trigger:function(f){var k=this||f;return De.test(k.type)&&k.click&&S(k,"input")&&_t(k,"click"),!0},_default:function(f){var k=f.target;return De.test(k.type)&&k.click&&S(k,"input")&&Re.get(k,"click")||S(k,"a")}},beforeunload:{postDispatch:function(f){f.result!==void 0&&f.originalEvent&&(f.originalEvent.returnValue=f.result)}}}};function _t(f,k,O){if(!O){Re.get(f,k)===void 0&&u.event.add(f,k,vt);return}Re.set(f,k,!1),u.event.add(f,k,{namespace:!1,handler:function(j){var te,ne=Re.get(this,k);if(j.isTrigger&1&&this[k]){if(ne)(u.event.special[k]||{}).delegateType&&j.stopPropagation();else if(ne=a.call(arguments),Re.set(this,k,ne),this[k](),te=Re.get(this,k),Re.set(this,k,!1),ne!==te)return j.stopImmediatePropagation(),j.preventDefault(),te}else ne&&(Re.set(this,k,u.event.trigger(ne[0],ne.slice(1),this)),j.stopPropagation(),j.isImmediatePropagationStopped=vt)}})}u.removeEvent=function(f,k,O){f.removeEventListener&&f.removeEventListener(k,O)},u.Event=function(f,k){if(!(this instanceof u.Event))return new u.Event(f,k);f&&f.type?(this.originalEvent=f,this.type=f.type,this.isDefaultPrevented=f.defaultPrevented||f.defaultPrevented===void 0&&f.returnValue===!1?vt:Ct,this.target=f.target&&f.target.nodeType===3?f.target.parentNode:f.target,this.currentTarget=f.currentTarget,this.relatedTarget=f.relatedTarget):this.type=f,k&&u.extend(this,k),this.timeStamp=f&&f.timeStamp||Date.now(),this[u.expando]=!0},u.Event.prototype={constructor:u.Event,isDefaultPrevented:Ct,isPropagationStopped:Ct,isImmediatePropagationStopped:Ct,isSimulated:!1,preventDefault:function(){var f=this.originalEvent;this.isDefaultPrevented=vt,f&&!this.isSimulated&&f.preventDefault()},stopPropagation:function(){var f=this.originalEvent;this.isPropagationStopped=vt,f&&!this.isSimulated&&f.stopPropagation()},stopImmediatePropagation:function(){var f=this.originalEvent;this.isImmediatePropagationStopped=vt,f&&!this.isSimulated&&f.stopImmediatePropagation(),this.stopPropagation()}},u.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},u.event.addProp),u.each({focus:"focusin",blur:"focusout"},function(f,k){function O(j){if(x.documentMode){var te=Re.get(this,"handle"),ne=u.event.fix(j);ne.type=j.type==="focusin"?"focus":"blur",ne.isSimulated=!0,te(j),ne.target===ne.currentTarget&&te(ne)}else u.event.simulate(k,j.target,u.event.fix(j))}u.event.special[f]={setup:function(){var j;if(_t(this,f,!0),x.documentMode)j=Re.get(this,k),j||this.addEventListener(k,O),Re.set(this,k,(j||0)+1);else return!1},trigger:function(){return _t(this,f),!0},teardown:function(){var j;if(x.documentMode)j=Re.get(this,k)-1,j?Re.set(this,k,j):(this.removeEventListener(k,O),Re.remove(this,k));else return!1},_default:function(j){return Re.get(j.target,f)},delegateType:k},u.event.special[k]={setup:function(){var j=this.ownerDocument||this.document||this,te=x.documentMode?this:j,ne=Re.get(te,k);ne||(x.documentMode?this.addEventListener(k,O):j.addEventListener(f,O,!0)),Re.set(te,k,(ne||0)+1)},teardown:function(){var j=this.ownerDocument||this.document||this,te=x.documentMode?this:j,ne=Re.get(te,k)-1;ne?Re.set(te,k,ne):(x.documentMode?this.removeEventListener(k,O):j.removeEventListener(f,O,!0),Re.remove(te,k))}}}),u.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(f,k){u.event.special[f]={delegateType:k,bindType:k,handle:function(O){var j,te=this,ne=O.relatedTarget,le=O.handleObj;return(!ne||ne!==te&&!u.contains(te,ne))&&(O.type=le.origType,j=le.handler.apply(this,arguments),O.type=k),j}}}),u.fn.extend({on:function(f,k,O,j){return Gt(this,f,k,O,j)},one:function(f,k,O,j){return Gt(this,f,k,O,j,1)},off:function(f,k,O){var j,te;if(f&&f.preventDefault&&f.handleObj)return j=f.handleObj,u(f.delegateTarget).off(j.namespace?j.origType+"."+j.namespace:j.origType,j.selector,j.handler),this;if(typeof f=="object"){for(te in f)this.off(te,k,f[te]);return this}return(k===!1||typeof k=="function")&&(O=k,k=void 0),O===!1&&(O=Ct),this.each(function(){u.event.remove(this,f,O,k)})}});var pt=/<script|<style|<link/i,Rt=/checked\s*(?:[^=]|=\s*.checked.)/i,Ot=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Mt(f,k){return S(f,"table")&&S(k.nodeType!==11?k:k.firstChild,"tr")&&u(f).children("tbody")[0]||f}function Qt(f){return f.type=(f.getAttribute("type")!==null)+"/"+f.type,f}function ln(f){return(f.type||"").slice(0,5)==="true/"?f.type=f.type.slice(5):f.removeAttribute("type"),f}function Nn(f,k){var O,j,te,ne,le,Ee,ye;if(k.nodeType===1){if(Re.hasData(f)&&(ne=Re.get(f),ye=ne.events,ye)){Re.remove(k,"handle events");for(te in ye)for(O=0,j=ye[te].length;O<j;O++)u.event.add(k,te,ye[te][O])}qe.hasData(f)&&(le=qe.access(f),Ee=u.extend({},le),qe.set(k,Ee))}}function si(f,k){var O=k.nodeName.toLowerCase();O==="input"&&De.test(f.type)?k.checked=f.checked:(O==="input"||O==="textarea")&&(k.defaultValue=f.defaultValue)}function Yt(f,k,O,j){k=i(k);var te,ne,le,Ee,ye,ke,Ne=0,Oe=f.length,Pe=Oe-1,ze=k[0],at=A(ze);if(at||Oe>1&&typeof ze=="string"&&!m.checkClone&&Rt.test(ze))return f.each(function(ht){var ot=f.eq(ht);at&&(k[0]=ze.call(this,ht,ot.html())),Yt(ot,k,O,j)});if(Oe&&(te=nt(k,f[0].ownerDocument,!1,f,j),ne=te.firstChild,te.childNodes.length===1&&(te=ne),ne||j)){for(le=u.map(Ie(te,"script"),Qt),Ee=le.length;Ne<Oe;Ne++)ye=te,Ne!==Pe&&(ye=u.clone(ye,!0,!0),Ee&&u.merge(le,Ie(ye,"script"))),O.call(f[Ne],ye,Ne);if(Ee)for(ke=le[le.length-1].ownerDocument,u.map(le,ln),Ne=0;Ne<Ee;Ne++)ye=le[Ne],Ke.test(ye.type||"")&&!Re.access(ye,"globalEval")&&u.contains(ke,ye)&&(ye.src&&(ye.type||"").toLowerCase()!=="module"?u._evalUrl&&!ye.noModule&&u._evalUrl(ye.src,{nonce:ye.nonce||ye.getAttribute("nonce")},ke):L(ye.textContent.replace(Ot,""),ye,ke))}return f}function Dn(f,k,O){for(var j,te=k?u.filter(k,f):f,ne=0;(j=te[ne])!=null;ne++)!O&&j.nodeType===1&&u.cleanData(Ie(j)),j.parentNode&&(O&&ue(j)&&Ue(Ie(j,"script")),j.parentNode.removeChild(j));return f}u.extend({htmlPrefilter:function(f){return f},clone:function(f,k,O){var j,te,ne,le,Ee=f.cloneNode(!0),ye=ue(f);if(!m.noCloneChecked&&(f.nodeType===1||f.nodeType===11)&&!u.isXMLDoc(f))for(le=Ie(Ee),ne=Ie(f),j=0,te=ne.length;j<te;j++)si(ne[j],le[j]);if(k)if(O)for(ne=ne||Ie(f),le=le||Ie(Ee),j=0,te=ne.length;j<te;j++)Nn(ne[j],le[j]);else Nn(f,Ee);return le=Ie(Ee,"script"),le.length>0&&Ue(le,!ye&&Ie(f,"script")),Ee},cleanData:function(f){for(var k,O,j,te=u.event.special,ne=0;(O=f[ne])!==void 0;ne++)if(Se(O)){if(k=O[Re.expando]){if(k.events)for(j in k.events)te[j]?u.event.remove(O,j):u.removeEvent(O,j,k.handle);O[Re.expando]=void 0}O[qe.expando]&&(O[qe.expando]=void 0)}}}),u.fn.extend({detach:function(f){return Dn(this,f,!0)},remove:function(f){return Dn(this,f)},text:function(f){return K(this,function(k){return k===void 0?u.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=k)})},null,f,arguments.length)},append:function(){return Yt(this,arguments,function(f){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var k=Mt(this,f);k.appendChild(f)}})},prepend:function(){return Yt(this,arguments,function(f){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var k=Mt(this,f);k.insertBefore(f,k.firstChild)}})},before:function(){return Yt(this,arguments,function(f){this.parentNode&&this.parentNode.insertBefore(f,this)})},after:function(){return Yt(this,arguments,function(f){this.parentNode&&this.parentNode.insertBefore(f,this.nextSibling)})},empty:function(){for(var f,k=0;(f=this[k])!=null;k++)f.nodeType===1&&(u.cleanData(Ie(f,!1)),f.textContent="");return this},clone:function(f,k){return f=f??!1,k=k??f,this.map(function(){return u.clone(this,f,k)})},html:function(f){return K(this,function(k){var O=this[0]||{},j=0,te=this.length;if(k===void 0&&O.nodeType===1)return O.innerHTML;if(typeof k=="string"&&!pt.test(k)&&!Be[(Ve.exec(k)||["",""])[1].toLowerCase()]){k=u.htmlPrefilter(k);try{for(;j<te;j++)O=this[j]||{},O.nodeType===1&&(u.cleanData(Ie(O,!1)),O.innerHTML=k);O=0}catch{}}O&&this.empty().append(k)},null,f,arguments.length)},replaceWith:function(){var f=[];return Yt(this,arguments,function(k){var O=this.parentNode;u.inArray(this,f)<0&&(u.cleanData(Ie(this)),O&&O.replaceChild(k,this))},f)}}),u.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(f,k){u.fn[f]=function(O){for(var j,te=[],ne=u(O),le=ne.length-1,Ee=0;Ee<=le;Ee++)j=Ee===le?this:this.clone(!0),u(ne[Ee])[k](j),o.apply(te,j.get());return this.pushStack(te)}});var _n=new RegExp("^("+Qe+")(?!px)[a-z%]+$","i"),mn=/^--/,cn=function(f){var k=f.ownerDocument.defaultView;return(!k||!k.opener)&&(k=n),k.getComputedStyle(f)},Fn=function(f,k,O){var j,te,ne={};for(te in k)ne[te]=f.style[te],f.style[te]=k[te];j=O.call(f);for(te in k)f.style[te]=ne[te];return j},oi=new RegExp(W.join("|"),"i");(function(){function f(){if(ke){ye.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",ke.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(ye).appendChild(ke);var Ne=n.getComputedStyle(ke);O=Ne.top!=="1%",Ee=k(Ne.marginLeft)===12,ke.style.right="60%",ne=k(Ne.right)===36,j=k(Ne.width)===36,ke.style.position="absolute",te=k(ke.offsetWidth/3)===12,re.removeChild(ye),ke=null}}function k(Ne){return Math.round(parseFloat(Ne))}var O,j,te,ne,le,Ee,ye=x.createElement("div"),ke=x.createElement("div");ke.style&&(ke.style.backgroundClip="content-box",ke.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle=ke.style.backgroundClip==="content-box",u.extend(m,{boxSizingReliable:function(){return f(),j},pixelBoxStyles:function(){return f(),ne},pixelPosition:function(){return f(),O},reliableMarginLeft:function(){return f(),Ee},scrollboxSize:function(){return f(),te},reliableTrDimensions:function(){var Ne,Oe,Pe,ze;return le==null&&(Ne=x.createElement("table"),Oe=x.createElement("tr"),Pe=x.createElement("div"),Ne.style.cssText="position:absolute;left:-11111px;border-collapse:separate",Oe.style.cssText="box-sizing:content-box;border:1px solid",Oe.style.height="1px",Pe.style.height="9px",Pe.style.display="block",re.appendChild(Ne).appendChild(Oe).appendChild(Pe),ze=n.getComputedStyle(Oe),le=parseInt(ze.height,10)+parseInt(ze.borderTopWidth,10)+parseInt(ze.borderBottomWidth,10)===Oe.offsetHeight,re.removeChild(Ne)),le}}))})();function en(f,k,O){var j,te,ne,le,Ee=mn.test(k),ye=f.style;return O=O||cn(f),O&&(le=O.getPropertyValue(k)||O[k],Ee&&le&&(le=le.replace(B,"$1")||void 0),le===""&&!ue(f)&&(le=u.style(f,k)),!m.pixelBoxStyles()&&_n.test(le)&&oi.test(k)&&(j=ye.width,te=ye.minWidth,ne=ye.maxWidth,ye.minWidth=ye.maxWidth=ye.width=le,le=O.width,ye.width=j,ye.minWidth=te,ye.maxWidth=ne)),le!==void 0?le+"":le}function On(f,k){return{get:function(){if(f()){delete this.get;return}return(this.get=k).apply(this,arguments)}}}var Un=["Webkit","Moz","ms"],Bn=x.createElement("div").style,Gn={};function li(f){for(var k=f[0].toUpperCase()+f.slice(1),O=Un.length;O--;)if(f=Un[O]+k,f in Bn)return f}function vn(f){var k=u.cssProps[f]||Gn[f];return k||(f in Bn?f:Gn[f]=li(f)||f)}var ci=/^(none|table(?!-c[ea]).+)/,ui={position:"absolute",visibility:"hidden",display:"block"},zn={letterSpacing:"0",fontWeight:"400"};function jn(f,k,O){var j=je.exec(k);return j?Math.max(0,j[2]-(O||0))+(j[3]||"px"):k}function bn(f,k,O,j,te,ne){var le=k==="width"?1:0,Ee=0,ye=0,ke=0;if(O===(j?"border":"content"))return 0;for(;le<4;le+=2)O==="margin"&&(ke+=u.css(f,O+W[le],!0,te)),j?(O==="content"&&(ye-=u.css(f,"padding"+W[le],!0,te)),O!=="margin"&&(ye-=u.css(f,"border"+W[le]+"Width",!0,te))):(ye+=u.css(f,"padding"+W[le],!0,te),O!=="padding"?ye+=u.css(f,"border"+W[le]+"Width",!0,te):Ee+=u.css(f,"border"+W[le]+"Width",!0,te));return!j&&ne>=0&&(ye+=Math.max(0,Math.ceil(f["offset"+k[0].toUpperCase()+k.slice(1)]-ne-ye-Ee-.5))||0),ye+ke}function Hn(f,k,O){var j=cn(f),te=!m.boxSizingReliable()||O,ne=te&&u.css(f,"boxSizing",!1,j)==="border-box",le=ne,Ee=en(f,k,j),ye="offset"+k[0].toUpperCase()+k.slice(1);if(_n.test(Ee)){if(!O)return Ee;Ee="auto"}return(!m.boxSizingReliable()&&ne||!m.reliableTrDimensions()&&S(f,"tr")||Ee==="auto"||!parseFloat(Ee)&&u.css(f,"display",!1,j)==="inline")&&f.getClientRects().length&&(ne=u.css(f,"boxSizing",!1,j)==="border-box",le=ye in f,le&&(Ee=f[ye])),Ee=parseFloat(Ee)||0,Ee+bn(f,k,O||(ne?"border":"content"),le,j,Ee)+"px"}u.extend({cssHooks:{opacity:{get:function(f,k){if(k){var O=en(f,"opacity");return O===""?"1":O}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(f,k,O,j){if(!(!f||f.nodeType===3||f.nodeType===8||!f.style)){var te,ne,le,Ee=ge(k),ye=mn.test(k),ke=f.style;if(ye||(k=vn(Ee)),le=u.cssHooks[k]||u.cssHooks[Ee],O!==void 0){if(ne=typeof O,ne==="string"&&(te=je.exec(O))&&te[1]&&(O=$e(f,k,te),ne="number"),O==null||O!==O)return;ne==="number"&&!ye&&(O+=te&&te[3]||(u.cssNumber[Ee]?"":"px")),!m.clearCloneStyle&&O===""&&k.indexOf("background")===0&&(ke[k]="inherit"),(!le||!("set"in le)||(O=le.set(f,O,j))!==void 0)&&(ye?ke.setProperty(k,O):ke[k]=O)}else return le&&"get"in le&&(te=le.get(f,!1,j))!==void 0?te:ke[k]}},css:function(f,k,O,j){var te,ne,le,Ee=ge(k),ye=mn.test(k);return ye||(k=vn(Ee)),le=u.cssHooks[k]||u.cssHooks[Ee],le&&"get"in le&&(te=le.get(f,!0,O)),te===void 0&&(te=en(f,k,j)),te==="normal"&&k in zn&&(te=zn[k]),O===""||O?(ne=parseFloat(te),O===!0||isFinite(ne)?ne||0:te):te}}),u.each(["height","width"],function(f,k){u.cssHooks[k]={get:function(O,j,te){if(j)return ci.test(u.css(O,"display"))&&(!O.getClientRects().length||!O.getBoundingClientRect().width)?Fn(O,ui,function(){return Hn(O,k,te)}):Hn(O,k,te)},set:function(O,j,te){var ne,le=cn(O),Ee=!m.scrollboxSize()&&le.position==="absolute",ye=Ee||te,ke=ye&&u.css(O,"boxSizing",!1,le)==="border-box",Ne=te?bn(O,k,te,ke,le):0;return ke&&Ee&&(Ne-=Math.ceil(O["offset"+k[0].toUpperCase()+k.slice(1)]-parseFloat(le[k])-bn(O,k,"border",!1,le)-.5)),Ne&&(ne=je.exec(j))&&(ne[3]||"px")!=="px"&&(O.style[k]=j,j=u.css(O,k)),jn(O,j,Ne)}}}),u.cssHooks.marginLeft=On(m.reliableMarginLeft,function(f,k){if(k)return(parseFloat(en(f,"marginLeft"))||f.getBoundingClientRect().left-Fn(f,{marginLeft:0},function(){return f.getBoundingClientRect().left}))+"px"}),u.each({margin:"",padding:"",border:"Width"},function(f,k){u.cssHooks[f+k]={expand:function(O){for(var j=0,te={},ne=typeof O=="string"?O.split(" "):[O];j<4;j++)te[f+W[j]+k]=ne[j]||ne[j-2]||ne[0];return te}},f!=="margin"&&(u.cssHooks[f+k].set=jn)}),u.fn.extend({css:function(f,k){return K(this,function(O,j,te){var ne,le,Ee={},ye=0;if(Array.isArray(j)){for(ne=cn(O),le=j.length;ye<le;ye++)Ee[j[ye]]=u.css(O,j[ye],!1,ne);return Ee}return te!==void 0?u.style(O,j,te):u.css(O,j)},f,k,arguments.length>1)}});function At(f,k,O,j,te){return new At.prototype.init(f,k,O,j,te)}u.Tween=At,At.prototype={constructor:At,init:function(f,k,O,j,te,ne){this.elem=f,this.prop=O,this.easing=te||u.easing._default,this.options=k,this.start=this.now=this.cur(),this.end=j,this.unit=ne||(u.cssNumber[O]?"":"px")},cur:function(){var f=At.propHooks[this.prop];return f&&f.get?f.get(this):At.propHooks._default.get(this)},run:function(f){var k,O=At.propHooks[this.prop];return this.options.duration?this.pos=k=u.easing[this.easing](f,this.options.duration*f,0,1,this.options.duration):this.pos=k=f,this.now=(this.end-this.start)*k+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),O&&O.set?O.set(this):At.propHooks._default.set(this),this}},At.prototype.init.prototype=At.prototype,At.propHooks={_default:{get:function(f){var k;return f.elem.nodeType!==1||f.elem[f.prop]!=null&&f.elem.style[f.prop]==null?f.elem[f.prop]:(k=u.css(f.elem,f.prop,""),!k||k==="auto"?0:k)},set:function(f){u.fx.step[f.prop]?u.fx.step[f.prop](f):f.elem.nodeType===1&&(u.cssHooks[f.prop]||f.elem.style[vn(f.prop)]!=null)?u.style(f.elem,f.prop,f.now+f.unit):f.elem[f.prop]=f.now}}},At.propHooks.scrollTop=At.propHooks.scrollLeft={set:function(f){f.elem.nodeType&&f.elem.parentNode&&(f.elem[f.prop]=f.now)}},u.easing={linear:function(f){return f},swing:function(f){return .5-Math.cos(f*Math.PI)/2},_default:"swing"},u.fx=At.prototype.init,u.fx.step={};var Xt,un,di=/^(?:toggle|show|hide)$/,hi=/queueHooks$/;function yn(){un&&(x.hidden===!1&&n.requestAnimationFrame?n.requestAnimationFrame(yn):n.setTimeout(yn,u.fx.interval),u.fx.tick())}function Wn(){return n.setTimeout(function(){Xt=void 0}),Xt=Date.now()}function dn(f,k){var O,j=0,te={height:f};for(k=k?1:0;j<4;j+=2-k)O=W[j],te["margin"+O]=te["padding"+O]=f;return k&&(te.opacity=te.width=f),te}function qn(f,k,O){for(var j,te=(Pt.tweeners[k]||[]).concat(Pt.tweeners["*"]),ne=0,le=te.length;ne<le;ne++)if(j=te[ne].call(O,k,f))return j}function fi(f,k,O){var j,te,ne,le,Ee,ye,ke,Ne,Oe="width"in k||"height"in k,Pe=this,ze={},at=f.style,ht=f.nodeType&&we(f),ot=Re.get(f,"fxshow");O.queue||(le=u._queueHooks(f,"fx"),le.unqueued==null&&(le.unqueued=0,Ee=le.empty.fire,le.empty.fire=function(){le.unqueued||Ee()}),le.unqueued++,Pe.always(function(){Pe.always(function(){le.unqueued--,u.queue(f,"fx").length||le.empty.fire()})}));for(j in k)if(te=k[j],di.test(te)){if(delete k[j],ne=ne||te==="toggle",te===(ht?"hide":"show"))if(te==="show"&&ot&&ot[j]!==void 0)ht=!0;else continue;ze[j]=ot&&ot[j]||u.style(f,j)}if(ye=!u.isEmptyObject(k),!(!ye&&u.isEmptyObject(ze))){Oe&&f.nodeType===1&&(O.overflow=[at.overflow,at.overflowX,at.overflowY],ke=ot&&ot.display,ke==null&&(ke=Re.get(f,"display")),Ne=u.css(f,"display"),Ne==="none"&&(ke?Ne=ke:(Ae([f],!0),ke=f.style.display||ke,Ne=u.css(f,"display"),Ae([f]))),(Ne==="inline"||Ne==="inline-block"&&ke!=null)&&u.css(f,"float")==="none"&&(ye||(Pe.done(function(){at.display=ke}),ke==null&&(Ne=at.display,ke=Ne==="none"?"":Ne)),at.display="inline-block")),O.overflow&&(at.overflow="hidden",Pe.always(function(){at.overflow=O.overflow[0],at.overflowX=O.overflow[1],at.overflowY=O.overflow[2]})),ye=!1;for(j in ze)ye||(ot?"hidden"in ot&&(ht=ot.hidden):ot=Re.access(f,"fxshow",{display:ke}),ne&&(ot.hidden=!ht),ht&&Ae([f],!0),Pe.done(function(){ht||Ae([f]),Re.remove(f,"fxshow");for(j in ze)u.style(f,j,ze[j])})),ye=qn(ht?ot[j]:0,j,Pe),j in ot||(ot[j]=ye.start,ht&&(ye.end=ye.start,ye.start=0))}}function pi(f,k){var O,j,te,ne,le;for(O in f)if(j=ge(O),te=k[j],ne=f[O],Array.isArray(ne)&&(te=ne[1],ne=f[O]=ne[0]),O!==j&&(f[j]=ne,delete f[O]),le=u.cssHooks[j],le&&"expand"in le){ne=le.expand(ne),delete f[j];for(O in ne)O in f||(f[O]=ne[O],k[O]=te)}else k[j]=te}function Pt(f,k,O){var j,te,ne=0,le=Pt.prefilters.length,Ee=u.Deferred().always(function(){delete ye.elem}),ye=function(){if(te)return!1;for(var Oe=Xt||Wn(),Pe=Math.max(0,ke.startTime+ke.duration-Oe),ze=Pe/ke.duration||0,at=1-ze,ht=0,ot=ke.tweens.length;ht<ot;ht++)ke.tweens[ht].run(at);return Ee.notifyWith(f,[ke,at,Pe]),at<1&&ot?Pe:(ot||Ee.notifyWith(f,[ke,1,0]),Ee.resolveWith(f,[ke]),!1)},ke=Ee.promise({elem:f,props:u.extend({},k),opts:u.extend(!0,{specialEasing:{},easing:u.easing._default},O),originalProperties:k,originalOptions:O,startTime:Xt||Wn(),duration:O.duration,tweens:[],createTween:function(Oe,Pe){var ze=u.Tween(f,ke.opts,Oe,Pe,ke.opts.specialEasing[Oe]||ke.opts.easing);return ke.tweens.push(ze),ze},stop:function(Oe){var Pe=0,ze=Oe?ke.tweens.length:0;if(te)return this;for(te=!0;Pe<ze;Pe++)ke.tweens[Pe].run(1);return Oe?(Ee.notifyWith(f,[ke,1,0]),Ee.resolveWith(f,[ke,Oe])):Ee.rejectWith(f,[ke,Oe]),this}}),Ne=ke.props;for(pi(Ne,ke.opts.specialEasing);ne<le;ne++)if(j=Pt.prefilters[ne].call(ke,f,Ne,ke.opts),j)return A(j.stop)&&(u._queueHooks(ke.elem,ke.opts.queue).stop=j.stop.bind(j)),j;return u.map(Ne,qn,ke),A(ke.opts.start)&&ke.opts.start.call(f,ke),ke.progress(ke.opts.progress).done(ke.opts.done,ke.opts.complete).fail(ke.opts.fail).always(ke.opts.always),u.fx.timer(u.extend(ye,{elem:f,anim:ke,queue:ke.opts.queue})),ke}u.Animation=u.extend(Pt,{tweeners:{"*":[function(f,k){var O=this.createTween(f,k);return $e(O.elem,f,je.exec(k),O),O}]},tweener:function(f,k){A(f)?(k=f,f=["*"]):f=f.match(Y);for(var O,j=0,te=f.length;j<te;j++)O=f[j],Pt.tweeners[O]=Pt.tweeners[O]||[],Pt.tweeners[O].unshift(k)},prefilters:[fi],prefilter:function(f,k){k?Pt.prefilters.unshift(f):Pt.prefilters.push(f)}}),u.speed=function(f,k,O){var j=f&&typeof f=="object"?u.extend({},f):{complete:O||!O&&k||A(f)&&f,duration:f,easing:O&&k||k&&!A(k)&&k};return u.fx.off?j.duration=0:typeof j.duration!="number"&&(j.duration in u.fx.speeds?j.duration=u.fx.speeds[j.duration]:j.duration=u.fx.speeds._default),(j.queue==null||j.queue===!0)&&(j.queue="fx"),j.old=j.complete,j.complete=function(){A(j.old)&&j.old.call(this),j.queue&&u.dequeue(this,j.queue)},j},u.fn.extend({fadeTo:function(f,k,O,j){return this.filter(we).css("opacity",0).show().end().animate({opacity:k},f,O,j)},animate:function(f,k,O,j){var te=u.isEmptyObject(f),ne=u.speed(k,O,j),le=function(){var Ee=Pt(this,u.extend({},f),ne);(te||Re.get(this,"finish"))&&Ee.stop(!0)};return le.finish=le,te||ne.queue===!1?this.each(le):this.queue(ne.queue,le)},stop:function(f,k,O){var j=function(te){var ne=te.stop;delete te.stop,ne(O)};return typeof f!="string"&&(O=k,k=f,f=void 0),k&&this.queue(f||"fx",[]),this.each(function(){var te=!0,ne=f!=null&&f+"queueHooks",le=u.timers,Ee=Re.get(this);if(ne)Ee[ne]&&Ee[ne].stop&&j(Ee[ne]);else for(ne in Ee)Ee[ne]&&Ee[ne].stop&&hi.test(ne)&&j(Ee[ne]);for(ne=le.length;ne--;)le[ne].elem===this&&(f==null||le[ne].queue===f)&&(le[ne].anim.stop(O),te=!1,le.splice(ne,1));(te||!O)&&u.dequeue(this,f)})},finish:function(f){return f!==!1&&(f=f||"fx"),this.each(function(){var k,O=Re.get(this),j=O[f+"queue"],te=O[f+"queueHooks"],ne=u.timers,le=j?j.length:0;for(O.finish=!0,u.queue(this,f,[]),te&&te.stop&&te.stop.call(this,!0),k=ne.length;k--;)ne[k].elem===this&&ne[k].queue===f&&(ne[k].anim.stop(!0),ne.splice(k,1));for(k=0;k<le;k++)j[k]&&j[k].finish&&j[k].finish.call(this);delete O.finish})}}),u.each(["toggle","show","hide"],function(f,k){var O=u.fn[k];u.fn[k]=function(j,te,ne){return j==null||typeof j=="boolean"?O.apply(this,arguments):this.animate(dn(k,!0),j,te,ne)}}),u.each({slideDown:dn("show"),slideUp:dn("hide"),slideToggle:dn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(f,k){u.fn[f]=function(O,j,te){return this.animate(k,O,j,te)}}),u.timers=[],u.fx.tick=function(){var f,k=0,O=u.timers;for(Xt=Date.now();k<O.length;k++)f=O[k],!f()&&O[k]===f&&O.splice(k--,1);O.length||u.fx.stop(),Xt=void 0},u.fx.timer=function(f){u.timers.push(f),u.fx.start()},u.fx.interval=13,u.fx.start=function(){un||(un=!0,yn())},u.fx.stop=function(){un=null},u.fx.speeds={slow:600,fast:200,_default:400},u.fn.delay=function(f,k){return f=u.fx&&u.fx.speeds[f]||f,k=k||"fx",this.queue(k,function(O,j){var te=n.setTimeout(O,f);j.stop=function(){n.clearTimeout(te)}})},function(){var f=x.createElement("input"),k=x.createElement("select"),O=k.appendChild(x.createElement("option"));f.type="checkbox",m.checkOn=f.value!=="",m.optSelected=O.selected,f=x.createElement("input"),f.value="t",f.type="radio",m.radioValue=f.value==="t"}();var Vn,tn=u.expr.attrHandle;u.fn.extend({attr:function(f,k){return K(this,u.attr,f,k,arguments.length>1)},removeAttr:function(f){return this.each(function(){u.removeAttr(this,f)})}}),u.extend({attr:function(f,k,O){var j,te,ne=f.nodeType;if(!(ne===3||ne===8||ne===2)){if(typeof f.getAttribute>"u")return u.prop(f,k,O);if((ne!==1||!u.isXMLDoc(f))&&(te=u.attrHooks[k.toLowerCase()]||(u.expr.match.bool.test(k)?Vn:void 0)),O!==void 0){if(O===null){u.removeAttr(f,k);return}return te&&"set"in te&&(j=te.set(f,O,k))!==void 0?j:(f.setAttribute(k,O+""),O)}return te&&"get"in te&&(j=te.get(f,k))!==null?j:(j=u.find.attr(f,k),j??void 0)}},attrHooks:{type:{set:function(f,k){if(!m.radioValue&&k==="radio"&&S(f,"input")){var O=f.value;return f.setAttribute("type",k),O&&(f.value=O),k}}}},removeAttr:function(f,k){var O,j=0,te=k&&k.match(Y);if(te&&f.nodeType===1)for(;O=te[j++];)f.removeAttribute(O)}}),Vn={set:function(f,k,O){return k===!1?u.removeAttr(f,O):f.setAttribute(O,O),O}},u.each(u.expr.match.bool.source.match(/\w+/g),function(f,k){var O=tn[k]||u.find.attr;tn[k]=function(j,te,ne){var le,Ee,ye=te.toLowerCase();return ne||(Ee=tn[ye],tn[ye]=le,le=O(j,te,ne)!=null?ye:null,tn[ye]=Ee),le}});var gi=/^(?:input|select|textarea|button)$/i,_i=/^(?:a|area)$/i;u.fn.extend({prop:function(f,k){return K(this,u.prop,f,k,arguments.length>1)},removeProp:function(f){return this.each(function(){delete this[u.propFix[f]||f]})}}),u.extend({prop:function(f,k,O){var j,te,ne=f.nodeType;if(!(ne===3||ne===8||ne===2))return(ne!==1||!u.isXMLDoc(f))&&(k=u.propFix[k]||k,te=u.propHooks[k]),O!==void 0?te&&"set"in te&&(j=te.set(f,O,k))!==void 0?j:f[k]=O:te&&"get"in te&&(j=te.get(f,k))!==null?j:f[k]},propHooks:{tabIndex:{get:function(f){var k=u.find.attr(f,"tabindex");return k?parseInt(k,10):gi.test(f.nodeName)||_i.test(f.nodeName)&&f.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(u.propHooks.selected={get:function(f){var k=f.parentNode;return k&&k.parentNode&&k.parentNode.selectedIndex,null},set:function(f){var k=f.parentNode;k&&(k.selectedIndex,k.parentNode&&k.parentNode.selectedIndex)}}),u.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){u.propFix[this.toLowerCase()]=this});function Wt(f){var k=f.match(Y)||[];return k.join(" ")}function qt(f){return f.getAttribute&&f.getAttribute("class")||""}function wn(f){return Array.isArray(f)?f:typeof f=="string"?f.match(Y)||[]:[]}u.fn.extend({addClass:function(f){var k,O,j,te,ne,le;return A(f)?this.each(function(Ee){u(this).addClass(f.call(this,Ee,qt(this)))}):(k=wn(f),k.length?this.each(function(){if(j=qt(this),O=this.nodeType===1&&" "+Wt(j)+" ",O){for(ne=0;ne<k.length;ne++)te=k[ne],O.indexOf(" "+te+" ")<0&&(O+=te+" ");le=Wt(O),j!==le&&this.setAttribute("class",le)}}):this)},removeClass:function(f){var k,O,j,te,ne,le;return A(f)?this.each(function(Ee){u(this).removeClass(f.call(this,Ee,qt(this)))}):arguments.length?(k=wn(f),k.length?this.each(function(){if(j=qt(this),O=this.nodeType===1&&" "+Wt(j)+" ",O){for(ne=0;ne<k.length;ne++)for(te=k[ne];O.indexOf(" "+te+" ")>-1;)O=O.replace(" "+te+" "," ");le=Wt(O),j!==le&&this.setAttribute("class",le)}}):this):this.attr("class","")},toggleClass:function(f,k){var O,j,te,ne,le=typeof f,Ee=le==="string"||Array.isArray(f);return A(f)?this.each(function(ye){u(this).toggleClass(f.call(this,ye,qt(this),k),k)}):typeof k=="boolean"&&Ee?k?this.addClass(f):this.removeClass(f):(O=wn(f),this.each(function(){if(Ee)for(ne=u(this),te=0;te<O.length;te++)j=O[te],ne.hasClass(j)?ne.removeClass(j):ne.addClass(j);else(f===void 0||le==="boolean")&&(j=qt(this),j&&Re.set(this,"__className__",j),this.setAttribute&&this.setAttribute("class",j||f===!1?"":Re.get(this,"__className__")||""))}))},hasClass:function(f){var k,O,j=0;for(k=" "+f+" ";O=this[j++];)if(O.nodeType===1&&(" "+Wt(qt(O))+" ").indexOf(k)>-1)return!0;return!1}});var mi=/\r/g;u.fn.extend({val:function(f){var k,O,j,te=this[0];return arguments.length?(j=A(f),this.each(function(ne){var le;this.nodeType===1&&(j?le=f.call(this,ne,u(this).val()):le=f,le==null?le="":typeof le=="number"?le+="":Array.isArray(le)&&(le=u.map(le,function(Ee){return Ee==null?"":Ee+""})),k=u.valHooks[this.type]||u.valHooks[this.nodeName.toLowerCase()],(!k||!("set"in k)||k.set(this,le,"value")===void 0)&&(this.value=le))})):te?(k=u.valHooks[te.type]||u.valHooks[te.nodeName.toLowerCase()],k&&"get"in k&&(O=k.get(te,"value"))!==void 0?O:(O=te.value,typeof O=="string"?O.replace(mi,""):O??"")):void 0}}),u.extend({valHooks:{option:{get:function(f){var k=u.find.attr(f,"value");return k??Wt(u.text(f))}},select:{get:function(f){var k,O,j,te=f.options,ne=f.selectedIndex,le=f.type==="select-one",Ee=le?null:[],ye=le?ne+1:te.length;for(ne<0?j=ye:j=le?ne:0;j<ye;j++)if(O=te[j],(O.selected||j===ne)&&!O.disabled&&(!O.parentNode.disabled||!S(O.parentNode,"optgroup"))){if(k=u(O).val(),le)return k;Ee.push(k)}return Ee},set:function(f,k){for(var O,j,te=f.options,ne=u.makeArray(k),le=te.length;le--;)j=te[le],(j.selected=u.inArray(u.valHooks.option.get(j),ne)>-1)&&(O=!0);return O||(f.selectedIndex=-1),ne}}}}),u.each(["radio","checkbox"],function(){u.valHooks[this]={set:function(f,k){if(Array.isArray(k))return f.checked=u.inArray(u(f).val(),k)>-1}},m.checkOn||(u.valHooks[this].get=function(f){return f.getAttribute("value")===null?"on":f.value})});var nn=n.location,Kn={guid:Date.now()},xn=/\?/;u.parseXML=function(f){var k,O;if(!f||typeof f!="string")return null;try{k=new n.DOMParser().parseFromString(f,"text/xml")}catch{}return O=k&&k.getElementsByTagName("parsererror")[0],(!k||O)&&u.error("Invalid XML: "+(O?u.map(O.childNodes,function(j){return j.textContent}).join(`
`):f)),k};var Yn=/^(?:focusinfocus|focusoutblur)$/,Xn=function(f){f.stopPropagation()};u.extend(u.event,{trigger:function(f,k,O,j){var te,ne,le,Ee,ye,ke,Ne,Oe,Pe=[O||x],ze=h.call(f,"type")?f.type:f,at=h.call(f,"namespace")?f.namespace.split("."):[];if(ne=Oe=le=O=O||x,!(O.nodeType===3||O.nodeType===8)&&!Yn.test(ze+u.event.triggered)&&(ze.indexOf(".")>-1&&(at=ze.split("."),ze=at.shift(),at.sort()),ye=ze.indexOf(":")<0&&"on"+ze,f=f[u.expando]?f:new u.Event(ze,typeof f=="object"&&f),f.isTrigger=j?2:3,f.namespace=at.join("."),f.rnamespace=f.namespace?new RegExp("(^|\\.)"+at.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,f.result=void 0,f.target||(f.target=O),k=k==null?[f]:u.makeArray(k,[f]),Ne=u.event.special[ze]||{},!(!j&&Ne.trigger&&Ne.trigger.apply(O,k)===!1))){if(!j&&!Ne.noBubble&&!y(O)){for(Ee=Ne.delegateType||ze,Yn.test(Ee+ze)||(ne=ne.parentNode);ne;ne=ne.parentNode)Pe.push(ne),le=ne;le===(O.ownerDocument||x)&&Pe.push(le.defaultView||le.parentWindow||n)}for(te=0;(ne=Pe[te++])&&!f.isPropagationStopped();)Oe=ne,f.type=te>1?Ee:Ne.bindType||ze,ke=(Re.get(ne,"events")||Object.create(null))[f.type]&&Re.get(ne,"handle"),ke&&ke.apply(ne,k),ke=ye&&ne[ye],ke&&ke.apply&&Se(ne)&&(f.result=ke.apply(ne,k),f.result===!1&&f.preventDefault());return f.type=ze,!j&&!f.isDefaultPrevented()&&(!Ne._default||Ne._default.apply(Pe.pop(),k)===!1)&&Se(O)&&ye&&A(O[ze])&&!y(O)&&(le=O[ye],le&&(O[ye]=null),u.event.triggered=ze,f.isPropagationStopped()&&Oe.addEventListener(ze,Xn),O[ze](),f.isPropagationStopped()&&Oe.removeEventListener(ze,Xn),u.event.triggered=void 0,le&&(O[ye]=le)),f.result}},simulate:function(f,k,O){var j=u.extend(new u.Event,O,{type:f,isSimulated:!0});u.event.trigger(j,null,k)}}),u.fn.extend({trigger:function(f,k){return this.each(function(){u.event.trigger(f,k,this)})},triggerHandler:function(f,k){var O=this[0];if(O)return u.event.trigger(f,k,O,!0)}});var vi=/\[\]$/,Jn=/\r?\n/g,bi=/^(?:submit|button|image|reset|file)$/i,yi=/^(?:input|select|textarea|keygen)/i;function En(f,k,O,j){var te;if(Array.isArray(k))u.each(k,function(ne,le){O||vi.test(f)?j(f,le):En(f+"["+(typeof le=="object"&&le!=null?ne:"")+"]",le,O,j)});else if(!O&&T(k)==="object")for(te in k)En(f+"["+te+"]",k[te],O,j);else j(f,k)}u.param=function(f,k){var O,j=[],te=function(ne,le){var Ee=A(le)?le():le;j[j.length]=encodeURIComponent(ne)+"="+encodeURIComponent(Ee??"")};if(f==null)return"";if(Array.isArray(f)||f.jquery&&!u.isPlainObject(f))u.each(f,function(){te(this.name,this.value)});else for(O in f)En(O,f[O],k,te);return j.join("&")},u.fn.extend({serialize:function(){return u.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var f=u.prop(this,"elements");return f?u.makeArray(f):this}).filter(function(){var f=this.type;return this.name&&!u(this).is(":disabled")&&yi.test(this.nodeName)&&!bi.test(f)&&(this.checked||!De.test(f))}).map(function(f,k){var O=u(this).val();return O==null?null:Array.isArray(O)?u.map(O,function(j){return{name:k.name,value:j.replace(Jn,`\r
`)}}):{name:k.name,value:O.replace(Jn,`\r
`)}}).get()}});var wi=/%20/g,xi=/#.*$/,Ei=/([?&])_=[^&]*/,Ai=/^(.*?):[ \t]*([^\r\n]*)$/mg,Si=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ci=/^(?:GET|HEAD)$/,Ti=/^\/\//,Zn={},An={},Qn="*/".concat("*"),Sn=x.createElement("a");Sn.href=nn.href;function ei(f){return function(k,O){typeof k!="string"&&(O=k,k="*");var j,te=0,ne=k.toLowerCase().match(Y)||[];if(A(O))for(;j=ne[te++];)j[0]==="+"?(j=j.slice(1)||"*",(f[j]=f[j]||[]).unshift(O)):(f[j]=f[j]||[]).push(O)}}function ti(f,k,O,j){var te={},ne=f===An;function le(Ee){var ye;return te[Ee]=!0,u.each(f[Ee]||[],function(ke,Ne){var Oe=Ne(k,O,j);if(typeof Oe=="string"&&!ne&&!te[Oe])return k.dataTypes.unshift(Oe),le(Oe),!1;if(ne)return!(ye=Oe)}),ye}return le(k.dataTypes[0])||!te["*"]&&le("*")}function Cn(f,k){var O,j,te=u.ajaxSettings.flatOptions||{};for(O in k)k[O]!==void 0&&((te[O]?f:j||(j={}))[O]=k[O]);return j&&u.extend(!0,f,j),f}function ki(f,k,O){for(var j,te,ne,le,Ee=f.contents,ye=f.dataTypes;ye[0]==="*";)ye.shift(),j===void 0&&(j=f.mimeType||k.getResponseHeader("Content-Type"));if(j){for(te in Ee)if(Ee[te]&&Ee[te].test(j)){ye.unshift(te);break}}if(ye[0]in O)ne=ye[0];else{for(te in O){if(!ye[0]||f.converters[te+" "+ye[0]]){ne=te;break}le||(le=te)}ne=ne||le}if(ne)return ne!==ye[0]&&ye.unshift(ne),O[ne]}function Mi(f,k,O,j){var te,ne,le,Ee,ye,ke={},Ne=f.dataTypes.slice();if(Ne[1])for(le in f.converters)ke[le.toLowerCase()]=f.converters[le];for(ne=Ne.shift();ne;)if(f.responseFields[ne]&&(O[f.responseFields[ne]]=k),!ye&&j&&f.dataFilter&&(k=f.dataFilter(k,f.dataType)),ye=ne,ne=Ne.shift(),ne){if(ne==="*")ne=ye;else if(ye!=="*"&&ye!==ne){if(le=ke[ye+" "+ne]||ke["* "+ne],!le){for(te in ke)if(Ee=te.split(" "),Ee[1]===ne&&(le=ke[ye+" "+Ee[0]]||ke["* "+Ee[0]],le)){le===!0?le=ke[te]:ke[te]!==!0&&(ne=Ee[0],Ne.unshift(Ee[1]));break}}if(le!==!0)if(le&&f.throws)k=le(k);else try{k=le(k)}catch(Oe){return{state:"parsererror",error:le?Oe:"No conversion from "+ye+" to "+ne}}}}return{state:"success",data:k}}u.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:nn.href,type:"GET",isLocal:Si.test(nn.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Qn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":u.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(f,k){return k?Cn(Cn(f,u.ajaxSettings),k):Cn(u.ajaxSettings,f)},ajaxPrefilter:ei(Zn),ajaxTransport:ei(An),ajax:function(f,k){typeof f=="object"&&(k=f,f=void 0),k=k||{};var O,j,te,ne,le,Ee,ye,ke,Ne,Oe,Pe=u.ajaxSetup({},k),ze=Pe.context||Pe,at=Pe.context&&(ze.nodeType||ze.jquery)?u(ze):u.event,ht=u.Deferred(),ot=u.Callbacks("once memory"),wt=Pe.statusCode||{},yt={},Lt={},It="canceled",dt={readyState:0,getResponseHeader:function(ft){var bt;if(ye){if(!ne)for(ne={};bt=Ai.exec(te);)ne[bt[1].toLowerCase()+" "]=(ne[bt[1].toLowerCase()+" "]||[]).concat(bt[2]);bt=ne[ft.toLowerCase()+" "]}return bt==null?null:bt.join(", ")},getAllResponseHeaders:function(){return ye?te:null},setRequestHeader:function(ft,bt){return ye==null&&(ft=Lt[ft.toLowerCase()]=Lt[ft.toLowerCase()]||ft,yt[ft]=bt),this},overrideMimeType:function(ft){return ye==null&&(Pe.mimeType=ft),this},statusCode:function(ft){var bt;if(ft)if(ye)dt.always(ft[dt.status]);else for(bt in ft)wt[bt]=[wt[bt],ft[bt]];return this},abort:function(ft){var bt=ft||It;return O&&O.abort(bt),Vt(0,bt),this}};if(ht.promise(dt),Pe.url=((f||Pe.url||nn.href)+"").replace(Ti,nn.protocol+"//"),Pe.type=k.method||k.type||Pe.method||Pe.type,Pe.dataTypes=(Pe.dataType||"*").toLowerCase().match(Y)||[""],Pe.crossDomain==null){Ee=x.createElement("a");try{Ee.href=Pe.url,Ee.href=Ee.href,Pe.crossDomain=Sn.protocol+"//"+Sn.host!=Ee.protocol+"//"+Ee.host}catch{Pe.crossDomain=!0}}if(Pe.data&&Pe.processData&&typeof Pe.data!="string"&&(Pe.data=u.param(Pe.data,Pe.traditional)),ti(Zn,Pe,k,dt),ye)return dt;ke=u.event&&Pe.global,ke&&u.active++===0&&u.event.trigger("ajaxStart"),Pe.type=Pe.type.toUpperCase(),Pe.hasContent=!Ci.test(Pe.type),j=Pe.url.replace(xi,""),Pe.hasContent?Pe.data&&Pe.processData&&(Pe.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(Pe.data=Pe.data.replace(wi,"+")):(Oe=Pe.url.slice(j.length),Pe.data&&(Pe.processData||typeof Pe.data=="string")&&(j+=(xn.test(j)?"&":"?")+Pe.data,delete Pe.data),Pe.cache===!1&&(j=j.replace(Ei,"$1"),Oe=(xn.test(j)?"&":"?")+"_="+Kn.guid+++Oe),Pe.url=j+Oe),Pe.ifModified&&(u.lastModified[j]&&dt.setRequestHeader("If-Modified-Since",u.lastModified[j]),u.etag[j]&&dt.setRequestHeader("If-None-Match",u.etag[j])),(Pe.data&&Pe.hasContent&&Pe.contentType!==!1||k.contentType)&&dt.setRequestHeader("Content-Type",Pe.contentType),dt.setRequestHeader("Accept",Pe.dataTypes[0]&&Pe.accepts[Pe.dataTypes[0]]?Pe.accepts[Pe.dataTypes[0]]+(Pe.dataTypes[0]!=="*"?", "+Qn+"; q=0.01":""):Pe.accepts["*"]);for(Ne in Pe.headers)dt.setRequestHeader(Ne,Pe.headers[Ne]);if(Pe.beforeSend&&(Pe.beforeSend.call(ze,dt,Pe)===!1||ye))return dt.abort();if(It="abort",ot.add(Pe.complete),dt.done(Pe.success),dt.fail(Pe.error),O=ti(An,Pe,k,dt),!O)Vt(-1,"No Transport");else{if(dt.readyState=1,ke&&at.trigger("ajaxSend",[dt,Pe]),ye)return dt;Pe.async&&Pe.timeout>0&&(le=n.setTimeout(function(){dt.abort("timeout")},Pe.timeout));try{ye=!1,O.send(yt,Vt)}catch(ft){if(ye)throw ft;Vt(-1,ft)}}function Vt(ft,bt,an,kn){var Nt,sn,Dt,zt,jt,Tt=bt;ye||(ye=!0,le&&n.clearTimeout(le),O=void 0,te=kn||"",dt.readyState=ft>0?4:0,Nt=ft>=200&&ft<300||ft===304,an&&(zt=ki(Pe,dt,an)),!Nt&&u.inArray("script",Pe.dataTypes)>-1&&u.inArray("json",Pe.dataTypes)<0&&(Pe.converters["text script"]=function(){}),zt=Mi(Pe,zt,dt,Nt),Nt?(Pe.ifModified&&(jt=dt.getResponseHeader("Last-Modified"),jt&&(u.lastModified[j]=jt),jt=dt.getResponseHeader("etag"),jt&&(u.etag[j]=jt)),ft===204||Pe.type==="HEAD"?Tt="nocontent":ft===304?Tt="notmodified":(Tt=zt.state,sn=zt.data,Dt=zt.error,Nt=!Dt)):(Dt=Tt,(ft||!Tt)&&(Tt="error",ft<0&&(ft=0))),dt.status=ft,dt.statusText=(bt||Tt)+"",Nt?ht.resolveWith(ze,[sn,Tt,dt]):ht.rejectWith(ze,[dt,Tt,Dt]),dt.statusCode(wt),wt=void 0,ke&&at.trigger(Nt?"ajaxSuccess":"ajaxError",[dt,Pe,Nt?sn:Dt]),ot.fireWith(ze,[dt,Tt]),ke&&(at.trigger("ajaxComplete",[dt,Pe]),--u.active||u.event.trigger("ajaxStop")))}return dt},getJSON:function(f,k,O){return u.get(f,k,O,"json")},getScript:function(f,k){return u.get(f,void 0,k,"script")}}),u.each(["get","post"],function(f,k){u[k]=function(O,j,te,ne){return A(j)&&(ne=ne||te,te=j,j=void 0),u.ajax(u.extend({url:O,type:k,dataType:ne,data:j,success:te},u.isPlainObject(O)&&O))}}),u.ajaxPrefilter(function(f){var k;for(k in f.headers)k.toLowerCase()==="content-type"&&(f.contentType=f.headers[k]||"")}),u._evalUrl=function(f,k,O){return u.ajax({url:f,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(j){u.globalEval(j,k,O)}})},u.fn.extend({wrapAll:function(f){var k;return this[0]&&(A(f)&&(f=f.call(this[0])),k=u(f,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&k.insertBefore(this[0]),k.map(function(){for(var O=this;O.firstElementChild;)O=O.firstElementChild;return O}).append(this)),this},wrapInner:function(f){return A(f)?this.each(function(k){u(this).wrapInner(f.call(this,k))}):this.each(function(){var k=u(this),O=k.contents();O.length?O.wrapAll(f):k.append(f)})},wrap:function(f){var k=A(f);return this.each(function(O){u(this).wrapAll(k?f.call(this,O):f)})},unwrap:function(f){return this.parent(f).not("body").each(function(){u(this).replaceWith(this.childNodes)}),this}}),u.expr.pseudos.hidden=function(f){return!u.expr.pseudos.visible(f)},u.expr.pseudos.visible=function(f){return!!(f.offsetWidth||f.offsetHeight||f.getClientRects().length)},u.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch{}};var Pi={0:200,1223:204},rn=u.ajaxSettings.xhr();m.cors=!!rn&&"withCredentials"in rn,m.ajax=rn=!!rn,u.ajaxTransport(function(f){var k,O;if(m.cors||rn&&!f.crossDomain)return{send:function(j,te){var ne,le=f.xhr();if(le.open(f.type,f.url,f.async,f.username,f.password),f.xhrFields)for(ne in f.xhrFields)le[ne]=f.xhrFields[ne];f.mimeType&&le.overrideMimeType&&le.overrideMimeType(f.mimeType),!f.crossDomain&&!j["X-Requested-With"]&&(j["X-Requested-With"]="XMLHttpRequest");for(ne in j)le.setRequestHeader(ne,j[ne]);k=function(Ee){return function(){k&&(k=O=le.onload=le.onerror=le.onabort=le.ontimeout=le.onreadystatechange=null,Ee==="abort"?le.abort():Ee==="error"?typeof le.status!="number"?te(0,"error"):te(le.status,le.statusText):te(Pi[le.status]||le.status,le.statusText,(le.responseType||"text")!=="text"||typeof le.responseText!="string"?{binary:le.response}:{text:le.responseText},le.getAllResponseHeaders()))}},le.onload=k(),O=le.onerror=le.ontimeout=k("error"),le.onabort!==void 0?le.onabort=O:le.onreadystatechange=function(){le.readyState===4&&n.setTimeout(function(){k&&O()})},k=k("abort");try{le.send(f.hasContent&&f.data||null)}catch(Ee){if(k)throw Ee}},abort:function(){k&&k()}}}),u.ajaxPrefilter(function(f){f.crossDomain&&(f.contents.script=!1)}),u.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(f){return u.globalEval(f),f}}}),u.ajaxPrefilter("script",function(f){f.cache===void 0&&(f.cache=!1),f.crossDomain&&(f.type="GET")}),u.ajaxTransport("script",function(f){if(f.crossDomain||f.scriptAttrs){var k,O;return{send:function(j,te){k=u("<script>").attr(f.scriptAttrs||{}).prop({charset:f.scriptCharset,src:f.url}).on("load error",O=function(ne){k.remove(),O=null,ne&&te(ne.type==="error"?404:200,ne.type)}),x.head.appendChild(k[0])},abort:function(){O&&O()}}}});var ni=[],Tn=/(=)\?(?=&|$)|\?\?/;u.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var f=ni.pop()||u.expando+"_"+Kn.guid++;return this[f]=!0,f}}),u.ajaxPrefilter("json jsonp",function(f,k,O){var j,te,ne,le=f.jsonp!==!1&&(Tn.test(f.url)?"url":typeof f.data=="string"&&(f.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Tn.test(f.data)&&"data");if(le||f.dataTypes[0]==="jsonp")return j=f.jsonpCallback=A(f.jsonpCallback)?f.jsonpCallback():f.jsonpCallback,le?f[le]=f[le].replace(Tn,"$1"+j):f.jsonp!==!1&&(f.url+=(xn.test(f.url)?"&":"?")+f.jsonp+"="+j),f.converters["script json"]=function(){return ne||u.error(j+" was not called"),ne[0]},f.dataTypes[0]="json",te=n[j],n[j]=function(){ne=arguments},O.always(function(){te===void 0?u(n).removeProp(j):n[j]=te,f[j]&&(f.jsonpCallback=k.jsonpCallback,ni.push(j)),ne&&A(te)&&te(ne[0]),ne=te=void 0}),"script"}),m.createHTMLDocument=function(){var f=x.implementation.createHTMLDocument("").body;return f.innerHTML="<form></form><form></form>",f.childNodes.length===2}(),u.parseHTML=function(f,k,O){if(typeof f!="string")return[];typeof k=="boolean"&&(O=k,k=!1);var j,te,ne;return k||(m.createHTMLDocument?(k=x.implementation.createHTMLDocument(""),j=k.createElement("base"),j.href=x.location.href,k.head.appendChild(j)):k=x),te=V.exec(f),ne=!O&&[],te?[k.createElement(te[1])]:(te=nt([f],k,ne),ne&&ne.length&&u(ne).remove(),u.merge([],te.childNodes))},u.fn.load=function(f,k,O){var j,te,ne,le=this,Ee=f.indexOf(" ");return Ee>-1&&(j=Wt(f.slice(Ee)),f=f.slice(0,Ee)),A(k)?(O=k,k=void 0):k&&typeof k=="object"&&(te="POST"),le.length>0&&u.ajax({url:f,type:te||"GET",dataType:"html",data:k}).done(function(ye){ne=arguments,le.html(j?u("<div>").append(u.parseHTML(ye)).find(j):ye)}).always(O&&function(ye,ke){le.each(function(){O.apply(this,ne||[ye.responseText,ke,ye])})}),this},u.expr.pseudos.animated=function(f){return u.grep(u.timers,function(k){return f===k.elem}).length},u.offset={setOffset:function(f,k,O){var j,te,ne,le,Ee,ye,ke,Ne=u.css(f,"position"),Oe=u(f),Pe={};Ne==="static"&&(f.style.position="relative"),Ee=Oe.offset(),ne=u.css(f,"top"),ye=u.css(f,"left"),ke=(Ne==="absolute"||Ne==="fixed")&&(ne+ye).indexOf("auto")>-1,ke?(j=Oe.position(),le=j.top,te=j.left):(le=parseFloat(ne)||0,te=parseFloat(ye)||0),A(k)&&(k=k.call(f,O,u.extend({},Ee))),k.top!=null&&(Pe.top=k.top-Ee.top+le),k.left!=null&&(Pe.left=k.left-Ee.left+te),"using"in k?k.using.call(f,Pe):Oe.css(Pe)}},u.fn.extend({offset:function(f){if(arguments.length)return f===void 0?this:this.each(function(te){u.offset.setOffset(this,f,te)});var k,O,j=this[0];if(j)return j.getClientRects().length?(k=j.getBoundingClientRect(),O=j.ownerDocument.defaultView,{top:k.top+O.pageYOffset,left:k.left+O.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var f,k,O,j=this[0],te={top:0,left:0};if(u.css(j,"position")==="fixed")k=j.getBoundingClientRect();else{for(k=this.offset(),O=j.ownerDocument,f=j.offsetParent||O.documentElement;f&&(f===O.body||f===O.documentElement)&&u.css(f,"position")==="static";)f=f.parentNode;f&&f!==j&&f.nodeType===1&&(te=u(f).offset(),te.top+=u.css(f,"borderTopWidth",!0),te.left+=u.css(f,"borderLeftWidth",!0))}return{top:k.top-te.top-u.css(j,"marginTop",!0),left:k.left-te.left-u.css(j,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var f=this.offsetParent;f&&u.css(f,"position")==="static";)f=f.offsetParent;return f||re})}}),u.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(f,k){var O=k==="pageYOffset";u.fn[f]=function(j){return K(this,function(te,ne,le){var Ee;if(y(te)?Ee=te:te.nodeType===9&&(Ee=te.defaultView),le===void 0)return Ee?Ee[k]:te[ne];Ee?Ee.scrollTo(O?Ee.pageXOffset:le,O?le:Ee.pageYOffset):te[ne]=le},f,j,arguments.length)}}),u.each(["top","left"],function(f,k){u.cssHooks[k]=On(m.pixelPosition,function(O,j){if(j)return j=en(O,k),_n.test(j)?u(O).position()[k]+"px":j})}),u.each({Height:"height",Width:"width"},function(f,k){u.each({padding:"inner"+f,content:k,"":"outer"+f},function(O,j){u.fn[j]=function(te,ne){var le=arguments.length&&(O||typeof te!="boolean"),Ee=O||(te===!0||ne===!0?"margin":"border");return K(this,function(ye,ke,Ne){var Oe;return y(ye)?j.indexOf("outer")===0?ye["inner"+f]:ye.document.documentElement["client"+f]:ye.nodeType===9?(Oe=ye.documentElement,Math.max(ye.body["scroll"+f],Oe["scroll"+f],ye.body["offset"+f],Oe["offset"+f],Oe["client"+f])):Ne===void 0?u.css(ye,ke,Ee):u.style(ye,ke,Ne,Ee)},k,le?te:void 0,le)}})}),u.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(f,k){u.fn[k]=function(O){return this.on(k,O)}}),u.fn.extend({bind:function(f,k,O){return this.on(f,null,k,O)},unbind:function(f,k){return this.off(f,null,k)},delegate:function(f,k,O,j){return this.on(k,f,O,j)},undelegate:function(f,k,O){return arguments.length===1?this.off(f,"**"):this.off(k,f||"**",O)},hover:function(f,k){return this.on("mouseenter",f).on("mouseleave",k||f)}}),u.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(f,k){u.fn[k]=function(O,j){return arguments.length>0?this.on(k,null,O,j):this.trigger(k)}});var $i=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;u.proxy=function(f,k){var O,j,te;if(typeof k=="string"&&(O=f[k],k=f,f=O),!!A(f))return j=a.call(arguments,2),te=function(){return f.apply(k||this,j.concat(a.call(arguments)))},te.guid=f.guid=f.guid||u.guid++,te},u.holdReady=function(f){f?u.readyWait++:u.ready(!0)},u.isArray=Array.isArray,u.parseJSON=JSON.parse,u.nodeName=S,u.isFunction=A,u.isWindow=y,u.camelCase=ge,u.type=T,u.now=Date.now,u.isNumeric=function(f){var k=u.type(f);return(k==="number"||k==="string")&&!isNaN(f-parseFloat(f))},u.trim=function(f){return f==null?"":(f+"").replace($i,"$1")};var Ri=n.jQuery,Li=n.$;return u.noConflict=function(f){return n.$===u&&(n.$=Li),f&&n.jQuery===u&&(n.jQuery=Ri),u},typeof s>"u"&&(n.jQuery=n.$=u),u})})(jquery);var jqueryExports=jquery.exports;const $=getDefaultExportFromCjs(jqueryExports);console.log("JS ì¤í:","error-handling-basic.js");var isIE=/MSIE \d|Trident.*rv:/.test(navigator.userAgent);window.onerror=function(t,n,s,e,c){if(isIE)return!1;var a=t.toLowerCase(),i="script error";return a.indexOf(i)>-1?alert("Script Error: See Browser Console for Detail"):console.error("Internal application error: "+t+`

URL: `+n+`
Line: `+s+`
Column: `+e),!1};window.onunhandledrejection=function(t){if(isIE)return!1;alert("Unhandled Rejection: "+t.reason)};if(isIE)var html='<style>	body { text-align: center; font-family: sans-serif; }	hr { width: 180px; }	.logo { position: relative; top: 3px; }</style><div className="not-supported">	<h1><img src="images/icons/32x32.png" class="logo"> JS Paint</h1>	<h2>Internet Explorer is not supported!</h2>	<p className="not-supported-details">		Try 		<a href="https://www.mozilla.org/firefox/">Firefox</a>, 		<a href="https://www.google.com/chrome/">Chrome</a>, 		or 		<a href="https://www.microsoft.com/edge/">Edge</a>.	</p>	<hr>	<p>		<a href="about.html">More about JS Paint</a>	</p></div>',interval=setInterval(function(){document.body&&(clearInterval(interval),document.body.innerHTML=html)},100);(function(t){if(typeof exports=="object"&&typeof module<"u")module.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var n;typeof window<"u"?n=window:typeof global<"u"?n=global:typeof self<"u"?n=self:n=this,n.GIF=t()}})(function(){return function(){function t(n,s,e){function c(o,l){if(!s[o]){if(!n[o]){var r=typeof require=="function"&&require;if(!l&&r)return r(o,!0);if(a)return a(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var h=s[o]={exports:{}};n[o][0].call(h.exports,function(v){var p=n[o][1][v];return c(p||v)},h,h.exports,t,n,s,e)}return s[o].exports}for(var a=typeof require=="function"&&require,i=0;i<e.length;i++)c(e[i]);return c}return t}()({1:[function(t,n,s){function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}n.exports=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(l){if(!a(l)||l<0||isNaN(l))throw TypeError("n must be a positive number");return this._maxListeners=l,this},e.prototype.emit=function(l){var r,d,h,v,p,m;if(this._events||(this._events={}),l==="error"&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(r=arguments[1],r instanceof Error)throw r;var A=new Error('Uncaught, unspecified "error" event. ('+r+")");throw A.context=r,A}if(d=this._events[l],o(d))return!1;if(c(d))switch(arguments.length){case 1:d.call(this);break;case 2:d.call(this,arguments[1]);break;case 3:d.call(this,arguments[1],arguments[2]);break;default:v=Array.prototype.slice.call(arguments,1),d.apply(this,v)}else if(i(d))for(v=Array.prototype.slice.call(arguments,1),m=d.slice(),h=m.length,p=0;p<h;p++)m[p].apply(this,v);return!0},e.prototype.addListener=function(l,r){var d;if(!c(r))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",l,c(r.listener)?r.listener:r),this._events[l]?i(this._events[l])?this._events[l].push(r):this._events[l]=[this._events[l],r]:this._events[l]=r,i(this._events[l])&&!this._events[l].warned&&(o(this._maxListeners)?d=e.defaultMaxListeners:d=this._maxListeners,d&&d>0&&this._events[l].length>d&&(this._events[l].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[l].length),typeof console.trace=="function"&&console.trace())),this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(l,r){if(!c(r))throw TypeError("listener must be a function");var d=!1;function h(){this.removeListener(l,h),d||(d=!0,r.apply(this,arguments))}return h.listener=r,this.on(l,h),this},e.prototype.removeListener=function(l,r){var d,h,v,p;if(!c(r))throw TypeError("listener must be a function");if(!this._events||!this._events[l])return this;if(d=this._events[l],v=d.length,h=-1,d===r||c(d.listener)&&d.listener===r)delete this._events[l],this._events.removeListener&&this.emit("removeListener",l,r);else if(i(d)){for(p=v;p-- >0;)if(d[p]===r||d[p].listener&&d[p].listener===r){h=p;break}if(h<0)return this;d.length===1?(d.length=0,delete this._events[l]):d.splice(h,1),this._events.removeListener&&this.emit("removeListener",l,r)}return this},e.prototype.removeAllListeners=function(l){var r,d;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[l]&&delete this._events[l],this;if(arguments.length===0){for(r in this._events)r!=="removeListener"&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events={},this}if(d=this._events[l],c(d))this.removeListener(l,d);else if(d)for(;d.length;)this.removeListener(l,d[d.length-1]);return delete this._events[l],this},e.prototype.listeners=function(l){var r;return!this._events||!this._events[l]?r=[]:c(this._events[l])?r=[this._events[l]]:r=this._events[l].slice(),r},e.prototype.listenerCount=function(l){if(this._events){var r=this._events[l];if(c(r))return 1;if(r)return r.length}return 0},e.listenerCount=function(l,r){return l.listenerCount(r)};function c(l){return typeof l=="function"}function a(l){return typeof l=="number"}function i(l){return typeof l=="object"&&l!==null}function o(l){return l===void 0}},{}],2:[function(t,n,s){var e,c,a,i,o;o=navigator.userAgent.toLowerCase(),i=navigator.platform.toLowerCase(),e=o.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],a=e[1]==="ie"&&document.documentMode,c={name:e[1]==="version"?e[3]:e[1],version:a||parseFloat(e[1]==="opera"&&e[4]?e[4]:e[2]),platform:{name:o.match(/ip(?:ad|od|hone)/)?"ios":(o.match(/(?:webos|android)/)||i.match(/mac|win|linux/)||["other"])[0]}},c[c.name]=!0,c[c.name+parseInt(c.version,10)]=!0,c.platform[c.platform.name]=!0,n.exports=c},{}],3:[function(t,n,s){var e,c,a,i=function(d,h){for(var v in h)o.call(h,v)&&(d[v]=h[v]);function p(){this.constructor=d}return p.prototype=h.prototype,d.prototype=new p,d.__super__=h.prototype,d},o={}.hasOwnProperty,l=[].indexOf||function(d){for(var h=0,v=this.length;h<v;h++)if(h in this&&this[h]===d)return h;return-1},r=[].slice;e=t("events").EventEmitter,a=t("./browser.coffee"),c=function(d){var h,v;i(p,d),h={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},v={delay:500,copy:!1,dispose:-1};function p(m){var A,y,x;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(m);for(y in h)x=h[y],(A=this.options)[y]==null&&(A[y]=x)}return p.prototype.setOption=function(m,A){if(this.options[m]=A,this._canvas!=null&&(m==="width"||m==="height"))return this._canvas[m]=A},p.prototype.setOptions=function(m){var A,y,x;y=[];for(A in m)o.call(m,A)&&(x=m[A],y.push(this.setOption(A,x)));return y},p.prototype.addFrame=function(m,A){var y,x;A==null&&(A={}),y={},y.transparent=this.options.transparent;for(x in v)y[x]=A[x]||v[x];if(this.options.width==null&&this.setOption("width",m.width),this.options.height==null&&this.setOption("height",m.height),typeof ImageData<"u"&&ImageData!==null&&m instanceof ImageData)y.data=m.data;else if(typeof CanvasRenderingContext2D<"u"&&CanvasRenderingContext2D!==null&&m instanceof CanvasRenderingContext2D||typeof WebGLRenderingContext<"u"&&WebGLRenderingContext!==null&&m instanceof WebGLRenderingContext)A.copy?y.data=this.getContextData(m):y.context=m;else if(m.childNodes!=null)A.copy?y.data=this.getImageData(m):y.image=m;else throw new Error("Invalid image");return this.frames.push(y)},p.prototype.render=function(){var m,A,y;if(this.running)throw new Error("Already running");if(this.options.width==null||this.options.height==null)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=(function(){var x,P,L;for(L=[],x=0,P=this.frames.length;0<=P?x<P:x>P;0<=P?++x:--x)L.push(null);return L}).call(this),A=this.spawnWorkers(),this.options.globalPalette===!0)this.renderNextFrame();else for(m=0,y=A;0<=y?m<y:m>y;0<=y?++m:--m)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},p.prototype.abort=function(){for(var m;m=this.activeWorkers.shift(),m!=null;)this.log("killing active worker"),m.terminate();return this.running=!1,this.emit("abort")},p.prototype.spawnWorkers=function(){var m,A,y;return m=Math.min(this.options.workers,this.frames.length),(function(){y=[];for(var x=A=this.freeWorkers.length;A<=m?x<m:x>m;A<=m?x++:x--)y.push(x);return y}).apply(this).forEach(function(x){return function(P){var L;return x.log("spawning worker "+P),L=new Worker(x.options.workerScript),L.onmessage=function(T){return x.activeWorkers.splice(x.activeWorkers.indexOf(L),1),x.freeWorkers.push(L),x.frameFinished(T.data)},x.freeWorkers.push(L)}}(this)),m},p.prototype.frameFinished=function(m){var A,y;if(this.log("frame "+m.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[m.index]=m,this.options.globalPalette===!0&&(this.options.globalPalette=m.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(A=1,y=this.freeWorkers.length;1<=y?A<y:A>y;1<=y?++A:--A)this.renderNextFrame();return l.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},p.prototype.finishRendering=function(){var m,A,y,x,P,L,T,g,_,u,b,S,M,R,C,D;for(g=0,R=this.imageParts,P=0,_=R.length;P<_;P++)A=R[P],g+=(A.data.length-1)*A.pageSize+A.cursor;for(g+=A.pageSize-A.cursor,this.log("rendering finished - filesize "+Math.round(g/1e3)+"kb"),m=new Uint8Array(g),S=0,C=this.imageParts,L=0,u=C.length;L<u;L++)for(A=C[L],D=A.data,y=T=0,b=D.length;T<b;y=++T)M=D[y],m.set(M,S),y===A.data.length-1?S+=A.cursor:S+=A.pageSize;return x=new Blob([m],{type:"image/gif"}),this.emit("finished",x,m)},p.prototype.renderNextFrame=function(){var m,A,y;if(this.freeWorkers.length===0)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return m=this.frames[this.nextFrame++],y=this.freeWorkers.shift(),A=this.getTask(m),this.log("starting frame "+(A.index+1)+" of "+this.frames.length),this.activeWorkers.push(y),y.postMessage(A)},p.prototype.getContextData=function(m){return m.getImageData(0,0,this.options.width,this.options.height).data},p.prototype.getImageData=function(m){var A;return this._canvas==null&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),A=this._canvas.getContext("2d"),A.fillStyle=this.options.background,A.fillRect(0,0,this.options.width,this.options.height),A.drawImage(m,0,0),this.getContextData(A)},p.prototype.getTask=function(m){var A,y;if(A=this.frames.indexOf(m),y={index:A,last:A===this.frames.length-1,delay:m.delay,dispose:m.dispose,transparent:m.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:a.name==="chrome"},m.data!=null)y.data=m.data;else if(m.context!=null)y.data=this.getContextData(m.context);else if(m.image!=null)y.data=this.getImageData(m.image);else throw new Error("Invalid frame");return y},p.prototype.log=function(){var m;if(m=1<=arguments.length?r.call(arguments,0):[],!!this.options.debug)return console.log.apply(console,m)},p}(e),n.exports=c},{"./browser.coffee":2,events:1}]},{},[3])(3)});const UPNG={};UPNG.toRGBA8=function(t){var n=t.width,s=t.height;if(t.tabs.acTL==null)return[UPNG.toRGBA8.decodeImage(t.data,n,s,t).buffer];var e=[];t.frames[0].data==null&&(t.frames[0].data=t.data);for(var c=n*s*4,a=new Uint8Array(c),i=new Uint8Array(c),o=new Uint8Array(c),l=0;l<t.frames.length;l++){var r=t.frames[l],d=r.rect.x,h=r.rect.y,v=r.rect.width,p=r.rect.height,m=UPNG.toRGBA8.decodeImage(r.data,v,p,t);if(l!=0)for(var A=0;A<c;A++)o[A]=a[A];if(r.blend==0?UPNG._copyTile(m,v,p,a,n,s,d,h,0):r.blend==1&&UPNG._copyTile(m,v,p,a,n,s,d,h,1),e.push(a.buffer.slice(0)),r.dispose!=0){if(r.dispose==1)UPNG._copyTile(i,v,p,a,n,s,d,h,0);else if(r.dispose==2)for(var A=0;A<c;A++)a[A]=o[A]}}return e};UPNG.toRGBA8.decodeImage=function(t,n,s,e){var c=n*s,a=UPNG.decode._getBPP(e),i=Math.ceil(n*a/8),o=new Uint8Array(c*4),l=new Uint32Array(o.buffer),r=e.ctype,d=e.depth,h=UPNG._bin.readUshort;if(r==6){var v=c<<2;if(d==8)for(var p=0;p<v;p+=4)o[p]=t[p],o[p+1]=t[p+1],o[p+2]=t[p+2],o[p+3]=t[p+3];if(d==16)for(var p=0;p<v;p++)o[p]=t[p<<1]}else if(r==2){var m=e.tabs.tRNS;if(m==null){if(d==8)for(var p=0;p<c;p++){var A=p*3;l[p]=255<<24|t[A+2]<<16|t[A+1]<<8|t[A]}if(d==16)for(var p=0;p<c;p++){var A=p*6;l[p]=255<<24|t[A+4]<<16|t[A+2]<<8|t[A]}}else{var y=m[0],x=m[1],P=m[2];if(d==8)for(var p=0;p<c;p++){var L=p<<2,A=p*3;l[p]=255<<24|t[A+2]<<16|t[A+1]<<8|t[A],t[A]==y&&t[A+1]==x&&t[A+2]==P&&(o[L+3]=0)}if(d==16)for(var p=0;p<c;p++){var L=p<<2,A=p*6;l[p]=255<<24|t[A+4]<<16|t[A+2]<<8|t[A],h(t,A)==y&&h(t,A+2)==x&&h(t,A+4)==P&&(o[L+3]=0)}}}else if(r==3){var T=e.tabs.PLTE,g=e.tabs.tRNS,_=g?g.length:0;if(d==1)for(var u=0;u<s;u++)for(var b=u*i,S=u*n,p=0;p<n;p++){var L=S+p<<2,M=t[b+(p>>3)]>>7-((p&7)<<0)&1,R=3*M;o[L]=T[R],o[L+1]=T[R+1],o[L+2]=T[R+2],o[L+3]=M<_?g[M]:255}if(d==2)for(var u=0;u<s;u++)for(var b=u*i,S=u*n,p=0;p<n;p++){var L=S+p<<2,M=t[b+(p>>2)]>>6-((p&3)<<1)&3,R=3*M;o[L]=T[R],o[L+1]=T[R+1],o[L+2]=T[R+2],o[L+3]=M<_?g[M]:255}if(d==4)for(var u=0;u<s;u++)for(var b=u*i,S=u*n,p=0;p<n;p++){var L=S+p<<2,M=t[b+(p>>1)]>>4-((p&1)<<2)&15,R=3*M;o[L]=T[R],o[L+1]=T[R+1],o[L+2]=T[R+2],o[L+3]=M<_?g[M]:255}if(d==8)for(var p=0;p<c;p++){var L=p<<2,M=t[p],R=3*M;o[L]=T[R],o[L+1]=T[R+1],o[L+2]=T[R+2],o[L+3]=M<_?g[M]:255}}else if(r==4){if(d==8)for(var p=0;p<c;p++){var L=p<<2,C=p<<1,D=t[C];o[L]=D,o[L+1]=D,o[L+2]=D,o[L+3]=t[C+1]}if(d==16)for(var p=0;p<c;p++){var L=p<<2,C=p<<2,D=t[C];o[L]=D,o[L+1]=D,o[L+2]=D,o[L+3]=t[C+2]}}else if(r==0)for(var y=e.tabs.tRNS?e.tabs.tRNS:-1,u=0;u<s;u++){var B=u*i,Z=u*n;if(d==1)for(var J=0;J<n;J++){var D=255*(t[B+(J>>>3)]>>>7-(J&7)&1),q=D==y*255?0:255;l[Z+J]=q<<24|D<<16|D<<8|D}else if(d==2)for(var J=0;J<n;J++){var D=85*(t[B+(J>>>2)]>>>6-((J&3)<<1)&3),q=D==y*85?0:255;l[Z+J]=q<<24|D<<16|D<<8|D}else if(d==4)for(var J=0;J<n;J++){var D=17*(t[B+(J>>>1)]>>>4-((J&1)<<2)&15),q=D==y*17?0:255;l[Z+J]=q<<24|D<<16|D<<8|D}else if(d==8)for(var J=0;J<n;J++){var D=t[B+J],q=D==y?0:255;l[Z+J]=q<<24|D<<16|D<<8|D}else if(d==16)for(var J=0;J<n;J++){var D=t[B+(J<<1)],q=h(t,B+(J<<p))==y?0:255;l[Z+J]=q<<24|D<<16|D<<8|D}}return o};UPNG.decode=function(t){for(var n=new Uint8Array(t),s=8,e=UPNG._bin,c=e.readUshort,a=e.readUint,i={tabs:{},frames:[]},o=new Uint8Array(n.length),l=0,r,d=0,h=[137,80,78,71,13,10,26,10],v=0;v<8;v++)if(n[v]!=h[v])throw"The input is not a PNG file!";for(;s<n.length;){var p=e.readUint(n,s);s+=4;var m=e.readASCII(n,s,4);if(s+=4,m=="IHDR")UPNG.decode._IHDR(n,s,i);else if(m=="CgBI")i.tabs[m]=n.slice(s,s+4);else if(m=="IDAT"){for(var v=0;v<p;v++)o[l+v]=n[s+v];l+=p}else if(m=="acTL")i.tabs[m]={num_frames:a(n,s),num_plays:a(n,s+4)},r=new Uint8Array(n.length);else if(m=="fcTL"){if(d!=0){var A=i.frames[i.frames.length-1];A.data=UPNG.decode._decompress(i,r.slice(0,d),A.rect.width,A.rect.height),d=0}var y={x:a(n,s+12),y:a(n,s+16),width:a(n,s+4),height:a(n,s+8)},x=c(n,s+22);x=c(n,s+20)/(x==0?100:x);var P={rect:y,delay:Math.round(x*1e3),dispose:n[s+24],blend:n[s+25]};i.frames.push(P)}else if(m=="fdAT"){for(var v=0;v<p-4;v++)r[d+v]=n[s+v+4];d+=p-4}else if(m=="pHYs")i.tabs[m]=[e.readUint(n,s),e.readUint(n,s+4),n[s+8]];else if(m=="cHRM"){i.tabs[m]=[];for(var v=0;v<8;v++)i.tabs[m].push(e.readUint(n,s+v*4))}else if(m=="tEXt"||m=="zTXt"){i.tabs[m]==null&&(i.tabs[m]={});var L=e.nextZero(n,s),T=e.readASCII(n,s,L-s),g,_=s+p-L-1;if(m=="tEXt")g=e.readASCII(n,L+1,_);else{var u=UPNG.decode._inflate(n.slice(L+2,L+2+_));g=e.readUTF8(u,0,u.length)}i.tabs[m][T]=g}else if(m=="iTXt"){i.tabs[m]==null&&(i.tabs[m]={});var L=0,b=s;L=e.nextZero(n,b);var T=e.readASCII(n,b,L-b);b=L+1;var S=n[b];n[b+1],b+=2,L=e.nextZero(n,b),e.readASCII(n,b,L-b),b=L+1,L=e.nextZero(n,b),e.readUTF8(n,b,L-b),b=L+1;var g,_=p-(b-s);if(S==0)g=e.readUTF8(n,b,_);else{var u=UPNG.decode._inflate(n.slice(b,b+_));g=e.readUTF8(u,0,u.length)}i.tabs[m][T]=g}else if(m=="PLTE")i.tabs[m]=e.readBytes(n,s,p);else if(m=="hIST"){var M=i.tabs.PLTE.length/3;i.tabs[m]=[];for(var v=0;v<M;v++)i.tabs[m].push(c(n,s+v*2))}else if(m=="tRNS")i.ctype==3?i.tabs[m]=e.readBytes(n,s,p):i.ctype==0?i.tabs[m]=c(n,s):i.ctype==2&&(i.tabs[m]=[c(n,s),c(n,s+2),c(n,s+4)]);else if(m=="gAMA")i.tabs[m]=e.readUint(n,s)/1e5;else if(m=="sRGB")i.tabs[m]=n[s];else if(m=="bKGD")i.ctype==0||i.ctype==4?i.tabs[m]=[c(n,s)]:i.ctype==2||i.ctype==6?i.tabs[m]=[c(n,s),c(n,s+2),c(n,s+4)]:i.ctype==3&&(i.tabs[m]=n[s]);else if(m=="IEND")break;s+=p,e.readUint(n,s),s+=4}if(d!=0){var A=i.frames[i.frames.length-1];A.data=UPNG.decode._decompress(i,r.slice(0,d),A.rect.width,A.rect.height),d=0}return i.data=UPNG.decode._decompress(i,o,i.width,i.height),delete i.compress,delete i.interlace,delete i.filter,i};UPNG.decode._decompress=function(t,n,s,e){var c=UPNG.decode._getBPP(t),a=Math.ceil(s*c/8),i=new Uint8Array((a+1+t.interlace)*e);return t.tabs.CgBI?n=UPNG.inflateRaw(n,i):n=UPNG.decode._inflate(n,i),t.interlace==0?n=UPNG.decode._filterZero(n,t,0,s,e):t.interlace==1&&(n=UPNG.decode._readInterlace(n,t)),n};UPNG.decode._inflate=function(t,n){var s=UPNG.inflateRaw(new Uint8Array(t.buffer,2,t.length-6),n);return s};UPNG.inflateRaw=function(){var t={};return t.H={},t.H.N=function(n,s){var e=Uint8Array,c=0,a=0,i=0,o=0,l=0,r=0,d=0,h=0,v=0,p,m;if(n[0]==3&&n[1]==0)return s||new e(0);var A=t.H,y=A.b,x=A.e,P=A.R,L=A.n,T=A.A,g=A.Z,_=A.m,u=s==null;for(u&&(s=new e(n.length>>>2<<5));c==0;){if(c=y(n,v,1),a=y(n,v+1,2),v+=3,a==0){v&7&&(v+=8-(v&7));var b=(v>>>3)+4,S=n[b-4]|n[b-3]<<8;u&&(s=t.H.W(s,h+S)),s.set(new e(n.buffer,n.byteOffset+b,S),h),v=b+S<<3,h+=S;continue}if(u&&(s=t.H.W(s,h+(1<<17))),a==1&&(p=_.J,m=_.h,r=511,d=31),a==2){i=x(n,v,5)+257,o=x(n,v+5,5)+1,l=x(n,v+10,4)+4,v+=14;for(var M=1,R=0;R<38;R+=2)_.Q[R]=0,_.Q[R+1]=0;for(var R=0;R<l;R++){var C=x(n,v+R*3,3);_.Q[(_.X[R]<<1)+1]=C,C>M&&(M=C)}v+=3*l,L(_.Q,M),T(_.Q,M,_.u),p=_.w,m=_.d,v=P(_.u,(1<<M)-1,i+o,n,v,_.v);var D=A.V(_.v,0,i,_.C);r=(1<<D)-1;var B=A.V(_.v,i,o,_.D);d=(1<<B)-1,L(_.C,D),T(_.C,D,p),L(_.D,B),T(_.D,B,m)}for(;;){var Z=p[g(n,v)&r];v+=Z&15;var J=Z>>>4;if(!(J>>>8))s[h++]=J;else{if(J==256)break;var q=h+J-254;if(J>264){var z=_.q[J-257];q=h+(z>>>3)+x(n,v,z&7),v+=z&7}var w=m[g(n,v)&d];v+=w&15;var N=w>>>4,G=_.c[N],V=(G>>>4)+y(n,v,G&15);for(v+=G&15;h<q;)s[h]=s[h++-V],s[h]=s[h++-V],s[h]=s[h++-V],s[h]=s[h++-V];h=q}}}return s.length==h?s:s.slice(0,h)},t.H.W=function(n,s){var e=n.length;if(s<=e)return n;var c=new Uint8Array(e<<1);return c.set(n,0),c},t.H.R=function(n,s,e,c,a,i){for(var o=t.H.e,l=t.H.Z,r=0;r<e;){var d=n[l(c,a)&s];a+=d&15;var h=d>>>4;if(h<=15)i[r]=h,r++;else{var v=0,p=0;h==16?(p=3+o(c,a,2),a+=2,v=i[r-1]):h==17?(p=3+o(c,a,3),a+=3):h==18&&(p=11+o(c,a,7),a+=7);for(var m=r+p;r<m;)i[r]=v,r++}}return a},t.H.V=function(n,s,e,c){for(var a=0,i=0,o=c.length>>>1;i<e;){var l=n[i+s];c[i<<1]=0,c[(i<<1)+1]=l,l>a&&(a=l),i++}for(;i<o;)c[i<<1]=0,c[(i<<1)+1]=0,i++;return a},t.H.n=function(n,s){for(var e=t.H.m,c=n.length,a,i,o,l,r,d=e.j,l=0;l<=s;l++)d[l]=0;for(l=1;l<c;l+=2)d[n[l]]++;var h=e.K;for(a=0,d[0]=0,i=1;i<=s;i++)a=a+d[i-1]<<1,h[i]=a;for(o=0;o<c;o+=2)r=n[o+1],r!=0&&(n[o]=h[r],h[r]++)},t.H.A=function(n,s,e){for(var c=n.length,a=t.H.m,i=a.r,o=0;o<c;o+=2)if(n[o+1]!=0)for(var l=o>>1,r=n[o+1],d=l<<4|r,h=s-r,v=n[o]<<h,p=v+(1<<h);v!=p;){var m=i[v]>>>15-s;e[m]=d,v++}},t.H.l=function(n,s){for(var e=t.H.m.r,c=15-s,a=0;a<n.length;a+=2){var i=n[a]<<s-n[a+1];n[a]=e[i]>>>c}},t.H.M=function(n,s,e){e=e<<(s&7);var c=s>>>3;n[c]|=e,n[c+1]|=e>>>8},t.H.I=function(n,s,e){e=e<<(s&7);var c=s>>>3;n[c]|=e,n[c+1]|=e>>>8,n[c+2]|=e>>>16},t.H.e=function(n,s,e){return(n[s>>>3]|n[(s>>>3)+1]<<8)>>>(s&7)&(1<<e)-1},t.H.b=function(n,s,e){return(n[s>>>3]|n[(s>>>3)+1]<<8|n[(s>>>3)+2]<<16)>>>(s&7)&(1<<e)-1},t.H.Z=function(n,s){return(n[s>>>3]|n[(s>>>3)+1]<<8|n[(s>>>3)+2]<<16)>>>(s&7)},t.H.i=function(n,s){return(n[s>>>3]|n[(s>>>3)+1]<<8|n[(s>>>3)+2]<<16|n[(s>>>3)+3]<<24)>>>(s&7)},t.H.m=function(){var n=Uint16Array,s=Uint32Array;return{K:new n(16),j:new n(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new n(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new s(32),J:new n(512),_:[],h:new n(32),$:[],w:new n(32768),C:[],v:[],d:new n(32768),D:[],u:new n(512),Q:[],r:new n(32768),s:new s(286),Y:new s(30),a:new s(19),t:new s(15e3),k:new n(65536),g:new n(32768)}}(),function(){for(var n=t.H.m,s=32768,e=0;e<s;e++){var c=e;c=(c&2863311530)>>>1|(c&1431655765)<<1,c=(c&3435973836)>>>2|(c&858993459)<<2,c=(c&4042322160)>>>4|(c&252645135)<<4,c=(c&4278255360)>>>8|(c&16711935)<<8,n.r[e]=(c>>>16|c<<16)>>>17}function a(i,o,l){for(;o--!=0;)i.push(0,l)}for(var e=0;e<32;e++)n.q[e]=n.S[e]<<3|n.T[e],n.c[e]=n.p[e]<<4|n.z[e];a(n._,144,8),a(n._,112,9),a(n._,24,7),a(n._,8,8),t.H.n(n._,9),t.H.A(n._,9,n.J),t.H.l(n._,9),a(n.$,32,5),t.H.n(n.$,5),t.H.A(n.$,5,n.h),t.H.l(n.$,5),a(n.Q,19,0),a(n.C,286,0),a(n.D,30,0),a(n.v,320,0)}(),t.H.N}();UPNG.decode._readInterlace=function(t,n){for(var s=n.width,e=n.height,c=UPNG.decode._getBPP(n),a=c>>3,i=Math.ceil(s*c/8),o=new Uint8Array(e*i),l=0,r=[0,0,4,0,2,0,1],d=[0,4,0,2,0,1,0],h=[8,8,8,4,4,2,2],v=[8,8,4,4,2,2,1],p=0;p<7;){for(var m=h[p],A=v[p],y=0,x=0,P=r[p];P<e;)P+=m,x++;for(var L=d[p];L<s;)L+=A,y++;var T=Math.ceil(y*c/8);UPNG.decode._filterZero(t,n,l,y,x);for(var g=0,_=r[p];_<e;){for(var u=d[p],b=l+g*T<<3;u<s;){if(c==1){var S=t[b>>3];S=S>>7-(b&7)&1,o[_*i+(u>>3)]|=S<<7-((u&7)<<0)}if(c==2){var S=t[b>>3];S=S>>6-(b&7)&3,o[_*i+(u>>2)]|=S<<6-((u&3)<<1)}if(c==4){var S=t[b>>3];S=S>>4-(b&7)&15,o[_*i+(u>>1)]|=S<<4-((u&1)<<2)}if(c>=8)for(var M=_*i+u*a,R=0;R<a;R++)o[M+R]=t[(b>>3)+R];b+=c,u+=A}g++,_+=m}y*x!=0&&(l+=x*(1+T)),p=p+1}return o};UPNG.decode._getBPP=function(t){var n=[1,null,3,1,2,null,4][t.ctype];return n*t.depth};UPNG.decode._filterZero=function(t,n,s,e,c){var a=UPNG.decode._getBPP(n),i=Math.ceil(e*a/8),o=UPNG.decode._paeth;a=Math.ceil(a/8);var l=0,r=1,d=t[s],h=0;if(d>1&&(t[s]=[0,0,1][d-2]),d==3)for(h=a;h<i;h++)t[h+1]=t[h+1]+(t[h+1-a]>>>1)&255;for(var v=0;v<c;v++)if(l=s+v*i,r=l+v+1,d=t[r-1],h=0,d==0)for(;h<i;h++)t[l+h]=t[r+h];else if(d==1){for(;h<a;h++)t[l+h]=t[r+h];for(;h<i;h++)t[l+h]=t[r+h]+t[l+h-a]}else if(d==2)for(;h<i;h++)t[l+h]=t[r+h]+t[l+h-i];else if(d==3){for(;h<a;h++)t[l+h]=t[r+h]+(t[l+h-i]>>>1);for(;h<i;h++)t[l+h]=t[r+h]+(t[l+h-i]+t[l+h-a]>>>1)}else{for(;h<a;h++)t[l+h]=t[r+h]+o(0,t[l+h-i],0);for(;h<i;h++)t[l+h]=t[r+h]+o(t[l+h-a],t[l+h-i],t[l+h-a-i])}return t};UPNG.decode._paeth=function(t,n,s){var e=t+n-s,c=e-t,a=e-n,i=e-s;return c*c<=a*a&&c*c<=i*i?t:a*a<=i*i?n:s};UPNG.decode._IHDR=function(t,n,s){var e=UPNG._bin;s.width=e.readUint(t,n),n+=4,s.height=e.readUint(t,n),n+=4,s.depth=t[n],n++,s.ctype=t[n],n++,s.compress=t[n],n++,s.filter=t[n],n++,s.interlace=t[n],n++};UPNG._bin={nextZero:function(t,n){for(;t[n]!=0;)n++;return n},readUshort:function(t,n){return t[n]<<8|t[n+1]},writeUshort:function(t,n,s){t[n]=s>>8&255,t[n+1]=s&255},readUint:function(t,n){return t[n]*(256*256*256)+(t[n+1]<<16|t[n+2]<<8|t[n+3])},writeUint:function(t,n,s){t[n]=s>>24&255,t[n+1]=s>>16&255,t[n+2]=s>>8&255,t[n+3]=s&255},readASCII:function(t,n,s){for(var e="",c=0;c<s;c++)e+=String.fromCharCode(t[n+c]);return e},writeASCII:function(t,n,s){for(var e=0;e<s.length;e++)t[n+e]=s.charCodeAt(e)},readBytes:function(t,n,s){for(var e=[],c=0;c<s;c++)e.push(t[n+c]);return e},pad:function(t){return t.length<2?"0"+t:t},readUTF8:function(t,n,s){for(var e="",c,a=0;a<s;a++)e+="%"+UPNG._bin.pad(t[n+a].toString(16));try{c=decodeURIComponent(e)}catch{return UPNG._bin.readASCII(t,n,s)}return c}};UPNG._copyTile=function(t,n,s,e,c,a,i,o,l){for(var r=Math.min(n,c),d=Math.min(s,a),h=0,v=0,p=0;p<d;p++)for(var m=0;m<r;m++)if(i>=0&&o>=0?(h=p*n+m<<2,v=(o+p)*c+i+m<<2):(h=(-o+p)*n-i+m<<2,v=p*c+m<<2),l==0)e[v]=t[h],e[v+1]=t[h+1],e[v+2]=t[h+2],e[v+3]=t[h+3];else if(l==1){var A=t[h+3]*.00392156862745098,y=t[h]*A,x=t[h+1]*A,P=t[h+2]*A,L=e[v+3]*(1/255),T=e[v]*L,g=e[v+1]*L,_=e[v+2]*L,u=1-A,b=A+L*u,S=b==0?0:1/b;e[v+3]=255*b,e[v+0]=(y+T*u)*S,e[v+1]=(x+g*u)*S,e[v+2]=(P+_*u)*S}else if(l==2){var A=t[h+3],y=t[h],x=t[h+1],P=t[h+2],L=e[v+3],T=e[v],g=e[v+1],_=e[v+2];A==L&&y==T&&x==g&&P==_?(e[v]=0,e[v+1]=0,e[v+2]=0,e[v+3]=0):(e[v]=y,e[v+1]=x,e[v+2]=P,e[v+3]=A)}else if(l==3){var A=t[h+3],y=t[h],x=t[h+1],P=t[h+2],L=e[v+3],T=e[v],g=e[v+1],_=e[v+2];if(A==L&&y==T&&x==g&&P==_)continue;if(A<220&&L>20)return!1}return!0};UPNG.encode=function(t,n,s,e,c,a,i){e==null&&(e=0),i==null&&(i=!1);var o=UPNG.encode.compress(t,n,s,e,[!1,!1,!1,0,i]);return UPNG.encode.compressPNG(o,-1),UPNG.encode._main(o,n,s,c,a)};UPNG.encodeLL=function(t,n,s,e,c,a,i,o){for(var l={ctype:0+(e==1?0:2)+(c==0?0:4),depth:a,frames:[]},r=(e+c)*a,d=r*n,h=0;h<t.length;h++)l.frames.push({rect:{x:0,y:0,width:n,height:s},img:new Uint8Array(t[h]),blend:0,dispose:1,bpp:Math.ceil(r/8),bpl:Math.ceil(d/8)});UPNG.encode.compressPNG(l,0,!0);var v=UPNG.encode._main(l,n,s,i,o);return v};UPNG.encode._main=function(t,n,s,e,c){c==null&&(c={});var a=UPNG.crc.crc,i=UPNG._bin.writeUint,o=UPNG._bin.writeUshort,l=UPNG._bin.writeASCII,r=8,d=t.frames.length>1,h=!1,v=33+(d?20:0);if(c.sRGB!=null&&(v+=13),c.pHYs!=null&&(v+=21),t.ctype==3){for(var p=t.plte.length,m=0;m<p;m++)t.plte[m]>>>24!=255&&(h=!0);v+=8+p*3+4+(h?8+p*1+4:0)}for(var A=0;A<t.frames.length;A++){var y=t.frames[A];d&&(v+=38),v+=y.cimg.length+12,A!=0&&(v+=4)}v+=12;for(var x=new Uint8Array(v),P=[137,80,78,71,13,10,26,10],m=0;m<8;m++)x[m]=P[m];if(i(x,r,13),r+=4,l(x,r,"IHDR"),r+=4,i(x,r,n),r+=4,i(x,r,s),r+=4,x[r]=t.depth,r++,x[r]=t.ctype,r++,x[r]=0,r++,x[r]=0,r++,x[r]=0,r++,i(x,r,a(x,r-17,17)),r+=4,c.sRGB!=null&&(i(x,r,1),r+=4,l(x,r,"sRGB"),r+=4,x[r]=c.sRGB,r++,i(x,r,a(x,r-5,5)),r+=4),c.pHYs!=null&&(i(x,r,9),r+=4,l(x,r,"pHYs"),r+=4,i(x,r,c.pHYs[0]),r+=4,i(x,r,c.pHYs[1]),r+=4,x[r]=c.pHYs[2],r++,i(x,r,a(x,r-13,13)),r+=4),d&&(i(x,r,8),r+=4,l(x,r,"acTL"),r+=4,i(x,r,t.frames.length),r+=4,i(x,r,c.loop!=null?c.loop:0),r+=4,i(x,r,a(x,r-12,12)),r+=4),t.ctype==3){var p=t.plte.length;i(x,r,p*3),r+=4,l(x,r,"PLTE"),r+=4;for(var m=0;m<p;m++){var L=m*3,T=t.plte[m],g=T&255,_=T>>>8&255,u=T>>>16&255;x[r+L+0]=g,x[r+L+1]=_,x[r+L+2]=u}if(r+=p*3,i(x,r,a(x,r-p*3-4,p*3+4)),r+=4,h){i(x,r,p),r+=4,l(x,r,"tRNS"),r+=4;for(var m=0;m<p;m++)x[r+m]=t.plte[m]>>>24&255;r+=p,i(x,r,a(x,r-p-4,p+4)),r+=4}}for(var b=0,A=0;A<t.frames.length;A++){var y=t.frames[A];d&&(i(x,r,26),r+=4,l(x,r,"fcTL"),r+=4,i(x,r,b++),r+=4,i(x,r,y.rect.width),r+=4,i(x,r,y.rect.height),r+=4,i(x,r,y.rect.x),r+=4,i(x,r,y.rect.y),r+=4,o(x,r,e[A]),r+=2,o(x,r,1e3),r+=2,x[r]=y.dispose,r++,x[r]=y.blend,r++,i(x,r,a(x,r-30,30)),r+=4);var S=y.cimg,p=S.length;i(x,r,p+(A==0?0:4)),r+=4;var M=r;l(x,r,A==0?"IDAT":"fdAT"),r+=4,A!=0&&(i(x,r,b++),r+=4),x.set(S,r),r+=p,i(x,r,a(x,M,r-M)),r+=4}return i(x,r,0),r+=4,l(x,r,"IEND"),r+=4,i(x,r,a(x,r-4,4)),r+=4,x.buffer};UPNG.encode.compressPNG=function(t,n,s){for(var e=0;e<t.frames.length;e++){var c=t.frames[e];c.rect.width;var a=c.rect.height,i=new Uint8Array(a*c.bpl+a);c.cimg=UPNG.encode._filterZero(c.img,a,c.bpp,c.bpl,i,n,s)}};UPNG.encode.compress=function(t,n,s,e,c){for(var a=c[0],i=c[1],o=c[2],l=c[3],r=c[4],d=6,h=8,v=255,p=0;p<t.length;p++)for(var m=new Uint8Array(t[p]),A=m.length,y=0;y<A;y+=4)v&=m[y+3];var x=v!=255,P=UPNG.encode.framize(t,n,s,a,i,o),L={},T=[],g=[];if(e!=0){for(var _=[],y=0;y<P.length;y++)_.push(P[y].img.buffer);var u=UPNG.encode.concatRGBA(_),b=UPNG.quantize(u,e);console.log(b);for(var S=0,M=new Uint8Array(b.abuf),y=0;y<P.length;y++){var R=P[y].img,C=R.length;g.push(new Uint8Array(b.inds.buffer,S>>2,C>>2));for(var p=0;p<C;p+=4)R[p]=M[S+p],R[p+1]=M[S+p+1],R[p+2]=M[S+p+2],R[p+3]=M[S+p+3];S+=C}for(var y=0;y<b.plte.length;y++)T.push(b.plte[y].est.rgba)}else for(var p=0;p<P.length;p++){var D=P[p],B=new Uint32Array(D.img.buffer),Z=D.rect.width,A=B.length,J=new Uint8Array(A);g.push(J);for(var y=0;y<A;y++){var q=B[y];if(y!=0&&q==B[y-1])J[y]=J[y-1];else if(y>Z&&q==B[y-Z])J[y]=J[y-Z];else{var z=L[q];if(z==null&&(L[q]=z=T.length,T.push(q),T.length>=300))break;J[y]=z}}}var w=T.length;w<=256&&r==!1&&(w<=2?h=1:w<=4?h=2:w<=16?h=4:h=8,h=Math.max(h,l));for(var p=0;p<P.length;p++){var D=P[p];D.rect.x,D.rect.y;var Z=D.rect.width,N=D.rect.height,G=D.img;new Uint32Array(G.buffer);var V=4*Z,H=4;if(w<=256&&r==!1){V=Math.ceil(h*Z/8);for(var X=new Uint8Array(V*N),Q=g[p],ce=0;ce<N;ce++){var y=ce*V,pe=ce*Z;if(h==8)for(var _e=0;_e<Z;_e++)X[y+_e]=Q[pe+_e];else if(h==4)for(var _e=0;_e<Z;_e++)X[y+(_e>>1)]|=Q[pe+_e]<<4-(_e&1)*4;else if(h==2)for(var _e=0;_e<Z;_e++)X[y+(_e>>2)]|=Q[pe+_e]<<6-(_e&3)*2;else if(h==1)for(var _e=0;_e<Z;_e++)X[y+(_e>>3)]|=Q[pe+_e]<<7-(_e&7)*1}G=X,d=3,H=1}else if(x==!1&&P.length==1){for(var X=new Uint8Array(Z*N*3),xe=Z*N,y=0;y<xe;y++){var R=y*3,Y=y*4;X[R]=G[Y],X[R+1]=G[Y+1],X[R+2]=G[Y+2]}G=X,d=2,H=3,V=3*Z}D.img=G,D.bpl=V,D.bpp=H}return{ctype:d,depth:h,plte:T,frames:P}};UPNG.encode.framize=function(t,n,s,e,c,a){for(var i=[],o=0;o<t.length;o++){var l=new Uint8Array(t[o]),r=new Uint32Array(l.buffer),d,h=0,v=0,p=n,m=s,A=e?1:0;if(o!=0){for(var y=a||e||o==1||i[o-2].dispose!=0?1:2,x=0,P=1e9,L=0;L<y;L++){for(var D=new Uint8Array(t[o-1-L]),T=new Uint32Array(t[o-1-L]),g=n,_=s,u=-1,b=-1,S=0;S<s;S++)for(var M=0;M<n;M++){var R=S*n+M;r[R]!=T[R]&&(M<g&&(g=M),M>u&&(u=M),S<_&&(_=S),S>b&&(b=S))}u==-1&&(g=_=u=b=0),c&&((g&1)==1&&g--,(_&1)==1&&_--);var C=(u-g+1)*(b-_+1);C<P&&(P=C,x=L,h=g,v=_,p=u-g+1,m=b-_+1)}var D=new Uint8Array(t[o-1-x]);x==1&&(i[o-1].dispose=2),d=new Uint8Array(p*m*4),UPNG._copyTile(D,n,s,d,p,m,-h,-v,0),A=UPNG._copyTile(l,n,s,d,p,m,-h,-v,3)?1:0,A==1?UPNG.encode._prepareDiff(l,n,s,d,{x:h,y:v,width:p,height:m}):UPNG._copyTile(l,n,s,d,p,m,-h,-v,0)}else d=l.slice(0);i.push({rect:{x:h,y:v,width:p,height:m},img:d,blend:A,dispose:0})}if(e)for(var o=0;o<i.length;o++){var B=i[o];if(B.blend!=1){var Z=B.rect,J=i[o-1].rect,q=Math.min(Z.x,J.x),z=Math.min(Z.y,J.y),w=Math.max(Z.x+Z.width,J.x+J.width),N=Math.max(Z.y+Z.height,J.y+J.height),G={x:q,y:z,width:w-q,height:N-z};i[o-1].dispose=1,o-1!=0&&UPNG.encode._updateFrame(t,n,s,i,o-1,G,c),UPNG.encode._updateFrame(t,n,s,i,o,G,c)}}var V=0;if(t.length!=1)for(var R=0;R<i.length;R++){var B=i[R];V+=B.rect.width*B.rect.height}return i};UPNG.encode._updateFrame=function(t,n,s,e,c,a,i){for(var o=Uint8Array,l=Uint32Array,r=new o(t[c-1]),d=new l(t[c-1]),h=c+1<t.length?new o(t[c+1]):null,v=new o(t[c]),p=new l(v.buffer),m=n,A=s,y=-1,x=-1,P=0;P<a.height;P++)for(var L=0;L<a.width;L++){var T=a.x+L,g=a.y+P,_=g*n+T,u=p[_];u==0||e[c-1].dispose==0&&d[_]==u&&(h==null||h[_*4+3]!=0)||(T<m&&(m=T),T>y&&(y=T),g<A&&(A=g),g>x&&(x=g))}y==-1&&(m=A=y=x=0),i&&((m&1)==1&&m--,(A&1)==1&&A--),a={x:m,y:A,width:y-m+1,height:x-A+1};var b=e[c];b.rect=a,b.blend=1,b.img=new Uint8Array(a.width*a.height*4),e[c-1].dispose==0?(UPNG._copyTile(r,n,s,b.img,a.width,a.height,-a.x,-a.y,0),UPNG.encode._prepareDiff(v,n,s,b.img,a)):UPNG._copyTile(v,n,s,b.img,a.width,a.height,-a.x,-a.y,0)};UPNG.encode._prepareDiff=function(t,n,s,e,c){UPNG._copyTile(t,n,s,e,c.width,c.height,-c.x,-c.y,2)};UPNG.encode._filterZero=function(t,n,s,e,c,a,i){var o=[],l=[0,1,2,3,4];a!=-1?l=[a]:(n*e>5e5||s==1)&&(l=[0]);var r;i&&(r={level:0});for(var d=c.length>1e7&&typeof UZIP<"u"&&UZIP!=null?UZIP:pako,h=0;h<l.length;h++){for(var v=0;v<n;v++)UPNG.encode._filterLine(c,t,v,e,s,l[h]);o.push(d.deflate(c,r))}for(var p,m=1e9,h=0;h<o.length;h++)o[h].length<m&&(p=h,m=o[h].length);return o[p]};UPNG.encode._filterLine=function(t,n,s,e,c,a){var i=s*e,o=i+s,l=UPNG.decode._paeth;if(t[o]=a,o++,a==0)if(e<500)for(var r=0;r<e;r++)t[o+r]=n[i+r];else t.set(new Uint8Array(n.buffer,i,e),o);else if(a==1){for(var r=0;r<c;r++)t[o+r]=n[i+r];for(var r=c;r<e;r++)t[o+r]=n[i+r]-n[i+r-c]+256&255}else if(s==0){for(var r=0;r<c;r++)t[o+r]=n[i+r];if(a==2)for(var r=c;r<e;r++)t[o+r]=n[i+r];if(a==3)for(var r=c;r<e;r++)t[o+r]=n[i+r]-(n[i+r-c]>>1)+256&255;if(a==4)for(var r=c;r<e;r++)t[o+r]=n[i+r]-l(n[i+r-c],0,0)+256&255}else{if(a==2)for(var r=0;r<e;r++)t[o+r]=n[i+r]+256-n[i+r-e]&255;if(a==3){for(var r=0;r<c;r++)t[o+r]=n[i+r]+256-(n[i+r-e]>>1)&255;for(var r=c;r<e;r++)t[o+r]=n[i+r]+256-(n[i+r-e]+n[i+r-c]>>1)&255}if(a==4){for(var r=0;r<c;r++)t[o+r]=n[i+r]+256-l(0,n[i+r-e],0)&255;for(var r=c;r<e;r++)t[o+r]=n[i+r]+256-l(n[i+r-c],n[i+r-e],n[i+r-c-e])&255}}};UPNG.crc={table:function(){for(var t=new Uint32Array(256),n=0;n<256;n++){for(var s=n,e=0;e<8;e++)s&1?s=3988292384^s>>>1:s=s>>>1;t[n]=s}return t}(),update:function(t,n,s,e){for(var c=0;c<e;c++)t=UPNG.crc.table[(t^n[s+c])&255]^t>>>8;return t},crc:function(t,n,s){return UPNG.crc.update(4294967295,t,n,s)^4294967295}};UPNG.quantize=function(t,n){var s=new Uint8Array(t),e=s.slice(0),c=new Uint32Array(e.buffer),a=UPNG.quantize.getKDtree(e,n),i=a[0],o=a[1],l=UPNG.quantize.planeDst,r=s,d=c,h=r.length,v=new Uint8Array(s.length>>2),p;if(s.length<2e7)for(var m=0;m<h;m+=4){var A=r[m]*.00392156862745098,y=r[m+1]*(1/255),x=r[m+2]*(1/255),P=r[m+3]*(1/255);p=UPNG.quantize.getNearest(i,A,y,x,P),v[m>>2]=p.ind,d[m>>2]=p.est.rgba}else for(var m=0;m<h;m+=4){var A=r[m]*.00392156862745098,y=r[m+1]*(1/255),x=r[m+2]*(1/255),P=r[m+3]*(1/255);for(p=i;p.left;)p=l(p.est,A,y,x,P)<=0?p.left:p.right;v[m>>2]=p.ind,d[m>>2]=p.est.rgba}return{abuf:e.buffer,inds:v,plte:o}};UPNG.quantize.getKDtree=function(t,n,s){s==null&&(s=1e-4);var e=new Uint32Array(t.buffer),c={i0:0,i1:t.length,bst:null,est:null,tdst:0,left:null,right:null};c.bst=UPNG.quantize.stats(t,c.i0,c.i1),c.est=UPNG.quantize.estats(c.bst);for(var a=[c];a.length<n;){for(var i=0,o=0,l=0;l<a.length;l++)a[l].est.L>i&&(i=a[l].est.L,o=l);if(i<s)break;var r=a[o],d=UPNG.quantize.splitPixels(t,e,r.i0,r.i1,r.est.e,r.est.eMq255),h=r.i0>=d||r.i1<=d;if(h){r.est.L=0;continue}var v={i0:r.i0,i1:d,bst:null,est:null,tdst:0,left:null,right:null};v.bst=UPNG.quantize.stats(t,v.i0,v.i1),v.est=UPNG.quantize.estats(v.bst);var p={i0:d,i1:r.i1,bst:null,est:null,tdst:0,left:null,right:null};p.bst={R:[],m:[],N:r.bst.N-v.bst.N};for(var l=0;l<16;l++)p.bst.R[l]=r.bst.R[l]-v.bst.R[l];for(var l=0;l<4;l++)p.bst.m[l]=r.bst.m[l]-v.bst.m[l];p.est=UPNG.quantize.estats(p.bst),r.left=v,r.right=p,a[o]=v,a.push(p)}a.sort(function(m,A){return A.bst.N-m.bst.N});for(var l=0;l<a.length;l++)a[l].ind=l;return[c,a]};UPNG.quantize.getNearest=function(t,n,s,e,c){if(t.left==null)return t.tdst=UPNG.quantize.dist(t.est.q,n,s,e,c),t;var a=UPNG.quantize.planeDst(t.est,n,s,e,c),i=t.left,o=t.right;a>0&&(i=t.right,o=t.left);var l=UPNG.quantize.getNearest(i,n,s,e,c);if(l.tdst<=a*a)return l;var r=UPNG.quantize.getNearest(o,n,s,e,c);return r.tdst<l.tdst?r:l};UPNG.quantize.planeDst=function(t,n,s,e,c){var a=t.e;return a[0]*n+a[1]*s+a[2]*e+a[3]*c-t.eMq};UPNG.quantize.dist=function(t,n,s,e,c){var a=n-t[0],i=s-t[1],o=e-t[2],l=c-t[3];return a*a+i*i+o*o+l*l};UPNG.quantize.splitPixels=function(t,n,s,e,c,a){var i=UPNG.quantize.vecDot;for(e-=4;s<e;){for(;i(t,s,c)<=a;)s+=4;for(;i(t,e,c)>a;)e-=4;if(s>=e)break;var o=n[s>>2];n[s>>2]=n[e>>2],n[e>>2]=o,s+=4,e-=4}for(;i(t,s,c)>a;)s-=4;return s+4};UPNG.quantize.vecDot=function(t,n,s){return t[n]*s[0]+t[n+1]*s[1]+t[n+2]*s[2]+t[n+3]*s[3]};UPNG.quantize.stats=function(t,n,s){for(var e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=[0,0,0,0],a=s-n>>2,i=n;i<s;i+=4){var o=t[i]*.00392156862745098,l=t[i+1]*(1/255),r=t[i+2]*(1/255),d=t[i+3]*(1/255);c[0]+=o,c[1]+=l,c[2]+=r,c[3]+=d,e[0]+=o*o,e[1]+=o*l,e[2]+=o*r,e[3]+=o*d,e[5]+=l*l,e[6]+=l*r,e[7]+=l*d,e[10]+=r*r,e[11]+=r*d,e[15]+=d*d}return e[4]=e[1],e[8]=e[2],e[9]=e[6],e[12]=e[3],e[13]=e[7],e[14]=e[11],{R:e,m:c,N:a}};UPNG.quantize.estats=function(t){var n=t.R,s=t.m,e=t.N,c=s[0],a=s[1],i=s[2],o=s[3],l=e==0?0:1/e,r=[n[0]-c*c*l,n[1]-c*a*l,n[2]-c*i*l,n[3]-c*o*l,n[4]-a*c*l,n[5]-a*a*l,n[6]-a*i*l,n[7]-a*o*l,n[8]-i*c*l,n[9]-i*a*l,n[10]-i*i*l,n[11]-i*o*l,n[12]-o*c*l,n[13]-o*a*l,n[14]-o*i*l,n[15]-o*o*l],d=r,h=UPNG.M4,v=[Math.random(),Math.random(),Math.random(),Math.random()],p=0,m=0;if(e!=0)for(var A=0;A<16&&(v=h.multVec(d,v),m=Math.sqrt(h.dot(v,v)),v=h.sml(1/m,v),!(A!=0&&Math.abs(m-p)<1e-9));A++)p=m;var y=[c*l,a*l,i*l,o*l],x=h.dot(h.sml(255,y),v);return{Cov:r,q:y,e:v,L:p,eMq255:x,eMq:h.dot(v,y),rgba:(Math.round(255*y[3])<<24|Math.round(255*y[2])<<16|Math.round(255*y[1])<<8|Math.round(255*y[0])<<0)>>>0}};UPNG.M4={multVec:function(t,n){return[t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3],t[4]*n[0]+t[5]*n[1]+t[6]*n[2]+t[7]*n[3],t[8]*n[0]+t[9]*n[1]+t[10]*n[2]+t[11]*n[3],t[12]*n[0]+t[13]*n[1]+t[14]*n[2]+t[15]*n[3]]},dot:function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]},sml:function(t,n){return[t*n[0],t*n[1],t*n[2],t*n[3]]}};UPNG.encode.concatRGBA=function(t){for(var n=0,s=0;s<t.length;s++)n+=t[s].byteLength;for(var e=new Uint8Array(n),c=0,s=0;s<t.length;s++){for(var a=new Uint8Array(t[s]),i=a.length,o=0;o<i;o+=4){var l=a[o],r=a[o+1],d=a[o+2],h=a[o+3];h==0&&(l=r=d=0),e[c+o]=l,e[c+o+1]=r,e[c+o+2]=d,e[c+o+3]=h}c+=i}return e.buffer};(function(){var t={};typeof module=="object"?module.exports=t:self.UTIF=t;var n=typeof require=="function"?require("pako"):self.pako;function s(){typeof process>"u"&&console.log.apply(console,arguments)}(function(e,c){(function(){var a=function(){function r(d){this.message="JPEG error: "+d}return r.prototype=new Error,r.prototype.name="JpegError",r.constructor=r,r}(),i=function(){var r=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),d=4017,h=799,v=3406,p=2276,m=1567,A=3784,y=5793,x=2896;function P(S){S==null&&(S={}),S.w==null&&(S.w=-1),this.V=S.n,this.N=S.w}function L(S,M){for(var R=0,C=[],D,B,Z=16,J;Z>0&&!S[Z-1];)Z--;C.push({children:[],index:0});var q=C[0];for(D=0;D<Z;D++){for(B=0;B<S[D];B++){for(q=C.pop(),q.children[q.index]=M[R];q.index>0;)q=C.pop();for(q.index++,C.push(q);C.length<=D;)C.push(J={children:[],index:0}),q.children[q.index]=J.children,q=J;R++}D+1<Z&&(C.push(J={children:[],index:0}),q.children[q.index]=J.children,q=J)}return C[0].children}function T(S,M,R){return 64*((S.P+1)*M+R)}function g(S,M,R,C,D,B,Z,J,q,z){z==null&&(z=!1);var w=R.m,N=R.Z,G=M,V=0,H=0,X=0,Q=0,ce,pe=0,_e,xe,Y,F,ie,ae,de=0,ve,ee,se,K;function I(){if(H>0)return H--,V>>H&1;if(V=S[M++],V===255){var je=S[M++];if(je){if(je===220&&z){M+=2;var W=o(S,M);if(M+=2,W>0&&W!==R.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",W)}else if(je===217){if(z){var re=pe*8;if(re>0&&re<R.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",re)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new a("unexpected marker")}}return H=7,V>>>7}function U(je){for(var W=je;;){switch(W=W[I()],typeof W){case"number":return W;case"object":continue}throw new a("invalid huffman sequence")}}function oe(je){for(var W=0;je>0;)W=W<<1|I(),je--;return W}function ge(je){if(je===1)return I()===1?1:-1;var W=oe(je);return W>=1<<je-1?W:W+(-1<<je)+1}function Se(je,W){var re=U(je.J),ue=re===0?0:ge(re),he=1;for(je.D[W]=je.Q+=ue;he<64;){var we=U(je.i),$e=we&15,fe=we>>4;if($e===0){if(fe<15)break;he+=16;continue}he+=fe;var be=r[he];je.D[W+be]=ge($e),he++}}function Ce(je,W){var re=U(je.J),ue=re===0?0:ge(re)<<q;je.D[W]=je.Q+=ue}function Re(je,W){je.D[W]|=I()<<q}function qe(je,W){if(X>0){X--;return}for(var re=B,ue=Z;re<=ue;){var he=U(je.i),we=he&15,$e=he>>4;if(we===0){if($e<15){X=oe($e)+(1<<$e)-1;break}re+=16;continue}re+=$e;var fe=r[re];je.D[W+fe]=ge(we)*(1<<q),re++}}function Ge(je,W){for(var re=B,ue=Z,he=0,we,$e;re<=ue;){var fe=W+r[re],be=je.D[fe]<0?-1:1;switch(Q){case 0:if($e=U(je.i),we=$e&15,he=$e>>4,we===0)he<15?(X=oe(he)+(1<<he),Q=4):(he=16,Q=1);else{if(we!==1)throw new a("invalid ACn encoding");ce=ge(we),Q=he?2:3}continue;case 1:case 2:je.D[fe]?je.D[fe]+=be*(I()<<q):(he--,he===0&&(Q=Q===2?3:0));break;case 3:je.D[fe]?je.D[fe]+=be*(I()<<q):(je.D[fe]=ce<<q,Q=0);break;case 4:je.D[fe]&&(je.D[fe]+=be*(I()<<q));break}re++}Q===4&&(X--,X===0&&(Q=0))}function Ye(je,W,re,ue,he){var we=re/w|0,$e=re%w;pe=we*je.A+ue;var fe=$e*je.h+he,be=T(je,pe,fe);W(je,be)}function He(je,W,re){pe=re/je.P|0;var ue=re%je.P,he=T(je,pe,ue);W(je,he)}var Xe=C.length;for(N?B===0?ae=J===0?Ce:Re:ae=J===0?qe:Ge:ae=Se,Xe===1?ee=C[0].P*C[0].c:ee=w*R.R;de<=ee;){var Qe=D?Math.min(ee-de,D):ee;if(Qe>0){for(xe=0;xe<Xe;xe++)C[xe].Q=0;if(X=0,Xe===1)for(_e=C[0],ie=0;ie<Qe;ie++)He(_e,ae,de),de++;else for(ie=0;ie<Qe;ie++){for(xe=0;xe<Xe;xe++)for(_e=C[xe],se=_e.h,K=_e.A,Y=0;Y<K;Y++)for(F=0;F<se;F++)Ye(_e,ae,de,Y,F);de++}}if(H=0,ve=b(S,M),!ve)break;if(ve.u&&(M=ve.offset),ve.M>=65488&&ve.M<=65495)M+=2;else break}return M-G}function _(S,M,R){var C=S.$,D=S.D,B,Z,J,q,z,w,N,G,V,H,X,Q,ce,pe,_e,xe,Y;if(!C)throw new a("missing required Quantization Table.");for(var F=0;F<64;F+=8){if(V=D[M+F],H=D[M+F+1],X=D[M+F+2],Q=D[M+F+3],ce=D[M+F+4],pe=D[M+F+5],_e=D[M+F+6],xe=D[M+F+7],V*=C[F],!(H|X|Q|ce|pe|_e|xe)){Y=y*V+512>>10,R[F]=Y,R[F+1]=Y,R[F+2]=Y,R[F+3]=Y,R[F+4]=Y,R[F+5]=Y,R[F+6]=Y,R[F+7]=Y;continue}H*=C[F+1],X*=C[F+2],Q*=C[F+3],ce*=C[F+4],pe*=C[F+5],_e*=C[F+6],xe*=C[F+7],B=y*V+128>>8,Z=y*ce+128>>8,J=X,q=_e,z=x*(H-xe)+128>>8,G=x*(H+xe)+128>>8,w=Q<<4,N=pe<<4,B=B+Z+1>>1,Z=B-Z,Y=J*A+q*m+128>>8,J=J*m-q*A+128>>8,q=Y,z=z+N+1>>1,N=z-N,G=G+w+1>>1,w=G-w,B=B+q+1>>1,q=B-q,Z=Z+J+1>>1,J=Z-J,Y=z*p+G*v+2048>>12,z=z*v-G*p+2048>>12,G=Y,Y=w*h+N*d+2048>>12,w=w*d-N*h+2048>>12,N=Y,R[F]=B+G,R[F+7]=B-G,R[F+1]=Z+N,R[F+6]=Z-N,R[F+2]=J+w,R[F+5]=J-w,R[F+3]=q+z,R[F+4]=q-z}for(var ie=0;ie<8;++ie){if(V=R[ie],H=R[ie+8],X=R[ie+16],Q=R[ie+24],ce=R[ie+32],pe=R[ie+40],_e=R[ie+48],xe=R[ie+56],!(H|X|Q|ce|pe|_e|xe)){Y=y*V+8192>>14,Y<-2040?Y=0:Y>=2024?Y=255:Y=Y+2056>>4,D[M+ie]=Y,D[M+ie+8]=Y,D[M+ie+16]=Y,D[M+ie+24]=Y,D[M+ie+32]=Y,D[M+ie+40]=Y,D[M+ie+48]=Y,D[M+ie+56]=Y;continue}B=y*V+2048>>12,Z=y*ce+2048>>12,J=X,q=_e,z=x*(H-xe)+2048>>12,G=x*(H+xe)+2048>>12,w=Q,N=pe,B=(B+Z+1>>1)+4112,Z=B-Z,Y=J*A+q*m+2048>>12,J=J*m-q*A+2048>>12,q=Y,z=z+N+1>>1,N=z-N,G=G+w+1>>1,w=G-w,B=B+q+1>>1,q=B-q,Z=Z+J+1>>1,J=Z-J,Y=z*p+G*v+2048>>12,z=z*v-G*p+2048>>12,G=Y,Y=w*h+N*d+2048>>12,w=w*d-N*h+2048>>12,N=Y,V=B+G,xe=B-G,H=Z+N,_e=Z-N,X=J+w,pe=J-w,Q=q+z,ce=q-z,V<16?V=0:V>=4080?V=255:V>>=4,H<16?H=0:H>=4080?H=255:H>>=4,X<16?X=0:X>=4080?X=255:X>>=4,Q<16?Q=0:Q>=4080?Q=255:Q>>=4,ce<16?ce=0:ce>=4080?ce=255:ce>>=4,pe<16?pe=0:pe>=4080?pe=255:pe>>=4,_e<16?_e=0:_e>=4080?_e=255:_e>>=4,xe<16?xe=0:xe>=4080?xe=255:xe>>=4,D[M+ie]=V,D[M+ie+8]=H,D[M+ie+16]=X,D[M+ie+24]=Q,D[M+ie+32]=ce,D[M+ie+40]=pe,D[M+ie+48]=_e,D[M+ie+56]=xe}}function u(S,M){for(var R=M.P,C=M.c,D=new Int16Array(64),B=0;B<C;B++)for(var Z=0;Z<R;Z++){var J=T(M,B,Z);_(M,J,D)}return M.D}function b(S,M,R){R==null&&(R=M);var C=S.length-1,D=R<M?R:M;if(M>=C)return null;var B=o(S,M);if(B>=65472&&B<=65534)return{u:null,M:B,offset:M};for(var Z=o(S,D);!(Z>=65472&&Z<=65534);){if(++D>=C)return null;Z=o(S,D)}return{u:B.toString(16),M:Z,offset:D}}return P.prototype={parse(S,M){M==null&&(M={});var R=M.F,C=0,D=null,B=null,Z,J,q=0;function z(){var fe=o(S,C);C+=2;var be=C+fe-2,Ae=b(S,be,C);Ae&&Ae.u&&(be=Ae.offset);var De=S.subarray(C,be);return C+=De.length,De}function w(fe){for(var be=Math.ceil(fe.o/8/fe.X),Ae=Math.ceil(fe.s/8/fe.B),De=0;De<fe.W.length;De++){Ge=fe.W[De];var Ve=Math.ceil(Math.ceil(fe.o/8)*Ge.h/fe.X),Ke=Math.ceil(Math.ceil(fe.s/8)*Ge.A/fe.B),Be=be*Ge.h,Ie=Ae*Ge.A,Ue=64*Ie*(Be+1);Ge.D=new Int16Array(Ue),Ge.P=Ve,Ge.c=Ke}fe.m=be,fe.R=Ae}var N=[],G=[],V=[],H=o(S,C);if(C+=2,H!==65496)throw new a("SOI not found");H=o(S,C),C+=2;e:for(;H!==65497;){var X,Q,ce;switch(H){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var pe=z();H===65504&&pe[0]===74&&pe[1]===70&&pe[2]===73&&pe[3]===70&&pe[4]===0&&(D={version:{d:pe[5],T:pe[6]},K:pe[7],j:pe[8]<<8|pe[9],H:pe[10]<<8|pe[11],S:pe[12],I:pe[13],C:pe.subarray(14,14+3*pe[12]*pe[13])}),H===65518&&pe[0]===65&&pe[1]===100&&pe[2]===111&&pe[3]===98&&pe[4]===101&&(B={version:pe[5]<<8|pe[6],k:pe[7]<<8|pe[8],q:pe[9]<<8|pe[10],a:pe[11]});break;case 65499:var _e=o(S,C),xe;C+=2;for(var Y=_e+C-2;C<Y;){var F=S[C++],ie=new Uint16Array(64);if(F>>4)if(F>>4===1)for(Q=0;Q<64;Q++)xe=r[Q],ie[xe]=o(S,C),C+=2;else throw new a("DQT - invalid table spec");else for(Q=0;Q<64;Q++)xe=r[Q],ie[xe]=S[C++];N[F&15]=ie}break;case 65472:case 65473:case 65474:if(Z)throw new a("Only single frame JPEGs supported");C+=2,Z={},Z.G=H===65473,Z.Z=H===65474,Z.precision=S[C++];var ae=o(S,C),de,ve=0,ee=0;C+=2,Z.s=R||ae,Z.o=o(S,C),C+=2,Z.W=[],Z._={};var se=S[C++];for(X=0;X<se;X++){de=S[C];var K=S[C+1]>>4,I=S[C+1]&15;ve<K&&(ve=K),ee<I&&(ee=I);var U=S[C+2];ce=Z.W.push({h:K,A:I,L:U,$:null}),Z._[de]=ce-1,C+=3}Z.X=ve,Z.B=ee,w(Z);break;case 65476:var oe=o(S,C);for(C+=2,X=2;X<oe;){var ge=S[C++],Se=new Uint8Array(16),Ce=0;for(Q=0;Q<16;Q++,C++)Ce+=Se[Q]=S[C];var Re=new Uint8Array(Ce);for(Q=0;Q<Ce;Q++,C++)Re[Q]=S[C];X+=17+Ce,(ge>>4?G:V)[ge&15]=L(Se,Re)}break;case 65501:C+=2,J=o(S,C),C+=2;break;case 65498:var qe=++q===1&&!R,Ge;C+=2;var Ye=S[C++],He=[];for(X=0;X<Ye;X++){var Xe=S[C++],Qe=Z._[Xe];Ge=Z.W[Qe],Ge.index=Xe;var je=S[C++];Ge.J=V[je>>4],Ge.i=G[je&15],He.push(Ge)}var W=S[C++],re=S[C++],ue=S[C++];try{var he=g(S,C,Z,He,J,W,re,ue>>4,ue&15,qe);C+=he}catch(fe){if(fe instanceof DNLMarkerError)return this.parse(S,{F:fe.s});if(fe instanceof EOIMarkerError)break e;throw fe}break;case 65500:C+=4;break;case 65535:S[C]!==255&&C--;break;default:var we=b(S,C-2,C-3);if(we&&we.u){C=we.offset;break}if(C>=S.length-1)break e;throw new a("JpegImage.parse - unknown marker: "+H.toString(16))}H=o(S,C),C+=2}for(this.width=Z.o,this.height=Z.s,this.g=D,this.b=B,this.W=[],X=0;X<Z.W.length;X++){Ge=Z.W[X];var $e=N[Ge.L];$e&&(Ge.$=$e),this.W.push({index:Ge.index,e:u(Z,Ge),l:Ge.h/Z.X,t:Ge.A/Z.B,P:Ge.P,c:Ge.c})}this.p=this.W.length},Y(S,M,R){R==null&&(R=!1);var C=this.width/S,D=this.height/M,B,Z,J,q,z,w,N,G,V,H,X=0,Q,ce=this.W.length,pe=S*M*ce,_e=new Uint8ClampedArray(pe),xe=new Uint32Array(S),Y=4294967288,F;for(N=0;N<ce;N++){if(B=this.W[N],Z=B.l*C,J=B.t*D,X=N,Q=B.e,q=B.P+1<<3,Z!==F){for(z=0;z<S;z++)G=0|z*Z,xe[z]=(G&Y)<<3|G&7;F=Z}for(w=0;w<M;w++)for(G=0|w*J,H=q*(G&Y)|(G&7)<<3,z=0;z<S;z++)_e[X]=Q[H+xe[z]],X+=ce}var ie=this.V;if(!R&&ce===4&&!ie&&(ie=new Int32Array([-256,255,-256,255,-256,255,-256,255])),ie)for(N=0;N<pe;)for(G=0,V=0;G<ce;G++,N++,V+=2)_e[N]=(_e[N]*ie[V]>>8)+ie[V+1];return _e},get f(){return this.b?!!this.b.a:this.p===3?this.N===0?!1:!(this.W[0].index===82&&this.W[1].index===71&&this.W[2].index===66):this.N===1},z:function(M){for(var R,C,D,B=0,Z=M.length;B<Z;B+=3)R=M[B],C=M[B+1],D=M[B+2],M[B]=R-179.456+1.402*D,M[B+1]=R+135.459-.344*C-.714*D,M[B+2]=R-226.816+1.772*C;return M},O:function(M){for(var R,C,D,B,Z=0,J=0,q=M.length;J<q;J+=4)R=M[J],C=M[J+1],D=M[J+2],B=M[J+3],M[Z++]=-122.67195406894+C*(-660635669420364e-19*C+.000437130475926232*D-54080610064599e-18*R+.00048449797120281*B-.154362151871126)+D*(-.000957964378445773*D+.000817076911346625*R-.00477271405408747*B+1.53380253221734)+R*(.000961250184130688*R-.00266257332283933*B+.48357088451265)+B*(-.000336197177618394*B+.484791561490776),M[Z++]=107.268039397724+C*(219927104525741e-19*C-.000640992018297945*D+.000659397001245577*R+.000426105652938837*B-.176491792462875)+D*(-.000778269941513683*D+.00130872261408275*R+.000770482631801132*B-.151051492775562)+R*(.00126935368114843*R-.00265090189010898*B+.25802910206845)+B*(-.000318913117588328*B-.213742400323665),M[Z++]=-20.810012546947+C*(-.000570115196973677*C-263409051004589e-19*D+.0020741088115012*R-.00288260236853442*B+.814272968359295)+D*(-153496057440975e-19*D-.000132689043961446*R+.000560833691242812*B-.195152027534049)+R*(.00174418132927582*R-.00255243321439347*B+.116935020465145)+B*(-.000343531996510555*B+.24165260232407);return M.subarray(0,Z)},r:function(M){for(var R,C,D,B=0,Z=M.length;B<Z;B+=4)R=M[B],C=M[B+1],D=M[B+2],M[B]=434.456-R-1.402*D,M[B+1]=119.541-R+.344*C+.714*D,M[B+2]=481.816-R-1.772*C;return M},U:function(M){for(var R,C,D,B,Z=0,J=0,q=M.length;J<q;J+=4)R=M[J],C=M[J+1],D=M[J+2],B=M[J+3],M[Z++]=255+R*(-6747147073602441e-20*R+.0008379262121013727*C+.0002894718188643294*D+.003264231057537806*B-1.1185611867203937)+C*(26374107616089405e-21*C-8626949158638572e-20*D-.0002748769067499491*B-.02155688794978967)+D*(-3878099212869363e-20*D-.0003267808279485286*B+.0686742238595345)-B*(.0003361971776183937*B+.7430659151342254),M[Z++]=255+R*(.00013596372813588848*R+.000924537132573585*C+.00010567359618683593*D+.0004791864687436512*B-.3109689587515875)+C*(-.00023545346108370344*C+.0002702845253534714*D+.0020200308977307156*B-.7488052167015494)+D*(6834815998235662e-20*D+.00015168452363460973*B-.09751927774728933)-B*(.0003189131175883281*B+.7364883807733168),M[Z++]=255+R*(13598650411385307e-21*R+.00012423956175490851*C+.0004751985097583589*D-36729317476630422e-22*B-.05562186980264034)+C*(.00016141380598724676*C+.0009692239130725186*D+.0007782692450036253*B-.44015232367526463)+D*(5068882914068769e-22*D+.0017778369011375071*B-.7591454649749609)-B*(.0003435319965105553*B+.7063770186160144);return M.subarray(0,Z)},getData:function(S){var M=S.width,R=S.height,C=S.forceRGB,D=S.isSourcePDF;if(this.p>4)throw new a("Unsupported color mode");var B=this.Y(M,R,D);if(this.p===1&&C){for(var Z=B.length,J=new Uint8ClampedArray(Z*3),q=0,z=0;z<Z;z++){var w=B[z];J[q++]=w,J[q++]=w,J[q++]=w}return J}else{if(this.p===3&&this.f)return this.z(B);if(this.p===4){if(this.f)return C?this.O(B):this.r(B);if(C)return this.U(B)}}return B}},P}();function o(l,r){return l[r]<<8|l[r+1]}e.JpegDecoder=i})(),e.encodeImage=function(a,i,o,l){var r={t256:[i],t257:[o],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[o],t279:[i*o*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(l)for(var d in l)r[d]=l[d];for(var h=new Uint8Array(e.encode([r])),v=new Uint8Array(a),p=new Uint8Array(1e3+i*o*4),d=0;d<h.length;d++)p[d]=h[d];for(var d=0;d<v.length;d++)p[1e3+d]=v[d];return p.buffer},e.encode=function(a){var i=new Uint8Array(2e4),o=4,l=e._binBE;i[0]=i[1]=77,l.writeUshort(i,2,42);var r=8;l.writeUint(i,o,r),o+=4;for(var d=0;d<a.length;d++){var h=e._writeIFD(l,e._types.basic,i,r,a[d]);r=h[1],d<a.length-1&&(r&3&&(r+=4-(r&3)),l.writeUint(i,h[0],r))}return i.slice(0,r).buffer},e.decode=function(a,i){i==null&&(i={parseMN:!0,debug:!1});var o=new Uint8Array(a),l=0,r=e._binBE.readASCII(o,l,2);l+=2;var d=r=="II"?e._binLE:e._binBE;d.readUshort(o,l),l+=2;var h=d.readUint(o,l);l+=4;for(var v=[];;){var p=d.readUshort(o,h),m=d.readUshort(o,h+4);if(p!=0&&(m<1||13<m)){s("error in TIFF");break}if(e._readIFD(d,o,h,v,0,i),h=d.readUint(o,h+2+p*12),h==0)break}return v},e.decodeImage=function(a,i,o){if(!i.data){var l=new Uint8Array(a),r=e._binBE.readASCII(l,0,2);if(i.t256!=null){i.isLE=r=="II",i.width=i.t256[0],i.height=i.t257[0];var d=i.t259?i.t259[0]:1,h=i.t266?i.t266[0]:1;i.t284&&i.t284[0]==2&&s("PlanarConfiguration 2 should not be used!");var v;i.t258?v=Math.min(32,i.t258[0])*i.t258.length:v=i.t277?i.t277[0]:1,d==1&&i.t279!=null&&i.t278&&i.t262[0]==32803&&(v=Math.round(i.t279[0]*8/(i.width*i.t278[0])));var p=Math.ceil(i.width*v/8)*8,m=i.t273;m==null&&(m=i.t324);var A=i.t279;d==1&&m.length==1&&(A=[i.height*(p>>>3)]),A==null&&(A=i.t325);var y=new Uint8Array(i.height*(p>>>3)),x=0;if(i.t322!=null){for(var P=i.t322[0],L=i.t323[0],T=Math.floor((i.width+P-1)/P),g=Math.floor((i.height+L-1)/L),_=new Uint8Array(Math.ceil(P*L*v/8)|0),u=0;u<g;u++)for(var b=0;b<T;b++){for(var S=u*T+b,M=0;M<_.length;M++)_[M]=0;e.decode._decompress(i,o,l,m[S],A[S],d,_,0,h),d==6?y=_:e._copyTile(_,Math.ceil(P*v/8)|0,L,y,Math.ceil(i.width*v/8)|0,i.height,Math.ceil(b*P*v/8)|0,u*L)}x=y.length*8}else{var R=i.t278?i.t278[0]:i.height;R=Math.min(R,i.height);for(var S=0;S<m.length;S++)e.decode._decompress(i,o,l,m[S],A[S],d,y,Math.ceil(x/8)|0,h),x+=p*R;x=Math.min(x,y.length*8)}i.data=new Uint8Array(y.buffer,0,Math.ceil(x/8)|0)}}},e.decode._decompress=function(a,i,o,l,r,d,h,v,p){if(d==1)for(var m=0;m<r;m++)h[v+m]=o[l+m];else if(d==3)e.decode._decodeG3(o,l,r,h,v,a.width,p,a.t292?(a.t292[0]&1)==1:!1);else if(d==4)e.decode._decodeG4(o,l,r,h,v,a.width,p);else if(d==5)e.decode._decodeLZW(o,l,r,h,v,8);else if(d==6)e.decode._decodeOldJPEG(a,o,l,r,h,v);else if(d==7||d==34892)e.decode._decodeNewJPEG(a,o,l,r,h,v);else if(d==8||d==32946)for(var A=new Uint8Array(o.buffer,l,r),y=c.inflate(A),x=0;x<y.length;x++)h[v+x]=y[x];else d==9?e.decode._decodeVC5(o,l,r,h,v):d==32767?e.decode._decodeARW(a,o,l,r,h,v):d==32773?e.decode._decodePackBits(o,l,r,h,v):d==32809?e.decode._decodeThunder(o,l,r,h,v):d==34713?e.decode._decodeNikon(a,i,o,l,r,h,v):s("Unknown compression",d);var P=a.t258?Math.min(32,a.t258[0]):1,L=a.t277?a.t277[0]:1,T=P*L>>>3,g=a.t278?a.t278[0]:a.height,_=Math.ceil(P*L*a.width/8);if(P==16&&!a.isLE&&a.t33422==null)for(var u=0;u<g;u++)for(var b=v+u*_,S=1;S<_;S+=2){var M=h[b+S];h[b+S]=h[b+S-1],h[b+S-1]=M}if(a.t317&&a.t317[0]==2)for(var u=0;u<g;u++){var R=v+u*_;if(P==16)for(var m=T;m<_;m+=2){var C=(h[R+m+1]<<8|h[R+m])+(h[R+m-T+1]<<8|h[R+m-T]);h[R+m]=C&255,h[R+m+1]=C>>>8&255}else if(L==3)for(var m=3;m<_;m+=3)h[R+m]=h[R+m]+h[R+m-3]&255,h[R+m+1]=h[R+m+1]+h[R+m-2]&255,h[R+m+2]=h[R+m+2]+h[R+m-1]&255;else for(var m=T;m<_;m++)h[R+m]=h[R+m]+h[R+m-T]&255}},e.decode._decodeVC5=e.decode._decodeVC5=function(){var a=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],i,o,l,r=[3,3,3,3,2,2,2,1,1,1],d=24576,h=16384,v=8192,p=h|v;function m(u){var b=u[1],S=u[0][b>>>3]>>>7-(b&7)&1;return u[1]++,S}function A(u,b){if(i==null){i={};for(var S=0;S<a.length;S+=4)i[a[S+1]]=a.slice(S,S+4)}for(var M=m(u),R=i[M];R==null;)M=M<<1|m(u),R=i[M];var C=R[3];C!=0&&(C=m(u)==0?C:-C),b[0]=R[2],b[1]=C}function y(u,b){for(var S=0;S<b;S++)(u&1)==1&&u++,u=u>>>1;return u}function x(u,b){return u>>b}function P(u,b,S,M,R,C){b[S]=x(x(11*u[R]-4*u[R+C]+u[R+C+C]+4,3)+u[M],1),b[S+C]=x(x(5*u[R]+4*u[R+C]-u[R+C+C]+4,3)-u[M],1)}function L(u,b,S,M,R,C){var D=u[R-C]-u[R+C],B=u[R],Z=u[M];b[S]=x(x(D+4,3)+B+Z,1),b[S+C]=x(x(-D+4,3)+B-Z,1)}function T(u,b,S,M,R,C){b[S]=x(x(5*u[R]+4*u[R-C]-u[R-C-C]+4,3)+u[M],1),b[S+C]=x(x(11*u[R]-4*u[R-C]+u[R-C-C]+4,3)-u[M],1)}function g(u){return u=u<0?0:u>4095?4095:u,u=l[u]>>>2,u}function _(u,b,S,M,R){M=new Uint16Array(M.buffer);var C=Date.now(),D=e._binBE,B=b+S,Z,J,q,z,w,N,G,V,H,X;for(b+=4;b<B;){var Q=D.readShort(u,b),ce=D.readUshort(u,b+2);if(b+=4,Q==12)Z=ce;else if(Q==20)J=ce;else if(Q==21)q=ce;else if(Q==48)z=ce;else if(Q==53)w=ce;else if(Q!=35){if(Q==62)N=ce;else if(Q!=101){if(Q==109)G=ce;else if(Q!=84){if(Q!=106){if(Q!=107){if(Q!=108){if(Q!=102){if(Q==104)V=ce;else if(Q!=105){var pe=Q<0?-Q:Q,_e=pe&65280,xe=0;if(pe&p&&(pe&v?(xe=ce&65535,xe+=(pe&255)<<16):xe=ce&65535),(pe&d)==d){if(H==null){H=[];for(var Y=0;Y<4;Y++)H[Y]=new Int16Array((J>>>1)*(q>>>1));X=new Int16Array((J>>>1)*(q>>>1)),o=new Int16Array(1024);for(var Y=0;Y<1024;Y++){var F=Y-512,ie=Math.abs(F),Z=Math.floor(768*ie*ie*ie/(255*255*255))+ie;o[Y]=Math.sign(F)*Z}l=new Uint16Array(4096);for(var ae=65535,Y=0;Y<4096;Y++){var de=Y,ve=ae*(Math.pow(113,de/4095)-1)/112;l[Y]=Math.min(ve,ae)}}var ee=H[N],se=y(J,1+r[z]),K=y(q,1+r[z]);if(z==0)for(var I=0;I<K;I++)for(var U=0;U<se;U++){var oe=b+(I*se+U)*2;ee[I*(J>>>1)+U]=u[oe]<<8|u[oe+1]}else{for(var ge=[u,b*8],Se=[],Ce=0,Re=se*K,qe=[0,0],Ge=0,ce=0;Ce<Re;)for(A(ge,qe),Ge=qe[0],ce=qe[1];Ge>0;)Se[Ce++]=ce,Ge--;for(var Ye=(z-1)%3,He=Ye!=1?se:0,Xe=Ye!=0?K:0,I=0;I<K;I++)for(var Qe=(I+Xe)*(J>>>1)+He,je=I*se,U=0;U<se;U++)ee[Qe+U]=o[Se[je+U]+512]*w;if(Ye==2){for(var V=J>>>1,W=se*2,re=K*2,I=0;I<K;I++)for(var U=0;U<W;U++){var Y=I*2*V+U,ue=I*V+U,he=K*V+ue;I==0?P(ee,X,Y,he,ue,V):I==K-1?T(ee,X,Y,he,ue,V):L(ee,X,Y,he,ue,V)}var we=ee;ee=X,X=we;for(var I=0;I<re;I++)for(var U=0;U<se;U++){var Y=I*V+2*U,ue=I*V+U,he=se+ue;U==0?P(ee,X,Y,he,ue,1):U==se-1?T(ee,X,Y,he,ue,1):L(ee,X,Y,he,ue,1)}var we=ee;ee=X,X=we;for(var $e=[],fe=2-~~((z-1)/3),be=0;be<3;be++)$e[be]=G>>14-be*2&3;var Ae=$e[fe];if(Ae!=0)for(var I=0;I<re;I++)for(var U=0;U<W;U++){var Y=I*V+U;ee[Y]=ee[Y]<<Ae}}}if(z==9&&N==3)for(var De=H[0],Ve=H[1],Ke=H[2],Be=H[3],I=0;I<q;I+=2)for(var U=0;U<J;U+=2){var Ie=I*J+U,oe=(I>>>1)*(J>>>1)+(U>>>1),Ue=De[oe],et=Ve[oe]-2048,nt=Ke[oe]-2048,lt=Be[oe]-2048,vt=(et<<1)+Ue,Ct=(nt<<1)+Ue,Gt=Ue+lt,_t=Ue-lt;M[Ie]=g(vt),M[Ie+1]=g(Gt),M[Ie+J]=g(_t),M[Ie+J+1]=g(Ct)}b+=xe*4}else if(pe==16388)b+=xe*4;else if(!(_e==8192||_e==8448||_e==9216))throw pe.toString(16)}}}}}}}}}console.log(Date.now()-C)}return _}(),e.decode._ljpeg_diff=function(a,i,o){var l=e.decode._getbithuff,r,d;return r=l(a,i,o[0],o),d=l(a,i,r,0),d&1<<r-1||(d-=(1<<r)-1),d},e.decode._decodeARW=function(a,i,o,l,r,d){var h=a.t256[0],v=a.t257[0],p=a.t258[0],m=a.isLE?e._binLE:e._binBE,A=h*v==l||h*v*1.5==l;if(!A){v+=8;var y=[o,0,0,0],x=new Uint16Array(32770),P=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],V,L,T,B,D,g=0,_=e.decode._ljpeg_diff;for(x[0]=15,T=V=0;V<18;V++)for(var u=32768>>>(P[V]>>>8),L=0;L<u;L++)x[++T]=P[V];for(B=h;B--;)for(D=0;D<v+1;D+=2)if(D==v&&(D=1),g+=_(i,y,x),D<v){var b=g&4095;e.decode._putsF(r,(D*h+B)*p,b<<16-p)}return}if(h*v*1.5==l){for(var V=0;V<l;V+=3){var S=i[o+V+0],M=i[o+V+1],R=i[o+V+2];r[d+V]=M<<4|S>>>4,r[d+V+1]=S<<4|R>>>4,r[d+V+2]=R<<4|M>>>4}return}var C=new Uint16Array(16),D,B,Z,J,q,z,w,N,G,V,H,X=new Uint8Array(h+1);for(D=0;D<v;D++){for(var Q=0;Q<h;Q++)X[Q]=i[o++];for(H=0,B=0;B<h-30;H+=16){for(J=2047&(Z=m.readUint(X,H)),q=2047&Z>>>11,z=15&Z>>>22,w=15&Z>>>26,N=0;N<4&&128<<N<=J-q;N++);for(G=30,V=0;V<16;V++)V==z?C[V]=J:V==w?C[V]=q:(C[V]=((m.readUshort(X,H+(G>>3))>>>(G&7)&127)<<N)+q,C[V]>2047&&(C[V]=2047),G+=7);for(V=0;V<16;V++,B+=2){var b=C[V]<<1;e.decode._putsF(r,(D*h+B)*p,b<<16-p)}B-=B&1?1:31}}},e.decode._decodeNikon=function(a,i,o,l,r,d,h){var v=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],p=a.t256[0],m=a.t257[0],A=a.t258[0],y=0,x=0,P=e.decode._make_decoder,L=e.decode._getbithuff,T=i[0].exifIFD.makerNote,g=T.t150?T.t150:T.t140,_=0,u=g[_++],b=g[_++];(u==73||b==88)&&(_+=2110),u==70&&(y=2),A==14&&(y+=3);for(var S=[[0,0],[0,0]],M=a.isLE?e._binLE:e._binBE,Z=0;Z<2;Z++)for(var R=0;R<2;R++)S[Z][R]=M.readShort(g,_),_+=2;var C=1<<A&32767,D=0,B=M.readShort(g,_);_+=2,B>1&&(D=Math.floor(C/(B-1))),u==68&&b==32&&D>0&&(x=M.readShort(g,562));var Z,J,q,z,w,N,G=[0,0],V=P(v[y]),H=[l,0,0,0];for(J=0;J<m;J++)for(x&&J==x&&(V=P(v[y+1])),q=0;q<p;q++){Z=L(o,H,V[0],V),z=Z&15,w=Z>>>4,N=(L(o,H,z-w,0)<<1)+1<<w>>>1,N&1<<z-1||(N-=(1<<z)-(w==0?1:0)),q<2?G[q]=S[J&1][q]+=N:G[q&1]+=N;var X=Math.min(Math.max(G[q&1],0),(1<<A)-1),Q=(J*p+q)*A;e.decode._putsF(d,Q,X<<16-A)}},e.decode._putsF=function(a,i,o){o=o<<8-(i&7);var l=i>>>3;a[l]|=o>>>16,a[l+1]|=o>>>8,a[l+2]|=o},e.decode._getbithuff=function(a,i,o,l){var r=0;e.decode._get_byte;var d,h=i[0],v=i[1],p=i[2],m=i[3];if(o==0||p<0)return 0;for(;!m&&p<o&&(d=a[h++])!=-1&&!(m=r);)v=(v<<8)+d,p+=8;if(d=v<<32-p>>>32-o,l?(p-=l[d+1]>>>8,d=l[d+1]&255):p-=o,p<0)throw"e";return i[0]=h,i[1]=v,i[2]=p,i[3]=m,d},e.decode._make_decoder=function(a){var i,o,l,r,d,h=[];for(i=16;i!=0&&!a[i];i--);var v=17;for(h[0]=i,l=o=1;o<=i;o++)for(r=0;r<a[o];r++,++v)for(d=0;d<1<<i-o;d++)l<=1<<i&&(h[l++]=o<<8|a[v]);return h},e.decode._decodeNewJPEG=function(a,i,o,l,r,d){l=Math.min(l,i.length-o);var h=a.t347,v=h?h.length:0,p=new Uint8Array(v+l);if(h){for(var m=216,A=217,y=0,x=0;x<v-1&&!(h[x]==255&&h[x+1]==A);x++)p[y++]=h[x];var P=i[o],L=i[o+1];(P!=255||L!=m)&&(p[y++]=P,p[y++]=L);for(var x=2;x<l;x++)p[y++]=i[o+x]}else for(var x=0;x<l;x++)p[x]=i[o+x];if(a.t262[0]==32803||a.t259[0]==7&&a.t262[0]==34892){var T=a.t258[0],g=e.LosslessJpegDecode(p),_=g.length;if(T==16)if(a.isLE)for(var x=0;x<_;x++)r[d+(x<<1)]=g[x]&255,r[d+(x<<1)+1]=g[x]>>>8;else for(var x=0;x<_;x++)r[d+(x<<1)]=g[x]>>>8,r[d+(x<<1)+1]=g[x]&255;else if(T==14||T==12)for(var u=16-T,x=0;x<_;x++)e.decode._putsF(r,x*T,g[x]<<u);else if(T==8)for(var x=0;x<_;x++)r[d+x]=g[x];else throw new Error("unsupported bit depth "+T)}else{var b=new e.JpegDecoder;b.parse(p);for(var S=b.getData({width:b.width,height:b.height,forceRGB:!0,isSourcePDF:!1}),x=0;x<S.length;x++)r[d+x]=S[x]}a.t262[0]==6&&(a.t262[0]=2)},e.decode._decodeOldJPEGInit=function(a,i,o,l){var r=216,d=219,h=196,v=221,p=192,m=218,A=0,y=0,x,P,L=!1,T,g,_,u=a.t513,b=u?u[0]:0,S=a.t514,M=S?S[0]:0,R=a.t324||a.t273||u,C=a.t530,D=0,B=0,Z=a.t277?a.t277[0]:1,J=a.t515;if(R&&(y=R[0],L=R.length>1),!L){if(i[o]==255&&i[o+1]==r)return{jpegOffset:o};if(u!=null&&(i[o+b]==255&&i[o+b+1]==r?A=o+b:s("JPEGInterchangeFormat does not point to SOI"),S==null?s("JPEGInterchangeFormatLength field is missing"):(b>=y||b+M<=y)&&s("JPEGInterchangeFormatLength field value is invalid"),A!=null))return{jpegOffset:A}}if(C!=null&&(D=C[0],B=C[1]),u!=null&&S!=null)if(M>=2&&b+M<=y){for(i[o+b+M-2]==255&&i[o+b+M-1]==r?x=new Uint8Array(M-2):x=new Uint8Array(M),T=0;T<x.length;T++)x[T]=i[o+b+T];s("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else s("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(x==null){var q=0,z=[];z[q++]=255,z[q++]=r;var w=a.t519;if(w==null)throw new Error("JPEGQTables tag is missing");for(T=0;T<w.length;T++)for(z[q++]=255,z[q++]=d,z[q++]=0,z[q++]=67,z[q++]=T,g=0;g<64;g++)z[q++]=i[o+w[T]+g];for(_=0;_<2;_++){var N=a[_==0?"t520":"t521"];if(N==null)throw new Error((_==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(T=0;T<N.length;T++){z[q++]=255,z[q++]=h;var G=19;for(g=0;g<16;g++)G+=i[o+N[T]+g];for(z[q++]=G>>>8,z[q++]=G&255,z[q++]=T|_<<4,g=0;g<16;g++)z[q++]=i[o+N[T]+g];for(g=0;g<G;g++)z[q++]=i[o+N[T]+16+g]}}if(z[q++]=255,z[q++]=p,z[q++]=0,z[q++]=8+3*Z,z[q++]=8,z[q++]=a.height>>>8&255,z[q++]=a.height&255,z[q++]=a.width>>>8&255,z[q++]=a.width&255,z[q++]=Z,Z==1)z[q++]=1,z[q++]=17,z[q++]=0;else for(T=0;T<3;T++)z[q++]=T+1,z[q++]=T!=0?17:(D&15)<<4|B&15,z[q++]=T;J!=null&&J[0]!=0&&(z[q++]=255,z[q++]=v,z[q++]=0,z[q++]=4,z[q++]=J[0]>>>8&255,z[q++]=J[0]&255),x=new Uint8Array(z)}var V=-1;for(T=0;T<x.length-1;){if(x[T]==255&&x[T+1]==p){V=T;break}T++}if(V==-1){var H=new Uint8Array(x.length+10+3*Z);H.set(x);var X=x.length;if(V=x.length,x=H,x[X++]=255,x[X++]=p,x[X++]=0,x[X++]=8+3*Z,x[X++]=8,x[X++]=a.height>>>8&255,x[X++]=a.height&255,x[X++]=a.width>>>8&255,x[X++]=a.width&255,x[X++]=Z,Z==1)x[X++]=1,x[X++]=17,x[X++]=0;else for(T=0;T<3;T++)x[X++]=T+1,x[X++]=T!=0?17:(D&15)<<4|B&15,x[X++]=T}if(i[y]==255&&i[y+1]==m){var Q=i[y+2]<<8|i[y+3];for(P=new Uint8Array(Q+2),P[0]=i[y],P[1]=i[y+1],P[2]=i[y+2],P[3]=i[y+3],T=0;T<Q-2;T++)P[T+4]=i[y+T+4]}else{P=new Uint8Array(8+2*Z);var ce=0;if(P[ce++]=255,P[ce++]=m,P[ce++]=0,P[ce++]=6+2*Z,P[ce++]=Z,Z==1)P[ce++]=1,P[ce++]=0;else for(T=0;T<3;T++)P[ce++]=T+1,P[ce++]=T<<4|T;P[ce++]=0,P[ce++]=63,P[ce++]=0}return{jpegOffset:o,tables:x,sosMarker:P,sofPosition:V}},e.decode._decodeOldJPEG=function(a,i,o,l,r,d){var h,v,p,m,A,y=e.decode._decodeOldJPEGInit(a,i,o,l);if(y.jpegOffset!=null)for(v=o+l-y.jpegOffset,m=new Uint8Array(v),h=0;h<v;h++)m[h]=i[y.jpegOffset+h];else{for(p=y.tables.length,m=new Uint8Array(p+y.sosMarker.length+l+2),m.set(y.tables),A=p,m[y.sofPosition+5]=a.height>>>8&255,m[y.sofPosition+6]=a.height&255,m[y.sofPosition+7]=a.width>>>8&255,m[y.sofPosition+8]=a.width&255,(i[o]!=255||i[o+1]!=SOS)&&(m.set(y.sosMarker,A),A+=sosMarker.length),h=0;h<l;h++)m[A++]=i[o+h];m[A++]=255,m[A++]=EOI}var x=new e.JpegDecoder;x.parse(m);for(var P=x.getData({width:x.width,height:x.height,forceRGB:!0,isSourcePDF:!1}),h=0;h<P.length;h++)r[d+h]=P[h];a.t262&&a.t262[0]==6&&(a.t262[0]=2)},e.decode._decodePackBits=function(a,i,o,l,r){for(var d=new Int8Array(a.buffer),h=new Int8Array(l.buffer),v=i+o;i<v;){var p=d[i];if(i++,p>=0&&p<128)for(var m=0;m<p+1;m++)h[r]=d[i],r++,i++;if(p>=-127&&p<0){for(var m=0;m<-p+1;m++)h[r]=d[i],r++;i++}}},e.decode._decodeThunder=function(a,i,o,l,r){for(var d=[0,1,0,-1],h=[0,1,2,3,0,-3,-2,-1],v=i+o,p=r*2,m=0;i<v;){var A=a[i],y=A>>>6,x=A&63;if(i++,y==3&&(m=x&15,l[p>>>1]|=m<<4*(1-p&1),p++),y==0)for(var P=0;P<x;P++)l[p>>>1]|=m<<4*(1-p&1),p++;if(y==2)for(var P=0;P<2;P++){var L=x>>>3*(1-P)&7;L!=4&&(m+=h[L],l[p>>>1]|=m<<4*(1-p&1),p++)}if(y==1)for(var P=0;P<3;P++){var L=x>>>2*(2-P)&3;L!=2&&(m+=d[L],l[p>>>1]|=m<<4*(1-p&1),p++)}}},e.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},e.decode._lens=function(){var a=function(p,m,A,y){for(var x=0;x<m.length;x++)p[m[x]]=A+x*y},i="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",o="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",l="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",r="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",d="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";i=i.split(","),o=o.split(","),l=l.split(","),r=r.split(","),d=d.split(",");var h={},v={};return a(h,i,0,1),a(h,l,64,64),a(h,d,1792,64),a(v,o,0,1),a(v,r,64,64),a(v,d,1792,64),[h,v]}(),e.decode._decodeG4=function(a,i,o,l,r,d,h){for(var v=e.decode,p=i<<3,m=0,A="",y=[],x=[],P=0;P<d;P++)x.push(0);x=v._makeDiff(x);for(var L=0,T=0,g=0,_=0,u=0,b=0,S="",M=0,R=Math.ceil(d/8)*8;p>>>3<i+o;){g=v._findDiff(x,L+(L==0?0:1),1-u),_=v._findDiff(x,g,u);var C=0;if(h==1&&(C=a[p>>>3]>>>7-(p&7)&1),h==2&&(C=a[p>>>3]>>>(p&7)&1),p++,A+=C,S=="H"){if(v._lens[u][A]!=null){var D=v._lens[u][A];A="",m+=D,D<64&&(v._addNtimes(y,m,u),L+=m,u=1-u,m=0,M--,M==0&&(S=""))}}else A=="0001"&&(A="",v._addNtimes(y,_-L,u),L=_),A=="001"&&(A="",S="H",M=2),v._dmap[A]!=null&&(T=g+v._dmap[A],v._addNtimes(y,T-L,u),L=T,A="",u=1-u);y.length==d&&S==""&&(v._writeBits(y,l,r*8+b*R),u=0,b++,L=0,x=v._makeDiff(y),y=[])}},e.decode._findDiff=function(a,i,o){for(var l=0;l<a.length;l+=2)if(a[l]>=i&&a[l+1]==o)return a[l]},e.decode._makeDiff=function(a){var i=[];a[0]==1&&i.push(0,1);for(var o=1;o<a.length;o++)a[o-1]!=a[o]&&i.push(o,a[o]);return i.push(a.length,0,a.length,1),i},e.decode._decodeG3=function(a,i,o,l,r,d,h,v){for(var p=e.decode,m=i<<3,A=0,y="",x=[],P=[],L=0;L<d;L++)x.push(0);for(var T=0,g=0,_=0,u=0,b=0,S=-1,M="",R=0,C=!0,D=Math.ceil(d/8)*8;m>>>3<i+o;){_=p._findDiff(P,T+(T==0?0:1),1-b),u=p._findDiff(P,_,b);var B=0;if(h==1&&(B=a[m>>>3]>>>7-(m&7)&1),h==2&&(B=a[m>>>3]>>>(m&7)&1),m++,y+=B,C){if(p._lens[b][y]!=null){var Z=p._lens[b][y];y="",A+=Z,Z<64&&(p._addNtimes(x,A,b),b=1-b,A=0)}}else if(M=="H"){if(p._lens[b][y]!=null){var Z=p._lens[b][y];y="",A+=Z,Z<64&&(p._addNtimes(x,A,b),T+=A,b=1-b,A=0,R--,R==0&&(M=""))}}else y=="0001"&&(y="",p._addNtimes(x,u-T,b),T=u),y=="001"&&(y="",M="H",R=2),p._dmap[y]!=null&&(g=_+p._dmap[y],p._addNtimes(x,g-T,b),T=g,y="",b=1-b);y.endsWith("000000000001")&&(S>=0&&p._writeBits(x,l,r*8+S*D),v&&(h==1&&(C=(a[m>>>3]>>>7-(m&7)&1)==1),h==2&&(C=(a[m>>>3]>>>(m&7)&1)==1),m++),y="",b=0,S++,T=0,P=p._makeDiff(x),x=[])}x.length==d&&p._writeBits(x,l,r*8+S*D)},e.decode._addNtimes=function(a,i,o){for(var l=0;l<i;l++)a.push(o)},e.decode._writeBits=function(a,i,o){for(var l=0;l<a.length;l++)i[o+l>>>3]|=a[l]<<7-(o+l&7)},e.decode._decodeLZW=e.decode._decodeLZW=function(){var a,i,o,l,r=0,d=0,h=0,v=0,p=function(){var g=a>>>3,_=i[g]<<16|i[g+1]<<8|i[g+2],u=_>>>24-(a&7)-d&(1<<d)-1;return a+=d,u},m=new Uint32Array(4096*4),A=0,y=function(g){if(g!=A){A=g,h=1<<g,v=h+1;for(var _=0;_<v+1;_++)m[4*_]=m[4*_+3]=_,m[4*_+1]=65535,m[4*_+2]=1}},x=function(g){d=g+1,r=v+1},P=function(g){for(var _=g<<2,u=m[_+2],b=l+u-1;_!=65535;)o[b--]=m[_],_=m[_+1];l+=u},L=function(g,_){var u=r<<2,b=g<<2;m[u]=m[(_<<2)+3],m[u+1]=b,m[u+2]=m[b+2]+1,m[u+3]=m[b+3],r++,r+1==1<<d&&d!=12&&d++},T=function(g,_,u,b,S,M){a=_<<3,i=g,o=b,l=S;var R=_+u<<3,C=0,D=0;for(y(M),x(M);a<R&&(C=p())!=v;){if(C==h){if(x(M),C=p(),C==v)break;P(C)}else C<r?(P(C),L(D,C)):(L(D,D),P(r-1));D=C}return l};return T}(),e.tags={},e._types=function(){var a=new Array(250);a.fill(0),a=a.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);var i={33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7};return{basic:{main:a,rest:i},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),e._readIFD=function(a,i,o,l,r,d){var h=a.readUshort(i,o);o+=2;var v={};d.debug&&s("   ".repeat(r),l.length-1,">>>----------------");for(var p=0;p<h;p++){var m=a.readUshort(i,o);o+=2;var A=a.readUshort(i,o);o+=2;var y=a.readUint(i,o);o+=4;var x=a.readUint(i,o);o+=4;var P=[];if((A==1||A==7)&&(P=new Uint8Array(i.buffer,y<5?o-4:x,y)),A==2){var L=y<5?o-4:x,T=i[L],g=Math.max(0,Math.min(y-1,i.length-L));T<128||g==0?P.push(a.readASCII(i,L,g)):P=new Uint8Array(i.buffer,L,g)}if(A==3)for(var _=0;_<y;_++)P.push(a.readUshort(i,(y<3?o-4:x)+2*_));if(A==4||A==13)for(var _=0;_<y;_++)P.push(a.readUint(i,(y<2?o-4:x)+4*_));if(A==5||A==10)for(var u=A==5?a.readUint:a.readInt,_=0;_<y;_++)P.push([u(i,x+_*8),u(i,x+_*8+4)]);if(A==8)for(var _=0;_<y;_++)P.push(a.readShort(i,(y<3?o-4:x)+2*_));if(A==9)for(var _=0;_<y;_++)P.push(a.readInt(i,(y<2?o-4:x)+4*_));if(A==11)for(var _=0;_<y;_++)P.push(a.readFloat(i,x+_*4));if(A==12)for(var _=0;_<y;_++)P.push(a.readDouble(i,x+_*8));if(y!=0&&P.length==0){if(s(m,"unknown TIFF tag type: ",A,"num:",y),p==0)return;continue}if(d.debug&&s("   ".repeat(r),m,A,e.tags[m],P),v["t"+m]=P,!(m==330&&v.t272&&v.t272[0]=="DSLR-A100")){if(m==330||m==34665||m==34853||m==50740&&a.readUshort(i,a.readUint(P,0))<300||m==61440){for(var b=m==50740?[a.readUint(P,0)]:P,S=[],_=0;_<b.length;_++)e._readIFD(a,i,b[_],S,r+1,d);m==330&&(v.subIFD=S),m==34665&&(v.exifIFD=S[0]),m==34853&&(v.gpsiIFD=S[0]),m==50740&&(v.dngPrvt=S[0]),m==61440&&(v.fujiIFD=S[0])}}if(m==37500&&d.parseMN){var M=P;if(a.readASCII(M,0,5)=="Nikon")v.makerNote=e.decode(M.slice(10).buffer)[0];else if(a.readUshort(i,x)<300&&a.readUshort(i,x+4)<=12){var R=[];e._readIFD(a,i,x,R,r+1,d),v.makerNote=R[0]}}}return l.push(v),d.debug&&s("   ".repeat(r),"<<<---------------"),o},e._writeIFD=function(a,i,o,l,r){var d=Object.keys(r),h=d.length;r.exifIFD&&h--,r.gpsiIFD&&h--,a.writeUshort(o,l,h),l+=2;for(var v=l+h*12+4,p=0;p<d.length;p++){var m=d[p];if(!(m=="t34665"||m=="t34853")){m=="exifIFD"&&(m="t34665"),m=="gpsiIFD"&&(m="t34853");var A=parseInt(m.slice(1)),y=i.main[A];if(y==null&&(y=i.rest[A]),y==null||y==0)throw new Error("unknown type of tag: "+A);var x=r[m];if(A==34665){var P=e._writeIFD(a,i,o,v,r.exifIFD);x=[v],v=P[1]}if(A==34853){var P=e._writeIFD(a,e._types.gps,o,v,r.gpsiIFD);x=[v],v=P[1]}y==2&&(x=x[0]+"\0");var L=x.length;a.writeUshort(o,l,A),l+=2,a.writeUshort(o,l,y),l+=2,a.writeUint(o,l,L),l+=4;var T=[-1,1,1,2,4,8,0,1,0,4,8,0,8][y]*L,g=l;if(T>4&&(a.writeUint(o,l,v),g=v),y==1||y==7)for(var _=0;_<L;_++)o[g+_]=x[_];else if(y==2)a.writeASCII(o,g,x);else if(y==3)for(var _=0;_<L;_++)a.writeUshort(o,g+2*_,x[_]);else if(y==4)for(var _=0;_<L;_++)a.writeUint(o,g+4*_,x[_]);else if(y==5||y==10)for(var u=y==5?a.writeUint:a.writeInt,_=0;_<L;_++){var b=x[_],S=b[0],M=b[1];if(S==null)throw"e";u(o,g+8*_,S),u(o,g+8*_+4,M)}else if(y==9)for(var _=0;_<L;_++)a.writeInt(o,g+4*_,x[_]);else if(y==12)for(var _=0;_<L;_++)a.writeDouble(o,g+8*_,x[_]);else throw y;T>4&&(T+=T&1,v+=T),l+=4}}return[l,v]},e.toRGBA8=function(a,i){var o=a.width,l=a.height,r=o*l,d=r*4,h=a.data,v=new Uint8Array(r*4),p=a.t262?a.t262[0]:2,m=a.t258?Math.min(32,a.t258[0]):1;if(a.t262==null&&m==1&&(p=0),p==0)for(var A=Math.ceil(m*o/8),y=0;y<l;y++){var x=y*A,P=y*o;if(m==1)for(var L=0;L<o;L++){var T=P+L<<2,g=h[x+(L>>3)]>>7-(L&7)&1;v[T]=v[T+1]=v[T+2]=(1-g)*255,v[T+3]=255}if(m==4)for(var L=0;L<o;L++){var T=P+L<<2,g=h[x+(L>>1)]>>4-4*(L&1)&15;v[T]=v[T+1]=v[T+2]=(15-g)*17,v[T+3]=255}if(m==8)for(var L=0;L<o;L++){var T=P+L<<2,g=h[x+L];v[T]=v[T+1]=v[T+2]=255-g,v[T+3]=255}}else if(p==1){var _=a.t258?a.t258.length:1,A=Math.ceil(_*m*o/8);i==null&&(i=1/256);for(var y=0;y<l;y++){var x=y*A,P=y*o;if(m==1)for(var L=0;L<o;L++){var T=P+L<<2,g=h[x+(L>>3)]>>7-(L&7)&1;v[T]=v[T+1]=v[T+2]=g*255,v[T+3]=255}if(m==2)for(var L=0;L<o;L++){var T=P+L<<2,g=h[x+(L>>2)]>>6-2*(L&3)&3;v[T]=v[T+1]=v[T+2]=g*85,v[T+3]=255}if(m==8)for(var L=0;L<o;L++){var T=P+L<<2,g=h[x+L*_];v[T]=v[T+1]=v[T+2]=g,v[T+3]=255}if(m==16)for(var L=0;L<o;L++){var T=P+L<<2,u=x+2*L,g=h[u+1]<<8|h[u];v[T]=v[T+1]=v[T+2]=Math.min(255,~~(g*i)),v[T+3]=255}}}else if(p==2){var _=a.t258?a.t258.length:3;if(m==8){if(_==4)for(var L=0;L<d;L++)v[L]=h[L];if(_==3)for(var L=0;L<r;L++){var T=L<<2,b=L*3;v[T]=h[b],v[T+1]=h[b+1],v[T+2]=h[b+2],v[T+3]=255}if(_==5)for(var L=0;L<r;L++){var T=L<<2,b=L*5;v[T]=h[b],v[T+1]=h[b+1],v[T+2]=h[b+2],v[T+3]=h[b+3]}}else{if(_==4)for(var L=0;L<r;L++){var T=L<<2,b=L*8+1;v[T]=h[b],v[T+1]=h[b+2],v[T+2]=h[b+4],v[T+3]=h[b+6]}if(_==3)for(var L=0;L<r;L++){var T=L<<2,b=L*6+1;v[T]=h[b],v[T+1]=h[b+2],v[T+2]=h[b+4],v[T+3]=255}}}else if(p==3)for(var S=a.t320,_=a.t258?a.t258.length:1,A=Math.ceil(_*m*o/8),M=1<<m,y=0;y<l;y++)for(var R=0;R<o;R++){var L=y*o+R,T=L<<2,C=0,D=y*A;if(m==1)C=h[D+(R>>>3)]>>>7-(R&7)&1;else if(m==2)C=h[D+(R>>>2)]>>>6-2*(R&3)&3;else if(m==4)C=h[D+(R>>>1)]>>>4-4*(R&1)&15;else if(m==8)C=h[D+R*_];else throw m;v[T]=S[C]>>8,v[T+1]=S[M+C]>>8,v[T+2]=S[M+M+C]>>8,v[T+3]=255}else if(p==5)for(var _=a.t258?a.t258.length:4,B=_>4?1:0,L=0;L<r;L++){var T=L<<2,Z=L*_,J=255-h[Z],q=255-h[Z+1],z=255-h[Z+2],w=(255-h[Z+3])*(1/255);v[T]=~~(J*w+.5),v[T+1]=~~(q*w+.5),v[T+2]=~~(z*w+.5),v[T+3]=255*(1-B)+h[Z+4]*B}else if(p==6&&a.t278)for(var N=a.t278[0],y=0;y<l;y+=N)for(var L=y*o,G=N*o,V=0;V<G;V++){var T=4*(L+V),Z=3*L+4*(V>>>1),z=h[Z+(V&1)],H=h[Z+2]-128,X=h[Z+3]-128,Q=z+((X>>2)+(X>>3)+(X>>5)),ce=z-((H>>2)+(H>>4)+(H>>5))-((X>>1)+(X>>3)+(X>>4)+(X>>5)),pe=z+(H+(H>>1)+(H>>2)+(H>>6));v[T]=Math.max(0,Math.min(255,Q)),v[T+1]=Math.max(0,Math.min(255,ce)),v[T+2]=Math.max(0,Math.min(255,pe)),v[T+3]=255}else s("Unknown Photometric interpretation: "+p);return v},e.replaceIMG=function(a){a==null&&(a=document.getElementsByTagName("img"));for(var i=["tif","tiff","dng","cr2","nef"],o=0;o<a.length;o++){var l=a[o],r=l.getAttribute("src");if(r!=null){var d=r.split(".").pop().toLowerCase();if(i.indexOf(d)!=-1){var h=new XMLHttpRequest;e._xhrs.push(h),e._imgs.push(l),h.open("GET",r),h.responseType="arraybuffer",h.onload=e._imgLoaded,h.send()}}}},e._xhrs=[],e._imgs=[],e._imgLoaded=function(a){var i=e._xhrs.indexOf(a.target),o=e._imgs[i];e._xhrs.splice(i,1),e._imgs.splice(i,1),o.setAttribute("src",e.bufferToURI(a.target.response))},e.bufferToURI=function(a){var i=e.decode(a),o=i,l=0,r=o[0];i[0].subIFD&&(o=o.concat(i[0].subIFD));for(var d=0;d<o.length;d++){var h=o[d];if(!(h.t258==null||h.t258.length<3)){var v=h.t256*h.t257;v>l&&(l=v,r=h)}}e.decodeImage(a,r,i);var p=e.toRGBA8(r),m=r.width,A=r.height,y=document.createElement("canvas");y.width=m,y.height=A;var x=y.getContext("2d"),P=new ImageData(new Uint8ClampedArray(p.buffer),m,A);return x.putImageData(P,0,0),y.toDataURL()},e._binBE={nextZero:function(a,i){for(;a[i]!=0;)i++;return i},readUshort:function(a,i){return a[i]<<8|a[i+1]},readShort:function(a,i){var o=e._binBE.ui8;return o[0]=a[i+1],o[1]=a[i+0],e._binBE.i16[0]},readInt:function(a,i){var o=e._binBE.ui8;return o[0]=a[i+3],o[1]=a[i+2],o[2]=a[i+1],o[3]=a[i+0],e._binBE.i32[0]},readUint:function(a,i){var o=e._binBE.ui8;return o[0]=a[i+3],o[1]=a[i+2],o[2]=a[i+1],o[3]=a[i+0],e._binBE.ui32[0]},readASCII:function(a,i,o){for(var l="",r=0;r<o;r++)l+=String.fromCharCode(a[i+r]);return l},readFloat:function(a,i){for(var o=e._binBE.ui8,l=0;l<4;l++)o[l]=a[i+3-l];return e._binBE.fl32[0]},readDouble:function(a,i){for(var o=e._binBE.ui8,l=0;l<8;l++)o[l]=a[i+7-l];return e._binBE.fl64[0]},writeUshort:function(a,i,o){a[i]=o>>8&255,a[i+1]=o&255},writeInt:function(a,i,o){var l=e._binBE.ui8;e._binBE.i32[0]=o,a[i+3]=l[0],a[i+2]=l[1],a[i+1]=l[2],a[i+0]=l[3]},writeUint:function(a,i,o){a[i]=o>>24&255,a[i+1]=o>>16&255,a[i+2]=o>>8&255,a[i+3]=o>>0&255},writeASCII:function(a,i,o){for(var l=0;l<o.length;l++)a[i+l]=o.charCodeAt(l)},writeDouble:function(a,i,o){e._binBE.fl64[0]=o;for(var l=0;l<8;l++)a[i+l]=e._binBE.ui8[7-l]}},e._binBE.ui8=new Uint8Array(8),e._binBE.i16=new Int16Array(e._binBE.ui8.buffer),e._binBE.i32=new Int32Array(e._binBE.ui8.buffer),e._binBE.ui32=new Uint32Array(e._binBE.ui8.buffer),e._binBE.fl32=new Float32Array(e._binBE.ui8.buffer),e._binBE.fl64=new Float64Array(e._binBE.ui8.buffer),e._binLE={nextZero:e._binBE.nextZero,readUshort:function(a,i){return a[i+1]<<8|a[i]},readShort:function(a,i){var o=e._binBE.ui8;return o[0]=a[i+0],o[1]=a[i+1],e._binBE.i16[0]},readInt:function(a,i){var o=e._binBE.ui8;return o[0]=a[i+0],o[1]=a[i+1],o[2]=a[i+2],o[3]=a[i+3],e._binBE.i32[0]},readUint:function(a,i){var o=e._binBE.ui8;return o[0]=a[i+0],o[1]=a[i+1],o[2]=a[i+2],o[3]=a[i+3],e._binBE.ui32[0]},readASCII:e._binBE.readASCII,readFloat:function(a,i){for(var o=e._binBE.ui8,l=0;l<4;l++)o[l]=a[i+l];return e._binBE.fl32[0]},readDouble:function(a,i){for(var o=e._binBE.ui8,l=0;l<8;l++)o[l]=a[i+l];return e._binBE.fl64[0]},writeUshort:function(a,i,o){a[i]=o&255,a[i+1]=o>>8&255},writeInt:function(a,i,o){var l=e._binBE.ui8;e._binBE.i32[0]=o,a[i+0]=l[0],a[i+1]=l[1],a[i+2]=l[2],a[i+3]=l[3]},writeUint:function(a,i,o){a[i]=o>>>0&255,a[i+1]=o>>>8&255,a[i+2]=o>>>16&255,a[i+3]=o>>>24&255},writeASCII:e._binBE.writeASCII},e._copyTile=function(a,i,o,l,r,d,h,v){for(var p=Math.min(i,r-h),m=Math.min(o,d-v),A=0;A<m;A++)for(var y=(v+A)*r+h,x=A*i,P=0;P<p;P++)l[y+P]=a[x+P]},e.LosslessJpegDecode=function(){var a,i,o,l,r,d,h,v,p,m;function A(){return a[i++]}function y(){return a[i++]<<8|a[i++]}function x(){for(var C=A(),D=[0,0,0,255],B=[],Z=8,J=0;J<16;J++)B[J]=A();for(var J=0;J<16;J++)for(var q=0;q<B[J];q++){var z=P(D,0,J+1,1);D[z+3]=A()}var w=new Uint8Array(1<<Z);p[C]=[new Uint8Array(D),w];for(var J=0;J<1<<Z;J++){for(var N=Z,G=J,V=0,H=0;D[V+3]==255&&N!=0;)H=G>>--N&1,V=D[V+H];w[J]=V}}function P(C,D,B,Z){if(C[D+3]!=255)return 0;if(B==0)return D;for(var J=0;J<2;J++){C[D+J]==0&&(C[D+J]=C.length,C.push(0,0,Z,255));var q=P(C,C[D+J],B-1,Z+1);if(q!=0)return q}return 0}function L(C){for(var D=C.e,B=C.c;D<25&&C.a<C.d;){var Z=C.data[C.a++];C.b||(C.a+=Z+1>>>8),B=B<<8|Z,D+=8}C.e=D,C.c=B}function T(C,D){return D.e<C&&L(D),D.c>>(D.e-=C)&65535>>16-C}function g(C,D){var B=C[0],Z=0,J=255,q=0;D.e<16&&L(D);var z=D.c>>D.e-8&255;for(Z=C[1][z],J=B[Z+3],D.e-=B[Z+2];J==255;)q=D.c>>--D.e&1,Z=B[Z+q],J=B[Z+3];return J}function _(C,D){return C<32768>>16-D&&(C+=-(1<<D)+1),C}function u(C,D){var B=g(C,D);if(B==0)return 0;if(B==16)return-32768;var Z=T(B,D);return _(Z,B)}function b(C,D,B){for(var Z=d,J=l,q=h,z=m,w=0;w<Z;w++)C[w]=u(z[w],B)+(1<<o-1);for(var N=Z;N<D;N+=Z)for(var w=0;w<Z;w++)C[N+w]=u(z[w],B)+C[N+w-Z];for(var G=D,V=1;V<J;V++){for(var w=0;w<Z;w++)C[G+w]=u(z[w],B)+C[G+w-D];for(var N=Z;N<D;N+=Z)for(var w=0;w<Z;w++){var H=G+N+w,X=C[H-Z],Q=0;if(q==0)Q=0;else if(q==1)Q=X;else if(q==2)Q=C[H-D];else if(q==3)Q=C[H-D-Z];else if(q==4)Q=X+(C[H-D]-C[H-D-Z]);else if(q==5)Q=X+(C[H-D]-C[H-D-Z]>>>1);else if(q==6)Q=C[H-D]+(X-C[H-D-Z]>>>1);else if(q==7)Q=X+C[H-D]>>>1;else throw q;C[H]=Q+u(z[w],B)}G+=D}}function S(C,D){return _(T(C,D),C)}function M(C,D,B){for(var Z=a.length-i,J=0;J<Z;J+=4){var q=a[i+J];a[i+J]=a[i+J+3],a[i+J+3]=q;var q=a[i+J+1];a[i+J+1]=a[i+J+2],a[i+J+2]=q}for(var z=m[0],w=0;w<l;w++)for(var N=32768,G=32768,V=0;V<D;V+=2){var H=g(z,B),X=g(z,B);H!=0&&(N+=S(H,B)),X!=0&&(G+=S(X,B)),C[w*D+V]=N&65535,C[w*D+V+1]=G&65535}}function R(C){if(a=C,i=0,p=[],m=[],y()!=65496)throw"e";for(;;){var D=y();if(D==65535){i--;continue}var B=y();if(D==65475){o=A(),l=y(),r=y(),d=A(),v=[];for(var Z=0;Z<d;Z++){var J=A(),q=A();if(q!=17)throw"e";var z=A();if(z!=0)throw"e";v[J]=Z}}else if(D==65476)for(var w=i+B-2;i<w;)x();else if(D==65498){i++;for(var Z=0;Z<d;Z++){var N=A();m[v[N]]=p[A()>>>4]}h=A(),i+=2;break}else i+=B-2}var G=o>8?Uint16Array:Uint8Array,V=r*d,H=new G(l*V),X={e:0,c:0,b:h==8,a:i,data:a,d:a.length};return X.b?M(H,V,X):b(H,V,X),H}return R}(),function(){var a=0,i=1,o=2,l=3,r=4,d=5,h=6,v=7,p=8,m=9,A=10,y=11,x=12,P=13,L=14,T=15,g=16,_=17,u=18;function b(H){var X=e._binBE.readUshort,Q={m:X(H,0),f:H[2],r:H[3],a:H[4],d:X(H,5),t:X(H,7),h:X(H,9),n:X(H,11),v:H[13],p:X(H,14)};if(Q.m!=18771||Q.f>1||Q.d<6||Q.d%6||Q.h<768||Q.h%24||Q.n!=768||Q.t<Q.n||Q.t%Q.n||Q.t-Q.h>=Q.n||Q.v>16||Q.v!=Q.t/Q.n||Q.v!=Math.ceil(Q.h/Q.n)||Q.p!=Q.d/6||Q.a!=12&&Q.a!=14&&Q.a!=16||Q.r!=16&&Q.r!=0)throw"Invalid data";if(Q.f==0)throw"Not implemented. We need this file!";return Q.o=Q.r==16,Q.c=(Q.o?Q.n*2/3:Q.n>>>1)|0,Q.g=Q.c+2,Q.q=64,Q.j=(1<<Q.a)-1,Q.w=4*Q.a,Q}function S(H,X){for(var Q=new Array(X.v),ce=16+4*X.v,pe=0,_e=16;pe<X.v;_e+=4){var xe=e._binBE.readUint(H,_e);Q[pe]=H.slice(ce,ce+xe),Q[pe].l=0,Q[pe].s=0,ce+=xe,pe++}if(ce!=H.length)throw"Invalid data";return Q}function M(H,X){for(var Q=-X[4],ce=0;Q<=X[4];ce++,Q++)H[ce]=Q<=-X[3]?-4:Q<=-X[2]?-3:Q<=-X[1]?-2:Q<-X[0]?-1:Q<=X[0]?0:Q<X[1]?1:Q<X[2]?2:Q<X[3]?3:4}function R(H,X,Q){var ce=[X,3*X+18,5*X+67,7*X+276,Q];H.k=X,H.i=(ce[4]+2*X)/(2*X+1)+1|0,H.b=Math.ceil(Math.log2(H.i)),H.e=9,M(H.u,ce)}function C(H){var X={u:new Int8Array(2<<H.a)};return R(X,0,H.j),X}function D(H){for(var X=[[],[],[]],Q=Math.max(2,H.i+32>>>6),ce=0;ce<3;ce++)for(var pe=0;pe<41;pe++)X[ce][pe]=[Q,1];return X}function B(H){for(var X=-1,Q=0;!Q;X++)Q=H[H.l]>>>7-H.s&1,H.s++,H.s&=7,H.s||H.l++;return X}function Z(H,X){var Q=0,ce=8-H.s;if(H.l,H.s,X){if(X>=ce)do Q<<=ce,X-=ce,Q|=H[H.l]&(1<<ce)-1,H.l++,ce=8;while(X>=8);X&&(Q<<=X,ce-=X,Q|=H[H.l]>>>ce&(1<<X)-1),H.s=8-ce}return Q}function J(H,X){var Q=0;if(X<H)for(;Q<=14&&X<<++Q<H;);return Q}function q(H,X,Q,ce,pe,_e,xe,Y){Y==null&&(Y=0);var F=_e+1,ie=F%2,ae=0,de,ve,ee=ce[pe],se=ce[pe-1],K=ce[pe-2][F],I=se[F-1],U=se[F],oe=se[F+1],ge=ee[F-1],Se=ee[F+1],Ce=Math.abs,Re,qe,Ge,Ye;if(ie&&(Re=Ce(oe-U),qe=Ce(K-U),Ge=Ce(I-U)),ie){if(Ye=Re>Ge&&qe<Re?K+I:Re<Ge&&qe<Ge?K+oe:oe+I,Ye=Ye+2*U>>>2,Y){ee[F]=Ye;return}de=X.e*X.u[H.j+U-K]+X.u[H.j+I-U]}else Ye=U>I&&U>oe||U<I&&U<oe?Se+ge+2*U>>>2:ge+Se>>>1,de=X.e*X.u[H.j+U-I]+X.u[H.j+I-ge];ve=Ce(de);var He=B(Q);if(He<H.w-X.b-1){var Xe=J(xe[ve][0],xe[ve][1]);ae=Z(Q,Xe)+(He<<Xe)}else ae=Z(Q,X.b)+1;ae=ae&1?-1-(ae>>>1):ae>>>1,xe[ve][0]+=Ce(ae),xe[ve][1]==H.q&&(xe[ve][0]>>>=1,xe[ve][1]>>>=1),xe[ve][1]++,Ye=de<0?Ye-ae:Ye+ae,H.f&&(Ye<0?Ye+=X.i:Ye>H.j&&(Ye-=X.i)),ee[F]=Ye>=0?Math.min(Ye,H.j):0}function z(H,X,Q){for(var ce=H[0].length,pe=X;pe<=Q;pe++)H[pe][0]=H[pe-1][1],H[pe][ce-1]=H[pe-1][ce-2]}function w(H){z(H,v,x),z(H,o,r),z(H,T,_)}function N(H,X,Q,ce,pe,_e,xe,Y,F,ie,ae,de,ve){for(var ee=0,se=1,K=pe<P&&pe>r;se<H.c;)ee<H.c&&(q(H,X,Q,ce,pe,ee,xe[F],H.o&&(K&&ie||!K&&(ae||(ee&de)==ve))),q(H,X,Q,ce,_e,ee,xe[F],H.o&&(!K&&ie||K&&(ae||(ee&de)==ve))),ee+=2),ee>8&&(q(H,X,Q,ce,pe,se,Y[F]),q(H,X,Q,ce,_e,se,Y[F]),se+=2);w(ce)}function G(H,X,Q,ce,pe,_e){N(H,X,Q,ce,o,v,pe,_e,0,0,1,0,8),N(H,X,Q,ce,p,T,pe,_e,1,0,1,0,8),N(H,X,Q,ce,l,m,pe,_e,2,1,0,3,0),N(H,X,Q,ce,A,g,pe,_e,0,0,0,3,2),N(H,X,Q,ce,r,y,pe,_e,1,0,0,3,2),N(H,X,Q,ce,x,_,pe,_e,2,1,0,3,0)}function V(H,X,Q,ce,pe,_e){var xe=_e.length,Y=H.n;pe+1==H.v&&(Y=H.h-pe*H.n);for(var F=6*H.h*ce+pe*H.n,ie=0;ie<6;ie++){for(var ae=0;ae<Y;ae++){var de=_e[ie%xe][ae%xe],ve;de==0?ve=o+(ie>>>1):de==2?ve=T+(ie>>>1):ve=v+ie;var ee=H.o?(ae*2/3&2147483646|ae%3&1)+(ae%3>>>1):ae>>>1;X[F+ae]=Q[ve][ee+1]}F+=H.h}}e._decompressRAF=function(H,X){var Q=b(H),ce=S(H,Q),pe=C(Q),_e=new Int16Array(Q.h*Q.d);X==null&&(X=Q.o?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var xe=[[a,l],[i,r],[d,y],[h,x],[P,g],[L,_]],Y=[],F=0;F<u;F++)Y[F]=new Uint16Array(Q.g);for(var ie=0;ie<Q.v;ie++){for(var ae=D(pe),de=D(pe),F=0;F<u;F++)for(var ve=0;ve<Q.g;ve++)Y[F][ve]=0;for(var ee=0;ee<Q.p;ee++){G(Q,pe,ce[ie],Y,ae,de);for(var F=0;F<6;F++)for(var ve=0;ve<Q.g;ve++)Y[xe[F][0]][ve]=Y[xe[F][1]][ve];V(Q,_e,Y,ee,ie,X);for(var F=o;F<u;F++)if([d,h,P,L].indexOf(F)==-1)for(var ve=0;ve<Q.g;ve++)Y[F][ve]=0;w(Y)}}return _e}}()})(t,n)})();/**
 * Based on: https://github.com/shaozilee/bmp-js/blob/db2c466ca1869ddc09e4b2143404eb03ecd490db/lib/encoder.js
 * @author shaozilee
 * @author 1j01
 * @license MIT
 *
 * BMP format encoder, encodes 24bit, 8bit, 4bit, and 1bit BMP files.
 * Doesn't support compression.
 *
 *//**
 * Based on: https://github.com/hipstersmoothie/bmp-ts
 * @license MIT
 */const HeaderTypes={};HeaderTypes[HeaderTypes.BITMAP_INFO_HEADER=40]="BITMAP_INFO_HEADER";HeaderTypes[HeaderTypes.BITMAP_V2_INFO_HEADER=52]="BITMAP_V2_INFO_HEADER";HeaderTypes[HeaderTypes.BITMAP_V3_INFO_HEADER=56]="BITMAP_V3_INFO_HEADER";HeaderTypes[HeaderTypes.BITMAP_V4_HEADER=108]="BITMAP_V4_HEADER";HeaderTypes[HeaderTypes.BITMAP_V5_HEADER=124]="BITMAP_V5_HEADER";Object.freeze(HeaderTypes);(function(t,n){if(typeof define=="function"&&define.amd)define([],n);else if(typeof exports<"u")n();else{var s={exports:{}};n(),window.FileSaver=s.exports}})(void 0,function(){var t=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0;function n(o,l){return typeof l>"u"?l={autoBom:!1}:typeof l!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function s(o,l,r){var d=new XMLHttpRequest;d.open("GET",o),d.responseType="blob",d.onload=function(){i(d.response,l,r)},d.onerror=function(){console.error("could not download file")},d.send()}function e(o){var l=new XMLHttpRequest;l.open("HEAD",o,!1);try{l.send()}catch{}return l.status>=200&&l.status<=299}function c(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(l)}}var a=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=t.saveAs||(typeof window!="object"||window!==t?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(l,r,d){var h=t.URL||t.webkitURL,v=document.createElement("a");r=r||l.name||"download",v.download=r,v.rel="noopener",typeof l=="string"?(v.href=l,v.origin!==location.origin?e(v.href)?s(l,r,d):c(v,v.target="_blank"):c(v)):(v.href=h.createObjectURL(l),setTimeout(function(){h.revokeObjectURL(v.href)},4e4),setTimeout(function(){c(v)},0))}:"msSaveOrOpenBlob"in navigator?function(l,r,d){if(r=r||l.name||"download",typeof l=="string")if(e(l))s(l,r,d);else{var h=document.createElement("a");h.href=l,h.target="_blank",setTimeout(function(){c(h)})}else navigator.msSaveOrOpenBlob(n(l,d),r)}:function(l,r,d,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof l=="string")return s(l,r,d);var v=l.type==="application/octet-stream",p=/constructor/i.test(t.HTMLElement)||t.safari,m=/CriOS\/[\d]+/.test(navigator.userAgent);if((m||v&&p||a)&&typeof FileReader<"u"){var A=new FileReader;A.onloadend=function(){var P=A.result;P=m?P:P.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=P:location=P,h=null},A.readAsDataURL(l)}else{var y=t.URL||t.webkitURL,x=y.createObjectURL(l);h?h.location=x:location.href=x,h=null,setTimeout(function(){y.revokeObjectURL(x)},4e4)}});t.saveAs=i.saveAs=i,typeof module<"u"&&(module.exports=i)});(function t(n,s,e){function c(o,l){if(!s[o]){if(!n[o]){var r=typeof require=="function"&&require;if(!l&&r)return r(o,!0);if(a)return a(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var h=s[o]={exports:{}};n[o][0].call(h.exports,function(v){var p=n[o][1][v];return c(p||v)},h,h.exports,t,n,s,e)}return s[o].exports}for(var a=typeof require=="function"&&require,i=0;i<e.length;i++)c(e[i]);return c})({1:[function(t,n,s){var e,c,a;e=function(i,o){var l;return l=setTimeout(o,i),{stop:function(){return clearTimeout(l)}}},a=function(i,o){var l;return l=setInterval(o,i),{stop:function(){return clearInterval(l)}}},c=function(i){return/in/.test(document.readyState)?e(10,function(){return c(i)}):i()},function(i){var o,l,r,d,h,v,p,m,A,y;return o=i.FontDetective={},p="Helvetica,Lucida Grande,Lucida Sans,Tahoma,Arial,Geneva,Monaco,Verdana,Microsoft Sans Serif,Trebuchet MS,Courier New,Times New Roman,Courier,Lucida Bright,Lucida Sans Typewriter,URW Chancery L,Comic Sans MS,Georgia,Palatino Linotype,Lucida Sans Unicode,Times,Century Schoolbook L,URW Gothic L,Franklin Gothic Medium,Lucida Console,Impact,URW Bookman L,Helvetica Neue,Nimbus Sans L,URW Palladio L,Nimbus Mono L,Nimbus Roman No9 L,Arial Black,Sylfaen,MV Boli,Estrangelo Edessa,Tunga,Gautami,Raavi,Mangal,Shruti,Latha,Kartika,Vrinda,Arial Narrow,Century Gothic,Garamond,Book Antiqua,Bookman Old Style,Calibri,Cambria,Candara,Corbel,Monotype Corsiva,Cambria Math,Consolas,Constantia,MS Reference Sans Serif,MS Mincho,Segoe UI,Arial Unicode MS,Tempus Sans ITC,Kristen ITC,Mistral,Meiryo UI,Juice ITC,Papyrus,Bradley Hand ITC,French Script MT,Malgun Gothic,Microsoft YaHei,Gisha,Leelawadee,Microsoft JhengHei,Haettenschweiler,Microsoft Himalaya,Microsoft Uighur,MoolBoran,Jokerman,DFKai-SB,KaiTi,SimSun-ExtB,Freestyle Script,Vivaldi,FangSong,MingLiU-ExtB,MingLiU_HKSCS,MingLiU_HKSCS-ExtB,PMingLiU-ExtB,Copperplate Gothic Light,Copperplate Gothic Bold,Franklin Gothic Book,Maiandra GD,Perpetua,Eras Demi ITC,Felix Titling,Franklin Gothic Demi,Pristina,Edwardian Script ITC,OCR A Extended,Engravers MT,Eras Light ITC,Franklin Gothic Medium Cond,Rockwell Extra Bold,Rockwell,Curlz MT,Blackadder ITC,Franklin Gothic Heavy,Franklin Gothic Demi Cond,Lucida Handwriting,Segoe UI Light,Segoe UI Semibold,Lucida Calligraphy,Cooper Black,Viner Hand ITC,Britannic Bold,Wide Latin,Old English Text MT,Broadway,Footlight MT Light,Harrington,Snap ITC,Onyx,Playbill,Bauhaus 93,Baskerville Old Face,Algerian,Matura MT Script Capitals,Stencil,Batang,Chiller,Harlow Solid Italic,Kunstler Script,Bernard MT Condensed,Informal Roman,Vladimir Script,Bell MT,Colonna MT,High Tower Text,Californian FB,Ravie,Segoe Script,Brush Script MT,SimSun,Arial Rounded MT Bold,Berlin Sans FB,Centaur,Niagara Solid,Showcard Gothic,Niagara Engraved,Segoe Print,Gabriola,Gill Sans MT,Iskoola Pota,Calisto MT,Script MT Bold,Century Schoolbook,Berlin Sans FB Demi,Magneto,Arabic Typesetting,DaunPenh,Mongolian Baiti,DokChampa,Euphemia,Kalinga,Microsoft Yi Baiti,Nyala,Bodoni MT Poster Compressed,Goudy Old Style,Imprint MT Shadow,Gill Sans MT Condensed,Gill Sans Ultra Bold,Palace Script MT,Lucida Fax,Gill Sans MT Ext Condensed Bold,Goudy Stout,Eras Medium ITC,Rage Italic,Rockwell Condensed,Castellar,Eras Bold ITC,Forte,Gill Sans Ultra Bold Condensed,Perpetua Titling MT,Agency FB,Tw Cen MT,Gigi,Tw Cen MT Condensed,Aparajita,Gloucester MT Extra Condensed,Tw Cen MT Condensed Extra Bold,PMingLiU,Bodoni MT,Bodoni MT Black,Bodoni MT Condensed,MS Gothic,GulimChe,MS UI Gothic,MS PGothic,Gulim,MS PMincho,BatangChe,Dotum,DotumChe,Gungsuh,GungsuhChe,MingLiU,NSimSun,SimHei,DejaVu Sans,DejaVu Sans Condensed,DejaVu Sans Mono,DejaVu Serif,DejaVu Serif Condensed,Eurostile,Matisse ITC,Bitstream Vera Sans Mono,Bitstream Vera Sans,Staccato222 BT,Bitstream Vera Serif,Broadway BT,ParkAvenue BT,Square721 BT,Calligraph421 BT,MisterEarl BT,Cataneo BT,Ruach LET,Rage Italic LET,La Bamba LET,Blackletter686 BT,John Handy LET,Scruff LET,Westwood LET".split(",").sort(),y=[],d=!1,m=!1,r=document.createElement("div"),r.id="font-detective",l=function(){function x(P,L,T){this.name=P,this.type=L,this.style=T}return x.prototype.toString=function(){return'"'+this.name.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},x}(),h=function(){var x,P,L,T;return x=["monospace","sans-serif","serif"],T=document.createElement("span"),T.innerHTML="mmmmmmmmmmlli",T.style.fontSize="72px",L={},P={},{init:function(){var g,_,u,b;for(document.body.appendChild(r),b=[],_=0,u=x.length;_<u;_++)g=x[_],T.style.fontFamily=g,r.appendChild(T),L[g]=T.offsetWidth,P[g]=T.offsetHeight,b.push(r.removeChild(T));return b},check:function(g){var _,u,b,S;for(b=0,S=x.length;b<S;b++)if(_=x[b],T.style.fontFamily=g+", "+_,r.appendChild(T),u=T.offsetWidth!==L[_]||T.offsetHeight!==P[_],r.removeChild(T),u)return!0;return!1}}}(),v=function(){if(!m)return m=!0,o.incomplete=!0,c(function(x){return function(){var P;return A(function(){var L,T,g;for(g=[],L=0,T=p.length;L<T;L++)P=p[L],g.push(new l(P));return g}())}}())},A=function(x){var P,L;return h.init(),P=0,L=a(20,function(){var T,g,_,u,b,S,M,R,C,D;for(u=0;u<=5;u++){if(_=x[P],T=h.check(_),T)for(y.push(_),C=o.each.callbacks,b=0,M=C.length;b<M;b++)g=C[b],g(_);if(P++,P>=x.length){for(L.stop(),D=o.all.callbacks,S=0,R=D.length;S<R;S++)g=D[S],g(y);o.all.callbacks=[],o.each.callbacks=[],d=!0;return}}})},o.preload=v,o.each=function(x){var P,L,T;for(L=0,T=y.length;L<T;L++)P=y[L],x(P);if(!d)return o.each.callbacks.push(x),v()},o.each.callbacks=[],o.all=function(x){return d?x(y):(o.all.callbacks.push(x),v())},o.all.callbacks=[]}(window)},{}]},{},[1]);const libtess=(function(){var t;function n(W,re){return W.b===re.b&&W.a===re.a}function s(W,re){return W.b<re.b||W.b===re.b&&W.a<=re.a}function e(W,re,ue){var he=re.b-W.b,we=ue.b-re.b;return 0<he+we?he<we?re.a-W.a+he/(he+we)*(W.a-ue.a):re.a-ue.a+we/(he+we)*(ue.a-W.a):0}function c(W,re,ue){var he=re.b-W.b,we=ue.b-re.b;return 0<he+we?(re.a-ue.a)*he+(re.a-W.a)*we:0}function a(W,re){return W.a<re.a||W.a===re.a&&W.b<=re.b}function i(W,re,ue){var he=re.a-W.a,we=ue.a-re.a;return 0<he+we?he<we?re.b-W.b+he/(he+we)*(W.b-ue.b):re.b-ue.b+we/(he+we)*(ue.b-W.b):0}function o(W,re,ue){var he=re.a-W.a,we=ue.a-re.a;return 0<he+we?(re.b-ue.b)*he+(re.b-W.b)*we:0}function l(W){return s(W.b.a,W.a)}function r(W){return s(W.a,W.b.a)}function d(W,re,ue,he){return W=0>W?0:W,ue=0>ue?0:ue,W<=ue?ue===0?(re+he)/2:re+W/(W+ue)*(he-re):he+ue/(W+ue)*(re-he)}function h(W){var re=y(W.b);return P(re,W.c),P(re.b,W.c),L(re,W.a),re}function v(W,re){var ue=!1,he=!1;W!==re&&(re.a!==W.a&&(he=!0,g(re.a,W.a)),re.d!==W.d&&(ue=!0,_(re.d,W.d)),x(re,W),he||(P(re,W.a),W.a.c=W),ue||(L(re,W.d),W.d.a=W))}function p(W){var re=W.b,ue=!1;W.d!==W.b.d&&(ue=!0,_(W.d,W.b.d)),W.c===W?g(W.a,null):(W.b.d.a=ee(W),W.a.c=W.c,x(W,ee(W)),ue||L(W,W.d)),re.c===re?(g(re.a,null),_(re.d,null)):(W.d.a=ee(re),re.a.c=re.c,x(re,ee(re))),T(W)}function m(W){var re=y(W),ue=re.b;return x(re,W.e),re.a=W.b.a,P(ue,re.a),re.d=ue.d=W.d,re=re.b,x(W.b,ee(W.b)),x(W.b,re),W.b.a=re.a,re.b.a.c=re.b,re.b.d=W.b.d,re.f=W.f,re.b.f=W.b.f,re}function A(W,re){var ue=!1,he=y(W),we=he.b;return re.d!==W.d&&(ue=!0,_(re.d,W.d)),x(he,W.e),x(we,re),he.a=W.b.a,we.a=re.a,he.d=we.d=W.d,W.d.a=we,ue||L(he,W.d),he}function y(W){var re=new ve,ue=new ve,he=W.b.h;return ue.h=he,he.b.h=re,re.h=W,W.b.h=ue,re.b=ue,re.c=re,re.e=ue,ue.b=re,ue.c=ue,ue.e=re}function x(W,re){var ue=W.c,he=re.c;ue.b.e=re,he.b.e=W,W.c=he,re.c=ue}function P(W,re){var ue=re.f,he=new K(re,ue);ue.e=he,re.f=he,ue=he.c=W;do ue.a=he,ue=ue.c;while(ue!==W)}function L(W,re){var ue=re.d,he=new de(re,ue);ue.b=he,re.d=he,he.a=W,he.c=re.c,ue=W;do ue.d=he,ue=ue.e;while(ue!==W)}function T(W){var re=W.h;W=W.b.h,re.b.h=W,W.b.h=re}function g(W,re){var ue=W.c,he=ue;do he.a=re,he=he.c;while(he!==ue);ue=W.f,he=W.e,he.f=ue,ue.e=he}function _(W,re){var ue=W.a,he=ue;do he.d=re,he=he.e;while(he!==ue);ue=W.d,he=W.b,he.d=ue,ue.b=he}function u(W){var re=0;return Math.abs(W[1])>Math.abs(W[0])&&(re=1),Math.abs(W[2])>Math.abs(W[re])&&(re=2),re}var b=4*1e150;function S(W,re){W.f+=re.f,W.b.f+=re.b.f}function M(W,re,ue){return W=W.a,re=re.a,ue=ue.a,re.b.a===W?ue.b.a===W?s(re.a,ue.a)?0>=c(ue.b.a,re.a,ue.a):0<=c(re.b.a,ue.a,re.a):0>=c(ue.b.a,W,ue.a):ue.b.a===W?0<=c(re.b.a,W,re.a):(re=e(re.b.a,W,re.a),W=e(ue.b.a,W,ue.a),re>=W)}function R(W){W.a.i=null;var re=W.e;re.a.c=re.c,re.c.a=re.a,W.e=null}function C(W,re){p(W.a),W.c=!1,W.a=re,re.i=W}function D(W){var re=W.a.a;do W=je(W);while(W.a.a===re);return W.c&&(re=A(Qe(W).a.b,W.a.e),C(W,re),W=je(W)),W}function B(W,re,ue){var he=new Xe;return he.a=ue,he.e=_e(W.f,re.e,he),ue.i=he}function Z(W,re){switch(W.s){case 100130:return(re&1)!==0;case 100131:return re!==0;case 100132:return 0<re;case 100133:return 0>re;case 100134:return 2<=re||-2>=re}return!1}function J(W){var re=W.a,ue=re.d;ue.c=W.d,ue.a=re,R(W)}function q(W,re,ue){for(W=re,re=re.a;W!==ue;){W.c=!1;var he=Qe(W),we=he.a;if(we.a!==re.a){if(!he.c){J(W);break}we=A(re.c.b,we.b),C(he,we)}re.c!==we&&(v(ee(we),we),v(re,we)),J(W),re=he.a,W=he}return re}function z(W,re,ue,he,we,$e){var fe=!0;do B(W,re,ue.b),ue=ue.c;while(ue!==he);for(we===null&&(we=Qe(re).a.b.c);he=Qe(re),ue=he.a.b,ue.a===we.a;)ue.c!==we&&(v(ee(ue),ue),v(ee(we),ue)),he.f=re.f-ue.f,he.d=Z(W,he.f),re.b=!0,!fe&&V(W,re)&&(S(ue,we),R(re),p(we)),fe=!1,re=he,we=ue;re.b=!0,$e&&X(W,re)}function w(W,re,ue,he,we){var $e=[re.g[0],re.g[1],re.g[2]];re.d=null,re.d=W.o&&W.o($e,ue,he,W.c)||null,re.d===null&&(we?W.n||(ae(W,100156),W.n=!0):re.d=ue[0])}function N(W,re,ue){var he=[null,null,null,null];he[0]=re.a.d,he[1]=ue.a.d,w(W,re.a,he,[.5,.5,0,0],!1),v(re,ue)}function G(W,re,ue,he,we){var $e=Math.abs(re.b-W.b)+Math.abs(re.a-W.a),fe=Math.abs(ue.b-W.b)+Math.abs(ue.a-W.a),be=we+1;he[we]=.5*fe/($e+fe),he[be]=.5*$e/($e+fe),W.g[0]+=he[we]*re.g[0]+he[be]*ue.g[0],W.g[1]+=he[we]*re.g[1]+he[be]*ue.g[1],W.g[2]+=he[we]*re.g[2]+he[be]*ue.g[2]}function V(W,re){var ue=Qe(re),he=re.a,we=ue.a;if(s(he.a,we.a)){if(0<c(we.b.a,he.a,we.a))return!1;if(!n(he.a,we.a))m(we.b),v(he,ee(we)),re.b=ue.b=!0;else if(he.a!==we.a){var ue=W.e,$e=he.a.h;if(0<=$e){var ue=ue.b,fe=ue.d,be=ue.e,Ae=ue.c,De=Ae[$e];fe[De]=fe[ue.a],Ae[fe[De]]=De,De<=--ue.a&&(1>=De||s(be[fe[De>>1]],be[fe[De]])?Ye(ue,De):He(ue,De)),be[$e]=null,Ae[$e]=ue.b,ue.b=$e}else for(ue.c[-($e+1)]=null;0<ue.a&&ue.c[ue.d[ue.a-1]]===null;)--ue.a;N(W,ee(we),he)}}else{if(0>c(he.b.a,we.a,he.a))return!1;je(re).b=re.b=!0,m(he.b),v(ee(we),he)}return!0}function H(W,re){var ue=Qe(re),he=re.a,we=ue.a,$e=he.a,fe=we.a,be=he.b.a,Ae=we.b.a,De=new K;if(c(be,W.a,$e),c(Ae,W.a,fe),$e===fe||Math.min($e.a,be.a)>Math.max(fe.a,Ae.a))return!1;if(s($e,fe)){if(0<c(Ae,$e,fe))return!1}else if(0>c(be,fe,$e))return!1;var Ve=be,Ke=$e,Be=Ae,Ie=fe,Ue,et;if(s(Ve,Ke)||(Ue=Ve,Ve=Ke,Ke=Ue),s(Be,Ie)||(Ue=Be,Be=Ie,Ie=Ue),s(Ve,Be)||(Ue=Ve,Ve=Be,Be=Ue,Ue=Ke,Ke=Ie,Ie=Ue),s(Be,Ke)?s(Ke,Ie)?(Ue=e(Ve,Be,Ke),et=e(Be,Ke,Ie),0>Ue+et&&(Ue=-Ue,et=-et),De.b=d(Ue,Be.b,et,Ke.b)):(Ue=c(Ve,Be,Ke),et=-c(Ve,Ie,Ke),0>Ue+et&&(Ue=-Ue,et=-et),De.b=d(Ue,Be.b,et,Ie.b)):De.b=(Be.b+Ke.b)/2,a(Ve,Ke)||(Ue=Ve,Ve=Ke,Ke=Ue),a(Be,Ie)||(Ue=Be,Be=Ie,Ie=Ue),a(Ve,Be)||(Ue=Ve,Ve=Be,Be=Ue,Ue=Ke,Ke=Ie,Ie=Ue),a(Be,Ke)?a(Ke,Ie)?(Ue=i(Ve,Be,Ke),et=i(Be,Ke,Ie),0>Ue+et&&(Ue=-Ue,et=-et),De.a=d(Ue,Be.a,et,Ke.a)):(Ue=o(Ve,Be,Ke),et=-o(Ve,Ie,Ke),0>Ue+et&&(Ue=-Ue,et=-et),De.a=d(Ue,Be.a,et,Ie.a)):De.a=(Be.a+Ke.a)/2,s(De,W.a)&&(De.b=W.a.b,De.a=W.a.a),Ve=s($e,fe)?$e:fe,s(Ve,De)&&(De.b=Ve.b,De.a=Ve.a),n(De,$e)||n(De,fe))return V(W,re),!1;if(!n(be,W.a)&&0<=c(be,W.a,De)||!n(Ae,W.a)&&0>=c(Ae,W.a,De)){if(Ae===W.a)return m(he.b),v(we.b,he),re=D(re),he=Qe(re).a,q(W,Qe(re),ue),z(W,re,ee(he),he,he,!0),!0;if(be===W.a){m(we.b),v(he.e,ee(we)),$e=ue=re,fe=$e.a.b.a;do $e=je($e);while($e.a.b.a===fe);return re=$e,$e=Qe(re).a.b.c,ue.a=ee(we),we=q(W,ue,null),z(W,re,we.c,he.b.c,$e,!0),!0}return 0<=c(be,W.a,De)&&(je(re).b=re.b=!0,m(he.b),he.a.b=W.a.b,he.a.a=W.a.a),0>=c(Ae,W.a,De)&&(re.b=ue.b=!0,m(we.b),we.a.b=W.a.b,we.a.a=W.a.a),!1}return m(he.b),m(we.b),v(ee(we),he),he.a.b=De.b,he.a.a=De.a,he.a.h=oe(W.e,he.a),he=he.a,we=[0,0,0,0],De=[$e.d,be.d,fe.d,Ae.d],he.g[0]=he.g[1]=he.g[2]=0,G(he,$e,be,we,0),G(he,fe,Ae,we,2),w(W,he,De,we,!0),je(re).b=re.b=ue.b=!0,!1}function X(W,re){for(var ue=Qe(re);;){for(;ue.b;)re=ue,ue=Qe(ue);if(!re.b&&(ue=re,re=je(re),re===null||!re.b))break;re.b=!1;var he=re.a,we=ue.a,$e;if($e=he.b.a!==we.b.a)e:{$e=re;var fe=Qe($e),be=$e.a,Ae=fe.a,De=void 0;if(s(be.b.a,Ae.b.a)){if(0>c(be.b.a,Ae.b.a,be.a)){$e=!1;break e}je($e).b=$e.b=!0,De=m(be),v(Ae.b,De),De.d.c=$e.d}else{if(0<c(Ae.b.a,be.b.a,Ae.a)){$e=!1;break e}$e.b=fe.b=!0,De=m(Ae),v(be.e,Ae.b),De.b.d.c=$e.d}$e=!0}if($e&&(ue.c?(R(ue),p(we),ue=Qe(re),we=ue.a):re.c&&(R(re),p(he),re=je(ue),he=re.a)),he.a!==we.a){if(he.b.a===we.b.a||re.c||ue.c||he.b.a!==W.a&&we.b.a!==W.a)V(W,re);else if(H(W,re))break}he.a===we.a&&he.b.a===we.b.a&&(S(we,he),R(re),p(he),re=je(ue))}}function Q(W,re){W.a=re;for(var ue=re.c;ue.i===null;)if(ue=ue.c,ue===re.c){var ue=W,he=re,fe=new Xe;fe.a=he.c.b;var we=ue.f,be=we.a;do be=be.a;while(be.b!==null&&!we.c(we.b,fe,be.b));var we=be.b,$e=Qe(we),fe=we.a,be=$e.a;if(c(fe.b.a,he,fe.a)===0)fe=we.a,n(fe.a,he)||n(fe.b.a,he)||(m(fe.b),we.c&&(p(fe.c),we.c=!1),v(he.c,fe),Q(ue,he));else{var Ae=s(be.b.a,fe.b.a)?we:$e,$e=void 0;we.d||Ae.c?(Ae===we?$e=A(he.c.b,fe.e):$e=A(be.b.c.b,he.c).b,Ae.c?C(Ae,$e):(fe=ue,we=B(ue,we,$e),we.f=je(we).f+we.a.f,we.d=Z(fe,we.f)),Q(ue,he)):z(ue,we,he.c,he.c,null,!0)}return}if(ue=D(ue.i),fe=Qe(ue),we=fe.a,fe=q(W,fe,null),fe.c===we){var we=fe,fe=we.c,be=Qe(ue),$e=ue.a,Ae=be.a,De=!1;$e.b.a!==Ae.b.a&&H(W,ue),n($e.a,W.a)&&(v(ee(fe),$e),ue=D(ue),fe=Qe(ue).a,q(W,Qe(ue),be),De=!0),n(Ae.a,W.a)&&(v(we,ee(Ae)),we=q(W,be,null),De=!0),De?z(W,ue,we.c,fe,fe,!0):(s(Ae.a,$e.a)?he=ee(Ae):he=$e,he=A(we.c.b,he),z(W,ue,he,he.c,he.c,!1),he.b.i.c=!0,X(W,ue))}else z(W,ue,fe.c,we,we,!0)}function ce(W,re){var ue=new Xe,he=h(W.b);he.a.b=b,he.a.a=re,he.b.a.b=-b,he.b.a.a=re,W.a=he.b.a,ue.a=he,ue.f=0,ue.d=!1,ue.c=!1,ue.h=!0,ue.b=!1,he=W.f,he=_e(he,he.a,ue),ue.e=he}function pe(W){this.a=new xe,this.b=W,this.c=M}function _e(W,re,ue){do re=re.c;while(re.b!==null&&!W.c(W.b,re.b,ue));return W=new xe(ue,re.a,re),re.a.c=W,re.a=W}function xe(W,re,ue){this.b=W||null,this.a=re||this,this.c=ue||this}function Y(){this.d=F,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}var F=0;t=Y.prototype,t.x=function(){ie(this,F)},t.B=function(W,re){switch(W){case 100142:return;case 100140:switch(re){case 100130:case 100131:case 100132:case 100133:case 100134:this.s=re;return}break;case 100141:this.m=!!re;return;default:ae(this,100900);return}ae(this,100901)},t.y=function(W){switch(W){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:ae(this,100900)}return!1},t.A=function(W,re,ue){this.j[0]=W,this.j[1]=re,this.j[2]=ue},t.z=function(W,re){var ue=re||null;switch(W){case 100100:case 100106:this.h=ue;break;case 100104:case 100110:this.l=ue;break;case 100101:case 100107:this.k=ue;break;case 100102:case 100108:this.i=ue;break;case 100103:case 100109:this.p=ue;break;case 100105:case 100111:this.o=ue;break;case 100112:this.r=ue;break;default:ae(this,100900)}},t.C=function(W,re){var ue=!1,he=[0,0,0];ie(this,2);for(var we=0;3>we;++we){var $e=W[we];-1e150>$e&&($e=-1e150,ue=!0),1e150<$e&&($e=1e150,ue=!0),he[we]=$e}ue&&ae(this,100155),ue=this.q,ue===null?(ue=h(this.b),v(ue,ue.b)):(m(ue),ue=ue.e),ue.a.d=re,ue.a.g[0]=he[0],ue.a.g[1]=he[1],ue.a.g[2]=he[2],ue.f=1,ue.b.f=-1,this.q=ue},t.u=function(W){ie(this,F),this.d=1,this.b=new se,this.c=W},t.t=function(){ie(this,1),this.d=2,this.q=null},t.v=function(){ie(this,2),this.d=1},t.w=function(){ie(this,1),this.d=F;var W=this.j[0],re=this.j[1],ue=this.j[2],he=!1,we=[W,re,ue];if(W===0&&re===0&&ue===0){for(var re=[-2*1e150,-2*1e150,-2*1e150],$e=[2*1e150,2*1e150,2*1e150],ue=[],fe=[],he=this.b.c,W=he.e;W!==he;W=W.e)for(var be=0;3>be;++be){var Ae=W.g[be];Ae<$e[be]&&($e[be]=Ae,fe[be]=W),Ae>re[be]&&(re[be]=Ae,ue[be]=W)}if(W=0,re[1]-$e[1]>re[0]-$e[0]&&(W=1),re[2]-$e[2]>re[W]-$e[W]&&(W=2),$e[W]>=re[W])we[0]=0,we[1]=0,we[2]=1;else{for(re=0,$e=fe[W],ue=ue[W],fe=[0,0,0],$e=[$e.g[0]-ue.g[0],$e.g[1]-ue.g[1],$e.g[2]-ue.g[2]],be=[0,0,0],W=he.e;W!==he;W=W.e)be[0]=W.g[0]-ue.g[0],be[1]=W.g[1]-ue.g[1],be[2]=W.g[2]-ue.g[2],fe[0]=$e[1]*be[2]-$e[2]*be[1],fe[1]=$e[2]*be[0]-$e[0]*be[2],fe[2]=$e[0]*be[1]-$e[1]*be[0],Ae=fe[0]*fe[0]+fe[1]*fe[1]+fe[2]*fe[2],Ae>re&&(re=Ae,we[0]=fe[0],we[1]=fe[1],we[2]=fe[2]);0>=re&&(we[0]=we[1]=we[2]=0,we[u($e)]=1)}he=!0}for(fe=u(we),W=this.b.c,re=(fe+1)%3,ue=(fe+2)%3,fe=0<we[fe]?1:-1,we=W.e;we!==W;we=we.e)we.b=we.g[re],we.a=fe*we.g[ue];if(he){for(we=0,he=this.b.a,W=he.b;W!==he;W=W.b)if(re=W.a,!(0>=re.f))do we+=(re.a.b-re.b.a.b)*(re.a.a+re.b.a.a),re=re.e;while(re!==W.a);if(0>we)for(we=this.b.c,he=we.e;he!==we;he=he.e)he.a=-he.a}for(this.n=!1,we=this.b.b,W=we.h;W!==we;W=he)he=W.h,re=W.e,n(W.a,W.b.a)&&W.e.e!==W&&(N(this,re,W),p(W),W=re,re=W.e),re.e===W&&(re!==W&&((re===he||re===he.b)&&(he=he.h),p(re)),(W===he||W===he.b)&&(he=he.h),p(W));for(this.e=we=new I,he=this.b.c,W=he.e;W!==he;W=W.e)W.h=oe(we,W);for(U(we),this.f=new pe(this),ce(this,-b),ce(this,b);(we=ge(this.e))!==null;){for(;;){e:if(W=this.e,W.a===0)he=qe(W.b);else if(he=W.c[W.d[W.a-1]],W.b.a!==0&&(W=qe(W.b),s(W,he))){he=W;break e}if(he===null||!n(he,we))break;he=ge(this.e),N(this,we.c,he.c)}Q(this,we)}for(this.a=this.f.a.a.b.a.a,we=0;(he=this.f.a.a.b)!==null;)he.h||++we,R(he);for(this.f=null,we=this.e,we.b=null,we.d=null,this.e=we.c=null,we=this.b,W=we.a.b;W!==we.a;W=he)he=W.b,W=W.a,W.e.e===W&&(S(W.c,W),p(W));if(!this.n){if(we=this.b,this.m)for(W=we.b.h;W!==we.b;W=he)he=W.h,W.b.d.c!==W.d.c?W.f=W.d.c?1:-1:p(W);else for(W=we.a.b;W!==we.a;W=he)if(he=W.b,W.c){for(W=W.a;s(W.b.a,W.a);W=W.c.b);for(;s(W.a,W.b.a);W=W.e);for(re=W.c.b,ue=void 0;W.e!==re;)if(s(W.b.a,re.a)){for(;re.e!==W&&(l(re.e)||0>=c(re.a,re.b.a,re.e.b.a));)ue=A(re.e,re),re=ue.b;re=re.c.b}else{for(;re.e!==W&&(r(W.c.b)||0<=c(W.b.a,W.a,W.c.b.a));)ue=A(W,W.c.b),W=ue.b;W=W.e}for(;re.e.e!==W;)ue=A(re.e,re),re=ue.b}if(this.h||this.i||this.k||this.l)if(this.m){for(we=this.b,he=we.a.b;he!==we.a;he=he.b)if(he.c){this.h&&this.h(2,this.c),W=he.a;do this.k&&this.k(W.a.d,this.c),W=W.e;while(W!==he.a);this.i&&this.i(this.c)}}else{for(we=this.b,he=!!this.l,W=!1,re=-1,ue=we.a.d;ue!==we.a;ue=ue.d)if(ue.c){W||(this.h&&this.h(4,this.c),W=!0),fe=ue.a;do he&&($e=fe.b.d.c?0:1,re!==$e&&(re=$e,this.l&&this.l(!!re,this.c))),this.k&&this.k(fe.a.d,this.c),fe=fe.e;while(fe!==ue.a)}W&&this.i&&this.i(this.c)}if(this.r){for(we=this.b,W=we.a.b;W!==we.a;W=he)if(he=W.b,!W.c){re=W.a,ue=re.e,fe=void 0;do fe=ue,ue=fe.e,fe.d=null,fe.b.d===null&&(fe.c===fe?g(fe.a,null):(fe.a.c=fe.c,x(fe,ee(fe))),$e=fe.b,$e.c===$e?g($e.a,null):($e.a.c=$e.c,x($e,ee($e))),T(fe));while(fe!==re);re=W.d,W=W.b,W.d=re,re.b=W}this.r(this.b),this.c=this.b=null;return}}this.b=this.c=null};function ie(W,re){if(W.d!==re)for(;W.d!==re;)if(W.d<re)switch(W.d){case F:ae(W,100151),W.u(null);break;case 1:ae(W,100152),W.t()}else switch(W.d){case 2:ae(W,100154),W.v();break;case 1:ae(W,100153),W.w()}}function ae(W,re){W.p&&W.p(re,W.c)}function de(W,re){this.b=W||this,this.d=re||this,this.a=null,this.c=!1}function ve(){this.h=this,this.i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function ee(W){return W.b.e}function se(){this.c=new K,this.a=new de,this.b=new ve,this.d=new ve,this.b.b=this.d,this.d.b=this.b}function K(W,re){this.e=W||this,this.f=re||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function I(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new Se}function U(W){W.d=[];for(var re=0;re<W.a;re++)W.d[re]=re;W.d.sort(function(ue){return function(he,we){return s(ue[he],ue[we])?1:-1}}(W.c)),W.e=!0,Re(W.b)}function oe(W,re){if(W.e){var ue=W.b,he=++ue.a;2*he>ue.f&&(ue.f*=2,ue.c=Ce(ue.c,ue.f+1));var we;return ue.b===0?we=he:(we=ue.b,ue.b=ue.c[ue.b]),ue.e[we]=re,ue.c[we]=he,ue.d[he]=we,ue.h&&He(ue,he),we}return ue=W.a++,W.c[ue]=re,-(ue+1)}function ge(W){if(W.a===0)return Ge(W.b);var re=W.c[W.d[W.a-1]];if(W.b.a!==0&&s(qe(W.b),re))return Ge(W.b);do--W.a;while(0<W.a&&W.c[W.d[W.a-1]]===null);return re}function Se(){this.d=Ce([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function Ce(W,re){for(var ue=Array(re),he=0;he<W.length;he++)ue[he]=W[he];for(;he<re;he++)ue[he]=0;return ue}function Re(W){for(var re=W.a;1<=re;--re)Ye(W,re);W.h=!0}function qe(W){return W.e[W.d[1]]}function Ge(W){var re=W.d,ue=W.e,he=W.c,we=re[1],$e=ue[we];return 0<W.a&&(re[1]=re[W.a],he[re[1]]=1,ue[we]=null,he[we]=W.b,W.b=we,0<--W.a&&Ye(W,1)),$e}function Ye(W,re){for(var ue=W.d,he=W.e,we=W.c,$e=re,fe=ue[$e];;){var be=$e<<1;be<W.a&&s(he[ue[be+1]],he[ue[be]])&&(be+=1);var Ae=ue[be];if(be>W.a||s(he[fe],he[Ae])){ue[$e]=fe,we[fe]=$e;break}ue[$e]=Ae,we[Ae]=$e,$e=be}}function He(W,re){for(var ue=W.d,he=W.e,we=W.c,$e=re,fe=ue[$e];;){var be=$e>>1,Ae=ue[be];if(be===0||s(he[Ae],he[fe])){ue[$e]=fe,we[fe]=$e;break}ue[$e]=Ae,we[Ae]=$e,$e=be}}function Xe(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function Qe(W){return W.e.c.b}function je(W){return W.e.a.b}return this.libtess={GluTesselator:Y,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},Y.prototype.gluDeleteTess=Y.prototype.x,Y.prototype.gluTessProperty=Y.prototype.B,Y.prototype.gluGetTessProperty=Y.prototype.y,Y.prototype.gluTessNormal=Y.prototype.A,Y.prototype.gluTessCallback=Y.prototype.z,Y.prototype.gluTessVertex=Y.prototype.C,Y.prototype.gluTessBeginPolygon=Y.prototype.u,Y.prototype.gluTessBeginContour=Y.prototype.t,Y.prototype.gluTessEndContour=Y.prototype.v,Y.prototype.gluTessEndPolygon=Y.prototype.w,typeof module<"u"&&(module.exports=this.libtess),this.libtess}).apply(new Object),TrackyMouse={dependenciesRoot:"./tracky-mouse"};TrackyMouse.loadDependencies=function(){TrackyMouse.dependenciesRoot=TrackyMouse.dependenciesRoot.replace(/\/+$/,"");const t=s=>new Promise((e,c)=>{const a=document.createElement("script");a.type="text/javascript",a.onload=e,a.onerror=c,a.src=s,document.head.append(a)}),n=[`${TrackyMouse.dependenciesRoot}/lib/no-eval.js`,`${TrackyMouse.dependenciesRoot}/lib/clmtrackr.js`,`${TrackyMouse.dependenciesRoot}/lib/stats.js`];return Promise.all(n.map(t))};const is_selector_valid=(t=>n=>{try{t.querySelector(n)}catch{return!1}return!0})(document.createDocumentFragment());let clean_up_dwell_clicking=()=>{};const init_dwell_clicking=t=>{if(typeof t!="object")throw new Error("configuration object required for initDwellClicking");if(t.targets===void 0)throw new Error("config.targets is required (must be a CSS selector)");if(typeof t.targets!="string")throw new Error("config.targets must be a string (a CSS selector)");if(!is_selector_valid(t.targets))throw new Error("config.targets is not a valid CSS selector");if(t.click===void 0)throw new Error("config.click is required");if(typeof t.click!="function")throw new Error("config.click must be a function");if(t.shouldDrag!==void 0&&typeof t.shouldDrag!="function")throw new Error("config.shouldDrag must be a function");if(t.noCenter!==void 0&&typeof t.noCenter!="function")throw new Error("config.noCenter must be a function");if(t.isEquivalentTarget!==void 0&&typeof t.isEquivalentTarget!="function")throw new Error("config.isEquivalentTarget must be a function");if(t.dwellClickEvenIfPaused!==void 0&&typeof t.dwellClickEvenIfPaused!="function")throw new Error("config.dwellClickEvenIfPaused must be a function");if(t.beforeDispatch!==void 0&&typeof t.beforeDispatch!="function")throw new Error("config.beforeDispatch must be a function");if(t.afterDispatch!==void 0&&typeof t.afterDispatch!="function")throw new Error("config.afterDispatch must be a function");if(t.beforePointerDownDispatch!==void 0&&typeof t.beforePointerDownDispatch!="function")throw new Error("config.beforePointerDownDispatch must be a function");if(t.isHeld!==void 0&&typeof t.isHeld!="function")throw new Error("config.isHeld must be a function");if(t.retarget!==void 0){if(!Array.isArray(t.retarget))throw new Error("config.retarget must be an array of objects");for(let J=0;J<t.retarget.length;J++){const q=t.retarget[J];if(typeof q!="object")throw new Error("config.retarget must be an array of objects");if(q.from===void 0)throw new Error(`config.retarget[${J}].from is required`);if(q.to===void 0)throw new Error(`config.retarget[${J}].to is required (although can be null to ignore the element)`);if(q.withinMargin!==void 0&&typeof q.withinMargin!="number")throw new Error(`config.retarget[${J}].withinMargin must be a number`);if(typeof q.from!="string"&&typeof q.from!="function"&&!(q.from instanceof Element))throw new Error(`config.retarget[${J}].from must be a CSS selector string, an Element, or a function`);if(typeof q.to!="string"&&typeof q.to!="function"&&!(q.to instanceof Element)&&q.to!==null)throw new Error(`config.retarget[${J}].to must be a CSS selector string, an Element, a function, or null`);if(typeof q.from=="string"&&!is_selector_valid(q.from))throw new Error(`config.retarget[${J}].from is not a valid CSS selector`);if(typeof q.to=="string"&&!is_selector_valid(q.to))throw new Error(`config.retarget[${J}].to is not a valid CSS selector`)}}const n=50,s=500,e=500,c=1500,a=1e3,i=1e3,o=1e3,l=1e3;let r=[],d=performance.now(),h=!1,v,p=null;const m=J=>{d=Math.max(d,performance.now()+J)};m(c);const A=document.createElement("div");A.className="tracky-mouse-hover-halo",A.style.display="none",document.body.appendChild(A);const y=document.createElement("div");y.className="tracky-mouse-dwell-indicator",y.style.width=`${n}px`,y.style.height=`${n}px`,y.style.display="none",document.body.appendChild(y);const x=J=>{r.push({x:J.clientX,y:J.clientY,time:performance.now()})},P=J=>{m(a),p=null};let L=document.visibilityState==="visible",T=!0;const g=()=>{L=!0,m(l)},_=()=>{L=!1},u=()=>{T=!1},b=()=>{T=!0};window.addEventListener("pointermove",x),window.addEventListener("pointerup",P),window.addEventListener("pointercancel",P),window.addEventListener("focus",g),window.addEventListener("blur",_),document.addEventListener("mouseleave",u),document.addEventListener("mouseenter",b);const S=(J,q)=>{var G;if(!L||!T)return null;let z=document.elementFromPoint(J,q);if(!z)return null;let w={x:J,y:q,time:performance.now()},N=!1;for(const{from:V,to:H,withinMargin:X=1/0}of t.retarget??[])if(V instanceof Element?V===z:typeof V=="function"?V(z):z.matches(V)){const Q=H instanceof Element||H===null?H:typeof H=="function"?H(z):z.closest(H)||z.querySelector(H);if(Q===null)return null;if(Q){const ce=Q.getBoundingClientRect();w.x>ce.left-X&&w.y>ce.top-X&&w.x<ce.right+X&&w.y<ce.bottom+X&&(z=Q,w.x=Math.min(ce.right-1,Math.max(ce.left,w.x)),w.y=Math.min(ce.bottom-1,Math.max(ce.top,w.y)),N=!0)}}if(!N&&(z=z.closest(t.targets),!z))return null;if(!((G=t.noCenter)!=null&&G.call(t,z))){const V=z.getBoundingClientRect();w.x=V.left+V.width/2,w.y=V.top+V.height/2}return w.target=z,w},M=({x:J,y:q})=>({view:window,clientX:J,clientY:q,pointerId:1234567890,pointerType:"mouse",isPrimary:!0,bubbles:!0,cancelable:!0}),R=J=>{const q={x:0,y:0};for(const z of J)q.x+=z.x,q.y+=z.y;return q.x/=J.length,q.y/=J.length,q},C=()=>{var q,z,w,N,G,V,H,X,Q,ce,pe,_e,xe,Y,F;const J=performance.now();if(r=r.filter(ie=>J<ie.time+e),r.length){const ie=r[r.length-1];r.push({x:ie.x,y:ie.y,time:J});const ae=R(r),de=Math.hypot(ie.x-ae.x,ie.y-ae.y);if(v&&!p){const I=S(v.x,v.y),U=oe=>{const ge=document.createElement("div"),Se=oe.getBoundingClientRect(),Ce=4;ge.style.pointerEvents="none",ge.style.zIndex=1000001,ge.style.display="block",ge.style.position="fixed",ge.style.left=`${Se.left+Ce}px`,ge.style.top=`${Se.top+Ce}px`,ge.style.width=`${Se.width-Ce*2}px`,ge.style.height=`${Se.height-Ce*2}px`,ge.style.outline=`${Ce}px dashed red`,ge.style.boxShadow=`0 0 ${Ce}px ${Ce}px maroon`,document.body.appendChild(ge),setTimeout(()=>{ge.remove()},o*.5)};if(I)I.target!==v.target&&!((q=t.isEquivalentTarget)!=null&&q.call(t,I.target,v.target))&&(v=null,m(o),U(I.target));else{let oe=document.elementFromPoint(v.x,v.y);v=null,m(o),U(oe||document.body)}}let ve=ie,ee=0,se=0;v&&(ve=v,ee=.4,se=(v.time-J+s)/s*n,J>v.time+s&&((z=t.isHeld)!=null&&z.call(t)||p?((w=t.beforeDispatch)==null||w.call(t),v.target.dispatchEvent(new PointerEvent("pointerup",Object.assign(M(v),{button:0,buttons:0}))),(N=t.afterDispatch)==null||N.call(t)):((G=t.beforePointerDownDispatch)==null||G.call(t),(V=t.beforeDispatch)==null||V.call(t),v.target.dispatchEvent(new PointerEvent("pointerdown",Object.assign(M(v),{button:0,buttons:1}))),(H=t.afterDispatch)==null||H.call(t),(X=t.shouldDrag)!=null&&X.call(t,v.target)?p=v.target:((Q=t.beforeDispatch)==null||Q.call(t),v.target.dispatchEvent(new PointerEvent("pointerup",Object.assign(M(v),{button:0,buttons:0}))),t.click(v),(ce=t.afterDispatch)==null||ce.call(t))),v=null,m(i))),p?y.classList.add("tracky-mouse-for-release"):y.classList.remove("tracky-mouse-for-release"),y.style.display="",y.style.opacity=ee,y.style.transform=`scale(${se/n})`,y.style.left=`${ve.x-n/2}px`,y.style.top=`${ve.y-n/2}px`;let K=p||(v||S(ie.x,ie.y)||{}).target;if(K&&(!h||(pe=t.dwellClickEvenIfPaused)!=null&&pe.call(t,K))){let I=K.getBoundingClientRect();const U=getComputedStyle(K);let oe=K,ge=1;for(;oe instanceof HTMLElement;){const Se=getComputedStyle(oe);if(Se.transform){const Ce=Se.transform.match(/(?:scale|matrix)\((\d+(?:\.\d+)?)/);Ce&&(ge*=Number(Ce[1]))}if(Se.overflow!=="visible"){const Ce=oe.getBoundingClientRect();I={left:Math.max(I.left,Ce.left),top:Math.max(I.top,Ce.top),right:Math.min(I.right,Ce.right),bottom:Math.min(I.bottom,Ce.bottom)},I.width=I.right-I.left,I.height=I.bottom-I.top}oe=oe.parentNode}A.style.display="block",A.style.position="fixed",A.style.left=`${I.left}px`,A.style.top=`${I.top}px`,A.style.width=`${I.width}px`,A.style.height=`${I.height}px`;for(const Se of["borderTopRightRadius","borderTopLeftRadius","borderBottomRightRadius","borderBottomLeftRadius"])U[Se].endsWith("px")?A.style[Se]=`${parseFloat(U[Se])*ge}px`:A.style[Se]=U[Se]}else A.style.display="none";if(J<d)return;de<5&&(v||(v={x:ae.x,y:ae.y,time:performance.now(),target:p||null},p||(v=S(v.x,v.y)),v&&h&&!((_e=t.dwellClickEvenIfPaused)!=null&&_e.call(t,v.target))&&(v=null))),de>100&&p&&((xe=t.beforeDispatch)==null||xe.call(t),window.dispatchEvent(new PointerEvent("pointerup",Object.assign(M(ae),{button:0,buttons:0}))),(Y=t.afterDispatch)==null||Y.call(t),(F=t.afterReleaseDrag)==null||F.call(t)),de>60&&(v=null)}};let D;const B=()=>{D=requestAnimationFrame(B),C()};return D=requestAnimationFrame(B),clean_up_dwell_clicking=()=>{cancelAnimationFrame(D),A.remove(),y.remove(),window.removeEventListener("pointermove",x),window.removeEventListener("pointerup",P),window.removeEventListener("pointercancel",P),window.removeEventListener("focus",g),window.removeEventListener("blur",_),document.removeEventListener("mouseleave",u),document.removeEventListener("mouseenter",b),clean_up_dwell_clicking=()=>{}},{get paused(){return h},set paused(J){h=J}}};TrackyMouse.initDwellClicking=function(t){return init_dwell_clicking(t)};TrackyMouse.cleanupDwellClicking=function(){clean_up_dwell_clicking()};TrackyMouse.init=function(t){var n=t||document.createElement("div");n.classList.add("tracky-mouse-ui"),n.innerHTML=`
		<div class="tracky-mouse-controls">
			<button class="tracky-mouse-start-stop-button" aria-pressed="false" aria-keyshortcuts="F9">Start</button>
			<br>
			<br>
			<label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Horizontal Sensitivity</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="25" class="tracky-mouse-sensitivity-x">
					<span class="tracky-mouse-min-label">Slow</span>
					<span class="tracky-mouse-max-label">Fast</span>
				</span>
			</label>
			<label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Vertical Sensitivity</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="50" class="tracky-mouse-sensitivity-y">
					<span class="tracky-mouse-min-label">Slow</span>
					<span class="tracky-mouse-max-label">Fast</span>
				</span>
			</label>
			<!-- <label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Smoothing</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="50" class="tracky-mouse-smoothing">
					<span class="tracky-mouse-min-label"></span>
					<span class="tracky-mouse-max-label"></span>
				</span>
			</label> -->
			<label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Acceleration</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="50" class="tracky-mouse-acceleration">
					<!-- TODO: "Linear" could be described as "Fast", and the other "Fast" labels are on the other side. Should it be swapped? What does other software with acceleration control look like? In Windows it's just a checkbox apparently, but it could go as far as a custom curve editor. -->
					<span class="tracky-mouse-min-label">Linear</span>
					<span class="tracky-mouse-max-label">Smooth</span>
				</span>
			</label>
			<!-- <label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Easy Stop (min distance to move)</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="50" class="tracky-mouse-min-distance">
					<span class="tracky-mouse-min-label">Jittery</span>
					<span class="tracky-mouse-max-label">Steady</span>
				</span>
			</label> -->
			<br>
			<!-- special interest: jspaint wants label not to use parent-child relationship so that os-gui's 98.css checkbox styles can work -->
			<!-- though this option might not be wanted in jspaint; might be good to hide it in the embedded case, or make it optional -->
			<!-- also TODO: add description of what this is for: on Windows, currently, when buttons are swapped at the system level, it affects serenade-driver's click() -->
			<!-- also this may be seen as a weirdly named/designed option for right-clicking -->
			<!-- btw: label is selected based on 'for' attribute -->
			<div class="tracky-mouse-control-row">
				<input type="checkbox" id="tracky-mouse-swap-mouse-buttons"/>
				<label for="tracky-mouse-swap-mouse-buttons"><span class="tracky-mouse-label-text">Swap mouse buttons</span></label>
			</div>
			<br>
			<!-- special interest: jspaint wants label not to use parent-child relationship so that os-gui's 98.css checkbox styles can work -->
			<!-- opposite, "Start paused", might be clearer, especially if I add a "pause" button -->
			<div class="tracky-mouse-control-row">
				<input type="checkbox" id="tracky-mouse-start-enabled"/>
				<label for="tracky-mouse-start-enabled"><span class="tracky-mouse-label-text">Start enabled</span></label>
			</div>
			<br>
			<!-- special interest: jspaint wants label not to use parent-child relationship so that os-gui's 98.css checkbox styles can work -->
			<div class="tracky-mouse-control-row">
				<input type="checkbox" id="tracky-mouse-run-at-login"/>
				<label for="tracky-mouse-run-at-login"><span class="tracky-mouse-label-text">Run at login</span></label>
			</div>
			<br>
			<!-- special interest: jspaint wants label not to use parent-child relationship so that os-gui's 98.css checkbox styles can work -->
			<!-- TODO: try moving this to the corner of the camera view, so it's clearer it applies only to the camera view -->
			<div class="tracky-mouse-control-row">
				<input type="checkbox" checked id="tracky-mouse-mirror"/>
				<label for="tracky-mouse-mirror"><span class="tracky-mouse-label-text">Mirror</span></label>
			</div>
			<br>
		</div>
		<div class="tracky-mouse-canvas-container-container">
			<div class="tracky-mouse-canvas-container">
				<div class="tracky-mouse-canvas-overlay">
					<button class="tracky-mouse-use-camera-button">Allow Camera Access</button>
					<!--<button class="tracky-mouse-use-camera-button">Use my camera</button>-->
					<button class="tracky-mouse-use-demo-footage-button" hidden>Use demo footage</button>
					<div class="tracky-mouse-error-message" role="alert" hidden></div>
				</div>
				<canvas class="tracky-mouse-canvas"></canvas>
			</div>
		</div>
		<p class="tracky-mouse-desktop-app-download-message">
			You can control your entire computer with the <a href="https://trackymouse.js.org/">TrackyMouse</a> desktop app.
		</p>
	`,t||document.body.appendChild(n);var s=n.querySelector(".tracky-mouse-start-stop-button"),e=n.querySelector("#tracky-mouse-mirror"),c=n.querySelector("#tracky-mouse-swap-mouse-buttons"),a=n.querySelector("#tracky-mouse-start-enabled"),i=n.querySelector("#tracky-mouse-run-at-login"),o=n.querySelector("label[for='tracky-mouse-swap-mouse-buttons']"),l=n.querySelector(".tracky-mouse-sensitivity-x"),r=n.querySelector(".tracky-mouse-sensitivity-y"),d=n.querySelector(".tracky-mouse-acceleration"),h=n.querySelector(".tracky-mouse-use-camera-button"),v=n.querySelector(".tracky-mouse-use-demo-footage-button"),p=n.querySelector(".tracky-mouse-error-message"),m=n.querySelector(".tracky-mouse-canvas-container"),A=n.querySelector(".tracky-mouse-desktop-app-download-message");window.electronAPI?(A.hidden=!0,window.electronAPI.getIsPackaged().then(Ie=>{i.disabled=!Ie})):(c.parentElement.hidden=!0,i.parentElement.hidden=!0);var y=n.querySelector(".tracky-mouse-canvas"),x=y.getContext("2d"),P=document.createElement("div");P.className="tracky-mouse-pointer",P.style.display="none",document.body.appendChild(P);var L=document.createElement("video");if(L.setAttribute("playsinline",""),typeof Stats<"u"){var T=new Stats;T.domElement.style.position="absolute",T.domElement.style.top="0px",T.domElement.style.right="0px",T.domElement.style.left="",document.body.appendChild(T.domElement)}var g=640,_=480,u=1e3,b=0,S=0,M=0,R=0,C=[],D,B,Z,J,q=0,z=.5,w=0,N=!0,G=!0,V,H,X,Q,ce=!0,pe=ce,_e=!0,xe={maxContinuousChecks:5,detectionConfidence:.9,maxFaces:1,iouThreshold:.3,scoreThreshold:.75},Y,F=!1,ie=!0,ae=!1,de=0,ve,ee,se=.7,K=0,I,U;let oe,ge;const Se=()=>{ge&&ge.terminate(),ae=!1,ie=!0,F=!1,ge=new Worker(`${TrackyMouse.dependenciesRoot}/facemesh.worker.js`),ge.addEventListener("message",Ie=>{Ie.data.type==="LOADED"&&(F=!0,ee=()=>{const Ue=oe;if(Ue)return ge.postMessage({type:"ESTIMATE_FACES",imageData:Ue}),new Promise((et,nt)=>{ge.addEventListener("message",lt=>{lt.data.type==="ESTIMATED_FACES"&&et(lt.data.predictions)},{once:!0})})})},{once:!0}),ge.postMessage({type:"LOAD",options:xe})};Se();function Ce(Ie,Ue=!1){"globalSettings"in Ie&&(Ie.globalSettings.swapMouseButtons!==void 0&&(Q=Ie.globalSettings.swapMouseButtons,c.checked=Q),Ie.globalSettings.mirrorCameraView!==void 0&&(V=Ie.globalSettings.mirrorCameraView,e.checked=V),Ie.globalSettings.headTrackingSensitivityX!==void 0&&(D=Ie.globalSettings.headTrackingSensitivityX,l.value=D*1e3),Ie.globalSettings.headTrackingSensitivityY!==void 0&&(B=Ie.globalSettings.headTrackingSensitivityY,r.value=B*1e3),Ie.globalSettings.headTrackingAcceleration!==void 0&&(Z=Ie.globalSettings.headTrackingAcceleration,d.value=Z*100),Ie.globalSettings.startEnabled!==void 0&&(H=Ie.globalSettings.startEnabled,a.checked=H,Ue&&(N=!H)),Ie.globalSettings.runAtLogin!==void 0&&(X=Ie.globalSettings.runAtLogin,i.checked=X))}const Re=1,qe="tracky-mouse-settings";function Ge(){return{formatVersion:Re,formatName:qe,globalSettings:{startEnabled:H,runAtLogin:X,swapMouseButtons:Q,mirrorCameraView:V,headTrackingSensitivityX:D,headTrackingSensitivityY:B,headTrackingAcceleration:Z}}}const Ye=Ie=>{if(window.electronAPI)window.electronAPI.setOptions(Ie);else try{localStorage.setItem("tracky-mouse-settings",JSON.stringify(Ge(),null,"	"))}catch(Ue){console.error(Ue)}},He=async(Ie=!1)=>{if(window.electronAPI)Ce(await window.electronAPI.getOptions(),Ie);else try{localStorage.getItem("tracky-mouse-settings")&&Ce(JSON.parse(localStorage.getItem("tracky-mouse-settings")),Ie)}catch(Ue){console.error(Ue)}};l.onchange=Ie=>{D=l.value/1e3,Ie&&Ye({globalSettings:{headTrackingSensitivityX:D}})},r.onchange=Ie=>{B=r.value/1e3,Ie&&Ye({globalSettings:{headTrackingSensitivityY:B}})},d.onchange=Ie=>{Z=d.value/100,Ie&&Ye({globalSettings:{headTrackingAcceleration:Z}})},e.onchange=Ie=>{V=e.checked,Ie&&Ye({globalSettings:{mirrorCameraView:V}})},c.onchange=Ie=>{Q=c.checked,Ie&&Ye({globalSettings:{swapMouseButtons:Q}})},a.onchange=Ie=>{H=a.checked,Ie&&Ye({globalSettings:{startEnabled:H}})},i.onchange=Ie=>{X=i.checked,Ie&&Ye({globalSettings:{runAtLogin:X}})},e.onchange(),c.onchange(),a.onchange(),i.onchange(),l.onchange(),r.onchange(),d.onchange(),N=!H;for(const Ie of[o,c])Ie.addEventListener("contextmenu",Ue=>{Ue.preventDefault(),c.checked=!c.checked,c.onchange(Ue)});const Xe=He(!0);var Qe=new clm.tracker({useWebGL:!1});Qe.init();var je=!1;const W=()=>{je=!1,C.length=0,ve&&(de=xe.maxContinuousChecks),ve=null,ce=!0,pe=!0,w=0,q=0,s.textContent="Start",s.setAttribute("aria-pressed","false")};h.onclick=TrackyMouse.useCamera=()=>{navigator.mediaDevices.getUserMedia({audio:!1,video:{width:g,height:_,facingMode:"user"}}).then(Ie=>{W();try{"srcObject"in L?L.srcObject=Ie:L.src=window.URL.createObjectURL(Ie)}catch{L.src=Ie}h.hidden=!0,p.hidden=!0,N||(s.textContent="Stop",s.setAttribute("aria-pressed","true"))},Ie=>{console.log(Ie),Ie.name=="NotFoundError"||Ie.name=="DevicesNotFoundError"?p.textContent="No camera found. Please make sure you have a camera connected and enabled.":Ie.name=="NotReadableError"||Ie.name=="TrackStartError"?p.textContent="Webcam is already in use. Please make sure you have no other programs using the camera.":Ie.name=="OverconstrainedError"||Ie.name=="ConstraintNotSatisfiedError"?p.textContent="Webcam does not support the required resolution. Please change your settings.":Ie.name=="NotAllowedError"||Ie.name=="PermissionDeniedError"?p.textContent="Permission denied. Please enable access to the camera.":Ie.name=="TypeError"?p.textContent=`Something went wrong accessing the camera. (${Ie.name}: ${Ie.message})`:p.textContent=`Something went wrong accessing the camera. Please try again. (${Ie.name}: ${Ie.message})`,p.textContent=`â ï¸ ${p.textContent}`,p.hidden=!1})},v.onclick=TrackyMouse.useDemoFootage=()=>{W(),L.srcObject=null,L.src=`${TrackyMouse.dependenciesRoot}/private/demo-input-footage.webm`,L.loop=!0},s.onclick=()=>{!h.hidden&&(TrackyMouse.useCamera(),!N)||Be("toggle-tracking")},navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||console.log("getUserMedia not supported in this browser"),m.style.aspectRatio=`${g} / ${_}`,m.style.setProperty("--aspect-ratio",g/_),L.addEventListener("loadedmetadata",()=>{L.play(),L.width=L.videoWidth,L.height=L.videoHeight,y.width=L.videoWidth,y.height=L.videoHeight,re.width=L.videoWidth,re.height=L.videoHeight,ue.width=L.videoWidth,ue.height=L.videoHeight,m.style.aspectRatio=`${L.videoWidth} / ${L.videoHeight}`,m.style.setProperty("--aspect-ratio",L.videoWidth/L.videoHeight),I=new fe,U=new fe}),L.addEventListener("play",()=>{Qe.reset(),Qe.initFaceDetector(L),je=!0}),L.addEventListener("ended",()=>{h.hidden=!1,N||Be("toggle-tracking")}),L.addEventListener("error",()=>{h.hidden=!1,N||Be("toggle-tracking")}),y.width=g,y.height=_,L.width=g,L.height=_;const re=document.createElement("canvas");re.width=y.width,re.height=y.height,re.getContext("2d");const ue=document.createElement("canvas");ue.width=y.width,ue.height=y.height;const he=ue.getContext("2d"),we=5,$e=we*1.5;class fe{constructor(){this.curPyramid=new jsfeat.pyramid_t(3),this.prevPyramid=new jsfeat.pyramid_t(3),this.curPyramid.allocate(L.videoWidth,L.videoHeight,jsfeat.U8C1_t),this.prevPyramid.allocate(L.videoWidth,L.videoHeight,jsfeat.U8C1_t),this.pointCount=0,this.pointStatus=new Uint8Array(u),this.prevXY=new Float32Array(u*2),this.curXY=new Float32Array(u*2)}addPoint(Ue,et){if(this.pointCount<u){var nt=this.pointCount*2;this.curXY[nt]=Ue,this.curXY[nt+1]=et,this.prevXY[nt]=Ue,this.prevXY[nt+1]=et,this.pointCount++}}filterPoints(Ue){for(var et=0,nt=0;nt<this.pointCount;nt++)if(Ue(nt)){if(et<nt){const lt=nt*2,vt=et*2;this.curXY[vt]=this.curXY[lt],this.curXY[vt+1]=this.curXY[lt+1],this.prevXY[vt]=this.prevXY[lt],this.prevXY[vt+1]=this.prevXY[lt+1]}et++}else{he.fillStyle="red";const lt=nt*2;De(he,this.curXY[lt],this.curXY[lt+1],5),he.fillText(Ue.toString(),5+this.curXY[lt],this.curXY[lt+1]),x.strokeStyle=x.fillStyle,x.beginPath(),x.moveTo(this.prevXY[lt],this.prevXY[lt+1]),x.lineTo(this.curXY[lt],this.curXY[lt+1]),x.stroke()}this.pointCount=et}prunePoints(){this.filterPoints(nt=>this.pointStatus[nt]==1);const Ue={};for(let nt=0;nt<this.pointCount;nt++){const lt=nt*2;Ue[`${~~(this.curXY[lt]/we)},${~~(this.curXY[lt+1]/we)}`]=nt}const et=Object.values(Ue);this.filterPoints(nt=>et.includes(nt))}update(Ue){[this.prevXY,this.curXY]=[this.curXY,this.prevXY],[this.prevPyramid,this.curPyramid]=[this.curPyramid,this.prevPyramid];var et=20,nt=30,lt=.01,vt=.001;jsfeat.imgproc.grayscale(Ue.data,Ue.width,Ue.height,this.curPyramid.data[0]),this.curPyramid.build(this.curPyramid.data[0],!0),jsfeat.optical_flow_lk.track(this.prevPyramid,this.curPyramid,this.prevXY,this.curXY,this.pointCount,et,nt,this.pointStatus,lt,vt),this.prunePoints()}draw(Ue){for(var et=0;et<this.pointCount;et++){var nt=et*2;De(Ue,this.curXY[nt],this.curXY[nt+1],3),Ue.strokeStyle=Ue.fillStyle,Ue.beginPath(),Ue.moveTo(this.prevXY[nt],this.prevXY[nt+1]),Ue.lineTo(this.curXY[nt],this.curXY[nt+1]),Ue.stroke()}}getMovement(){for(var Ue=0,et=0,nt=0,lt=0;lt<this.pointCount;lt++){var vt=lt*2;Ue+=this.curXY[vt]-this.prevXY[vt],et+=this.curXY[vt+1]-this.prevXY[vt+1],nt+=1}return nt>0&&(Ue/=nt,et/=nt),[Ue,et]}}y.addEventListener("click",Ie=>{if(!I)return;const Ue=y.getBoundingClientRect();V?I.addPoint((Ue.right-Ie.clientX)/Ue.width*y.width,(Ie.clientY-Ue.top)/Ue.height*y.height):I.addPoint((Ie.clientX-Ue.left)/Ue.width*y.width,(Ie.clientY-Ue.top)/Ue.height*y.height)});function be(Ie,Ue,et){for(var nt=0;nt<Ie.pointCount;nt++){var lt=nt*2;if(Math.abs(Ue-Ie.curXY[lt])<=$e||Math.abs(et-Ie.curXY[lt+1])<=$e)return}Ie.addPoint(Ue,et)}function Ae(Ie=!0){x.resetTransform(),x.clearRect(0,0,y.width,y.height),x.save(),x.drawImage(L,0,0,y.width,y.height);const Ue=x.getImageData(0,0,y.width,y.height);if(oe=Ue,V&&(x.translate(y.width,0),x.scale(-1,1),x.drawImage(L,0,0,y.width,y.height)),!!I){if(Ie){if(je){if(ce||pe){try{Qe.track(L)}catch(_t){console.warn("Error in clmTracker.track()",_t),Qe.getCurrentParameters().includes(NaN)&&console.warn("NaNs crept in.")}J=Qe.getCurrentPosition(),q=Qe.getScore(),Math.pow(Qe.getConvergence(),.5)}F&&!ae&&(ae=!0,C=[],clearTimeout(Y),Y=setTimeout(()=>{ce||(W(),Qe.init(),Qe.reset(),Qe.initFaceDetector(L),je=!0,console.warn("Falling back to clmtrackr")),Y=setInterval(()=>{try{document.createElement("canvas").getContext("webgl2"),clearInterval(Y),setTimeout(()=>{console.warn("Re-initializing facemesh worker"),Se(),de=1},1e3)}catch(_t){if(_t.name!=="InvalidStateError")throw _t;console.warn("Trying to recover; can't create webgl2 canvas yet...")}},500)},ie?2e4:2e3),ee().then(_t=>{if(ae=!1,ie=!1,de-=1,de>0||(ve=_t[0],ce=!1,pe=!1,clearTimeout(Y),!ve))return;U.filterPoints(()=>!1);const{annotations:pt}=ve;U.addPoint(pt.noseLeftCorner[0][0],pt.noseLeftCorner[0][1]),U.addPoint(pt.noseRightCorner[0][0],pt.noseRightCorner[0][1]),U.addPoint(pt.midwayBetweenEyes[0][0],pt.midwayBetweenEyes[0][1]);for(var Rt=0;Rt<U.pointCount;Rt++){const Ot=Rt*2;be(I,U.curXY[Ot],U.curXY[Ot+1])}K=ve.faceInViewConfidence,I.filterPoints(Ot=>{var Mt=Ot*2,Qt=Math.hypot((pt.noseTip[0][0]-I.curXY[Mt])*1.4,pt.noseTip[0][1]-I.curXY[Mt+1]),ln=Math.hypot(pt.leftCheek[0][0]-pt.rightCheek[0][0],pt.leftCheek[0][1]-pt.rightCheek[0][1]);return!(Qt>ln||(Qt=Math.min(Math.hypot(pt.leftEyeLower0[0][0]-I.curXY[Mt],pt.leftEyeLower0[0][1]-I.curXY[Mt+1]),Math.hypot(pt.rightEyeLower0[0][0]-I.curXY[Mt],pt.rightEyeLower0[0][1]-I.curXY[Mt+1])),Qt<ln*.42))})},()=>{ae=!1,ie=!1}))}I.update(Ue)}if(window.electronAPI&&window.electronAPI.notifyCameraFeedDiagnostics({headNotFound:!J&&!ve}),ve){x.fillStyle="red";const _t=ve.faceInViewConfidence<se;x.fillStyle=_t?"rgb(255,255,0)":"rgb(130,255,50)",!_t||I.pointCount<3||ve.faceInViewConfidence>K+.05?(_t&&(x.fillStyle="rgba(255,0,255)"),Ie&&_e&&ve.scaledMesh.forEach(pt=>{pt[0]+=M,pt[1]+=R}),ve.scaledMesh.forEach(([pt,Rt,Ot])=>{x.fillRect(pt,Rt,1,1)})):Ie&&_e&&(K-=.001)}if(J){const _t=q<z;x.strokeStyle=_t?"rgb(255,255,0)":"rgb(130,255,50)",!_t||I.pointCount<2||q>w+.05?(_t&&(x.strokeStyle="rgba(255,0,255)"),Ie&&ce&&(w=q,be(I,J[42][0],J[42][1]),be(I,J[43][0],J[43][1]),I.filterPoints(pt=>{var Rt=pt*2,Ot=Math.hypot((J[62][0]-I.curXY[Rt])*1.4,J[62][1]-I.curXY[Rt+1]),Mt=Math.hypot(J[23][0]-J[28][0],J[23][1]-J[28][1]);return!(Ot>Mt)}))):Ie&&ce&&(w-=.001),pe&&Qe.draw(y,void 0,void 0,!0)}if(x.fillStyle="lime",I.draw(x),he.fillStyle="green",I.draw(he),Ie){var[et,nt]=I.getMovement(),lt=(_t,pt)=>_t/1*Math.abs(_t*5)**Z,vt=Math.hypot(et,nt),Ct=lt(et*D,vt),Gt=lt(nt*B,vt);if(!isFinite(Ct)||!isFinite(Gt))return;if(!N){const _t=window.electronAPI?screen.width:innerWidth,pt=window.electronAPI?screen.height:innerHeight;b-=Ct*_t,S+=Gt*pt,b=Math.min(Math.max(0,b),_t),S=Math.min(Math.max(0,S),pt),G&&(b=_t/2,S=pt/2,G=!1),window.electronAPI?(window.electronAPI.moveMouse(~~b,~~S),P.style.display="none"):(P.style.display="",P.style.left=`${b}px`,P.style.top=`${S}px`),TrackyMouse.onPointerMove&&TrackyMouse.onPointerMove(b,S)}M=et,R=nt}x.restore(),T==null||T.update()}}function De(Ie,Ue,et,nt){Ie.beginPath(),Ie.arc(Ue,et,nt,0,Math.PI*2),Ie.fill()}setInterval(function(){Ae(!N||document.visibilityState==="visible")},15);let Ve=!1;try{Ve=localStorage.trackyMouseAutoDemo==="true"}catch{}Ve?TrackyMouse.useDemoFootage():window.electronAPI&&TrackyMouse.useCamera();const Ke=()=>{G=!0,N&&(P.style.display="none"),N?(s.textContent="Start",s.setAttribute("aria-pressed","false")):(s.textContent="Stop",s.setAttribute("aria-pressed","true")),window.electronAPI&&window.electronAPI.notifyToggleState(!N)},Be=Ie=>{Ie==="toggle-tracking"&&(N=!N,Ke())};Xe.then(Ke),window.electronAPI&&window.electronAPI.onShortcut(Be),addEventListener("keydown",Ie=>{!Ie.ctrlKey&&!Ie.metaKey&&!Ie.altKey&&!Ie.shiftKey&&Ie.key==="F9"&&Be("toggle-tracking")})};typeof module<"u"&&module.exports&&(module.exports=TrackyMouse);(t=>{const n=document.createElement.bind(document);function s(l){return l&&typeof l=="object"&&"tagName"in l?l.tagName.toLowerCase()+(l.id?"#"+l.id:"")+(l.className?"."+l.className.split(" ").join("."):"")+(l.src?`[src="${l.src}"]`:"")+(l.srcdoc?"[srcdoc]":"")+(l.href?`[href="${l.href}"]`:""):l?l.constructor.name:`${l}`}function e(l){let d=$(l).find(`
		input:enabled,
		textarea:enabled,
		select:enabled,
		button:enabled,
		a[href],
		[tabIndex='0'],
		details summary,
		iframe,
		object,
		embed,
		video[controls],
		audio[controls],
		[contenteditable]:not([contenteditable='false'])
	`).filter(":visible");const h={},v=[];for(const m of d.toArray())m.nodeName.toLowerCase()==="input"&&m.type==="radio"&&(h[m.name]?m.checked?(v.push(h[m.name]),h[m.name]=m):v.push(m):h[m.name]=m);return d.not(v)}var c=$(window);i.Z_INDEX=5;var a=[];function i(l={}){var F,ie,ae;var r=$(n("div")).addClass("window os-window").appendTo("body");r[0].$window=r,r.element=r[0],r[0].id=`os-window-${Math.random().toString(36).substr(2,9)}`,r.$titlebar=$(n("div")).addClass("window-titlebar").appendTo(r),r.$title_area=$(n("div")).addClass("window-title-area").appendTo(r.$titlebar),r.$title=$(n("span")).addClass("window-title").appendTo(r.$title_area),l.toolWindow&&(l.minimizeButton=!1,l.maximizeButton=!1),l.minimizeButton!==!1&&(r.$minimize=$(n("button")).addClass("window-minimize-button window-action-minimize window-button").appendTo(r.$titlebar),r.$minimize.attr("aria-label","Minimize window"),r.$minimize.append("<span class='window-button-icon'></span>")),l.maximizeButton!==!1&&(r.$maximize=$(n("button")).addClass("window-maximize-button window-action-maximize window-button").appendTo(r.$titlebar),r.$maximize.attr("aria-label","Maximize or restore window"),l.resizable||r.$maximize.prop("disabled",!0),r.$maximize.append("<span class='window-button-icon'></span>")),l.closeButton!==!1&&(r.$x=$(n("button")).addClass("window-close-button window-action-close window-button").appendTo(r.$titlebar),r.$x.attr("aria-label","Close window"),r.$x.append("<span class='window-button-icon'></span>")),r.$content=$(n("div")).addClass("window-content").appendTo(r),r.$content.attr("tabIndex","-1"),r.$content.css("outline","none"),l.toolWindow&&r.addClass("tool-window"),l.parentWindow&&(l.parentWindow.addChildWindow(r),l.toolWindow&&(r[0].dataset.semanticParent=l.parentWindow[0].id));var d=l.$component;if(typeof l.icon=="object"&&"tagName"in l.icon)l.icons={any:l.icon};else if(l.icon)if(console.warn("DEPRECATED: use options.icons instead of options.icon, e.g. new $Window({icons: {16: 'app-16x16.png', any: 'app-icon.svg'}})"),typeof $Icon<"u"&&typeof TITLEBAR_ICON_SIZE<"u")r.icon_name=l.icon,r.$icon=$Icon(l.icon,TITLEBAR_ICON_SIZE).prependTo(r.$titlebar);else throw new Error("Use {icon: img_element} or {icons: {16: url_or_img_element}} options");r.icons=l.icons||{};let h=16;r.setTitlebarIconSize=function(de){var ve;if(r.icons){(ve=r.$icon)==null||ve.remove();const ee=r.getIconAtSize(de);r.$icon=ee?$(ee):$(),r.$icon.prependTo(r.$titlebar)}h=de,r.trigger("icon-change")},r.getTitlebarIconSize=function(){return h},r.getIconAtSize=function(de){let ve;if(r.icons[de])ve=de;else if(r.icons.any)ve="any";else{const ee=Object.keys(r.icons).filter(se=>isFinite(se)&&isFinite(parseFloat(se)));ee.sort((se,K)=>Math.abs(parseFloat(se)-de)-Math.abs(parseFloat(K)-de)),ve=ee[0]}if(ve){const ee=r.icons[ve];let se;if(typeof ee=="object"&&"cloneNode"in ee)se=ee.cloneNode(!0);else{se=n("img");const K=$(se);typeof ee=="string"?K.attr("src",ee):"srcset"in ee?K.attr("srcset",ee.srcset):K.attr("src",ee.src),K.attr({width:ve,height:ve,draggable:!1}),K.css({width:de,height:de})}return se}return null},r.setTitlebarIconSize(h),r.getIconName=()=>(console.warn("DEPRECATED: use $w.icons object instead of $w.icon_name"),r.icon_name),r.setIconByID=de=>{var ee;console.warn("DEPRECATED: use $w.setIcons(icons) instead of $w.setIconByID(icon_name)");var ve=r.$icon;return r.$icon=$Icon(de,TITLEBAR_ICON_SIZE),ve.replaceWith(r.$icon),r.icon_name=de,(ee=r.task)==null||ee.updateIcon(),r.trigger("icon-change"),r},r.setIcons=de=>{var ve;r.icons=de,r.setTitlebarIconSize(h),(ve=r.task)==null||ve.updateIcon()},d&&r.addClass("component-window"),setTimeout(()=>{v()=="rtl"&&r.addClass("rtl")},0);function v(){return window.get_direction?window.get_direction():getComputedStyle(r[0]).direction}const p=$({}),m=de=>ve=>{const ee=()=>{ve()};return p.on(de,ee),()=>{p.off(de,ee)}};r.onFocus=m("focus"),r.onBlur=m("blur"),r.onClosed=m("closed"),r.setDimensions=({innerWidth:de,innerHeight:ve,outerWidth:ee,outerHeight:se})=>{let K,I;if(de&&(K=r.outerWidth()-r.$content.outerWidth()),ve){I=r.outerHeight()-r.$content.outerHeight();const U=r.$content.find(".menus");U.length&&(I+=U.outerHeight())}ee&&r.outerWidth(ee),se&&r.outerHeight(se),de&&r.outerWidth(de+K),ve&&r.outerHeight(ve+I)},r.setDimensions(l);let A=[];r.addChildWindow=de=>{A.push(de)};const y=()=>{r.hasClass("focused")||(r.addClass("focused"),p.triggerHandler("focus"))},x=()=>{r.hasClass("focused")&&(r.removeClass("focused"),p.triggerHandler("blur"))};r.focus=()=>{r.bringToFront(),q()},r.blur=()=>{x(),document.activeElement&&document.activeElement.closest(".window")==r[0]&&document.activeElement.blur()},l.toolWindow&&(l.parentWindow?(l.parentWindow.onFocus(y),l.parentWindow.onBlur(x),document.activeElement&&document.activeElement.closest(".window")==l.parentWindow[0]&&y()):($(window).on("focus",y),$(window).on("blur",x),document.hasFocus()&&y()));{let ve=function(K){if(!u.has(K)){const I=se(K,!1);u.set(K,I),setTimeout(()=>{try{const U=oe=>{K.contentDocument.readyState=="complete"?oe():setTimeout(()=>{U(oe)},100)};U(()=>{K.contentWindow.addEventListener("focusin",I),K.contentWindow.addEventListener("focusout",I),K.contentWindow.addEventListener("blur",I),K.contentWindow.addEventListener("focus",I),ee(K.contentDocument)})}catch(U){R(K,U)}},100)}},ee=function(K){new MutationObserver(U=>{for(const oe of U)for(const ge of oe.addedNodes)ge.tagName=="IFRAME"&&ve(ge)}).observe(K,{childList:!0,subtree:!0});for(const U of K.querySelectorAll("iframe"))ve(U)},se=function(K,I){return function(oe){var Ge,Ye;const ge=K.tagName=="IFRAME"?K.contentDocument:K,Se=ge.ownerDocument??ge;let Ce=oe?oe.type==="focusout"||oe.type==="blur"?oe.relatedTarget:oe.target:Se.activeElement;(oe==null?void 0:oe.type)==="blur"&&(Ce=null),Se.activeElement&&Se.activeElement.tagName==="IFRAME"&&((oe==null?void 0:oe.type)==="focusout"||(oe==null?void 0:oe.type)==="blur")&&!Ce&&(Ce=Se.activeElement);const Re=!Ce||Ce.window===Ce||!ge.contains(Ce);if(Re&&ge!==Ce&&I&&(l.toolWindow||x()),!Re&&Ce.tagName!=="HTML"&&Ce.tagName!=="BODY"&&Ce!==ge&&!Ce.matches(".window-content")&&!Ce.closest(".menus")&&!Ce.closest(".window-titlebar")&&(_.set(K,Ce),C(Se,ge,Ce,I)),!Re&&Ce.tagName==="IFRAME"){const He=Ce;try{const Xe=He.contentDocument.activeElement;Xe&&Xe.tagName!=="HTML"&&Xe.tagName!=="BODY"&&!Xe.closest(".menus")&&(_.set(He,Xe),C(He.contentDocument,He.contentDocument,Xe,I))}catch(Xe){R(He,Xe)}}if(I)do{const He=(Ge=Ce==null?void 0:Ce.closest)==null?void 0:Ge.call(Ce,"[data-semantic-parent]");if(He){const Xe=He.dataset.semanticParent,Qe=He.ownerDocument.getElementById(Xe);if(Ce=Qe,!Qe){console.warn("semantic parent not found with id",Xe);break}}else break}while(!0);if(Ce&&Ce.window!==Ce&&ge.contains(Ce)){if(l.toolWindow||y(),r.bringToFront(),!I){let He=K;for(;He;)He.dispatchEvent(new Event("focusin",{bubbles:!0,target:He,view:He.ownerDocument.defaultView})),He=(Ye=He.ownerDocument.defaultView)==null?void 0:Ye.frameElement}}else I&&(l.toolWindow||x())}};var _e=ve,xe=ee,Y=se;const de=se(r[0],!0);window.addEventListener("focusin",de),window.addEventListener("focusout",de),window.addEventListener("blur",de),window.addEventListener("focus",de),ee(r.$content[0])}r.css("touch-action","none");let P=null;r.setMinimizeTarget=function(de){P=de};let L;Object.defineProperty(r,"task",{get(){return L},set(de){console.warn("DEPRECATED: use $w.setMinimizeTarget(taskbar_button_el) instead of setting $window.task object"),L=de}});let T;r.minimize=()=>{if(P=P||(L==null?void 0:L.$task[0]),Q){ce.push(r.minimize);return}if(r.is(":visible"))if(P&&!r.hasClass("minimized-without-taskbar")){const de=r.$titlebar[0].getBoundingClientRect(),ve=P.getBoundingClientRect();r.animateTitlebar(de,ve,()=>{r.hide(),r.blur()})}else{if(r.hasClass("minimized-without-taskbar"))a[r._minimize_slot_index]=null;else{let Se=0;for(;a[Se];)Se++;r._minimize_slot_index=Se,a[Se]=r}const ee=r._minimize_slot_index*160+10,se=r.$titlebar.outerHeight()??0;let K;const I=()=>{T={position:r.css("position"),left:r.css("left"),top:r.css("top"),width:r.css("width"),height:r.css("height")},r.addClass("minimized-without-taskbar"),r.hasClass("maximized")&&(r.removeClass("maximized"),r.addClass("was-maximized"),r.$maximize.removeClass("window-action-restore"),r.$maximize.addClass("window-action-maximize")),r.$minimize.removeClass("window-action-minimize"),r.$minimize.addClass("window-action-restore"),K?r.css({position:K.position,left:K.left,top:K.top,width:K.width,height:K.height}):r.css({position:"fixed",top:`calc(100% - ${se+5}px)`,left:`${ee}px`,width:"150px",height:`${se}px`})},U=()=>{K={position:r.css("position"),left:r.css("left"),top:r.css("top"),width:r.css("width"),height:r.css("height")},r.removeClass("minimized-without-taskbar"),r.hasClass("was-maximized")&&(r.removeClass("was-maximized"),r.addClass("maximized"),r.$maximize.removeClass("window-action-maximize"),r.$maximize.addClass("window-action-restore")),r.$minimize.removeClass("window-action-restore"),r.$minimize.addClass("window-action-minimize"),r.css({width:"",height:""}),T&&r.css({position:T.position,left:T.left,top:T.top,width:T.width,height:T.height})},oe=r.$titlebar[0].getBoundingClientRect();let ge;r.css("transform",""),r.hasClass("minimized-without-taskbar")?(U(),ge=r.$titlebar[0].getBoundingClientRect(),I()):(I(),ge=r.$titlebar[0].getBoundingClientRect(),U()),r.animateTitlebar(oe,ge,()=>{r.hasClass("minimized-without-taskbar")?U():(I(),r.blur())})}},r.unminimize=()=>{if(Q){ce.push(r.unminimize);return}if(r.hasClass("minimized-without-taskbar")){r.minimize();return}if(r.is(":hidden")){const de=P.getBoundingClientRect();r.show();const ve=r.$titlebar[0].getBoundingClientRect();r.hide(),r.animateTitlebar(de,ve,()=>{r.show(),r.bringToFront(),r.focus()})}};let g;r.maximize=()=>{if(!l.resizable)return;if(Q){ce.push(r.maximize);return}if(r.hasClass("minimized-without-taskbar")){r.minimize();return}const de=()=>{g={position:r.css("position"),left:r.css("left"),top:r.css("top"),width:r.css("width"),height:r.css("height")},r.addClass("maximized");const I=$(".taskbar"),U=window.innerWidth-$(window).width(),oe=window.innerHeight-$(window).height(),ge=I.length?I.outerHeight()+1:0;r.css({position:"fixed",top:0,left:0,width:`calc(100vw - ${U}px)`,height:`calc(100vh - ${oe}px - ${ge}px)`})},ve=()=>{r.removeClass("maximized"),r.css({width:"",height:""}),g&&r.css({position:g.position,left:g.left,top:g.top,width:g.width,height:g.height})},ee=r.$titlebar[0].getBoundingClientRect();let se;r.css("transform","");const K=r.hasClass("maximized");K?(ve(),se=r.$titlebar[0].getBoundingClientRect(),de()):(de(),se=r.$titlebar[0].getBoundingClientRect(),ve()),r.animateTitlebar(ee,se,()=>{K?(ve(),r.$maximize.removeClass("window-action-restore"),r.$maximize.addClass("window-action-maximize")):(de(),r.$maximize.removeClass("window-action-maximize"),r.$maximize.addClass("window-action-restore"))})},r.restore=()=>{r.is(".minimized-without-taskbar, .minimized")?r.unminimize():r.is(".maximized")&&r.maximize()},(F=r.$minimize)==null||F.on("click",de=>{r.minimize()}),(ie=r.$maximize)==null||ie.on("click",de=>{r.maximize()}),(ae=r.$x)==null||ae.on("click",de=>{r.close()}),r.$title_area.on("dblclick",de=>{r.maximize()}),r.css({position:"absolute",zIndex:i.Z_INDEX++}),r.bringToFront=()=>{r.css({zIndex:i.Z_INDEX++});for(const de of A)de.bringToFront()};var _=new Map,u=new Map,b=new Map,S=[],M=new WeakSet;const R=(de,ve)=>{var K;const ee=I=>[`OS-GUI.js failed to access an iframe (${s(de)}) for focus integration.
${I}
Original error:
`,ve];let se;if(de.srcdoc)se=!1;else try{se=new URL(de.src).origin!==window.location.origin}catch(I){console.error(...ee(`This may be a bug in OS-GUI. Is this a cross-origin iframe? Failed to parse URL (${I}).`));return}se?(K=l.iframes)!=null&&K.ignoreCrossOrigin&&!M.has(de)&&(console.warn(...ee(`Only same-origin iframes can work with focus integration (showing window as focused, refocusing last focused controls).
If you can re-host the content on the same origin, you can resolve this and enable focus integration.
You can also disable this warning by passing {iframes: {ignoreCrossOrigin: true}} to $Window.`)),M.add(de)):console.error(...ee("This may be a bug in OS-GUI, since it doesn't appear to be a cross-origin iframe."))},C=(de,ve,ee,se)=>{if(!i.DEBUG_FOCUS)return;let K=b.get(ve);K||(K=de.createElementNS("http://www.w3.org/2000/svg","svg"),K.style.position="fixed",K.style.top="0",K.style.left="0",K.style.width="100%",K.style.height="100%",K.style.pointerEvents="none",K.style.zIndex="100000000",K.style.direction="ltr",b.set(ve,K),S.push(K),de.body.appendChild(K)),K._container_el=ve,K._descendant_el=ee,K._is_root=se,Z()},D=de=>{var oe,ge;const ve=de._container_el,ee=de._descendant_el,se=de._is_root;for(;de.lastChild;)de.removeChild(de.lastChild);const K=((oe=ee.getBoundingClientRect)==null?void 0:oe.call(ee))??{left:0,top:0,width:innerWidth,height:innerHeight,right:innerWidth,bottom:innerHeight},I=((ge=ve.getBoundingClientRect)==null?void 0:ge.call(ve))??{left:0,top:0,width:innerWidth,height:innerHeight,right:innerWidth,bottom:innerHeight};for(const Se of[K,I]){const Ce=document.createElementNS("http://www.w3.org/2000/svg","rect");Ce.setAttribute("x",Se.left),Ce.setAttribute("y",Se.top),Ce.setAttribute("width",Se.width),Ce.setAttribute("height",Se.height),Ce.setAttribute("stroke","#f44"),Ce.setAttribute("stroke-width","2"),Ce.setAttribute("fill","none"),se||Ce.setAttribute("stroke-dasharray","5,5"),de.appendChild(Ce);const Re=document.createElementNS("http://www.w3.org/2000/svg","text");Re.setAttribute("x",Se.left),Re.setAttribute("y",Se.top+(Se===K?20:0)),Re.setAttribute("fill",Se===K?"#f44":"aqua"),Re.setAttribute("font-size","20"),Re.style.textShadow="1px 1px 1px black, 0 0 10px black",Re.textContent=s(Se===K?ee:ve),de.appendChild(Re)}const U=[[K.left,K.top,I.left,I.top],[K.right,K.top,I.right,I.top],[K.left,K.bottom,I.left,I.bottom],[K.right,K.bottom,I.right,I.bottom]];for(const Se of U){const Ce=document.createElementNS("http://www.w3.org/2000/svg","line");Ce.setAttribute("x1",Se[0]),Ce.setAttribute("y1",Se[1]),Ce.setAttribute("x2",Se[2]),Ce.setAttribute("y2",Se[3]),Ce.setAttribute("stroke","green"),Ce.setAttribute("stroke-width","2"),de.appendChild(Ce)}};let B;const Z=()=>{if(cancelAnimationFrame(B),!i.DEBUG_FOCUS){J();return}B=requestAnimationFrame(Z);for(const de of S)D(de)},J=()=>{cancelAnimationFrame(B);for(const de of S)de.remove();S.length=0,b.clear()},q=(de=r.$content[0])=>{const ve=de.matches(".window-content")?r[0]:de,ee=_.get(ve);if(ee){if(ee.focus({preventScroll:!0}),ee.tagName==="IFRAME")try{q(ee)}catch(I){R(ee,I)}return}const se=e(de),K=se.filter(".default");if(K.length){K[0].focus({preventScroll:!0});return}if(se.length){if(se[0].tagName==="IFRAME"){const I=se[0];try{q(I)}catch(U){R(I,U)}}else se[0].focus({preventScroll:!0});return}if(l.toolWindow&&l.parentWindow){l.parentWindow.triggerHandler("refocus-window");return}if(de.focus({preventScroll:!0}),de.tagName==="IFRAME"){const I=de;try{q(I.contentDocument.body)}catch(U){R(I,U)}}};r.on("refocus-window",()=>{q()}),r.on("pointerdown mousedown",z),c.on("focusin",de=>{_.set(window,de.target)});function z(de){r.bringToFront(),requestAnimationFrame(()=>{var se,K;const ve=_.get(window);if(document.activeElement&&document.activeElement!==document&&document.activeElement!==document.body&&document.activeElement!==r.$content[0]&&document.activeElement!==ve||(K=(se=document.activeElement)==null?void 0:se.closest)!=null&&K.call(se,".menus, .menu-popup"))return;if(getComputedStyle(de.target).userSelect!=="none"){r.$content.focus(),r.one("pointerup pointercancel",()=>{requestAnimationFrame(()=>{var I;(I=getSelection())!=null&&I.toString().trim()||q()})});return}q()})}r.on("keydown",de=>{if(de.isDefaultPrevented()||de.ctrlKey||de.altKey||de.metaKey||de.target.closest(".menus"))return;const ve=r.$content.find("button"),ee=$(document.activeElement),se=ve.index(ee);switch(de.keyCode){case 40:case 39:ee.is("button")&&!de.shiftKey&&se<ve.length-1&&(ve[se+1].focus(),de.preventDefault());break;case 38:case 37:ee.is("button")&&!de.shiftKey&&se>0&&(ve[se-1].focus(),de.preventDefault());break;case 32:case 13:if(ee.is("button")&&!de.shiftKey){ee.addClass("pressed");const K=()=>{ee.removeClass("pressed"),ee.off("focusout",K),$(window).off("keyup",I)},I=U=>{(U.keyCode===32||U.keyCode===13)&&K()};ee.on("focusout",K),$(window).on("keyup",I)}break;case 9:{const K=e(r.$content[0]);if(K.length>0){const I=K.index(ee);de.shiftKey?I===0&&(de.preventDefault(),K[K.length-1].focus()):I===K.length-1&&(de.preventDefault(),K[0].focus())}break}case 27:r.close();break}}),r.applyBounds=()=>{const de=Math.max(document.body.scrollWidth,innerWidth),ve=Math.max(document.body.scrollHeight,innerHeight);r.css({left:Math.max(0,Math.min(de-r.width(),r.position().left)),top:Math.max(0,Math.min(ve-r.height(),r.position().top))})},r.bringTitleBarInBounds=()=>{const de=Math.max(document.body.scrollWidth,innerWidth),ve=Math.max(document.body.scrollHeight,innerHeight),ee=40;r.css({left:Math.max(ee-r.outerWidth(),Math.min(de-ee,r.position().left)),top:Math.max(0,Math.min(ve-r.$titlebar.outerHeight()-5,r.position().top))})},r.center=()=>{r.css({left:(innerWidth-r.width())/2+window.scrollX,top:(innerHeight-r.height())/2+window.scrollY}),r.applyBounds()},c.on("resize",r.bringTitleBarInBounds);var w,N,G,V,H,X=de=>{var ee;const ve=de.pointerId??((ee=de.originalEvent)==null?void 0:ee.pointerId);(H===ve||ve===void 0||H===void 0||H===1234567890)&&(G=de.clientX??G,V=de.clientY??V),r.css({left:G+scrollX-w,top:V+scrollY-N})};r.$titlebar.css("touch-action","none"),r.$titlebar.on("selectstart",de=>{de.preventDefault()}),r.$titlebar.on("mousedown","button",de=>{q();const ve=de.currentTarget;if(!$(ve).is(":enabled"))return;ve.classList.add("pressing");const ee=I=>{I&&I.type==="blur"&&document.hasFocus()||(ve.classList.remove("pressing"),c.off("mouseup blur",ee),$(ve).off("mouseenter",se),$(ve).off("mouseleave",K))},se=()=>{ve.classList.add("pressing")},K=()=>{ve.classList.remove("pressing")};c.on("mouseup blur",ee),$(ve).on("mouseenter",se),$(ve).on("mouseleave",K)}),r.$titlebar.on("pointerdown",de=>{var ee;if($(de.target).closest("button").length||r.hasClass("maximized"))return;const ve=$.Event("window-drag-start");r.trigger(ve),!ve.isDefaultPrevented()&&(w=de.clientX+scrollX-r.position().left,N=de.clientY+scrollY-r.position().top,G=de.clientX,V=de.clientY,H=de.pointerId??((ee=de.originalEvent)==null?void 0:ee.pointerId),c.on("pointermove",X),c.on("scroll",X),$("body").addClass("dragging"))}),c.on("pointerup pointercancel",de=>{var ee;const ve=de.pointerId??((ee=de.originalEvent)==null?void 0:ee.pointerId);ve!==H&&ve!==void 0||(c.off("pointermove",X),c.off("scroll",X),$("body").removeClass("dragging"),r.bringTitleBarInBounds(),H=-1)}),r.$titlebar.on("dblclick",de=>{d&&d.dock()}),l.resizable&&[[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1],[1,0],[1,1],[0,1]].forEach(([ge,Se])=>{const Ce=$("<div>").addClass("handle").appendTo(r);let Re="";ge===-1&&(Re+="n"),ge===1&&(Re+="s"),Se===-1&&(Re+="w"),Se===1&&(Re+="e"),Re+="-resize";const qe=(r.outerWidth()-r.width())/2,Ge=(r.outerWidth()-r.innerWidth())/2,Ye=r.outerHeight()-r.$content.outerHeight(),He=r.outerWidth()-r.$content.outerWidth();Ce.css({position:"absolute",top:ge===-1?-Ge:ge===0?`calc(${qe}px - ${Ge}px)`:"",bottom:ge===1?-Ge:"",left:Se===-1?-Ge:Se===0?`calc(${qe}px - ${Ge}px)`:"",right:Se===1?-Ge:"",width:Se===0?`calc(100% - ${qe}px * 2 + ${Ge*2}px)`:`${qe}px`,height:ge===0?`calc(100% - ${qe}px * 2 + ${Ge*2}px)`:`${qe}px`,touchAction:"none",cursor:Re});let Xe,Qe,je,W,re,ue;Ce.on("pointerdown",fe=>{var be;fe.preventDefault(),c.on("pointermove",he),c.on("scroll",$e),$("body").addClass("dragging"),c.on("pointerup pointercancel",we),Xe={x:r.position().left,y:r.position().top,width:r.outerWidth(),height:r.outerHeight()},Qe=fe.clientX+scrollX-Xe.x-(Se===1?Xe.width:0),je=fe.clientY+scrollY-Xe.y-(ge===1?Xe.height:0),W=fe.clientX,re=fe.clientY,ue=fe.pointerId??((be=fe.originalEvent)==null?void 0:be.pointerId);try{Ce[0].setPointerCapture(ue)}catch(Ae){console.warn("Failed to capture pointer for resize handle drag:",Ae)}});function he(fe){var Ae;const be=fe.pointerId??((Ae=fe.originalEvent)==null?void 0:Ae.pointerId);be!==ue&&be!==void 0||(W=fe.clientX,re=fe.clientY,$e())}function we(fe){var Ae;const be=fe.pointerId??((Ae=fe.originalEvent)==null?void 0:Ae.pointerId);be!==ue&&be!==void 0||(c.off("pointermove",he),$("body").removeClass("dragging"),c.off("pointerup pointercancel",we),r.bringTitleBarInBounds())}function $e(){const fe=W+scrollX-Qe,be=re+scrollY-je;let Ae=0,De=0,Ve,Ke;Se===1?(Ae=0,Ve=~~(fe-Xe.x)):Se===-1?(Ae=~~(fe-Xe.x),Ve=~~(Xe.x+Xe.width-fe)):Ve=~~Xe.width,ge===1?(De=0,Ke=~~(be-Xe.y)):ge===-1?(De=~~(be-Xe.y),Ke=~~(Xe.y+Xe.height-be)):Ke=~~Xe.height;let Be={x:Xe.x+Ae,y:Xe.y+De,width:Ve,height:Ke};Be.width=Math.max(1,Be.width),Be.height=Math.max(1,Be.height),l.constrainRect&&(Be=l.constrainRect(Be,Se,ge)),Be.width=Math.max(Be.width,l.minOuterWidth??100),Be.height=Math.max(Be.height,l.minOuterHeight??0),Be.width=Math.max(Be.width,(l.minInnerWidth??0)+He),Be.height=Math.max(Be.height,(l.minInnerHeight??0)+Ye),Se===-1&&(Be.x=Math.min(Be.x,Xe.x+Xe.width-Be.width)),ge===-1&&(Be.y=Math.min(Be.y,Xe.y+Xe.height-Be.height)),r.css({top:Be.y,left:Be.x}),r.outerWidth(Be.width),r.outerHeight(Be.height)}}),r.$Button=(de,ve)=>{var ee=$(n("button")).appendTo(r.$content).text(de).on("click",()=>{ve&&ve(),r.close()});return ee},r.title=de=>typeof de<"u"?(r.$title.text(de),r.trigger("title-change"),r.task&&r.task.updateTitle(),r):r.$title.text(),r.getTitle=()=>r.title();let Q=!1,ce=[];r.animateTitlebar=(de,ve,ee=()=>{})=>{Q=!0;const se=r.$titlebar.clone(!0);se.find("button").remove(),se.appendTo("body");const K=i.OVERRIDE_TRANSITION_DURATION??200,I=`${K}ms`;se.css({transition:`left ${I} linear, top ${I} linear, width ${I} linear, height ${I} linear`,position:"fixed",zIndex:1e7,pointerEvents:"none",left:de.left,top:de.top,width:de.width,height:de.height}),setTimeout(()=>{se.css({left:ve.left,top:ve.top,width:ve.width,height:ve.height})},5);let U=!1;const oe=()=>{var ge;U||(U=!0,Q=!1,se.remove(),ee(),(ge=ce.shift())==null||ge())};se.on("transitionend transitioncancel",oe),setTimeout(oe,K*1.2)},r.close=de=>{if(de&&de!==!0)throw new TypeError("force must be a boolean or undefined, not "+Object.prototype.toString.call(de));if(!de){var ve=$.Event("close");if(r.trigger(ve),ve.isDefaultPrevented())return}d&&d.detach(),r.closed=!0,a[r._minimize_slot_index]=null,p.triggerHandler("closed"),r.trigger("closed"),r.remove();var ee=$($(".window:visible").toArray().sort((se,K)=>K.style.zIndex-se.style.zIndex)[0]);ee.triggerHandler("refocus-window"),J()},r.closed=!1;let pe;return r.setMenuBar=de=>{pe&&pe.element.remove(),de&&(r.$titlebar.after(de.element),de.setKeyboardScope(r[0]),pe=de)},l.title&&r.title(l.title),d||r.center(),r}function o(l){var r=i();return r.title(l),r.$form=$(n("form")).appendTo(r.$content),r.$main=$(n("div")).appendTo(r.$form),r.$buttons=$(n("div")).appendTo(r.$form).addClass("button-group"),r.$Button=(d,h)=>{var v=$(n("button")).appendTo(r.$buttons).text(d);return v.on("click",p=>{p.preventDefault(),h()}),v.on("pointerdown",()=>{v.focus()}),v},r}t.$Window=i,t.$FormWindow=o})(window);function E$1(t,n){const s=document.createElement(t);if(n)for(const e in n)e==="class"?s.className=n[e]:s.setAttribute(e,n[e]);return s}let uid_counter=0;function uid(){return(uid_counter++).toString(36)+Math.random().toString(36).slice(2)}const AccessKeys={escape:function(t){return t.replace(/&/g,"&&")},unescape:function(t){return t.replace(/&&/g,"&")},indexOf:function(t){return` ${t}`.search(/[^&]&[^&\s]/)},has:function(t){return this.indexOf(t)>=0},get:function(t){const n=this.indexOf(t);return n>=0?t.charAt(n+1).toUpperCase():null},remove:function(t){const n=/\s?\(&[^&]\)/;return n.test(t)?this.unescape(t.replace(n,"")):this.toText(t)},toText:function(t){const n=this.indexOf(t);return n>=0?this.unescape(t.substring(0,n))+this.unescape(t.substring(n+1)):this.unescape(t)},toHTML:function(t){const n=this.toFragment(t),s=document.createElement("div");return s.appendChild(n),s.innerHTML},toFragment:function(t){const n=document.createDocumentFragment(),s=this.indexOf(t);if(s>=0){n.appendChild(document.createTextNode(this.unescape(t.substring(0,s))));const e=E$1("span",{class:"menu-hotkey"});e.appendChild(document.createTextNode(t.charAt(s+1))),n.appendChild(e),n.appendChild(document.createTextNode(this.unescape(t.substring(s+2))))}else n.appendChild(document.createTextNode(this.unescape(t)));return n}},MENU_DIVIDER="MENU_DIVIDER",MAX_MENU_NESTING=1e3;let last_focus_outside_menus=null;function track_focus(){document.activeElement&&document.activeElement.tagName!=="BODY"&&document.activeElement.tagName!=="HTML"&&!document.activeElement.closest(".menus, .menu-popup")&&(last_focus_outside_menus=document.activeElement)}typeof window<"u"&&(window.addEventListener("focusin",track_focus),window.addEventListener("focusout",track_focus));let internal_z_counter=1;function get_new_menu_z_index(){return typeof $Window<"u"?$Window.Z_INDEX+++MAX_MENU_NESTING:++internal_z_counter+MAX_MENU_NESTING}function MenuBar(t){if(!(this instanceof MenuBar))return new MenuBar(t);const n=E$1("div",{class:"menus",role:"menubar","aria-label":"Application Menu"});n.style.touchAction="none";function s(){return window.get_direction?window.get_direction():getComputedStyle(n).direction}let e=!1;const c=[];let a=-1,i;const o=new WeakMap,l=new WeakMap,r=()=>{for(const{menu_button_el:g}of c)g.getAttribute("aria-expanded")==="true"&&g.dispatchEvent(new CustomEvent("release",{}))},d=()=>{if(last_focus_outside_menus&&(last_focus_outside_menus.focus(),document.activeElement===last_focus_outside_menus))return;const g=n.closest(".window");g&&g.dispatchEvent(new CustomEvent("refocus-window"))},h=g=>{const _=typeof g=="string"?Object.keys(t).indexOf(g):g;a!==-1&&a!==_&&c[a].menu_button_el.classList.remove("highlight"),_!==-1&&c[_].menu_button_el.classList.add("highlight"),a=_};n.addEventListener("pointerleave",()=>{a!==-1&&c[a].menu_popup_el.style.display==="none"&&h(-1)});const v=g=>typeof g.enabled=="function"?!g.enabled():typeof g.enabled=="boolean"?!g.enabled:!1;function p(g){const _=(g==null?void 0:g.description)||"";if(typeof jQuery<"u"){const u=new jQuery.Event("info",{detail:{description:_}}),b={toString(){return console.warn("jQuery extra parameter for info event is deprecated, use event.detail instead"),_}};jQuery(n).trigger(u,b)}else n.dispatchEvent(new CustomEvent("info",{detail:{description:_}}))}function m(g){if(g.defaultPrevented)return;const _=i==null?void 0:i.element,u=c[a],{menu_button_el:b,open_top_level_menu:S}=u||{},M=_||(u==null?void 0:u.menu_popup_el),R=_?l.get(_):void 0,C=M==null?void 0:M.querySelector(".menu-item.highlight");if(C&&!(C instanceof HTMLElement))throw new Error("Unexpected type for highlighted item element");switch(g.key){case"ArrowLeft":case"ArrowRight":const D=g.key==="ArrowRight";if(C!=null&&C.matches(".has-submenu:not([aria-disabled='true'])")&&s()==="ltr"===D)C.click(),g.preventDefault();else if(i&&i.parentMenuPopup&&s()==="ltr"!==D)i.close(!0),R.setAttribute("aria-expanded","false"),p(i.menuItems[i.itemElements.indexOf(R)]),g.preventDefault();else if(C||!i||!i.parentMenuPopup){const w=M&&M.style.display!=="none",N=s()==="ltr"===D?1:-1;let G;a===-1?G=N===1?0:c.length-1:G=(a+N+c.length)%c.length;const V=c[G],H=V.menu_button_el;w?V.open_top_level_menu("keydown"):(b==null||b.dispatchEvent(new CustomEvent("release",{})),H.focus({preventScroll:!0}),h(G)),g.preventDefault()}break;case"ArrowUp":case"ArrowDown":const B=g.key==="ArrowDown";if(i){const w=B?1:-1,N=[...M.querySelectorAll(".menu-item")],G=N.indexOf(C);let V=(G+w+N.length)%N.length;G===-1&&(B?V=0:V=N.length-1);const H=N[V];i.highlight(H),p(i.menuItems[i.itemElements.indexOf(H)]),g.preventDefault()}else S==null||S("keydown");g.preventDefault();break;case"Escape":if(i)R&&R!==b?(i.close(!0),R.setAttribute("aria-expanded","false"),p(i.menuItems[i.itemElements.indexOf(R)])):(r(),b.focus({preventScroll:!0})),g.preventDefault();else{const w=n.closest(".window");w&&(w.dispatchEvent(new CustomEvent("refocus-window")),g.preventDefault())}break;case"Alt":r(),d(),g.preventDefault();break;case"Space":break;case"Enter":b===document.activeElement?(S("keydown"),g.preventDefault()):(C==null||C.click(),g.preventDefault());break;default:if(g.ctrlKey||g.metaKey)break;const Z=g.key.toLowerCase(),J=i?[...M.querySelectorAll(".menu-item")]:c.map(w=>w.menu_button_el),q={};for(const w of J){const N=w.querySelector(".menu-hotkey"),G=(N?N.textContent:(w.querySelector(".menu-item-label")??w).textContent[0]).toLowerCase();q[G]=q[G]||[],q[G].push(w)}const z=q[Z]||[];if(z.length)if(z.length===1){const w=z[0],N=c.find(G=>G.menu_button_el===w);N?N.open_top_level_menu("keydown"):w.click(),g.preventDefault()}else{let w=z.indexOf(C);w===-1?w=0:w=(w+1)%z.length;const N=z[w];i.highlight(N),g.preventDefault()}break}}n.addEventListener("keydown",m);function A(g,{parentMenuPopup:_}={}){this.parentMenuPopup=_,this.menuItems=g,this.itemElements=[];const u=E$1("div",{class:"menu-popup",id:`menu-popup-${uid()}`,tabIndex:"-1",role:"menu"});u.style.touchAction="pan-y",u.style.outline="none";const b=E$1("table",{class:"menu-popup-table",role:"presentation"});u.appendChild(b),this.element=u;let S=[];u.addEventListener("keydown",m),u.addEventListener("pointerleave",()=>{for(const D of S)if(D.submenu_popup_el.style.display!=="none"){this.highlight(D.item_el);return}this.highlight(-1)}),u.addEventListener("focusin",D=>{u.focus({preventScroll:!0})});let M;this.highlight=D=>{let B;typeof D=="number"?B=this.itemElements[D]:B=D,M&&M!==B&&M.classList.remove("highlight"),B?(B.classList.add("highlight"),u.setAttribute("aria-activedescendant",B.id),M=B):(u.removeAttribute("aria-activedescendant"),M=null)},this.close=(D=!0)=>{var B;for(const Z of S)Z.submenu_popup.close(!1);D&&((B=this.parentMenuPopup)==null||B.element.focus({preventScroll:!0})),u.style.display="none",this.highlight(-1),i===this&&(i=this.parentMenuPopup)};const R=(D,B,Z)=>{var z,w;const J=E$1("tr",{class:"menu-row"});if(this.itemElements.push(J),D.appendChild(J),B===MENU_DIVIDER){const N=E$1("td",{colspan:"4"}),G=E$1("hr",{class:"menu-hr"});N.appendChild(G),J.appendChild(N),G.addEventListener("pointerenter",()=>{this.highlight(-1)})}else{const N=J;N.classList.add("menu-item"),N.id=`menu-item-${uid()}`,N.tabIndex=-1,N.setAttribute("role",B.checkbox?B.checkbox.type==="radio"?"menuitemradio":"menuitemcheckbox":"menuitem"),(B.label||B.item)&&N.setAttribute("aria-label",AccessKeys.toText(B.label||B.item)),N.setAttribute("aria-keyshortcuts",B.ariaKeyShortcuts||""),B.description&&N.setAttribute("aria-description",B.description);const G=E$1("td",{class:"menu-item-checkbox-area"}),V=E$1("td",{class:"menu-item-label"}),H=E$1("td",{class:"menu-item-shortcut"}),X=E$1("td",{class:"menu-item-submenu-area"});N.appendChild(G),N.appendChild(V),N.appendChild(H),N.appendChild(X),B.label?V.appendChild(AccessKeys.toFragment(B.label)):B.item&&(V.appendChild(AccessKeys.toFragment(B.item)),console.warn("Menu item option `item` is deprecated; use `label` instead.")),B.shortcutLabel?H.textContent=B.shortcutLabel:B.shortcut&&(H.textContent=B.shortcut,console.warn("Menu item option `shortcut` is deprecated; use `shortcutLabel` instead (and ideally provide `ariaKeyShortcuts` as well)")),u.addEventListener("update",()=>{if(v(B)?(N.setAttribute("disabled",""),N.setAttribute("aria-disabled","true")):(N.removeAttribute("disabled"),N.removeAttribute("aria-disabled")),B.checkbox&&B.checkbox.check){const xe=B.checkbox.check();N.setAttribute("aria-checked",xe?"true":"false")}}),N.addEventListener("pointerenter",()=>{this.highlight(Z),p(B)}),N.addEventListener("pointerleave",xe=>{u.style.display!=="none"&&xe.pointerType!=="touch"&&p()}),((z=B.checkbox)==null?void 0:z.type)==="radio"?G.classList.add("radio"):B.checkbox&&G.classList.add("checkbox");let Q,ce;if(B.submenu){let Y=function(){for(const{submenu_popup:ae,item_el:de}of S)ae.close(!1),de.setAttribute("aria-expanded","false");u.focus({preventScroll:!0})};var q=Y;N.classList.add("has-submenu"),X.classList.toggle("point-right",s()==="rtl");const xe=new A(B.submenu,{parentMenuPopup:this});ce=xe.element,(w=document.body)==null||w.appendChild(ce),ce.style.display="none",N.setAttribute("aria-haspopup","true"),N.setAttribute("aria-expanded","false"),N.setAttribute("aria-controls",ce.id),o.set(N,xe),l.set(ce,N),ce.dataset.semanticParent=u.id,u.setAttribute("aria-owns",`${u.getAttribute("aria-owns")||""} ${ce.id}`),ce.setAttribute("aria-labelledby",N.id),Q=(ae=!0)=>{if(ce.style.display!=="none"||N.getAttribute("aria-disabled")==="true")return;Y(),N.setAttribute("aria-expanded","true"),ce.style.display="",ce.style.zIndex=`${get_new_menu_z_index()}`,ce.setAttribute("dir",s()),window.inheritTheme&&window.inheritTheme(ce,u),ce.parentElement||document.body.appendChild(ce),ce.dispatchEvent(new CustomEvent("update",{})),ae?(xe.highlight(0),p(xe.menuItems[0])):xe.highlight(-1);const de=N.getBoundingClientRect();let ve=ce.getBoundingClientRect();ce.style.position="absolute",ce.style.left=`${(s()==="rtl"?de.left-ve.width:de.right)+window.scrollX}px`,ce.style.top=`${de.top+window.scrollY}px`,ve=ce.getBoundingClientRect(),s()==="rtl"?ve.left<0&&(ce.style.left=`${de.right}px`,ve=ce.getBoundingClientRect(),ve.right>innerWidth&&(ce.style.left=`${innerWidth-ve.width}px`)):ve.right>innerWidth&&(ce.style.left=`${de.left-ve.width}px`,ve=ce.getBoundingClientRect(),ve.left<0&&(ce.style.left="0")),ce.focus({preventScroll:!0}),i=xe},S.push({item_el:N,submenu_popup_el:ce,submenu_popup:xe});let F,ie;ce.addEventListener("pointerenter",()=>{F&&(clearTimeout(F),F=null),ie&&(clearTimeout(ie),ie=null)}),N.addEventListener("pointerenter",()=>{F&&(clearTimeout(F),F=null),ie&&(clearTimeout(ie),ie=null),F=setTimeout(()=>{Q(!1)},501)}),N.addEventListener("pointerleave",()=>{F&&(clearTimeout(F),F=null)}),u.addEventListener("pointerenter",ae=>{ae.target.closest(".menu-item")!==N&&(ie||ce.style.display!=="none"&&(ie=setTimeout(()=>{window.debugKeepMenusOpen||Y()},500)))}),u.addEventListener("pointerleave",()=>{ie&&(clearTimeout(ie),ie=null)}),N.addEventListener("pointerdown",()=>{Q(!1)})}let pe=!1;const _e=()=>{pe||(pe=!0,setTimeout(()=>{pe=!1},10),B.checkbox?(B.checkbox.toggle&&B.checkbox.toggle(),u.dispatchEvent(new CustomEvent("update",{}))):B.action&&(r(),d(),B.action()))};N.addEventListener("pointerup",xe=>{xe.pointerType==="mouse"&&xe.button!==0||xe.pointerType!=="touch"&&N.click()}),N.addEventListener("click",xe=>{B.submenu?Q(!0):_e()})}};g.length===0&&(g=[{label:"(Empty)",enabled:!1}]);let C=0;for(const D of g)if(typeof D=="object"&&"radioItems"in D){const B=E$1("tbody",{role:"group"});D.ariaLabel&&B.setAttribute("aria-label",D.ariaLabel);for(const Z of D.radioItems)Z.checkbox={type:"radio",check:()=>Z.value===D.getValue(),toggle:()=>{D.setValue(Z.value)}},R(B,Z,C++);b.appendChild(B)}else R(b,D,C++)}const y=(g,_)=>{var D;const u=E$1("div",{class:"menu-button","aria-expanded":"false","aria-haspopup":"true",role:"menuitem"});n.appendChild(u);const b=new A(_),S=b.element;(D=document.body)==null||D.appendChild(S),o.set(u,b),l.set(S,u),u.id=`menu-button-${g}-${uid()}`,S.dataset.semanticParent=u.id,u.setAttribute("aria-controls",S.id),S.setAttribute("aria-labelledby",u.id),n.setAttribute("aria-owns",`${n.getAttribute("aria-owns")||""} ${S.id}`);const M=()=>{const B=u.getBoundingClientRect();let Z=S.getBoundingClientRect();S.style.position="absolute",S.style.left=`${(s()==="rtl"?B.right-Z.width:B.left)+window.scrollX}px`,S.style.top=`${B.bottom+window.scrollY}px`;const J=S.getBoundingClientRect();Math.floor(J.right)>innerWidth&&(S.style.left=`${innerWidth-J.width}px`),Math.ceil(J.left)<0&&(S.style.left="0px")};window.addEventListener("resize",M),S.addEventListener("update",M);const R=g.replace("&","").replace(/ /g,"-").toLowerCase();u.classList.add(`${R}-menu-button`),S.style.display="none",u.innerHTML=`<span>${AccessKeys.toHTML(g)}</span>`,u.tabIndex=-1,u.setAttribute("aria-haspopup","true"),u.setAttribute("aria-controls",S.id),u.addEventListener("focus",()=>{h(g)}),u.addEventListener("pointerdown",B=>{u.classList.contains("active")?(u.dispatchEvent(new CustomEvent("release",{})),d(),B.preventDefault()):C(B.type)}),u.addEventListener("pointermove",B=>{h(g),B.pointerType!=="touch"&&e&&C(B.type)});function C(B="other"){Object.keys(t).indexOf(g)===a&&u.getAttribute("aria-expanded")==="true"||(r(),u.classList.add("active"),u.setAttribute("aria-expanded","true"),S.style.display="",S.style.zIndex=`${get_new_menu_z_index()}`,S.setAttribute("dir",s()),window.inheritTheme&&window.inheritTheme(S,n),S.parentElement||document.body.appendChild(S),h(g),S.dispatchEvent(new CustomEvent("update",{})),e=!0,S.focus({preventScroll:!0}),i=b,B==="keydown"?(b.highlight(0),p(b.menuItems[0])):p())}u.addEventListener("release",()=>{e=!1,u.classList.remove("active"),window.debugKeepMenusOpen||(b.close(!0),u.setAttribute("aria-expanded","false")),n.dispatchEvent(new CustomEvent("default-info",{}))}),c.push({menu_button_el:u,menu_popup_el:S,menus_key:g,access_key:AccessKeys.get(g),open_top_level_menu:C})};for(const g in t)y(g,t[g]);window.addEventListener("keydown",g=>{(!document.activeElement||!document.activeElement.closest||!document.activeElement.closest(".menus, .menu-popup"))&&g.key==="Escape"&&i&&(r(),g.preventDefault())}),window.addEventListener("blur",g=>{g.isTrusted&&r()});function x(g){var _,u,b,S;((u=(_=g.target)==null?void 0:_.closest)==null?void 0:u.call(_,".menus"))===n||(S=(b=g.target)==null?void 0:b.closest)!=null&&S.call(b,".menu-popup")||(r(),h(-1))}window.addEventListener("pointerdown",x),window.addEventListener("pointerup",x),window.addEventListener("focusout",g=>{var _,u,b,S;((u=(_=g.relatedTarget)==null?void 0:_.closest)==null?void 0:u.call(_,".menus"))===n||(S=(b=g.relatedTarget)==null?void 0:b.closest)!=null&&S.call(b,".menu-popup")||(r(),h(c.findIndex(({menu_button_el:M})=>M.matches(":hover"))))});let P=[];function L(...g){for(const _ of P)_.removeEventListener("keydown",T);P=g;for(const _ of P)_.addEventListener("keydown",T)}function T(g){if((g.ctrlKey||g.metaKey)&&g.key!=="Control"&&g.key!=="Meta"){r();return}if(!g.defaultPrevented&&g.altKey&&!g.shiftKey&&!g.ctrlKey&&!g.metaKey){const _=c.find(u=>{var b;return((b=u.access_key)==null?void 0:b.toLowerCase())===g.key.toLowerCase()});_&&(g.preventDefault(),_.open_top_level_menu("keydown"))}}L(window),this.element=n,this.closeMenus=r,this.setKeyboardScope=L}exports.MenuBar=MenuBar;exports.AccessKeys=AccessKeys;exports.MENU_DIVIDER=MENU_DIVIDER;(function(){function t(){var n=this;this.versionnumber="1.2.5",this.imageToSVG=function(s,e,c){c=n.checkoptions(c),n.loadImage(s,function(a){e(n.imagedataToSVG(n.getImgdata(a),c))},c)},this.imagedataToSVG=function(s,e){e=n.checkoptions(e);var c=n.imagedataToTracedata(s,e);return n.getsvgstring(c,e)},this.imageToTracedata=function(s,e,c){c=n.checkoptions(c),n.loadImage(s,function(a){e(n.imagedataToTracedata(n.getImgdata(a),c))},c)},this.imagedataToTracedata=function(s,e){e=n.checkoptions(e);var c=n.colorquantization(s,e);if(e.layering===0)for(var a={layers:[],palette:c.palette,width:c.array[0].length-2,height:c.array.length-2},i=0;i<c.palette.length;i++){var o=n.batchtracepaths(n.internodes(n.pathscan(n.layeringstep(c,i),e.pathomit),e),e.ltres,e.qtres);a.layers.push(o)}else{var l=n.layering(c);e.layercontainerid&&n.drawLayers(l,n.specpalette,e.scale,e.layercontainerid);var r=n.batchpathscan(l,e.pathomit),d=n.batchinternodes(r,e),a={layers:n.batchtracelayers(d,e.ltres,e.qtres),palette:c.palette,width:s.width,height:s.height}}return a},this.optionpresets={default:{corsenabled:!1,ltres:1,qtres:1,pathomit:8,rightangleenhance:!0,colorsampling:2,numberofcolors:16,mincolorratio:0,colorquantcycles:3,layering:0,strokewidth:1,linefilter:!1,scale:1,roundcoords:1,viewbox:!1,desc:!1,lcpr:0,qcpr:0,blurradius:0,blurdelta:20},posterized1:{colorsampling:0,numberofcolors:2},posterized2:{numberofcolors:4,blurradius:5},curvy:{ltres:.01,linefilter:!0,rightangleenhance:!1},sharp:{qtres:.01,linefilter:!1},detailed:{pathomit:0,roundcoords:2,ltres:.5,qtres:.5,numberofcolors:64},smoothed:{blurradius:5,blurdelta:64},grayscale:{colorsampling:0,colorquantcycles:1,numberofcolors:7},fixedpalette:{colorsampling:0,colorquantcycles:1,numberofcolors:27},randomsampling1:{colorsampling:1,numberofcolors:8},randomsampling2:{colorsampling:1,numberofcolors:64},artistic1:{colorsampling:0,colorquantcycles:1,pathomit:0,blurradius:5,blurdelta:64,ltres:.01,linefilter:!0,numberofcolors:16,strokewidth:2},artistic2:{qtres:.01,colorsampling:0,colorquantcycles:1,numberofcolors:4,strokewidth:0},artistic3:{qtres:10,ltres:10,numberofcolors:8},artistic4:{qtres:10,ltres:10,numberofcolors:64,blurradius:5,blurdelta:256,strokewidth:2},posterized3:{ltres:1,qtres:1,pathomit:20,rightangleenhance:!0,colorsampling:0,numberofcolors:3,mincolorratio:0,colorquantcycles:3,blurradius:3,blurdelta:20,strokewidth:0,linefilter:!1,roundcoords:1,pal:[{r:0,g:0,b:100,a:255},{r:255,g:255,b:255,a:255}]}},this.checkoptions=function(s){s=s||{},typeof s=="string"&&(s=s.toLowerCase(),n.optionpresets[s]?s=n.optionpresets[s]:s={});for(var e=Object.keys(n.optionpresets.default),c=0;c<e.length;c++)s.hasOwnProperty(e[c])||(s[e[c]]=n.optionpresets.default[e[c]]);return s},this.colorquantization=function(s,e){var c=[],a=0,i,o,l,r=[],d=s.width*s.height,h,v,p,m,A;if(s.data.length<d*4){for(var y=new Uint8ClampedArray(d*4),x=0;x<d;x++)y[x*4]=s.data[x*3],y[x*4+1]=s.data[x*3+1],y[x*4+2]=s.data[x*3+2],y[x*4+3]=255;s.data=y}for(v=0;v<s.height+2;v++)for(c[v]=[],h=0;h<s.width+2;h++)c[v][h]=-1;for(e.pal?A=e.pal:e.colorsampling===0?A=n.generatepalette(e.numberofcolors):e.colorsampling===1?A=n.samplepalette(e.numberofcolors,s):A=n.samplepalette2(e.numberofcolors,s),e.blurradius>0&&(s=n.blur(s,e.blurradius,e.blurdelta)),m=0;m<e.colorquantcycles;m++){if(m>0)for(p=0;p<A.length;p++)r[p].n>0&&(A[p]={r:Math.floor(r[p].r/r[p].n),g:Math.floor(r[p].g/r[p].n),b:Math.floor(r[p].b/r[p].n),a:Math.floor(r[p].a/r[p].n)}),r[p].n/d<e.mincolorratio&&m<e.colorquantcycles-1&&(A[p]={r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255),a:Math.floor(Math.random()*255)});for(h=0;h<A.length;h++)r[h]={r:0,g:0,b:0,a:0,n:0};for(v=0;v<s.height;v++)for(h=0;h<s.width;h++){for(a=(v*s.width+h)*4,l=0,o=1024,p=0;p<A.length;p++)i=Math.abs(A[p].r-s.data[a])+Math.abs(A[p].g-s.data[a+1])+Math.abs(A[p].b-s.data[a+2])+Math.abs(A[p].a-s.data[a+3]),i<o&&(o=i,l=p);r[l].r+=s.data[a],r[l].g+=s.data[a+1],r[l].b+=s.data[a+2],r[l].a+=s.data[a+3],r[l].n++,c[v+1][h+1]=l}}return{array:c,palette:A}},this.samplepalette=function(s,e){for(var c,a=[],i=0;i<s;i++)c=Math.floor(Math.random()*e.data.length/4)*4,a.push({r:e.data[c],g:e.data[c+1],b:e.data[c+2],a:e.data[c+3]});return a},this.samplepalette2=function(s,e){for(var c,a=[],i=Math.ceil(Math.sqrt(s)),o=Math.ceil(s/i),l=e.width/(i+1),r=e.height/(o+1),d=0;d<o;d++)for(var h=0;h<i&&a.length!==s;h++)c=Math.floor((d+1)*r*e.width+(h+1)*l)*4,a.push({r:e.data[c],g:e.data[c+1],b:e.data[c+2],a:e.data[c+3]});return a},this.generatepalette=function(s){var e=[],c,a,i;if(s<8)for(var o=Math.floor(255/(s-1)),l=0;l<s;l++)e.push({r:l*o,g:l*o,b:l*o,a:255});else{var r=Math.floor(Math.pow(s,.3333333333333333)),d=Math.floor(255/(r-1)),h=s-r*r*r;for(c=0;c<r;c++)for(a=0;a<r;a++)for(i=0;i<r;i++)e.push({r:c*d,g:a*d,b:i*d,a:255});for(c=0;c<h;c++)e.push({r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255),a:Math.floor(Math.random()*255)})}return e},this.layering=function(s){var e=[],c=0,a=s.array.length,i=s.array[0].length,o,l,r,d,h,v,p,m,A,y,x;for(x=0;x<s.palette.length;x++)for(e[x]=[],y=0;y<a;y++)for(e[x][y]=[],A=0;A<i;A++)e[x][y][A]=0;for(y=1;y<a-1;y++)for(A=1;A<i-1;A++)c=s.array[y][A],o=s.array[y-1][A-1]===c?1:0,l=s.array[y-1][A]===c?1:0,r=s.array[y-1][A+1]===c?1:0,d=s.array[y][A-1]===c?1:0,h=s.array[y][A+1]===c?1:0,v=s.array[y+1][A-1]===c?1:0,p=s.array[y+1][A]===c?1:0,m=s.array[y+1][A+1]===c?1:0,e[c][y+1][A+1]=1+h*2+m*4+p*8,d||(e[c][y+1][A]=2+p*4+v*8),l||(e[c][y][A+1]=0+r*2+h*4+8),o||(e[c][y][A]=0+l*2+4+d*8);return e},this.layeringstep=function(s,e){var c=[],a=s.array.length,i=s.array[0].length,o,l;for(l=0;l<a;l++)for(c[l]=[],o=0;o<i;o++)c[l][o]=0;for(l=1;l<a;l++)for(o=1;o<i;o++)c[l][o]=(s.array[l-1][o-1]===e?1:0)+(s.array[l-1][o]===e?2:0)+(s.array[l][o-1]===e?8:0)+(s.array[l][o]===e?4:0);return c},this.pathscan_combined_lookup=[[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[13,3,0,1],[13,2,-1,0],[7,1,0,-1],[7,0,1,0]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[11,1,0,-1],[14,0,1,0],[14,3,0,1],[11,2,-1,0]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]],this.pathscan=function(s,e){for(var c=[],a=0,i=0,o=0,l=0,r=s[0].length,d=s.length,h=0,v=!0,p=!1,m,A=0;A<d;A++)for(var y=0;y<r;y++)if(s[A][y]==4||s[A][y]==11)for(o=y,l=A,c[a]={},c[a].points=[],c[a].boundingbox=[o,l,o,l],c[a].holechildren=[],v=!1,i=0,p=s[A][y]==11,h=1;!v;){if(c[a].points[i]={},c[a].points[i].x=o-1,c[a].points[i].y=l-1,c[a].points[i].t=s[l][o],o-1<c[a].boundingbox[0]&&(c[a].boundingbox[0]=o-1),o-1>c[a].boundingbox[2]&&(c[a].boundingbox[2]=o-1),l-1<c[a].boundingbox[1]&&(c[a].boundingbox[1]=l-1),l-1>c[a].boundingbox[3]&&(c[a].boundingbox[3]=l-1),m=n.pathscan_combined_lookup[s[l][o]][h],s[l][o]=m[0],h=m[1],o+=m[2],l+=m[3],o-1===c[a].points[0].x&&l-1===c[a].points[0].y)if(v=!0,c[a].points.length<e)c.pop();else{if(c[a].isholepath=!!p,p){for(var x=0,P=[-1,-1,r+1,d+1],L=0;L<a;L++)!c[L].isholepath&&n.boundingboxincludes(c[L].boundingbox,c[a].boundingbox)&&n.boundingboxincludes(P,c[L].boundingbox)&&(x=L,P=c[L].boundingbox);c[x].holechildren.push(a)}a++}i++}return c},this.boundingboxincludes=function(s,e){return s[0]<e[0]&&s[1]<e[1]&&s[2]>e[2]&&s[3]>e[3]},this.batchpathscan=function(s,e){var c=[];for(var a in s)s.hasOwnProperty(a)&&(c[a]=n.pathscan(s[a],e));return c},this.internodes=function(s,e){var c=[],a=0,i=0,o=0,l=0,r=0,d,h;for(d=0;d<s.length;d++)for(c[d]={},c[d].points=[],c[d].boundingbox=s[d].boundingbox,c[d].holechildren=s[d].holechildren,c[d].isholepath=s[d].isholepath,a=s[d].points.length,h=0;h<a;h++)i=(h+1)%a,o=(h+2)%a,l=(h-1+a)%a,r=(h-2+a)%a,e.rightangleenhance&&n.testrightangle(s[d],r,l,h,i,o)&&(c[d].points.length>0&&(c[d].points[c[d].points.length-1].linesegment=n.getdirection(c[d].points[c[d].points.length-1].x,c[d].points[c[d].points.length-1].y,s[d].points[h].x,s[d].points[h].y)),c[d].points.push({x:s[d].points[h].x,y:s[d].points[h].y,linesegment:n.getdirection(s[d].points[h].x,s[d].points[h].y,(s[d].points[h].x+s[d].points[i].x)/2,(s[d].points[h].y+s[d].points[i].y)/2)})),c[d].points.push({x:(s[d].points[h].x+s[d].points[i].x)/2,y:(s[d].points[h].y+s[d].points[i].y)/2,linesegment:n.getdirection((s[d].points[h].x+s[d].points[i].x)/2,(s[d].points[h].y+s[d].points[i].y)/2,(s[d].points[i].x+s[d].points[o].x)/2,(s[d].points[i].y+s[d].points[o].y)/2)});return c},this.testrightangle=function(s,e,c,a,i,o){return s.points[a].x===s.points[e].x&&s.points[a].x===s.points[c].x&&s.points[a].y===s.points[i].y&&s.points[a].y===s.points[o].y||s.points[a].y===s.points[e].y&&s.points[a].y===s.points[c].y&&s.points[a].x===s.points[i].x&&s.points[a].x===s.points[o].x},this.getdirection=function(s,e,c,a){var i=8;return s<c?e<a?i=1:e>a?i=7:i=0:s>c?e<a?i=3:e>a?i=5:i=4:e<a?i=2:e>a?i=6:i=8,i},this.batchinternodes=function(s,e){var c=[];for(var a in s)s.hasOwnProperty(a)&&(c[a]=n.internodes(s[a],e));return c},this.tracepath=function(s,e,c){var a=0,i,o,l,r={};for(r.segments=[],r.boundingbox=s.boundingbox,r.holechildren=s.holechildren,r.isholepath=s.isholepath;a<s.points.length;){for(i=s.points[a].linesegment,o=-1,l=a+1;(s.points[l].linesegment===i||s.points[l].linesegment===o||o===-1)&&l<s.points.length-1;)s.points[l].linesegment!==i&&o===-1&&(o=s.points[l].linesegment),l++;l===s.points.length-1&&(l=0),r.segments=r.segments.concat(n.fitseq(s,e,c,a,l)),l>0?a=l:a=s.points.length}return r},this.fitseq=function(s,e,c,a,i){if(i>s.points.length||i<0)return[];var o=a,l=0,r=!0,d,h,v,p=i-a;p<0&&(p+=s.points.length);for(var m=(s.points[i].x-s.points[a].x)/p,A=(s.points[i].y-s.points[a].y)/p,y=(a+1)%s.points.length,x;y!=i;)x=y-a,x<0&&(x+=s.points.length),d=s.points[a].x+m*x,h=s.points[a].y+A*x,v=(s.points[y].x-d)*(s.points[y].x-d)+(s.points[y].y-h)*(s.points[y].y-h),v>e&&(r=!1),v>l&&(o=y,l=v),y=(y+1)%s.points.length;if(r)return[{type:"L",x1:s.points[a].x,y1:s.points[a].y,x2:s.points[i].x,y2:s.points[i].y}];var P=o;r=!0,l=0;var L=(P-a)/p,T=(1-L)*(1-L),g=2*(1-L)*L,_=L*L,u=(T*s.points[a].x+_*s.points[i].x-s.points[P].x)/-g,b=(T*s.points[a].y+_*s.points[i].y-s.points[P].y)/-g;for(y=a+1;y!=i;)L=(y-a)/p,T=(1-L)*(1-L),g=2*(1-L)*L,_=L*L,d=T*s.points[a].x+g*u+_*s.points[i].x,h=T*s.points[a].y+g*b+_*s.points[i].y,v=(s.points[y].x-d)*(s.points[y].x-d)+(s.points[y].y-h)*(s.points[y].y-h),v>c&&(r=!1),v>l&&(o=y,l=v),y=(y+1)%s.points.length;if(r)return[{type:"Q",x1:s.points[a].x,y1:s.points[a].y,x2:u,y2:b,x3:s.points[i].x,y3:s.points[i].y}];var S=P;return n.fitseq(s,e,c,a,S).concat(n.fitseq(s,e,c,S,i))},this.batchtracepaths=function(s,e,c){var a=[];for(var i in s)s.hasOwnProperty(i)&&a.push(n.tracepath(s[i],e,c));return a},this.batchtracelayers=function(s,e,c){var a=[];for(var i in s)s.hasOwnProperty(i)&&(a[i]=n.batchtracepaths(s[i],e,c));return a},this.roundtodec=function(s,e){return+s.toFixed(e)},this.svgpathstring=function(s,e,c,a){var i=s.layers[e],o=i[c],l="",r;if(a.linefilter&&o.segments.length<3)return l;if(l="<path "+(a.desc?'desc="l '+e+" p "+c+'" ':"")+n.tosvgcolorstr(s.palette[e],a)+'d="',a.roundcoords===-1){for(l+="M "+o.segments[0].x1*a.scale+" "+o.segments[0].y1*a.scale+" ",r=0;r<o.segments.length;r++)l+=o.segments[r].type+" "+o.segments[r].x2*a.scale+" "+o.segments[r].y2*a.scale+" ",o.segments[r].hasOwnProperty("x3")&&(l+=o.segments[r].x3*a.scale+" "+o.segments[r].y3*a.scale+" ");l+="Z "}else{for(l+="M "+n.roundtodec(o.segments[0].x1*a.scale,a.roundcoords)+" "+n.roundtodec(o.segments[0].y1*a.scale,a.roundcoords)+" ",r=0;r<o.segments.length;r++)l+=o.segments[r].type+" "+n.roundtodec(o.segments[r].x2*a.scale,a.roundcoords)+" "+n.roundtodec(o.segments[r].y2*a.scale,a.roundcoords)+" ",o.segments[r].hasOwnProperty("x3")&&(l+=n.roundtodec(o.segments[r].x3*a.scale,a.roundcoords)+" "+n.roundtodec(o.segments[r].y3*a.scale,a.roundcoords)+" ");l+="Z "}for(var d=0;d<o.holechildren.length;d++){var h=i[o.holechildren[d]];if(a.roundcoords===-1)for(h.segments[h.segments.length-1].hasOwnProperty("x3")?l+="M "+h.segments[h.segments.length-1].x3*a.scale+" "+h.segments[h.segments.length-1].y3*a.scale+" ":l+="M "+h.segments[h.segments.length-1].x2*a.scale+" "+h.segments[h.segments.length-1].y2*a.scale+" ",r=h.segments.length-1;r>=0;r--)l+=h.segments[r].type+" ",h.segments[r].hasOwnProperty("x3")&&(l+=h.segments[r].x2*a.scale+" "+h.segments[r].y2*a.scale+" "),l+=h.segments[r].x1*a.scale+" "+h.segments[r].y1*a.scale+" ";else for(h.segments[h.segments.length-1].hasOwnProperty("x3")?l+="M "+n.roundtodec(h.segments[h.segments.length-1].x3*a.scale)+" "+n.roundtodec(h.segments[h.segments.length-1].y3*a.scale)+" ":l+="M "+n.roundtodec(h.segments[h.segments.length-1].x2*a.scale)+" "+n.roundtodec(h.segments[h.segments.length-1].y2*a.scale)+" ",r=h.segments.length-1;r>=0;r--)l+=h.segments[r].type+" ",h.segments[r].hasOwnProperty("x3")&&(l+=n.roundtodec(h.segments[r].x2*a.scale)+" "+n.roundtodec(h.segments[r].y2*a.scale)+" "),l+=n.roundtodec(h.segments[r].x1*a.scale)+" "+n.roundtodec(h.segments[r].y1*a.scale)+" ";l+="Z "}if(l+='" />',a.lcpr||a.qcpr){for(r=0;r<o.segments.length;r++)o.segments[r].hasOwnProperty("x3")&&a.qcpr&&(l+='<circle cx="'+o.segments[r].x2*a.scale+'" cy="'+o.segments[r].y2*a.scale+'" r="'+a.qcpr+'" fill="cyan" stroke-width="'+a.qcpr*.2+'" stroke="black" />',l+='<circle cx="'+o.segments[r].x3*a.scale+'" cy="'+o.segments[r].y3*a.scale+'" r="'+a.qcpr+'" fill="white" stroke-width="'+a.qcpr*.2+'" stroke="black" />',l+='<line x1="'+o.segments[r].x1*a.scale+'" y1="'+o.segments[r].y1*a.scale+'" x2="'+o.segments[r].x2*a.scale+'" y2="'+o.segments[r].y2*a.scale+'" stroke-width="'+a.qcpr*.2+'" stroke="cyan" />',l+='<line x1="'+o.segments[r].x2*a.scale+'" y1="'+o.segments[r].y2*a.scale+'" x2="'+o.segments[r].x3*a.scale+'" y2="'+o.segments[r].y3*a.scale+'" stroke-width="'+a.qcpr*.2+'" stroke="cyan" />'),!o.segments[r].hasOwnProperty("x3")&&a.lcpr&&(l+='<circle cx="'+o.segments[r].x2*a.scale+'" cy="'+o.segments[r].y2*a.scale+'" r="'+a.lcpr+'" fill="white" stroke-width="'+a.lcpr*.2+'" stroke="black" />');for(var d=0;d<o.holechildren.length;d++){var h=i[o.holechildren[d]];for(r=0;r<h.segments.length;r++)h.segments[r].hasOwnProperty("x3")&&a.qcpr&&(l+='<circle cx="'+h.segments[r].x2*a.scale+'" cy="'+h.segments[r].y2*a.scale+'" r="'+a.qcpr+'" fill="cyan" stroke-width="'+a.qcpr*.2+'" stroke="black" />',l+='<circle cx="'+h.segments[r].x3*a.scale+'" cy="'+h.segments[r].y3*a.scale+'" r="'+a.qcpr+'" fill="white" stroke-width="'+a.qcpr*.2+'" stroke="black" />',l+='<line x1="'+h.segments[r].x1*a.scale+'" y1="'+h.segments[r].y1*a.scale+'" x2="'+h.segments[r].x2*a.scale+'" y2="'+h.segments[r].y2*a.scale+'" stroke-width="'+a.qcpr*.2+'" stroke="cyan" />',l+='<line x1="'+h.segments[r].x2*a.scale+'" y1="'+h.segments[r].y2*a.scale+'" x2="'+h.segments[r].x3*a.scale+'" y2="'+h.segments[r].y3*a.scale+'" stroke-width="'+a.qcpr*.2+'" stroke="cyan" />'),!h.segments[r].hasOwnProperty("x3")&&a.lcpr&&(l+='<circle cx="'+h.segments[r].x2*a.scale+'" cy="'+h.segments[r].y2*a.scale+'" r="'+a.lcpr+'" fill="white" stroke-width="'+a.lcpr*.2+'" stroke="black" />')}}return l},this.getsvgstring=function(s,e){e=n.checkoptions(e);for(var c=s.width*e.scale,a=s.height*e.scale,i="<svg "+(e.viewbox?'viewBox="0 0 '+c+" "+a+'" ':'width="'+c+'" height="'+a+'" ')+'version="1.1" xmlns="http://www.w3.org/2000/svg" desc="Created with imagetracer.js version '+n.versionnumber+'" >',o=0;o<s.layers.length;o++)for(var l=0;l<s.layers[o].length;l++)s.layers[o][l].isholepath||(i+=n.svgpathstring(s,o,l,e));return i+="</svg>",i},this.compareNumbers=function(s,e){return s-e},this.torgbastr=function(s){return"rgba("+s.r+","+s.g+","+s.b+","+s.a+")"},this.tosvgcolorstr=function(s,e){return'fill="rgb('+s.r+","+s.g+","+s.b+')" stroke="rgb('+s.r+","+s.g+","+s.b+')" stroke-width="'+e.strokewidth+'" opacity="'+s.a/255+'" '},this.appendSVGString=function(s,e){var c;e?(c=document.getElementById(e),c||(c=document.createElement("div"),c.id=e,document.body.appendChild(c))):(c=document.createElement("div"),document.body.appendChild(c)),c.innerHTML+=s},this.gks=[[.27901,.44198,.27901],[.135336,.228569,.272192,.228569,.135336],[.086776,.136394,.178908,.195843,.178908,.136394,.086776],[.063327,.093095,.122589,.144599,.152781,.144599,.122589,.093095,.063327],[.049692,.069304,.089767,.107988,.120651,.125194,.120651,.107988,.089767,.069304,.049692]],this.blur=function(s,e,c){var a,i,o,l,r,d,h,v,p,m,A={width:s.width,height:s.height,data:[]};if(e=Math.floor(e),e<1)return s;e>5&&(e=5),c=Math.abs(c),c>1024&&(c=1024);var y=n.gks[e-1];for(i=0;i<s.height;i++)for(a=0;a<s.width;a++){for(d=0,h=0,v=0,p=0,m=0,o=-e;o<e+1;o++)a+o>0&&a+o<s.width&&(r=(i*s.width+a+o)*4,d+=s.data[r]*y[o+e],h+=s.data[r+1]*y[o+e],v+=s.data[r+2]*y[o+e],p+=s.data[r+3]*y[o+e],m+=y[o+e]);r=(i*s.width+a)*4,A.data[r]=Math.floor(d/m),A.data[r+1]=Math.floor(h/m),A.data[r+2]=Math.floor(v/m),A.data[r+3]=Math.floor(p/m)}var x=new Uint8ClampedArray(A.data);for(i=0;i<s.height;i++)for(a=0;a<s.width;a++){for(d=0,h=0,v=0,p=0,m=0,o=-e;o<e+1;o++)i+o>0&&i+o<s.height&&(r=((i+o)*s.width+a)*4,d+=x[r]*y[o+e],h+=x[r+1]*y[o+e],v+=x[r+2]*y[o+e],p+=x[r+3]*y[o+e],m+=y[o+e]);r=(i*s.width+a)*4,A.data[r]=Math.floor(d/m),A.data[r+1]=Math.floor(h/m),A.data[r+2]=Math.floor(v/m),A.data[r+3]=Math.floor(p/m)}for(i=0;i<s.height;i++)for(a=0;a<s.width;a++)r=(i*s.width+a)*4,l=Math.abs(A.data[r]-s.data[r])+Math.abs(A.data[r+1]-s.data[r+1])+Math.abs(A.data[r+2]-s.data[r+2])+Math.abs(A.data[r+3]-s.data[r+3]),l>c&&(A.data[r]=s.data[r],A.data[r+1]=s.data[r+1],A.data[r+2]=s.data[r+2],A.data[r+3]=s.data[r+3]);return A},this.loadImage=function(s,e,c){var a=new Image;c&&c.corsenabled&&(a.crossOrigin="Anonymous"),a.onload=function(){var i=document.createElement("canvas");i.width=a.width,i.height=a.height;var o=i.getContext("2d");o.drawImage(a,0,0),e(i)},a.src=s},this.getImgdata=function(s){var e=s.getContext("2d");return e.getImageData(0,0,s.width,s.height)},this.specpalette=[{r:0,g:0,b:0,a:255},{r:128,g:128,b:128,a:255},{r:0,g:0,b:128,a:255},{r:64,g:64,b:128,a:255},{r:192,g:192,b:192,a:255},{r:255,g:255,b:255,a:255},{r:128,g:128,b:192,a:255},{r:0,g:0,b:192,a:255},{r:128,g:0,b:0,a:255},{r:128,g:64,b:64,a:255},{r:128,g:0,b:128,a:255},{r:168,g:168,b:168,a:255},{r:192,g:128,b:128,a:255},{r:192,g:0,b:0,a:255},{r:255,g:255,b:255,a:255},{r:0,g:128,b:0,a:255}],this.drawLayers=function(s,e,c,a){c=c||1;var i,o,l,r,d,h;a?(h=document.getElementById(a),h||(h=document.createElement("div"),h.id=a,document.body.appendChild(h))):(h=document.createElement("div"),document.body.appendChild(h));for(d in s)if(s.hasOwnProperty(d)){i=s[d][0].length,o=s[d].length;var v=document.createElement("canvas");v.width=i*c,v.height=o*c;var p=v.getContext("2d");for(r=0;r<o;r++)for(l=0;l<i;l++)p.fillStyle=n.torgbastr(e[s[d][r][l]%e.length]),p.fillRect(l*c,r*c,c,c);h.appendChild(v)}}}typeof define=="function"&&define.amd?define(function(){return new t}):typeof module<"u"?module.exports=new t:typeof self<"u"?self.ImageTracer=new t:window.ImageTracer=new t})();/*! jQuery UI - v1.14.1 - 2024-11-08
* https://jqueryui.com
* Includes: widget.js, keycode.js, widgets/mouse.js, widgets/slider.js
* Copyright OpenJS Foundation and other contributors; Licensed MIT */(t=>{typeof define=="function"&&define.amd?define(["jquery"],t):t($)})(function(t){t.ui=t.ui||{},t.ui.version="1.14.1";var n,s=0,e=Array.prototype.hasOwnProperty,c=Array.prototype.slice,a=(t.cleanData=(n=t.cleanData,function(i){for(var o,l,r=0;(l=i[r])!=null;r++)(o=t._data(l,"events"))&&o.remove&&t(l).triggerHandler("remove");n(i)}),t.widget=function(i,o,l){var r,d,h,v,p={},m=i.split(".")[0];return(i=i.split(".")[1])==="__proto__"||i==="constructor"?t.error("Invalid widget name: "+i):(v=m+"-"+i,l||(l=o,o=t.Widget),Array.isArray(l)&&(l=t.extend.apply(null,[{}].concat(l))),t.expr.pseudos[v.toLowerCase()]=function(A){return!!t.data(A,v)},t[m]=t[m]||{},r=t[m][i],d=t[m][i]=function(A,y){if(!this||!this._createWidget)return new d(A,y);arguments.length&&this._createWidget(A,y)},t.extend(d,r,{version:l.version,_proto:t.extend({},l),_childConstructors:[]}),(h=new o).options=t.widget.extend({},h.options),t.each(l,function(A,y){function x(){return o.prototype[A].apply(this,arguments)}function P(L){return o.prototype[A].apply(this,L)}p[A]=typeof y!="function"?y:function(){var L,T=this._super,g=this._superApply;return this._super=x,this._superApply=P,L=y.apply(this,arguments),this._super=T,this._superApply=g,L}}),d.prototype=t.widget.extend(h,{widgetEventPrefix:r&&h.widgetEventPrefix||i},p,{constructor:d,namespace:m,widgetName:i,widgetFullName:v}),r?(t.each(r._childConstructors,function(A,y){var x=y.prototype;t.widget(x.namespace+"."+x.widgetName,d,y._proto)}),delete r._childConstructors):o._childConstructors.push(d),t.widget.bridge(i,d),d)},t.widget.extend=function(i){for(var o,l,r=c.call(arguments,1),d=0,h=r.length;d<h;d++)for(o in r[d])l=r[d][o],e.call(r[d],o)&&l!==void 0&&(t.isPlainObject(l)?i[o]=t.isPlainObject(i[o])?t.widget.extend({},i[o],l):t.widget.extend({},l):i[o]=l);return i},t.widget.bridge=function(i,o){var l=o.prototype.widgetFullName||i;t.fn[i]=function(r){var d=typeof r=="string",h=c.call(arguments,1),v=this;return d?this.length||r!=="instance"?this.each(function(){var p,m=t.data(this,l);return r==="instance"?(v=m,!1):m?typeof m[r]!="function"||r.charAt(0)==="_"?t.error("no such method '"+r+"' for "+i+" widget instance"):(p=m[r].apply(m,h))!==m&&p!==void 0?(v=p&&p.jquery?v.pushStack(p.get()):p,!1):void 0:t.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+r+"'")}):v=void 0:(h.length&&(r=t.widget.extend.apply(null,[r].concat(h))),this.each(function(){var p=t.data(this,l);p?(p.option(r||{}),p._init&&p._init()):t.data(this,l,new o(r,this))})),v}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(i,o){o=t(o||this.defaultElement||this)[0],this.element=t(o),this.uuid=s++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},o!==this&&(t.data(o,this.widgetFullName,this),this._on(!0,this.element,{remove:function(l){l.target===o&&this.destroy()}}),this.document=t(o.style?o.ownerDocument:o.document||o),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),i),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var i=this;this._destroy(),t.each(this.classesElementLookup,function(o,l){i._removeClass(l,o)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(i,o){var l,r,d,h=i;if(arguments.length===0)return t.widget.extend({},this.options);if(typeof i=="string")if(h={},i=(l=i.split(".")).shift(),l.length){for(r=h[i]=t.widget.extend({},this.options[i]),d=0;d<l.length-1;d++)r[l[d]]=r[l[d]]||{},r=r[l[d]];if(i=l.pop(),arguments.length===1)return r[i]===void 0?null:r[i];r[i]=o}else{if(arguments.length===1)return this.options[i]===void 0?null:this.options[i];h[i]=o}return this._setOptions(h),this},_setOptions:function(i){for(var o in i)this._setOption(o,i[o]);return this},_setOption:function(i,o){return i==="classes"&&this._setOptionClasses(o),this.options[i]=o,i==="disabled"&&this._setOptionDisabled(o),this},_setOptionClasses:function(i){var o,l,r;for(o in i)r=this.classesElementLookup[o],i[o]!==this.options.classes[o]&&r&&r.length&&(l=t(r.get()),this._removeClass(r,o),l.addClass(this._classes({element:l,keys:o,classes:i,add:!0})))},_setOptionDisabled:function(i){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!i),i&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(i){var o=[],l=this;function r(d,h){for(var v,p=0;p<d.length;p++)v=l.classesElementLookup[d[p]]||t(),v=i.add?((()=>{var m=[];i.element.each(function(A,y){t.map(l.classesElementLookup,function(x){return x}).some(function(x){return x.is(y)})||m.push(y)}),l._on(t(m),{remove:"_untrackClassesElement"})})(),t(t.uniqueSort(v.get().concat(i.element.get())))):t(v.not(i.element).get()),l.classesElementLookup[d[p]]=v,o.push(d[p]),h&&i.classes[d[p]]&&o.push(i.classes[d[p]])}return(i=t.extend({element:this.element,classes:this.options.classes||{}},i)).keys&&r(i.keys.match(/\S+/g)||[],!0),i.extra&&r(i.extra.match(/\S+/g)||[]),o.join(" ")},_untrackClassesElement:function(i){var o=this;t.each(o.classesElementLookup,function(l,r){t.inArray(i.target,r)!==-1&&(o.classesElementLookup[l]=t(r.not(i.target).get()))}),this._off(t(i.target))},_removeClass:function(i,o,l){return this._toggleClass(i,o,l,!1)},_addClass:function(i,o,l){return this._toggleClass(i,o,l,!0)},_toggleClass:function(i,h,l,r){var d=typeof i=="string"||i===null,h={extra:d?h:l,keys:d?i:h,element:d?this.element:i,add:r=typeof r=="boolean"?r:l};return h.element.toggleClass(this._classes(h),r),this},_on:function(i,o,l){var r,d=this;typeof i!="boolean"&&(l=o,o=i,i=!1),l?(o=r=t(o),this.bindings=this.bindings.add(o)):(l=o,o=this.element,r=this.widget()),t.each(l,function(A,v){function p(){if(i||d.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled"))return(typeof v=="string"?d[v]:v).apply(d,arguments)}typeof v!="string"&&(p.guid=v.guid=v.guid||p.guid||t.guid++);var A=A.match(/^([\w:-]*)\s*(.*)$/),m=A[1]+d.eventNamespace,A=A[2];A?r.on(m,A,p):o.on(m,p)})},_off:function(i,o){o=(o||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,i.off(o),this.bindings=t(this.bindings.not(i).get()),this.focusable=t(this.focusable.not(i).get()),this.hoverable=t(this.hoverable.not(i).get())},_delay:function(i,o){var l=this;return setTimeout(function(){return(typeof i=="string"?l[i]:i).apply(l,arguments)},o||0)},_hoverable:function(i){this.hoverable=this.hoverable.add(i),this._on(i,{mouseenter:function(o){this._addClass(t(o.currentTarget),null,"ui-state-hover")},mouseleave:function(o){this._removeClass(t(o.currentTarget),null,"ui-state-hover")}})},_focusable:function(i){this.focusable=this.focusable.add(i),this._on(i,{focusin:function(o){this._addClass(t(o.currentTarget),null,"ui-state-focus")},focusout:function(o){this._removeClass(t(o.currentTarget),null,"ui-state-focus")}})},_trigger:function(i,o,l){var r,d,h=this.options[i];if(l=l||{},(o=t.Event(o)).type=(i===this.widgetEventPrefix?i:this.widgetEventPrefix+i).toLowerCase(),o.target=this.element[0],d=o.originalEvent)for(r in d)r in o||(o[r]=d[r]);return this.element.trigger(o,l),!(typeof h=="function"&&h.apply(this.element[0],[o].concat(l))===!1||o.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(i,o){t.Widget.prototype["_"+i]=function(l,r,d){var h,v=(r=typeof r=="string"?{effect:r}:r)?r!==!0&&typeof r!="number"&&r.effect||o:i;typeof(r=r||{})=="number"?r={duration:r}:r===!0&&(r={}),h=!t.isEmptyObject(r),r.complete=d,r.delay&&l.delay(r.delay),h&&t.effects&&t.effects.effect[v]?l[i](r):v!==i&&l[v]?l[v](r.duration,r.easing,d):l.queue(function(p){t(this)[i](),d&&d.call(l[0]),p()})}}),t.widget,t.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},!1);t(document).on("mouseup",function(){a=!1}),t.widget("ui.mouse",{version:"1.14.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var i=this;this.element.on("mousedown."+this.widgetName,function(o){return i._mouseDown(o)}).on("click."+this.widgetName,function(o){if(t.data(o.target,i.widgetName+".preventClickEvent")===!0)return t.removeData(o.target,i.widgetName+".preventClickEvent"),o.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){var o,l,r;if(!a)return this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(i),l=(this._mouseDownEvent=i).which===1,r=typeof(o=this).options.cancel=="string"&&t(i.target).closest(this.options.cancel).length,l&&!r&&this._mouseCapture(i)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){o.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?i.preventDefault():(t.data(i.target,this.widgetName+".preventClickEvent")===!0&&t.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(d){return o._mouseMove(d)},this._mouseUpDelegate=function(d){return o._mouseUp(d)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),a=!0)),!0},_mouseMove:function(i){if(this._mouseMoved&&!i.which){if(i.originalEvent.altKey||i.originalEvent.ctrlKey||i.originalEvent.metaKey||i.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(i)}return(i.which||i.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(i),i.preventDefault()):(this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,i)!==!1,this._mouseStarted?this._mouseDrag(i):this._mouseUp(i)),!this._mouseStarted)},_mouseUp:function(i){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,i.target===this._mouseDownEvent.target&&t.data(i.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(i)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,a=!1,i.preventDefault()},_mouseDistanceMet:function(i){return Math.max(Math.abs(this._mouseDownEvent.pageX-i.pageX),Math.abs(this._mouseDownEvent.pageY-i.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),t.widget("ui.slider",t.ui.mouse,{version:"1.14.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var i,o=this.options,l=this.element.find(".ui-slider-handle"),r=[],d=o.values&&o.values.length||1;for(l.length>d&&(l.slice(d).remove(),l=l.slice(0,d)),i=l.length;i<d;i++)r.push("<span tabindex='0'></span>");this.handles=l.add(t(r.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(h){t(this).data("ui-slider-handle-index",h).attr("tabIndex",0)})},_createRange:function(){var i=this.options;i.range?(i.range===!0&&(i.values?i.values.length&&i.values.length!==2?i.values=[i.values[0],i.values[0]]:Array.isArray(i.values)&&(i.values=i.values.slice(0)):i.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=t("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),i.range!=="min"&&i.range!=="max"||this._addClass(this.range,"ui-slider-range-"+i.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(i){var o,l,r,d,h,v,p=this,m=this.options;return!m.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),h={x:i.pageX,y:i.pageY},o=this._normValueFromMouse(h),l=this._valueMax()-this._valueMin()+1,this.handles.each(function(A){var y=Math.abs(o-p.values(A));(y<l||l===y&&(A===p._lastChangedValue||p.values(A)===m.min))&&(l=y,r=t(this),d=A)}),this._start(i,d)!==!1)&&(this._mouseSliding=!0,this._handleIndex=d,this._addClass(r,null,"ui-state-active"),r.trigger("focus"),h=r.offset(),v=!t(i.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=v?{left:0,top:0}:{left:i.pageX-h.left-r.width()/2,top:i.pageY-h.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(i,d,o),this._animateOff=!0)},_mouseStart:function(){return!0},_mouseDrag:function(i){var o={x:i.pageX,y:i.pageY},o=this._normValueFromMouse(o);return this._slide(i,this._handleIndex,o),!1},_mouseStop:function(i){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(i,this._handleIndex),this._change(i,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(l){var o,l=this.orientation==="horizontal"?(o=this.elementSize.width,l.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(o=this.elementSize.height,l.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),l=l/o;return(l=1<l?1:l)<0&&(l=0),this.orientation==="vertical"&&(l=1-l),o=this._valueMax()-this._valueMin(),l=this._valueMin()+l*o,this._trimAlignValue(l)},_uiHash:function(i,o,l){var r={handle:this.handles[i],handleIndex:i,value:o!==void 0?o:this.value()};return this._hasMultipleValues()&&(r.value=o!==void 0?o:this.values(i),r.values=l||this.values()),r},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(i,o){return this._trigger("start",i,this._uiHash(o))},_slide:function(i,o,l){var r,d=this.value(),h=this.values();this._hasMultipleValues()&&(r=this.values(o?0:1),d=this.values(o),this.options.values.length===2&&this.options.range===!0&&(l=o===0?Math.min(r,l):Math.max(r,l)),h[o]=l),l!==d&&this._trigger("slide",i,this._uiHash(o,l,h))!==!1&&(this._hasMultipleValues()?this.values(o,l):this.value(l))},_stop:function(i,o){this._trigger("stop",i,this._uiHash(o))},_change:function(i,o){this._keySliding||this._mouseSliding||(this._lastChangedValue=o,this._trigger("change",i,this._uiHash(o)))},value:function(i){if(!arguments.length)return this._value();this.options.value=this._trimAlignValue(i),this._refreshValue(),this._change(null,0)},values:function(i,o){var l,r,d;if(1<arguments.length)this.options.values[i]=this._trimAlignValue(o),this._refreshValue(),this._change(null,i);else{if(!arguments.length)return this._values();if(!Array.isArray(i))return this._hasMultipleValues()?this._values(i):this.value();for(l=this.options.values,r=i,d=0;d<l.length;d+=1)l[d]=this._trimAlignValue(r[d]),this._change(null,d);this._refreshValue()}},_setOption:function(i,o){var l,r=0;switch(i==="range"&&this.options.range===!0&&(o==="min"?(this.options.value=this._values(0),this.options.values=null):o==="max"&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),Array.isArray(this.options.values)&&(r=this.options.values.length),this._super(i,o),i){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(o),this.handles.css(o==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),l=r-1;0<=l;l--)this._change(null,l);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(i){this._super(i),this._toggleClass(null,"ui-state-disabled",!!i)},_value:function(){var i=this.options.value;return this._trimAlignValue(i)},_values:function(i){var o,l;if(arguments.length)return i=this.options.values[i],this._trimAlignValue(i);if(this._hasMultipleValues()){for(o=this.options.values.slice(),l=0;l<o.length;l+=1)o[l]=this._trimAlignValue(o[l]);return o}return[]},_trimAlignValue:function(i){var o,l;return i<=this._valueMin()?this._valueMin():i>=this._valueMax()?this._valueMax():(o=0<this.options.step?this.options.step:1,l=i-(i=(i-this._valueMin())%o),2*Math.abs(i)>=o&&(l+=0<i?o:-o),parseFloat(l.toFixed(5)))},_calculateNewMax:function(){var i=this.options.max,o=this._valueMin(),l=this.options.step;(i=Math.round((i-o)/l)*l+o)>this.options.max&&(i-=l),this.max=parseFloat(i.toFixed(this._precision()))},_precision:function(){var i=this._precisionOf(this.options.step);return i=this.options.min!==null?Math.max(i,this._precisionOf(this.options.min)):i},_precisionOf:function(o){var o=o.toString(),l=o.indexOf(".");return l===-1?0:o.length-l-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(i){i==="vertical"&&this.range.css({width:"",left:""}),i==="horizontal"&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var i,o,l,r,d,h=this.options.range,v=this.options,p=this,m=!this._animateOff&&v.animate,A={};this._hasMultipleValues()?this.handles.each(function(y){o=(p.values(y)-p._valueMin())/(p._valueMax()-p._valueMin())*100,A[p.orientation==="horizontal"?"left":"bottom"]=o+"%",t(this).stop(1,1)[m?"animate":"css"](A,v.animate),p.options.range===!0&&(p.orientation==="horizontal"?(y===0&&p.range.stop(1,1)[m?"animate":"css"]({left:o+"%"},v.animate),y===1&&p.range[m?"animate":"css"]({width:o-i+"%"},{queue:!1,duration:v.animate})):(y===0&&p.range.stop(1,1)[m?"animate":"css"]({bottom:o+"%"},v.animate),y===1&&p.range[m?"animate":"css"]({height:o-i+"%"},{queue:!1,duration:v.animate}))),i=o}):(l=this.value(),r=this._valueMin(),d=this._valueMax(),o=d!==r?(l-r)/(d-r)*100:0,A[this.orientation==="horizontal"?"left":"bottom"]=o+"%",this.handle.stop(1,1)[m?"animate":"css"](A,v.animate),h==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[m?"animate":"css"]({width:o+"%"},v.animate),h==="max"&&this.orientation==="horizontal"&&this.range.stop(1,1)[m?"animate":"css"]({width:100-o+"%"},v.animate),h==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[m?"animate":"css"]({height:o+"%"},v.animate),h==="max"&&this.orientation==="vertical"&&this.range.stop(1,1)[m?"animate":"css"]({height:100-o+"%"},v.animate))},_handleEvents:{keydown:function(i){var o,l,r,d=t(i.target).data("ui-slider-handle-index");switch(i.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(i.preventDefault(),this._keySliding||(this._keySliding=!0,this._addClass(t(i.target),null,"ui-state-active"),this._start(i,d)!==!1))break;return}switch(r=this.options.step,o=l=this._hasMultipleValues()?this.values(d):this.value(),i.keyCode){case t.ui.keyCode.HOME:l=this._valueMin();break;case t.ui.keyCode.END:l=this._valueMax();break;case t.ui.keyCode.PAGE_UP:l=this._trimAlignValue(o+(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.PAGE_DOWN:l=this._trimAlignValue(o-(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(o===this._valueMax())return;l=this._trimAlignValue(o+r);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(o===this._valueMin())return;l=this._trimAlignValue(o-r)}this._slide(i,d,l)},keyup:function(i){var o=t(i.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(i,o),this._change(i,o),this._removeClass(t(i.target),null,"ui-state-active"))}}})});console.log("JS ì¤í:","app-localization.js");(t=>{let n={};function s(x,...P){function L(g){if(AccessKeys.has(g)){const _=AccessKeys.remove(g);if(n[_]){const u=AccessKeys.get(g);return n[_].toUpperCase().indexOf(u.toUpperCase())>-1?n[_]:AccessKeys.has(n[_])?`${AccessKeys.remove(n[_])} (${u})`:`${n[_]} (${u})`}}return n[g]?n[g]:g}function T(g,_){for(let u=0;u<_.length;u++)g=g.replace(`%${u+1}`,_[u]);return g}return T(L(x),P)}const e="jspaint language",c=Array.from(navigator.languages||[navigator.language||navigator.userLanguage]);try{localStorage[e]&&c.unshift(localStorage[e])}catch{}var a={aa:"ET",ab:"GE",abr:"GH",ace:"ID",ach:"UG",ada:"GH",ady:"RU",ae:"IR",aeb:"TN",af:"ZA",agq:"CM",aho:"IN",ak:"GH",akk:"IQ",aln:"XK",alt:"RU",am:"ET",amo:"NG",aoz:"ID",apd:"TG",ar:"EG",arc:"IR","arc-Nbat":"JO","arc-Palm":"SY",arn:"CL",aro:"BO",arq:"DZ",ary:"MA",arz:"EG",as:"IN",asa:"TZ",ase:"US",ast:"ES",atj:"CA",av:"RU",awa:"IN",ay:"BO",az:"AZ","az-Arab":"IR",ba:"RU",bal:"PK",ban:"ID",bap:"NP",bar:"AT",bas:"CM",bax:"CM",bbc:"ID",bbj:"CM",bci:"CI",be:"BY",bej:"SD",bem:"ZM",bew:"ID",bez:"TZ",bfd:"CM",bfq:"IN",bft:"PK",bfy:"IN",bg:"BG",bgc:"IN",bgn:"PK",bgx:"TR",bhb:"IN",bhi:"IN",bhk:"PH",bho:"IN",bi:"VU",bik:"PH",bin:"NG",bjj:"IN",bjn:"ID",bjt:"SN",bkm:"CM",bku:"PH",blt:"VN",bm:"ML",bmq:"ML",bn:"BD",bo:"CN",bpy:"IN",bqi:"IR",bqv:"CI",br:"FR",bra:"IN",brh:"PK",brx:"IN",bs:"BA",bsq:"LR",bss:"CM",bto:"PH",btv:"PK",bua:"RU",buc:"YT",bug:"ID",bum:"CM",bvb:"GQ",byn:"ER",byv:"CM",bze:"ML",ca:"ES",cch:"NG",ccp:"BD",ce:"RU",ceb:"PH",cgg:"UG",ch:"GU",chk:"FM",chm:"RU",cho:"US",chp:"CA",chr:"US",cja:"KH",cjm:"VN",ckb:"IQ",co:"FR",cop:"EG",cps:"PH",cr:"CA",crh:"UA",crj:"CA",crk:"CA",crl:"CA",crm:"CA",crs:"SC",cs:"CZ",csb:"PL",csw:"CA",ctd:"MM",cu:"RU","cu-Glag":"BG",cv:"RU",cy:"GB",da:"DK",dak:"US",dar:"RU",dav:"KE",dcc:"IN",de:"DE",den:"CA",dgr:"CA",dje:"NE",dnj:"CI",doi:"IN",dsb:"DE",dtm:"ML",dtp:"MY",dty:"NP",dua:"CM",dv:"MV",dyo:"SN",dyu:"BF",dz:"BT",ebu:"KE",ee:"GH",efi:"NG",egl:"IT",egy:"EG",eky:"MM",el:"GR",en:"US","en-Shaw":"GB",es:"ES",esu:"US",et:"EE",ett:"IT",eu:"ES",ewo:"CM",ext:"ES",fa:"IR",fan:"GQ",ff:"SN","ff-Adlm":"GN",ffm:"ML",fi:"FI",fia:"SD",fil:"PH",fit:"SE",fj:"FJ",fo:"FO",fon:"BJ",fr:"FR",frc:"US",frp:"FR",frr:"DE",frs:"DE",fub:"CM",fud:"WF",fuf:"GN",fuq:"NE",fur:"IT",fuv:"NG",fvr:"SD",fy:"NL",ga:"IE",gaa:"GH",gag:"MD",gan:"CN",gay:"ID",gbm:"IN",gbz:"IR",gcr:"GF",gd:"GB",gez:"ET",ggn:"NP",gil:"KI",gjk:"PK",gju:"PK",gl:"ES",glk:"IR",gn:"PY",gom:"IN",gon:"IN",gor:"ID",gos:"NL",got:"UA",grc:"CY","grc-Linb":"GR",grt:"IN",gsw:"CH",gu:"IN",gub:"BR",guc:"CO",gur:"GH",guz:"KE",gv:"IM",gvr:"NP",gwi:"CA",ha:"NG",hak:"CN",haw:"US",haz:"AF",he:"IL",hi:"IN",hif:"FJ",hil:"PH",hlu:"TR",hmd:"CN",hnd:"PK",hne:"IN",hnj:"LA",hnn:"PH",hno:"PK",ho:"PG",hoc:"IN",hoj:"IN",hr:"HR",hsb:"DE",hsn:"CN",ht:"HT",hu:"HU",hy:"AM",hz:"NA",ia:"FR",iba:"MY",ibb:"NG",id:"ID",ife:"TG",ig:"NG",ii:"CN",ik:"US",ikt:"CA",ilo:"PH",in:"ID",inh:"RU",is:"IS",it:"IT",iu:"CA",iw:"IL",izh:"RU",ja:"JP",jam:"JM",jgo:"CM",ji:"UA",jmc:"TZ",jml:"NP",jut:"DK",jv:"ID",jw:"ID",ka:"GE",kaa:"UZ",kab:"DZ",kac:"MM",kaj:"NG",kam:"KE",kao:"ML",kbd:"RU",kby:"NE",kcg:"NG",kck:"ZW",kde:"TZ",kdh:"TG",kdt:"TH",kea:"CV",ken:"CM",kfo:"CI",kfr:"IN",kfy:"IN",kg:"CD",kge:"ID",kgp:"BR",kha:"IN",khb:"CN",khn:"IN",khq:"ML",kht:"IN",khw:"PK",ki:"KE",kiu:"TR",kj:"NA",kjg:"LA",kk:"KZ","kk-Arab":"CN",kkj:"CM",kl:"GL",kln:"KE",km:"KH",kmb:"AO",kn:"IN",knf:"SN",ko:"KR",koi:"RU",kok:"IN",kos:"FM",kpe:"LR",krc:"RU",kri:"SL",krj:"PH",krl:"RU",kru:"IN",ks:"IN",ksb:"TZ",ksf:"CM",ksh:"DE",ku:"TR","ku-Arab":"IQ",kum:"RU",kv:"RU",kvr:"ID",kvx:"PK",kw:"GB",kxm:"TH",kxp:"PK",ky:"KG","ky-Arab":"CN","ky-Latn":"TR",la:"VA",lab:"GR",lad:"IL",lag:"TZ",lah:"PK",laj:"UG",lb:"LU",lbe:"RU",lbw:"ID",lcp:"CN",lep:"IN",lez:"RU",lg:"UG",li:"NL",lif:"NP","lif-Limb":"IN",lij:"IT",lis:"CN",ljp:"ID",lki:"IR",lkt:"US",lmn:"IN",lmo:"IT",ln:"CD",lo:"LA",lol:"CD",loz:"ZM",lrc:"IR",lt:"LT",ltg:"LV",lu:"CD",lua:"CD",luo:"KE",luy:"KE",luz:"IR",lv:"LV",lwl:"TH",lzh:"CN",lzz:"TR",mad:"ID",maf:"CM",mag:"IN",mai:"IN",mak:"ID",man:"GM","man-Nkoo":"GN",mas:"KE",maz:"MX",mdf:"RU",mdh:"PH",mdr:"ID",men:"SL",mer:"KE",mfa:"TH",mfe:"MU",mg:"MG",mgh:"MZ",mgo:"CM",mgp:"NP",mgy:"TZ",mh:"MH",mi:"NZ",min:"ID",mis:"IQ",mk:"MK",ml:"IN",mls:"SD",mn:"MN","mn-Mong":"CN",mni:"IN",mnw:"MM",moe:"CA",moh:"CA",mos:"BF",mr:"IN",mrd:"NP",mrj:"RU",mro:"BD",ms:"MY",mt:"MT",mtr:"IN",mua:"CM",mus:"US",mvy:"PK",mwk:"ML",mwr:"IN",mwv:"ID",mxc:"ZW",my:"MM",myv:"RU",myx:"UG",myz:"IR",mzn:"IR",na:"NR",nan:"CN",nap:"IT",naq:"NA",nb:"NO",nch:"MX",nd:"ZW",ndc:"MZ",nds:"DE",ne:"NP",new:"NP",ng:"NA",ngl:"MZ",nhe:"MX",nhw:"MX",nij:"ID",niu:"NU",njo:"IN",nl:"NL",nmg:"CM",nn:"NO",nnh:"CM",no:"NO",nod:"TH",noe:"IN",non:"SE",nqo:"GN",nr:"ZA",nsk:"CA",nso:"ZA",nus:"SS",nv:"US",nxq:"CN",ny:"MW",nym:"TZ",nyn:"UG",nzi:"GH",oc:"FR",om:"ET",or:"IN",os:"GE",osa:"US",otk:"MN",pa:"IN","pa-Arab":"PK",pag:"PH",pal:"IR","pal-Phlp":"CN",pam:"PH",pap:"AW",pau:"PW",pcd:"FR",pcm:"NG",pdc:"US",pdt:"CA",peo:"IR",pfl:"DE",phn:"LB",pka:"IN",pko:"KE",pl:"PL",pms:"IT",pnt:"GR",pon:"FM",pra:"PK",prd:"IR",ps:"AF",pt:"PT",puu:"GA",qu:"PE",quc:"GT",qug:"EC",raj:"IN",rcf:"RE",rej:"ID",rgn:"IT",ria:"IN",rif:"MA",rjs:"NP",rkt:"BD",rm:"CH",rmf:"FI",rmo:"CH",rmt:"IR",rmu:"SE",rn:"BI",rng:"MZ",ro:"RO",rob:"ID",rof:"TZ",rtm:"FJ",ru:"RU",rue:"UA",rug:"SB",rw:"RW",rwk:"TZ",ryu:"JP",sa:"IN",saf:"GH",sah:"RU",saq:"KE",sas:"ID",sat:"IN",sav:"SN",saz:"IN",sbp:"TZ",sc:"IT",sck:"IN",scn:"IT",sco:"GB",scs:"CA",sd:"PK","sd-Deva":"IN","sd-Khoj":"IN","sd-Sind":"IN",sdc:"IT",sdh:"IR",se:"NO",sef:"CI",seh:"MZ",sei:"MX",ses:"ML",sg:"CF",sga:"IE",sgs:"LT",shi:"MA",shn:"MM",si:"LK",sid:"ET",sk:"SK",skr:"PK",sl:"SI",sli:"PL",sly:"ID",sm:"WS",sma:"SE",smj:"SE",smn:"FI",smp:"IL",sms:"FI",sn:"ZW",snk:"ML",so:"SO",sou:"TH",sq:"AL",sr:"RS",srb:"IN",srn:"SR",srr:"SN",srx:"IN",ss:"ZA",ssy:"ER",st:"ZA",stq:"DE",su:"ID",suk:"TZ",sus:"GN",sv:"SE",sw:"TZ",swb:"YT",swc:"CD",swg:"DE",swv:"IN",sxn:"ID",syl:"BD",syr:"IQ",szl:"PL",ta:"IN",taj:"NP",tbw:"PH",tcy:"IN",tdd:"CN",tdg:"NP",tdh:"NP",te:"IN",tem:"SL",teo:"UG",tet:"TL",tg:"TJ","tg-Arab":"PK",th:"TH",thl:"NP",thq:"NP",thr:"NP",ti:"ET",tig:"ER",tiv:"NG",tk:"TM",tkl:"TK",tkr:"AZ",tkt:"NP",tl:"PH",tly:"AZ",tmh:"NE",tn:"ZA",to:"TO",tog:"MW",tpi:"PG",tr:"TR",tru:"TR",trv:"TW",ts:"ZA",tsd:"GR",tsf:"NP",tsg:"PH",tsj:"BT",tt:"RU",ttj:"UG",tts:"TH",ttt:"AZ",tum:"MW",tvl:"TV",twq:"NE",txg:"CN",ty:"PF",tyv:"RU",tzm:"MA",udm:"RU",ug:"CN","ug-Cyrl":"KZ",uga:"SY",uk:"UA",uli:"FM",umb:"AO",und:"US",unr:"IN","unr-Deva":"NP",unx:"IN",ur:"PK",uz:"UZ","uz-Arab":"AF",vai:"LR",ve:"ZA",vec:"IT",vep:"RU",vi:"VN",vic:"SX",vls:"BE",vmf:"DE",vmw:"MZ",vot:"RU",vro:"EE",vun:"TZ",wa:"BE",wae:"CH",wal:"ET",war:"PH",wbp:"AU",wbq:"IN",wbr:"IN",wls:"WF",wni:"KM",wo:"SN",wtm:"IN",wuu:"CN",xav:"BR",xcr:"TR",xh:"ZA",xlc:"TR",xld:"TR",xmf:"GE",xmn:"CN",xmr:"SD",xna:"SA",xnr:"IN",xog:"UG",xpr:"IR",xsa:"YE",xsr:"NP",yao:"MZ",yap:"FM",yav:"CM",ybb:"CM",yo:"NG",yrl:"BR",yua:"MX",yue:"HK","yue-Hans":"CN",za:"CN",zag:"SD",zdj:"KM",zea:"NL",zgh:"MA",zh:"CN","zh-Bopo":"TW","zh-Hanb":"TW","zh-Hant":"TW",zlm:"TG",zmi:"MY",zu:"ZA",zza:"TR"};function i(x){var P=x.toUpperCase().split(/-|_/),L=P.shift(),T=P.pop();if(/^[A-Z]{2}$/.test(T)||(T=a[L.toLowerCase()]),!T)return"";const g=String.fromCodePoint(T.codePointAt(0)-65+127462),_=String.fromCodePoint(T.codePointAt(1)-65+127462);return g+_}const o="en",l=["ar","cs","da","de","el","en","es","fi","fr","he","hu","it","ja","ko","nl","no","pl","pt","pt-br","ru","sk","sl","sv","tr","zh","zh-simplified"],r={ab:[["Abkhazian"],["ÐÒ§ÑÑÐ° ÐÑÐ·ÑÓÐ°","ÐÒ§ÑÑÓÐ°"]],aa:[["Afar"],["Afaraf"]],af:[["Afrikaans"],["Afrikaans"]],ak:[["Akan"],["Akan"]],sq:[["Albanian"],["Shqip"]],am:[["Amharic"],["á áá­á"]],ar:[["Arabic"],["Ø§ÙØ¹Ø±Ø¨ÙØ©"]],an:[["Aragonese"],["AragonÃ©s"]],hy:[["Armenian"],["ÕÕ¡ÕµÕ¥ÖÕ¥Õ¶"]],as:[["Assamese"],["à¦à¦¸à¦®à§à¦¯à¦¼à¦¾"]],av:[["Avaric"],["ÐÐ²Ð°Ñ ÐÐ°ÑÓ","ÐÐ°Ð³ÓÐ°ÑÑÐ» ÐÐ°ÑÓ"]],ae:[["Avestan"],["Avesta"]],ay:[["Aymara"],["Aymar Aru"]],az:[["Azerbaijani"],["AzÉrbaycan Dili"]],bm:[["Bambara"],["Bamanankan"]],ba:[["Bashkir"],["ÐÐ°ÑÒ¡Ð¾ÑÑ Ð¢ÐµÐ»Ðµ"]],eu:[["Basque"],["Euskara","Euskera"]],be:[["Belarusian"],["ÐÐµÐ»Ð°ÑÑÑÐºÐ°Ñ ÐÐ¾Ð²Ð°"]],bn:[["Bengali"],["à¦¬à¦¾à¦à¦²à¦¾"]],bh:[["Bihari Languages"],["à¤­à¥à¤à¤ªà¥à¤°à¥"]],bi:[["Bislama"],["Bislama"]],bs:[["Bosnian"],["Bosanski Jezik"]],br:[["Breton"],["Brezhoneg"]],bg:[["Bulgarian"],["ÐÑÐ»Ð³Ð°ÑÑÐºÐ¸ ÐÐ·Ð¸Ðº"]],my:[["Burmese"],["ááá¬áá¬"]],ca:[["Catalan","Valencian"],["CatalÃ ","ValenciÃ "]],ch:[["Chamorro"],["Chamoru"]],ce:[["Chechen"],["ÐÐ¾ÑÑÐ¸Ð¹Ð½ ÐÐ¾ÑÑ"]],ny:[["Chichewa","Chewa","Nyanja"],["ChiCheÅµa","Chinyanja"]],zh:[["Traditional Chinese"],["ç¹é«ä¸­æ","å³çµ±ä¸­æ","æ­£é«ä¸­æ","ç¹ä½ä¸­æ"]],"zh-traditional":[["Traditional Chinese"],["ç¹é«ä¸­æ","å³çµ±ä¸­æ","æ­£é«ä¸­æ","ç¹ä½ä¸­æ"]],"zh-simplified":[["Simple Chinese"],["ç®ä½ä¸­æ"]],cv:[["Chuvash"],["Ð§ÓÐ²Ð°Ñ Ð§ÓÐ»ÑÐ¸"]],kw:[["Cornish"],["Kernewek"]],co:[["Corsican"],["Corsu","Lingua Corsa"]],cr:[["Cree"],["áá¦áá­ááá£"]],hr:[["Croatian"],["Hrvatski Jezik"]],cs:[["Czech"],["ÄeÅ¡tina","ÄeskÃ½ Jazyk"]],da:[["Danish"],["Dansk"]],dv:[["Divehi","Dhivehi","Maldivian"],["ÞÞ¨ÞÞ¬ÞÞ¨"]],nl:[["Dutch","Flemish"],["Nederlands","Vlaams"]],dz:[["Dzongkha"],["à½¢à¾«à½¼à½à¼à½"]],en:[["English"],["English"]],eo:[["Esperanto"],["Esperanto"]],et:[["Estonian"],["Eesti","Eesti Keel"]],ee:[["Ewe"],["EÊegbe"]],fo:[["Faroese"],["FÃ¸royskt"]],fj:[["Fijian"],["Vosa Vakaviti"]],fi:[["Finnish"],["Suomi","Suomen Kieli"]],fr:[["French"],["FranÃ§ais","Langue FranÃ§aise"]],ff:[["Fulah"],["Fulfulde","Pulaar","Pular"]],gl:[["Galician"],["Galego"]],ka:[["Georgian"],["á¥áá áá£áá"]],de:[["German"],["Deutsch"]],el:[["Greek"],["ÎÎ»Î»Î·Î½Î¹ÎºÎ¬"]],gn:[["Guarani"],["AvaÃ±e'áº½"]],gu:[["Gujarati"],["àªà«àªàª°àª¾àª¤à«"]],ht:[["Haitian","Haitian Creole"],["KreyÃ²l Ayisyen"]],ha:[["Hausa"],["ÙÙÙÙØ³Ù"]],he:[["Hebrew"],["×¢××¨××ª"]],hz:[["Herero"],["Otjiherero"]],hi:[["Hindi"],["à¤¹à¤¿à¤¨à¥à¤¦à¥","à¤¹à¤¿à¤à¤¦à¥"]],ho:[["Hiri Motu"],["Hiri Motu"]],hu:[["Hungarian"],["Magyar"]],ia:[["Interlingua"],["Interlingua"]],id:[["Indonesian"],["Bahasa Indonesia"]],ie:[["Interlingue","Occidental"],["Interlingue","Occidental"]],ga:[["Irish"],["Gaeilge"]],ig:[["Igbo"],["Asá»¥sá»¥ Igbo"]],ik:[["Inupiaq"],["IÃ±upiaq","IÃ±upiatun"]],io:[["Ido"],["Ido"]],is:[["Icelandic"],["Ãslenska"]],it:[["Italian"],["Italiano"]],iu:[["Inuktitut"],["áááááá¦"]],ja:[["Japanese"],["æ¥æ¬èª","ã«ã»ãã"]],jv:[["Javanese"],["ê¦§ê¦±ê¦ê¦®","Basa Jawa"]],kl:[["Kalaallisut","Greenlandic"],["Kalaallisut","Kalaallit Oqaasii"]],kn:[["Kannada"],["à²à²¨à³à²¨à²¡"]],kr:[["Kanuri"],["Kanuri"]],ks:[["Kashmiri"],["à¤à¤¶à¥à¤®à¥à¤°à¥","ÙØ´ÙÙØ±Ùâ"]],kk:[["Kazakh"],["ÒÐ°Ð·Ð°Ò Ð¢ÑÐ»Ñ"]],km:[["Central Khmer"],["ááááá","áááááá¶áá¶","áá¶áá¶ááááá"]],ki:[["Kikuyu","Gikuyu"],["GÄ©kÅ©yÅ©"]],rw:[["Kinyarwanda"],["Ikinyarwanda"]],ky:[["Kirghiz","Kyrgyz"],["ÐÑÑÐ³ÑÐ·ÑÐ°","ÐÑÑÐ³ÑÐ· Ð¢Ð¸Ð»Ð¸"]],kv:[["Komi"],["ÐÐ¾Ð¼Ð¸ ÐÑÐ²"]],kg:[["Kongo"],["Kikongo"]],ko:[["Korean"],["íêµ­ì´"]],ku:[["Kurdish"],["KurdÃ®","Ú©ÙØ±Ø¯Ûâ"]],kj:[["Kuanyama","Kwanyama"],["Kuanyama"]],la:[["Latin"],["Latine","Lingua Latina"]],lb:[["Luxembourgish","Letzeburgesch"],["LÃ«tzebuergesch"]],lg:[["Ganda"],["Luganda"]],li:[["Limburgan","Limburger","Limburgish"],["Limburgs"]],ln:[["Lingala"],["LingÃ¡la"]],lo:[["Lao"],["àºàº²àºªàº²àº¥àº²àº§"]],lt:[["Lithuanian"],["LietuviÅ³ Kalba"]],lu:[["Luba-Katanga"],["Kiluba"]],lv:[["Latvian"],["LatvieÅ¡u Valoda"]],gv:[["Manx"],["Gaelg","Gailck"]],mk:[["Macedonian"],["ÐÐ°ÐºÐµÐ´Ð¾Ð½ÑÐºÐ¸ ÐÐ°Ð·Ð¸Ðº"]],mg:[["Malagasy"],["Fiteny Malagasy"]],ms:[["Malay"],["Bahasa Melayu","Ø¨ÙØ§Ø³ ÙÙØ§ÙÙâ"]],ml:[["Malayalam"],["à´®à´²à´¯à´¾à´³à´"]],mt:[["Maltese"],["Malti"]],mi:[["Maori"],["Te Reo MÄori"]],mr:[["Marathi"],["à¤®à¤°à¤¾à¤ à¥"]],mh:[["Marshallese"],["Kajin MÌ§ajeÄ¼"]],mn:[["Mongolian"],["ÐÐ¾Ð½Ð³Ð¾Ð» Ð¥ÑÐ»"]],na:[["Nauru"],["Dorerin Naoero"]],nv:[["Navajo","Navaho"],["DinÃ© Bizaad"]],nd:[["North Ndebele"],["IsiNdebele"]],ne:[["Nepali"],["à¤¨à¥à¤ªà¤¾à¤²à¥"]],ng:[["Ndonga"],["Owambo"]],nb:[["Norwegian BokmÃ¥l"],["Norsk BokmÃ¥l"]],nn:[["Norwegian Nynorsk"],["Norsk Nynorsk"]],no:[["Norwegian"],["Norsk"]],ii:[["Sichuan Yi","Nuosu"],["êê ê¿","Nuosuhxop"]],nr:[["South Ndebele"],["IsiNdebele"]],oc:[["Occitan"],["Occitan","Lenga d'Ãc"]],oj:[["Ojibwa"],["ááááá¯á§áá"]],cu:[["Church Slavic","Old Slavonic","Church Slavonic","Old Bulgarian","Old Church Slavonic"],["Ñ¨Ð·ÑÐºÑ Ð¡Ð»Ð¾Ð²Ñ£Ð½ÑÑÐºÑ"]],om:[["Oromo"],["Afaan Oromoo"]],or:[["Oriya"],["à¬à¬¡à¬¼à¬¿à¬"]],os:[["Ossetian","Ossetic"],["ÐÑÐ¾Ð½ ÃÐ²Ð·Ð°Ð³"]],pa:[["Punjabi","Panjabi"],["à¨ªà©°à¨à¨¾à¨¬à©","Ù¾ÙØ¬Ø§Ø¨Ûâ"]],pi:[["Pali"],["à¤ªà¤¾à¤²à¤¿","à¤ªà¤¾à¤³à¤¿"]],fa:[["Persian"],["ÙØ§Ø±Ø³Û"]],pl:[["Polish"],["JÄzyk Polski","Polszczyzna"]],ps:[["Pashto","Pushto"],["Ù¾ÚØªÙ"]],pt:[["Portuguese"],["PortuguÃªs"]],"pt-br":[["Brazilian Portuguese"],["PortuguÃªs Brasileiro"]],"pt-pt":[["Portuguese (Portugal)"],["PortuguÃªs De Portugal"]],qu:[["Quechua"],["Runa Simi","Kichwa"]],rm:[["Romansh"],["Rumantsch Grischun"]],rn:[["Rundi"],["Ikirundi"]],ro:[["Romanian","Moldavian","Moldovan"],["RomÃ¢nÄ"]],ru:[["Russian"],["Ð ÑÑÑÐºÐ¸Ð¹"]],sa:[["Sanskrit"],["à¤¸à¤à¤¸à¥à¤à¥à¤¤à¤®à¥"]],sc:[["Sardinian"],["Sardu"]],sd:[["Sindhi"],["à¤¸à¤¿à¤¨à¥à¤§à¥","Ø³ÙÚÙØ Ø³ÙØ¯Ú¾Ûâ"]],se:[["Northern Sami"],["DavvisÃ¡megiella"]],sm:[["Samoan"],["Gagana Fa'a Samoa"]],sg:[["Sango"],["YÃ¢ngÃ¢ TÃ® SÃ¤ngÃ¶"]],sr:[["Serbian"],["Ð¡ÑÐ¿ÑÐºÐ¸ ÐÐµÐ·Ð¸Ðº"]],gd:[["Gaelic","Scottish Gaelic"],["GÃ idhlig"]],sn:[["Shona"],["ChiShona"]],si:[["Sinhala","Sinhalese"],["à·à·à¶à·à¶½"]],sk:[["Slovak"],["SlovenÄina","SlovenskÃ½ Jazyk"]],sl:[["Slovenian"],["Slovenski Jezik","SlovenÅ¡Äina"]],so:[["Somali"],["Soomaaliga","Af Soomaali"]],st:[["Southern Sotho"],["Sesotho"]],es:[["Spanish","Castilian"],["EspaÃ±ol"]],su:[["Sundanese"],["Basa Sunda"]],sw:[["Swahili"],["Kiswahili"]],ss:[["Swati"],["SiSwati"]],sv:[["Swedish"],["Svenska"]],ta:[["Tamil"],["à®¤à®®à®¿à®´à¯"]],te:[["Telugu"],["à°¤à±à°²à±à°à±"]],tg:[["Tajik"],["Ð¢Ð¾Ò·Ð¸ÐºÓ£","ToÃ§ikÄ«","ØªØ§Ø¬ÛÚ©Ûâ"]],th:[["Thai"],["à¹à¸à¸¢"]],ti:[["Tigrinya"],["áµáá­á"]],bo:[["Tibetan"],["à½à½¼à½à¼à½¡à½²à½"]],tk:[["Turkmen"],["TÃ¼rkmen","Ð¢Ò¯ÑÐºÐ¼ÐµÐ½"]],tl:[["Tagalog"],["Wikang Tagalog"]],tn:[["Tswana"],["Setswana"]],to:[["Tonga"],["Faka Tonga"]],tr:[["Turkish"],["TÃ¼rkÃ§e"]],ts:[["Tsonga"],["Xitsonga"]],tt:[["Tatar"],["Ð¢Ð°ÑÐ°Ñ Ð¢ÐµÐ»Ðµ","Tatar Tele"]],tw:[["Twi"],["Twi"]],ty:[["Tahitian"],["Reo Tahiti"]],ug:[["Uighur","Uyghur"],["Ø¦ÛÙØºÛØ±ÚÛâ","Uyghurche"]],uk:[["Ukrainian"],["Ð£ÐºÑÐ°ÑÐ½ÑÑÐºÐ°"]],ur:[["Urdu"],["Ø§Ø±Ø¯Ù"]],uz:[["Uzbek"],["OÊ»zbek","ÐÐ·Ð±ÐµÐº","Ø£ÛØ²Ø¨ÛÙâ"]],ve:[["Venda"],["Tshivená¸a"]],vi:[["Vietnamese"],["Tiáº¿ng Viá»t"]],vo:[["VolapÃ¼k"],["VolapÃ¼k"]],wa:[["Walloon"],["Walon"]],cy:[["Welsh"],["Cymraeg"]],wo:[["Wolof"],["Wollof"]],fy:[["Western Frisian"],["Frysk"]],xh:[["Xhosa"],["IsiXhosa"]],yi:[["Yiddish"],["××Ö´×××©"]],yo:[["Yoruba"],["YorÃ¹bÃ¡"]],za:[["Zhuang","Chuang"],["SaÉ¯ CueÅÆ","Saw Cuengh"]],zu:[["Zulu"],["IsiZulu"]]};function d(x){return r[x][0][0]}function h(x){return r[x][1][0]}let v=o;for(const x of c)if(l.indexOf(x)!==-1){v=x;break}function p(){return v}function m(x=v){return x.match(/^(ar|dv|fa|ha|he|ks|ku|ms|pa|ps|sd|ug|yi)\b/i)?"rtl":"ltr"}function A(x){const P=[...document.querySelectorAll(".flippable-layout-stylesheet")];for(const T of P){let g=T.getAttribute("href");m(x)==="rtl"?g.indexOf(".rtl.css")===-1&&(g=g.replace(/\.css$/i,".rtl.css")):g.indexOf(".rtl.css")>-1&&(g=g.replace(/\.rtl\.css$/i,".css")),T.setAttribute("href",g);const _=document.createElement("img");_.onerror=()=>{$(()=>{$G.triggerHandler("theme-load")})},_.src=g}if(x===o){n={},v=o;return}(async T=>{const g=`../localization/${T}/localizations.js`;try{return(await import(g)).default}catch(_){console.error(`Failed to load localization for language ${T}`,_)}})(x).then(T=>{})}window.loaded_localizations=function(P,L){n=L,v=P};function y(x){showMessageBox({title:"Reload Required",message:"The application needs to reload to change the language.",buttons:[{label:s("OK"),value:"reload",default:!0},{label:s("Cancel"),value:"cancel"}],windowOptions:{innerWidth:450}}).then(P=>{P==="reload"&&are_you_sure(()=>{try{localStorage[e]=x,exit_fullscreen_if_ios(),location.reload()}catch(L){show_error_message("Failed to store language preference. Make sure cookies / local storage is enabled in your browser settings.",L)}})})}A(v),t.localize=s,t.set_language=y,t.get_language=p,t.get_iso_language_name=d,t.get_language_endonym=h,t.get_language_emoji=i,t.get_direction=m,t.available_languages=l})(window);console.log("JS ì¤í:","helpers.js");const TAU=- - - - - - - -Math.PI+Math.PI-0,is_pride_month=new Date().getMonth()===5,$G$1=$(window);function render_access_key(t){return`<span style="white-space: pre">${AccessKeys.toHTML(t)}</span>`}function make_css_cursor(t,n,s){return`url(images/cursors/${t}.png) ${n.join(" ")}, ${s}`}const E=function(n){return document.createElement(n)};function debounce(t,n,s){let e;const c=function(){const a=this,i=arguments,o=()=>{e=null,t.apply(a,i)};clearTimeout(e),e=setTimeout(o,n)};return c.cancel=()=>{clearTimeout(e)},c}function memoize_synchronous_function(t,n=5e4){const s={},e=[],c=(...a)=>{if(a.some(o=>o instanceof CanvasPattern))return t.apply(null,a);const i=JSON.stringify(a);if(s[i])return s[i];{const o=t.apply(null,a);if(s[i]=o,e.push(i),e.length>n){const l=e.shift();delete s[l]}return o}};return c.clear_memo_cache=()=>{for(const a of e)delete s[a];e.length=0},c}const get_rgba_from_color_implementation=t=>{const n=make_canvas(1,1);n.ctx.fillStyle=t,n.ctx.fillRect(0,0,1,1);const s=n.ctx.getImageData(0,0,1,1);return Array.from(s.data)},get_rgba_from_color=memoize_synchronous_function(get_rgba_from_color_implementation);function image_data_match(t,n,s){const e=t.data,c=n.data;if(e.length!==c.length)return!1;for(let a=e.length,i=0;i<a;i++)if(e[i]!==c[i]&&Math.abs(e[i]-c[i])>s)return!1;return!0}function make_canvas(t,n){const s=t,e=E("canvas"),c=e.getContext("2d");return e.ctx=c,c.disable_image_smoothing=()=>{c.imageSmoothingEnabled=!1,c.imageSmoothingEnabled!==!1&&(c.mozImageSmoothingEnabled=!1,c.webkitImageSmoothingEnabled=!1,c.msImageSmoothingEnabled=!1)},c.enable_image_smoothing=()=>{c.imageSmoothingEnabled=!0,c.imageSmoothingEnabled!==!0&&(c.mozImageSmoothingEnabled=!0,c.webkitImageSmoothingEnabled=!0,c.msImageSmoothingEnabled=!0)},c.copy=a=>{e.width=a.naturalWidth||a.width,e.height=a.naturalHeight||a.height,c.disable_image_smoothing(),a instanceof ImageData?c.putImageData(a,0,0):c.drawImage(a,0,0)},t&&n?(e.width=t,e.height=n,c.disable_image_smoothing()):s&&c.copy(s),e}function get_help_folder_icon(t){const n=new Image;return n.src=`help/${t}`,n}function get_icon_for_tool(t){return get_help_folder_icon(t.help_icon)}function load_image_simple(t){return new Promise((n,s)=>{const e=new Image;e.onload=()=>{n(e)},e.onerror=()=>{s(new Error(`failed to load image from ${t}`))},e.src=t})}function get_icon_for_tools(t){if(t.length===1)return get_icon_for_tool(t[0]);const n=make_canvas(16,16);return Promise.all(t.map(s=>load_image_simple(`help/${s.help_icon}`))).then(s=>{s.forEach((e,c)=>{const a=n.width/s.length,i=c*a,o=n.height,l=0;n.ctx.drawImage(e,i,l,a,o,i,l,a,o)})}),n}function get_file_extension(t){var n;return((n=t.match(/\.([^./]+)$/))==null?void 0:n[1])||""}function rgb_to_hsl(t,n,s){t/=255,n/=255,s/=255;var e=Math.max(t,n,s),c=Math.min(t,n,s),a,i,o=(e+c)/2;if(e==c)a=i=0;else{var l=e-c;switch(i=o>.5?l/(2-e-c):l/(e+c),e){case t:a=(n-s)/l+(n<s?6:0);break;case n:a=(s-t)/l+2;break;case s:a=(t-n)/l+4;break}a/=6}return[a,i,o]}function to_canvas_coords({clientX:t,clientY:n}){if(t===void 0||n===void 0)throw new TypeError("clientX and clientY must be defined (not {x, y} or x, y or [x, y])");const s=window.canvas_bounding_client_rect;return{x:~~((t-s.left)/s.width*main_canvas.width),y:~~((n-s.top)/s.height*main_canvas.height)}}function from_canvas_coords({x:t,y:n}){const s=window.canvas_bounding_client_rect;return{clientX:~~(t/main_canvas.width*s.width+s.left),clientY:~~(n/main_canvas.height*s.height+s.top)}}window.$G=$G$1;window.make_canvas=make_canvas;console.log("JS ì¤í:","$ToolWindow.js");function make_window_supporting_scale(t){const n=$Window(t),s=()=>{if(!n.is(".edit-colors-window, .storage-manager, .attributes-window, .flip-and-rotate, .stretch-and-skew"))return;const e=n.$content[0],c=n.$titlebar[0];let a=1;n.$content.css({transform:`scale(${a})`,transformOrigin:"0 0",marginRight:"",marginBottom:""}),document.body.classList.contains("eye-gaze-mode")&&(a=Math.min(innerWidth/e.offsetWidth,(innerHeight-c.offsetHeight)/e.offsetHeight),n.$content.css({transform:`scale(${a})`,transformOrigin:"0 0",marginRight:e.scrollWidth*(a-1)}),n.$content.css({marginBottom:e.scrollHeight*(a-1)}),n.center())};if(!t.$component){n.center();const e=()=>{requestAnimationFrame(s)},c=()=>{n.off("close",c),$G$1.off("eye-gaze-mode-toggled resize",e)};n.on("close",c),$G$1.on("eye-gaze-mode-toggled resize",e),e()}return t.$component&&n.$content.css({contain:"none"}),n}function $ToolWindow(t){return make_window_supporting_scale({$component:t,toolWindow:!0})}function $DialogWindow(t){const n=make_window_supporting_scale({title:t,resizable:!1,maximizeButton:!1,minimizeButton:!1});n.addClass("dialog-window"),n.$form=$(E("form")).appendTo(n.$content),n.$main=$(E("div")).appendTo(n.$form),n.$buttons=$(E("div")).appendTo(n.$form).addClass("button-group"),n.$Button=(e,c,a={type:"button"})=>{const i=$(E("button")).appendTo(n.$buttons);return i[0].append(e),i.on("click",()=>{c()}),i.on("pointerdown",()=>{i.focus()}),i.attr({type:a.type}),i},n.$form.on("submit",e=>{e.preventDefault()});function s(){n.find("button, input").removeClass("default");let e=$(document.activeElement).closest("button, input[type='submit'], input[type='button'], textarea, select");e.length===0&&(e=n.$form.find('button[type="submit"], input[type="submit"], button:not([type])').first()),e.is("button, input[type='submit'], input[type='button']")&&e.addClass("default")}return n.on("focusin",s),n.on("focusout",()=>{n.find("button, input").removeClass("default")}),setTimeout(()=>{s()},0),n}console.log("JS ì¤í:","msgbox.js");const exports$1={};function showMessageBox_implementation({title:t=window.defaultMessageBoxTitle??"Alert",message:n,messageHTML:s,buttons:e=[{label:"OK",value:"ok",default:!0}],iconID:c="warning",windowOptions:a={}}){let i,o;const l=new Promise(r=>{i=make_window_supporting_scale(Object.assign({title:t,resizable:!1,innerWidth:400,maximizeButton:!1,minimizeButton:!1},a)),o=$("<div>").css({textAlign:"left",fontFamily:"MS Sans Serif, Arial, sans-serif",fontSize:"14px",marginTop:"22px",flex:1,minWidth:0,whiteSpace:"normal"}),s?o.html(s):n&&o.text(n).css({whiteSpace:"pre-wrap",wordWrap:"break-word"}),$("<div>").append($("<img width='32' height='32'>").attr("src",`images/${c}-32x32-8bpp.png`).css({margin:"16px",display:"block"}),o).css({display:"flex",flexDirection:"row"}).appendTo(i.$content),i.$content.css({textAlign:"center"});for(const d of e){const h=i.$Button(d.label,()=>{var v;(v=d.action)==null||v.call(d),r(d.value),i.close()});d.default&&(h.addClass("default"),h.focus(),setTimeout(()=>h.focus(),0)),h.css({minWidth:75,height:23,margin:"16px 2px"})}i.on("focusin","button",d=>{$(d.currentTarget).addClass("default")}),i.on("focusout","button",d=>{$(d.currentTarget).removeClass("default")}),i.on("closed",()=>{r("closed")}),i.center()});return l.$window=i,l.$message=o,l.promise=l,l}exports$1.showMessageBox=window.showMessageBox||showMessageBox_implementation;window.defaultMessageBoxTitle=localize("Paint");const{showMessageBox:showMessageBox$1}=exports$1;window.showMessageBox=showMessageBox$1;let pdfjs;const pdfjs$1=pdfjs;(function(n,s){typeof exports=="object"&&typeof module=="object"?module.exports=s():typeof define=="function"&&define.amd?define("pdfjs-dist/build/pdf",[],s):typeof exports=="object"?exports["pdfjs-dist/build/pdf"]=s():(window["pdfjs-dist/build/pdf"]=window.pdfjsLib=s(),pdfjs=s())})(void 0,function(){return(()=>{var __webpack_modules__=[,(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.addLinkAttributes=m,n.deprecated=u,n.getFilenameFromUrl=x,n.getPdfFilenameFromUrl=P,n.isDataScheme=A,n.isFetchSupported=T,n.isPdfFile=y,n.isValidFetchUrl=g,n.loadScript=_,n.StatTimer=n.RenderingCancelledException=n.PDFDateString=n.PageViewport=n.LinkTarget=n.DOMSVGFactory=n.DOMCMapReaderFactory=n.DOMCanvasFactory=n.DEFAULT_LINK_REL=n.BaseCMapReaderFactory=n.BaseCanvasFactory=void 0;var e=s(2);const c="noopener noreferrer nofollow";n.DEFAULT_LINK_REL=c;const a="http://www.w3.org/2000/svg";class i{constructor(){this.constructor===i&&(0,e.unreachable)("Cannot initialize BaseCanvasFactory.")}create(R,C){(0,e.unreachable)("Abstract method `create` called.")}reset(R,C,D){if(!R.canvas)throw new Error("Canvas is not specified");if(C<=0||D<=0)throw new Error("Invalid canvas size");R.canvas.width=C,R.canvas.height=D}destroy(R){if(!R.canvas)throw new Error("Canvas is not specified");R.canvas.width=0,R.canvas.height=0,R.canvas=null,R.context=null}}n.BaseCanvasFactory=i;class o extends i{constructor({ownerDocument:R=globalThis.document}={}){super(),this._document=R}create(R,C){if(R<=0||C<=0)throw new Error("Invalid canvas size");const D=this._document.createElement("canvas"),B=D.getContext("2d");return D.width=R,D.height=C,{canvas:D,context:B}}}n.DOMCanvasFactory=o;class l{constructor({baseUrl:R=null,isCompressed:C=!1}){this.constructor===l&&(0,e.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=R,this.isCompressed=C}async fetch({name:R}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!R)throw new Error("CMap name must be specified.");const C=this.baseUrl+R+(this.isCompressed?".bcmap":""),D=this.isCompressed?e.CMapCompressionType.BINARY:e.CMapCompressionType.NONE;return this._fetchData(C,D).catch(B=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${C}`)})}_fetchData(R,C){(0,e.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=l;class r extends l{_fetchData(R,C){return T()&&g(R,document.baseURI)?fetch(R).then(async D=>{if(!D.ok)throw new Error(D.statusText);let B;return this.isCompressed?B=new Uint8Array(await D.arrayBuffer()):B=(0,e.stringToBytes)(await D.text()),{cMapData:B,compressionType:C}}):new Promise((D,B)=>{const Z=new XMLHttpRequest;Z.open("GET",R,!0),this.isCompressed&&(Z.responseType="arraybuffer"),Z.onreadystatechange=()=>{if(Z.readyState===XMLHttpRequest.DONE){if(Z.status===200||Z.status===0){let J;if(this.isCompressed&&Z.response?J=new Uint8Array(Z.response):!this.isCompressed&&Z.responseText&&(J=(0,e.stringToBytes)(Z.responseText)),J){D({cMapData:J,compressionType:C});return}}B(new Error(Z.statusText))}},Z.send(null)})}}n.DOMCMapReaderFactory=r;class d{create(R,C){(0,e.assert)(R>0&&C>0,"Invalid SVG dimensions");const D=document.createElementNS(a,"svg:svg");return D.setAttribute("version","1.1"),D.setAttribute("width",R+"px"),D.setAttribute("height",C+"px"),D.setAttribute("preserveAspectRatio","none"),D.setAttribute("viewBox","0 0 "+R+" "+C),D}createElement(R){return(0,e.assert)(typeof R=="string","Invalid SVG element type"),document.createElementNS(a,R)}}n.DOMSVGFactory=d;class h{constructor({viewBox:R,scale:C,rotation:D,offsetX:B=0,offsetY:Z=0,dontFlip:J=!1}){this.viewBox=R,this.scale=C,this.rotation=D,this.offsetX=B,this.offsetY=Z;const q=(R[2]+R[0])/2,z=(R[3]+R[1])/2;let w,N,G,V;switch(D%=360,D<0&&(D+=360),D){case 180:w=-1,N=0,G=0,V=1;break;case 90:w=0,N=1,G=1,V=0;break;case 270:w=0,N=-1,G=-1,V=0;break;case 0:w=1,N=0,G=0,V=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}J&&(G=-G,V=-V);let H,X,Q,ce;w===0?(H=Math.abs(z-R[1])*C+B,X=Math.abs(q-R[0])*C+Z,Q=Math.abs(R[3]-R[1])*C,ce=Math.abs(R[2]-R[0])*C):(H=Math.abs(q-R[0])*C+B,X=Math.abs(z-R[1])*C+Z,Q=Math.abs(R[2]-R[0])*C,ce=Math.abs(R[3]-R[1])*C),this.transform=[w*C,N*C,G*C,V*C,H-w*C*q-G*C*z,X-N*C*q-V*C*z],this.width=Q,this.height=ce}clone({scale:R=this.scale,rotation:C=this.rotation,offsetX:D=this.offsetX,offsetY:B=this.offsetY,dontFlip:Z=!1}={}){return new h({viewBox:this.viewBox.slice(),scale:R,rotation:C,offsetX:D,offsetY:B,dontFlip:Z})}convertToViewportPoint(R,C){return e.Util.applyTransform([R,C],this.transform)}convertToViewportRectangle(R){const C=e.Util.applyTransform([R[0],R[1]],this.transform),D=e.Util.applyTransform([R[2],R[3]],this.transform);return[C[0],C[1],D[0],D[1]]}convertToPdfPoint(R,C){return e.Util.applyInverseTransform([R,C],this.transform)}}n.PageViewport=h;class v extends e.BaseException{constructor(R,C){super(R),this.type=C}}n.RenderingCancelledException=v;const p={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};n.LinkTarget=p;function m(M,{url:R,target:C,rel:D,enabled:B=!0}={}){(0,e.assert)(R&&typeof R=="string",'addLinkAttributes: A valid "url" parameter must provided.');const Z=(0,e.removeNullCharacters)(R);B?M.href=M.title=Z:(M.href="",M.title=`Disabled: ${Z}`,M.onclick=()=>!1);let J="";switch(C){case p.NONE:break;case p.SELF:J="_self";break;case p.BLANK:J="_blank";break;case p.PARENT:J="_parent";break;case p.TOP:J="_top";break}M.target=J,M.rel=typeof D=="string"?D:c}function A(M){const R=M.length;let C=0;for(;C<R&&M[C].trim()==="";)C++;return M.substring(C,C+5).toLowerCase()==="data:"}function y(M){return typeof M=="string"&&/\.pdf$/i.test(M)}function x(M){const R=M.indexOf("#"),C=M.indexOf("?"),D=Math.min(R>0?R:M.length,C>0?C:M.length);return M.substring(M.lastIndexOf("/",D)+1,D)}function P(M,R="document.pdf"){if(typeof M!="string")return R;if(A(M))return(0,e.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),R;const C=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,D=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,B=C.exec(M);let Z=D.exec(B[1])||D.exec(B[2])||D.exec(B[3]);if(Z&&(Z=Z[0],Z.includes("%")))try{Z=D.exec(decodeURIComponent(Z))[0]}catch{}return Z||R}class L{constructor(){this.started=Object.create(null),this.times=[]}time(R){R in this.started&&(0,e.warn)(`Timer is already running for ${R}`),this.started[R]=Date.now()}timeEnd(R){R in this.started||(0,e.warn)(`Timer has not been started for ${R}`),this.times.push({name:R,start:this.started[R],end:Date.now()}),delete this.started[R]}toString(){const R=[];let C=0;for(const D of this.times){const B=D.name;B.length>C&&(C=B.length)}for(const D of this.times){const B=D.end-D.start;R.push(`${D.name.padEnd(C)} ${B}ms
`)}return R.join("")}}n.StatTimer=L;function T(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&typeof ReadableStream<"u"}function g(M,R){try{const{protocol:C}=R?new URL(M,R):new URL(M);return C==="http:"||C==="https:"}catch{return!1}}function _(M,R=!1){return new Promise((C,D)=>{const B=document.createElement("script");B.src=M,B.onload=function(Z){R&&B.remove(),C(Z)},B.onerror=function(){D(new Error(`Cannot load script at: ${B.src}`))},(document.head||document.documentElement).appendChild(B)})}function u(M){console.log("Deprecated API usage: "+M)}let b;class S{static toDateObject(R){if(!R||!(0,e.isString)(R))return null;b||(b=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const C=b.exec(R);if(!C)return null;const D=parseInt(C[1],10);let B=parseInt(C[2],10);B=B>=1&&B<=12?B-1:0;let Z=parseInt(C[3],10);Z=Z>=1&&Z<=31?Z:1;let J=parseInt(C[4],10);J=J>=0&&J<=23?J:0;let q=parseInt(C[5],10);q=q>=0&&q<=59?q:0;let z=parseInt(C[6],10);z=z>=0&&z<=59?z:0;const w=C[7]||"Z";let N=parseInt(C[8],10);N=N>=0&&N<=23?N:0;let G=parseInt(C[9],10)||0;return G=G>=0&&G<=59?G:0,w==="-"?(J+=N,q+=G):w==="+"&&(J-=N,q-=G),new Date(Date.UTC(D,B,Z,J,q,z))}}n.PDFDateString=S},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.arrayByteLength=ae,n.arraysToBytes=de,n.assert=J,n.bytesToString=F,n.createObjectURL=$e,n.createPromiseCapability=we,n.createValidAbsoluteUrl=w,n.escapeString=qe,n.getModificationDate=he,n.getVerbosityLevel=C,n.info=D,n.isArrayBuffer=re,n.isArrayEqual=ue,n.isAscii=Ge,n.isBool=Qe,n.isNum=je,n.isSameOrigin=q,n.isString=W,n.objectFromMap=se,n.objectSize=ee,n.removeNullCharacters=Y,n.setVerbosityLevel=R,n.shadow=N,n.string32=ve,n.stringToBytes=ie,n.stringToPDFString=Re,n.stringToUTF16BEString=Ye,n.stringToUTF8String=He,n.unreachable=Z,n.utf8StringToString=Xe,n.warn=B,n.VerbosityLevel=n.Util=n.UNSUPPORTED_FEATURES=n.UnknownErrorException=n.UnexpectedResponseException=n.TextRenderingMode=n.StreamType=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.IsLittleEndianCached=n.IsEvalSupportedCached=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FontType=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.AnnotationType=n.AnnotationStateModelType=n.AnnotationReviewState=n.AnnotationReplyType=n.AnnotationMarkedState=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,s(3);const e=[1,0,0,1,0,0];n.IDENTITY_MATRIX=e;const c=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=c;const a={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=a;const i={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=i;const o={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=o;const l={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=l;const r={MARKED:"Marked",REVIEW:"Review"};n.AnnotationStateModelType=r;const d={MARKED:"Marked",UNMARKED:"Unmarked"};n.AnnotationMarkedState=d;const h={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};n.AnnotationReviewState=h;const v={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=v;const p={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=p;const m={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=m;const A={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=A;const y={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=y;const x={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=x;const P={O:"PageOpen",C:"PageClose"};n.PageActionEventType=P;const L={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};n.StreamType=L;const T={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};n.FontType=T;const g={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=g;const _={NONE:0,BINARY:1,STREAM:2};n.CMapCompressionType=_;const u={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=u;const b={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent"};n.UNSUPPORTED_FEATURES=b;const S={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=S;let M=g.WARNINGS;function R(fe){Number.isInteger(fe)&&(M=fe)}function C(){return M}function D(fe){M>=g.INFOS&&console.log(`Info: ${fe}`)}function B(fe){M>=g.WARNINGS&&console.log(`Warning: ${fe}`)}function Z(fe){throw new Error(fe)}function J(fe,be){fe||Z(be)}function q(fe,be){let Ae;try{if(Ae=new URL(fe),!Ae.origin||Ae.origin==="null")return!1}catch{return!1}const De=new URL(be,Ae);return Ae.origin===De.origin}function z(fe){if(!fe)return!1;switch(fe.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function w(fe,be){if(!fe)return null;try{const Ae=be?new URL(fe,be):new URL(fe);if(z(Ae))return Ae}catch{}return null}function N(fe,be,Ae){return Object.defineProperty(fe,be,{value:Ae,enumerable:!0,configurable:!0,writable:!1}),Ae}const G=function(){function be(Ae){this.constructor===be&&Z("Cannot initialize BaseException."),this.message=Ae,this.name=this.constructor.name}return be.prototype=new Error,be.constructor=be,be}();n.BaseException=G;class V extends G{constructor(be,Ae){super(be),this.code=Ae}}n.PasswordException=V;class H extends G{constructor(be,Ae){super(be),this.details=Ae}}n.UnknownErrorException=H;class X extends G{}n.InvalidPDFException=X;class Q extends G{}n.MissingPDFException=Q;class ce extends G{constructor(be,Ae){super(be),this.status=Ae}}n.UnexpectedResponseException=ce;class pe extends G{}n.FormatError=pe;class _e extends G{}n.AbortException=_e;const xe=/\x00/g;function Y(fe){return typeof fe!="string"?(B("The argument for removeNullCharacters must be a string."),fe):fe.replace(xe,"")}function F(fe){J(fe!==null&&typeof fe=="object"&&fe.length!==void 0,"Invalid argument for bytesToString");const be=fe.length,Ae=8192;if(be<Ae)return String.fromCharCode.apply(null,fe);const De=[];for(let Ve=0;Ve<be;Ve+=Ae){const Ke=Math.min(Ve+Ae,be),Be=fe.subarray(Ve,Ke);De.push(String.fromCharCode.apply(null,Be))}return De.join("")}function ie(fe){J(typeof fe=="string","Invalid argument for stringToBytes");const be=fe.length,Ae=new Uint8Array(be);for(let De=0;De<be;++De)Ae[De]=fe.charCodeAt(De)&255;return Ae}function ae(fe){return fe.length!==void 0?fe.length:(J(fe.byteLength!==void 0,"arrayByteLength - invalid argument."),fe.byteLength)}function de(fe){const be=fe.length;if(be===1&&fe[0]instanceof Uint8Array)return fe[0];let Ae=0;for(let Ke=0;Ke<be;Ke++)Ae+=ae(fe[Ke]);let De=0;const Ve=new Uint8Array(Ae);for(let Ke=0;Ke<be;Ke++){let Be=fe[Ke];Be instanceof Uint8Array||(typeof Be=="string"?Be=ie(Be):Be=new Uint8Array(Be));const Ie=Be.byteLength;Ve.set(Be,De),De+=Ie}return Ve}function ve(fe){return String.fromCharCode(fe>>24&255,fe>>16&255,fe>>8&255,fe&255)}function ee(fe){return Object.keys(fe).length}function se(fe){const be=Object.create(null);for(const[Ae,De]of fe)be[Ae]=De;return be}function K(){const fe=new Uint8Array(4);return fe[0]=1,new Uint32Array(fe.buffer,0,1)[0]===1}const I={get value(){return N(this,"value",K())}};n.IsLittleEndianCached=I;function U(){try{return new Function(""),!0}catch{return!1}}const oe={get value(){return N(this,"value",U())}};n.IsEvalSupportedCached=oe;const ge=[...Array(256).keys()].map(fe=>fe.toString(16).padStart(2,"0"));class Se{static makeHexColor(be,Ae,De){return`#${ge[be]}${ge[Ae]}${ge[De]}`}static transform(be,Ae){return[be[0]*Ae[0]+be[2]*Ae[1],be[1]*Ae[0]+be[3]*Ae[1],be[0]*Ae[2]+be[2]*Ae[3],be[1]*Ae[2]+be[3]*Ae[3],be[0]*Ae[4]+be[2]*Ae[5]+be[4],be[1]*Ae[4]+be[3]*Ae[5]+be[5]]}static applyTransform(be,Ae){const De=be[0]*Ae[0]+be[1]*Ae[2]+Ae[4],Ve=be[0]*Ae[1]+be[1]*Ae[3]+Ae[5];return[De,Ve]}static applyInverseTransform(be,Ae){const De=Ae[0]*Ae[3]-Ae[1]*Ae[2],Ve=(be[0]*Ae[3]-be[1]*Ae[2]+Ae[2]*Ae[5]-Ae[4]*Ae[3])/De,Ke=(-be[0]*Ae[1]+be[1]*Ae[0]+Ae[4]*Ae[1]-Ae[5]*Ae[0])/De;return[Ve,Ke]}static getAxialAlignedBoundingBox(be,Ae){const De=Se.applyTransform(be,Ae),Ve=Se.applyTransform(be.slice(2,4),Ae),Ke=Se.applyTransform([be[0],be[3]],Ae),Be=Se.applyTransform([be[2],be[1]],Ae);return[Math.min(De[0],Ve[0],Ke[0],Be[0]),Math.min(De[1],Ve[1],Ke[1],Be[1]),Math.max(De[0],Ve[0],Ke[0],Be[0]),Math.max(De[1],Ve[1],Ke[1],Be[1])]}static inverseTransform(be){const Ae=be[0]*be[3]-be[1]*be[2];return[be[3]/Ae,-be[1]/Ae,-be[2]/Ae,be[0]/Ae,(be[2]*be[5]-be[4]*be[3])/Ae,(be[4]*be[1]-be[5]*be[0])/Ae]}static apply3dTransform(be,Ae){return[be[0]*Ae[0]+be[1]*Ae[1]+be[2]*Ae[2],be[3]*Ae[0]+be[4]*Ae[1]+be[5]*Ae[2],be[6]*Ae[0]+be[7]*Ae[1]+be[8]*Ae[2]]}static singularValueDecompose2dScale(be){const Ae=[be[0],be[2],be[1],be[3]],De=be[0]*Ae[0]+be[1]*Ae[2],Ve=be[0]*Ae[1]+be[1]*Ae[3],Ke=be[2]*Ae[0]+be[3]*Ae[2],Be=be[2]*Ae[1]+be[3]*Ae[3],Ie=(De+Be)/2,Ue=Math.sqrt((De+Be)**2-4*(De*Be-Ke*Ve))/2,et=Ie+Ue||1,nt=Ie-Ue||1;return[Math.sqrt(et),Math.sqrt(nt)]}static normalizeRect(be){const Ae=be.slice(0);return be[0]>be[2]&&(Ae[0]=be[2],Ae[2]=be[0]),be[1]>be[3]&&(Ae[1]=be[3],Ae[3]=be[1]),Ae}static intersect(be,Ae){function De(Ie,Ue){return Ie-Ue}const Ve=[be[0],be[2],Ae[0],Ae[2]].sort(De),Ke=[be[1],be[3],Ae[1],Ae[3]].sort(De),Be=[];if(be=Se.normalizeRect(be),Ae=Se.normalizeRect(Ae),Ve[0]===be[0]&&Ve[1]===Ae[0]||Ve[0]===Ae[0]&&Ve[1]===be[0])Be[0]=Ve[1],Be[2]=Ve[2];else return null;if(Ke[0]===be[1]&&Ke[1]===Ae[1]||Ke[0]===Ae[1]&&Ke[1]===be[1])Be[1]=Ke[1],Be[3]=Ke[2];else return null;return Be}}n.Util=Se;const Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Re(fe){const be=fe.length,Ae=[];if(fe[0]==="Ã¾"&&fe[1]==="Ã¿")for(let De=2;De<be;De+=2)Ae.push(String.fromCharCode(fe.charCodeAt(De)<<8|fe.charCodeAt(De+1)));else if(fe[0]==="Ã¿"&&fe[1]==="Ã¾")for(let De=2;De<be;De+=2)Ae.push(String.fromCharCode(fe.charCodeAt(De+1)<<8|fe.charCodeAt(De)));else for(let De=0;De<be;++De){const Ve=Ce[fe.charCodeAt(De)];Ae.push(Ve?String.fromCharCode(Ve):fe.charAt(De))}return Ae.join("")}function qe(fe){return fe.replace(/([()\\\n\r])/g,be=>be===`
`?"\\n":be==="\r"?"\\r":`\\${be}`)}function Ge(fe){return/^[\x00-\x7F]*$/.test(fe)}function Ye(fe){const be=["Ã¾Ã¿"];for(let Ae=0,De=fe.length;Ae<De;Ae++){const Ve=fe.charCodeAt(Ae);be.push(String.fromCharCode(Ve>>8&255)),be.push(String.fromCharCode(Ve&255))}return be.join("")}function He(fe){return decodeURIComponent(escape(fe))}function Xe(fe){return unescape(encodeURIComponent(fe))}function Qe(fe){return typeof fe=="boolean"}function je(fe){return typeof fe=="number"}function W(fe){return typeof fe=="string"}function re(fe){return typeof fe=="object"&&fe!==null&&fe.byteLength!==void 0}function ue(fe,be){if(fe.length!==be.length)return!1;for(let Ae=0,De=fe.length;Ae<De;Ae++)if(fe[Ae]!==be[Ae])return!1;return!0}function he(fe=new Date){return[fe.getUTCFullYear().toString(),(fe.getUTCMonth()+1).toString().padStart(2,"0"),fe.getUTCDate().toString().padStart(2,"0"),fe.getUTCHours().toString().padStart(2,"0"),fe.getUTCMinutes().toString().padStart(2,"0"),fe.getUTCSeconds().toString().padStart(2,"0")].join("")}function we(){const fe=Object.create(null);let be=!1;return Object.defineProperty(fe,"settled",{get(){return be}}),fe.promise=new Promise(function(Ae,De){fe.resolve=function(Ve){be=!0,Ae(Ve)},fe.reject=function(Ve){be=!0,De(Ve)}}),fe}function $e(fe,be="",Ae=!1){if(URL.createObjectURL&&!Ae)return URL.createObjectURL(new Blob([fe],{type:be}));const De="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let Ve=`data:${be};base64,`;for(let Ke=0,Be=fe.length;Ke<Be;Ke+=3){const Ie=fe[Ke]&255,Ue=fe[Ke+1]&255,et=fe[Ke+2]&255,nt=Ie>>2,lt=(Ie&3)<<4|Ue>>4,vt=Ke+1<Be?(Ue&15)<<2|et>>6:64,Ct=Ke+2<Be?et&63:64;Ve+=De[nt]+De[lt]+De[vt]+De[Ct]}return Ve}},(t,n,s)=>{s(4)},(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isNodeJS=void 0;const s=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=s},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultCMapReaderFactory=exports.DefaultCanvasFactory=exports.build=void 0;var _util=__w_pdfjs_require__(2),_display_utils=__w_pdfjs_require__(1),_font_loader=__w_pdfjs_require__(6),_node_utils=__w_pdfjs_require__(7),_annotation_storage=__w_pdfjs_require__(8),_api_compatibility=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(12),_is_node=__w_pdfjs_require__(4),_message_handler=__w_pdfjs_require__(13),_metadata=__w_pdfjs_require__(14),_optional_content_config=__w_pdfjs_require__(15),_transport_stream=__w_pdfjs_require__(16),_webgl=__w_pdfjs_require__(17);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DefaultCanvasFactory=_is_node.isNodeJS?_node_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_is_node.isNodeJS?_node_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let createPDFNetworkStream;function setPDFNetworkStreamFactory(t){createPDFNetworkStream=t}function getDocument(t){const n=new PDFDocumentLoadingTask;let s;if(typeof t=="string"||t instanceof URL)s={url:t};else if((0,_util.isArrayBuffer)(t))s={data:t};else if(t instanceof PDFDataRangeTransport)s={range:t};else{if(typeof t!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!t.url&&!t.data&&!t.range)throw new Error("Invalid parameter object: need either .data, .range or .url");s=t}const e=Object.create(null);let c=null,a=null;for(const o in s){const l=s[o];switch(o){case"url":if(typeof window<"u")try{e[o]=new URL(l,window.location).href;continue}catch(r){(0,_util.warn)(`Cannot create valid URL: "${r}".`)}else if(typeof l=="string"||l instanceof URL){e[o]=l.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":c=l;continue;case"worker":a=l;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&l instanceof Buffer)e[o]=new Uint8Array(l);else{if(l instanceof Uint8Array)break;if(typeof l=="string")e[o]=(0,_util.stringToBytes)(l);else if(typeof l=="object"&&l!==null&&!isNaN(l.length))e[o]=new Uint8Array(l);else if((0,_util.isArrayBuffer)(l))e[o]=new Uint8Array(l);else throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.")}continue}e[o]=l}if(e.rangeChunkSize=e.rangeChunkSize||DEFAULT_RANGE_CHUNK_SIZE,e.CMapReaderFactory=e.CMapReaderFactory||DefaultCMapReaderFactory,e.ignoreErrors=e.stopAtErrors!==!0,e.fontExtraProperties=e.fontExtraProperties===!0,e.pdfBug=e.pdfBug===!0,e.enableXfa=e.enableXfa===!0,(typeof e.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(e.docBaseUrl))&&(e.docBaseUrl=null),Number.isInteger(e.maxImageSize)||(e.maxImageSize=-1),typeof e.isEvalSupported!="boolean"&&(e.isEvalSupported=!0),typeof e.disableFontFace!="boolean"&&(e.disableFontFace=_api_compatibility.apiCompatibilityParams.disableFontFace||!1),typeof e.ownerDocument>"u"&&(e.ownerDocument=globalThis.document),typeof e.disableRange!="boolean"&&(e.disableRange=!1),typeof e.disableStream!="boolean"&&(e.disableStream=!1),typeof e.disableAutoFetch!="boolean"&&(e.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(e.verbosity),!a){const o={verbosity:e.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};a=o.port?PDFWorker.fromPort(o):new PDFWorker(o),n._worker=a}const i=n.docId;return a.promise.then(function(){if(n.destroyed)throw new Error("Loading aborted");const o=_fetchDocument(a,e,c,i),l=new Promise(function(r){let d;c?d=new _transport_stream.PDFDataTransportStream({length:e.length,initialData:e.initialData,progressiveDone:e.progressiveDone,contentDispositionFilename:e.contentDispositionFilename,disableRange:e.disableRange,disableStream:e.disableStream},c):e.data||(d=createPDFNetworkStream({url:e.url,length:e.length,httpHeaders:e.httpHeaders,withCredentials:e.withCredentials,rangeChunkSize:e.rangeChunkSize,disableRange:e.disableRange,disableStream:e.disableStream})),r(d)});return Promise.all([o,l]).then(function([r,d]){if(n.destroyed)throw new Error("Loading aborted");const h=new _message_handler.MessageHandler(i,r,a.port);h.postMessageTransfers=a.postMessageTransfers;const v=new WorkerTransport(h,n,d,e);n._transport=v,h.send("Ready",null)})}).catch(n._capability.reject),n}function _fetchDocument(t,n,s,e){return t.destroyed?Promise.reject(new Error("Worker was destroyed")):(s&&(n.length=s.length,n.initialData=s.initialData,n.progressiveDone=s.progressiveDone,n.contentDispositionFilename=s.contentDispositionFilename),t.messageHandler.sendWithPromise("GetDocRequest",{docId:e,apiVersion:"2.8.335",source:{data:n.data,url:n.url,password:n.password,disableAutoFetch:n.disableAutoFetch,rangeChunkSize:n.rangeChunkSize,length:n.length},maxImageSize:n.maxImageSize,disableFontFace:n.disableFontFace,postMessageTransfers:t.postMessageTransfers,docBaseUrl:n.docBaseUrl,ignoreErrors:n.ignoreErrors,isEvalSupported:n.isEvalSupported,fontExtraProperties:n.fontExtraProperties,enableXfa:n.enableXfa}).then(function(c){if(t.destroyed)throw new Error("Worker was destroyed");return c}))}const PDFDocumentLoadingTask=function(){let n=0;class s{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+n++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}destroy(){return this.destroyed=!0,(this._transport?this._transport.destroy():Promise.resolve()).then(()=>{this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}}return s}();class PDFDataRangeTransport{constructor(n,s,e=!1,c=null){this.length=n,this.initialData=s,this.progressiveDone=e,this.contentDispositionFilename=c,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(n){this._rangeListeners.push(n)}addProgressListener(n){this._progressListeners.push(n)}addProgressiveReadListener(n){this._progressiveReadListeners.push(n)}addProgressiveDoneListener(n){this._progressiveDoneListeners.push(n)}onDataRange(n,s){for(const e of this._rangeListeners)e(n,s)}onDataProgress(n,s){this._readyCapability.promise.then(()=>{for(const e of this._progressListeners)e(n,s)})}onDataProgressiveRead(n){this._readyCapability.promise.then(()=>{for(const s of this._progressiveReadListeners)s(n)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const n of this._progressiveDoneListeners)n()})}transportReady(){this._readyCapability.resolve()}requestDataRange(n,s){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(n,s){this._pdfInfo=n,this._transport=s}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get numPages(){return this._pdfInfo.numPages}get fingerprint(){return this._pdfInfo.fingerprint}get isPureXfa(){return this._pdfInfo.isPureXfa}getPage(n){return this._transport.getPage(n)}getPageIndex(n){return this._transport.getPageIndex(n)}getDestinations(){return this._transport.getDestinations()}getDestination(n){return this._transport.getDestination(n)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}getStats(){return this._transport.getStats()}cleanup(n=!1){return this._transport.startCleanup(n||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(n){return this._transport.saveDocument(n)}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(n,s,e,c,a=!1){this._pageIndex=n,this._pageInfo=s,this._ownerDocument=c,this._transport=e,this._stats=a?new _display_utils.StatTimer:null,this._pdfBug=a,this.commonObjs=e.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:n,rotation:s=this.rotate,offsetX:e=0,offsetY:c=0,dontFlip:a=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:n,rotation:s,offsetX:e,offsetY:c,dontFlip:a})}getAnnotations({intent:n=null}={}){return(!this._annotationsPromise||this._annotationsIntent!==n)&&(this._annotationsPromise=this._transport.getAnnotations(this._pageIndex,n),this._annotationsIntent=n),this._annotationsPromise}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}getXfa(){return this._xfaPromise||(this._xfaPromise=this._transport.getPageXfa(this._pageIndex))}render({canvasContext:n,viewport:s,intent:e="display",enableWebGL:c=!1,renderInteractiveForms:a=!1,transform:i=null,imageLayer:o=null,canvasFactory:l=null,background:r=null,annotationStorage:d=null,optionalContentConfigPromise:h=null}){var v;this._stats&&this._stats.time("Overall");const p=e==="print"?"print":"display";this.pendingCleanup=!1,h||(h=this._transport.getOptionalContentConfig());let m=this._intentStates.get(p);m||(m=Object.create(null),this._intentStates.set(p,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const A=l||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),y=new _webgl.WebGLContext({enable:c});m.displayReadyCapability||(m.displayReadyCapability=(0,_util.createPromiseCapability)(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:p,renderInteractiveForms:a===!0,annotationStorage:(d==null?void 0:d.serializable)||null}));const x=T=>{m.renderTasks.delete(P),(this.cleanupAfterRender||p==="print")&&(this.pendingCleanup=!0),this._tryCleanup(),T?(P.capability.reject(T),this._abortOperatorList({intentState:m,reason:T})):P.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},P=new InternalRenderTask({callback:x,params:{canvasContext:n,viewport:s,transform:i,imageLayer:o,background:r},objs:this.objs,commonObjs:this.commonObjs,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:A,webGLContext:y,useRequestAnimationFrame:p!=="print",pdfBug:this._pdfBug});((v=m).renderTasks||(v.renderTasks=new Set)).add(P);const L=P.task;return Promise.all([m.displayReadyCapability.promise,h]).then(([T,g])=>{if(this.pendingCleanup){x();return}this._stats&&this._stats.time("Rendering"),P.initializeGraphics({transparency:T,optionalContentConfig:g}),P.operatorListChanged()}).catch(x),L}getOperatorList(){function n(){e.operatorList.lastChunk&&(e.opListReadCapability.resolve(e.operatorList),e.renderTasks.delete(c))}const s="oplist";let e=this._intentStates.get(s);e||(e=Object.create(null),this._intentStates.set(s,e));let c;if(!e.opListReadCapability){var a;c=Object.create(null),c.operatorListChanged=n,e.opListReadCapability=(0,_util.createPromiseCapability)(),((a=e).renderTasks||(a.renderTasks=new Set)).add(c),e.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:s})}return e.opListReadCapability.promise}streamTextContent({normalizeWhitespace:n=!1,disableCombineTextItems:s=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,normalizeWhitespace:n===!0,combineTextItems:s!==!0},{highWaterMark:100,size(c){return c.items.length}})}getTextContent(n={}){const s=this.streamTextContent(n);return new Promise(function(e,c){function a(){i.read().then(function({value:l,done:r}){if(r){e(o);return}Object.assign(o.styles,l.styles),o.items.push(...l.items),a()},c)}const i=s.getReader(),o={items:[],styles:Object.create(null)};a()})}_destroy(){this.destroyed=!0,this._transport.pageCache[this._pageIndex]=null;const n=[];for(const[s,e]of this._intentStates)if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),s!=="oplist")for(const c of e.renderTasks)n.push(c.completed),c.cancel();return this.objs.clear(),this._annotationsPromise=null,this._jsActionsPromise=null,this._xfaPromise=null,this.pendingCleanup=!1,Promise.all(n)}cleanup(n=!1){return this.pendingCleanup=!0,this._tryCleanup(n)}_tryCleanup(n=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:s,operatorList:e}of this._intentStates.values())if(s.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this._annotationsPromise=null,this._jsActionsPromise=null,this._xfaPromise=null,n&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,!0}_startRenderPage(n,s){const e=this._intentStates.get(s);e&&(this._stats&&this._stats.timeEnd("Page Request"),e.displayReadyCapability&&e.displayReadyCapability.resolve(n))}_renderPageChunk(n,s){for(let e=0,c=n.length;e<c;e++)s.operatorList.fnArray.push(n.fnArray[e]),s.operatorList.argsArray.push(n.argsArray[e]);s.operatorList.lastChunk=n.lastChunk;for(const e of s.renderTasks)e.operatorListChanged();n.lastChunk&&this._tryCleanup()}_pumpOperatorList(n){(0,_util.assert)(n.intent,'PDFPageProxy._pumpOperatorList: Expected "intent" argument.');const e=this._transport.messageHandler.sendWithStream("GetOperatorList",n).getReader(),c=this._intentStates.get(n.intent);c.streamReader=e;const a=()=>{e.read().then(({value:i,done:o})=>{if(o){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(i,c),a())},i=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const o of c.renderTasks)o.operatorListChanged();this._tryCleanup()}if(c.displayReadyCapability)c.displayReadyCapability.reject(i);else if(c.opListReadCapability)c.opListReadCapability.reject(i);else throw i}})};a()}_abortOperatorList({intentState:n,reason:s,force:e=!1}){if((0,_util.assert)(s instanceof Error||typeof s=="object"&&s!==null,'PDFPageProxy._abortOperatorList: Expected "reason" argument.'),!!n.streamReader){if(!e){if(n.renderTasks.size>0)return;if(s instanceof _display_utils.RenderingCancelledException){n.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:n,reason:s,force:!0}),n.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(n.streamReader.cancel(new _util.AbortException(s==null?void 0:s.message)),n.streamReader=null,!this._transport.destroyed){for(const[c,a]of this._intentStates)if(a===n){this._intentStates.delete(c);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve(void 0)}postMessage(n,s){function e(i){var r;if(typeof i!="object"||i===null)return i;if(c.has(i))return c.get(i);let o,l;if((o=i.buffer)&&(0,_util.isArrayBuffer)(o))return s!=null&&s.includes(o)?l=new i.constructor(o,i.byteOffset,i.byteLength):l=new i.constructor(i),c.set(i,l),l;if(i instanceof Map){l=new Map,c.set(i,l);for(const[d,h]of i)l.set(d,e(h));return l}if(i instanceof Set){l=new Set,c.set(i,l);for(const d of i)l.add(e(d));return l}l=Array.isArray(i)?[]:{},c.set(i,l);for(const d in i){let h,v=i;for(;!(h=Object.getOwnPropertyDescriptor(v,d));)v=Object.getPrototypeOf(v);if(!(typeof h.value>"u")){if(typeof h.value=="function"){if((r=i.hasOwnProperty)!=null&&r.call(i,d))throw new Error(`LoopbackPort.postMessage - cannot clone: ${i[d]}`);continue}l[d]=e(h.value)}}return l}const c=new WeakMap,a={data:e(n)};this._deferred.then(()=>{for(const i of this._listeners)i.call(this,a)})}addEventListener(n,s){this._listeners.push(s)}removeEventListener(n,s){const e=this._listeners.indexOf(s);this._listeners.splice(e,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorker=function PDFWorkerClosure(){var t;const pdfWorkerPorts=new WeakMap;let isWorkerDisabled=!1,fallbackWorkerSrc,nextFakeWorkerId=0,fakeWorkerCapability;if(_is_node.isNodeJS&&typeof require=="function")isWorkerDisabled=!0,fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"&&"currentScript"in document){const n=(t=document.currentScript)==null?void 0:t.src;n&&(fallbackWorkerSrc=n.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}function getWorkerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(typeof fallbackWorkerSrc<"u")return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}function getMainThreadWorkerMessageHandler(){var s;let n;try{n=(s=globalThis.pdfjsWorker)==null?void 0:s.WorkerMessageHandler}catch{}return n||null}function setupFakeWorkerGlobal(){if(fakeWorkerCapability)return fakeWorkerCapability.promise;fakeWorkerCapability=(0,_util.createPromiseCapability)();const loader=async function(){const mainWorkerMessageHandler=getMainThreadWorkerMessageHandler();if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof require=="function"){const worker=eval("require")(getWorkerSrc());return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(getWorkerSrc()),window.pdfjsWorker.WorkerMessageHandler};return loader().then(fakeWorkerCapability.resolve,fakeWorkerCapability.reject),fakeWorkerCapability.promise}function createCDNWrapper(n){const s="importScripts('"+n+"');";return URL.createObjectURL(new Blob([s]))}class PDFWorker{constructor({name:s=null,port:e=null,verbosity:c=(0,_util.getVerbosityLevel)()}={}){if(e&&pdfWorkerPorts.has(e))throw new Error("Cannot use more than one PDFWorker per port");if(this.name=s,this.destroyed=!1,this.postMessageTransfers=!0,this.verbosity=c,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,e){pdfWorkerPorts.set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(s){this._port=s,this._messageHandler=new _message_handler.MessageHandler("main","worker",s),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(typeof Worker<"u"&&!isWorkerDisabled&&!getMainThreadWorkerMessageHandler()){let s=getWorkerSrc();try{(0,_util.isSameOrigin)(window.location.href,s)||(s=createCDNWrapper(new URL(s,window.location).href));const e=new Worker(s),c=new _message_handler.MessageHandler("main","worker",e),a=()=>{e.removeEventListener("error",i),c.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=()=>{this._webWorker||a()};e.addEventListener("error",i),c.on("test",l=>{if(e.removeEventListener("error",i),this.destroyed){a();return}l?(this._messageHandler=c,this._port=e,this._webWorker=e,l.supportTransfers||(this.postMessageTransfers=!1),this._readyCapability.resolve(),c.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),c.destroy(),e.terminate())}),c.on("ready",l=>{if(e.removeEventListener("error",i),this.destroyed){a();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const l=new Uint8Array([this.postMessageTransfers?255:0]);try{c.send("test",l,[l.buffer])}catch{(0,_util.warn)("Cannot use postMessage transfers."),l[0]=0,c.send("test",l)}};o();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),isWorkerDisabled=!0),setupFakeWorkerGlobal().then(s=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new LoopbackPort;this._port=e;const c="fake"+nextFakeWorkerId++,a=new _message_handler.MessageHandler(c+"_worker",c,e);s.setup(a,e);const i=new _message_handler.MessageHandler(c,c+"_worker",e);this._messageHandler=i,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})}).catch(s=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${s.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),pdfWorkerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(s){if(!s||!s.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return pdfWorkerPorts.has(s.port)?pdfWorkerPorts.get(s.port):new PDFWorker(s)}static getWorkerSrc(){return getWorkerSrc()}}return PDFWorker}();exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(n,s,e,c){this.messageHandler=n,this.loadingTask=s,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:s.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:c.ownerDocument}),this._params=c,this.CMapReaderFactory=new c.CMapReaderFactory({baseUrl:c.cMapUrl,isCompressed:c.cMapPacked}),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=e,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get loadingTaskSettled(){return this.loadingTask._capability.settled}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const n=[];this.pageCache.forEach(function(e){e&&n.push(e._destroy())}),this.pageCache.length=0,this.pagePromises.length=0;const s=this.messageHandler.sendWithPromise("Terminate",null);if(n.push(s),this.loadingTaskSettled){const e=this.loadingTask.promise.then(c=>{c.hasOwnProperty("annotationStorage")&&c.annotationStorage.resetModified()}).catch(()=>{});n.push(e)}return Promise.all(n).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:n,loadingTask:s}=this;n.on("GetReader",(e,c)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},c.onPull=()=>{this._fullReader.read().then(function({value:a,done:i}){if(i){c.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(a),"GetReader - expected an ArrayBuffer."),c.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{c.error(a)})},c.onCancel=a=>{this._fullReader.cancel(a),c.ready.catch(i=>{if(!this.destroyed)throw i})}}),n.on("ReaderHeadersReady",e=>{const c=(0,_util.createPromiseCapability)(),a=this._fullReader;return a.headersReady.then(()=>{(!a.isStreamingSupported||!a.isRangeSupported)&&(this._lastProgress&&s.onProgress&&s.onProgress(this._lastProgress),a.onProgress=i=>{s.onProgress&&s.onProgress({loaded:i.loaded,total:i.total})}),c.resolve({isStreamingSupported:a.isStreamingSupported,isRangeSupported:a.isRangeSupported,contentLength:a.contentLength})},c.reject),c.promise}),n.on("GetRangeReader",(e,c)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(e.begin,e.end);if(!a){c.close();return}c.onPull=()=>{a.read().then(function({value:i,done:o}){if(o){c.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(i),"GetRangeReader - expected an ArrayBuffer."),c.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{c.error(i)})},c.onCancel=i=>{a.cancel(i),c.ready.catch(o=>{if(!this.destroyed)throw o})}}),n.on("GetDoc",({pdfInfo:e})=>{this._numPages=e.numPages,s._capability.resolve(new PDFDocumentProxy(e,this))}),n.on("DocException",function(e){let c;switch(e.name){case"PasswordException":c=new _util.PasswordException(e.message,e.code);break;case"InvalidPDFException":c=new _util.InvalidPDFException(e.message);break;case"MissingPDFException":c=new _util.MissingPDFException(e.message);break;case"UnexpectedResponseException":c=new _util.UnexpectedResponseException(e.message,e.status);break;case"UnknownErrorException":c=new _util.UnknownErrorException(e.message,e.details);break}c instanceof Error||(0,_util.warn)("DocException - expected a valid Error."),s._capability.reject(c)}),n.on("PasswordRequest",e=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),s.onPassword){const c=a=>{this._passwordCapability.resolve({password:a})};try{s.onPassword(c,e.code)}catch(a){this._passwordCapability.reject(a)}}else this._passwordCapability.reject(new _util.PasswordException(e.message,e.code));return this._passwordCapability.promise}),n.on("DataLoaded",e=>{s.onProgress&&s.onProgress({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),n.on("StartRenderPage",e=>{if(this.destroyed)return;this.pageCache[e.pageIndex]._startRenderPage(e.transparency,e.intent)}),n.on("commonobj",e=>{var o;if(this.destroyed)return;const[c,a,i]=e;if(!this.commonObjs.has(c))switch(a){case"Font":const l=this._params;if("error"in i){const h=i.error;(0,_util.warn)(`Error during font loading: ${h}`),this.commonObjs.resolve(c,h);break}let r=null;l.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)&&(r={registerFont(h,v){globalThis.FontInspector.fontAdded(h,v)}});const d=new _font_loader.FontFaceObject(i,{isEvalSupported:l.isEvalSupported,disableFontFace:l.disableFontFace,ignoreErrors:l.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:r});this.fontLoader.bind(d).catch(h=>n.sendWithPromise("FontFallback",{id:c})).finally(()=>{!l.fontExtraProperties&&d.data&&(d.data=null),this.commonObjs.resolve(c,d)});break;case"FontPath":case"Image":this.commonObjs.resolve(c,i);break;default:throw new Error(`Got unknown common object type ${a}`)}}),n.on("obj",e=>{var r;if(this.destroyed)return;const[c,a,i,o]=e,l=this.pageCache[a];if(!l.objs.has(c))switch(i){case"Image":l.objs.resolve(c,o),((r=o==null?void 0:o.data)==null?void 0:r.length)>8e6&&(l.cleanupAfterRender=!0);break;default:throw new Error(`Got unknown object type ${i}`)}}),n.on("DocProgress",e=>{this.destroyed||s.onProgress&&s.onProgress({loaded:e.loaded,total:e.total})}),n.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),n.on("FetchBuiltInCMap",(e,c)=>{if(this.destroyed){c.error(new Error("Worker was destroyed"));return}let a=!1;c.onPull=()=>{if(a){c.close();return}a=!0,this.CMapReaderFactory.fetch(e).then(function(i){c.enqueue(i,1,[i.cMapData.buffer])}).catch(function(i){c.error(i)})}})}_onUnsupportedFeature({featureId:n}){this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(n)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(n){if(!Number.isInteger(n)||n<=0||n>this._numPages)return Promise.reject(new Error("Invalid page request"));const s=n-1;if(s in this.pagePromises)return this.pagePromises[s];const e=this.messageHandler.sendWithPromise("GetPage",{pageIndex:s}).then(c=>{if(this.destroyed)throw new Error("Transport destroyed");const a=new PDFPageProxy(s,c,this,this._params.ownerDocument,this._params.pdfBug);return this.pageCache[s]=a,a});return this.pagePromises[s]=e,e}getPageIndex(n){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:n}).catch(function(s){return Promise.reject(new Error(s))})}getAnnotations(n,s){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:n,intent:s})}saveDocument(n){var s;return this.messageHandler.sendWithPromise("SaveDocument",{numPages:this._numPages,annotationStorage:(n==null?void 0:n.serializable)||null,filename:((s=this._fullReader)==null?void 0:s.filename)??null}).finally(()=>{n&&n.resetModified()})}getFieldObjects(){return this.messageHandler.sendWithPromise("GetFieldObjects",null)}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(n){return typeof n!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:n})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(n){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:n})}getPageXfa(n){return this.messageHandler.sendWithPromise("GetPageXfa",{pageIndex:n})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(n=>new _optional_content_config.OptionalContentConfig(n))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.messageHandler.sendWithPromise("GetMetadata",null).then(n=>{var s,e;return{info:n[0],metadata:n[1]?new _metadata.Metadata(n[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((e=this._fullReader)==null?void 0:e.contentLength)??null}})}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}getStats(){return this.messageHandler.sendWithPromise("GetStats",null)}async startCleanup(n=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(let s=0,e=this.pageCache.length;s<e;s++){const c=this.pageCache[s];if(!c)continue;if(!c.cleanup())throw new Error(`startCleanup: Page ${s+1} is currently rendering.`)}this.commonObjs.clear(),n||this.fontLoader.clear(),this._hasJSActionsPromise=null}}get loadingParams(){const n=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:n.disableAutoFetch,disableFontFace:n.disableFontFace})}}class PDFObjects{constructor(){this._objs=Object.create(null)}_ensureObj(n){return this._objs[n]?this._objs[n]:this._objs[n]={capability:(0,_util.createPromiseCapability)(),data:null,resolved:!1}}get(n,s=null){if(s)return this._ensureObj(n).capability.promise.then(s),null;const e=this._objs[n];if(!e||!e.resolved)throw new Error(`Requesting object that isn't resolved yet ${n}.`);return e.data}has(n){const s=this._objs[n];return(s==null?void 0:s.resolved)||!1}resolve(n,s){const e=this._ensureObj(n);e.resolved=!0,e.data=s,e.capability.resolve(s)}clear(){this._objs=Object.create(null)}}class RenderTask{constructor(n){this._internalRenderTask=n,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}const InternalRenderTask=function t(){const n=new WeakSet;class s{constructor({callback:c,params:a,objs:i,commonObjs:o,operatorList:l,pageIndex:r,canvasFactory:d,webGLContext:h,useRequestAnimationFrame:v=!1,pdfBug:p=!1}){this.callback=c,this.params=a,this.objs=i,this.commonObjs=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=r,this.canvasFactory=d,this.webGLContext=h,this._pdfBug=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=v===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=a.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:c=!1,optionalContentConfig:a}){var h;if(this.cancelled)return;if(this._canvas){if(n.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");n.add(this._canvas)}this._pdfBug&&((h=globalThis.StepperManager)!=null&&h.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:o,transform:l,imageLayer:r,background:d}=this.params;this.gfx=new _canvas.CanvasGraphics(i,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext,r,a),this.gfx.beginDrawing({transform:l,viewport:o,transparency:c,background:d}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(c=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&n.delete(this._canvas),this.callback(c||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&n.delete(this._canvas),this.callback())))}}return s}(),version="2.8.335";exports.version=version;const build="228adbf67";exports.build=build},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var e=s(2);class c{constructor({docId:l,onUnsupportedFeature:r,ownerDocument:d=globalThis.document}){this.constructor===c&&(0,e.unreachable)("Cannot initialize BaseFontLoader."),this.docId=l,this._onUnsupportedFeature=r,this._document=d,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(l){this.nativeFontFaces.push(l),this._document.fonts.add(l)}insertRule(l){let r=this.styleElement;r||(r=this.styleElement=this._document.createElement("style"),r.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].appendChild(r));const d=r.sheet;d.insertRule(l,d.cssRules.length)}clear(){this.nativeFontFaces.forEach(l=>{this._document.fonts.delete(l)}),this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(l){if(l.attached||l.missingFile)return;if(l.attached=!0,this.isFontLoadingAPISupported){const d=l.createNativeFontFace();if(d){this.addNativeFontFace(d);try{await d.loaded}catch(h){throw this._onUnsupportedFeature({featureId:e.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,e.warn)(`Failed to load font '${d.family}': '${h}'.`),l.disableFontFace=!0,h}}return}const r=l.createFontFaceRule();if(r){if(this.insertRule(r),this.isSyncFontLoadingSupported)return;await new Promise(d=>{const h=this._queueLoadingCallback(d);this._prepareFontLoadEvent([r],[l],h)})}}_queueLoadingCallback(l){(0,e.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var l;return(0,e.shadow)(this,"isFontLoadingAPISupported",!!((l=this._document)!=null&&l.fonts))}get isSyncFontLoadingSupported(){(0,e.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,e.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(l,r,d){(0,e.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let a;n.FontLoader=a,n.FontLoader=a=class extends c{constructor(l){super(l),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let l=!1;if(typeof navigator>"u")l=!0;else{const r=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(r==null?void 0:r[1])>=14&&(l=!0)}return(0,e.shadow)(this,"isSyncFontLoadingSupported",l)}_queueLoadingCallback(l){function r(){for((0,e.assert)(!h.done,"completeRequest() cannot be called twice."),h.done=!0;d.requests.length>0&&d.requests[0].done;){const v=d.requests.shift();setTimeout(v.callback,0)}}const d=this.loadingContext,h={id:`pdfjs-font-loading-${d.nextRequestId++}`,done:!1,complete:r,callback:l};return d.requests.push(h),h}get _loadTestFont(){const l=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,e.shadow)(this,"_loadTestFont",l())}_prepareFontLoadEvent(l,r,d){function h(D,B){return D.charCodeAt(B)<<24|D.charCodeAt(B+1)<<16|D.charCodeAt(B+2)<<8|D.charCodeAt(B+3)&255}function v(D,B,Z,J){const q=D.substring(0,B),z=D.substring(B+Z);return q+J+z}let p,m;const A=this._document.createElement("canvas");A.width=1,A.height=1;const y=A.getContext("2d");let x=0;function P(D,B){if(x++,x>30){(0,e.warn)("Load test font never loaded."),B();return}if(y.font="30px "+D,y.fillText(".",0,20),y.getImageData(0,0,1,1).data[3]>0){B();return}setTimeout(P.bind(null,D,B))}const L=`lt${Date.now()}${this.loadTestFontId++}`;let T=this._loadTestFont;T=v(T,976,L.length,L);const _=16,u=1482184792;let b=h(T,_);for(p=0,m=L.length-3;p<m;p+=4)b=b-u+h(L,p)|0;p<L.length&&(b=b-u+h(L+"XXX",p)|0),T=v(T,_,4,(0,e.string32)(b));const S=`url(data:font/opentype;base64,${btoa(T)});`,M=`@font-face {font-family:"${L}";src:${S}}`;this.insertRule(M);const R=[];for(p=0,m=r.length;p<m;p++)R.push(r[p].loadedName);R.push(L);const C=this._document.createElement("div");for(C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px",p=0,m=R.length;p<m;++p){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=R[p],C.appendChild(D)}this._document.body.appendChild(C),P(L,()=>{this._document.body.removeChild(C),d.complete()})}};class i{constructor(l,{isEvalSupported:r=!0,disableFontFace:d=!1,ignoreErrors:h=!1,onUnsupportedFeature:v,fontRegistry:p=null}){this.compiledGlyphs=Object.create(null);for(const m in l)this[m]=l[m];this.isEvalSupported=r!==!1,this.disableFontFace=d===!0,this.ignoreErrors=h===!0,this._onUnsupportedFeature=v,this.fontRegistry=p}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;const l=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),l}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const l=(0,e.bytesToString)(new Uint8Array(this.data)),r=`url(data:${this.mimetype};base64,${btoa(l)});`,d=`@font-face {font-family:"${this.loadedName}";src:${r}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,r),d}getPathGenerator(l,r){if(this.compiledGlyphs[r]!==void 0)return this.compiledGlyphs[r];let d,h;try{d=l.get(this.loadedName+"_path_"+r)}catch(v){if(!this.ignoreErrors)throw v;return this._onUnsupportedFeature({featureId:e.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,e.warn)(`getPathGenerator - ignoring character: "${v}".`),this.compiledGlyphs[r]=function(p,m){}}if(this.isEvalSupported&&e.IsEvalSupportedCached.value){let v,p="";for(let m=0,A=d.length;m<A;m++)h=d[m],h.args!==void 0?v=h.args.join(","):v="",p+="c."+h.cmd+"("+v+`);
`;return this.compiledGlyphs[r]=new Function("c","size",p)}return this.compiledGlyphs[r]=function(v,p){for(let m=0,A=d.length;m<A;m++)h=d[m],h.cmd==="scale"&&(h.args=[p,-p]),v[h.cmd].apply(v,h.args)}}}n.FontFaceObject=i},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeCMapReaderFactory=n.NodeCanvasFactory=void 0;var e=s(1),c=s(4),a=s(2);let i=class{constructor(){(0,a.unreachable)("Not implemented: NodeCanvasFactory")}};n.NodeCanvasFactory=i;let o=class{constructor(){(0,a.unreachable)("Not implemented: NodeCMapReaderFactory")}};n.NodeCMapReaderFactory=o,c.isNodeJS&&(n.NodeCanvasFactory=i=class extends e.BaseCanvasFactory{create(l,r){if(l<=0||r<=0)throw new Error("Invalid canvas size");const h=require("canvas").createCanvas(l,r);return{canvas:h,context:h.getContext("2d")}}},n.NodeCMapReaderFactory=o=class extends e.BaseCMapReaderFactory{_fetchData(l,r){return new Promise((d,h)=>{require("fs").readFile(l,(p,m)=>{if(p||!m){h(new Error(p));return}d({cMapData:new Uint8Array(m),compressionType:r})})})}})},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationStorage=void 0;var e=s(1),c=s(2);class a{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(o,l){const r=this._storage.get(o);return r!==void 0?r:l}getOrCreateValue(o,l){return(0,e.deprecated)("Use getValue instead."),this._storage.has(o)?this._storage.get(o):(this._storage.set(o,l),l)}setValue(o,l){const r=this._storage.get(o);let d=!1;if(r!==void 0)for(const[h,v]of Object.entries(l))r[h]!==v&&(d=!0,r[h]=v);else this._storage.set(o,l),d=!0;d&&this._setModified()}getAll(){return this._storage.size>0?(0,c.objectFromMap)(this._storage):null}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get serializable(){return this._storage.size>0?this._storage:null}}n.AnnotationStorage=a},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.apiCompatibilityParams=void 0;var e=s(4);const c=Object.create(null);(function(){e.isNodeJS&&(c.disableFontFace=!0)})();const a=Object.freeze(c);n.apiCompatibilityParams=a},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var e=s(2),c=s(11);const a=16,i=100,o=4096,l=1e3,r=16,d=1.000001;function h(y){if(!y.mozCurrentTransform){y._originalSave=y.save,y._originalRestore=y.restore,y._originalRotate=y.rotate,y._originalScale=y.scale,y._originalTranslate=y.translate,y._originalTransform=y.transform,y._originalSetTransform=y.setTransform,y._originalResetTransform=y.resetTransform,y._transformMatrix=y._transformMatrix||[1,0,0,1,0,0],y._transformStack=[];try{const x=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(y),"lineWidth");y._setLineWidth=x.set,y._getLineWidth=x.get,Object.defineProperty(y,"lineWidth",{set:function(L){this._setLineWidth(L*d)},get:function(){return this._getLineWidth()}})}catch{}Object.defineProperty(y,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(y,"mozCurrentTransformInverse",{get:function(){const P=this._transformMatrix,L=P[0],T=P[1],g=P[2],_=P[3],u=P[4],b=P[5],S=L*_-T*g,M=T*g-L*_;return[_/S,T/M,g/M,L/S,(_*u-g*b)/M,(T*u-L*b)/S]}}),y.save=function(){const P=this._transformMatrix;this._transformStack.push(P),this._transformMatrix=P.slice(0,6),this._originalSave()},y.restore=function(){const P=this._transformStack.pop();P&&(this._transformMatrix=P,this._originalRestore())},y.translate=function(P,L){const T=this._transformMatrix;T[4]=T[0]*P+T[2]*L+T[4],T[5]=T[1]*P+T[3]*L+T[5],this._originalTranslate(P,L)},y.scale=function(P,L){const T=this._transformMatrix;T[0]=T[0]*P,T[1]=T[1]*P,T[2]=T[2]*L,T[3]=T[3]*L,this._originalScale(P,L)},y.transform=function(P,L,T,g,_,u){const b=this._transformMatrix;this._transformMatrix=[b[0]*P+b[2]*L,b[1]*P+b[3]*L,b[0]*T+b[2]*g,b[1]*T+b[3]*g,b[0]*_+b[2]*u+b[4],b[1]*_+b[3]*u+b[5]],y._originalTransform(P,L,T,g,_,u)},y.setTransform=function(P,L,T,g,_,u){this._transformMatrix=[P,L,T,g,_,u],y._originalSetTransform(P,L,T,g,_,u)},y.resetTransform=function(){this._transformMatrix=[1,0,0,1,0,0],y._originalResetTransform()},y.rotate=function(P){const L=Math.cos(P),T=Math.sin(P),g=this._transformMatrix;this._transformMatrix=[g[0]*L+g[2]*T,g[1]*L+g[3]*T,g[0]*-T+g[2]*L,g[1]*-T+g[3]*L,g[4],g[5]],this._originalRotate(P)}}}const v=function(){function x(P){this.canvasFactory=P,this.cache=Object.create(null)}return x.prototype={getCanvas:function(L,T,g,_){let u;return this.cache[L]!==void 0?(u=this.cache[L],this.canvasFactory.reset(u,T,g),u.context.setTransform(1,0,0,1,0,0)):(u=this.canvasFactory.create(T,g),this.cache[L]=u),_&&h(u.context),u},clear(){for(const P in this.cache){const L=this.cache[P];this.canvasFactory.destroy(L),delete this.cache[P]}}},x}();function p(y){const P=y.width,L=y.height,T=P+1;let g,_,u,b;const S=new Uint8Array(T*(L+1)),M=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),R=P+7&-8,C=y.data,D=new Uint8Array(R*L);let B=0;for(g=0,_=C.length;g<_;g++){const w=C[g];let N=128;for(;N>0;)D[B++]=w&N?0:255,N>>=1}let Z=0;for(B=0,D[B]!==0&&(S[0]=1,++Z),u=1;u<P;u++)D[B]!==D[B+1]&&(S[u]=D[B]?2:1,++Z),B++;for(D[B]!==0&&(S[u]=2,++Z),g=1;g<L;g++){B=g*R,b=g*T,D[B-R]!==D[B]&&(S[b]=D[B]?1:8,++Z);let w=(D[B]?4:0)+(D[B-R]?8:0);for(u=1;u<P;u++)w=(w>>2)+(D[B+1]?4:0)+(D[B-R+1]?8:0),M[w]&&(S[b+u]=M[w],++Z),B++;if(D[B-R]!==D[B]&&(S[b+u]=D[B]?2:4,++Z),Z>1e3)return null}for(B=R*(L-1),b=g*T,D[B]!==0&&(S[b]=8,++Z),u=1;u<P;u++)D[B]!==D[B+1]&&(S[b+u]=D[B]?4:8,++Z),B++;if(D[B]!==0&&(S[b+u]=4,++Z),Z>1e3)return null;const J=new Int32Array([0,T,-1,0,-T,0,0,0,1]),q=[];for(g=0;Z&&g<=L;g++){let w=g*T;const N=w+P;for(;w<N&&!S[w];)w++;if(w===N)continue;const G=[w%T,g],V=w;let H=S[w];do{const X=J[H];do w+=X;while(!S[w]);const Q=S[w];Q!==5&&Q!==10?(H=Q,S[w]=0):(H=Q&51*H>>4,S[w]&=H>>2|H<<2),G.push(w%T),G.push(w/T|0),S[w]||--Z}while(V!==w);q.push(G),--g}return function(w){w.save(),w.scale(1/P,-1/L),w.translate(0,-L),w.beginPath();for(let N=0,G=q.length;N<G;N++){const V=q[N];w.moveTo(V[0],V[1]);for(let H=2,X=V.length;H<X;H+=2)w.lineTo(V[H],V[H+1])}w.fill(),w.beginPath(),w.restore()}}const m=function(){function x(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=e.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=e.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=e.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null,this.transferMaps=null}return x.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(L,T){this.x=L,this.y=T}},x}(),A=function(){function L(q,z,w,N,G,V,H){this.ctx=q,this.current=new m,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=z,this.objs=w,this.canvasFactory=N,this.webGLContext=G,this.imageLayer=V,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=H,this.cachedCanvases=new v(this.canvasFactory),q&&h(q),this._cachedGetSinglePixelWidth=null}function T(q,z,w=null){if(typeof ImageData<"u"&&z instanceof ImageData){q.putImageData(z,0,0);return}const N=z.height,G=z.width,V=N%r,H=(N-V)/r,X=V===0?H:H+1,Q=q.createImageData(G,r);let ce=0,pe;const _e=z.data,xe=Q.data;let Y,F,ie,ae,de,ve,ee,se;if(w)switch(w.length){case 1:de=w[0],ve=w[0],ee=w[0],se=w[0];break;case 4:de=w[0],ve=w[1],ee=w[2],se=w[3];break}if(z.kind===e.ImageKind.GRAYSCALE_1BPP){const K=_e.byteLength,I=new Uint32Array(xe.buffer,0,xe.byteLength>>2),U=I.length,oe=G+7>>3;let ge=4294967295,Se=e.IsLittleEndianCached.value?4278190080:255;for(se&&se[0]===255&&se[255]===0&&([ge,Se]=[Se,ge]),Y=0;Y<X;Y++){for(ie=Y<H?r:V,pe=0,F=0;F<ie;F++){const Ce=K-ce;let Re=0;const qe=Ce>oe?G:Ce*8-7,Ge=qe&-8;let Ye=0,He=0;for(;Re<Ge;Re+=8)He=_e[ce++],I[pe++]=He&128?ge:Se,I[pe++]=He&64?ge:Se,I[pe++]=He&32?ge:Se,I[pe++]=He&16?ge:Se,I[pe++]=He&8?ge:Se,I[pe++]=He&4?ge:Se,I[pe++]=He&2?ge:Se,I[pe++]=He&1?ge:Se;for(;Re<qe;Re++)Ye===0&&(He=_e[ce++],Ye=128),I[pe++]=He&Ye?ge:Se,Ye>>=1}for(;pe<U;)I[pe++]=0;q.putImageData(Q,0,Y*r)}}else if(z.kind===e.ImageKind.RGBA_32BPP){const K=!!(de||ve||ee);for(F=0,ae=G*r*4,Y=0;Y<H;Y++){if(xe.set(_e.subarray(ce,ce+ae)),ce+=ae,K)for(let I=0;I<ae;I+=4)de&&(xe[I+0]=de[xe[I+0]]),ve&&(xe[I+1]=ve[xe[I+1]]),ee&&(xe[I+2]=ee[xe[I+2]]);q.putImageData(Q,0,F),F+=r}if(Y<X){if(ae=G*V*4,xe.set(_e.subarray(ce,ce+ae)),K)for(let I=0;I<ae;I+=4)de&&(xe[I+0]=de[xe[I+0]]),ve&&(xe[I+1]=ve[xe[I+1]]),ee&&(xe[I+2]=ee[xe[I+2]]);q.putImageData(Q,0,F)}}else if(z.kind===e.ImageKind.RGB_24BPP){const K=!!(de||ve||ee);for(ie=r,ae=G*ie,Y=0;Y<X;Y++){for(Y>=H&&(ie=V,ae=G*ie),pe=0,F=ae;F--;)xe[pe++]=_e[ce++],xe[pe++]=_e[ce++],xe[pe++]=_e[ce++],xe[pe++]=255;if(K)for(let I=0;I<pe;I+=4)de&&(xe[I+0]=de[xe[I+0]]),ve&&(xe[I+1]=ve[xe[I+1]]),ee&&(xe[I+2]=ee[xe[I+2]]);q.putImageData(Q,0,Y*r)}}else throw new Error(`bad image kind: ${z.kind}`)}function g(q,z){const w=z.height,N=z.width,G=w%r,V=(w-G)/r,H=G===0?V:V+1,X=q.createImageData(N,r);let Q=0;const ce=z.data,pe=X.data;for(let _e=0;_e<H;_e++){const xe=_e<V?r:G;let Y=3;for(let F=0;F<xe;F++){let ie,ae=0;for(let de=0;de<N;de++)ae||(ie=ce[Q++],ae=128),pe[Y]=ie&ae?0:255,Y+=4,ae>>=1}q.putImageData(X,0,_e*r)}}function _(q,z){const w=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let N=0,G=w.length;N<G;N++){const V=w[N];q[V]!==void 0&&(z[V]=q[V])}q.setLineDash!==void 0&&(z.setLineDash(q.getLineDash()),z.lineDashOffset=q.lineDashOffset)}function u(q){q.strokeStyle="#000000",q.fillStyle="#000000",q.fillRule="nonzero",q.globalAlpha=1,q.lineWidth=1,q.lineCap="butt",q.lineJoin="miter",q.miterLimit=10,q.globalCompositeOperation="source-over",q.font="10px sans-serif",q.setLineDash!==void 0&&(q.setLineDash([]),q.lineDashOffset=0)}function b(q,z,w,N){const G=q.length;for(let V=3;V<G;V+=4){const H=q[V];if(H===0)q[V-3]=z,q[V-2]=w,q[V-1]=N;else if(H<255){const X=255-H;q[V-3]=q[V-3]*H+z*X>>8,q[V-2]=q[V-2]*H+w*X>>8,q[V-1]=q[V-1]*H+N*X>>8}}}function S(q,z,w){const N=q.length,G=1/255;for(let V=3;V<N;V+=4){const H=w?w[q[V]]:q[V];z[V]=z[V]*H*G|0}}function M(q,z,w){const N=q.length;for(let G=3;G<N;G+=4){const V=q[G-3]*77+q[G-2]*152+q[G-1]*28;z[G]=w?z[G]*w[V>>8]>>8:z[G]*V>>16}}function R(q,z,w,N,G,V,H){const X=!!V,Q=X?V[0]:0,ce=X?V[1]:0,pe=X?V[2]:0;let _e;G==="Luminosity"?_e=M:_e=S;const Y=Math.min(N,Math.ceil(1048576/w));for(let F=0;F<N;F+=Y){const ie=Math.min(Y,N-F),ae=q.getImageData(0,F,w,ie),de=z.getImageData(0,F,w,ie);X&&b(ae.data,Q,ce,pe),_e(ae.data,de.data,H),q.putImageData(de,0,F)}}function C(q,z,w,N){const G=z.canvas,V=z.context;q.setTransform(z.scaleX,0,0,z.scaleY,z.offsetX,z.offsetY);const H=z.backdrop||null;if(!z.transferMap&&N.isEnabled){const X=N.composeSMask({layer:w.canvas,mask:G,properties:{subtype:z.subtype,backdrop:H}});q.setTransform(1,0,0,1,0,0),q.drawImage(X,z.offsetX,z.offsetY);return}R(V,w,G.width,G.height,z.subtype,H,z.transferMap),q.drawImage(G,0,0)}const D=["butt","round","square"],B=["miter","round","bevel"],Z={},J={};L.prototype={beginDrawing({transform:q,viewport:z,transparency:w=!1,background:N=null}){const G=this.ctx.canvas.width,V=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=N||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,G,V),this.ctx.restore(),w){const H=this.cachedCanvases.getCanvas("transparent",G,V,!0);this.compositeCtx=this.ctx,this.transparentCanvas=H.canvas,this.ctx=H.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),u(this.ctx),q&&this.ctx.transform.apply(this.ctx,q),this.ctx.transform.apply(this.ctx,z.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this._combinedScaleFactor=Math.hypot(this.baseTransform[0],this.baseTransform[2]),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(z,w,N,G){const V=z.argsArray,H=z.fnArray;let X=w||0;const Q=V.length;if(Q===X)return X;const ce=Q-X>10&&typeof N=="function",pe=ce?Date.now()+15:0;let _e=0;const xe=this.commonObjs,Y=this.objs;let F;for(;;){if(G!==void 0&&X===G.nextBreakPoint)return G.breakIt(X,N),X;if(F=H[X],F!==e.OPS.dependency)this[F].apply(this,V[X]);else for(const ie of V[X]){const ae=ie.startsWith("g_")?xe:Y;if(!ae.has(ie))return ae.get(ie,N),X}if(X++,X===Q)return X;if(ce&&++_e>10){if(Date.now()>pe)return N(),X;_e=0}}},endDrawing:function(){for(;this.stateStack.length||this.current.activeSMask!==null;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.webGLContext.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(z){this.current.lineWidth=z,this.ctx.lineWidth=z},setLineCap:function(z){this.ctx.lineCap=D[z]},setLineJoin:function(z){this.ctx.lineJoin=B[z]},setMiterLimit:function(z){this.ctx.miterLimit=z},setDash:function(z,w){const N=this.ctx;N.setLineDash!==void 0&&(N.setLineDash(z),N.lineDashOffset=w)},setRenderingIntent(q){},setFlatness(q){},setGState:function(z){for(let w=0,N=z.length;w<N;w++){const G=z[w],V=G[0],H=G[1];switch(V){case"LW":this.setLineWidth(H);break;case"LC":this.setLineCap(H);break;case"LJ":this.setLineJoin(H);break;case"ML":this.setMiterLimit(H);break;case"D":this.setDash(H[0],H[1]);break;case"RI":this.setRenderingIntent(H);break;case"FL":this.setFlatness(H);break;case"Font":this.setFont(H[0],H[1]);break;case"CA":this.current.strokeAlpha=G[1];break;case"ca":this.current.fillAlpha=G[1],this.ctx.globalAlpha=G[1];break;case"BM":this.ctx.globalCompositeOperation=H;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=H?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null;break;case"TR":this.current.transferMaps=H}}},beginSMaskGroup:function(){const z=this.current.activeSMask,w=z.canvas.width,N=z.canvas.height,G="smaskGroupAt"+this.groupLevel,V=this.cachedCanvases.getCanvas(G,w,N,!0),H=this.ctx,X=H.mozCurrentTransform;this.ctx.save();const Q=V.context;Q.scale(1/z.scaleX,1/z.scaleY),Q.translate(-z.offsetX,-z.offsetY),Q.transform.apply(Q,X),z.startTransformInverse=Q.mozCurrentTransformInverse,_(H,Q),this.ctx=Q,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(H),this.groupLevel++},suspendSMaskGroup:function(){const z=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),C(this.ctx,this.current.activeSMask,z,this.webGLContext),this.ctx.restore(),this.ctx.save(),_(z,this.ctx),this.current.resumeSMaskCtx=z;const w=e.Util.transform(this.current.activeSMask.startTransformInverse,z.mozCurrentTransform);this.ctx.transform.apply(this.ctx,w),z.save(),z.setTransform(1,0,0,1,0,0),z.clearRect(0,0,z.canvas.width,z.canvas.height),z.restore()},resumeSMaskGroup:function(){const z=this.current.resumeSMaskCtx,w=this.ctx;this.ctx=z,this.groupStack.push(w),this.groupLevel++},endSMaskGroup:function(){const z=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),C(this.ctx,this.current.activeSMask,z,this.webGLContext),this.ctx.restore(),_(z,this.ctx);const w=e.Util.transform(this.current.activeSMask.startTransformInverse,z.mozCurrentTransform);this.ctx.transform.apply(this.ctx,w)},save:function(){this.ctx.save();const z=this.current;this.stateStack.push(z),this.current=z.clone(),this.current.resumeSMaskCtx=null},restore:function(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),this.current.activeSMask!==null&&(this.stateStack.length===0||this.stateStack[this.stateStack.length-1].activeSMask!==this.current.activeSMask)&&this.endSMaskGroup(),this.stateStack.length!==0?(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null):this.current.activeSMask=null},transform:function(z,w,N,G,V,H){this.ctx.transform(z,w,N,G,V,H),this._cachedGetSinglePixelWidth=null},constructPath:function(z,w){const N=this.ctx,G=this.current;let V=G.x,H=G.y;for(let X=0,Q=0,ce=z.length;X<ce;X++)switch(z[X]|0){case e.OPS.rectangle:V=w[Q++],H=w[Q++];const pe=w[Q++],_e=w[Q++],xe=V+pe,Y=H+_e;N.moveTo(V,H),pe===0||_e===0?N.lineTo(xe,Y):(N.lineTo(xe,H),N.lineTo(xe,Y),N.lineTo(V,Y)),N.closePath();break;case e.OPS.moveTo:V=w[Q++],H=w[Q++],N.moveTo(V,H);break;case e.OPS.lineTo:V=w[Q++],H=w[Q++],N.lineTo(V,H);break;case e.OPS.curveTo:V=w[Q+4],H=w[Q+5],N.bezierCurveTo(w[Q],w[Q+1],w[Q+2],w[Q+3],V,H),Q+=6;break;case e.OPS.curveTo2:N.bezierCurveTo(V,H,w[Q],w[Q+1],w[Q+2],w[Q+3]),V=w[Q+2],H=w[Q+3],Q+=4;break;case e.OPS.curveTo3:V=w[Q+2],H=w[Q+3],N.bezierCurveTo(w[Q],w[Q+1],V,H,V,H),Q+=4;break;case e.OPS.closePath:N.closePath();break}G.setCurrentPoint(V,H)},closePath:function(){this.ctx.closePath()},stroke:function(z){z=typeof z<"u"?z:!0;const w=this.ctx,N=this.current.strokeColor;if(w.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof N=="object"&&(N!=null&&N.getPattern)){w.save();const G=w.mozCurrentTransform,V=e.Util.singularValueDecompose2dScale(G)[0];w.strokeStyle=N.getPattern(w,this);const H=this.getSinglePixelWidth(),X=this.current.lineWidth*V;H<0&&-H>=X?(w.resetTransform(),w.lineWidth=Math.round(this._combinedScaleFactor)):w.lineWidth=Math.max(H,X),w.stroke(),w.restore()}else{const G=this.getSinglePixelWidth();G<0&&-G>=this.current.lineWidth?(w.save(),w.resetTransform(),w.lineWidth=Math.round(this._combinedScaleFactor),w.stroke(),w.restore()):(w.lineWidth=Math.max(G,this.current.lineWidth),w.stroke())}z&&this.consumePath(),w.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(z){z=typeof z<"u"?z:!0;const w=this.ctx,N=this.current.fillColor,G=this.current.patternFill;let V=!1;G&&(w.save(),this.baseTransform&&w.setTransform.apply(w,this.baseTransform),w.fillStyle=N.getPattern(w,this),V=!0),this.contentVisible&&(this.pendingEOFill?(w.fill("evenodd"),this.pendingEOFill=!1):w.fill()),V&&w.restore(),z&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=Z},eoClip:function(){this.pendingClip=J},beginText:function(){this.current.textMatrix=e.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){const z=this.pendingTextPaths,w=this.ctx;if(z===void 0){w.beginPath();return}w.save(),w.beginPath();for(let N=0;N<z.length;N++){const G=z[N];w.setTransform.apply(w,G.transform),w.translate(G.x,G.y),G.addToPath(w,G.fontSize)}w.restore(),w.clip(),w.beginPath(),delete this.pendingTextPaths},setCharSpacing:function(z){this.current.charSpacing=z},setWordSpacing:function(z){this.current.wordSpacing=z},setHScale:function(z){this.current.textHScale=z/100},setLeading:function(z){this.current.leading=-z},setFont:function(z,w){const N=this.commonObjs.get(z),G=this.current;if(!N)throw new Error(`Can't find font for ${z}`);if(G.fontMatrix=N.fontMatrix||e.FONT_IDENTITY_MATRIX,(G.fontMatrix[0]===0||G.fontMatrix[3]===0)&&(0,e.warn)("Invalid font matrix for font "+z),w<0?(w=-w,G.fontDirection=-1):G.fontDirection=1,this.current.font=N,this.current.fontSize=w,N.isType3Font)return;const V=N.loadedName||"sans-serif";let H="normal";N.black?H="900":N.bold&&(H="bold");const X=N.italic?"italic":"normal",Q=`"${V}", ${N.fallbackName}`;let ce=w;w<a?ce=a:w>i&&(ce=i),this.current.fontSizeScale=w/ce,this.ctx.font=`${X} ${H} ${ce}px ${Q}`},setTextRenderingMode:function(z){this.current.textRenderingMode=z},setTextRise:function(z){this.current.textRise=z},moveText:function(z,w){this.current.x=this.current.lineX+=z,this.current.y=this.current.lineY+=w},setLeadingMoveText:function(z,w){this.setLeading(-w),this.moveText(z,w)},setTextMatrix:function(z,w,N,G,V,H){this.current.textMatrix=[z,w,N,G,V,H],this.current.textMatrixScale=Math.hypot(z,w),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar(q,z,w,N,G){const V=this.ctx,H=this.current,X=H.font,Q=H.textRenderingMode,ce=H.fontSize/H.fontSizeScale,pe=Q&e.TextRenderingMode.FILL_STROKE_MASK,_e=!!(Q&e.TextRenderingMode.ADD_TO_PATH_FLAG),xe=H.patternFill&&!X.missingFile;let Y;(X.disableFontFace||_e||xe)&&(Y=X.getPathGenerator(this.commonObjs,q)),X.disableFontFace||xe?(V.save(),V.translate(z,w),V.beginPath(),Y(V,ce),N&&V.setTransform.apply(V,N),(pe===e.TextRenderingMode.FILL||pe===e.TextRenderingMode.FILL_STROKE)&&V.fill(),(pe===e.TextRenderingMode.STROKE||pe===e.TextRenderingMode.FILL_STROKE)&&(G&&(V.resetTransform(),V.lineWidth=Math.round(this._combinedScaleFactor)),V.stroke()),V.restore()):((pe===e.TextRenderingMode.FILL||pe===e.TextRenderingMode.FILL_STROKE)&&V.fillText(q,z,w),(pe===e.TextRenderingMode.STROKE||pe===e.TextRenderingMode.FILL_STROKE)&&(G?(V.save(),V.moveTo(z,w),V.resetTransform(),V.lineWidth=Math.round(this._combinedScaleFactor),V.strokeText(q,0,0),V.restore()):V.strokeText(q,z,w))),_e&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:V.mozCurrentTransform,x:z,y:w,fontSize:ce,addToPath:Y})},get isFontSubpixelAAEnabled(){const{context:q}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);q.scale(1.5,1),q.fillText("I",0,10);const z=q.getImageData(0,0,10,10).data;let w=!1;for(let N=3;N<z.length;N+=4)if(z[N]>0&&z[N]<255){w=!0;break}return(0,e.shadow)(this,"isFontSubpixelAAEnabled",w)},showText:function(z){const w=this.current,N=w.font;if(N.isType3Font)return this.showType3Text(z);const G=w.fontSize;if(G===0)return;const V=this.ctx,H=w.fontSizeScale,X=w.charSpacing,Q=w.wordSpacing,ce=w.fontDirection,pe=w.textHScale*ce,_e=z.length,xe=N.vertical,Y=xe?1:-1,F=N.defaultVMetrics,ie=G*w.fontMatrix[0],ae=w.textRenderingMode===e.TextRenderingMode.FILL&&!N.disableFontFace&&!w.patternFill;V.save();let de;if(w.patternFill){V.save();const U=w.fillColor.getPattern(V,this);de=V.mozCurrentTransform,V.restore(),V.fillStyle=U}V.transform.apply(V,w.textMatrix),V.translate(w.x,w.y+w.textRise),ce>0?V.scale(pe,-1):V.scale(pe,1);let ve=w.lineWidth,ee=!1;const se=w.textMatrixScale;if(se===0||ve===0){const U=w.textRenderingMode&e.TextRenderingMode.FILL_STROKE_MASK;(U===e.TextRenderingMode.STROKE||U===e.TextRenderingMode.FILL_STROKE)&&(this._cachedGetSinglePixelWidth=null,ve=this.getSinglePixelWidth(),ee=ve<0)}else ve/=se;H!==1&&(V.scale(H,H),ve/=H),V.lineWidth=ve;let K=0,I;for(I=0;I<_e;++I){const U=z[I];if((0,e.isNum)(U)){K+=Y*U*G/1e3;continue}let oe=!1;const ge=(U.isSpace?Q:0)+X,Se=U.fontChar,Ce=U.accent;let Re,qe,Ge=U.width;if(xe){const He=U.vmetric||F,Xe=-(U.vmetric?He[1]:Ge*.5)*ie,Qe=He[2]*ie;Ge=He?-He[0]:Ge,Re=Xe/H,qe=(K+Qe)/H}else Re=K/H,qe=0;if(N.remeasure&&Ge>0){const He=V.measureText(Se).width*1e3/G*H;if(Ge<He&&this.isFontSubpixelAAEnabled){const Xe=Ge/He;oe=!0,V.save(),V.scale(Xe,1),Re/=Xe}else Ge!==He&&(Re+=(Ge-He)/2e3*G/H)}if(this.contentVisible&&(U.isInFont||N.missingFile)){if(ae&&!Ce)V.fillText(Se,Re,qe);else if(this.paintChar(Se,Re,qe,de,ee),Ce){const He=Re+G*Ce.offset.x/H,Xe=qe-G*Ce.offset.y/H;this.paintChar(Ce.fontChar,He,Xe,de,ee)}}let Ye;xe?Ye=Ge*ie-ge*ce:Ye=Ge*ie+ge*ce,K+=Ye,oe&&V.restore()}xe?w.y-=K:w.x+=K*pe,V.restore()},showType3Text:function(z){const w=this.ctx,N=this.current,G=N.font,V=N.fontSize,H=N.fontDirection,X=G.vertical?1:-1,Q=N.charSpacing,ce=N.wordSpacing,pe=N.textHScale*H,_e=N.fontMatrix||e.FONT_IDENTITY_MATRIX,xe=z.length,Y=N.textRenderingMode===e.TextRenderingMode.INVISIBLE;let F,ie,ae,de;if(!(Y||V===0)){for(this._cachedGetSinglePixelWidth=null,w.save(),w.transform.apply(w,N.textMatrix),w.translate(N.x,N.y),w.scale(pe,H),F=0;F<xe;++F){if(ie=z[F],(0,e.isNum)(ie)){de=X*ie*V/1e3,this.ctx.translate(de,0),N.x+=de*pe;continue}const ve=(ie.isSpace?ce:0)+Q,ee=G.charProcOperatorList[ie.operatorListId];if(!ee){(0,e.warn)(`Type3 character "${ie.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=ie,this.save(),w.scale(V,V),w.transform.apply(w,_e),this.executeOperatorList(ee),this.restore()),ae=e.Util.applyTransform([ie.width,0],_e)[0]*V+ve,w.translate(ae,0),N.x+=ae*pe}w.restore(),this.processingType3=null}},setCharWidth:function(z,w){},setCharWidthAndBounds:function(z,w,N,G,V,H){this.ctx.rect(N,G,V-N,H-G),this.clip(),this.endPath()},getColorN_Pattern:function(z){let w;if(z[0]==="TilingPattern"){const N=z[1],G=this.baseTransform||this.ctx.mozCurrentTransform.slice(),V={createCanvasGraphics:H=>new L(H,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext)};w=new c.TilingPattern(z,N,this.ctx,V,G)}else w=(0,c.getShadingPatternFromIR)(z);return w},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(z,w,N){const G=e.Util.makeHexColor(z,w,N);this.ctx.strokeStyle=G,this.current.strokeColor=G},setFillRGBColor:function(z,w,N){const G=e.Util.makeHexColor(z,w,N);this.ctx.fillStyle=G,this.current.fillColor=G,this.current.patternFill=!1},shadingFill:function(z){if(!this.contentVisible)return;const w=this.ctx;this.save();const N=(0,c.getShadingPatternFromIR)(z);w.fillStyle=N.getPattern(w,this,!0);const G=w.mozCurrentTransformInverse;if(G){const V=w.canvas,H=V.width,X=V.height,Q=e.Util.applyTransform([0,0],G),ce=e.Util.applyTransform([0,X],G),pe=e.Util.applyTransform([H,0],G),_e=e.Util.applyTransform([H,X],G),xe=Math.min(Q[0],ce[0],pe[0],_e[0]),Y=Math.min(Q[1],ce[1],pe[1],_e[1]),F=Math.max(Q[0],ce[0],pe[0],_e[0]),ie=Math.max(Q[1],ce[1],pe[1],_e[1]);this.ctx.fillRect(xe,Y,F-xe,ie-Y)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()},beginInlineImage:function(){(0,e.unreachable)("Should not call beginInlineImage")},beginImageData:function(){(0,e.unreachable)("Should not call beginImageData")},paintFormXObjectBegin:function(z,w){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(z)&&z.length===6&&this.transform.apply(this,z),this.baseTransform=this.ctx.mozCurrentTransform,w)){const N=w[2]-w[0],G=w[3]-w[1];this.ctx.rect(w[0],w[1],N,G),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())},beginGroup:function(z){if(!this.contentVisible)return;this.save();const w=this.ctx;z.isolated||(0,e.info)("TODO: Support non-isolated groups."),z.knockout&&(0,e.warn)("Knockout groups not supported.");const N=w.mozCurrentTransform;if(z.matrix&&w.transform.apply(w,z.matrix),!z.bbox)throw new Error("Bounding box is required.");let G=e.Util.getAxialAlignedBoundingBox(z.bbox,w.mozCurrentTransform);const V=[0,0,w.canvas.width,w.canvas.height];G=e.Util.intersect(G,V)||[0,0,0,0];const H=Math.floor(G[0]),X=Math.floor(G[1]);let Q=Math.max(Math.ceil(G[2])-H,1),ce=Math.max(Math.ceil(G[3])-X,1),pe=1,_e=1;Q>o&&(pe=Q/o,Q=o),ce>o&&(_e=ce/o,ce=o);let xe="groupAt"+this.groupLevel;z.smask&&(xe+="_smask_"+this.smaskCounter++%2);const Y=this.cachedCanvases.getCanvas(xe,Q,ce,!0),F=Y.context;F.scale(1/pe,1/_e),F.translate(-H,-X),F.transform.apply(F,N),z.smask?this.smaskStack.push({canvas:Y.canvas,context:F,offsetX:H,offsetY:X,scaleX:pe,scaleY:_e,subtype:z.smask.subtype,backdrop:z.smask.backdrop,transferMap:z.smask.transferMap||null,startTransformInverse:null}):(w.setTransform(1,0,0,1,0,0),w.translate(H,X),w.scale(pe,_e)),_(w,F),this.ctx=F,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(w),this.groupLevel++,this.current.activeSMask=null},endGroup:function(z){if(!this.contentVisible)return;this.groupLevel--;const w=this.ctx;this.ctx=this.groupStack.pop(),this.ctx.imageSmoothingEnabled!==void 0?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,z.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(w.canvas,0,0),this.restore()},beginAnnotations:function(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(z,w,N){if(this.save(),u(this.ctx),this.current=new m,Array.isArray(z)&&z.length===4){const G=z[2]-z[0],V=z[3]-z[1];this.ctx.rect(z[0],z[1],G,V),this.clip(),this.endPath()}this.transform.apply(this,w),this.transform.apply(this,N)},endAnnotation:function(){this.restore()},paintImageMaskXObject:function(z){if(!this.contentVisible)return;const w=this.ctx,N=z.width,G=z.height,V=this.current.fillColor,H=this.current.patternFill,X=this.processingType3;if(X&&X.compiled===void 0&&(N<=l&&G<=l?X.compiled=p({data:z.data,width:N,height:G}):X.compiled=null),X!=null&&X.compiled){X.compiled(w);return}const Q=this.cachedCanvases.getCanvas("maskCanvas",N,G),ce=Q.context;ce.save(),g(ce,z),ce.globalCompositeOperation="source-in",ce.fillStyle=H?V.getPattern(ce,this):V,ce.fillRect(0,0,N,G),ce.restore(),this.paintInlineImageXObject(Q.canvas)},paintImageMaskXObjectRepeat(q,z,w=0,N=0,G,V){if(!this.contentVisible)return;const H=q.width,X=q.height,Q=this.current.fillColor,ce=this.current.patternFill,pe=this.cachedCanvases.getCanvas("maskCanvas",H,X),_e=pe.context;_e.save(),g(_e,q),_e.globalCompositeOperation="source-in",_e.fillStyle=ce?Q.getPattern(_e,this):Q,_e.fillRect(0,0,H,X),_e.restore();const xe=this.ctx;for(let Y=0,F=V.length;Y<F;Y+=2)xe.save(),xe.transform(z,w,N,G,V[Y],V[Y+1]),xe.scale(1,-1),xe.drawImage(pe.canvas,0,0,H,X,0,-1,1,1),xe.restore()},paintImageMaskXObjectGroup:function(z){if(!this.contentVisible)return;const w=this.ctx,N=this.current.fillColor,G=this.current.patternFill;for(let V=0,H=z.length;V<H;V++){const X=z[V],Q=X.width,ce=X.height,pe=this.cachedCanvases.getCanvas("maskCanvas",Q,ce),_e=pe.context;_e.save(),g(_e,X),_e.globalCompositeOperation="source-in",_e.fillStyle=G?N.getPattern(_e,this):N,_e.fillRect(0,0,Q,ce),_e.restore(),w.save(),w.transform.apply(w,X.transform),w.scale(1,-1),w.drawImage(pe.canvas,0,0,Q,ce,0,-1,1,1),w.restore()}},paintImageXObject:function(z){if(!this.contentVisible)return;const w=z.startsWith("g_")?this.commonObjs.get(z):this.objs.get(z);if(!w){(0,e.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(w)},paintImageXObjectRepeat:function(z,w,N,G){if(!this.contentVisible)return;const V=z.startsWith("g_")?this.commonObjs.get(z):this.objs.get(z);if(!V){(0,e.warn)("Dependent image isn't ready yet");return}const H=V.width,X=V.height,Q=[];for(let ce=0,pe=G.length;ce<pe;ce+=2)Q.push({transform:[w,0,0,N,G[ce],G[ce+1]],x:0,y:0,w:H,h:X});this.paintInlineImageXObjectGroup(V,Q)},paintInlineImageXObject:function(z){if(!this.contentVisible)return;const w=z.width,N=z.height,G=this.ctx;this.save(),G.scale(1/w,-1/N);const V=G.mozCurrentTransformInverse;let H=Math.max(Math.hypot(V[0],V[1]),1),X=Math.max(Math.hypot(V[2],V[3]),1),Q,ce,pe;typeof HTMLElement=="function"&&z instanceof HTMLElement||!z.data?Q=z:(ce=this.cachedCanvases.getCanvas("inlineImage",w,N),pe=ce.context,T(pe,z,this.current.transferMaps),Q=ce.canvas);let _e=w,xe=N,Y="prescale1";for(;H>2&&_e>1||X>2&&xe>1;){let F=_e,ie=xe;H>2&&_e>1&&(F=Math.ceil(_e/2),H/=_e/F),X>2&&xe>1&&(ie=Math.ceil(xe/2),X/=xe/ie),ce=this.cachedCanvases.getCanvas(Y,F,ie),pe=ce.context,pe.clearRect(0,0,F,ie),pe.drawImage(Q,0,0,_e,xe,0,0,F,ie),Q=ce.canvas,_e=F,xe=ie,Y=Y==="prescale1"?"prescale2":"prescale1"}if(G.drawImage(Q,0,0,_e,xe,0,-N,w,N),this.imageLayer){const F=this.getCanvasPosition(0,-N);this.imageLayer.appendImage({imgData:z,left:F[0],top:F[1],width:w/V[0],height:N/V[3]})}this.restore()},paintInlineImageXObjectGroup:function(z,w){if(!this.contentVisible)return;const N=this.ctx,G=z.width,V=z.height,H=this.cachedCanvases.getCanvas("inlineImage",G,V),X=H.context;T(X,z,this.current.transferMaps);for(let Q=0,ce=w.length;Q<ce;Q++){const pe=w[Q];if(N.save(),N.transform.apply(N,pe.transform),N.scale(1,-1),N.drawImage(H.canvas,pe.x,pe.y,pe.w,pe.h,0,-1,1,1),this.imageLayer){const _e=this.getCanvasPosition(pe.x,pe.y);this.imageLayer.appendImage({imgData:z,left:_e[0],top:_e[1],width:G,height:V})}N.restore()}},paintSolidColorImageMask:function(){this.contentVisible&&this.ctx.fillRect(0,0,1,1)},markPoint:function(z){},markPointProps:function(z,w){},beginMarkedContent:function(z){this.markedContentStack.push({visible:!0})},beginMarkedContentProps:function(z,w){z==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(w)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()},endMarkedContent:function(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()},beginCompat:function(){},endCompat:function(){},consumePath:function(){const z=this.ctx;this.pendingClip&&(this.pendingClip===J?z.clip("evenodd"):z.clip(),this.pendingClip=null),z.beginPath()},getSinglePixelWidth(){if(this._cachedGetSinglePixelWidth===null){const q=this.ctx.mozCurrentTransform,z=Math.abs(q[0]*q[3]-q[2]*q[1]),w=q[0]**2+q[2]**2,N=q[1]**2+q[3]**2,G=Math.sqrt(Math.max(w,N))/z;w!==N&&this._combinedScaleFactor*G>1?this._cachedGetSinglePixelWidth=-(this._combinedScaleFactor*G):z>Number.EPSILON?this._cachedGetSinglePixelWidth=G:this._cachedGetSinglePixelWidth=1}return this._cachedGetSinglePixelWidth},getCanvasPosition:function(z,w){const N=this.ctx.mozCurrentTransform;return[N[0]*z+N[2]*w+N[4],N[1]*z+N[3]*w+N[5]]},isContentVisible:function(){for(let z=this.markedContentStack.length-1;z>=0;z--)if(!this.markedContentStack[z].visible)return!1;return!0}};for(const q in e.OPS)L.prototype[e.OPS[q]]=L.prototype[q];return L}();n.CanvasGraphics=A},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getShadingPatternFromIR=o,n.TilingPattern=void 0;var e=s(2);const c={};function a(r,d){if(!d||typeof Path2D>"u")return;const h=d[2]-d[0],v=d[3]-d[1],p=new Path2D;p.rect(d[0],d[1],h,v),r.clip(p)}c.RadialAxial={fromIR:function(d){const h=d[1],v=d[2],p=d[3],m=d[4],A=d[5],y=d[6],x=d[7];return{getPattern:function(L){a(L,v);let T;h==="axial"?T=L.createLinearGradient(m[0],m[1],A[0],A[1]):h==="radial"&&(T=L.createRadialGradient(m[0],m[1],y,A[0],A[1],x));for(let g=0,_=p.length;g<_;++g){const u=p[g];T.addColorStop(u[0],u[1])}return T}}}};const i=function(){function d(p,m,A,y,x,P,L,T){const g=m.coords,_=m.colors,u=p.data,b=p.width*4;let S;g[A+1]>g[y+1]&&(S=A,A=y,y=S,S=P,P=L,L=S),g[y+1]>g[x+1]&&(S=y,y=x,x=S,S=L,L=T,T=S),g[A+1]>g[y+1]&&(S=A,A=y,y=S,S=P,P=L,L=S);const M=(g[A]+m.offsetX)*m.scaleX,R=(g[A+1]+m.offsetY)*m.scaleY,C=(g[y]+m.offsetX)*m.scaleX,D=(g[y+1]+m.offsetY)*m.scaleY,B=(g[x]+m.offsetX)*m.scaleX,Z=(g[x+1]+m.offsetY)*m.scaleY;if(R>=Z)return;const J=_[P],q=_[P+1],z=_[P+2],w=_[L],N=_[L+1],G=_[L+2],V=_[T],H=_[T+1],X=_[T+2],Q=Math.round(R),ce=Math.round(Z);let pe,_e,xe,Y,F,ie,ae,de;for(let ve=Q;ve<=ce;ve++){if(ve<D){let U;ve<R?U=0:R===D?U=1:U=(R-ve)/(R-D),pe=M-(M-C)*U,_e=J-(J-w)*U,xe=q-(q-N)*U,Y=z-(z-G)*U}else{let U;ve>Z?U=1:D===Z?U=0:U=(D-ve)/(D-Z),pe=C-(C-B)*U,_e=w-(w-V)*U,xe=N-(N-H)*U,Y=G-(G-X)*U}let ee;ve<R?ee=0:ve>Z?ee=1:ee=(R-ve)/(R-Z),F=M-(M-B)*ee,ie=J-(J-V)*ee,ae=q-(q-H)*ee,de=z-(z-X)*ee;const se=Math.round(Math.min(pe,F)),K=Math.round(Math.max(pe,F));let I=b*ve+se*4;for(let U=se;U<=K;U++)ee=(pe-U)/(pe-F),ee<0?ee=0:ee>1&&(ee=1),u[I++]=_e-(_e-ie)*ee|0,u[I++]=xe-(xe-ae)*ee|0,u[I++]=Y-(Y-de)*ee|0,u[I++]=255}}function h(p,m,A){const y=m.coords,x=m.colors;let P,L;switch(m.type){case"lattice":const T=m.verticesPerRow,g=Math.floor(y.length/T)-1,_=T-1;for(P=0;P<g;P++){let u=P*T;for(let b=0;b<_;b++,u++)d(p,A,y[u],y[u+1],y[u+T],x[u],x[u+1],x[u+T]),d(p,A,y[u+T+1],y[u+1],y[u+T],x[u+T+1],x[u+1],x[u+T])}break;case"triangles":for(P=0,L=y.length;P<L;P+=3)d(p,A,y[P],y[P+1],y[P+2],x[P],x[P+1],x[P+2]);break;default:throw new Error("illegal figure")}}function v(p,m,A,y,x,P,L,T){const b=Math.floor(p[0]),S=Math.floor(p[1]),M=Math.ceil(p[2])-b,R=Math.ceil(p[3])-S,C=Math.min(Math.ceil(Math.abs(M*m[0]*1.1)),3e3),D=Math.min(Math.ceil(Math.abs(R*m[1]*1.1)),3e3),B=M/C,Z=R/D,J={coords:A,colors:y,offsetX:-b,offsetY:-S,scaleX:1/B,scaleY:1/Z},q=C+2*2,z=D+2*2;let w,N,G,V;if(T.isEnabled)w=T.drawFigures({width:C,height:D,backgroundColor:P,figures:x,context:J}),N=L.getCanvas("mesh",q,z,!1),N.context.drawImage(w,2,2),w=N.canvas;else{N=L.getCanvas("mesh",q,z,!1);const H=N.context,X=H.createImageData(C,D);if(P){const Q=X.data;for(G=0,V=Q.length;G<V;G+=4)Q[G]=P[0],Q[G+1]=P[1],Q[G+2]=P[2],Q[G+3]=255}for(G=0;G<x.length;G++)h(X,x[G],J);H.putImageData(X,2,2),w=N.canvas}return{canvas:w,offsetX:b-2*B,offsetY:S-2*Z,scaleX:B,scaleY:Z}}return v}();c.Mesh={fromIR:function(d){const h=d[2],v=d[3],p=d[4],m=d[5],A=d[6],y=d[7],x=d[8];return{getPattern:function(L,T,g){a(L,y);let _;if(g)_=e.Util.singularValueDecompose2dScale(L.mozCurrentTransform);else if(_=e.Util.singularValueDecompose2dScale(T.baseTransform),A){const b=e.Util.singularValueDecompose2dScale(A);_=[_[0]*b[0],_[1]*b[1]]}const u=i(m,_,h,v,p,g?null:x,T.cachedCanvases,T.webGLContext);return g||(L.setTransform.apply(L,T.baseTransform),A&&L.transform.apply(L,A)),L.translate(u.offsetX,u.offsetY),L.scale(u.scaleX,u.scaleY),L.createPattern(u.canvas,"no-repeat")}}}},c.Dummy={fromIR:function(){return{getPattern:function(){return"hotpink"}}}};function o(r){const d=c[r[0]];if(!d)throw new Error(`Unknown IR type: ${r[0]}`);return d.fromIR(r)}const l=function(){const d={COLORED:1,UNCOLORED:2},h=3e3;function v(p,m,A,y,x){this.operatorList=p[2],this.matrix=p[3]||[1,0,0,1,0,0],this.bbox=p[4],this.xstep=p[5],this.ystep=p[6],this.paintType=p[7],this.tilingType=p[8],this.color=m,this.canvasGraphicsFactory=y,this.baseTransform=x,this.ctx=A}return v.prototype={createPatternCanvas:function(m){const A=this.operatorList,y=this.bbox,x=this.xstep,P=this.ystep,L=this.paintType,T=this.tilingType,g=this.color,_=this.canvasGraphicsFactory;(0,e.info)("TilingType: "+T);const u=y[0],b=y[1],S=y[2],M=y[3],R=e.Util.singularValueDecompose2dScale(this.matrix),C=e.Util.singularValueDecompose2dScale(this.baseTransform),D=[R[0]*C[0],R[1]*C[1]],B=this.getSizeAndScale(x,this.ctx.canvas.width,D[0]),Z=this.getSizeAndScale(P,this.ctx.canvas.height,D[1]),J=m.cachedCanvases.getCanvas("pattern",B.size,Z.size,!0),q=J.context,z=_.createCanvasGraphics(q);return z.groupLevel=m.groupLevel,this.setFillAndStrokeStyleToContext(z,L,g),z.transform(B.scale,0,0,Z.scale,0,0),z.transform(1,0,0,1,-u,-b),this.clipBbox(z,y,u,b,S,M),z.executeOperatorList(A),this.ctx.transform(1,0,0,1,u,b),this.ctx.scale(1/B.scale,1/Z.scale),J.canvas},getSizeAndScale:function(m,A,y){m=Math.abs(m);const x=Math.max(h,A);let P=Math.ceil(m*y);return P>=x?P=x:y=P/m,{scale:y,size:P}},clipBbox:function(m,A,y,x,P,L){if(Array.isArray(A)&&A.length===4){const T=P-y,g=L-x;m.ctx.rect(y,x,T,g),m.clip(),m.endPath()}},setFillAndStrokeStyleToContext:function(m,A,y){const x=m.ctx,P=m.current;switch(A){case d.COLORED:const L=this.ctx;x.fillStyle=L.fillStyle,x.strokeStyle=L.strokeStyle,P.fillColor=L.fillStyle,P.strokeColor=L.strokeStyle;break;case d.UNCOLORED:const T=e.Util.makeHexColor(y[0],y[1],y[2]);x.fillStyle=T,x.strokeStyle=T,P.fillColor=T,P.strokeColor=T;break;default:throw new e.FormatError(`Unsupported paint type: ${A}`)}},getPattern:function(m,A){m=this.ctx,m.setTransform.apply(m,this.baseTransform),m.transform.apply(m,this.matrix);const y=this.createPatternCanvas(A);return m.createPattern(y,"repeat")}},v}();n.TilingPattern=l},(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const s=Object.create(null);n.GlobalWorkerOptions=s,s.workerPort=s.workerPort===void 0?null:s.workerPort,s.workerSrc=s.workerSrc===void 0?"":s.workerSrc},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var e=s(2);const c={UNKNOWN:0,DATA:1,ERROR:2},a={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function i(l){if(typeof l!="object"||l===null)return l;switch(l.name){case"AbortException":return new e.AbortException(l.message);case"MissingPDFException":return new e.MissingPDFException(l.message);case"UnexpectedResponseException":return new e.UnexpectedResponseException(l.message,l.status);case"UnknownErrorException":return new e.UnknownErrorException(l.message,l.details);default:return new e.UnknownErrorException(l.message,l.toString())}}class o{constructor(r,d,h){this.sourceName=r,this.targetName=d,this.comObj=h,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=v=>{const p=v.data;if(p.targetName!==this.sourceName)return;if(p.stream){this._processStreamMessage(p);return}if(p.callback){const A=p.callbackId,y=this.callbackCapabilities[A];if(!y)throw new Error(`Cannot resolve callback ${A}`);if(delete this.callbackCapabilities[A],p.callback===c.DATA)y.resolve(p.data);else if(p.callback===c.ERROR)y.reject(i(p.reason));else throw new Error("Unexpected callback case");return}const m=this.actionHandler[p.action];if(!m)throw new Error(`Unknown action from worker: ${p.action}`);if(p.callbackId){const A=this.sourceName,y=p.sourceName;new Promise(function(x){x(m(p.data))}).then(function(x){h.postMessage({sourceName:A,targetName:y,callback:c.DATA,callbackId:p.callbackId,data:x})},function(x){h.postMessage({sourceName:A,targetName:y,callback:c.ERROR,callbackId:p.callbackId,reason:i(x)})});return}if(p.streamId){this._createStreamSink(p);return}m(p.data)},h.addEventListener("message",this._onComObjOnMessage)}on(r,d){const h=this.actionHandler;if(h[r])throw new Error(`There is already an actionName called "${r}"`);h[r]=d}send(r,d,h){this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:r,data:d},h)}sendWithPromise(r,d,h){const v=this.callbackId++,p=(0,e.createPromiseCapability)();this.callbackCapabilities[v]=p;try{this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:r,callbackId:v,data:d},h)}catch(m){p.reject(m)}return p.promise}sendWithStream(r,d,h,v){const p=this.streamId++,m=this.sourceName,A=this.targetName,y=this.comObj;return new ReadableStream({start:x=>{const P=(0,e.createPromiseCapability)();return this.streamControllers[p]={controller:x,startCall:P,pullCall:null,cancelCall:null,isClosed:!1},this._postMessage({sourceName:m,targetName:A,action:r,streamId:p,data:d,desiredSize:x.desiredSize},v),P.promise},pull:x=>{const P=(0,e.createPromiseCapability)();return this.streamControllers[p].pullCall=P,y.postMessage({sourceName:m,targetName:A,stream:a.PULL,streamId:p,desiredSize:x.desiredSize}),P.promise},cancel:x=>{(0,e.assert)(x instanceof Error,"cancel must have a valid reason");const P=(0,e.createPromiseCapability)();return this.streamControllers[p].cancelCall=P,this.streamControllers[p].isClosed=!0,y.postMessage({sourceName:m,targetName:A,stream:a.CANCEL,streamId:p,reason:i(x)}),P.promise}},h)}_createStreamSink(r){const d=this,h=this.actionHandler[r.action],v=r.streamId,p=this.sourceName,m=r.sourceName,A=this.comObj,y={enqueue(x,P=1,L){if(this.isCancelled)return;const T=this.desiredSize;this.desiredSize-=P,T>0&&this.desiredSize<=0&&(this.sinkCapability=(0,e.createPromiseCapability)(),this.ready=this.sinkCapability.promise),d._postMessage({sourceName:p,targetName:m,stream:a.ENQUEUE,streamId:v,chunk:x},L)},close(){this.isCancelled||(this.isCancelled=!0,A.postMessage({sourceName:p,targetName:m,stream:a.CLOSE,streamId:v}),delete d.streamSinks[v])},error(x){(0,e.assert)(x instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,A.postMessage({sourceName:p,targetName:m,stream:a.ERROR,streamId:v,reason:i(x)}))},sinkCapability:(0,e.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:r.desiredSize,ready:null};y.sinkCapability.resolve(),y.ready=y.sinkCapability.promise,this.streamSinks[v]=y,new Promise(function(x){x(h(r.data,y))}).then(function(){A.postMessage({sourceName:p,targetName:m,stream:a.START_COMPLETE,streamId:v,success:!0})},function(x){A.postMessage({sourceName:p,targetName:m,stream:a.START_COMPLETE,streamId:v,reason:i(x)})})}_processStreamMessage(r){const d=r.streamId,h=this.sourceName,v=r.sourceName,p=this.comObj;switch(r.stream){case a.START_COMPLETE:r.success?this.streamControllers[d].startCall.resolve():this.streamControllers[d].startCall.reject(i(r.reason));break;case a.PULL_COMPLETE:r.success?this.streamControllers[d].pullCall.resolve():this.streamControllers[d].pullCall.reject(i(r.reason));break;case a.PULL:if(!this.streamSinks[d]){p.postMessage({sourceName:h,targetName:v,stream:a.PULL_COMPLETE,streamId:d,success:!0});break}this.streamSinks[d].desiredSize<=0&&r.desiredSize>0&&this.streamSinks[d].sinkCapability.resolve(),this.streamSinks[d].desiredSize=r.desiredSize;const{onPull:m}=this.streamSinks[r.streamId];new Promise(function(y){y(m&&m())}).then(function(){p.postMessage({sourceName:h,targetName:v,stream:a.PULL_COMPLETE,streamId:d,success:!0})},function(y){p.postMessage({sourceName:h,targetName:v,stream:a.PULL_COMPLETE,streamId:d,reason:i(y)})});break;case a.ENQUEUE:if((0,e.assert)(this.streamControllers[d],"enqueue should have stream controller"),this.streamControllers[d].isClosed)break;this.streamControllers[d].controller.enqueue(r.chunk);break;case a.CLOSE:if((0,e.assert)(this.streamControllers[d],"close should have stream controller"),this.streamControllers[d].isClosed)break;this.streamControllers[d].isClosed=!0,this.streamControllers[d].controller.close(),this._deleteStreamController(d);break;case a.ERROR:(0,e.assert)(this.streamControllers[d],"error should have stream controller"),this.streamControllers[d].controller.error(i(r.reason)),this._deleteStreamController(d);break;case a.CANCEL_COMPLETE:r.success?this.streamControllers[d].cancelCall.resolve():this.streamControllers[d].cancelCall.reject(i(r.reason)),this._deleteStreamController(d);break;case a.CANCEL:if(!this.streamSinks[d])break;const{onCancel:A}=this.streamSinks[r.streamId];new Promise(function(y){y(A&&A(i(r.reason)))}).then(function(){p.postMessage({sourceName:h,targetName:v,stream:a.CANCEL_COMPLETE,streamId:d,success:!0})},function(y){p.postMessage({sourceName:h,targetName:v,stream:a.CANCEL_COMPLETE,streamId:d,reason:i(y)})}),this.streamSinks[d].sinkCapability.reject(i(r.reason)),this.streamSinks[d].isCancelled=!0,delete this.streamSinks[d];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(r){await Promise.allSettled([this.streamControllers[r].startCall,this.streamControllers[r].pullCall,this.streamControllers[r].cancelCall].map(function(d){return d&&d.promise})),delete this.streamControllers[r]}_postMessage(r,d){d&&this.postMessageTransfers?this.comObj.postMessage(r,d):this.comObj.postMessage(r)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}n.MessageHandler=o},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var e=s(2);class c{constructor({parsedData:i,rawData:o}){this._metadataMap=i,this._data=o}getRaw(){return this._data}get(i){return this._metadataMap.get(i)??null}getAll(){return(0,e.objectFromMap)(this._metadataMap)}has(i){return this._metadataMap.has(i)}}n.Metadata=c},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var e=s(2);class c{constructor(o,l){this.visible=!0,this.name=o,this.intent=l}}class a{constructor(o){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,o!==null){this.name=o.name,this.creator=o.creator,this._order=o.order;for(const l of o.groups)this._groups.set(l.id,new c(l.name,l.intent));if(o.baseState==="OFF")for(const l of this._groups)l.visible=!1;for(const l of o.on)this._groups.get(l).visible=!0;for(const l of o.off)this._groups.get(l).visible=!1}}isVisible(o){if(o.type==="OCG")return this._groups.has(o.id)?this._groups.get(o.id).visible:((0,e.warn)(`Optional content group not found: ${o.id}`),!0);if(o.type==="OCMD"){if(o.expression&&(0,e.warn)("Visibility expression not supported yet."),!o.policy||o.policy==="AnyOn"){for(const l of o.ids){if(!this._groups.has(l))return(0,e.warn)(`Optional content group not found: ${l}`),!0;if(this._groups.get(l).visible)return!0}return!1}else if(o.policy==="AllOn"){for(const l of o.ids){if(!this._groups.has(l))return(0,e.warn)(`Optional content group not found: ${l}`),!0;if(!this._groups.get(l).visible)return!1}return!0}else if(o.policy==="AnyOff"){for(const l of o.ids){if(!this._groups.has(l))return(0,e.warn)(`Optional content group not found: ${l}`),!0;if(!this._groups.get(l).visible)return!0}return!1}else if(o.policy==="AllOff"){for(const l of o.ids){if(!this._groups.has(l))return(0,e.warn)(`Optional content group not found: ${l}`),!0;if(this._groups.get(l).visible)return!1}return!0}return(0,e.warn)(`Unknown optional content policy ${o.policy}.`),!0}return(0,e.warn)(`Unknown group type ${o.type}.`),!0}setVisibility(o,l=!0){if(!this._groups.has(o)){(0,e.warn)(`Optional content group not found: ${o}`);return}this._groups.get(o).visible=!!l}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size>0?(0,e.objectFromMap)(this._groups):null}getGroup(o){return this._groups.get(o)||null}}n.OptionalContentConfig=a},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var e=s(2),c=s(1);class a{constructor(r,d){(0,e.assert)(d,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=r.progressiveDone||!1,this._contentDispositionFilename=r.contentDispositionFilename||null;const h=r.initialData;if((h==null?void 0:h.length)>0){const v=new Uint8Array(h).buffer;this._queuedChunks.push(v)}this._pdfDataRangeTransport=d,this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._contentLength=r.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((v,p)=>{this._onReceiveData({begin:v,chunk:p})}),this._pdfDataRangeTransport.addProgressListener((v,p)=>{this._onProgress({loaded:v,total:p})}),this._pdfDataRangeTransport.addProgressiveReadListener(v=>{this._onReceiveData({chunk:v})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(r){const d=new Uint8Array(r.chunk).buffer;if(r.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(d):this._queuedChunks.push(d);else{const h=this._rangeReaders.some(function(v){return v._begin!==r.begin?!1:(v._enqueue(d),!0)});(0,e.assert)(h,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var r;return((r=this._fullRequestReader)==null?void 0:r._loaded)??0}_onProgress(r){if(r.total===void 0){const d=this._rangeReaders[0];d!=null&&d.onProgress&&d.onProgress({loaded:r.loaded})}else{const d=this._fullRequestReader;d!=null&&d.onProgress&&d.onProgress({loaded:r.loaded,total:r.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(r){const d=this._rangeReaders.indexOf(r);d>=0&&this._rangeReaders.splice(d,1)}getFullReader(){(0,e.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const r=this._queuedChunks;return this._queuedChunks=null,new i(this,r,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(r,d){if(d<=this._progressiveDataLength)return null;const h=new o(this,r,d);return this._pdfDataRangeTransport.requestDataRange(r,d),this._rangeReaders.push(h),h}cancelAllRequests(r){this._fullRequestReader&&this._fullRequestReader.cancel(r),this._rangeReaders.slice(0).forEach(function(h){h.cancel(r)}),this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=a;class i{constructor(r,d,h=!1,v=null){this._stream=r,this._done=h||!1,this._filename=(0,c.isPdfFile)(v)?v:null,this._queuedChunks=d||[],this._loaded=0;for(const p of this._queuedChunks)this._loaded+=p.byteLength;this._requests=[],this._headersReady=Promise.resolve(),r._fullRequestReader=this,this.onProgress=null}_enqueue(r){this._done||(this._requests.length>0?this._requests.shift().resolve({value:r,done:!1}):this._queuedChunks.push(r),this._loaded+=r.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const r=(0,e.createPromiseCapability)();return this._requests.push(r),r.promise}cancel(r){this._done=!0,this._requests.forEach(function(d){d.resolve({value:void 0,done:!0})}),this._requests=[]}progressiveDone(){this._done||(this._done=!0)}}class o{constructor(r,d,h){this._stream=r,this._begin=d,this._end=h,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(r){this._done||(this._requests.length===0?this._queuedChunk=r:(this._requests.shift().resolve({value:r,done:!1}),this._requests.forEach(function(h){h.resolve({value:void 0,done:!0})}),this._requests=[]),this._done=!0,this._stream._removeRangeReader(this))}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const d=this._queuedChunk;return this._queuedChunk=null,{value:d,done:!1}}if(this._done)return{value:void 0,done:!0};const r=(0,e.createPromiseCapability)();return this._requests.push(r),r.promise}cancel(r){this._done=!0,this._requests.forEach(function(d){d.resolve({value:void 0,done:!0})}),this._requests=[],this._stream._removeRangeReader(this)}}},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WebGLContext=void 0;var e=s(2);class c{constructor({enable:o=!1}){this._enabled=o===!0}get isEnabled(){let o=this._enabled;return o&&(o=a.tryInitGL()),(0,e.shadow)(this,"isEnabled",o)}composeSMask({layer:o,mask:l,properties:r}){return a.composeSMask(o,l,r)}drawFigures({width:o,height:l,backgroundColor:r,figures:d,context:h}){return a.drawFigures(o,l,r,d,h)}clear(){a.cleanup()}}n.WebGLContext=c;const a=function(){function o(S,M,R){const C=S.createShader(R);if(S.shaderSource(C,M),S.compileShader(C),!S.getShaderParameter(C,S.COMPILE_STATUS)){const B=S.getShaderInfoLog(C);throw new Error("Error during shader compilation: "+B)}return C}function l(S,M){return o(S,M,S.VERTEX_SHADER)}function r(S,M){return o(S,M,S.FRAGMENT_SHADER)}function d(S,M){const R=S.createProgram();for(let D=0,B=M.length;D<B;++D)S.attachShader(R,M[D]);if(S.linkProgram(R),!S.getProgramParameter(R,S.LINK_STATUS)){const D=S.getProgramInfoLog(R);throw new Error("Error during program linking: "+D)}return R}function h(S,M,R){S.activeTexture(R);const C=S.createTexture();return S.bindTexture(S.TEXTURE_2D,C),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,S.NEAREST),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,S.NEAREST),S.texImage2D(S.TEXTURE_2D,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,M),C}let v,p;function m(){v||(p=document.createElement("canvas"),v=p.getContext("webgl",{premultipliedalpha:!1}))}const A="  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             ",y="  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ";let x=null;function P(){m();const S=p;p=null;const M=v;v=null;const R=l(M,A),C=r(M,y),D=d(M,[R,C]);M.useProgram(D);const B={};B.gl=M,B.canvas=S,B.resolutionLocation=M.getUniformLocation(D,"u_resolution"),B.positionLocation=M.getAttribLocation(D,"a_position"),B.backdropLocation=M.getUniformLocation(D,"u_backdrop"),B.subtypeLocation=M.getUniformLocation(D,"u_subtype");const Z=M.getAttribLocation(D,"a_texCoord"),J=M.getUniformLocation(D,"u_image"),q=M.getUniformLocation(D,"u_mask"),z=M.createBuffer();M.bindBuffer(M.ARRAY_BUFFER,z),M.bufferData(M.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),M.STATIC_DRAW),M.enableVertexAttribArray(Z),M.vertexAttribPointer(Z,2,M.FLOAT,!1,0,0),M.uniform1i(J,0),M.uniform1i(q,1),x=B}function L(S,M,R){const C=S.width,D=S.height;x||P();const B=x,Z=B.canvas,J=B.gl;Z.width=C,Z.height=D,J.viewport(0,0,J.drawingBufferWidth,J.drawingBufferHeight),J.uniform2f(B.resolutionLocation,C,D),R.backdrop?J.uniform4f(B.resolutionLocation,R.backdrop[0],R.backdrop[1],R.backdrop[2],1):J.uniform4f(B.resolutionLocation,0,0,0,0),J.uniform1i(B.subtypeLocation,R.subtype==="Luminosity"?1:0);const q=h(J,S,J.TEXTURE0),z=h(J,M,J.TEXTURE1),w=J.createBuffer();return J.bindBuffer(J.ARRAY_BUFFER,w),J.bufferData(J.ARRAY_BUFFER,new Float32Array([0,0,C,0,0,D,0,D,C,0,C,D]),J.STATIC_DRAW),J.enableVertexAttribArray(B.positionLocation),J.vertexAttribPointer(B.positionLocation,2,J.FLOAT,!1,0,0),J.clearColor(0,0,0,0),J.enable(J.BLEND),J.blendFunc(J.ONE,J.ONE_MINUS_SRC_ALPHA),J.clear(J.COLOR_BUFFER_BIT),J.drawArrays(J.TRIANGLES,0,6),J.flush(),J.deleteTexture(q),J.deleteTexture(z),J.deleteBuffer(w),Z}const T="  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             ",g="  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ";let _=null;function u(){m();const S=p;p=null;const M=v;v=null;const R=l(M,T),C=r(M,g),D=d(M,[R,C]);M.useProgram(D);const B={};B.gl=M,B.canvas=S,B.resolutionLocation=M.getUniformLocation(D,"u_resolution"),B.scaleLocation=M.getUniformLocation(D,"u_scale"),B.offsetLocation=M.getUniformLocation(D,"u_offset"),B.positionLocation=M.getAttribLocation(D,"a_position"),B.colorLocation=M.getAttribLocation(D,"a_color"),_=B}function b(S,M,R,C,D){_||u();const B=_,Z=B.canvas,J=B.gl;Z.width=S,Z.height=M,J.viewport(0,0,J.drawingBufferWidth,J.drawingBufferHeight),J.uniform2f(B.resolutionLocation,S,M);let q=0;for(let ce=0,pe=C.length;ce<pe;ce++)switch(C[ce].type){case"lattice":const _e=C[ce].coords.length/C[ce].verticesPerRow|0;q+=(_e-1)*(C[ce].verticesPerRow-1)*6;break;case"triangles":q+=C[ce].coords.length;break}const z=new Float32Array(q*2),w=new Uint8Array(q*3),N=D.coords,G=D.colors;let V=0,H=0;for(let ce=0,pe=C.length;ce<pe;ce++){const _e=C[ce],xe=_e.coords,Y=_e.colors;switch(_e.type){case"lattice":const F=_e.verticesPerRow,ie=xe.length/F|0;for(let ae=1;ae<ie;ae++){let de=ae*F+1;for(let ve=1;ve<F;ve++,de++)z[V]=N[xe[de-F-1]],z[V+1]=N[xe[de-F-1]+1],z[V+2]=N[xe[de-F]],z[V+3]=N[xe[de-F]+1],z[V+4]=N[xe[de-1]],z[V+5]=N[xe[de-1]+1],w[H]=G[Y[de-F-1]],w[H+1]=G[Y[de-F-1]+1],w[H+2]=G[Y[de-F-1]+2],w[H+3]=G[Y[de-F]],w[H+4]=G[Y[de-F]+1],w[H+5]=G[Y[de-F]+2],w[H+6]=G[Y[de-1]],w[H+7]=G[Y[de-1]+1],w[H+8]=G[Y[de-1]+2],z[V+6]=z[V+2],z[V+7]=z[V+3],z[V+8]=z[V+4],z[V+9]=z[V+5],z[V+10]=N[xe[de]],z[V+11]=N[xe[de]+1],w[H+9]=w[H+3],w[H+10]=w[H+4],w[H+11]=w[H+5],w[H+12]=w[H+6],w[H+13]=w[H+7],w[H+14]=w[H+8],w[H+15]=G[Y[de]],w[H+16]=G[Y[de]+1],w[H+17]=G[Y[de]+2],V+=12,H+=18}break;case"triangles":for(let ae=0,de=xe.length;ae<de;ae++)z[V]=N[xe[ae]],z[V+1]=N[xe[ae]+1],w[H]=G[Y[ae]],w[H+1]=G[Y[ae]+1],w[H+2]=G[Y[ae]+2],V+=2,H+=3;break}}R?J.clearColor(R[0]/255,R[1]/255,R[2]/255,1):J.clearColor(0,0,0,0),J.clear(J.COLOR_BUFFER_BIT);const X=J.createBuffer();J.bindBuffer(J.ARRAY_BUFFER,X),J.bufferData(J.ARRAY_BUFFER,z,J.STATIC_DRAW),J.enableVertexAttribArray(B.positionLocation),J.vertexAttribPointer(B.positionLocation,2,J.FLOAT,!1,0,0);const Q=J.createBuffer();return J.bindBuffer(J.ARRAY_BUFFER,Q),J.bufferData(J.ARRAY_BUFFER,w,J.STATIC_DRAW),J.enableVertexAttribArray(B.colorLocation),J.vertexAttribPointer(B.colorLocation,3,J.UNSIGNED_BYTE,!1,0,0),J.uniform2f(B.scaleLocation,D.scaleX,D.scaleY),J.uniform2f(B.offsetLocation,D.offsetX,D.offsetY),J.drawArrays(J.TRIANGLES,0,q),J.flush(),J.deleteBuffer(X),J.deleteBuffer(Q),Z}return{tryInitGL(){try{return m(),!!v}catch{}return!1},composeSMask:L,drawFigures:b,cleanup(){x!=null&&x.canvas&&(x.canvas.width=0,x.canvas.height=0),_!=null&&_.canvas&&(_.canvas.width=0,_.canvas.height=0),x=null,_=null}}}()},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationLayer=void 0;var e=s(1),c=s(2),a=s(8),i=s(19);class o{static create(w){switch(w.data.annotationType){case c.AnnotationType.LINK:return new r(w);case c.AnnotationType.TEXT:return new d(w);case c.AnnotationType.WIDGET:switch(w.data.fieldType){case"Tx":return new v(w);case"Btn":return w.data.radioButton?new m(w):w.data.checkBox?new p(w):new A(w);case"Ch":return new y(w)}return new h(w);case c.AnnotationType.POPUP:return new x(w);case c.AnnotationType.FREETEXT:return new L(w);case c.AnnotationType.LINE:return new T(w);case c.AnnotationType.SQUARE:return new g(w);case c.AnnotationType.CIRCLE:return new _(w);case c.AnnotationType.POLYLINE:return new u(w);case c.AnnotationType.CARET:return new S(w);case c.AnnotationType.INK:return new M(w);case c.AnnotationType.POLYGON:return new b(w);case c.AnnotationType.HIGHLIGHT:return new R(w);case c.AnnotationType.UNDERLINE:return new C(w);case c.AnnotationType.SQUIGGLY:return new D(w);case c.AnnotationType.STRIKEOUT:return new B(w);case c.AnnotationType.STAMP:return new Z(w);case c.AnnotationType.FILEATTACHMENT:return new J(w);default:return new l(w)}}}class l{constructor(w,{isRenderable:N=!1,ignoreBorder:G=!1,createQuadrilaterals:V=!1}={}){this.isRenderable=N,this.data=w.data,this.layer=w.layer,this.page=w.page,this.viewport=w.viewport,this.linkService=w.linkService,this.downloadManager=w.downloadManager,this.imageResourcesPath=w.imageResourcesPath,this.renderInteractiveForms=w.renderInteractiveForms,this.svgFactory=w.svgFactory,this.annotationStorage=w.annotationStorage,this.enableScripting=w.enableScripting,this.hasJSActions=w.hasJSActions,this._mouseState=w.mouseState,N&&(this.container=this._createContainer(G)),V&&(this.quadrilaterals=this._createQuadrilaterals(G))}_createContainer(w=!1){const N=this.data,G=this.page,V=this.viewport,H=document.createElement("section");let X=N.rect[2]-N.rect[0],Q=N.rect[3]-N.rect[1];H.setAttribute("data-annotation-id",N.id);const ce=c.Util.normalizeRect([N.rect[0],G.view[3]-N.rect[1]+G.view[1],N.rect[2],G.view[3]-N.rect[3]+G.view[1]]);if(H.style.transform=`matrix(${V.transform.join(",")})`,H.style.transformOrigin=`${-ce[0]}px ${-ce[1]}px`,!w&&N.borderStyle.width>0){H.style.borderWidth=`${N.borderStyle.width}px`,N.borderStyle.style!==c.AnnotationBorderStyleType.UNDERLINE&&(X=X-2*N.borderStyle.width,Q=Q-2*N.borderStyle.width);const pe=N.borderStyle.horizontalCornerRadius,_e=N.borderStyle.verticalCornerRadius;if(pe>0||_e>0){const xe=`${pe}px / ${_e}px`;H.style.borderRadius=xe}switch(N.borderStyle.style){case c.AnnotationBorderStyleType.SOLID:H.style.borderStyle="solid";break;case c.AnnotationBorderStyleType.DASHED:H.style.borderStyle="dashed";break;case c.AnnotationBorderStyleType.BEVELED:(0,c.warn)("Unimplemented border style: beveled");break;case c.AnnotationBorderStyleType.INSET:(0,c.warn)("Unimplemented border style: inset");break;case c.AnnotationBorderStyleType.UNDERLINE:H.style.borderBottomStyle="solid";break}N.color?H.style.borderColor=c.Util.makeHexColor(N.color[0]|0,N.color[1]|0,N.color[2]|0):H.style.borderWidth=0}return H.style.left=`${ce[0]}px`,H.style.top=`${ce[1]}px`,H.style.width=`${X}px`,H.style.height=`${Q}px`,H}_createQuadrilaterals(w=!1){if(!this.data.quadPoints)return null;const N=[],G=this.data.rect;for(const V of this.data.quadPoints)this.data.rect=[V[2].x,V[2].y,V[1].x,V[1].y],N.push(this._createContainer(w));return this.data.rect=G,N}_createPopup(w,N){let G=this.container;this.quadrilaterals&&(w=w||this.quadrilaterals,G=this.quadrilaterals[0]),w||(w=document.createElement("div"),w.style.height=G.style.height,w.style.width=G.style.width,G.appendChild(w));const H=new P({container:G,trigger:w,color:N.color,title:N.title,modificationDate:N.modificationDate,contents:N.contents,hideWrapper:!0}).render();H.style.left=G.style.width,G.appendChild(H)}_renderQuadrilaterals(w){return this.quadrilaterals.forEach(N=>{N.className=w}),this.quadrilaterals}render(){(0,c.unreachable)("Abstract method `AnnotationElement.render` called")}}class r extends l{constructor(w){const N=!!(w.data.url||w.data.dest||w.data.action||w.data.isTooltipOnly||w.data.actions&&(w.data.actions.Action||w.data.actions["Mouse Up"]||w.data.actions["Mouse Down"]));super(w,{isRenderable:N,createQuadrilaterals:!0})}render(){const{data:w,linkService:N}=this,G=document.createElement("a");return w.url?(0,e.addLinkAttributes)(G,{url:w.url,target:w.newWindow?e.LinkTarget.BLANK:N.externalLinkTarget,rel:N.externalLinkRel,enabled:N.externalLinkEnabled}):w.action?this._bindNamedAction(G,w.action):w.dest?this._bindLink(G,w.dest):w.actions&&(w.actions.Action||w.actions["Mouse Up"]||w.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions?this._bindJSAction(G,w):this._bindLink(G,""),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((V,H)=>{const X=H===0?G:G.cloneNode();return V.appendChild(X),V}):(this.container.className="linkAnnotation",this.container.appendChild(G),this.container)}_bindLink(w,N){w.href=this.linkService.getDestinationHash(N),w.onclick=()=>(N&&this.linkService.goToDestination(N),!1),(N||N==="")&&(w.className="internalLink")}_bindNamedAction(w,N){w.href=this.linkService.getAnchorUrl(""),w.onclick=()=>(this.linkService.executeNamedAction(N),!1),w.className="internalLink"}_bindJSAction(w,N){w.href=this.linkService.getAnchorUrl("");const G=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const V of Object.keys(N.actions)){const H=G.get(V);H&&(w[H]=()=>{var X;return(X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N.id,name:V}}),!1})}w.className="internalLink"}}class d extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N})}render(){this.container.className="textAnnotation";const w=document.createElement("img");return w.style.height=this.container.style.height,w.style.width=this.container.style.width,w.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",w.alt="[{{type}} Annotation]",w.dataset.l10nId="text_annotation_type",w.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(w,this.data),this.container.appendChild(w),this.container}}class h extends l{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(w){return navigator.platform.includes("Win")&&w.ctrlKey||navigator.platform.includes("Mac")&&w.metaKey}_setEventListener(w,N,G,V){N.includes("mouse")?w.addEventListener(N,H=>{var X;(X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:G,value:V(H),shift:H.shiftKey,modifier:this._getKeyModifier(H)}})}):w.addEventListener(N,H=>{var X;(X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:G,value:H.target.checked}})})}_setEventListeners(w,N,G){var V;for(const[H,X]of N)(X==="Action"||(V=this.data.actions)!=null&&V[X])&&this._setEventListener(w,H,X,G)}_setColor(w){const{detail:N,target:G}=w,{style:V}=G;for(const H of["bgColor","fillColor","fgColor","textColor","borderColor","strokeColor"]){let X=N[H];if(X)switch(X=i.ColorConverters[`${X[0]}_HTML`](X.slice(1)),H){case"bgColor":case"fillColor":V.backgroundColor=X;break;case"fgColor":case"textColor":V.color=X;break;case"borderColor":case"strokeColor":V.borderColor=X;break}}}}class v extends h{constructor(w){const N=w.renderInteractiveForms||!w.data.hasAppearance&&!!w.data.fieldValue;super(w,{isRenderable:N})}render(){var V;const w=this.annotationStorage,N=this.data.id;this.container.className="textWidgetAnnotation";let G=null;if(this.renderInteractiveForms){const H=w.getValue(N,{value:this.data.fieldValue,valueAsString:this.data.fieldValue}),X=H.valueAsString||H.value||"",Q={userValue:null,formattedValue:null,beforeInputSelectionRange:null,beforeInputValue:null};this.data.multiLine?(G=document.createElement("textarea"),G.textContent=X):(G=document.createElement("input"),G.type="text",G.setAttribute("value",X)),Q.userValue=X,G.setAttribute("id",N),G.addEventListener("input",function(pe){w.setValue(N,{value:pe.target.value})});let ce=pe=>{Q.formattedValue&&(pe.target.value=Q.formattedValue),pe.target.setSelectionRange(0,0),Q.beforeInputSelectionRange=null};if(this.enableScripting&&this.hasJSActions){G.addEventListener("focus",_e=>{Q.userValue&&(_e.target.value=Q.userValue)}),G.addEventListener("updatefromsandbox",_e=>{const{detail:xe}=_e,Y={value(){Q.userValue=xe.value||"",w.setValue(N,{value:Q.userValue.toString()}),Q.formattedValue||(_e.target.value=Q.userValue)},valueAsString(){Q.formattedValue=xe.valueAsString||"",_e.target!==document.activeElement&&(_e.target.value=Q.formattedValue),w.setValue(N,{formattedValue:Q.formattedValue})},focus(){setTimeout(()=>_e.target.focus({preventScroll:!1}),0)},userName(){_e.target.title=xe.userName},hidden(){_e.target.style.visibility=xe.hidden?"hidden":"visible",w.setValue(N,{hidden:xe.hidden})},editable(){_e.target.disabled=!xe.editable},selRange(){const[F,ie]=xe.selRange;F>=0&&ie<_e.target.value.length&&_e.target.setSelectionRange(F,ie)}};Object.keys(xe).filter(F=>F in Y).forEach(F=>Y[F]()),this._setColor(_e)}),G.addEventListener("keydown",_e=>{var Y;Q.beforeInputValue=_e.target.value;let xe=-1;_e.key==="Escape"?xe=0:_e.key==="Enter"?xe=2:_e.key==="Tab"&&(xe=3),xe!==-1&&(Q.userValue=_e.target.value,(Y=this.linkService.eventBus)==null||Y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:_e.target.value,willCommit:!0,commitKey:xe,selStart:_e.target.selectionStart,selEnd:_e.target.selectionEnd}}))});const pe=ce;ce=null,G.addEventListener("blur",_e=>{var xe;this._mouseState.isDown&&(Q.userValue=_e.target.value,(xe=this.linkService.eventBus)==null||xe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:_e.target.value,willCommit:!0,commitKey:1,selStart:_e.target.selectionStart,selEnd:_e.target.selectionEnd}})),pe(_e)}),G.addEventListener("mousedown",_e=>{Q.beforeInputValue=_e.target.value,Q.beforeInputSelectionRange=null}),G.addEventListener("keyup",_e=>{_e.target.selectionStart===_e.target.selectionEnd&&(Q.beforeInputSelectionRange=null)}),G.addEventListener("select",_e=>{Q.beforeInputSelectionRange=[_e.target.selectionStart,_e.target.selectionEnd]}),(V=this.data.actions)!=null&&V.Keystroke&&G.addEventListener("input",_e=>{var F;let xe=-1,Y=-1;Q.beforeInputSelectionRange&&([xe,Y]=Q.beforeInputSelectionRange),(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:Q.beforeInputValue,change:_e.data,willCommit:!1,selStart:xe,selEnd:Y}})}),this._setEventListeners(G,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_e=>_e.target.value)}if(ce&&G.addEventListener("blur",ce),G.disabled=this.data.readOnly,G.name=this.data.fieldName,this.data.maxLen!==null&&(G.maxLength=this.data.maxLen),this.data.comb){const _e=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;G.classList.add("comb"),G.style.letterSpacing=`calc(${_e}px - 1ch)`}}else G=document.createElement("div"),G.textContent=this.data.fieldValue,G.style.verticalAlign="middle",G.style.display="table-cell";return this._setTextStyle(G),this.container.appendChild(G),this.container}_setTextStyle(w){const N=["left","center","right"],{fontSize:G,fontColor:V}=this.data.defaultAppearanceData,H=w.style;G&&(H.fontSize=`${G}px`),H.color=c.Util.makeHexColor(V[0],V[1],V[2]),this.data.textAlignment!==null&&(H.textAlign=N[this.data.textAlignment])}}class p extends h{constructor(w){super(w,{isRenderable:w.renderInteractiveForms})}render(){const w=this.annotationStorage,N=this.data,G=N.id,V=w.getValue(G,{value:N.fieldValue&&(N.exportValue&&N.exportValue===N.fieldValue||!N.exportValue&&N.fieldValue!=="Off")}).value;this.container.className="buttonWidgetAnnotation checkBox";const H=document.createElement("input");return H.disabled=N.readOnly,H.type="checkbox",H.name=this.data.fieldName,V&&H.setAttribute("checked",!0),H.setAttribute("id",G),H.addEventListener("change",function(X){const Q=X.target.name;for(const ce of document.getElementsByName(Q))ce!==X.target&&(ce.checked=!1,w.setValue(ce.parentNode.getAttribute("data-annotation-id"),{value:!1}));w.setValue(G,{value:X.target.checked})}),this.enableScripting&&this.hasJSActions&&(H.addEventListener("updatefromsandbox",X=>{const{detail:Q}=X,ce={value(){X.target.checked=Q.value!=="Off",w.setValue(G,{value:X.target.checked})},focus(){setTimeout(()=>X.target.focus({preventScroll:!1}),0)},hidden(){X.target.style.visibility=Q.hidden?"hidden":"visible",w.setValue(G,{hidden:Q.hidden})},editable(){X.target.disabled=!Q.editable}};Object.keys(Q).filter(pe=>pe in ce).forEach(pe=>ce[pe]()),this._setColor(X)}),this._setEventListeners(H,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],X=>X.target.checked)),this.container.appendChild(H),this.container}}class m extends h{constructor(w){super(w,{isRenderable:w.renderInteractiveForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const w=this.annotationStorage,N=this.data,G=N.id,V=w.getValue(G,{value:N.fieldValue===N.buttonValue}).value,H=document.createElement("input");if(H.disabled=N.readOnly,H.type="radio",H.name=N.fieldName,V&&H.setAttribute("checked",!0),H.setAttribute("id",G),H.addEventListener("change",function(X){const{target:Q}=X;for(const ce of document.getElementsByName(Q.name))ce!==Q&&w.setValue(ce.getAttribute("id"),{value:!1});w.setValue(G,{value:Q.checked})}),this.enableScripting&&this.hasJSActions){const X=N.buttonValue;H.addEventListener("updatefromsandbox",Q=>{const{detail:ce}=Q,pe={value(){const _e=X===ce.value;for(const xe of document.getElementsByName(Q.target.name)){const Y=xe.getAttribute("id");xe.checked=Y===G&&_e,w.setValue(Y,{value:xe.checked})}},focus(){setTimeout(()=>Q.target.focus({preventScroll:!1}),0)},hidden(){Q.target.style.visibility=ce.hidden?"hidden":"visible",w.setValue(G,{hidden:ce.hidden})},editable(){Q.target.disabled=!ce.editable}};Object.keys(ce).filter(_e=>_e in pe).forEach(_e=>pe[_e]()),this._setColor(Q)}),this._setEventListeners(H,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Q=>Q.target.checked)}return this.container.appendChild(H),this.container}}class A extends r{render(){const w=super.render();return w.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(w.title=this.data.alternativeText),w}}class y extends h{constructor(w){super(w,{isRenderable:w.renderInteractiveForms})}render(){this.container.className="choiceWidgetAnnotation";const w=this.annotationStorage,N=this.data.id;w.getValue(N,{value:this.data.fieldValue.length>0?this.data.fieldValue[0]:void 0});const G=document.createElement("select");G.disabled=this.data.readOnly,G.name=this.data.fieldName,G.setAttribute("id",N),this.data.combo||(G.size=this.data.options.length,this.data.multiSelect&&(G.multiple=!0));for(const X of this.data.options){const Q=document.createElement("option");Q.textContent=X.displayValue,Q.value=X.exportValue,this.data.fieldValue.includes(X.exportValue)&&Q.setAttribute("selected",!0),G.appendChild(Q)}const V=(X,Q)=>{const ce=Q?"value":"textContent",pe=X.target.options;return X.target.multiple?Array.prototype.filter.call(pe,_e=>_e.selected).map(_e=>_e[ce]):pe.selectedIndex===-1?null:pe[pe.selectedIndex][ce]},H=X=>{const Q=X.target.options;return Array.prototype.map.call(Q,ce=>({displayValue:ce.textContent,exportValue:ce.value}))};return this.enableScripting&&this.hasJSActions?(G.addEventListener("updatefromsandbox",X=>{const{detail:Q}=X,ce={value(){const pe=G.options,_e=Q.value,xe=new Set(Array.isArray(_e)?_e:[_e]);Array.prototype.forEach.call(pe,Y=>{Y.selected=xe.has(Y.value)}),w.setValue(N,{value:V(X,!0)})},multipleSelection(){G.multiple=!0},remove(){const pe=G.options,_e=Q.remove;pe[_e].selected=!1,G.remove(_e),pe.length>0&&Array.prototype.findIndex.call(pe,Y=>Y.selected)===-1&&(pe[0].selected=!0),w.setValue(N,{value:V(X,!0),items:H(X)})},clear(){for(;G.length!==0;)G.remove(0);w.setValue(N,{value:null,items:[]})},insert(){const{index:pe,displayValue:_e,exportValue:xe}=Q.insert,Y=document.createElement("option");Y.textContent=_e,Y.value=xe,G.insertBefore(Y,G.children[pe]),w.setValue(N,{value:V(X,!0),items:H(X)})},items(){const{items:pe}=Q;for(;G.length!==0;)G.remove(0);for(const _e of pe){const{displayValue:xe,exportValue:Y}=_e,F=document.createElement("option");F.textContent=xe,F.value=Y,G.appendChild(F)}G.options.length>0&&(G.options[0].selected=!0),w.setValue(N,{value:V(X,!0),items:H(X)})},indices(){const pe=new Set(Q.indices),_e=X.target.options;Array.prototype.forEach.call(_e,(xe,Y)=>{xe.selected=pe.has(Y)}),w.setValue(N,{value:V(X,!0)})},focus(){setTimeout(()=>X.target.focus({preventScroll:!1}),0)},hidden(){X.target.style.visibility=Q.hidden?"hidden":"visible",w.setValue(N,{hidden:Q.hidden})},editable(){X.target.disabled=!Q.editable}};Object.keys(Q).filter(pe=>pe in ce).forEach(pe=>ce[pe]()),this._setColor(X)}),G.addEventListener("input",X=>{var pe;const Q=V(X,!0),ce=V(X,!1);w.setValue(N,{value:Q}),(pe=this.linkService.eventBus)==null||pe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:ce,changeEx:Q,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(G,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],X=>X.target.checked)):G.addEventListener("input",function(X){w.setValue(N,{value:V(X)})}),this.container.appendChild(G),this.container}}class x extends l{constructor(w){const N=!!(w.data.title||w.data.contents);super(w,{isRenderable:N})}render(){const w=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",w.includes(this.data.parentType))return this.container;const N=`[data-annotation-id="${this.data.parentId}"]`,G=this.layer.querySelectorAll(N);if(G.length===0)return this.container;const V=new P({container:this.container,trigger:Array.from(G),color:this.data.color,title:this.data.title,modificationDate:this.data.modificationDate,contents:this.data.contents}),H=this.page,X=c.Util.normalizeRect([this.data.parentRect[0],H.view[3]-this.data.parentRect[1]+H.view[1],this.data.parentRect[2],H.view[3]-this.data.parentRect[3]+H.view[1]]),Q=X[0]+this.data.parentRect[2]-this.data.parentRect[0],ce=X[1];return this.container.style.transformOrigin=`${-Q}px ${-ce}px`,this.container.style.left=`${Q}px`,this.container.style.top=`${ce}px`,this.container.appendChild(V.render()),this.container}}class P{constructor(w){this.container=w.container,this.trigger=w.trigger,this.color=w.color,this.title=w.title,this.modificationDate=w.modificationDate,this.contents=w.contents,this.hideWrapper=w.hideWrapper||!1,this.pinned=!1}render(){const N=document.createElement("div");N.className="popupWrapper",this.hideElement=this.hideWrapper?N:this.container,this.hideElement.hidden=!0;const G=document.createElement("div");G.className="popup";const V=this.color;if(V){const ce=.7*(255-V[0])+V[0],pe=.7*(255-V[1])+V[1],_e=.7*(255-V[2])+V[2];G.style.backgroundColor=c.Util.makeHexColor(ce|0,pe|0,_e|0)}const H=document.createElement("h1");H.textContent=this.title,G.appendChild(H);const X=e.PDFDateString.toDateObject(this.modificationDate);if(X){const ce=document.createElement("span");ce.textContent="{{date}}, {{time}}",ce.dataset.l10nId="annotation_date_string",ce.dataset.l10nArgs=JSON.stringify({date:X.toLocaleDateString(),time:X.toLocaleTimeString()}),G.appendChild(ce)}const Q=this._formatContents(this.contents);return G.appendChild(Q),Array.isArray(this.trigger)||(this.trigger=[this.trigger]),this.trigger.forEach(ce=>{ce.addEventListener("click",this._toggle.bind(this)),ce.addEventListener("mouseover",this._show.bind(this,!1)),ce.addEventListener("mouseout",this._hide.bind(this,!1))}),G.addEventListener("click",this._hide.bind(this,!0)),N.appendChild(G),N}_formatContents(w){const N=document.createElement("p"),G=w.split(/(?:\r\n?|\n)/);for(let V=0,H=G.length;V<H;++V){const X=G[V];N.appendChild(document.createTextNode(X)),V<H-1&&N.appendChild(document.createElement("br"))}return N}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(w=!1){w&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(w=!0){w&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class L extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N,ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class T extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const w=this.data,N=w.rect[2]-w.rect[0],G=w.rect[3]-w.rect[1],V=this.svgFactory.create(N,G),H=this.svgFactory.createElement("svg:line");return H.setAttribute("x1",w.rect[2]-w.lineCoordinates[0]),H.setAttribute("y1",w.rect[3]-w.lineCoordinates[1]),H.setAttribute("x2",w.rect[2]-w.lineCoordinates[2]),H.setAttribute("y2",w.rect[3]-w.lineCoordinates[3]),H.setAttribute("stroke-width",w.borderStyle.width||1),H.setAttribute("stroke","transparent"),V.appendChild(H),this.container.append(V),this._createPopup(H,w),this.container}}class g extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const w=this.data,N=w.rect[2]-w.rect[0],G=w.rect[3]-w.rect[1],V=this.svgFactory.create(N,G),H=w.borderStyle.width,X=this.svgFactory.createElement("svg:rect");return X.setAttribute("x",H/2),X.setAttribute("y",H/2),X.setAttribute("width",N-H),X.setAttribute("height",G-H),X.setAttribute("stroke-width",H||1),X.setAttribute("stroke","transparent"),X.setAttribute("fill","none"),V.appendChild(X),this.container.append(V),this._createPopup(X,w),this.container}}class _ extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const w=this.data,N=w.rect[2]-w.rect[0],G=w.rect[3]-w.rect[1],V=this.svgFactory.create(N,G),H=w.borderStyle.width,X=this.svgFactory.createElement("svg:ellipse");return X.setAttribute("cx",N/2),X.setAttribute("cy",G/2),X.setAttribute("rx",N/2-H/2),X.setAttribute("ry",G/2-H/2),X.setAttribute("stroke-width",H||1),X.setAttribute("stroke","transparent"),X.setAttribute("fill","none"),V.appendChild(X),this.container.append(V),this._createPopup(X,w),this.container}}class u extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const w=this.data,N=w.rect[2]-w.rect[0],G=w.rect[3]-w.rect[1],V=this.svgFactory.create(N,G);let H=[];for(const Q of w.vertices){const ce=Q.x-w.rect[0],pe=w.rect[3]-Q.y;H.push(ce+","+pe)}H=H.join(" ");const X=this.svgFactory.createElement(this.svgElementName);return X.setAttribute("points",H),X.setAttribute("stroke-width",w.borderStyle.width||1),X.setAttribute("stroke","transparent"),X.setAttribute("fill","none"),V.appendChild(X),this.container.append(V),this._createPopup(X,w),this.container}}class b extends u{constructor(w){super(w),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class S extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class M extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const w=this.data,N=w.rect[2]-w.rect[0],G=w.rect[3]-w.rect[1],V=this.svgFactory.create(N,G);for(const H of w.inkLists){let X=[];for(const ce of H){const pe=ce.x-w.rect[0],_e=w.rect[3]-ce.y;X.push(`${pe},${_e}`)}X=X.join(" ");const Q=this.svgFactory.createElement(this.svgElementName);Q.setAttribute("points",X),Q.setAttribute("stroke-width",w.borderStyle.width||1),Q.setAttribute("stroke","transparent"),Q.setAttribute("fill","none"),this._createPopup(Q,w),V.appendChild(Q)}return this.container.append(V),this.container}}class R extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class C extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class D extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class B extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class Z extends l{constructor(w){const N=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:N,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class J extends l{constructor(w){var V;super(w,{isRenderable:!0});const{filename:N,content:G}=this.data.file;this.filename=(0,e.getFilenameFromUrl)(N),this.content=G,(V=this.linkService.eventBus)==null||V.dispatch("fileattachmentannotation",{source:this,id:(0,c.stringToPDFString)(N),filename:N,content:G})}render(){this.container.className="fileAttachmentAnnotation";const w=document.createElement("div");return w.style.height=this.container.style.height,w.style.width=this.container.style.width,w.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.title||this.data.contents)&&this._createPopup(w,this.data),this.container.appendChild(w),this.container}_download(){var w;(w=this.downloadManager)==null||w.openOrDownloadData(this.container,this.content,this.filename)}}class q{static render(w){const N=[],G=[];for(const V of w.annotations)if(V){if(V.annotationType===c.AnnotationType.POPUP){G.push(V);continue}N.push(V)}G.length&&N.push(...G);for(const V of N){const H=o.create({data:V,layer:w.div,page:w.page,viewport:w.viewport,linkService:w.linkService,downloadManager:w.downloadManager,imageResourcesPath:w.imageResourcesPath||"",renderInteractiveForms:w.renderInteractiveForms!==!1,svgFactory:new e.DOMSVGFactory,annotationStorage:w.annotationStorage||new a.AnnotationStorage,enableScripting:w.enableScripting,hasJSActions:w.hasJSActions,mouseState:w.mouseState||{isDown:!1}});if(H.isRenderable){const X=H.render();if(V.hidden&&(X.style.visibility="hidden"),Array.isArray(X))for(const Q of X)w.div.appendChild(Q);else H instanceof x?w.div.prepend(X):w.div.appendChild(X)}}}static update(w){const N=`matrix(${w.viewport.transform.join(",")})`;for(const G of w.annotations){const V=w.div.querySelectorAll(`[data-annotation-id="${G.id}"]`);V&&V.forEach(H=>{H.style.transform=N})}w.div.hidden=!1}}n.AnnotationLayer=q},(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function s(c){return Math.floor(Math.max(0,Math.min(1,c))*255).toString(16).padStart(2,"0")}class e{static CMYK_G([a,i,o,l]){return["G",1-Math.min(1,.3*a+.59*o+.11*i+l)]}static G_CMYK([a]){return["CMYK",0,0,0,1-a]}static G_RGB([a]){return["RGB",a,a,a]}static G_HTML([a]){const i=s(a);return`#${i}${i}${i}`}static RGB_G([a,i,o]){return["G",.3*a+.59*i+.11*o]}static RGB_HTML([a,i,o]){const l=s(a),r=s(i),d=s(o);return`#${l}${r}${d}`}static T_HTML(){return"#00000000"}static CMYK_RGB([a,i,o,l]){return["RGB",1-Math.min(1,a+l),1-Math.min(1,o+l),1-Math.min(1,i+l)]}static CMYK_HTML(a){return this.RGB_HTML(this.CMYK_RGB(a))}static RGB_CMYK([a,i,o]){const l=1-a,r=1-i,d=1-o,h=Math.min(l,r,d);return["CMYK",l,r,d,h]}}n.ColorConverters=e},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.renderTextLayer=void 0;var e=s(2);const c=function(){const r=new Map,d=/\S/;function h(g){return!d.test(g)}function v(g,_){const u=r.get(g);if(u)return u;_.save(),_.font=`30px ${g}`;const b=_.measureText("");let S=b.fontBoundingBoxAscent,M=Math.abs(b.fontBoundingBoxDescent);if(S){_.restore();const C=S/(S+M);return r.set(g,C),C}_.strokeStyle="red",_.clearRect(0,0,30,30),_.strokeText("g",0,0);let R=_.getImageData(0,0,30,30).data;M=0;for(let C=R.length-1-3;C>=0;C-=4)if(R[C]>0){M=Math.ceil(C/4/30);break}_.clearRect(0,0,30,30),_.strokeText("A",0,30),R=_.getImageData(0,0,30,30).data,S=0;for(let C=0,D=R.length;C<D;C+=4)if(R[C]>0){S=30-Math.floor(C/4/30);break}if(_.restore(),S){const C=S/(S+M);return r.set(g,C),C}return r.set(g,.8),.8}function p(g,_,u,b){const S=document.createElement("span"),M={angle:0,canvasWidth:0,isWhitespace:!1,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};if(g._textDivs.push(S),h(_.str)){M.isWhitespace=!0,g._textDivProperties.set(S,M);return}const R=e.Util.transform(g._viewport.transform,_.transform);let C=Math.atan2(R[1],R[0]);const D=u[_.fontName];D.vertical&&(C+=Math.PI/2);const B=Math.hypot(R[2],R[3]),Z=B*v(D.fontFamily,b);let J,q;C===0?(J=R[4],q=R[5]-Z):(J=R[4]+Z*Math.sin(C),q=R[5]-Z*Math.cos(C)),S.style.left=`${J}px`,S.style.top=`${q}px`,S.style.fontSize=`${B}px`,S.style.fontFamily=D.fontFamily,S.textContent=_.str,S.dir=_.dir,g._fontInspectorEnabled&&(S.dataset.fontName=_.fontName),C!==0&&(M.angle=C*(180/Math.PI));let z=!1;if(_.str.length>1)z=!0;else if(_.transform[0]!==_.transform[3]){const w=Math.abs(_.transform[0]),N=Math.abs(_.transform[3]);w!==N&&Math.max(w,N)/Math.min(w,N)>1.5&&(z=!0)}if(z&&(D.vertical?M.canvasWidth=_.height*g._viewport.scale:M.canvasWidth=_.width*g._viewport.scale),g._textDivProperties.set(S,M),g._textContentStream&&g._layoutText(S),g._enhanceTextSelection){let w=1,N=0;C!==0&&(w=Math.cos(C),N=Math.sin(C));const G=(D.vertical?_.height:_.width)*g._viewport.scale,V=B;let H,X;C!==0?(H=[w,N,-N,w,J,q],X=e.Util.getAxialAlignedBoundingBox([0,0,G,V],H)):X=[J,q,J+G,q+V],g._bounds.push({left:X[0],top:X[1],right:X[2],bottom:X[3],div:S,size:[G,V],m:H})}}function m(g){if(g._canceled)return;const _=g._textDivs,u=g._capability,b=_.length;if(b>1e5){g._renderingDone=!0,u.resolve();return}if(!g._textContentStream)for(let S=0;S<b;S++)g._layoutText(_[S]);g._renderingDone=!0,u.resolve()}function A(g,_,u){let b=0;for(let S=0;S<u;S++){const M=g[_++];M>0&&(b=b?Math.min(M,b):M)}return b}function y(g){const _=g._bounds,u=g._viewport,b=x(u.width,u.height,_);for(let S=0;S<b.length;S++){const M=_[S].div,R=g._textDivProperties.get(M);if(R.angle===0){R.paddingLeft=_[S].left-b[S].left,R.paddingTop=_[S].top-b[S].top,R.paddingRight=b[S].right-_[S].right,R.paddingBottom=b[S].bottom-_[S].bottom,g._textDivProperties.set(M,R);continue}const C=b[S],D=_[S],B=D.m,Z=B[0],J=B[1],q=[[0,0],[0,D.size[1]],[D.size[0],0],D.size],z=new Float64Array(64);q.forEach(function(N,G){const V=e.Util.applyTransform(N,B);z[G+0]=Z&&(C.left-V[0])/Z,z[G+4]=J&&(C.top-V[1])/J,z[G+8]=Z&&(C.right-V[0])/Z,z[G+12]=J&&(C.bottom-V[1])/J,z[G+16]=J&&(C.left-V[0])/-J,z[G+20]=Z&&(C.top-V[1])/Z,z[G+24]=J&&(C.right-V[0])/-J,z[G+28]=Z&&(C.bottom-V[1])/Z,z[G+32]=Z&&(C.left-V[0])/-Z,z[G+36]=J&&(C.top-V[1])/-J,z[G+40]=Z&&(C.right-V[0])/-Z,z[G+44]=J&&(C.bottom-V[1])/-J,z[G+48]=J&&(C.left-V[0])/J,z[G+52]=Z&&(C.top-V[1])/-Z,z[G+56]=J&&(C.right-V[0])/J,z[G+60]=Z&&(C.bottom-V[1])/-Z});const w=1+Math.min(Math.abs(Z),Math.abs(J));R.paddingLeft=A(z,32,16)/w,R.paddingTop=A(z,48,16)/w,R.paddingRight=A(z,0,16)/w,R.paddingBottom=A(z,16,16)/w,g._textDivProperties.set(M,R)}}function x(g,_,u){const b=u.map(function(M,R){return{x1:M.left,y1:M.top,x2:M.right,y2:M.bottom,index:R,x1New:void 0,x2New:void 0}});P(g,b);const S=new Array(u.length);return b.forEach(function(M){const R=M.index;S[R]={left:M.x1New,top:0,right:M.x2New,bottom:0}}),u.map(function(M,R){const C=S[R],D=b[R];D.x1=M.top,D.y1=g-C.right,D.x2=M.bottom,D.y2=g-C.left,D.index=R,D.x1New=void 0,D.x2New=void 0}),P(_,b),b.forEach(function(M){const R=M.index;S[R].top=M.x1New,S[R].bottom=M.x2New}),S}function P(g,_){_.sort(function(S,M){return S.x1-M.x1||S.index-M.index});const b=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];_.forEach(function(S){let M=0;for(;M<b.length&&b[M].end<=S.y1;)M++;let R=b.length-1;for(;R>=0&&b[R].start>=S.y2;)R--;let C,D,B,Z,J=-1/0;for(B=M;B<=R;B++){C=b[B],D=C.boundary;let w;D.x2>S.x1?w=D.index>S.index?D.x1New:S.x1:D.x2New===void 0?w=(D.x2+S.x1)/2:w=D.x2New,w>J&&(J=w)}for(S.x1New=J,B=M;B<=R;B++)C=b[B],D=C.boundary,D.x2New===void 0?D.x2>S.x1?D.index>S.index&&(D.x2New=D.x2):D.x2New=J:D.x2New>J&&(D.x2New=Math.max(J,D.x2));const q=[];let z=null;for(B=M;B<=R;B++){C=b[B],D=C.boundary;const w=D.x2>S.x2?D:S;z===w?q[q.length-1].end=C.end:(q.push({start:C.start,end:C.end,boundary:w}),z=w)}for(b[M].start<S.y1&&(q[0].start=S.y1,q.unshift({start:b[M].start,end:S.y1,boundary:b[M].boundary})),S.y2<b[R].end&&(q[q.length-1].end=S.y2,q.push({start:S.y2,end:b[R].end,boundary:b[R].boundary})),B=M;B<=R;B++){if(C=b[B],D=C.boundary,D.x2New!==void 0)continue;let w=!1;for(Z=M-1;!w&&Z>=0&&b[Z].start>=D.y1;Z--)w=b[Z].boundary===D;for(Z=R+1;!w&&Z<b.length&&b[Z].end<=D.y2;Z++)w=b[Z].boundary===D;for(Z=0;!w&&Z<q.length;Z++)w=q[Z].boundary===D;w||(D.x2New=J)}Array.prototype.splice.apply(b,[M,R-M+1].concat(q))}),b.forEach(function(S){const M=S.boundary;M.x2New===void 0&&(M.x2New=Math.max(g,M.x2))})}function L({textContent:g,textContentStream:_,container:u,viewport:b,textDivs:S,textContentItemsStr:M,enhanceTextSelection:R}){var C;this._textContent=g,this._textContentStream=_,this._container=u,this._document=u.ownerDocument,this._viewport=b,this._textDivs=S||[],this._textContentItemsStr=M||[],this._enhanceTextSelection=!!R,this._fontInspectorEnabled=!!((C=globalThis.FontInspector)!=null&&C.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,e.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally(()=>{this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}L.prototype={get promise(){return this._capability.promise},cancel:function(){this._canceled=!0,this._reader&&(this._reader.cancel(new e.AbortException("TextLayer task cancelled.")),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))},_processItems(g,_){for(let u=0,b=g.length;u<b;u++)this._textContentItemsStr.push(g[u].str),p(this,g[u],_,this._layoutTextCtx)},_layoutText(g){const _=this._textDivProperties.get(g);if(_.isWhitespace)return;let u="";if(_.canvasWidth!==0){const{fontSize:b,fontFamily:S}=g.style;(b!==this._layoutTextLastFontSize||S!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${b} ${S}`,this._layoutTextLastFontSize=b,this._layoutTextLastFontFamily=S);const{width:M}=this._layoutTextCtx.measureText(g.textContent);M>0&&(_.scale=_.canvasWidth/M,u=`scaleX(${_.scale})`)}_.angle!==0&&(u=`rotate(${_.angle}deg) ${u}`),u.length>0&&(this._enhanceTextSelection&&(_.originalTransform=u),g.style.transform=u),this._textDivProperties.set(g,_),this._container.appendChild(g)},_render:function(_){const u=(0,e.createPromiseCapability)();let b=Object.create(null);const S=this._document.createElement("canvas");if(S.height=S.width=30,S.mozOpaque=!0,this._layoutTextCtx=S.getContext("2d",{alpha:!1}),this._textContent){const M=this._textContent.items,R=this._textContent.styles;this._processItems(M,R),u.resolve()}else if(this._textContentStream){const M=()=>{this._reader.read().then(({value:R,done:C})=>{if(C){u.resolve();return}Object.assign(b,R.styles),this._processItems(R.items,b),M()},u.reject)};this._reader=this._textContentStream.getReader(),M()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');u.promise.then(()=>{b=null,_?this._renderTimer=setTimeout(()=>{m(this),this._renderTimer=null},_):m(this)},this._capability.reject)},expandTextDivs:function(_){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(y(this),this._bounds=null);const u=[],b=[];for(let S=0,M=this._textDivs.length;S<M;S++){const R=this._textDivs[S],C=this._textDivProperties.get(R);C.isWhitespace||(_?(u.length=0,b.length=0,C.originalTransform&&u.push(C.originalTransform),C.paddingTop>0?(b.push(`${C.paddingTop}px`),u.push(`translateY(${-C.paddingTop}px)`)):b.push(0),C.paddingRight>0?b.push(`${C.paddingRight/C.scale}px`):b.push(0),C.paddingBottom>0?b.push(`${C.paddingBottom}px`):b.push(0),C.paddingLeft>0?(b.push(`${C.paddingLeft/C.scale}px`),u.push(`translateX(${-C.paddingLeft/C.scale}px)`)):b.push(0),R.style.padding=b.join(" "),u.length&&(R.style.transform=u.join(" "))):(R.style.padding=null,R.style.transform=C.originalTransform))}}};function T(g){const _=new L({textContent:g.textContent,textContentStream:g.textContentStream,container:g.container,viewport:g.viewport,textDivs:g.textDivs,textContentItemsStr:g.textContentItemsStr,enhanceTextSelection:g.enhanceTextSelection});return _._render(g.timeout),_}return T}();n.renderTextLayer=c},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var e=s(2),c=s(1),a=s(4);let i=function(){throw new Error("Not implemented: SVGGraphics")};n.SVGGraphics=i;{let x=function(u){let b=[];const S=[];for(const M of u){if(M.fn==="save"){b.push({fnId:92,fn:"group",items:[]}),S.push(b),b=b[b.length-1].items;continue}M.fn==="restore"?b=S.pop():b.push(M)}return b},P=function(u){if(Number.isInteger(u))return u.toString();const b=u.toFixed(10);let S=b.length-1;if(b[S]!=="0")return b;do S--;while(b[S]==="0");return b.substring(0,b[S]==="."?S:S+1)},L=function(u){if(u[4]===0&&u[5]===0){if(u[1]===0&&u[2]===0)return u[0]===1&&u[3]===1?"":`scale(${P(u[0])} ${P(u[3])})`;if(u[0]===u[3]&&u[1]===-u[2]){const b=Math.acos(u[0])*180/Math.PI;return`rotate(${P(b)})`}}else if(u[0]===1&&u[1]===0&&u[2]===0&&u[3]===1)return`translate(${P(u[4])} ${P(u[5])})`;return`matrix(${P(u[0])} ${P(u[1])} ${P(u[2])} ${P(u[3])} ${P(u[4])} ${P(u[5])})`};var o=x,l=P,r=L;const d={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},h="http://www.w3.org/XML/1998/namespace",v="http://www.w3.org/1999/xlink",p=["butt","round","square"],m=["miter","round","bevel"],A=function(){const u=new Uint8Array([137,80,78,71,13,10,26,10]),b=12,S=new Int32Array(256);for(let J=0;J<256;J++){let q=J;for(let z=0;z<8;z++)q&1?q=3988292384^q>>1&2147483647:q=q>>1&2147483647;S[J]=q}function M(J,q,z){let w=-1;for(let N=q;N<z;N++){const G=(w^J[N])&255,V=S[G];w=w>>>8^V}return w^-1}function R(J,q,z,w){let N=w;const G=q.length;z[N]=G>>24&255,z[N+1]=G>>16&255,z[N+2]=G>>8&255,z[N+3]=G&255,N+=4,z[N]=J.charCodeAt(0)&255,z[N+1]=J.charCodeAt(1)&255,z[N+2]=J.charCodeAt(2)&255,z[N+3]=J.charCodeAt(3)&255,N+=4,z.set(q,N),N+=q.length;const V=M(z,w+4,N);z[N]=V>>24&255,z[N+1]=V>>16&255,z[N+2]=V>>8&255,z[N+3]=V&255}function C(J,q,z){let w=1,N=0;for(let G=q;G<z;++G)w=(w+(J[G]&255))%65521,N=(N+w)%65521;return N<<16|w}function D(J){if(!a.isNodeJS)return B(J);try{let q;parseInt(process.versions.node)>=8?q=J:q=Buffer.from(J);const z=require("zlib").deflateSync(q,{level:9});return z instanceof Uint8Array?z:new Uint8Array(z)}catch(q){(0,e.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+q)}return B(J)}function B(J){let q=J.length;const z=65535,w=Math.ceil(q/z),N=new Uint8Array(2+q+w*5+4);let G=0;N[G++]=120,N[G++]=156;let V=0;for(;q>z;)N[G++]=0,N[G++]=255,N[G++]=255,N[G++]=0,N[G++]=0,N.set(J.subarray(V,V+z),G),G+=z,V+=z,q-=z;N[G++]=1,N[G++]=q&255,N[G++]=q>>8&255,N[G++]=~q&65535&255,N[G++]=(~q&65535)>>8&255,N.set(J.subarray(V),G),G+=J.length-V;const H=C(J,0,J.length);return N[G++]=H>>24&255,N[G++]=H>>16&255,N[G++]=H>>8&255,N[G++]=H&255,N}function Z(J,q,z,w){const N=J.width,G=J.height;let V,H,X;const Q=J.data;switch(q){case e.ImageKind.GRAYSCALE_1BPP:H=0,V=1,X=N+7>>3;break;case e.ImageKind.RGB_24BPP:H=2,V=8,X=N*3;break;case e.ImageKind.RGBA_32BPP:H=6,V=8,X=N*4;break;default:throw new Error("invalid format")}const ce=new Uint8Array((1+X)*G);let pe=0,_e=0;for(let de=0;de<G;++de)ce[pe++]=0,ce.set(Q.subarray(_e,_e+X),pe),_e+=X,pe+=X;if(q===e.ImageKind.GRAYSCALE_1BPP&&w){pe=0;for(let de=0;de<G;de++){pe++;for(let ve=0;ve<X;ve++)ce[pe++]^=255}}const xe=new Uint8Array([N>>24&255,N>>16&255,N>>8&255,N&255,G>>24&255,G>>16&255,G>>8&255,G&255,V,H,0,0,0]),Y=D(ce),F=u.length+b*3+xe.length+Y.length,ie=new Uint8Array(F);let ae=0;return ie.set(u,ae),ae+=u.length,R("IHDR",xe,ie,ae),ae+=b+xe.length,R("IDATA",Y,ie,ae),ae+=b+Y.length,R("IEND",new Uint8Array(0),ie,ae),(0,e.createObjectURL)(ie,"image/png",z)}return function(q,z,w){const N=q.kind===void 0?e.ImageKind.GRAYSCALE_1BPP:q.kind;return Z(q,N,z,w)}}();class y{constructor(){this.fontSizeScale=1,this.fontWeight=d.fontWeight,this.fontSize=0,this.textMatrix=e.IDENTITY_MATRIX,this.fontMatrix=e.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=e.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=d.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(b,S){this.x=b,this.y=S}}let T=0,g=0,_=0;n.SVGGraphics=i=class{constructor(b,S,M=!1){this.svgFactory=new c.DOMSVGFactory,this.current=new y,this.transformMatrix=e.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=b,this.objs=S,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!M,this._operatorIdMapping=[];for(const R in e.OPS)this._operatorIdMapping[e.OPS[R]]=R}save(){this.transformStack.push(this.transformMatrix);const b=this.current;this.extraStack.push(b),this.current=b.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(b){this.save(),this.executeOpTree(b),this.restore()}loadDependencies(b){const S=b.fnArray,M=b.argsArray;for(let R=0,C=S.length;R<C;R++)if(S[R]===e.OPS.dependency)for(const D of M[R]){const B=D.startsWith("g_")?this.commonObjs:this.objs,Z=new Promise(J=>{B.get(D,J)});this.current.dependencies.push(Z)}return Promise.all(this.current.dependencies)}transform(b,S,M,R,C,D){const B=[b,S,M,R,C,D];this.transformMatrix=e.Util.transform(this.transformMatrix,B),this.tgrp=null}getSVG(b,S){this.viewport=S;const M=this._initialize(S);return this.loadDependencies(b).then(()=>(this.transformMatrix=e.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(b)),M))}convertOpList(b){const S=this._operatorIdMapping,M=b.argsArray,R=b.fnArray,C=[];for(let D=0,B=R.length;D<B;D++){const Z=R[D];C.push({fnId:Z,fn:S[Z],args:M[D]})}return x(C)}executeOpTree(b){for(const S of b){const M=S.fn,R=S.fnId,C=S.args;switch(R|0){case e.OPS.beginText:this.beginText();break;case e.OPS.dependency:break;case e.OPS.setLeading:this.setLeading(C);break;case e.OPS.setLeadingMoveText:this.setLeadingMoveText(C[0],C[1]);break;case e.OPS.setFont:this.setFont(C);break;case e.OPS.showText:this.showText(C[0]);break;case e.OPS.showSpacedText:this.showText(C[0]);break;case e.OPS.endText:this.endText();break;case e.OPS.moveText:this.moveText(C[0],C[1]);break;case e.OPS.setCharSpacing:this.setCharSpacing(C[0]);break;case e.OPS.setWordSpacing:this.setWordSpacing(C[0]);break;case e.OPS.setHScale:this.setHScale(C[0]);break;case e.OPS.setTextMatrix:this.setTextMatrix(C[0],C[1],C[2],C[3],C[4],C[5]);break;case e.OPS.setTextRise:this.setTextRise(C[0]);break;case e.OPS.setTextRenderingMode:this.setTextRenderingMode(C[0]);break;case e.OPS.setLineWidth:this.setLineWidth(C[0]);break;case e.OPS.setLineJoin:this.setLineJoin(C[0]);break;case e.OPS.setLineCap:this.setLineCap(C[0]);break;case e.OPS.setMiterLimit:this.setMiterLimit(C[0]);break;case e.OPS.setFillRGBColor:this.setFillRGBColor(C[0],C[1],C[2]);break;case e.OPS.setStrokeRGBColor:this.setStrokeRGBColor(C[0],C[1],C[2]);break;case e.OPS.setStrokeColorN:this.setStrokeColorN(C);break;case e.OPS.setFillColorN:this.setFillColorN(C);break;case e.OPS.shadingFill:this.shadingFill(C[0]);break;case e.OPS.setDash:this.setDash(C[0],C[1]);break;case e.OPS.setRenderingIntent:this.setRenderingIntent(C[0]);break;case e.OPS.setFlatness:this.setFlatness(C[0]);break;case e.OPS.setGState:this.setGState(C[0]);break;case e.OPS.fill:this.fill();break;case e.OPS.eoFill:this.eoFill();break;case e.OPS.stroke:this.stroke();break;case e.OPS.fillStroke:this.fillStroke();break;case e.OPS.eoFillStroke:this.eoFillStroke();break;case e.OPS.clip:this.clip("nonzero");break;case e.OPS.eoClip:this.clip("evenodd");break;case e.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case e.OPS.paintImageXObject:this.paintImageXObject(C[0]);break;case e.OPS.paintInlineImageXObject:this.paintInlineImageXObject(C[0]);break;case e.OPS.paintImageMaskXObject:this.paintImageMaskXObject(C[0]);break;case e.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(C[0],C[1]);break;case e.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case e.OPS.closePath:this.closePath();break;case e.OPS.closeStroke:this.closeStroke();break;case e.OPS.closeFillStroke:this.closeFillStroke();break;case e.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case e.OPS.nextLine:this.nextLine();break;case e.OPS.transform:this.transform(C[0],C[1],C[2],C[3],C[4],C[5]);break;case e.OPS.constructPath:this.constructPath(C[0],C[1]);break;case e.OPS.endPath:this.endPath();break;case 92:this.group(S.items);break;default:(0,e.warn)(`Unimplemented operator ${M}`);break}}}setWordSpacing(b){this.current.wordSpacing=b}setCharSpacing(b){this.current.charSpacing=b}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(b,S,M,R,C,D){const B=this.current;B.textMatrix=B.lineMatrix=[b,S,M,R,C,D],B.textMatrixScale=Math.hypot(b,S),B.x=B.lineX=0,B.y=B.lineY=0,B.xcoords=[],B.ycoords=[],B.tspan=this.svgFactory.createElement("svg:tspan"),B.tspan.setAttributeNS(null,"font-family",B.fontFamily),B.tspan.setAttributeNS(null,"font-size",`${P(B.fontSize)}px`),B.tspan.setAttributeNS(null,"y",P(-B.y)),B.txtElement=this.svgFactory.createElement("svg:text"),B.txtElement.appendChild(B.tspan)}beginText(){const b=this.current;b.x=b.lineX=0,b.y=b.lineY=0,b.textMatrix=e.IDENTITY_MATRIX,b.lineMatrix=e.IDENTITY_MATRIX,b.textMatrixScale=1,b.tspan=this.svgFactory.createElement("svg:tspan"),b.txtElement=this.svgFactory.createElement("svg:text"),b.txtgrp=this.svgFactory.createElement("svg:g"),b.xcoords=[],b.ycoords=[]}moveText(b,S){const M=this.current;M.x=M.lineX+=b,M.y=M.lineY+=S,M.xcoords=[],M.ycoords=[],M.tspan=this.svgFactory.createElement("svg:tspan"),M.tspan.setAttributeNS(null,"font-family",M.fontFamily),M.tspan.setAttributeNS(null,"font-size",`${P(M.fontSize)}px`),M.tspan.setAttributeNS(null,"y",P(-M.y))}showText(b){const S=this.current,M=S.font,R=S.fontSize;if(R===0)return;const C=S.fontSizeScale,D=S.charSpacing,B=S.wordSpacing,Z=S.fontDirection,J=S.textHScale*Z,q=M.vertical,z=q?1:-1,w=M.defaultVMetrics,N=R*S.fontMatrix[0];let G=0;for(const X of b){if(X===null){G+=Z*B;continue}else if((0,e.isNum)(X)){G+=z*X*R/1e3;continue}const Q=(X.isSpace?B:0)+D,ce=X.fontChar;let pe,_e,xe=X.width;if(q){let F;const ie=X.vmetric||w;F=X.vmetric?ie[1]:xe*.5,F=-F*N;const ae=ie[2]*N;xe=ie?-ie[0]:xe,pe=F/C,_e=(G+ae)/C}else pe=G/C,_e=0;(X.isInFont||M.missingFile)&&(S.xcoords.push(S.x+pe),q&&S.ycoords.push(-S.y+_e),S.tspan.textContent+=ce);let Y;q?Y=xe*N-Q*Z:Y=xe*N+Q*Z,G+=Y}S.tspan.setAttributeNS(null,"x",S.xcoords.map(P).join(" ")),q?S.tspan.setAttributeNS(null,"y",S.ycoords.map(P).join(" ")):S.tspan.setAttributeNS(null,"y",P(-S.y)),q?S.y-=G:S.x+=G*J,S.tspan.setAttributeNS(null,"font-family",S.fontFamily),S.tspan.setAttributeNS(null,"font-size",`${P(S.fontSize)}px`),S.fontStyle!==d.fontStyle&&S.tspan.setAttributeNS(null,"font-style",S.fontStyle),S.fontWeight!==d.fontWeight&&S.tspan.setAttributeNS(null,"font-weight",S.fontWeight);const V=S.textRenderingMode&e.TextRenderingMode.FILL_STROKE_MASK;if(V===e.TextRenderingMode.FILL||V===e.TextRenderingMode.FILL_STROKE?(S.fillColor!==d.fillColor&&S.tspan.setAttributeNS(null,"fill",S.fillColor),S.fillAlpha<1&&S.tspan.setAttributeNS(null,"fill-opacity",S.fillAlpha)):S.textRenderingMode===e.TextRenderingMode.ADD_TO_PATH?S.tspan.setAttributeNS(null,"fill","transparent"):S.tspan.setAttributeNS(null,"fill","none"),V===e.TextRenderingMode.STROKE||V===e.TextRenderingMode.FILL_STROKE){const X=1/(S.textMatrixScale||1);this._setStrokeAttributes(S.tspan,X)}let H=S.textMatrix;S.textRise!==0&&(H=H.slice(),H[5]+=S.textRise),S.txtElement.setAttributeNS(null,"transform",`${L(H)} scale(${P(J)}, -1)`),S.txtElement.setAttributeNS(h,"xml:space","preserve"),S.txtElement.appendChild(S.tspan),S.txtgrp.appendChild(S.txtElement),this._ensureTransformGroup().appendChild(S.txtElement)}setLeadingMoveText(b,S){this.setLeading(-S),this.moveText(b,S)}addFontStyle(b){if(!b.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const S=(0,e.createObjectURL)(b.data,b.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${b.loadedName}"; src: url(${S}); }
`}setFont(b){const S=this.current,M=this.commonObjs.get(b[0]);let R=b[1];S.font=M,this.embedFonts&&!M.missingFile&&!this.embeddedFonts[M.loadedName]&&(this.addFontStyle(M),this.embeddedFonts[M.loadedName]=M),S.fontMatrix=M.fontMatrix||e.FONT_IDENTITY_MATRIX;let C="normal";M.black?C="900":M.bold&&(C="bold");const D=M.italic?"italic":"normal";R<0?(R=-R,S.fontDirection=-1):S.fontDirection=1,S.fontSize=R,S.fontFamily=M.loadedName,S.fontWeight=C,S.fontStyle=D,S.tspan=this.svgFactory.createElement("svg:tspan"),S.tspan.setAttributeNS(null,"y",P(-S.y)),S.xcoords=[],S.ycoords=[]}endText(){var S;const b=this.current;b.textRenderingMode&e.TextRenderingMode.ADD_TO_PATH_FLAG&&((S=b.txtElement)!=null&&S.hasChildNodes())&&(b.element=b.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(b){b>0&&(this.current.lineWidth=b)}setLineCap(b){this.current.lineCap=p[b]}setLineJoin(b){this.current.lineJoin=m[b]}setMiterLimit(b){this.current.miterLimit=b}setStrokeAlpha(b){this.current.strokeAlpha=b}setStrokeRGBColor(b,S,M){this.current.strokeColor=e.Util.makeHexColor(b,S,M)}setFillAlpha(b){this.current.fillAlpha=b}setFillRGBColor(b,S,M){this.current.fillColor=e.Util.makeHexColor(b,S,M),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(b){this.current.strokeColor=this._makeColorN_Pattern(b)}setFillColorN(b){this.current.fillColor=this._makeColorN_Pattern(b)}shadingFill(b){const S=this.viewport.width,M=this.viewport.height,R=e.Util.inverseTransform(this.transformMatrix),C=e.Util.applyTransform([0,0],R),D=e.Util.applyTransform([0,M],R),B=e.Util.applyTransform([S,0],R),Z=e.Util.applyTransform([S,M],R),J=Math.min(C[0],D[0],B[0],Z[0]),q=Math.min(C[1],D[1],B[1],Z[1]),z=Math.max(C[0],D[0],B[0],Z[0]),w=Math.max(C[1],D[1],B[1],Z[1]),N=this.svgFactory.createElement("svg:rect");N.setAttributeNS(null,"x",J),N.setAttributeNS(null,"y",q),N.setAttributeNS(null,"width",z-J),N.setAttributeNS(null,"height",w-q),N.setAttributeNS(null,"fill",this._makeShadingPattern(b)),this.current.fillAlpha<1&&N.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(N)}_makeColorN_Pattern(b){return b[0]==="TilingPattern"?this._makeTilingPattern(b):this._makeShadingPattern(b)}_makeTilingPattern(b){const S=b[1],M=b[2],R=b[3]||e.IDENTITY_MATRIX,[C,D,B,Z]=b[4],J=b[5],q=b[6],z=b[7],w=`shading${_++}`,[N,G]=e.Util.applyTransform([C,D],R),[V,H]=e.Util.applyTransform([B,Z],R),[X,Q]=e.Util.singularValueDecompose2dScale(R),ce=J*X,pe=q*Q,_e=this.svgFactory.createElement("svg:pattern");_e.setAttributeNS(null,"id",w),_e.setAttributeNS(null,"patternUnits","userSpaceOnUse"),_e.setAttributeNS(null,"width",ce),_e.setAttributeNS(null,"height",pe),_e.setAttributeNS(null,"x",`${N}`),_e.setAttributeNS(null,"y",`${G}`);const xe=this.svg,Y=this.transformMatrix,F=this.current.fillColor,ie=this.current.strokeColor,ae=this.svgFactory.create(V-N,H-G);if(this.svg=ae,this.transformMatrix=R,z===2){const de=e.Util.makeHexColor(...S);this.current.fillColor=de,this.current.strokeColor=de}return this.executeOpTree(this.convertOpList(M)),this.svg=xe,this.transformMatrix=Y,this.current.fillColor=F,this.current.strokeColor=ie,_e.appendChild(ae.childNodes[0]),this.defs.appendChild(_e),`url(#${w})`}_makeShadingPattern(b){switch(b[0]){case"RadialAxial":const S=`shading${_++}`,M=b[3];let R;switch(b[1]){case"axial":const C=b[4],D=b[5];R=this.svgFactory.createElement("svg:linearGradient"),R.setAttributeNS(null,"id",S),R.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),R.setAttributeNS(null,"x1",C[0]),R.setAttributeNS(null,"y1",C[1]),R.setAttributeNS(null,"x2",D[0]),R.setAttributeNS(null,"y2",D[1]);break;case"radial":const B=b[4],Z=b[5],J=b[6],q=b[7];R=this.svgFactory.createElement("svg:radialGradient"),R.setAttributeNS(null,"id",S),R.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),R.setAttributeNS(null,"cx",Z[0]),R.setAttributeNS(null,"cy",Z[1]),R.setAttributeNS(null,"r",q),R.setAttributeNS(null,"fx",B[0]),R.setAttributeNS(null,"fy",B[1]),R.setAttributeNS(null,"fr",J);break;default:throw new Error(`Unknown RadialAxial type: ${b[1]}`)}for(const C of M){const D=this.svgFactory.createElement("svg:stop");D.setAttributeNS(null,"offset",C[0]),D.setAttributeNS(null,"stop-color",C[1]),R.appendChild(D)}return this.defs.appendChild(R),`url(#${S})`;case"Mesh":return(0,e.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${b[0]}`)}}setDash(b,S){this.current.dashArray=b,this.current.dashPhase=S}constructPath(b,S){const M=this.current;let R=M.x,C=M.y,D=[],B=0;for(const Z of b)switch(Z|0){case e.OPS.rectangle:R=S[B++],C=S[B++];const J=S[B++],q=S[B++],z=R+J,w=C+q;D.push("M",P(R),P(C),"L",P(z),P(C),"L",P(z),P(w),"L",P(R),P(w),"Z");break;case e.OPS.moveTo:R=S[B++],C=S[B++],D.push("M",P(R),P(C));break;case e.OPS.lineTo:R=S[B++],C=S[B++],D.push("L",P(R),P(C));break;case e.OPS.curveTo:R=S[B+4],C=S[B+5],D.push("C",P(S[B]),P(S[B+1]),P(S[B+2]),P(S[B+3]),P(R),P(C)),B+=6;break;case e.OPS.curveTo2:D.push("C",P(R),P(C),P(S[B]),P(S[B+1]),P(S[B+2]),P(S[B+3])),R=S[B+2],C=S[B+3],B+=4;break;case e.OPS.curveTo3:R=S[B+2],C=S[B+3],D.push("C",P(S[B]),P(S[B+1]),P(R),P(C),P(R),P(C)),B+=4;break;case e.OPS.closePath:D.push("Z");break}D=D.join(" "),M.path&&b.length>0&&b[0]!==e.OPS.rectangle&&b[0]!==e.OPS.moveTo?D=M.path.getAttributeNS(null,"d")+D:(M.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(M.path)),M.path.setAttributeNS(null,"d",D),M.path.setAttributeNS(null,"fill","none"),M.element=M.path,M.setCurrentPoint(R,C)}endPath(){const b=this.current;if(b.path=null,!this.pendingClip)return;if(!b.element){this.pendingClip=null;return}const S=`clippath${T++}`,M=this.svgFactory.createElement("svg:clipPath");M.setAttributeNS(null,"id",S),M.setAttributeNS(null,"transform",L(this.transformMatrix));const R=b.element.cloneNode(!0);this.pendingClip==="evenodd"?R.setAttributeNS(null,"clip-rule","evenodd"):R.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,M.appendChild(R),this.defs.appendChild(M),b.activeClipUrl&&(b.clipGroup=null,this.extraStack.forEach(function(C){C.clipGroup=null}),M.setAttributeNS(null,"clip-path",b.activeClipUrl)),b.activeClipUrl=`url(#${S})`,this.tgrp=null}clip(b){this.pendingClip=b}closePath(){const b=this.current;if(b.path){const S=`${b.path.getAttributeNS(null,"d")}Z`;b.path.setAttributeNS(null,"d",S)}}setLeading(b){this.current.leading=-b}setTextRise(b){this.current.textRise=b}setTextRenderingMode(b){this.current.textRenderingMode=b}setHScale(b){this.current.textHScale=b/100}setRenderingIntent(b){}setFlatness(b){}setGState(b){for(const[S,M]of b)switch(S){case"LW":this.setLineWidth(M);break;case"LC":this.setLineCap(M);break;case"LJ":this.setLineJoin(M);break;case"ML":this.setMiterLimit(M);break;case"D":this.setDash(M[0],M[1]);break;case"RI":this.setRenderingIntent(M);break;case"FL":this.setFlatness(M);break;case"Font":this.setFont(M);break;case"CA":this.setStrokeAlpha(M);break;case"ca":this.setFillAlpha(M);break;default:(0,e.warn)(`Unimplemented graphic state operator ${S}`);break}}fill(){const b=this.current;b.element&&(b.element.setAttributeNS(null,"fill",b.fillColor),b.element.setAttributeNS(null,"fill-opacity",b.fillAlpha),this.endPath())}stroke(){const b=this.current;b.element&&(this._setStrokeAttributes(b.element),b.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(b,S=1){const M=this.current;let R=M.dashArray;S!==1&&R.length>0&&(R=R.map(function(C){return S*C})),b.setAttributeNS(null,"stroke",M.strokeColor),b.setAttributeNS(null,"stroke-opacity",M.strokeAlpha),b.setAttributeNS(null,"stroke-miterlimit",P(M.miterLimit)),b.setAttributeNS(null,"stroke-linecap",M.lineCap),b.setAttributeNS(null,"stroke-linejoin",M.lineJoin),b.setAttributeNS(null,"stroke-width",P(S*M.lineWidth)+"px"),b.setAttributeNS(null,"stroke-dasharray",R.map(P).join(" ")),b.setAttributeNS(null,"stroke-dashoffset",P(S*M.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const b=this.svgFactory.createElement("svg:rect");b.setAttributeNS(null,"x","0"),b.setAttributeNS(null,"y","0"),b.setAttributeNS(null,"width","1px"),b.setAttributeNS(null,"height","1px"),b.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(b)}paintImageXObject(b){const S=b.startsWith("g_")?this.commonObjs.get(b):this.objs.get(b);if(!S){(0,e.warn)(`Dependent image with object ID ${b} is not ready yet`);return}this.paintInlineImageXObject(S)}paintInlineImageXObject(b,S){const M=b.width,R=b.height,C=A(b,this.forceDataSchema,!!S),D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y","0"),D.setAttributeNS(null,"width",P(M)),D.setAttributeNS(null,"height",P(R)),this.current.element=D,this.clip("nonzero");const B=this.svgFactory.createElement("svg:image");B.setAttributeNS(v,"xlink:href",C),B.setAttributeNS(null,"x","0"),B.setAttributeNS(null,"y",P(-R)),B.setAttributeNS(null,"width",P(M)+"px"),B.setAttributeNS(null,"height",P(R)+"px"),B.setAttributeNS(null,"transform",`scale(${P(1/M)} ${P(-1/R)})`),S?S.appendChild(B):this._ensureTransformGroup().appendChild(B)}paintImageMaskXObject(b){const S=this.current,M=b.width,R=b.height,C=S.fillColor;S.maskId=`mask${g++}`;const D=this.svgFactory.createElement("svg:mask");D.setAttributeNS(null,"id",S.maskId);const B=this.svgFactory.createElement("svg:rect");B.setAttributeNS(null,"x","0"),B.setAttributeNS(null,"y","0"),B.setAttributeNS(null,"width",P(M)),B.setAttributeNS(null,"height",P(R)),B.setAttributeNS(null,"fill",C),B.setAttributeNS(null,"mask",`url(#${S.maskId})`),this.defs.appendChild(D),this._ensureTransformGroup().appendChild(B),this.paintInlineImageXObject(b,D)}paintFormXObjectBegin(b,S){if(Array.isArray(b)&&b.length===6&&this.transform(b[0],b[1],b[2],b[3],b[4],b[5]),S){const M=S[2]-S[0],R=S[3]-S[1],C=this.svgFactory.createElement("svg:rect");C.setAttributeNS(null,"x",S[0]),C.setAttributeNS(null,"y",S[1]),C.setAttributeNS(null,"width",P(M)),C.setAttributeNS(null,"height",P(R)),this.current.element=C,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(b){const S=this.svgFactory.create(b.width,b.height),M=this.svgFactory.createElement("svg:defs");S.appendChild(M),this.defs=M;const R=this.svgFactory.createElement("svg:g");return R.setAttributeNS(null,"transform",L(b.transform)),S.appendChild(R),this.svg=R,S}_ensureClipGroup(){if(!this.current.clipGroup){const b=this.svgFactory.createElement("svg:g");b.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(b),this.current.clipGroup=b}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",L(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;class s{static setAttributes(c,a){for(const[i,o]of Object.entries(a))o!=null&&(i!=="style"?c.setAttribute(i,o):Object.assign(c.style,o))}static render(c){const a=c.xfa,i=document.createElement(a.name);a.attributes&&s.setAttributes(i,a.attributes);const o=[[a,-1,i]],l=c.div;l.appendChild(i);const r=c.viewport.transform.join(",");for(l.style.transform=`matrix(${r})`,l.setAttribute("class","xfaLayer xfaFont");o.length>0;){const[d,h,v]=o[o.length-1];if(h+1===d.children.length){o.pop();continue}const p=d.children[++o[o.length-1][1]];if(p===null)continue;const{name:m}=p;if(m==="#text"){v.appendChild(document.createTextNode(p.value));continue}const A=document.createElement(m);v.appendChild(A),p.attributes&&s.setAttributes(A,p.attributes),p.children&&p.children.length>0?o.push([p,-1,A]):p.value&&A.appendChild(document.createTextNode(p.value))}}static update(c){const a=`matrix(${c.viewport.transform.join(",")})`;c.div.style.transform=a,c.div.hidden=!1}}n.XfaLayer=s},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var e=s(2),c=s(24);const a=require("fs"),i=require("http"),o=require("https"),l=require("url"),r=/^file:\/\/\/[a-zA-Z]:\//;function d(L){const T=l.parse(L);return T.protocol==="file:"||T.host?T:/^[a-z]:[/\\]/i.test(L)?l.parse(`file:///${L}`):(T.host||(T.protocol="file:"),T)}class h{constructor(T){this.source=T,this.url=d(T.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&T.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var T;return((T=this._fullRequestReader)==null?void 0:T._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new x(this):new A(this),this._fullRequestReader}getRangeReader(T,g){if(g<=this._progressiveDataLength)return null;const _=this.isFsUrl?new P(this,T,g):new y(this,T,g);return this._rangeRequestReaders.push(_),_}cancelAllRequests(T){this._fullRequestReader&&this._fullRequestReader.cancel(T),this._rangeRequestReaders.slice(0).forEach(function(_){_.cancel(T)})}}n.PDFNodeStream=h;class v{constructor(T){this._url=T.url,this._done=!1,this._storedError=null,this.onProgress=null;const g=T.source;this._contentLength=g.length,this._loaded=0,this._filename=null,this._disableRange=g.disableRange||!1,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!g.disableStream,this._isRangeSupported=!g.disableRange,this._readableStream=null,this._readCapability=(0,e.createPromiseCapability)(),this._headersCapability=(0,e.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const T=this._readableStream.read();return T===null?(this._readCapability=(0,e.createPromiseCapability)(),this.read()):(this._loaded+=T.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(T).buffer,done:!1})}cancel(T){if(!this._readableStream){this._error(T);return}this._readableStream.destroy(T)}_error(T){this._storedError=T,this._readCapability.resolve()}_setReadableStream(T){this._readableStream=T,T.on("readable",()=>{this._readCapability.resolve()}),T.on("end",()=>{T.destroy(),this._done=!0,this._readCapability.resolve()}),T.on("error",g=>{this._error(g)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new e.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class p{constructor(T){this._url=T.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,e.createPromiseCapability)();const g=T.source;this._isStreamingSupported=!g.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const T=this._readableStream.read();return T===null?(this._readCapability=(0,e.createPromiseCapability)(),this.read()):(this._loaded+=T.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(T).buffer,done:!1})}cancel(T){if(!this._readableStream){this._error(T);return}this._readableStream.destroy(T)}_error(T){this._storedError=T,this._readCapability.resolve()}_setReadableStream(T){this._readableStream=T,T.on("readable",()=>{this._readCapability.resolve()}),T.on("end",()=>{T.destroy(),this._done=!0,this._readCapability.resolve()}),T.on("error",g=>{this._error(g)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function m(L,T){return{protocol:L.protocol,auth:L.auth,host:L.hostname,port:L.port,path:L.path,method:"GET",headers:T}}class A extends v{constructor(T){super(T);const g=_=>{if(_.statusCode===404){const M=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=M,this._headersCapability.reject(M);return}this._headersCapability.resolve(),this._setReadableStream(_);const u=M=>this._readableStream.headers[M.toLowerCase()],{allowRangeRequests:b,suggestedLength:S}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:T.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=b,this._contentLength=S||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(u)};this._request=null,this._url.protocol==="http:"?this._request=i.request(m(this._url,T.httpHeaders),g):this._request=o.request(m(this._url,T.httpHeaders),g),this._request.on("error",_=>{this._storedError=_,this._headersCapability.reject(_)}),this._request.end()}}class y extends p{constructor(T,g,_){super(T),this._httpHeaders={};for(const b in T.httpHeaders){const S=T.httpHeaders[b];typeof S>"u"||(this._httpHeaders[b]=S)}this._httpHeaders.Range=`bytes=${g}-${_-1}`;const u=b=>{if(b.statusCode===404){const S=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=S;return}this._setReadableStream(b)};this._request=null,this._url.protocol==="http:"?this._request=i.request(m(this._url,this._httpHeaders),u):this._request=o.request(m(this._url,this._httpHeaders),u),this._request.on("error",b=>{this._storedError=b}),this._request.end()}}class x extends v{constructor(T){super(T);let g=decodeURIComponent(this._url.path);r.test(this._url.href)&&(g=g.replace(/^\//,"")),a.lstat(g,(_,u)=>{if(_){_.code==="ENOENT"&&(_=new e.MissingPDFException(`Missing PDF "${g}".`)),this._storedError=_,this._headersCapability.reject(_);return}this._contentLength=u.size,this._setReadableStream(a.createReadStream(g)),this._headersCapability.resolve()})}}class P extends p{constructor(T,g,_){super(T);let u=decodeURIComponent(this._url.path);r.test(this._url.href)&&(u=u.replace(/^\//,"")),this._setReadableStream(a.createReadStream(u,{start:g,end:_-1}))}}},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=l,n.extractFilenameFromHeader=o,n.validateRangeRequestCapabilities=i,n.validateResponseStatus=r;var e=s(2),c=s(25),a=s(1);function i({getResponseHeader:d,isHttp:h,rangeChunkSize:v,disableRange:p}){(0,e.assert)(v>0,"Range chunk size must be larger than zero");const m={allowRangeRequests:!1,suggestedLength:void 0},A=parseInt(d("Content-Length"),10);return!Number.isInteger(A)||(m.suggestedLength=A,A<=2*v)||p||!h||d("Accept-Ranges")!=="bytes"||(d("Content-Encoding")||"identity")!=="identity"||(m.allowRangeRequests=!0),m}function o(d){const h=d("Content-Disposition");if(h){let v=(0,c.getFilenameFromContentDispositionHeader)(h);if(v.includes("%"))try{v=decodeURIComponent(v)}catch{}if((0,a.isPdfFile)(v))return v}return null}function l(d,h){return d===404||d===0&&h.startsWith("file:")?new e.MissingPDFException('Missing PDF "'+h+'".'):new e.UnexpectedResponseException(`Unexpected server response (${d}) while retrieving PDF "${h}".`,d)}function r(d){return d===200||d===206}},(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=s;function s(e){let c=!0,a=i("filename\\*","i").exec(e);if(a){a=a[1];let p=d(a);return p=unescape(p),p=h(p),p=v(p),l(p)}if(a=r(e),a){const p=v(a);return l(p)}if(a=i("filename","i").exec(e),a){a=a[1];let p=d(a);return p=v(p),l(p)}function i(p,m){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function o(p,m){if(p){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const A=new TextDecoder(p,{fatal:!0}),y=Array.from(m,function(x){return x.charCodeAt(0)&255});m=A.decode(new Uint8Array(y)),c=!1}catch{if(/^utf-?8$/i.test(p))try{m=decodeURIComponent(escape(m)),c=!1}catch{}}}return m}function l(p){return c&&/[\x80-\xff]/.test(p)&&(p=o("utf-8",p),c&&(p=o("iso-8859-1",p))),p}function r(p){const m=[];let A;const y=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(A=y.exec(p))!==null;){let[,P,L,T]=A;if(P=parseInt(P,10),P in m){if(P===0)break;continue}m[P]=[L,T]}const x=[];for(let P=0;P<m.length&&P in m;++P){let[L,T]=m[P];T=d(T),L&&(T=unescape(T),P===0&&(T=h(T))),x.push(T)}return x.join("")}function d(p){if(p.startsWith('"')){const m=p.slice(1).split('\\"');for(let A=0;A<m.length;++A){const y=m[A].indexOf('"');y!==-1&&(m[A]=m[A].slice(0,y),m.length=A+1),m[A]=m[A].replace(/\\(.)/g,"$1")}p=m.join('"')}return p}function h(p){const m=p.indexOf("'");if(m===-1)return p;const A=p.slice(0,m),x=p.slice(m+1).replace(/^[^']*'/,"");return o(A,x)}function v(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,A,y,x){if(y==="q"||y==="Q")return x=x.replace(/_/g," "),x=x.replace(/=([0-9a-fA-F]{2})/g,function(P,L){return String.fromCharCode(parseInt(L,16))}),o(A,x);try{x=atob(x)}catch{}return o(A,x)})}return""}},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var e=s(2),c=s(24);const a=200,i=206;function o(v){const p=v.response;return typeof p!="string"?p:(0,e.stringToBytes)(p).buffer}class l{constructor(p,m){this.url=p,m=m||{},this.isHttp=/^https?:/i.test(p),this.httpHeaders=this.isHttp&&m.httpHeaders||{},this.withCredentials=m.withCredentials||!1,this.getXhr=m.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(p,m,A){const y={begin:p,end:m};for(const x in A)y[x]=A[x];return this.request(y)}requestFull(p){return this.request(p)}request(p){const m=this.getXhr(),A=this.currXhrId++,y=this.pendingRequests[A]={xhr:m};m.open("GET",this.url),m.withCredentials=this.withCredentials;for(const x in this.httpHeaders){const P=this.httpHeaders[x];typeof P>"u"||m.setRequestHeader(x,P)}return this.isHttp&&"begin"in p&&"end"in p?(m.setRequestHeader("Range",`bytes=${p.begin}-${p.end-1}`),y.expectedStatus=i):y.expectedStatus=a,m.responseType="arraybuffer",p.onError&&(m.onerror=function(x){p.onError(m.status)}),m.onreadystatechange=this.onStateChange.bind(this,A),m.onprogress=this.onProgress.bind(this,A),y.onHeadersReceived=p.onHeadersReceived,y.onDone=p.onDone,y.onError=p.onError,y.onProgress=p.onProgress,m.send(null),A}onProgress(p,m){const A=this.pendingRequests[p];A&&A.onProgress&&A.onProgress(m)}onStateChange(p,m){const A=this.pendingRequests[p];if(!A)return;const y=A.xhr;if(y.readyState>=2&&A.onHeadersReceived&&(A.onHeadersReceived(),delete A.onHeadersReceived),y.readyState!==4||!(p in this.pendingRequests))return;if(delete this.pendingRequests[p],y.status===0&&this.isHttp){A.onError&&A.onError(y.status);return}const x=y.status||a;if(!(x===a&&A.expectedStatus===i)&&x!==A.expectedStatus){A.onError&&A.onError(y.status);return}const L=o(y);if(x===i){const T=y.getResponseHeader("Content-Range"),g=/bytes (\d+)-(\d+)\/(\d+)/.exec(T);A.onDone({begin:parseInt(g[1],10),chunk:L})}else L?A.onDone({begin:0,chunk:L}):A.onError&&A.onError(y.status)}getRequestXhr(p){return this.pendingRequests[p].xhr}isPendingRequest(p){return p in this.pendingRequests}abortRequest(p){const m=this.pendingRequests[p].xhr;delete this.pendingRequests[p],m.abort()}}class r{constructor(p){this._source=p,this._manager=new l(p.url,{httpHeaders:p.httpHeaders,withCredentials:p.withCredentials}),this._rangeChunkSize=p.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(p){const m=this._rangeRequestReaders.indexOf(p);m>=0&&this._rangeRequestReaders.splice(m,1)}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new d(this._manager,this._source),this._fullRequestReader}getRangeReader(p,m){const A=new h(this._manager,p,m);return A.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(A),A}cancelAllRequests(p){this._fullRequestReader&&this._fullRequestReader.cancel(p),this._rangeRequestReaders.slice(0).forEach(function(A){A.cancel(p)})}}n.PDFNetworkStream=r;class d{constructor(p,m){this._manager=p;const A={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=m.url,this._fullRequestId=p.requestFull(A),this._headersReceivedCapability=(0,e.createPromiseCapability)(),this._disableRange=m.disableRange||!1,this._contentLength=m.length,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const p=this._fullRequestId,m=this._manager.getRequestXhr(p),A=P=>m.getResponseHeader(P),{allowRangeRequests:y,suggestedLength:x}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:A,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});y&&(this._isRangeSupported=!0),this._contentLength=x||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(A),this._isRangeSupported&&this._manager.abortRequest(p),this._headersReceivedCapability.resolve()}_onDone(p){p&&(this._requests.length>0?this._requests.shift().resolve({value:p.chunk,done:!1}):this._cachedChunks.push(p.chunk)),this._done=!0,!(this._cachedChunks.length>0)&&(this._requests.forEach(function(m){m.resolve({value:void 0,done:!0})}),this._requests=[])}_onError(p){const m=this._url,A=(0,c.createResponseStatusError)(p,m);this._storedError=A,this._headersReceivedCapability.reject(A),this._requests.forEach(function(y){y.reject(A)}),this._requests=[],this._cachedChunks=[]}_onProgress(p){this.onProgress&&this.onProgress({loaded:p.loaded,total:p.lengthComputable?p.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const p=(0,e.createPromiseCapability)();return this._requests.push(p),p.promise}cancel(p){this._done=!0,this._headersReceivedCapability.reject(p),this._requests.forEach(function(m){m.resolve({value:void 0,done:!0})}),this._requests=[],this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class h{constructor(p,m,A){this._manager=p;const y={onDone:this._onDone.bind(this),onProgress:this._onProgress.bind(this)};this._requestId=p.requestRange(m,A,y),this._requests=[],this._queuedChunk=null,this._done=!1,this.onProgress=null,this.onClosed=null}_close(){this.onClosed&&this.onClosed(this)}_onDone(p){const m=p.chunk;this._requests.length>0?this._requests.shift().resolve({value:m,done:!1}):this._queuedChunk=m,this._done=!0,this._requests.forEach(function(A){A.resolve({value:void 0,done:!0})}),this._requests=[],this._close()}_onProgress(p){!this.isStreamingSupported&&this.onProgress&&this.onProgress({loaded:p.loaded})}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk!==null){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const p=(0,e.createPromiseCapability)();return this._requests.push(p),p.promise}cancel(p){this._done=!0,this._requests.forEach(function(m){m.resolve({value:void 0,done:!0})}),this._requests=[],this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(t,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var e=s(2),c=s(24);function a(d,h,v){return{method:"GET",headers:d,signal:v==null?void 0:v.signal,mode:"cors",credentials:h?"include":"same-origin",redirect:"follow"}}function i(d){const h=new Headers;for(const v in d){const p=d[v];typeof p>"u"||h.append(v,p)}return h}class o{constructor(h){this.source=h,this.isHttp=/^https?:/i.test(h.url),this.httpHeaders=this.isHttp&&h.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var h;return((h=this._fullRequestReader)==null?void 0:h._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new l(this),this._fullRequestReader}getRangeReader(h,v){if(v<=this._progressiveDataLength)return null;const p=new r(this,h,v);return this._rangeRequestReaders.push(p),p}cancelAllRequests(h){this._fullRequestReader&&this._fullRequestReader.cancel(h),this._rangeRequestReaders.slice(0).forEach(function(p){p.cancel(h)})}}n.PDFFetchStream=o;class l{constructor(h){this._stream=h,this._reader=null,this._loaded=0,this._filename=null;const v=h.source;this._withCredentials=v.withCredentials||!1,this._contentLength=v.length,this._headersCapability=(0,e.createPromiseCapability)(),this._disableRange=v.disableRange||!1,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),typeof AbortController<"u"&&(this._abortController=new AbortController),this._isStreamingSupported=!v.disableStream,this._isRangeSupported=!v.disableRange,this._headers=i(this._stream.httpHeaders);const p=v.url;fetch(p,a(this._headers,this._withCredentials,this._abortController)).then(m=>{if(!(0,c.validateResponseStatus)(m.status))throw(0,c.createResponseStatusError)(m.status,p);this._reader=m.body.getReader(),this._headersCapability.resolve();const A=P=>m.headers.get(P),{allowRangeRequests:y,suggestedLength:x}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:A,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=y,this._contentLength=x||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(A),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new e.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:h,done:v}=await this._reader.read();return v?{value:h,done:v}:(this._loaded+=h.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){this._reader&&this._reader.cancel(h),this._abortController&&this._abortController.abort()}}class r{constructor(h,v,p){this._stream=h,this._reader=null,this._loaded=0;const m=h.source;this._withCredentials=m.withCredentials||!1,this._readCapability=(0,e.createPromiseCapability)(),this._isStreamingSupported=!m.disableStream,typeof AbortController<"u"&&(this._abortController=new AbortController),this._headers=i(this._stream.httpHeaders),this._headers.append("Range",`bytes=${v}-${p-1}`);const A=m.url;fetch(A,a(this._headers,this._withCredentials,this._abortController)).then(y=>{if(!(0,c.validateResponseStatus)(y.status))throw(0,c.createResponseStatusError)(y.status,A);this._readCapability.resolve(),this._reader=y.body.getReader()}).catch(y=>{if((y==null?void 0:y.name)!=="AbortError")throw y}),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:h,done:v}=await this._reader.read();return v?{value:h,done:v}:(this._loaded+=h.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){this._reader&&this._reader.cancel(h),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(t){var n=__webpack_module_cache__[t];if(n!==void 0)return n.exports;var s=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](s,s.exports,__w_pdfjs_require__),s.exports}var __webpack_exports__={};return(()=>{var t=__webpack_exports__;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addLinkAttributes",{enumerable:!0,get:function(){return n.addLinkAttributes}}),Object.defineProperty(t,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(t,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(t,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(t,"LinkTarget",{enumerable:!0,get:function(){return n.LinkTarget}}),Object.defineProperty(t,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(t,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(t,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(t,"build",{enumerable:!0,get:function(){return s.build}}),Object.defineProperty(t,"getDocument",{enumerable:!0,get:function(){return s.getDocument}}),Object.defineProperty(t,"LoopbackPort",{enumerable:!0,get:function(){return s.LoopbackPort}}),Object.defineProperty(t,"PDFDataRangeTransport",{enumerable:!0,get:function(){return s.PDFDataRangeTransport}}),Object.defineProperty(t,"PDFWorker",{enumerable:!0,get:function(){return s.PDFWorker}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return s.version}}),Object.defineProperty(t,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(t,"createObjectURL",{enumerable:!0,get:function(){return e.createObjectURL}}),Object.defineProperty(t,"createPromiseCapability",{enumerable:!0,get:function(){return e.createPromiseCapability}}),Object.defineProperty(t,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(t,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(t,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(t,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(t,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(t,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(t,"removeNullCharacters",{enumerable:!0,get:function(){return e.removeNullCharacters}}),Object.defineProperty(t,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(t,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(t,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return e.UNSUPPORTED_FEATURES}}),Object.defineProperty(t,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(t,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(t,"AnnotationLayer",{enumerable:!0,get:function(){return c.AnnotationLayer}}),Object.defineProperty(t,"apiCompatibilityParams",{enumerable:!0,get:function(){return a.apiCompatibilityParams}}),Object.defineProperty(t,"GlobalWorkerOptions",{enumerable:!0,get:function(){return i.GlobalWorkerOptions}}),Object.defineProperty(t,"renderTextLayer",{enumerable:!0,get:function(){return o.renderTextLayer}}),Object.defineProperty(t,"SVGGraphics",{enumerable:!0,get:function(){return l.SVGGraphics}}),Object.defineProperty(t,"XfaLayer",{enumerable:!0,get:function(){return r.XfaLayer}});var n=__w_pdfjs_require__(1),s=__w_pdfjs_require__(5),e=__w_pdfjs_require__(2),c=__w_pdfjs_require__(18),a=__w_pdfjs_require__(9),i=__w_pdfjs_require__(12),o=__w_pdfjs_require__(20),l=__w_pdfjs_require__(21),r=__w_pdfjs_require__(22);{const{isNodeJS:d}=__w_pdfjs_require__(4);if(d){const h=__w_pdfjs_require__(23).PDFNodeStream;(0,s.setPDFNetworkStreamFactory)(v=>new h(v))}else{const h=__w_pdfjs_require__(26).PDFNetworkStream;let v;(0,n.isFetchSupported)()&&(v=__w_pdfjs_require__(27).PDFFetchStream),(0,s.setPDFNetworkStreamFactory)(p=>v&&(0,n.isValidFetchUrl)(p.url)?new v(p):new h(p))}}})(),__webpack_exports__})()});let exportAnyPalette;/**
 * Modules in this bundle
 * @license
 *
 * anypalette:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Isaiah Odhner <isaiahodhner@gmail.com>
 *   homepage: https://1j01.github.io/anypalette.js/
 *   version: 0.6.0
 *
 * base64-js:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: T. Jameson Little <t.jameson.little@gmail.com>
 *   homepage: https://github.com/beatgammit/base64-js
 *   version: 1.5.1
 *
 * browser-resolve:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Roman Shtylman <shtylman@gmail.com>
 *   homepage: https://github.com/browserify/browser-resolve#readme
 *   version: 2.0.0
 *
 * buffer:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Feross Aboukhadijeh <feross@feross.org>
 *   contributors: Romain Beauxis <toots@rastageeks.org>, James Halliday <mail@substack.net>
 *   homepage: https://github.com/feross/buffer
 *   version: 5.2.1
 *
 * css.escape:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Mathias Bynens
 *   homepage: https://mths.be/cssescape
 *   version: 1.5.1
 *
 * events:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Irakli Gozalishvili <rfobic@gmail.com>
 *   homepage: https://github.com/Gozala/events#readme
 *   version: 3.2.0
 *
 * ieee754:
 *   license: BSD-3-Clause (http://opensource.org/licenses/BSD-3-Clause)
 *   author: Feross Aboukhadijeh <feross@feross.org>
 *   contributors: Romain Beauxis <toots@rastageeks.org>
 *   homepage: https://github.com/feross/ieee754#readme
 *   version: 1.2.1
 *
 * inherits:
 *   license: ISC (http://opensource.org/licenses/ISC)
 *   homepage: https://github.com/isaacs/inherits#readme
 *   version: 2.0.4
 *
 * jdataview:
 *   licenses: WTFPL (http://www.wtfpl.net/about/)
 *   author: Vjeux <vjeuxx@gmail.com>
 *   contributors: Vjeux <vjeuxx@gmail.com>, RReverser <me@rreverser.com>
 *   homepage: http://jDataView.github.io/
 *   version: 2.5.0
 *
 * process:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Roman Shtylman <shtylman@gmail.com>
 *   homepage: https://github.com/shtylman/node-process#readme
 *   version: 0.11.10
 *
 * readable-stream:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   homepage: https://github.com/nodejs/readable-stream#readme
 *   version: 3.6.0
 *
 * safe-buffer:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Feross Aboukhadijeh <feross@feross.org>
 *   homepage: https://github.com/feross/safe-buffer
 *   version: 5.1.2
 *
 * sax:
 *   license: ISC (http://opensource.org/licenses/ISC)
 *   author: Isaac Z. Schlueter <i@izs.me>
 *   homepage: https://github.com/isaacs/sax-js#readme
 *   version: 1.2.4
 *
 * stream-browserify:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: James Halliday <mail@substack.net>
 *   homepage: https://github.com/browserify/stream-browserify
 *   version: 3.0.0
 *
 * string_decoder:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   homepage: https://github.com/nodejs/string_decoder
 *   version: 1.1.1
 *
 * util-deprecate:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Nathan Rajlich <nathan@tootallnate.net>
 *   homepage: https://github.com/TooTallNate/util-deprecate
 *   version: 1.0.2
 *
 * xml-js:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Yousuf Almarzooqi <ysf953@gmail.com>
 *   homepage: https://github.com/nashwaan/xml-js#readme
 *   version: 1.6.11
 *
 * This header is generated by licensify (https://github.com/twada/licensify)
 */(function(t){if(typeof exports=="object"&&typeof module<"u")module.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var n;typeof window<"u"?n=window:typeof global<"u"?n=global:typeof self<"u"?n=self:n=this,n.AnyPalette=t()}})(function(){return function(){function t(n,s,e){function c(o,l){if(!s[o]){if(!n[o]){var r=typeof require=="function"&&require;if(!l&&r)return r(o,!0);if(a)return a(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var h=s[o]={exports:{}};n[o][0].call(h.exports,function(v){var p=n[o][1][v];return c(p||v)},h,h.exports,t,n,s,e)}return s[o].exports}for(var a=typeof require=="function"&&require,i=0;i<e.length;i++)c(e[i]);return c}return t}()({1:[function(t,n,s){s.byteLength=d,s.toByteArray=v,s.fromByteArray=A;for(var e=[],c=[],a=typeof Uint8Array<"u"?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=i.length;o<l;++o)e[o]=i[o],c[i.charCodeAt(o)]=o;c[45]=62,c[95]=63;function r(y){var x=y.length;if(x%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var P=y.indexOf("=");P===-1&&(P=x);var L=P===x?0:4-P%4;return[P,L]}function d(y){var x=r(y),P=x[0],L=x[1];return(P+L)*3/4-L}function h(y,x,P){return(x+P)*3/4-P}function v(y){var x,P=r(y),L=P[0],T=P[1],g=new a(h(y,L,T)),_=0,u=T>0?L-4:L,b;for(b=0;b<u;b+=4)x=c[y.charCodeAt(b)]<<18|c[y.charCodeAt(b+1)]<<12|c[y.charCodeAt(b+2)]<<6|c[y.charCodeAt(b+3)],g[_++]=x>>16&255,g[_++]=x>>8&255,g[_++]=x&255;return T===2&&(x=c[y.charCodeAt(b)]<<2|c[y.charCodeAt(b+1)]>>4,g[_++]=x&255),T===1&&(x=c[y.charCodeAt(b)]<<10|c[y.charCodeAt(b+1)]<<4|c[y.charCodeAt(b+2)]>>2,g[_++]=x>>8&255,g[_++]=x&255),g}function p(y){return e[y>>18&63]+e[y>>12&63]+e[y>>6&63]+e[y&63]}function m(y,x,P){for(var L,T=[],g=x;g<P;g+=3)L=(y[g]<<16&16711680)+(y[g+1]<<8&65280)+(y[g+2]&255),T.push(p(L));return T.join("")}function A(y){for(var x,P=y.length,L=P%3,T=[],g=16383,_=0,u=P-L;_<u;_+=g)T.push(m(y,_,_+g>u?u:_+g));return L===1?(x=y[P-1],T.push(e[x>>2]+e[x<<4&63]+"==")):L===2&&(x=(y[P-2]<<8)+y[P-1],T.push(e[x>>10]+e[x>>4&63]+e[x<<2&63]+"=")),T.join("")}},{}],2:[function(t,n,s){},{}],3:[function(t,n,s){(function(e){(function(){var c=t("base64-js"),a=t("ieee754");s.Buffer=r,s.SlowBuffer=L,s.INSPECT_MAX_BYTES=50;var i=2147483647;s.kMaxLength=i,r.TYPED_ARRAY_SUPPORT=o(),!r.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var K=new Uint8Array(1);return K.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},K.foo()===42}catch{return!1}}Object.defineProperty(r.prototype,"parent",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.buffer}}),Object.defineProperty(r.prototype,"offset",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.byteOffset}});function l(K){if(K>i)throw new RangeError('The value "'+K+'" is invalid for option "size"');var I=new Uint8Array(K);return I.__proto__=r.prototype,I}function r(K,I,U){if(typeof K=="number"){if(typeof I=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(K)}return d(K,I,U)}typeof Symbol<"u"&&Symbol.species!=null&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192;function d(K,I,U){if(typeof K=="string")return m(K,I);if(ArrayBuffer.isView(K))return A(K);if(K==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof K);if(ee(K,ArrayBuffer)||K&&ee(K.buffer,ArrayBuffer))return y(K,I,U);if(typeof K=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var oe=K.valueOf&&K.valueOf();if(oe!=null&&oe!==K)return r.from(oe,I,U);var ge=x(K);if(ge)return ge;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof K[Symbol.toPrimitive]=="function")return r.from(K[Symbol.toPrimitive]("string"),I,U);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof K)}r.from=function(K,I,U){return d(K,I,U)},r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array;function h(K){if(typeof K!="number")throw new TypeError('"size" argument must be of type number');if(K<0)throw new RangeError('The value "'+K+'" is invalid for option "size"')}function v(K,I,U){return h(K),K<=0?l(K):I!==void 0?typeof U=="string"?l(K).fill(I,U):l(K).fill(I):l(K)}r.alloc=function(K,I,U){return v(K,I,U)};function p(K){return h(K),l(K<0?0:P(K)|0)}r.allocUnsafe=function(K){return p(K)},r.allocUnsafeSlow=function(K){return p(K)};function m(K,I){if((typeof I!="string"||I==="")&&(I="utf8"),!r.isEncoding(I))throw new TypeError("Unknown encoding: "+I);var U=T(K,I)|0,oe=l(U),ge=oe.write(K,I);return ge!==U&&(oe=oe.slice(0,ge)),oe}function A(K){for(var I=K.length<0?0:P(K.length)|0,U=l(I),oe=0;oe<I;oe+=1)U[oe]=K[oe]&255;return U}function y(K,I,U){if(I<0||K.byteLength<I)throw new RangeError('"offset" is outside of buffer bounds');if(K.byteLength<I+(U||0))throw new RangeError('"length" is outside of buffer bounds');var oe;return I===void 0&&U===void 0?oe=new Uint8Array(K):U===void 0?oe=new Uint8Array(K,I):oe=new Uint8Array(K,I,U),oe.__proto__=r.prototype,oe}function x(K){if(r.isBuffer(K)){var I=P(K.length)|0,U=l(I);return U.length===0||K.copy(U,0,0,I),U}if(K.length!==void 0)return typeof K.length!="number"||se(K.length)?l(0):A(K);if(K.type==="Buffer"&&Array.isArray(K.data))return A(K.data)}function P(K){if(K>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return K|0}function L(K){return+K!=K&&(K=0),r.alloc(+K)}r.isBuffer=function(I){return I!=null&&I._isBuffer===!0&&I!==r.prototype},r.compare=function(I,U){if(ee(I,Uint8Array)&&(I=r.from(I,I.offset,I.byteLength)),ee(U,Uint8Array)&&(U=r.from(U,U.offset,U.byteLength)),!r.isBuffer(I)||!r.isBuffer(U))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===U)return 0;for(var oe=I.length,ge=U.length,Se=0,Ce=Math.min(oe,ge);Se<Ce;++Se)if(I[Se]!==U[Se]){oe=I[Se],ge=U[Se];break}return oe<ge?-1:ge<oe?1:0},r.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(I,U){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(I.length===0)return r.alloc(0);var oe;if(U===void 0)for(U=0,oe=0;oe<I.length;++oe)U+=I[oe].length;var ge=r.allocUnsafe(U),Se=0;for(oe=0;oe<I.length;++oe){var Ce=I[oe];if(ee(Ce,Uint8Array)&&(Ce=r.from(Ce)),!r.isBuffer(Ce))throw new TypeError('"list" argument must be an Array of Buffers');Ce.copy(ge,Se),Se+=Ce.length}return ge};function T(K,I){if(r.isBuffer(K))return K.length;if(ArrayBuffer.isView(K)||ee(K,ArrayBuffer))return K.byteLength;if(typeof K!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof K);var U=K.length,oe=arguments.length>2&&arguments[2]===!0;if(!oe&&U===0)return 0;for(var ge=!1;;)switch(I){case"ascii":case"latin1":case"binary":return U;case"utf8":case"utf-8":return F(K).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U*2;case"hex":return U>>>1;case"base64":return de(K).length;default:if(ge)return oe?-1:F(K).length;I=(""+I).toLowerCase(),ge=!0}}r.byteLength=T;function g(K,I,U){var oe=!1;if((I===void 0||I<0)&&(I=0),I>this.length||((U===void 0||U>this.length)&&(U=this.length),U<=0)||(U>>>=0,I>>>=0,U<=I))return"";for(K||(K="utf8");;)switch(K){case"hex":return G(this,I,U);case"utf8":case"utf-8":return J(this,I,U);case"ascii":return w(this,I,U);case"latin1":case"binary":return N(this,I,U);case"base64":return Z(this,I,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V(this,I,U);default:if(oe)throw new TypeError("Unknown encoding: "+K);K=(K+"").toLowerCase(),oe=!0}}r.prototype._isBuffer=!0;function _(K,I,U){var oe=K[I];K[I]=K[U],K[U]=oe}r.prototype.swap16=function(){var I=this.length;if(I%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var U=0;U<I;U+=2)_(this,U,U+1);return this},r.prototype.swap32=function(){var I=this.length;if(I%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var U=0;U<I;U+=4)_(this,U,U+3),_(this,U+1,U+2);return this},r.prototype.swap64=function(){var I=this.length;if(I%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var U=0;U<I;U+=8)_(this,U,U+7),_(this,U+1,U+6),_(this,U+2,U+5),_(this,U+3,U+4);return this},r.prototype.toString=function(){var I=this.length;return I===0?"":arguments.length===0?J(this,0,I):g.apply(this,arguments)},r.prototype.toLocaleString=r.prototype.toString,r.prototype.equals=function(I){if(!r.isBuffer(I))throw new TypeError("Argument must be a Buffer");return this===I?!0:r.compare(this,I)===0},r.prototype.inspect=function(){var I="",U=s.INSPECT_MAX_BYTES;return I=this.toString("hex",0,U).replace(/(.{2})/g,"$1 ").trim(),this.length>U&&(I+=" ... "),"<Buffer "+I+">"},r.prototype.compare=function(I,U,oe,ge,Se){if(ee(I,Uint8Array)&&(I=r.from(I,I.offset,I.byteLength)),!r.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(U===void 0&&(U=0),oe===void 0&&(oe=I?I.length:0),ge===void 0&&(ge=0),Se===void 0&&(Se=this.length),U<0||oe>I.length||ge<0||Se>this.length)throw new RangeError("out of range index");if(ge>=Se&&U>=oe)return 0;if(ge>=Se)return-1;if(U>=oe)return 1;if(U>>>=0,oe>>>=0,ge>>>=0,Se>>>=0,this===I)return 0;for(var Ce=Se-ge,Re=oe-U,qe=Math.min(Ce,Re),Ge=this.slice(ge,Se),Ye=I.slice(U,oe),He=0;He<qe;++He)if(Ge[He]!==Ye[He]){Ce=Ge[He],Re=Ye[He];break}return Ce<Re?-1:Re<Ce?1:0};function u(K,I,U,oe,ge){if(K.length===0)return-1;if(typeof U=="string"?(oe=U,U=0):U>2147483647?U=2147483647:U<-2147483648&&(U=-2147483648),U=+U,se(U)&&(U=ge?0:K.length-1),U<0&&(U=K.length+U),U>=K.length){if(ge)return-1;U=K.length-1}else if(U<0)if(ge)U=0;else return-1;if(typeof I=="string"&&(I=r.from(I,oe)),r.isBuffer(I))return I.length===0?-1:b(K,I,U,oe,ge);if(typeof I=="number")return I=I&255,typeof Uint8Array.prototype.indexOf=="function"?ge?Uint8Array.prototype.indexOf.call(K,I,U):Uint8Array.prototype.lastIndexOf.call(K,I,U):b(K,[I],U,oe,ge);throw new TypeError("val must be string, number or Buffer")}function b(K,I,U,oe,ge){var Se=1,Ce=K.length,Re=I.length;if(oe!==void 0&&(oe=String(oe).toLowerCase(),oe==="ucs2"||oe==="ucs-2"||oe==="utf16le"||oe==="utf-16le")){if(K.length<2||I.length<2)return-1;Se=2,Ce/=2,Re/=2,U/=2}function qe(Qe,je){return Se===1?Qe[je]:Qe.readUInt16BE(je*Se)}var Ge;if(ge){var Ye=-1;for(Ge=U;Ge<Ce;Ge++)if(qe(K,Ge)===qe(I,Ye===-1?0:Ge-Ye)){if(Ye===-1&&(Ye=Ge),Ge-Ye+1===Re)return Ye*Se}else Ye!==-1&&(Ge-=Ge-Ye),Ye=-1}else for(U+Re>Ce&&(U=Ce-Re),Ge=U;Ge>=0;Ge--){for(var He=!0,Xe=0;Xe<Re;Xe++)if(qe(K,Ge+Xe)!==qe(I,Xe)){He=!1;break}if(He)return Ge}return-1}r.prototype.includes=function(I,U,oe){return this.indexOf(I,U,oe)!==-1},r.prototype.indexOf=function(I,U,oe){return u(this,I,U,oe,!0)},r.prototype.lastIndexOf=function(I,U,oe){return u(this,I,U,oe,!1)};function S(K,I,U,oe){U=Number(U)||0;var ge=K.length-U;oe?(oe=Number(oe),oe>ge&&(oe=ge)):oe=ge;var Se=I.length;oe>Se/2&&(oe=Se/2);for(var Ce=0;Ce<oe;++Ce){var Re=parseInt(I.substr(Ce*2,2),16);if(se(Re))return Ce;K[U+Ce]=Re}return Ce}function M(K,I,U,oe){return ve(F(I,K.length-U),K,U,oe)}function R(K,I,U,oe){return ve(ie(I),K,U,oe)}function C(K,I,U,oe){return R(K,I,U,oe)}function D(K,I,U,oe){return ve(de(I),K,U,oe)}function B(K,I,U,oe){return ve(ae(I,K.length-U),K,U,oe)}r.prototype.write=function(I,U,oe,ge){if(U===void 0)ge="utf8",oe=this.length,U=0;else if(oe===void 0&&typeof U=="string")ge=U,oe=this.length,U=0;else if(isFinite(U))U=U>>>0,isFinite(oe)?(oe=oe>>>0,ge===void 0&&(ge="utf8")):(ge=oe,oe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Se=this.length-U;if((oe===void 0||oe>Se)&&(oe=Se),I.length>0&&(oe<0||U<0)||U>this.length)throw new RangeError("Attempt to write outside buffer bounds");ge||(ge="utf8");for(var Ce=!1;;)switch(ge){case"hex":return S(this,I,U,oe);case"utf8":case"utf-8":return M(this,I,U,oe);case"ascii":return R(this,I,U,oe);case"latin1":case"binary":return C(this,I,U,oe);case"base64":return D(this,I,U,oe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,I,U,oe);default:if(Ce)throw new TypeError("Unknown encoding: "+ge);ge=(""+ge).toLowerCase(),Ce=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Z(K,I,U){return I===0&&U===K.length?c.fromByteArray(K):c.fromByteArray(K.slice(I,U))}function J(K,I,U){U=Math.min(K.length,U);for(var oe=[],ge=I;ge<U;){var Se=K[ge],Ce=null,Re=Se>239?4:Se>223?3:Se>191?2:1;if(ge+Re<=U){var qe,Ge,Ye,He;switch(Re){case 1:Se<128&&(Ce=Se);break;case 2:qe=K[ge+1],(qe&192)===128&&(He=(Se&31)<<6|qe&63,He>127&&(Ce=He));break;case 3:qe=K[ge+1],Ge=K[ge+2],(qe&192)===128&&(Ge&192)===128&&(He=(Se&15)<<12|(qe&63)<<6|Ge&63,He>2047&&(He<55296||He>57343)&&(Ce=He));break;case 4:qe=K[ge+1],Ge=K[ge+2],Ye=K[ge+3],(qe&192)===128&&(Ge&192)===128&&(Ye&192)===128&&(He=(Se&15)<<18|(qe&63)<<12|(Ge&63)<<6|Ye&63,He>65535&&He<1114112&&(Ce=He))}}Ce===null?(Ce=65533,Re=1):Ce>65535&&(Ce-=65536,oe.push(Ce>>>10&1023|55296),Ce=56320|Ce&1023),oe.push(Ce),ge+=Re}return z(oe)}var q=4096;function z(K){var I=K.length;if(I<=q)return String.fromCharCode.apply(String,K);for(var U="",oe=0;oe<I;)U+=String.fromCharCode.apply(String,K.slice(oe,oe+=q));return U}function w(K,I,U){var oe="";U=Math.min(K.length,U);for(var ge=I;ge<U;++ge)oe+=String.fromCharCode(K[ge]&127);return oe}function N(K,I,U){var oe="";U=Math.min(K.length,U);for(var ge=I;ge<U;++ge)oe+=String.fromCharCode(K[ge]);return oe}function G(K,I,U){var oe=K.length;(!I||I<0)&&(I=0),(!U||U<0||U>oe)&&(U=oe);for(var ge="",Se=I;Se<U;++Se)ge+=Y(K[Se]);return ge}function V(K,I,U){for(var oe=K.slice(I,U),ge="",Se=0;Se<oe.length;Se+=2)ge+=String.fromCharCode(oe[Se]+oe[Se+1]*256);return ge}r.prototype.slice=function(I,U){var oe=this.length;I=~~I,U=U===void 0?oe:~~U,I<0?(I+=oe,I<0&&(I=0)):I>oe&&(I=oe),U<0?(U+=oe,U<0&&(U=0)):U>oe&&(U=oe),U<I&&(U=I);var ge=this.subarray(I,U);return ge.__proto__=r.prototype,ge};function H(K,I,U){if(K%1!==0||K<0)throw new RangeError("offset is not uint");if(K+I>U)throw new RangeError("Trying to access beyond buffer length")}r.prototype.readUIntLE=function(I,U,oe){I=I>>>0,U=U>>>0,oe||H(I,U,this.length);for(var ge=this[I],Se=1,Ce=0;++Ce<U&&(Se*=256);)ge+=this[I+Ce]*Se;return ge},r.prototype.readUIntBE=function(I,U,oe){I=I>>>0,U=U>>>0,oe||H(I,U,this.length);for(var ge=this[I+--U],Se=1;U>0&&(Se*=256);)ge+=this[I+--U]*Se;return ge},r.prototype.readUInt8=function(I,U){return I=I>>>0,U||H(I,1,this.length),this[I]},r.prototype.readUInt16LE=function(I,U){return I=I>>>0,U||H(I,2,this.length),this[I]|this[I+1]<<8},r.prototype.readUInt16BE=function(I,U){return I=I>>>0,U||H(I,2,this.length),this[I]<<8|this[I+1]},r.prototype.readUInt32LE=function(I,U){return I=I>>>0,U||H(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+this[I+3]*16777216},r.prototype.readUInt32BE=function(I,U){return I=I>>>0,U||H(I,4,this.length),this[I]*16777216+(this[I+1]<<16|this[I+2]<<8|this[I+3])},r.prototype.readIntLE=function(I,U,oe){I=I>>>0,U=U>>>0,oe||H(I,U,this.length);for(var ge=this[I],Se=1,Ce=0;++Ce<U&&(Se*=256);)ge+=this[I+Ce]*Se;return Se*=128,ge>=Se&&(ge-=Math.pow(2,8*U)),ge},r.prototype.readIntBE=function(I,U,oe){I=I>>>0,U=U>>>0,oe||H(I,U,this.length);for(var ge=U,Se=1,Ce=this[I+--ge];ge>0&&(Se*=256);)Ce+=this[I+--ge]*Se;return Se*=128,Ce>=Se&&(Ce-=Math.pow(2,8*U)),Ce},r.prototype.readInt8=function(I,U){return I=I>>>0,U||H(I,1,this.length),this[I]&128?(255-this[I]+1)*-1:this[I]},r.prototype.readInt16LE=function(I,U){I=I>>>0,U||H(I,2,this.length);var oe=this[I]|this[I+1]<<8;return oe&32768?oe|4294901760:oe},r.prototype.readInt16BE=function(I,U){I=I>>>0,U||H(I,2,this.length);var oe=this[I+1]|this[I]<<8;return oe&32768?oe|4294901760:oe},r.prototype.readInt32LE=function(I,U){return I=I>>>0,U||H(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},r.prototype.readInt32BE=function(I,U){return I=I>>>0,U||H(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},r.prototype.readFloatLE=function(I,U){return I=I>>>0,U||H(I,4,this.length),a.read(this,I,!0,23,4)},r.prototype.readFloatBE=function(I,U){return I=I>>>0,U||H(I,4,this.length),a.read(this,I,!1,23,4)},r.prototype.readDoubleLE=function(I,U){return I=I>>>0,U||H(I,8,this.length),a.read(this,I,!0,52,8)},r.prototype.readDoubleBE=function(I,U){return I=I>>>0,U||H(I,8,this.length),a.read(this,I,!1,52,8)};function X(K,I,U,oe,ge,Se){if(!r.isBuffer(K))throw new TypeError('"buffer" argument must be a Buffer instance');if(I>ge||I<Se)throw new RangeError('"value" argument is out of bounds');if(U+oe>K.length)throw new RangeError("Index out of range")}r.prototype.writeUIntLE=function(I,U,oe,ge){if(I=+I,U=U>>>0,oe=oe>>>0,!ge){var Se=Math.pow(2,8*oe)-1;X(this,I,U,oe,Se,0)}var Ce=1,Re=0;for(this[U]=I&255;++Re<oe&&(Ce*=256);)this[U+Re]=I/Ce&255;return U+oe},r.prototype.writeUIntBE=function(I,U,oe,ge){if(I=+I,U=U>>>0,oe=oe>>>0,!ge){var Se=Math.pow(2,8*oe)-1;X(this,I,U,oe,Se,0)}var Ce=oe-1,Re=1;for(this[U+Ce]=I&255;--Ce>=0&&(Re*=256);)this[U+Ce]=I/Re&255;return U+oe},r.prototype.writeUInt8=function(I,U,oe){return I=+I,U=U>>>0,oe||X(this,I,U,1,255,0),this[U]=I&255,U+1},r.prototype.writeUInt16LE=function(I,U,oe){return I=+I,U=U>>>0,oe||X(this,I,U,2,65535,0),this[U]=I&255,this[U+1]=I>>>8,U+2},r.prototype.writeUInt16BE=function(I,U,oe){return I=+I,U=U>>>0,oe||X(this,I,U,2,65535,0),this[U]=I>>>8,this[U+1]=I&255,U+2},r.prototype.writeUInt32LE=function(I,U,oe){return I=+I,U=U>>>0,oe||X(this,I,U,4,4294967295,0),this[U+3]=I>>>24,this[U+2]=I>>>16,this[U+1]=I>>>8,this[U]=I&255,U+4},r.prototype.writeUInt32BE=function(I,U,oe){return I=+I,U=U>>>0,oe||X(this,I,U,4,4294967295,0),this[U]=I>>>24,this[U+1]=I>>>16,this[U+2]=I>>>8,this[U+3]=I&255,U+4},r.prototype.writeIntLE=function(I,U,oe,ge){if(I=+I,U=U>>>0,!ge){var Se=Math.pow(2,8*oe-1);X(this,I,U,oe,Se-1,-Se)}var Ce=0,Re=1,qe=0;for(this[U]=I&255;++Ce<oe&&(Re*=256);)I<0&&qe===0&&this[U+Ce-1]!==0&&(qe=1),this[U+Ce]=(I/Re>>0)-qe&255;return U+oe},r.prototype.writeIntBE=function(I,U,oe,ge){if(I=+I,U=U>>>0,!ge){var Se=Math.pow(2,8*oe-1);X(this,I,U,oe,Se-1,-Se)}var Ce=oe-1,Re=1,qe=0;for(this[U+Ce]=I&255;--Ce>=0&&(Re*=256);)I<0&&qe===0&&this[U+Ce+1]!==0&&(qe=1),this[U+Ce]=(I/Re>>0)-qe&255;return U+oe},r.prototype.writeInt8=function(I,U,oe){return I=+I,U=U>>>0,oe||X(this,I,U,1,127,-128),I<0&&(I=255+I+1),this[U]=I&255,U+1},r.prototype.writeInt16LE=function(I,U,oe){return I=+I,U=U>>>0,oe||X(this,I,U,2,32767,-32768),this[U]=I&255,this[U+1]=I>>>8,U+2},r.prototype.writeInt16BE=function(I,U,oe){return I=+I,U=U>>>0,oe||X(this,I,U,2,32767,-32768),this[U]=I>>>8,this[U+1]=I&255,U+2},r.prototype.writeInt32LE=function(I,U,oe){return I=+I,U=U>>>0,oe||X(this,I,U,4,2147483647,-2147483648),this[U]=I&255,this[U+1]=I>>>8,this[U+2]=I>>>16,this[U+3]=I>>>24,U+4},r.prototype.writeInt32BE=function(I,U,oe){return I=+I,U=U>>>0,oe||X(this,I,U,4,2147483647,-2147483648),I<0&&(I=4294967295+I+1),this[U]=I>>>24,this[U+1]=I>>>16,this[U+2]=I>>>8,this[U+3]=I&255,U+4};function Q(K,I,U,oe,ge,Se){if(U+oe>K.length)throw new RangeError("Index out of range");if(U<0)throw new RangeError("Index out of range")}function ce(K,I,U,oe,ge){return I=+I,U=U>>>0,ge||Q(K,I,U,4),a.write(K,I,U,oe,23,4),U+4}r.prototype.writeFloatLE=function(I,U,oe){return ce(this,I,U,!0,oe)},r.prototype.writeFloatBE=function(I,U,oe){return ce(this,I,U,!1,oe)};function pe(K,I,U,oe,ge){return I=+I,U=U>>>0,ge||Q(K,I,U,8),a.write(K,I,U,oe,52,8),U+8}r.prototype.writeDoubleLE=function(I,U,oe){return pe(this,I,U,!0,oe)},r.prototype.writeDoubleBE=function(I,U,oe){return pe(this,I,U,!1,oe)},r.prototype.copy=function(I,U,oe,ge){if(!r.isBuffer(I))throw new TypeError("argument should be a Buffer");if(oe||(oe=0),!ge&&ge!==0&&(ge=this.length),U>=I.length&&(U=I.length),U||(U=0),ge>0&&ge<oe&&(ge=oe),ge===oe||I.length===0||this.length===0)return 0;if(U<0)throw new RangeError("targetStart out of bounds");if(oe<0||oe>=this.length)throw new RangeError("Index out of range");if(ge<0)throw new RangeError("sourceEnd out of bounds");ge>this.length&&(ge=this.length),I.length-U<ge-oe&&(ge=I.length-U+oe);var Se=ge-oe;if(this===I&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(U,oe,ge);else if(this===I&&oe<U&&U<ge)for(var Ce=Se-1;Ce>=0;--Ce)I[Ce+U]=this[Ce+oe];else Uint8Array.prototype.set.call(I,this.subarray(oe,ge),U);return Se},r.prototype.fill=function(I,U,oe,ge){if(typeof I=="string"){if(typeof U=="string"?(ge=U,U=0,oe=this.length):typeof oe=="string"&&(ge=oe,oe=this.length),ge!==void 0&&typeof ge!="string")throw new TypeError("encoding must be a string");if(typeof ge=="string"&&!r.isEncoding(ge))throw new TypeError("Unknown encoding: "+ge);if(I.length===1){var Se=I.charCodeAt(0);(ge==="utf8"&&Se<128||ge==="latin1")&&(I=Se)}}else typeof I=="number"&&(I=I&255);if(U<0||this.length<U||this.length<oe)throw new RangeError("Out of range index");if(oe<=U)return this;U=U>>>0,oe=oe===void 0?this.length:oe>>>0,I||(I=0);var Ce;if(typeof I=="number")for(Ce=U;Ce<oe;++Ce)this[Ce]=I;else{var Re=r.isBuffer(I)?I:r.from(I,ge),qe=Re.length;if(qe===0)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(Ce=0;Ce<oe-U;++Ce)this[Ce+U]=Re[Ce%qe]}return this};var _e=/[^+/0-9A-Za-z-_]/g;function xe(K){if(K=K.split("=")[0],K=K.trim().replace(_e,""),K.length<2)return"";for(;K.length%4!==0;)K=K+"=";return K}function Y(K){return K<16?"0"+K.toString(16):K.toString(16)}function F(K,I){I=I||1/0;for(var U,oe=K.length,ge=null,Se=[],Ce=0;Ce<oe;++Ce){if(U=K.charCodeAt(Ce),U>55295&&U<57344){if(!ge){if(U>56319){(I-=3)>-1&&Se.push(239,191,189);continue}else if(Ce+1===oe){(I-=3)>-1&&Se.push(239,191,189);continue}ge=U;continue}if(U<56320){(I-=3)>-1&&Se.push(239,191,189),ge=U;continue}U=(ge-55296<<10|U-56320)+65536}else ge&&(I-=3)>-1&&Se.push(239,191,189);if(ge=null,U<128){if((I-=1)<0)break;Se.push(U)}else if(U<2048){if((I-=2)<0)break;Se.push(U>>6|192,U&63|128)}else if(U<65536){if((I-=3)<0)break;Se.push(U>>12|224,U>>6&63|128,U&63|128)}else if(U<1114112){if((I-=4)<0)break;Se.push(U>>18|240,U>>12&63|128,U>>6&63|128,U&63|128)}else throw new Error("Invalid code point")}return Se}function ie(K){for(var I=[],U=0;U<K.length;++U)I.push(K.charCodeAt(U)&255);return I}function ae(K,I){for(var U,oe,ge,Se=[],Ce=0;Ce<K.length&&!((I-=2)<0);++Ce)U=K.charCodeAt(Ce),oe=U>>8,ge=U%256,Se.push(ge),Se.push(oe);return Se}function de(K){return c.toByteArray(xe(K))}function ve(K,I,U,oe){for(var ge=0;ge<oe&&!(ge+U>=I.length||ge>=K.length);++ge)I[ge+U]=K[ge];return ge}function ee(K,I){return K instanceof I||K!=null&&K.constructor!=null&&K.constructor.name!=null&&K.constructor.name===I.name}function se(K){return K!==K}}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:6}],4:[function(t,n,s){(function(e){(function(){(function(c,a){typeof s=="object"?n.exports=a(c):a(c)})(typeof e<"u"?e:this,function(c){if(c.CSS&&c.CSS.escape)return c.CSS.escape;var a=function(i){if(arguments.length==0)throw new TypeError("`CSS.escape` requires an argument.");for(var o=String(i),l=o.length,r=-1,d,h="",v=o.charCodeAt(0);++r<l;){if(d=o.charCodeAt(r),d==0){h+="ï¿½";continue}if(d>=1&&d<=31||d==127||r==0&&d>=48&&d<=57||r==1&&d>=48&&d<=57&&v==45){h+="\\"+d.toString(16)+" ";continue}if(r==0&&l==1&&d==45){h+="\\"+o.charAt(r);continue}if(d>=128||d==45||d==95||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122){h+=o.charAt(r);continue}h+="\\"+o.charAt(r)}return h};return c.CSS||(c.CSS={}),c.CSS.escape=a,a})}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],5:[function(t,n,s){var e=typeof Reflect=="object"?Reflect:null,c=e&&typeof e.apply=="function"?e.apply:function(_,u,b){return Function.prototype.apply.call(_,u,b)},a;e&&typeof e.ownKeys=="function"?a=e.ownKeys:Object.getOwnPropertySymbols?a=function(_){return Object.getOwnPropertyNames(_).concat(Object.getOwnPropertySymbols(_))}:a=function(_){return Object.getOwnPropertyNames(_)};function i(g){console&&console.warn&&console.warn(g)}var o=Number.isNaN||function(_){return _!==_};function l(){l.init.call(this)}n.exports=l,n.exports.once=T,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var r=10;function d(g){if(typeof g!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof g)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return r},set:function(g){if(typeof g!="number"||g<0||o(g))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+g+".");r=g}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(_){if(typeof _!="number"||_<0||o(_))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+_+".");return this._maxListeners=_,this};function h(g){return g._maxListeners===void 0?l.defaultMaxListeners:g._maxListeners}l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(_){for(var u=[],b=1;b<arguments.length;b++)u.push(arguments[b]);var S=_==="error",M=this._events;if(M!==void 0)S=S&&M.error===void 0;else if(!S)return!1;if(S){var R;if(u.length>0&&(R=u[0]),R instanceof Error)throw R;var C=new Error("Unhandled error."+(R?" ("+R.message+")":""));throw C.context=R,C}var D=M[_];if(D===void 0)return!1;if(typeof D=="function")c(D,this,u);else for(var B=D.length,Z=x(D,B),b=0;b<B;++b)c(Z[b],this,u);return!0};function v(g,_,u,b){var S,M,R;if(d(u),M=g._events,M===void 0?(M=g._events=Object.create(null),g._eventsCount=0):(M.newListener!==void 0&&(g.emit("newListener",_,u.listener?u.listener:u),M=g._events),R=M[_]),R===void 0)R=M[_]=u,++g._eventsCount;else if(typeof R=="function"?R=M[_]=b?[u,R]:[R,u]:b?R.unshift(u):R.push(u),S=h(g),S>0&&R.length>S&&!R.warned){R.warned=!0;var C=new Error("Possible EventEmitter memory leak detected. "+R.length+" "+String(_)+" listeners added. Use emitter.setMaxListeners() to increase limit");C.name="MaxListenersExceededWarning",C.emitter=g,C.type=_,C.count=R.length,i(C)}return g}l.prototype.addListener=function(_,u){return v(this,_,u,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(_,u){return v(this,_,u,!0)};function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(g,_,u){var b={fired:!1,wrapFn:void 0,target:g,type:_,listener:u},S=p.bind(b);return S.listener=u,b.wrapFn=S,S}l.prototype.once=function(_,u){return d(u),this.on(_,m(this,_,u)),this},l.prototype.prependOnceListener=function(_,u){return d(u),this.prependListener(_,m(this,_,u)),this},l.prototype.removeListener=function(_,u){var b,S,M,R,C;if(d(u),S=this._events,S===void 0)return this;if(b=S[_],b===void 0)return this;if(b===u||b.listener===u)--this._eventsCount===0?this._events=Object.create(null):(delete S[_],S.removeListener&&this.emit("removeListener",_,b.listener||u));else if(typeof b!="function"){for(M=-1,R=b.length-1;R>=0;R--)if(b[R]===u||b[R].listener===u){C=b[R].listener,M=R;break}if(M<0)return this;M===0?b.shift():P(b,M),b.length===1&&(S[_]=b[0]),S.removeListener!==void 0&&this.emit("removeListener",_,C||u)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(_){var u,b,S;if(b=this._events,b===void 0)return this;if(b.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):b[_]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete b[_]),this;if(arguments.length===0){var M=Object.keys(b),R;for(S=0;S<M.length;++S)R=M[S],R!=="removeListener"&&this.removeAllListeners(R);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(u=b[_],typeof u=="function")this.removeListener(_,u);else if(u!==void 0)for(S=u.length-1;S>=0;S--)this.removeListener(_,u[S]);return this};function A(g,_,u){var b=g._events;if(b===void 0)return[];var S=b[_];return S===void 0?[]:typeof S=="function"?u?[S.listener||S]:[S]:u?L(S):x(S,S.length)}l.prototype.listeners=function(_){return A(this,_,!0)},l.prototype.rawListeners=function(_){return A(this,_,!1)},l.listenerCount=function(g,_){return typeof g.listenerCount=="function"?g.listenerCount(_):y.call(g,_)},l.prototype.listenerCount=y;function y(g){var _=this._events;if(_!==void 0){var u=_[g];if(typeof u=="function")return 1;if(u!==void 0)return u.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]};function x(g,_){for(var u=new Array(_),b=0;b<_;++b)u[b]=g[b];return u}function P(g,_){for(;_+1<g.length;_++)g[_]=g[_+1];g.pop()}function L(g){for(var _=new Array(g.length),u=0;u<_.length;++u)_[u]=g[u].listener||g[u];return _}function T(g,_){return new Promise(function(u,b){function S(){M!==void 0&&g.removeListener("error",M),u([].slice.call(arguments))}var M;_!=="error"&&(M=function(C){g.removeListener(_,S),b(C)},g.once("error",M)),g.once(_,S)})}},{}],6:[function(t,n,s){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */s.read=function(e,c,a,i,o){var l,r,d=o*8-i-1,h=(1<<d)-1,v=h>>1,p=-7,m=a?o-1:0,A=a?-1:1,y=e[c+m];for(m+=A,l=y&(1<<-p)-1,y>>=-p,p+=d;p>0;l=l*256+e[c+m],m+=A,p-=8);for(r=l&(1<<-p)-1,l>>=-p,p+=i;p>0;r=r*256+e[c+m],m+=A,p-=8);if(l===0)l=1-v;else{if(l===h)return r?NaN:(y?-1:1)*(1/0);r=r+Math.pow(2,i),l=l-v}return(y?-1:1)*r*Math.pow(2,l-i)},s.write=function(e,c,a,i,o,l){var r,d,h,v=l*8-o-1,p=(1<<v)-1,m=p>>1,A=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=i?0:l-1,x=i?1:-1,P=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(d=isNaN(c)?1:0,r=p):(r=Math.floor(Math.log(c)/Math.LN2),c*(h=Math.pow(2,-r))<1&&(r--,h*=2),r+m>=1?c+=A/h:c+=A*Math.pow(2,1-m),c*h>=2&&(r++,h/=2),r+m>=p?(d=0,r=p):r+m>=1?(d=(c*h-1)*Math.pow(2,o),r=r+m):(d=c*Math.pow(2,m-1)*Math.pow(2,o),r=0));o>=8;e[a+y]=d&255,y+=x,d/=256,o-=8);for(r=r<<o|d,v+=o;v>0;e[a+y]=r&255,y+=x,r/=256,v-=8);e[a+y-x]|=P*128}},{}],7:[function(t,n,s){(function(e){(function(){(function(c){var a=this;n.exports=c(a)})(function(c){function a(g,_){return typeof g!="object"||g===null?!1:g.constructor===_||Object.prototype.toString.call(g)==="[object "+_.name+"]"}function i(g,_){return!_&&a(g,Array)?g:Array.prototype.slice.call(g)}function o(g,_){return g!==void 0?g:_}function l(g,_,u,b){if(l.is(g)){var S=g.slice(_,_+u);return S._littleEndian=o(b,S._littleEndian),S}if(!l.is(this))return new l(g,_,u,b);if(this.buffer=g=l.wrapBuffer(g),this._isArrayBuffer=p.ArrayBuffer&&a(g,ArrayBuffer),this._isPixelData=!1,this._isDataView=p.DataView&&this._isArrayBuffer,this._isNodeBuffer=p.NodeBuffer&&a(g,e),!this._isNodeBuffer&&!this._isArrayBuffer&&!a(g,Array))throw new TypeError("jDataView buffer has an incompatible type");this._littleEndian=!!b;var M="byteLength"in g?g.byteLength:g.length;this.byteOffset=_=o(_,0),this.byteLength=u=o(u,M-_),this._offset=this._bitOffset=0,this._isDataView?this._view=new DataView(g,_,u):this._checkBounds(_,u,M),this._engineAction=this._isDataView?this._dataViewAction:this._isNodeBuffer?this._nodeBufferAction:this._isArrayBuffer?this._arrayBufferAction:this._arrayAction}function r(g){if(p.NodeBuffer)return new e(g,"binary");for(var _=p.ArrayBuffer?Uint8Array:Array,u=new _(g.length),b=0,S=g.length;S>b;b++)u[b]=255&g.charCodeAt(b);return u}function d(g){return g>=0&&31>g?1<<g:d[g]||(d[g]=Math.pow(2,g))}function h(g,_){this.lo=g,this.hi=_}function v(){h.apply(this,arguments)}var p={NodeBuffer:"Buffer"in window,DataView:"DataView"in window,ArrayBuffer:"ArrayBuffer"in window,PixelData:!1},m=window.TextEncoder,A=window.TextDecoder;p.NodeBuffer&&function(g){try{g.writeFloatLE(1/0,0)}catch{p.NodeBuffer=!1}}(new e(4));var y={Int8:1,Int16:2,Int32:4,Uint8:1,Uint16:2,Uint32:4,Float32:4,Float64:8};l.wrapBuffer=function(g){switch(typeof g){case"number":if(p.NodeBuffer)g=new e(g),g.fill(0);else if(p.ArrayBuffer)g=new Uint8Array(g).buffer;else{g=new Array(g);for(var _=0;_<g.length;_++)g[_]=0}return g;case"string":g=r(g);default:return"length"in g&&!(p.NodeBuffer&&a(g,e)||p.ArrayBuffer&&a(g,ArrayBuffer))&&(p.NodeBuffer?g=new e(g):p.ArrayBuffer?a(g,ArrayBuffer)||(g=new Uint8Array(g).buffer,a(g,ArrayBuffer)||(g=new Uint8Array(i(g,!0)).buffer)):g=i(g)),g}},l.is=function(g){return g&&g.jDataView},l.from=function(){return new l(arguments)},l.Uint64=h,h.prototype={valueOf:function(){return this.lo+d(32)*this.hi},toString:function(){return Number.prototype.toString.apply(this.valueOf(),arguments)}},h.fromNumber=function(g){var _=Math.floor(g/d(32)),u=g-_*d(32);return new h(u,_)},l.Int64=v,v.prototype="create"in Object?Object.create(h.prototype):new h,v.prototype.valueOf=function(){return this.hi<d(31)?h.prototype.valueOf.apply(this,arguments):-(d(32)-this.lo+d(32)*(d(32)-1-this.hi))},v.fromNumber=function(g){var _,u;if(g>=0){var b=h.fromNumber(g);_=b.lo,u=b.hi}else u=Math.floor(g/d(32)),_=g-u*d(32),u+=d(32);return new v(_,u)};var x=l.prototype={compatibility:p,jDataView:!0,_checkBounds:function(g,_,u){if(typeof g!="number")throw new TypeError("Offset is not a number.");if(typeof _!="number")throw new TypeError("Size is not a number.");if(0>_)throw new RangeError("Length is negative.");if(0>g||g+_>o(u,this.byteLength))throw new RangeError("Offsets are out of bounds.")},_action:function(g,_,u,b,S){return this._engineAction(g,_,o(u,this._offset),o(b,this._littleEndian),S)},_dataViewAction:function(g,_,u,b,S){return this._offset=u+y[g],_?this._view["get"+g](u,b):this._view["set"+g](u,S,b)},_arrayBufferAction:function(g,_,u,b,S){var M,R=y[g],C=c[g+"Array"];if(b=o(b,this._littleEndian),R===1||(this.byteOffset+u)%R===0&&b)return M=new C(this.buffer,this.byteOffset+u,1),this._offset=u+R,_?M[0]:M[0]=S;var D=new Uint8Array(_?this.getBytes(R,u,b,!0):R);return M=new C(D.buffer,0,1),_?M[0]:(M[0]=S,void this._setBytes(u,D,b))},_arrayAction:function(g,_,u,b,S){return _?this["_get"+g](u,b):this["_set"+g](u,S,b)},_getBytes:function(g,_,u){u=o(u,this._littleEndian),_=o(_,this._offset),g=o(g,this.byteLength-_),this._checkBounds(_,g),_+=this.byteOffset,this._offset=_-this.byteOffset+g;var b=this._isArrayBuffer?new Uint8Array(this.buffer,_,g):(this.buffer.slice||Array.prototype.slice).call(this.buffer,_,_+g);return u||1>=g?b:i(b).reverse()},getBytes:function(g,_,u,b){var S=this._getBytes(g,_,o(u,!0));return b?i(S):S},_setBytes:function(g,_,u){var b=_.length;if(b!==0){if(u=o(u,this._littleEndian),g=o(g,this._offset),this._checkBounds(g,b),!u&&b>1&&(_=i(_,!0).reverse()),g+=this.byteOffset,this._isArrayBuffer)new Uint8Array(this.buffer,g,b).set(_);else if(this._isNodeBuffer)new e(_).copy(this.buffer,g);else for(var S=0;b>S;S++)this.buffer[g+S]=_[S];this._offset=g-this.byteOffset+b}},setBytes:function(g,_,u){this._setBytes(g,_,o(u,!0))},getString:function(g,_,u){if(this._isNodeBuffer)return _=o(_,this._offset),g=o(g,this.byteLength-_),this._checkBounds(_,g),this._offset=_+g,this.buffer.toString(u||"binary",this.byteOffset+_,this.byteOffset+this._offset);var b=this._getBytes(g,_,!0);if(u=u==="utf8"?"utf-8":u||"binary",A&&u!=="binary")return new A(u).decode(this._isArrayBuffer?b:new Uint8Array(b));var S="";g=b.length;for(var M=0;g>M;M++)S+=String.fromCharCode(b[M]);return u==="utf-8"&&(S=decodeURIComponent(escape(S))),S},setString:function(g,_,u){if(this._isNodeBuffer)return g=o(g,this._offset),this._checkBounds(g,_.length),void(this._offset=g+this.buffer.write(_,this.byteOffset+g,u||"binary"));u=u==="utf8"?"utf-8":u||"binary";var b;m&&u!=="binary"?b=new m(u).encode(_):(u==="utf-8"&&(_=unescape(encodeURIComponent(_))),b=r(_)),this._setBytes(g,b,!0)},getChar:function(g){return this.getString(1,g)},setChar:function(g,_){this.setString(g,_)},tell:function(){return this._offset},seek:function(g){return this._checkBounds(g,0),this._offset=g},skip:function(g){return this.seek(this._offset+g)},slice:function(g,_,u){function b(S,M){return 0>S?S+M:S}return g=b(g,this.byteLength),_=b(o(_,this.byteLength),this.byteLength),u?new l(this.getBytes(_-g,g,!0,!0),void 0,void 0,this._littleEndian):new l(this.buffer,this.byteOffset+g,_-g,this._littleEndian)},alignBy:function(g){return this._bitOffset=0,o(g,1)!==1?this.skip(g-(this._offset%g||g)):this._offset},_getFloat64:function(g,_){var u=this._getBytes(8,g,_),b=1-2*(u[7]>>7),S=((u[7]<<1&255)<<3|u[6]>>4)-1023,M=(15&u[6])*d(48)+u[5]*d(40)+u[4]*d(32)+u[3]*d(24)+u[2]*d(16)+u[1]*d(8)+u[0];return S===1024?M!==0?NaN:1/0*b:S===-1023?b*M*d(-1074):b*(1+M*d(-52))*d(S)},_getFloat32:function(g,_){var u=this._getBytes(4,g,_),b=1-2*(u[3]>>7),S=(u[3]<<1&255|u[2]>>7)-127,M=(127&u[2])<<16|u[1]<<8|u[0];return S===128?M!==0?NaN:1/0*b:S===-127?b*M*d(-149):b*(1+M*d(-23))*d(S)},_get64:function(g,_,u){u=o(u,this._littleEndian),_=o(_,this._offset);for(var b=u?[0,4]:[4,0],S=0;2>S;S++)b[S]=this.getUint32(_+b[S],u);return this._offset=_+8,new g(b[0],b[1])},getInt64:function(g,_){return this._get64(v,g,_)},getUint64:function(g,_){return this._get64(h,g,_)},_getInt32:function(g,_){var u=this._getBytes(4,g,_);return u[3]<<24|u[2]<<16|u[1]<<8|u[0]},_getUint32:function(g,_){return this._getInt32(g,_)>>>0},_getInt16:function(g,_){return this._getUint16(g,_)<<16>>16},_getUint16:function(g,_){var u=this._getBytes(2,g,_);return u[1]<<8|u[0]},_getInt8:function(g){return this._getUint8(g)<<24>>24},_getUint8:function(g){return this._getBytes(1,g)[0]},_getBitRangeData:function(g,_){var u=(o(_,this._offset)<<3)+this._bitOffset,b=u+g,S=u>>>3,M=b+7>>>3,R=this._getBytes(M-S,S,!0),C=0;(this._bitOffset=7&b)&&(this._bitOffset-=8);for(var D=0,B=R.length;B>D;D++)C=C<<8|R[D];return{start:S,bytes:R,wideValue:C}},getSigned:function(g,_){var u=32-g;return this.getUnsigned(g,_)<<u>>u},getUnsigned:function(g,_){var u=this._getBitRangeData(g,_).wideValue>>>-this._bitOffset;return 32>g?u&~(-1<<g):u},_setBinaryFloat:function(g,_,u,b,S){var M,R,C=0>_?1:0,D=~(-1<<b-1),B=1-D;0>_&&(_=-_),_===0?(M=0,R=0):isNaN(_)?(M=2*D+1,R=1):_===1/0?(M=2*D+1,R=0):(M=Math.floor(Math.log(_)/Math.LN2),M>=B&&D>=M?(R=Math.floor((_*d(-M)-1)*d(u)),M+=D):(R=Math.floor(_/d(B-u)),M=0));for(var Z=[];u>=8;)Z.push(R%256),R=Math.floor(R/256),u-=8;for(M=M<<u|R,b+=u;b>=8;)Z.push(255&M),M>>>=8,b-=8;Z.push(C<<b|M),this._setBytes(g,Z,S)},_setFloat32:function(g,_,u){this._setBinaryFloat(g,_,23,8,u)},_setFloat64:function(g,_,u){this._setBinaryFloat(g,_,52,11,u)},_set64:function(g,_,u,b){typeof u!="object"&&(u=g.fromNumber(u)),b=o(b,this._littleEndian),_=o(_,this._offset);var S=b?{lo:0,hi:4}:{lo:4,hi:0};for(var M in S)this.setUint32(_+S[M],u[M],b);this._offset=_+8},setInt64:function(g,_,u){this._set64(v,g,_,u)},setUint64:function(g,_,u){this._set64(h,g,_,u)},_setUint32:function(g,_,u){this._setBytes(g,[255&_,_>>>8&255,_>>>16&255,_>>>24],u)},_setUint16:function(g,_,u){this._setBytes(g,[255&_,_>>>8&255],u)},_setUint8:function(g,_){this._setBytes(g,[255&_])},setUnsigned:function(g,_,u){var b=this._getBitRangeData(u,g),S=b.wideValue,M=b.bytes;S&=~(~(-1<<u)<<-this._bitOffset),S|=(32>u?_&~(-1<<u):_)<<-this._bitOffset;for(var R=M.length-1;R>=0;R--)M[R]=255&S,S>>>=8;this._setBytes(b.start,M,!0)}},P={Int8:"Int8",Int16:"Int16",Int32:"Int32",Uint8:"UInt8",Uint16:"UInt16",Uint32:"UInt32",Float32:"Float",Float64:"Double"};x._nodeBufferAction=function(g,_,u,b,S){this._offset=u+y[g];var M=P[g]+(g==="Int8"||g==="Uint8"?"":b?"LE":"BE");return u+=this.byteOffset,_?this.buffer["read"+M](u):this.buffer["write"+M](S,u)};for(var L in y)(function(g){x["get"+g]=function(_,u){return this._action(g,!0,_,u)},x["set"+g]=function(_,u,b){this._action(g,!1,_,b,u)}})(L);x._setInt32=x._setUint32,x._setInt16=x._setUint16,x._setInt8=x._setUint8,x.setSigned=x.setUnsigned;for(var T in x)T.slice(0,3)==="set"&&function(g){x["write"+g]=function(){Array.prototype.unshift.call(arguments,void 0),this["set"+g].apply(this,arguments)}}(T.slice(3));return l})}).call(this)}).call(this,t("buffer").Buffer)},{buffer:3}],8:[function(t,n,s){var e=n.exports={},c,a;function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?c=setTimeout:c=i}catch{c=i}try{typeof clearTimeout=="function"?a=clearTimeout:a=o}catch{a=o}})();function l(P){if(c===setTimeout)return setTimeout(P,0);if((c===i||!c)&&setTimeout)return c=setTimeout,setTimeout(P,0);try{return c(P,0)}catch{try{return c.call(null,P,0)}catch{return c.call(this,P,0)}}}function r(P){if(a===clearTimeout)return clearTimeout(P);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(P);try{return a(P)}catch{try{return a.call(null,P)}catch{return a.call(this,P)}}}var d=[],h=!1,v,p=-1;function m(){!h||!v||(h=!1,v.length?d=v.concat(d):p=-1,d.length&&A())}function A(){if(!h){var P=l(m);h=!0;for(var L=d.length;L;){for(v=d,d=[];++p<L;)v&&v[p].run();p=-1,L=d.length}v=null,h=!1,r(P)}}e.nextTick=function(P){var L=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)L[T-1]=arguments[T];d.push(new y(P,L)),d.length===1&&!h&&l(A)};function y(P,L){this.fun=P,this.array=L}y.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={};function x(){}e.on=x,e.addListener=x,e.once=x,e.off=x,e.removeListener=x,e.removeAllListeners=x,e.emit=x,e.prependListener=x,e.prependOnceListener=x,e.listeners=function(P){return[]},e.binding=function(P){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(P){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],9:[function(t,n,s){var e=t("buffer"),c=e.Buffer;function a(o,l){for(var r in o)l[r]=o[r]}c.from&&c.alloc&&c.allocUnsafe&&c.allocUnsafeSlow?n.exports=e:(a(e,s),s.Buffer=i);function i(o,l,r){return c(o,l,r)}a(c,i),i.from=function(o,l,r){if(typeof o=="number")throw new TypeError("Argument must not be a number");return c(o,l,r)},i.alloc=function(o,l,r){if(typeof o!="number")throw new TypeError("Argument must be a number");var d=c(o);return l!==void 0?typeof r=="string"?d.fill(l,r):d.fill(l):d.fill(0),d},i.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return c(o)},i.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return e.SlowBuffer(o)}},{buffer:3}],10:[function(t,n,s){(function(e){(function(){(function(c){c.parser=function(Y,F){return new i(Y,F)},c.SAXParser=i,c.SAXStream=p,c.createStream=v,c.MAX_BUFFER_LENGTH=64*1024;var a=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];c.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function i(Y,F){if(!(this instanceof i))return new i(Y,F);var ie=this;l(ie),ie.q=ie.c="",ie.bufferCheckPosition=c.MAX_BUFFER_LENGTH,ie.opt=F||{},ie.opt.lowercase=ie.opt.lowercase||ie.opt.lowercasetags,ie.looseCase=ie.opt.lowercase?"toLowerCase":"toUpperCase",ie.tags=[],ie.closed=ie.closedRoot=ie.sawRoot=!1,ie.tag=ie.error=null,ie.strict=!!Y,ie.noscript=!!(Y||ie.opt.noscript),ie.state=C.BEGIN,ie.strictEntities=ie.opt.strictEntities,ie.ENTITIES=ie.strictEntities?Object.create(c.XML_ENTITIES):Object.create(c.ENTITIES),ie.attribList=[],ie.opt.xmlns&&(ie.ns=Object.create(P)),ie.trackPosition=ie.opt.position!==!1,ie.trackPosition&&(ie.position=ie.line=ie.column=0),B(ie,"onready")}Object.create||(Object.create=function(Y){function F(){}F.prototype=Y;var ie=new F;return ie}),Object.keys||(Object.keys=function(Y){var F=[];for(var ie in Y)Y.hasOwnProperty(ie)&&F.push(ie);return F});function o(Y){for(var F=Math.max(c.MAX_BUFFER_LENGTH,10),ie=0,ae=0,de=a.length;ae<de;ae++){var ve=Y[a[ae]].length;if(ve>F)switch(a[ae]){case"textNode":J(Y);break;case"cdata":Z(Y,"oncdata",Y.cdata),Y.cdata="";break;case"script":Z(Y,"onscript",Y.script),Y.script="";break;default:z(Y,"Max buffer length exceeded: "+a[ae])}ie=Math.max(ie,ve)}var ee=c.MAX_BUFFER_LENGTH-ie;Y.bufferCheckPosition=ee+Y.position}function l(Y){for(var F=0,ie=a.length;F<ie;F++)Y[a[F]]=""}function r(Y){J(Y),Y.cdata!==""&&(Z(Y,"oncdata",Y.cdata),Y.cdata=""),Y.script!==""&&(Z(Y,"onscript",Y.script),Y.script="")}i.prototype={end:function(){w(this)},write:xe,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){r(this)}};var d;try{d=t("stream").Stream}catch{d=function(){}}var h=c.EVENTS.filter(function(Y){return Y!=="error"&&Y!=="end"});function v(Y,F){return new p(Y,F)}function p(Y,F){if(!(this instanceof p))return new p(Y,F);d.apply(this),this._parser=new i(Y,F),this.writable=!0,this.readable=!0;var ie=this;this._parser.onend=function(){ie.emit("end")},this._parser.onerror=function(ae){ie.emit("error",ae),ie._parser.error=null},this._decoder=null,h.forEach(function(ae){Object.defineProperty(ie,"on"+ae,{get:function(){return ie._parser["on"+ae]},set:function(de){if(!de)return ie.removeAllListeners(ae),ie._parser["on"+ae]=de,de;ie.on(ae,de)},enumerable:!0,configurable:!1})})}p.prototype=Object.create(d.prototype,{constructor:{value:p}}),p.prototype.write=function(Y){if(typeof e=="function"&&typeof e.isBuffer=="function"&&e.isBuffer(Y)){if(!this._decoder){var F=t("string_decoder").StringDecoder;this._decoder=new F("utf8")}Y=this._decoder.write(Y)}return this._parser.write(Y.toString()),this.emit("data",Y),!0},p.prototype.end=function(Y){return Y&&Y.length&&this.write(Y),this._parser.end(),!0},p.prototype.on=function(Y,F){var ie=this;return!ie._parser["on"+Y]&&h.indexOf(Y)!==-1&&(ie._parser["on"+Y]=function(){var ae=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);ae.splice(0,0,Y),ie.emit.apply(ie,ae)}),d.prototype.on.call(ie,Y,F)};var m="[CDATA[",A="DOCTYPE",y="http://www.w3.org/XML/1998/namespace",x="http://www.w3.org/2000/xmlns/",P={xml:y,xmlns:x},L=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,T=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,g=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function u(Y){return Y===" "||Y===`
`||Y==="\r"||Y==="	"}function b(Y){return Y==='"'||Y==="'"}function S(Y){return Y===">"||u(Y)}function M(Y,F){return Y.test(F)}function R(Y,F){return!M(Y,F)}var C=0;c.STATE={BEGIN:C++,BEGIN_WHITESPACE:C++,TEXT:C++,TEXT_ENTITY:C++,OPEN_WAKA:C++,SGML_DECL:C++,SGML_DECL_QUOTED:C++,DOCTYPE:C++,DOCTYPE_QUOTED:C++,DOCTYPE_DTD:C++,DOCTYPE_DTD_QUOTED:C++,COMMENT_STARTING:C++,COMMENT:C++,COMMENT_ENDING:C++,COMMENT_ENDED:C++,CDATA:C++,CDATA_ENDING:C++,CDATA_ENDING_2:C++,PROC_INST:C++,PROC_INST_BODY:C++,PROC_INST_ENDING:C++,OPEN_TAG:C++,OPEN_TAG_SLASH:C++,ATTRIB:C++,ATTRIB_NAME:C++,ATTRIB_NAME_SAW_WHITE:C++,ATTRIB_VALUE:C++,ATTRIB_VALUE_QUOTED:C++,ATTRIB_VALUE_CLOSED:C++,ATTRIB_VALUE_UNQUOTED:C++,ATTRIB_VALUE_ENTITY_Q:C++,ATTRIB_VALUE_ENTITY_U:C++,CLOSE_TAG:C++,CLOSE_TAG_SAW_WHITE:C++,SCRIPT:C++,SCRIPT_ENDING:C++},c.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},c.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(c.ENTITIES).forEach(function(Y){var F=c.ENTITIES[Y],ie=typeof F=="number"?String.fromCharCode(F):F;c.ENTITIES[Y]=ie});for(var D in c.STATE)c.STATE[c.STATE[D]]=D;C=c.STATE;function B(Y,F,ie){Y[F]&&Y[F](ie)}function Z(Y,F,ie){Y.textNode&&J(Y),B(Y,F,ie)}function J(Y){Y.textNode=q(Y.opt,Y.textNode),Y.textNode&&B(Y,"ontext",Y.textNode),Y.textNode=""}function q(Y,F){return Y.trim&&(F=F.trim()),Y.normalize&&(F=F.replace(/\s+/g," ")),F}function z(Y,F){return J(Y),Y.trackPosition&&(F+=`
Line: `+Y.line+`
Column: `+Y.column+`
Char: `+Y.c),F=new Error(F),Y.error=F,B(Y,"onerror",F),Y}function w(Y){return Y.sawRoot&&!Y.closedRoot&&N(Y,"Unclosed root tag"),Y.state!==C.BEGIN&&Y.state!==C.BEGIN_WHITESPACE&&Y.state!==C.TEXT&&z(Y,"Unexpected end"),J(Y),Y.c="",Y.closed=!0,B(Y,"onend"),i.call(Y,Y.strict,Y.opt),Y}function N(Y,F){if(typeof Y!="object"||!(Y instanceof i))throw new Error("bad call to strictFail");Y.strict&&z(Y,F)}function G(Y){Y.strict||(Y.tagName=Y.tagName[Y.looseCase]());var F=Y.tags[Y.tags.length-1]||Y,ie=Y.tag={name:Y.tagName,attributes:{}};Y.opt.xmlns&&(ie.ns=F.ns),Y.attribList.length=0,Z(Y,"onopentagstart",ie)}function V(Y,F){var ie=Y.indexOf(":"),ae=ie<0?["",Y]:Y.split(":"),de=ae[0],ve=ae[1];return F&&Y==="xmlns"&&(de="xmlns",ve=""),{prefix:de,local:ve}}function H(Y){if(Y.strict||(Y.attribName=Y.attribName[Y.looseCase]()),Y.attribList.indexOf(Y.attribName)!==-1||Y.tag.attributes.hasOwnProperty(Y.attribName)){Y.attribName=Y.attribValue="";return}if(Y.opt.xmlns){var F=V(Y.attribName,!0),ie=F.prefix,ae=F.local;if(ie==="xmlns")if(ae==="xml"&&Y.attribValue!==y)N(Y,"xml: prefix must be bound to "+y+`
Actual: `+Y.attribValue);else if(ae==="xmlns"&&Y.attribValue!==x)N(Y,"xmlns: prefix must be bound to "+x+`
Actual: `+Y.attribValue);else{var de=Y.tag,ve=Y.tags[Y.tags.length-1]||Y;de.ns===ve.ns&&(de.ns=Object.create(ve.ns)),de.ns[ae]=Y.attribValue}Y.attribList.push([Y.attribName,Y.attribValue])}else Y.tag.attributes[Y.attribName]=Y.attribValue,Z(Y,"onattribute",{name:Y.attribName,value:Y.attribValue});Y.attribName=Y.attribValue=""}function X(Y,F){if(Y.opt.xmlns){var ie=Y.tag,ae=V(Y.tagName);ie.prefix=ae.prefix,ie.local=ae.local,ie.uri=ie.ns[ae.prefix]||"",ie.prefix&&!ie.uri&&(N(Y,"Unbound namespace prefix: "+JSON.stringify(Y.tagName)),ie.uri=ae.prefix);var de=Y.tags[Y.tags.length-1]||Y;ie.ns&&de.ns!==ie.ns&&Object.keys(ie.ns).forEach(function(Re){Z(Y,"onopennamespace",{prefix:Re,uri:ie.ns[Re]})});for(var ve=0,ee=Y.attribList.length;ve<ee;ve++){var se=Y.attribList[ve],K=se[0],I=se[1],U=V(K,!0),oe=U.prefix,ge=U.local,Se=oe===""?"":ie.ns[oe]||"",Ce={name:K,value:I,prefix:oe,local:ge,uri:Se};oe&&oe!=="xmlns"&&!Se&&(N(Y,"Unbound namespace prefix: "+JSON.stringify(oe)),Ce.uri=oe),Y.tag.attributes[K]=Ce,Z(Y,"onattribute",Ce)}Y.attribList.length=0}Y.tag.isSelfClosing=!!F,Y.sawRoot=!0,Y.tags.push(Y.tag),Z(Y,"onopentag",Y.tag),F||(!Y.noscript&&Y.tagName.toLowerCase()==="script"?Y.state=C.SCRIPT:Y.state=C.TEXT,Y.tag=null,Y.tagName=""),Y.attribName=Y.attribValue="",Y.attribList.length=0}function Q(Y){if(!Y.tagName){N(Y,"Weird empty close tag."),Y.textNode+="</>",Y.state=C.TEXT;return}if(Y.script){if(Y.tagName!=="script"){Y.script+="</"+Y.tagName+">",Y.tagName="",Y.state=C.SCRIPT;return}Z(Y,"onscript",Y.script),Y.script=""}var F=Y.tags.length,ie=Y.tagName;Y.strict||(ie=ie[Y.looseCase]());for(var ae=ie;F--;){var de=Y.tags[F];if(de.name!==ae)N(Y,"Unexpected close tag");else break}if(F<0){N(Y,"Unmatched closing tag: "+Y.tagName),Y.textNode+="</"+Y.tagName+">",Y.state=C.TEXT;return}Y.tagName=ie;for(var ve=Y.tags.length;ve-- >F;){var ee=Y.tag=Y.tags.pop();Y.tagName=Y.tag.name,Z(Y,"onclosetag",Y.tagName);var se={};for(var K in ee.ns)se[K]=ee.ns[K];var I=Y.tags[Y.tags.length-1]||Y;Y.opt.xmlns&&ee.ns!==I.ns&&Object.keys(ee.ns).forEach(function(U){var oe=ee.ns[U];Z(Y,"onclosenamespace",{prefix:U,uri:oe})})}F===0&&(Y.closedRoot=!0),Y.tagName=Y.attribValue=Y.attribName="",Y.attribList.length=0,Y.state=C.TEXT}function ce(Y){var F=Y.entity,ie=F.toLowerCase(),ae,de="";return Y.ENTITIES[F]?Y.ENTITIES[F]:Y.ENTITIES[ie]?Y.ENTITIES[ie]:(F=ie,F.charAt(0)==="#"&&(F.charAt(1)==="x"?(F=F.slice(2),ae=parseInt(F,16),de=ae.toString(16)):(F=F.slice(1),ae=parseInt(F,10),de=ae.toString(10))),F=F.replace(/^0+/,""),isNaN(ae)||de.toLowerCase()!==F?(N(Y,"Invalid character entity"),"&"+Y.entity+";"):String.fromCodePoint(ae))}function pe(Y,F){F==="<"?(Y.state=C.OPEN_WAKA,Y.startTagPosition=Y.position):u(F)||(N(Y,"Non-whitespace before first tag."),Y.textNode=F,Y.state=C.TEXT)}function _e(Y,F){var ie="";return F<Y.length&&(ie=Y.charAt(F)),ie}function xe(Y){var F=this;if(this.error)throw this.error;if(F.closed)return z(F,"Cannot write after close. Assign an onready handler.");if(Y===null)return w(F);typeof Y=="object"&&(Y=Y.toString());for(var ie=0,ae="";ae=_e(Y,ie++),F.c=ae,!!ae;)switch(F.trackPosition&&(F.position++,ae===`
`?(F.line++,F.column=0):F.column++),F.state){case C.BEGIN:if(F.state=C.BEGIN_WHITESPACE,ae==="\uFEFF")continue;pe(F,ae);continue;case C.BEGIN_WHITESPACE:pe(F,ae);continue;case C.TEXT:if(F.sawRoot&&!F.closedRoot){for(var de=ie-1;ae&&ae!=="<"&&ae!=="&";)ae=_e(Y,ie++),ae&&F.trackPosition&&(F.position++,ae===`
`?(F.line++,F.column=0):F.column++);F.textNode+=Y.substring(de,ie-1)}ae==="<"&&!(F.sawRoot&&F.closedRoot&&!F.strict)?(F.state=C.OPEN_WAKA,F.startTagPosition=F.position):(!u(ae)&&(!F.sawRoot||F.closedRoot)&&N(F,"Text data outside of root node."),ae==="&"?F.state=C.TEXT_ENTITY:F.textNode+=ae);continue;case C.SCRIPT:ae==="<"?F.state=C.SCRIPT_ENDING:F.script+=ae;continue;case C.SCRIPT_ENDING:ae==="/"?F.state=C.CLOSE_TAG:(F.script+="<"+ae,F.state=C.SCRIPT);continue;case C.OPEN_WAKA:if(ae==="!")F.state=C.SGML_DECL,F.sgmlDecl="";else if(!u(ae))if(M(L,ae))F.state=C.OPEN_TAG,F.tagName=ae;else if(ae==="/")F.state=C.CLOSE_TAG,F.tagName="";else if(ae==="?")F.state=C.PROC_INST,F.procInstName=F.procInstBody="";else{if(N(F,"Unencoded <"),F.startTagPosition+1<F.position){var ve=F.position-F.startTagPosition;ae=new Array(ve).join(" ")+ae}F.textNode+="<"+ae,F.state=C.TEXT}continue;case C.SGML_DECL:(F.sgmlDecl+ae).toUpperCase()===m?(Z(F,"onopencdata"),F.state=C.CDATA,F.sgmlDecl="",F.cdata=""):F.sgmlDecl+ae==="--"?(F.state=C.COMMENT,F.comment="",F.sgmlDecl=""):(F.sgmlDecl+ae).toUpperCase()===A?(F.state=C.DOCTYPE,(F.doctype||F.sawRoot)&&N(F,"Inappropriately located doctype declaration"),F.doctype="",F.sgmlDecl=""):ae===">"?(Z(F,"onsgmldeclaration",F.sgmlDecl),F.sgmlDecl="",F.state=C.TEXT):(b(ae)&&(F.state=C.SGML_DECL_QUOTED),F.sgmlDecl+=ae);continue;case C.SGML_DECL_QUOTED:ae===F.q&&(F.state=C.SGML_DECL,F.q=""),F.sgmlDecl+=ae;continue;case C.DOCTYPE:ae===">"?(F.state=C.TEXT,Z(F,"ondoctype",F.doctype),F.doctype=!0):(F.doctype+=ae,ae==="["?F.state=C.DOCTYPE_DTD:b(ae)&&(F.state=C.DOCTYPE_QUOTED,F.q=ae));continue;case C.DOCTYPE_QUOTED:F.doctype+=ae,ae===F.q&&(F.q="",F.state=C.DOCTYPE);continue;case C.DOCTYPE_DTD:F.doctype+=ae,ae==="]"?F.state=C.DOCTYPE:b(ae)&&(F.state=C.DOCTYPE_DTD_QUOTED,F.q=ae);continue;case C.DOCTYPE_DTD_QUOTED:F.doctype+=ae,ae===F.q&&(F.state=C.DOCTYPE_DTD,F.q="");continue;case C.COMMENT:ae==="-"?F.state=C.COMMENT_ENDING:F.comment+=ae;continue;case C.COMMENT_ENDING:ae==="-"?(F.state=C.COMMENT_ENDED,F.comment=q(F.opt,F.comment),F.comment&&Z(F,"oncomment",F.comment),F.comment=""):(F.comment+="-"+ae,F.state=C.COMMENT);continue;case C.COMMENT_ENDED:ae!==">"?(N(F,"Malformed comment"),F.comment+="--"+ae,F.state=C.COMMENT):F.state=C.TEXT;continue;case C.CDATA:ae==="]"?F.state=C.CDATA_ENDING:F.cdata+=ae;continue;case C.CDATA_ENDING:ae==="]"?F.state=C.CDATA_ENDING_2:(F.cdata+="]"+ae,F.state=C.CDATA);continue;case C.CDATA_ENDING_2:ae===">"?(F.cdata&&Z(F,"oncdata",F.cdata),Z(F,"onclosecdata"),F.cdata="",F.state=C.TEXT):ae==="]"?F.cdata+="]":(F.cdata+="]]"+ae,F.state=C.CDATA);continue;case C.PROC_INST:ae==="?"?F.state=C.PROC_INST_ENDING:u(ae)?F.state=C.PROC_INST_BODY:F.procInstName+=ae;continue;case C.PROC_INST_BODY:if(!F.procInstBody&&u(ae))continue;ae==="?"?F.state=C.PROC_INST_ENDING:F.procInstBody+=ae;continue;case C.PROC_INST_ENDING:ae===">"?(Z(F,"onprocessinginstruction",{name:F.procInstName,body:F.procInstBody}),F.procInstName=F.procInstBody="",F.state=C.TEXT):(F.procInstBody+="?"+ae,F.state=C.PROC_INST_BODY);continue;case C.OPEN_TAG:M(T,ae)?F.tagName+=ae:(G(F),ae===">"?X(F):ae==="/"?F.state=C.OPEN_TAG_SLASH:(u(ae)||N(F,"Invalid character in tag name"),F.state=C.ATTRIB));continue;case C.OPEN_TAG_SLASH:ae===">"?(X(F,!0),Q(F)):(N(F,"Forward-slash in opening tag not followed by >"),F.state=C.ATTRIB);continue;case C.ATTRIB:if(u(ae))continue;ae===">"?X(F):ae==="/"?F.state=C.OPEN_TAG_SLASH:M(L,ae)?(F.attribName=ae,F.attribValue="",F.state=C.ATTRIB_NAME):N(F,"Invalid attribute name");continue;case C.ATTRIB_NAME:ae==="="?F.state=C.ATTRIB_VALUE:ae===">"?(N(F,"Attribute without value"),F.attribValue=F.attribName,H(F),X(F)):u(ae)?F.state=C.ATTRIB_NAME_SAW_WHITE:M(T,ae)?F.attribName+=ae:N(F,"Invalid attribute name");continue;case C.ATTRIB_NAME_SAW_WHITE:if(ae==="=")F.state=C.ATTRIB_VALUE;else{if(u(ae))continue;N(F,"Attribute without value"),F.tag.attributes[F.attribName]="",F.attribValue="",Z(F,"onattribute",{name:F.attribName,value:""}),F.attribName="",ae===">"?X(F):M(L,ae)?(F.attribName=ae,F.state=C.ATTRIB_NAME):(N(F,"Invalid attribute name"),F.state=C.ATTRIB)}continue;case C.ATTRIB_VALUE:if(u(ae))continue;b(ae)?(F.q=ae,F.state=C.ATTRIB_VALUE_QUOTED):(N(F,"Unquoted attribute value"),F.state=C.ATTRIB_VALUE_UNQUOTED,F.attribValue=ae);continue;case C.ATTRIB_VALUE_QUOTED:if(ae!==F.q){ae==="&"?F.state=C.ATTRIB_VALUE_ENTITY_Q:F.attribValue+=ae;continue}H(F),F.q="",F.state=C.ATTRIB_VALUE_CLOSED;continue;case C.ATTRIB_VALUE_CLOSED:u(ae)?F.state=C.ATTRIB:ae===">"?X(F):ae==="/"?F.state=C.OPEN_TAG_SLASH:M(L,ae)?(N(F,"No whitespace between attributes"),F.attribName=ae,F.attribValue="",F.state=C.ATTRIB_NAME):N(F,"Invalid attribute name");continue;case C.ATTRIB_VALUE_UNQUOTED:if(!S(ae)){ae==="&"?F.state=C.ATTRIB_VALUE_ENTITY_U:F.attribValue+=ae;continue}H(F),ae===">"?X(F):F.state=C.ATTRIB;continue;case C.CLOSE_TAG:if(F.tagName)ae===">"?Q(F):M(T,ae)?F.tagName+=ae:F.script?(F.script+="</"+F.tagName,F.tagName="",F.state=C.SCRIPT):(u(ae)||N(F,"Invalid tagname in closing tag"),F.state=C.CLOSE_TAG_SAW_WHITE);else{if(u(ae))continue;R(L,ae)?F.script?(F.script+="</"+ae,F.state=C.SCRIPT):N(F,"Invalid tagname in closing tag."):F.tagName=ae}continue;case C.CLOSE_TAG_SAW_WHITE:if(u(ae))continue;ae===">"?Q(F):N(F,"Invalid characters in closing tag");continue;case C.TEXT_ENTITY:case C.ATTRIB_VALUE_ENTITY_Q:case C.ATTRIB_VALUE_ENTITY_U:var ee,se;switch(F.state){case C.TEXT_ENTITY:ee=C.TEXT,se="textNode";break;case C.ATTRIB_VALUE_ENTITY_Q:ee=C.ATTRIB_VALUE_QUOTED,se="attribValue";break;case C.ATTRIB_VALUE_ENTITY_U:ee=C.ATTRIB_VALUE_UNQUOTED,se="attribValue";break}ae===";"?(F[se]+=ce(F),F.entity="",F.state=ee):M(F.entity.length?_:g,ae)?F.entity+=ae:(N(F,"Invalid character in entity name"),F[se]+="&"+F.entity+ae,F.entity="",F.state=ee);continue;default:throw new Error(F,"Unknown state: "+F.state)}return F.position>=F.bufferCheckPosition&&o(F),F}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var Y=String.fromCharCode,F=Math.floor,ie=function(){var ae=16384,de=[],ve,ee,se=-1,K=arguments.length;if(!K)return"";for(var I="";++se<K;){var U=Number(arguments[se]);if(!isFinite(U)||U<0||U>1114111||F(U)!==U)throw RangeError("Invalid code point: "+U);U<=65535?de.push(U):(U-=65536,ve=(U>>10)+55296,ee=U%1024+56320,de.push(ve,ee)),(se+1===K||de.length>ae)&&(I+=Y.apply(null,de),de.length=0)}return I};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:ie,configurable:!0,writable:!0}):String.fromCodePoint=ie}()})(typeof s>"u"?this.sax={}:s)}).call(this)}).call(this,t("buffer").Buffer)},{buffer:3,stream:11,string_decoder:27}],11:[function(t,n,s){n.exports=a;var e=t("events").EventEmitter,c=t("inherits");c(a,e),a.Readable=t("readable-stream/lib/_stream_readable.js"),a.Writable=t("readable-stream/lib/_stream_writable.js"),a.Duplex=t("readable-stream/lib/_stream_duplex.js"),a.Transform=t("readable-stream/lib/_stream_transform.js"),a.PassThrough=t("readable-stream/lib/_stream_passthrough.js"),a.finished=t("readable-stream/lib/internal/streams/end-of-stream.js"),a.pipeline=t("readable-stream/lib/internal/streams/pipeline.js"),a.Stream=a;function a(){e.call(this)}a.prototype.pipe=function(i,o){var l=this;function r(y){i.writable&&i.write(y)===!1&&l.pause&&l.pause()}l.on("data",r);function d(){l.readable&&l.resume&&l.resume()}i.on("drain",d),!i._isStdio&&(!o||o.end!==!1)&&(l.on("end",v),l.on("close",p));var h=!1;function v(){h||(h=!0,i.end())}function p(){h||(h=!0,typeof i.destroy=="function"&&i.destroy())}function m(y){if(A(),e.listenerCount(this,"error")===0)throw y}l.on("error",m),i.on("error",m);function A(){l.removeListener("data",r),i.removeListener("drain",d),l.removeListener("end",v),l.removeListener("close",p),l.removeListener("error",m),i.removeListener("error",m),l.removeListener("end",A),l.removeListener("close",A),i.removeListener("close",A)}return l.on("end",A),l.on("close",A),i.on("close",A),i.emit("pipe",l),i}},{events:5,inherits:12,"readable-stream/lib/_stream_duplex.js":14,"readable-stream/lib/_stream_passthrough.js":15,"readable-stream/lib/_stream_readable.js":16,"readable-stream/lib/_stream_transform.js":17,"readable-stream/lib/_stream_writable.js":18,"readable-stream/lib/internal/streams/end-of-stream.js":22,"readable-stream/lib/internal/streams/pipeline.js":24}],12:[function(t,n,s){typeof Object.create=="function"?n.exports=function(c,a){a&&(c.super_=a,c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(c,a){if(a){c.super_=a;var i=function(){};i.prototype=a.prototype,c.prototype=new i,c.prototype.constructor=c}}},{}],13:[function(t,n,s){function e(d,h){d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.__proto__=h}var c={};function a(d,h,v){v||(v=Error);function p(A,y,x){return typeof h=="string"?h:h(A,y,x)}var m=function(A){e(y,A);function y(x,P,L){return A.call(this,p(x,P,L))||this}return y}(v);m.prototype.name=v.name,m.prototype.code=d,c[d]=m}function i(d,h){if(Array.isArray(d)){var v=d.length;return d=d.map(function(p){return String(p)}),v>2?"one of ".concat(h," ").concat(d.slice(0,v-1).join(", "),", or ")+d[v-1]:v===2?"one of ".concat(h," ").concat(d[0]," or ").concat(d[1]):"of ".concat(h," ").concat(d[0])}else return"of ".concat(h," ").concat(String(d))}function o(d,h,v){return d.substr(0,h.length)===h}function l(d,h,v){return(v===void 0||v>d.length)&&(v=d.length),d.substring(v-h.length,v)===h}function r(d,h,v){return typeof v!="number"&&(v=0),v+h.length>d.length?!1:d.indexOf(h,v)!==-1}a("ERR_INVALID_OPT_VALUE",function(d,h){return'The value "'+h+'" is invalid for option "'+d+'"'},TypeError),a("ERR_INVALID_ARG_TYPE",function(d,h,v){var p;typeof h=="string"&&o(h,"not ")?(p="must not be",h=h.replace(/^not /,"")):p="must be";var m;if(l(d," argument"))m="The ".concat(d," ").concat(p," ").concat(i(h,"type"));else{var A=r(d,".")?"property":"argument";m='The "'.concat(d,'" ').concat(A," ").concat(p," ").concat(i(h,"type"))}return m+=". Received type ".concat(typeof v),m},TypeError),a("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),a("ERR_METHOD_NOT_IMPLEMENTED",function(d){return"The "+d+" method is not implemented"}),a("ERR_STREAM_PREMATURE_CLOSE","Premature close"),a("ERR_STREAM_DESTROYED",function(d){return"Cannot call "+d+" after a stream was destroyed"}),a("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),a("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),a("ERR_STREAM_WRITE_AFTER_END","write after end"),a("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),a("ERR_UNKNOWN_ENCODING",function(d){return"Unknown encoding: "+d},TypeError),a("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),n.exports.codes=c},{}],14:[function(t,n,s){(function(e){(function(){var c=Object.keys||function(p){var m=[];for(var A in p)m.push(A);return m};n.exports=d;var a=t("./_stream_readable"),i=t("./_stream_writable");t("inherits")(d,a);for(var o=c(i.prototype),l=0;l<o.length;l++){var r=o[l];d.prototype[r]||(d.prototype[r]=i.prototype[r])}function d(p){if(!(this instanceof d))return new d(p);a.call(this,p),i.call(this,p),this.allowHalfOpen=!0,p&&(p.readable===!1&&(this.readable=!1),p.writable===!1&&(this.writable=!1),p.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",h)))}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function h(){this._writableState.ended||e.nextTick(v,this)}function v(p){p.end()}Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(m){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=m,this._writableState.destroyed=m)}})}).call(this)}).call(this,t("_process"))},{"./_stream_readable":16,"./_stream_writable":18,_process:8,inherits:12}],15:[function(t,n,s){n.exports=c;var e=t("./_stream_transform");t("inherits")(c,e);function c(a){if(!(this instanceof c))return new c(a);e.call(this,a)}c.prototype._transform=function(a,i,o){o(null,a)}},{"./_stream_transform":17,inherits:12}],16:[function(t,n,s){(function(e,c){(function(){n.exports=B;var a;B.ReadableState=D,t("events").EventEmitter;var i=function(se,K){return se.listeners(K).length},o=t("./internal/streams/stream"),l=t("buffer").Buffer,r=c.Uint8Array||function(){};function d(ee){return l.from(ee)}function h(ee){return l.isBuffer(ee)||ee instanceof r}var v=t("util"),p;v&&v.debuglog?p=v.debuglog("stream"):p=function(){};var m=t("./internal/streams/buffer_list"),A=t("./internal/streams/destroy"),y=t("./internal/streams/state"),x=y.getHighWaterMark,P=t("../errors").codes,L=P.ERR_INVALID_ARG_TYPE,T=P.ERR_STREAM_PUSH_AFTER_EOF,g=P.ERR_METHOD_NOT_IMPLEMENTED,_=P.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,u,b,S;t("inherits")(B,o);var M=A.errorOrDestroy,R=["error","close","destroy","pause","resume"];function C(ee,se,K){if(typeof ee.prependListener=="function")return ee.prependListener(se,K);!ee._events||!ee._events[se]?ee.on(se,K):Array.isArray(ee._events[se])?ee._events[se].unshift(K):ee._events[se]=[K,ee._events[se]]}function D(ee,se,K){a=a||t("./_stream_duplex"),ee=ee||{},typeof K!="boolean"&&(K=se instanceof a),this.objectMode=!!ee.objectMode,K&&(this.objectMode=this.objectMode||!!ee.readableObjectMode),this.highWaterMark=x(this,ee,"readableHighWaterMark",K),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=ee.emitClose!==!1,this.autoDestroy=!!ee.autoDestroy,this.destroyed=!1,this.defaultEncoding=ee.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,ee.encoding&&(u||(u=t("string_decoder/").StringDecoder),this.decoder=new u(ee.encoding),this.encoding=ee.encoding)}function B(ee){if(a=a||t("./_stream_duplex"),!(this instanceof B))return new B(ee);var se=this instanceof a;this._readableState=new D(ee,this,se),this.readable=!0,ee&&(typeof ee.read=="function"&&(this._read=ee.read),typeof ee.destroy=="function"&&(this._destroy=ee.destroy)),o.call(this)}Object.defineProperty(B.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(se){this._readableState&&(this._readableState.destroyed=se)}}),B.prototype.destroy=A.destroy,B.prototype._undestroy=A.undestroy,B.prototype._destroy=function(ee,se){se(ee)},B.prototype.push=function(ee,se){var K=this._readableState,I;return K.objectMode?I=!0:typeof ee=="string"&&(se=se||K.defaultEncoding,se!==K.encoding&&(ee=l.from(ee,se),se=""),I=!0),Z(this,ee,se,!1,I)},B.prototype.unshift=function(ee){return Z(this,ee,null,!0,!1)};function Z(ee,se,K,I,U){p("readableAddChunk",se);var oe=ee._readableState;if(se===null)oe.reading=!1,G(ee,oe);else{var ge;if(U||(ge=q(oe,se)),ge)M(ee,ge);else if(oe.objectMode||se&&se.length>0)if(typeof se!="string"&&!oe.objectMode&&Object.getPrototypeOf(se)!==l.prototype&&(se=d(se)),I)oe.endEmitted?M(ee,new _):J(ee,oe,se,!0);else if(oe.ended)M(ee,new T);else{if(oe.destroyed)return!1;oe.reading=!1,oe.decoder&&!K?(se=oe.decoder.write(se),oe.objectMode||se.length!==0?J(ee,oe,se,!1):X(ee,oe)):J(ee,oe,se,!1)}else I||(oe.reading=!1,X(ee,oe))}return!oe.ended&&(oe.length<oe.highWaterMark||oe.length===0)}function J(ee,se,K,I){se.flowing&&se.length===0&&!se.sync?(se.awaitDrain=0,ee.emit("data",K)):(se.length+=se.objectMode?1:K.length,I?se.buffer.unshift(K):se.buffer.push(K),se.needReadable&&V(ee)),X(ee,se)}function q(ee,se){var K;return!h(se)&&typeof se!="string"&&se!==void 0&&!ee.objectMode&&(K=new L("chunk",["string","Buffer","Uint8Array"],se)),K}B.prototype.isPaused=function(){return this._readableState.flowing===!1},B.prototype.setEncoding=function(ee){u||(u=t("string_decoder/").StringDecoder);var se=new u(ee);this._readableState.decoder=se,this._readableState.encoding=this._readableState.decoder.encoding;for(var K=this._readableState.buffer.head,I="";K!==null;)I+=se.write(K.data),K=K.next;return this._readableState.buffer.clear(),I!==""&&this._readableState.buffer.push(I),this._readableState.length=I.length,this};var z=1073741824;function w(ee){return ee>=z?ee=z:(ee--,ee|=ee>>>1,ee|=ee>>>2,ee|=ee>>>4,ee|=ee>>>8,ee|=ee>>>16,ee++),ee}function N(ee,se){return ee<=0||se.length===0&&se.ended?0:se.objectMode?1:ee!==ee?se.flowing&&se.length?se.buffer.head.data.length:se.length:(ee>se.highWaterMark&&(se.highWaterMark=w(ee)),ee<=se.length?ee:se.ended?se.length:(se.needReadable=!0,0))}B.prototype.read=function(ee){p("read",ee),ee=parseInt(ee,10);var se=this._readableState,K=ee;if(ee!==0&&(se.emittedReadable=!1),ee===0&&se.needReadable&&((se.highWaterMark!==0?se.length>=se.highWaterMark:se.length>0)||se.ended))return p("read: emitReadable",se.length,se.ended),se.length===0&&se.ended?ae(this):V(this),null;if(ee=N(ee,se),ee===0&&se.ended)return se.length===0&&ae(this),null;var I=se.needReadable;p("need readable",I),(se.length===0||se.length-ee<se.highWaterMark)&&(I=!0,p("length less than watermark",I)),se.ended||se.reading?(I=!1,p("reading or ended",I)):I&&(p("do read"),se.reading=!0,se.sync=!0,se.length===0&&(se.needReadable=!0),this._read(se.highWaterMark),se.sync=!1,se.reading||(ee=N(K,se)));var U;return ee>0?U=ie(ee,se):U=null,U===null?(se.needReadable=se.length<=se.highWaterMark,ee=0):(se.length-=ee,se.awaitDrain=0),se.length===0&&(se.ended||(se.needReadable=!0),K!==ee&&se.ended&&ae(this)),U!==null&&this.emit("data",U),U};function G(ee,se){if(p("onEofChunk"),!se.ended){if(se.decoder){var K=se.decoder.end();K&&K.length&&(se.buffer.push(K),se.length+=se.objectMode?1:K.length)}se.ended=!0,se.sync?V(ee):(se.needReadable=!1,se.emittedReadable||(se.emittedReadable=!0,H(ee)))}}function V(ee){var se=ee._readableState;p("emitReadable",se.needReadable,se.emittedReadable),se.needReadable=!1,se.emittedReadable||(p("emitReadable",se.flowing),se.emittedReadable=!0,e.nextTick(H,ee))}function H(ee){var se=ee._readableState;p("emitReadable_",se.destroyed,se.length,se.ended),!se.destroyed&&(se.length||se.ended)&&(ee.emit("readable"),se.emittedReadable=!1),se.needReadable=!se.flowing&&!se.ended&&se.length<=se.highWaterMark,F(ee)}function X(ee,se){se.readingMore||(se.readingMore=!0,e.nextTick(Q,ee,se))}function Q(ee,se){for(;!se.reading&&!se.ended&&(se.length<se.highWaterMark||se.flowing&&se.length===0);){var K=se.length;if(p("maybeReadMore read 0"),ee.read(0),K===se.length)break}se.readingMore=!1}B.prototype._read=function(ee){M(this,new g("_read()"))},B.prototype.pipe=function(ee,se){var K=this,I=this._readableState;switch(I.pipesCount){case 0:I.pipes=ee;break;case 1:I.pipes=[I.pipes,ee];break;default:I.pipes.push(ee);break}I.pipesCount+=1,p("pipe count=%d opts=%j",I.pipesCount,se);var U=(!se||se.end!==!1)&&ee!==e.stdout&&ee!==e.stderr,oe=U?Se:Qe;I.endEmitted?e.nextTick(oe):K.once("end",oe),ee.on("unpipe",ge);function ge(je,W){p("onunpipe"),je===K&&W&&W.hasUnpiped===!1&&(W.hasUnpiped=!0,qe())}function Se(){p("onend"),ee.end()}var Ce=ce(K);ee.on("drain",Ce);var Re=!1;function qe(){p("cleanup"),ee.removeListener("close",He),ee.removeListener("finish",Xe),ee.removeListener("drain",Ce),ee.removeListener("error",Ye),ee.removeListener("unpipe",ge),K.removeListener("end",Se),K.removeListener("end",Qe),K.removeListener("data",Ge),Re=!0,I.awaitDrain&&(!ee._writableState||ee._writableState.needDrain)&&Ce()}K.on("data",Ge);function Ge(je){p("ondata");var W=ee.write(je);p("dest.write",W),W===!1&&((I.pipesCount===1&&I.pipes===ee||I.pipesCount>1&&ve(I.pipes,ee)!==-1)&&!Re&&(p("false write response, pause",I.awaitDrain),I.awaitDrain++),K.pause())}function Ye(je){p("onerror",je),Qe(),ee.removeListener("error",Ye),i(ee,"error")===0&&M(ee,je)}C(ee,"error",Ye);function He(){ee.removeListener("finish",Xe),Qe()}ee.once("close",He);function Xe(){p("onfinish"),ee.removeListener("close",He),Qe()}ee.once("finish",Xe);function Qe(){p("unpipe"),K.unpipe(ee)}return ee.emit("pipe",K),I.flowing||(p("pipe resume"),K.resume()),ee};function ce(ee){return function(){var K=ee._readableState;p("pipeOnDrain",K.awaitDrain),K.awaitDrain&&K.awaitDrain--,K.awaitDrain===0&&i(ee,"data")&&(K.flowing=!0,F(ee))}}B.prototype.unpipe=function(ee){var se=this._readableState,K={hasUnpiped:!1};if(se.pipesCount===0)return this;if(se.pipesCount===1)return ee&&ee!==se.pipes?this:(ee||(ee=se.pipes),se.pipes=null,se.pipesCount=0,se.flowing=!1,ee&&ee.emit("unpipe",this,K),this);if(!ee){var I=se.pipes,U=se.pipesCount;se.pipes=null,se.pipesCount=0,se.flowing=!1;for(var oe=0;oe<U;oe++)I[oe].emit("unpipe",this,{hasUnpiped:!1});return this}var ge=ve(se.pipes,ee);return ge===-1?this:(se.pipes.splice(ge,1),se.pipesCount-=1,se.pipesCount===1&&(se.pipes=se.pipes[0]),ee.emit("unpipe",this,K),this)},B.prototype.on=function(ee,se){var K=o.prototype.on.call(this,ee,se),I=this._readableState;return ee==="data"?(I.readableListening=this.listenerCount("readable")>0,I.flowing!==!1&&this.resume()):ee==="readable"&&!I.endEmitted&&!I.readableListening&&(I.readableListening=I.needReadable=!0,I.flowing=!1,I.emittedReadable=!1,p("on readable",I.length,I.reading),I.length?V(this):I.reading||e.nextTick(_e,this)),K},B.prototype.addListener=B.prototype.on,B.prototype.removeListener=function(ee,se){var K=o.prototype.removeListener.call(this,ee,se);return ee==="readable"&&e.nextTick(pe,this),K},B.prototype.removeAllListeners=function(ee){var se=o.prototype.removeAllListeners.apply(this,arguments);return(ee==="readable"||ee===void 0)&&e.nextTick(pe,this),se};function pe(ee){var se=ee._readableState;se.readableListening=ee.listenerCount("readable")>0,se.resumeScheduled&&!se.paused?se.flowing=!0:ee.listenerCount("data")>0&&ee.resume()}function _e(ee){p("readable nexttick read 0"),ee.read(0)}B.prototype.resume=function(){var ee=this._readableState;return ee.flowing||(p("resume"),ee.flowing=!ee.readableListening,xe(this,ee)),ee.paused=!1,this};function xe(ee,se){se.resumeScheduled||(se.resumeScheduled=!0,e.nextTick(Y,ee,se))}function Y(ee,se){p("resume",se.reading),se.reading||ee.read(0),se.resumeScheduled=!1,ee.emit("resume"),F(ee),se.flowing&&!se.reading&&ee.read(0)}B.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function F(ee){var se=ee._readableState;for(p("flow",se.flowing);se.flowing&&ee.read()!==null;);}B.prototype.wrap=function(ee){var se=this,K=this._readableState,I=!1;ee.on("end",function(){if(p("wrapped end"),K.decoder&&!K.ended){var ge=K.decoder.end();ge&&ge.length&&se.push(ge)}se.push(null)}),ee.on("data",function(ge){if(p("wrapped data"),K.decoder&&(ge=K.decoder.write(ge)),!(K.objectMode&&ge==null)&&!(!K.objectMode&&(!ge||!ge.length))){var Se=se.push(ge);Se||(I=!0,ee.pause())}});for(var U in ee)this[U]===void 0&&typeof ee[U]=="function"&&(this[U]=function(Se){return function(){return ee[Se].apply(ee,arguments)}}(U));for(var oe=0;oe<R.length;oe++)ee.on(R[oe],this.emit.bind(this,R[oe]));return this._read=function(ge){p("wrapped _read",ge),I&&(I=!1,ee.resume())},this},typeof Symbol=="function"&&(B.prototype[Symbol.asyncIterator]=function(){return b===void 0&&(b=t("./internal/streams/async_iterator")),b(this)}),Object.defineProperty(B.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(B.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(B.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(se){this._readableState&&(this._readableState.flowing=se)}}),B._fromList=ie,Object.defineProperty(B.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function ie(ee,se){if(se.length===0)return null;var K;return se.objectMode?K=se.buffer.shift():!ee||ee>=se.length?(se.decoder?K=se.buffer.join(""):se.buffer.length===1?K=se.buffer.first():K=se.buffer.concat(se.length),se.buffer.clear()):K=se.buffer.consume(ee,se.decoder),K}function ae(ee){var se=ee._readableState;p("endReadable",se.endEmitted),se.endEmitted||(se.ended=!0,e.nextTick(de,se,ee))}function de(ee,se){if(p("endReadableNT",ee.endEmitted,ee.length),!ee.endEmitted&&ee.length===0&&(ee.endEmitted=!0,se.readable=!1,se.emit("end"),ee.autoDestroy)){var K=se._writableState;(!K||K.autoDestroy&&K.finished)&&se.destroy()}}typeof Symbol=="function"&&(B.from=function(ee,se){return S===void 0&&(S=t("./internal/streams/from")),S(B,ee,se)});function ve(ee,se){for(var K=0,I=ee.length;K<I;K++)if(ee[K]===se)return K;return-1}}).call(this)}).call(this,t("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":13,"./_stream_duplex":14,"./internal/streams/async_iterator":19,"./internal/streams/buffer_list":20,"./internal/streams/destroy":21,"./internal/streams/from":23,"./internal/streams/state":25,"./internal/streams/stream":26,_process:8,buffer:3,events:5,inherits:12,"string_decoder/":27,util:2}],17:[function(t,n,s){n.exports=d;var e=t("../errors").codes,c=e.ERR_METHOD_NOT_IMPLEMENTED,a=e.ERR_MULTIPLE_CALLBACK,i=e.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=e.ERR_TRANSFORM_WITH_LENGTH_0,l=t("./_stream_duplex");t("inherits")(d,l);function r(p,m){var A=this._transformState;A.transforming=!1;var y=A.writecb;if(y===null)return this.emit("error",new a);A.writechunk=null,A.writecb=null,m!=null&&this.push(m),y(p);var x=this._readableState;x.reading=!1,(x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}function d(p){if(!(this instanceof d))return new d(p);l.call(this,p),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,p&&(typeof p.transform=="function"&&(this._transform=p.transform),typeof p.flush=="function"&&(this._flush=p.flush)),this.on("prefinish",h)}function h(){var p=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(m,A){v(p,m,A)}):v(this,null,null)}d.prototype.push=function(p,m){return this._transformState.needTransform=!1,l.prototype.push.call(this,p,m)},d.prototype._transform=function(p,m,A){A(new c("_transform()"))},d.prototype._write=function(p,m,A){var y=this._transformState;if(y.writecb=A,y.writechunk=p,y.writeencoding=m,!y.transforming){var x=this._readableState;(y.needTransform||x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}},d.prototype._read=function(p){var m=this._transformState;m.writechunk!==null&&!m.transforming?(m.transforming=!0,this._transform(m.writechunk,m.writeencoding,m.afterTransform)):m.needTransform=!0},d.prototype._destroy=function(p,m){l.prototype._destroy.call(this,p,function(A){m(A)})};function v(p,m,A){if(m)return p.emit("error",m);if(A!=null&&p.push(A),p._writableState.length)throw new o;if(p._transformState.transforming)throw new i;return p.push(null)}},{"../errors":13,"./_stream_duplex":14,inherits:12}],18:[function(t,n,s){(function(e,c){(function(){n.exports=D;function a(F){var ie=this;this.next=null,this.entry=null,this.finish=function(){Y(ie,F)}}var i;D.WritableState=R;var o={deprecate:t("util-deprecate")},l=t("./internal/streams/stream"),r=t("buffer").Buffer,d=c.Uint8Array||function(){};function h(F){return r.from(F)}function v(F){return r.isBuffer(F)||F instanceof d}var p=t("./internal/streams/destroy"),m=t("./internal/streams/state"),A=m.getHighWaterMark,y=t("../errors").codes,x=y.ERR_INVALID_ARG_TYPE,P=y.ERR_METHOD_NOT_IMPLEMENTED,L=y.ERR_MULTIPLE_CALLBACK,T=y.ERR_STREAM_CANNOT_PIPE,g=y.ERR_STREAM_DESTROYED,_=y.ERR_STREAM_NULL_VALUES,u=y.ERR_STREAM_WRITE_AFTER_END,b=y.ERR_UNKNOWN_ENCODING,S=p.errorOrDestroy;t("inherits")(D,l);function M(){}function R(F,ie,ae){i=i||t("./_stream_duplex"),F=F||{},typeof ae!="boolean"&&(ae=ie instanceof i),this.objectMode=!!F.objectMode,ae&&(this.objectMode=this.objectMode||!!F.writableObjectMode),this.highWaterMark=A(this,F,"writableHighWaterMark",ae),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var de=F.decodeStrings===!1;this.decodeStrings=!de,this.defaultEncoding=F.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ve){G(ie,ve)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=F.emitClose!==!1,this.autoDestroy=!!F.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}R.prototype.getBuffer=function(){for(var ie=this.bufferedRequest,ae=[];ie;)ae.push(ie),ie=ie.next;return ae},function(){try{Object.defineProperty(R.prototype,"buffer",{get:o.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var C;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(C=Function.prototype[Symbol.hasInstance],Object.defineProperty(D,Symbol.hasInstance,{value:function(ie){return C.call(this,ie)?!0:this!==D?!1:ie&&ie._writableState instanceof R}})):C=function(ie){return ie instanceof this};function D(F){i=i||t("./_stream_duplex");var ie=this instanceof i;if(!ie&&!C.call(D,this))return new D(F);this._writableState=new R(F,this,ie),this.writable=!0,F&&(typeof F.write=="function"&&(this._write=F.write),typeof F.writev=="function"&&(this._writev=F.writev),typeof F.destroy=="function"&&(this._destroy=F.destroy),typeof F.final=="function"&&(this._final=F.final)),l.call(this)}D.prototype.pipe=function(){S(this,new T)};function B(F,ie){var ae=new u;S(F,ae),e.nextTick(ie,ae)}function Z(F,ie,ae,de){var ve;return ae===null?ve=new _:typeof ae!="string"&&!ie.objectMode&&(ve=new x("chunk",["string","Buffer"],ae)),ve?(S(F,ve),e.nextTick(de,ve),!1):!0}D.prototype.write=function(F,ie,ae){var de=this._writableState,ve=!1,ee=!de.objectMode&&v(F);return ee&&!r.isBuffer(F)&&(F=h(F)),typeof ie=="function"&&(ae=ie,ie=null),ee?ie="buffer":ie||(ie=de.defaultEncoding),typeof ae!="function"&&(ae=M),de.ending?B(this,ae):(ee||Z(this,de,F,ae))&&(de.pendingcb++,ve=q(this,de,ee,F,ie,ae)),ve},D.prototype.cork=function(){this._writableState.corked++},D.prototype.uncork=function(){var F=this._writableState;F.corked&&(F.corked--,!F.writing&&!F.corked&&!F.bufferProcessing&&F.bufferedRequest&&X(this,F))},D.prototype.setDefaultEncoding=function(ie){if(typeof ie=="string"&&(ie=ie.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ie+"").toLowerCase())>-1))throw new b(ie);return this._writableState.defaultEncoding=ie,this},Object.defineProperty(D.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function J(F,ie,ae){return!F.objectMode&&F.decodeStrings!==!1&&typeof ie=="string"&&(ie=r.from(ie,ae)),ie}Object.defineProperty(D.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function q(F,ie,ae,de,ve,ee){if(!ae){var se=J(ie,de,ve);de!==se&&(ae=!0,ve="buffer",de=se)}var K=ie.objectMode?1:de.length;ie.length+=K;var I=ie.length<ie.highWaterMark;if(I||(ie.needDrain=!0),ie.writing||ie.corked){var U=ie.lastBufferedRequest;ie.lastBufferedRequest={chunk:de,encoding:ve,isBuf:ae,callback:ee,next:null},U?U.next=ie.lastBufferedRequest:ie.bufferedRequest=ie.lastBufferedRequest,ie.bufferedRequestCount+=1}else z(F,ie,!1,K,de,ve,ee);return I}function z(F,ie,ae,de,ve,ee,se){ie.writelen=de,ie.writecb=se,ie.writing=!0,ie.sync=!0,ie.destroyed?ie.onwrite(new g("write")):ae?F._writev(ve,ie.onwrite):F._write(ve,ee,ie.onwrite),ie.sync=!1}function w(F,ie,ae,de,ve){--ie.pendingcb,ae?(e.nextTick(ve,de),e.nextTick(_e,F,ie),F._writableState.errorEmitted=!0,S(F,de)):(ve(de),F._writableState.errorEmitted=!0,S(F,de),_e(F,ie))}function N(F){F.writing=!1,F.writecb=null,F.length-=F.writelen,F.writelen=0}function G(F,ie){var ae=F._writableState,de=ae.sync,ve=ae.writecb;if(typeof ve!="function")throw new L;if(N(ae),ie)w(F,ae,de,ie,ve);else{var ee=Q(ae)||F.destroyed;!ee&&!ae.corked&&!ae.bufferProcessing&&ae.bufferedRequest&&X(F,ae),de?e.nextTick(V,F,ae,ee,ve):V(F,ae,ee,ve)}}function V(F,ie,ae,de){ae||H(F,ie),ie.pendingcb--,de(),_e(F,ie)}function H(F,ie){ie.length===0&&ie.needDrain&&(ie.needDrain=!1,F.emit("drain"))}function X(F,ie){ie.bufferProcessing=!0;var ae=ie.bufferedRequest;if(F._writev&&ae&&ae.next){var de=ie.bufferedRequestCount,ve=new Array(de),ee=ie.corkedRequestsFree;ee.entry=ae;for(var se=0,K=!0;ae;)ve[se]=ae,ae.isBuf||(K=!1),ae=ae.next,se+=1;ve.allBuffers=K,z(F,ie,!0,ie.length,ve,"",ee.finish),ie.pendingcb++,ie.lastBufferedRequest=null,ee.next?(ie.corkedRequestsFree=ee.next,ee.next=null):ie.corkedRequestsFree=new a(ie),ie.bufferedRequestCount=0}else{for(;ae;){var I=ae.chunk,U=ae.encoding,oe=ae.callback,ge=ie.objectMode?1:I.length;if(z(F,ie,!1,ge,I,U,oe),ae=ae.next,ie.bufferedRequestCount--,ie.writing)break}ae===null&&(ie.lastBufferedRequest=null)}ie.bufferedRequest=ae,ie.bufferProcessing=!1}D.prototype._write=function(F,ie,ae){ae(new P("_write()"))},D.prototype._writev=null,D.prototype.end=function(F,ie,ae){var de=this._writableState;return typeof F=="function"?(ae=F,F=null,ie=null):typeof ie=="function"&&(ae=ie,ie=null),F!=null&&this.write(F,ie),de.corked&&(de.corked=1,this.uncork()),de.ending||xe(this,de,ae),this},Object.defineProperty(D.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Q(F){return F.ending&&F.length===0&&F.bufferedRequest===null&&!F.finished&&!F.writing}function ce(F,ie){F._final(function(ae){ie.pendingcb--,ae&&S(F,ae),ie.prefinished=!0,F.emit("prefinish"),_e(F,ie)})}function pe(F,ie){!ie.prefinished&&!ie.finalCalled&&(typeof F._final=="function"&&!ie.destroyed?(ie.pendingcb++,ie.finalCalled=!0,e.nextTick(ce,F,ie)):(ie.prefinished=!0,F.emit("prefinish")))}function _e(F,ie){var ae=Q(ie);if(ae&&(pe(F,ie),ie.pendingcb===0&&(ie.finished=!0,F.emit("finish"),ie.autoDestroy))){var de=F._readableState;(!de||de.autoDestroy&&de.endEmitted)&&F.destroy()}return ae}function xe(F,ie,ae){ie.ending=!0,_e(F,ie),ae&&(ie.finished?e.nextTick(ae):F.once("finish",ae)),ie.ended=!0,F.writable=!1}function Y(F,ie,ae){var de=F.entry;for(F.entry=null;de;){var ve=de.callback;ie.pendingcb--,ve(ae),de=de.next}ie.corkedRequestsFree.next=F}Object.defineProperty(D.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(ie){this._writableState&&(this._writableState.destroyed=ie)}}),D.prototype.destroy=p.destroy,D.prototype._undestroy=p.undestroy,D.prototype._destroy=function(F,ie){ie(F)}}).call(this)}).call(this,t("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":13,"./_stream_duplex":14,"./internal/streams/destroy":21,"./internal/streams/state":25,"./internal/streams/stream":26,_process:8,buffer:3,inherits:12,"util-deprecate":28}],19:[function(t,n,s){(function(e){(function(){var c;function a(g,_,u){return _ in g?Object.defineProperty(g,_,{value:u,enumerable:!0,configurable:!0,writable:!0}):g[_]=u,g}var i=t("./end-of-stream"),o=Symbol("lastResolve"),l=Symbol("lastReject"),r=Symbol("error"),d=Symbol("ended"),h=Symbol("lastPromise"),v=Symbol("handlePromise"),p=Symbol("stream");function m(g,_){return{value:g,done:_}}function A(g){var _=g[o];if(_!==null){var u=g[p].read();u!==null&&(g[h]=null,g[o]=null,g[l]=null,_(m(u,!1)))}}function y(g){e.nextTick(A,g)}function x(g,_){return function(u,b){g.then(function(){if(_[d]){u(m(void 0,!0));return}_[v](u,b)},b)}}var P=Object.getPrototypeOf(function(){}),L=Object.setPrototypeOf((c={get stream(){return this[p]},next:function(){var _=this,u=this[r];if(u!==null)return Promise.reject(u);if(this[d])return Promise.resolve(m(void 0,!0));if(this[p].destroyed)return new Promise(function(R,C){e.nextTick(function(){_[r]?C(_[r]):R(m(void 0,!0))})});var b=this[h],S;if(b)S=new Promise(x(b,this));else{var M=this[p].read();if(M!==null)return Promise.resolve(m(M,!1));S=new Promise(this[v])}return this[h]=S,S}},a(c,Symbol.asyncIterator,function(){return this}),a(c,"return",function(){var _=this;return new Promise(function(u,b){_[p].destroy(null,function(S){if(S){b(S);return}u(m(void 0,!0))})})}),c),P),T=function(_){var u,b=Object.create(L,(u={},a(u,p,{value:_,writable:!0}),a(u,o,{value:null,writable:!0}),a(u,l,{value:null,writable:!0}),a(u,r,{value:null,writable:!0}),a(u,d,{value:_._readableState.endEmitted,writable:!0}),a(u,v,{value:function(M,R){var C=b[p].read();C?(b[h]=null,b[o]=null,b[l]=null,M(m(C,!1))):(b[o]=M,b[l]=R)},writable:!0}),u));return b[h]=null,i(_,function(S){if(S&&S.code!=="ERR_STREAM_PREMATURE_CLOSE"){var M=b[l];M!==null&&(b[h]=null,b[o]=null,b[l]=null,M(S)),b[r]=S;return}var R=b[o];R!==null&&(b[h]=null,b[o]=null,b[l]=null,R(m(void 0,!0))),b[d]=!0}),_.on("readable",y.bind(null,b)),b};n.exports=T}).call(this)}).call(this,t("_process"))},{"./end-of-stream":22,_process:8}],20:[function(t,n,s){function e(A,y){var x=Object.keys(A);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(A);y&&(P=P.filter(function(L){return Object.getOwnPropertyDescriptor(A,L).enumerable})),x.push.apply(x,P)}return x}function c(A){for(var y=1;y<arguments.length;y++){var x=arguments[y]!=null?arguments[y]:{};y%2?e(Object(x),!0).forEach(function(P){a(A,P,x[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(x)):e(Object(x)).forEach(function(P){Object.defineProperty(A,P,Object.getOwnPropertyDescriptor(x,P))})}return A}function a(A,y,x){return y in A?Object.defineProperty(A,y,{value:x,enumerable:!0,configurable:!0,writable:!0}):A[y]=x,A}function i(A,y){if(!(A instanceof y))throw new TypeError("Cannot call a class as a function")}function o(A,y){for(var x=0;x<y.length;x++){var P=y[x];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(A,P.key,P)}}function l(A,y,x){return y&&o(A.prototype,y),A}var r=t("buffer"),d=r.Buffer,h=t("util"),v=h.inspect,p=v&&v.custom||"inspect";function m(A,y,x){d.prototype.copy.call(A,y,x)}n.exports=function(){function A(){i(this,A),this.head=null,this.tail=null,this.length=0}return l(A,[{key:"push",value:function(x){var P={data:x,next:null};this.length>0?this.tail.next=P:this.head=P,this.tail=P,++this.length}},{key:"unshift",value:function(x){var P={data:x,next:this.head};this.length===0&&(this.tail=P),this.head=P,++this.length}},{key:"shift",value:function(){if(this.length!==0){var x=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,x}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(x){if(this.length===0)return"";for(var P=this.head,L=""+P.data;P=P.next;)L+=x+P.data;return L}},{key:"concat",value:function(x){if(this.length===0)return d.alloc(0);for(var P=d.allocUnsafe(x>>>0),L=this.head,T=0;L;)m(L.data,P,T),T+=L.data.length,L=L.next;return P}},{key:"consume",value:function(x,P){var L;return x<this.head.data.length?(L=this.head.data.slice(0,x),this.head.data=this.head.data.slice(x)):x===this.head.data.length?L=this.shift():L=P?this._getString(x):this._getBuffer(x),L}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(x){var P=this.head,L=1,T=P.data;for(x-=T.length;P=P.next;){var g=P.data,_=x>g.length?g.length:x;if(_===g.length?T+=g:T+=g.slice(0,x),x-=_,x===0){_===g.length?(++L,P.next?this.head=P.next:this.head=this.tail=null):(this.head=P,P.data=g.slice(_));break}++L}return this.length-=L,T}},{key:"_getBuffer",value:function(x){var P=d.allocUnsafe(x),L=this.head,T=1;for(L.data.copy(P),x-=L.data.length;L=L.next;){var g=L.data,_=x>g.length?g.length:x;if(g.copy(P,P.length-x,0,_),x-=_,x===0){_===g.length?(++T,L.next?this.head=L.next:this.head=this.tail=null):(this.head=L,L.data=g.slice(_));break}++T}return this.length-=T,P}},{key:p,value:function(x,P){return v(this,c({},P,{depth:0,customInspect:!1}))}}]),A}()},{buffer:3,util:2}],21:[function(t,n,s){(function(e){(function(){function c(d,h){var v=this,p=this._readableState&&this._readableState.destroyed,m=this._writableState&&this._writableState.destroyed;return p||m?(h?h(d):d&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(l,this,d)):e.nextTick(l,this,d)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(d||null,function(A){!h&&A?v._writableState?v._writableState.errorEmitted?e.nextTick(i,v):(v._writableState.errorEmitted=!0,e.nextTick(a,v,A)):e.nextTick(a,v,A):h?(e.nextTick(i,v),h(A)):e.nextTick(i,v)}),this)}function a(d,h){l(d,h),i(d)}function i(d){d._writableState&&!d._writableState.emitClose||d._readableState&&!d._readableState.emitClose||d.emit("close")}function o(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function l(d,h){d.emit("error",h)}function r(d,h){var v=d._readableState,p=d._writableState;v&&v.autoDestroy||p&&p.autoDestroy?d.destroy(h):d.emit("error",h)}n.exports={destroy:c,undestroy:o,errorOrDestroy:r}}).call(this)}).call(this,t("_process"))},{_process:8}],22:[function(t,n,s){var e=t("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function c(l){var r=!1;return function(){if(!r){r=!0;for(var d=arguments.length,h=new Array(d),v=0;v<d;v++)h[v]=arguments[v];l.apply(this,h)}}}function a(){}function i(l){return l.setHeader&&typeof l.abort=="function"}function o(l,r,d){if(typeof r=="function")return o(l,null,r);r||(r={}),d=c(d||a);var h=r.readable||r.readable!==!1&&l.readable,v=r.writable||r.writable!==!1&&l.writable,p=function(){l.writable||A()},m=l._writableState&&l._writableState.finished,A=function(){v=!1,m=!0,h||d.call(l)},y=l._readableState&&l._readableState.endEmitted,x=function(){h=!1,y=!0,v||d.call(l)},P=function(_){d.call(l,_)},L=function(){var _;if(h&&!y)return(!l._readableState||!l._readableState.ended)&&(_=new e),d.call(l,_);if(v&&!m)return(!l._writableState||!l._writableState.ended)&&(_=new e),d.call(l,_)},T=function(){l.req.on("finish",A)};return i(l)?(l.on("complete",A),l.on("abort",L),l.req?T():l.on("request",T)):v&&!l._writableState&&(l.on("end",p),l.on("close",p)),l.on("end",x),l.on("finish",A),r.error!==!1&&l.on("error",P),l.on("close",L),function(){l.removeListener("complete",A),l.removeListener("abort",L),l.removeListener("request",T),l.req&&l.req.removeListener("finish",A),l.removeListener("end",p),l.removeListener("close",p),l.removeListener("finish",A),l.removeListener("end",x),l.removeListener("error",P),l.removeListener("close",L)}}n.exports=o},{"../../../errors":13}],23:[function(t,n,s){n.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],24:[function(t,n,s){var e;function c(A){var y=!1;return function(){y||(y=!0,A.apply(void 0,arguments))}}var a=t("../../../errors").codes,i=a.ERR_MISSING_ARGS,o=a.ERR_STREAM_DESTROYED;function l(A){if(A)throw A}function r(A){return A.setHeader&&typeof A.abort=="function"}function d(A,y,x,P){P=c(P);var L=!1;A.on("close",function(){L=!0}),e===void 0&&(e=t("./end-of-stream")),e(A,{readable:y,writable:x},function(g){if(g)return P(g);L=!0,P()});var T=!1;return function(g){if(!L&&!T){if(T=!0,r(A))return A.abort();if(typeof A.destroy=="function")return A.destroy();P(g||new o("pipe"))}}}function h(A){A()}function v(A,y){return A.pipe(y)}function p(A){return!A.length||typeof A[A.length-1]!="function"?l:A.pop()}function m(){for(var A=arguments.length,y=new Array(A),x=0;x<A;x++)y[x]=arguments[x];var P=p(y);if(Array.isArray(y[0])&&(y=y[0]),y.length<2)throw new i("streams");var L,T=y.map(function(g,_){var u=_<y.length-1,b=_>0;return d(g,u,b,function(S){L||(L=S),S&&T.forEach(h),!u&&(T.forEach(h),P(L))})});return y.reduce(v)}n.exports=m},{"../../../errors":13,"./end-of-stream":22}],25:[function(t,n,s){var e=t("../../../errors").codes.ERR_INVALID_OPT_VALUE;function c(i,o,l){return i.highWaterMark!=null?i.highWaterMark:o?i[l]:null}function a(i,o,l,r){var d=c(o,r,l);if(d!=null){if(!(isFinite(d)&&Math.floor(d)===d)||d<0){var h=r?l:"highWaterMark";throw new e(h,d)}return Math.floor(d)}return i.objectMode?16:16*1024}n.exports={getHighWaterMark:a}},{"../../../errors":13}],26:[function(t,n,s){n.exports=t("events").EventEmitter},{events:5}],27:[function(t,n,s){var e=t("safe-buffer").Buffer,c=e.isEncoding||function(T){switch(T=""+T,T&&T.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(T){if(!T)return"utf8";for(var g;;)switch(T){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return T;default:if(g)return;T=(""+T).toLowerCase(),g=!0}}function i(T){var g=a(T);if(typeof g!="string"&&(e.isEncoding===c||!c(T)))throw new Error("Unknown encoding: "+T);return g||T}s.StringDecoder=o;function o(T){this.encoding=i(T);var g;switch(this.encoding){case"utf16le":this.text=m,this.end=A,g=4;break;case"utf8":this.fillLast=h,g=4;break;case"base64":this.text=y,this.end=x,g=3;break;default:this.write=P,this.end=L;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(g)}o.prototype.write=function(T){if(T.length===0)return"";var g,_;if(this.lastNeed){if(g=this.fillLast(T),g===void 0)return"";_=this.lastNeed,this.lastNeed=0}else _=0;return _<T.length?g?g+this.text(T,_):this.text(T,_):g||""},o.prototype.end=p,o.prototype.text=v,o.prototype.fillLast=function(T){if(this.lastNeed<=T.length)return T.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);T.copy(this.lastChar,this.lastTotal-this.lastNeed,0,T.length),this.lastNeed-=T.length};function l(T){return T<=127?0:T>>5===6?2:T>>4===14?3:T>>3===30?4:T>>6===2?-1:-2}function r(T,g,_){var u=g.length-1;if(u<_)return 0;var b=l(g[u]);return b>=0?(b>0&&(T.lastNeed=b-1),b):--u<_||b===-2?0:(b=l(g[u]),b>=0?(b>0&&(T.lastNeed=b-2),b):--u<_||b===-2?0:(b=l(g[u]),b>=0?(b>0&&(b===2?b=0:T.lastNeed=b-3),b):0))}function d(T,g,_){if((g[0]&192)!==128)return T.lastNeed=0,"ï¿½";if(T.lastNeed>1&&g.length>1){if((g[1]&192)!==128)return T.lastNeed=1,"ï¿½";if(T.lastNeed>2&&g.length>2&&(g[2]&192)!==128)return T.lastNeed=2,"ï¿½"}}function h(T){var g=this.lastTotal-this.lastNeed,_=d(this,T);if(_!==void 0)return _;if(this.lastNeed<=T.length)return T.copy(this.lastChar,g,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);T.copy(this.lastChar,g,0,T.length),this.lastNeed-=T.length}function v(T,g){var _=r(this,T,g);if(!this.lastNeed)return T.toString("utf8",g);this.lastTotal=_;var u=T.length-(_-this.lastNeed);return T.copy(this.lastChar,0,u),T.toString("utf8",g,u)}function p(T){var g=T&&T.length?this.write(T):"";return this.lastNeed?g+"ï¿½":g}function m(T,g){if((T.length-g)%2===0){var _=T.toString("utf16le",g);if(_){var u=_.charCodeAt(_.length-1);if(u>=55296&&u<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=T[T.length-2],this.lastChar[1]=T[T.length-1],_.slice(0,-1)}return _}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=T[T.length-1],T.toString("utf16le",g,T.length-1)}function A(T){var g=T&&T.length?this.write(T):"";if(this.lastNeed){var _=this.lastTotal-this.lastNeed;return g+this.lastChar.toString("utf16le",0,_)}return g}function y(T,g){var _=(T.length-g)%3;return _===0?T.toString("base64",g):(this.lastNeed=3-_,this.lastTotal=3,_===1?this.lastChar[0]=T[T.length-1]:(this.lastChar[0]=T[T.length-2],this.lastChar[1]=T[T.length-1]),T.toString("base64",g,T.length-_))}function x(T){var g=T&&T.length?this.write(T):"";return this.lastNeed?g+this.lastChar.toString("base64",0,3-this.lastNeed):g}function P(T){return T.toString(this.encoding)}function L(T){return T&&T.length?this.write(T):""}},{"safe-buffer":9}],28:[function(t,n,s){(function(e){(function(){n.exports=c;function c(i,o){if(a("noDeprecation"))return i;var l=!1;function r(){if(!l){if(a("throwDeprecation"))throw new Error(o);a("traceDeprecation")?console.trace(o):console.warn(o),l=!0}return i.apply(this,arguments)}return r}function a(i){try{if(!e.localStorage)return!1}catch{return!1}var o=e.localStorage[i];return o==null?!1:String(o).toLowerCase()==="true"}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],29:[function(t,n,s){n.exports={isArray:function(e){return Array.isArray?Array.isArray(e):Object.prototype.toString.call(e)==="[object Array]"}}},{}],30:[function(t,n,s){var e=t("./xml2js"),c=t("./xml2json"),a=t("./js2xml"),i=t("./json2xml");n.exports={xml2js:e,xml2json:c,js2xml:a,json2xml:i}},{"./js2xml":31,"./json2xml":32,"./xml2js":34,"./xml2json":35}],31:[function(t,n,s){var e=t("./options-helper"),c=t("./array-helper").isArray,a,i;function o(_){var u=e.copyOptions(_);return e.ensureFlagExists("ignoreDeclaration",u),e.ensureFlagExists("ignoreInstruction",u),e.ensureFlagExists("ignoreAttributes",u),e.ensureFlagExists("ignoreText",u),e.ensureFlagExists("ignoreComment",u),e.ensureFlagExists("ignoreCdata",u),e.ensureFlagExists("ignoreDoctype",u),e.ensureFlagExists("compact",u),e.ensureFlagExists("indentText",u),e.ensureFlagExists("indentCdata",u),e.ensureFlagExists("indentAttributes",u),e.ensureFlagExists("indentInstruction",u),e.ensureFlagExists("fullTagEmptyElement",u),e.ensureFlagExists("noQuotesForNativeAttributes",u),e.ensureSpacesExists(u),typeof u.spaces=="number"&&(u.spaces=Array(u.spaces+1).join(" ")),e.ensureKeyExists("declaration",u),e.ensureKeyExists("instruction",u),e.ensureKeyExists("attributes",u),e.ensureKeyExists("text",u),e.ensureKeyExists("comment",u),e.ensureKeyExists("cdata",u),e.ensureKeyExists("doctype",u),e.ensureKeyExists("type",u),e.ensureKeyExists("name",u),e.ensureKeyExists("elements",u),e.checkFnExists("doctype",u),e.checkFnExists("instruction",u),e.checkFnExists("cdata",u),e.checkFnExists("comment",u),e.checkFnExists("text",u),e.checkFnExists("instructionName",u),e.checkFnExists("elementName",u),e.checkFnExists("attributeName",u),e.checkFnExists("attributeValue",u),e.checkFnExists("attributes",u),e.checkFnExists("fullTagEmptyElement",u),u}function l(_,u,b){return(!b&&_.spaces?`
`:"")+Array(u+1).join(_.spaces)}function r(_,u,b){if(u.ignoreAttributes)return"";"attributesFn"in u&&(_=u.attributesFn(_,i,a));var S,M,R,C,D=[];for(S in _)_.hasOwnProperty(S)&&_[S]!==null&&_[S]!==void 0&&(C=u.noQuotesForNativeAttributes&&typeof _[S]!="string"?"":'"',M=""+_[S],M=M.replace(/"/g,"&quot;"),R="attributeNameFn"in u?u.attributeNameFn(S,M,i,a):S,D.push(u.spaces&&u.indentAttributes?l(u,b+1,!1):" "),D.push(R+"="+C+("attributeValueFn"in u?u.attributeValueFn(M,S,i,a):M)+C));return _&&Object.keys(_).length&&u.spaces&&u.indentAttributes&&D.push(l(u,b,!1)),D.join("")}function d(_,u,b){return a=_,i="xml",u.ignoreDeclaration?"":"<?xml"+r(_[u.attributesKey],u,b)+"?>"}function h(_,u,b){if(u.ignoreInstruction)return"";var S;for(S in _)if(_.hasOwnProperty(S))break;var M="instructionNameFn"in u?u.instructionNameFn(S,_[S],i,a):S;if(typeof _[S]=="object")return a=_,i=M,"<?"+M+r(_[S][u.attributesKey],u,b)+"?>";var R=_[S]?_[S]:"";return"instructionFn"in u&&(R=u.instructionFn(R,S,i,a)),"<?"+M+(R?" "+R:"")+"?>"}function v(_,u){return u.ignoreComment?"":"<!--"+("commentFn"in u?u.commentFn(_,i,a):_)+"-->"}function p(_,u){return u.ignoreCdata?"":"<![CDATA["+("cdataFn"in u?u.cdataFn(_,i,a):_.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function m(_,u){return u.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in u?u.doctypeFn(_,i,a):_)+">"}function A(_,u){return u.ignoreText?"":(_=""+_,_=_.replace(/&amp;/g,"&"),_=_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in u?u.textFn(_,i,a):_)}function y(_,u){var b;if(_.elements&&_.elements.length)for(b=0;b<_.elements.length;++b)switch(_.elements[b][u.typeKey]){case"text":if(u.indentText)return!0;break;case"cdata":if(u.indentCdata)return!0;break;case"instruction":if(u.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function x(_,u,b){a=_,i=_.name;var S=[],M="elementNameFn"in u?u.elementNameFn(_.name,_):_.name;S.push("<"+M),_[u.attributesKey]&&S.push(r(_[u.attributesKey],u,b));var R=_[u.elementsKey]&&_[u.elementsKey].length||_[u.attributesKey]&&_[u.attributesKey]["xml:space"]==="preserve";return R||("fullTagEmptyElementFn"in u?R=u.fullTagEmptyElementFn(_.name,_):R=u.fullTagEmptyElement),R?(S.push(">"),_[u.elementsKey]&&_[u.elementsKey].length&&(S.push(P(_[u.elementsKey],u,b+1)),a=_,i=_.name),S.push(u.spaces&&y(_,u)?`
`+Array(b+1).join(u.spaces):""),S.push("</"+M+">")):S.push("/>"),S.join("")}function P(_,u,b,S){return _.reduce(function(M,R){var C=l(u,b,S&&!M);switch(R.type){case"element":return M+C+x(R,u,b);case"comment":return M+C+v(R[u.commentKey],u);case"doctype":return M+C+m(R[u.doctypeKey],u);case"cdata":return M+(u.indentCdata?C:"")+p(R[u.cdataKey],u);case"text":return M+(u.indentText?C:"")+A(R[u.textKey],u);case"instruction":var D={};return D[R[u.nameKey]]=R[u.attributesKey]?R:R[u.instructionKey],M+(u.indentInstruction?C:"")+h(D,u,b)}},"")}function L(_,u,b){var S;for(S in _)if(_.hasOwnProperty(S))switch(S){case u.parentKey:case u.attributesKey:break;case u.textKey:if(u.indentText||b)return!0;break;case u.cdataKey:if(u.indentCdata||b)return!0;break;case u.instructionKey:if(u.indentInstruction||b)return!0;break;case u.doctypeKey:case u.commentKey:return!0;default:return!0}return!1}function T(_,u,b,S,M){a=_,i=u;var R="elementNameFn"in b?b.elementNameFn(u,_):u;if(typeof _>"u"||_===null||_==="")return"fullTagEmptyElementFn"in b&&b.fullTagEmptyElementFn(u,_)||b.fullTagEmptyElement?"<"+R+"></"+R+">":"<"+R+"/>";var C=[];if(u){if(C.push("<"+R),typeof _!="object")return C.push(">"+A(_,b)+"</"+R+">"),C.join("");_[b.attributesKey]&&C.push(r(_[b.attributesKey],b,S));var D=L(_,b,!0)||_[b.attributesKey]&&_[b.attributesKey]["xml:space"]==="preserve";if(D||("fullTagEmptyElementFn"in b?D=b.fullTagEmptyElementFn(u,_):D=b.fullTagEmptyElement),D)C.push(">");else return C.push("/>"),C.join("")}return C.push(g(_,b,S+1,!1)),a=_,i=u,u&&C.push((M?l(b,S,!1):"")+"</"+R+">"),C.join("")}function g(_,u,b,S){var M,R,C,D=[];for(R in _)if(_.hasOwnProperty(R))for(C=c(_[R])?_[R]:[_[R]],M=0;M<C.length;++M){switch(R){case u.declarationKey:D.push(d(C[M],u,b));break;case u.instructionKey:D.push((u.indentInstruction?l(u,b,S):"")+h(C[M],u,b));break;case u.attributesKey:case u.parentKey:break;case u.textKey:D.push((u.indentText?l(u,b,S):"")+A(C[M],u));break;case u.cdataKey:D.push((u.indentCdata?l(u,b,S):"")+p(C[M],u));break;case u.doctypeKey:D.push(l(u,b,S)+m(C[M],u));break;case u.commentKey:D.push(l(u,b,S)+v(C[M],u));break;default:D.push(l(u,b,S)+T(C[M],R,u,b,L(C[M],u)))}S=S&&!D.length}return D.join("")}n.exports=function(_,u){u=o(u);var b=[];return a=_,i="_root_",u.compact?b.push(g(_,u,0,!0)):(_[u.declarationKey]&&b.push(d(_[u.declarationKey],u,0)),_[u.elementsKey]&&_[u.elementsKey].length&&b.push(P(_[u.elementsKey],u,0,!b.length))),b.join("")}},{"./array-helper":29,"./options-helper":33}],32:[function(t,n,s){(function(e){(function(){var c=t("./js2xml.js");n.exports=function(a,i){a instanceof e&&(a=a.toString());var o=null;if(typeof a=="string")try{o=JSON.parse(a)}catch{throw new Error("The JSON structure is invalid")}else o=a;return c(o,i)}}).call(this)}).call(this,t("buffer").Buffer)},{"./js2xml.js":31,buffer:3}],33:[function(t,n,s){var e=t("./array-helper").isArray;n.exports={copyOptions:function(c){var a,i={};for(a in c)c.hasOwnProperty(a)&&(i[a]=c[a]);return i},ensureFlagExists:function(c,a){(!(c in a)||typeof a[c]!="boolean")&&(a[c]=!1)},ensureSpacesExists:function(c){(!("spaces"in c)||typeof c.spaces!="number"&&typeof c.spaces!="string")&&(c.spaces=0)},ensureAlwaysArrayExists:function(c){(!("alwaysArray"in c)||typeof c.alwaysArray!="boolean"&&!e(c.alwaysArray))&&(c.alwaysArray=!1)},ensureKeyExists:function(c,a){(!(c+"Key"in a)||typeof a[c+"Key"]!="string")&&(a[c+"Key"]=a.compact?"_"+c:c)},checkFnExists:function(c,a){return c+"Fn"in a}}},{"./array-helper":29}],34:[function(t,n,s){var e=t("sax"),c=t("./options-helper"),a=t("./array-helper").isArray,i,o;function l(T){return i=c.copyOptions(T),c.ensureFlagExists("ignoreDeclaration",i),c.ensureFlagExists("ignoreInstruction",i),c.ensureFlagExists("ignoreAttributes",i),c.ensureFlagExists("ignoreText",i),c.ensureFlagExists("ignoreComment",i),c.ensureFlagExists("ignoreCdata",i),c.ensureFlagExists("ignoreDoctype",i),c.ensureFlagExists("compact",i),c.ensureFlagExists("alwaysChildren",i),c.ensureFlagExists("addParent",i),c.ensureFlagExists("trim",i),c.ensureFlagExists("nativeType",i),c.ensureFlagExists("nativeTypeAttributes",i),c.ensureFlagExists("sanitize",i),c.ensureFlagExists("instructionHasAttributes",i),c.ensureFlagExists("captureSpacesBetweenElements",i),c.ensureAlwaysArrayExists(i),c.ensureKeyExists("declaration",i),c.ensureKeyExists("instruction",i),c.ensureKeyExists("attributes",i),c.ensureKeyExists("text",i),c.ensureKeyExists("comment",i),c.ensureKeyExists("cdata",i),c.ensureKeyExists("doctype",i),c.ensureKeyExists("type",i),c.ensureKeyExists("name",i),c.ensureKeyExists("elements",i),c.ensureKeyExists("parent",i),c.checkFnExists("doctype",i),c.checkFnExists("instruction",i),c.checkFnExists("cdata",i),c.checkFnExists("comment",i),c.checkFnExists("text",i),c.checkFnExists("instructionName",i),c.checkFnExists("elementName",i),c.checkFnExists("attributeName",i),c.checkFnExists("attributeValue",i),c.checkFnExists("attributes",i),i}function r(T){var g=Number(T);if(!isNaN(g))return g;var _=T.toLowerCase();return _==="true"?!0:_==="false"?!1:T}function d(T,g){var _;if(i.compact){if(!o[i[T+"Key"]]&&(a(i.alwaysArray)?i.alwaysArray.indexOf(i[T+"Key"])!==-1:i.alwaysArray)&&(o[i[T+"Key"]]=[]),o[i[T+"Key"]]&&!a(o[i[T+"Key"]])&&(o[i[T+"Key"]]=[o[i[T+"Key"]]]),T+"Fn"in i&&typeof g=="string"&&(g=i[T+"Fn"](g,o)),T==="instruction"&&("instructionFn"in i||"instructionNameFn"in i)){for(_ in g)if(g.hasOwnProperty(_))if("instructionFn"in i)g[_]=i.instructionFn(g[_],_,o);else{var u=g[_];delete g[_],g[i.instructionNameFn(_,u,o)]=u}}a(o[i[T+"Key"]])?o[i[T+"Key"]].push(g):o[i[T+"Key"]]=g}else{o[i.elementsKey]||(o[i.elementsKey]=[]);var b={};if(b[i.typeKey]=T,T==="instruction"){for(_ in g)if(g.hasOwnProperty(_))break;b[i.nameKey]="instructionNameFn"in i?i.instructionNameFn(_,g,o):_,i.instructionHasAttributes?(b[i.attributesKey]=g[_][i.attributesKey],"instructionFn"in i&&(b[i.attributesKey]=i.instructionFn(b[i.attributesKey],_,o))):("instructionFn"in i&&(g[_]=i.instructionFn(g[_],_,o)),b[i.instructionKey]=g[_])}else T+"Fn"in i&&(g=i[T+"Fn"](g,o)),b[i[T+"Key"]]=g;i.addParent&&(b[i.parentKey]=o),o[i.elementsKey].push(b)}}function h(T){if("attributesFn"in i&&T&&(T=i.attributesFn(T,o)),(i.trim||"attributeValueFn"in i||"attributeNameFn"in i||i.nativeTypeAttributes)&&T){var g;for(g in T)if(T.hasOwnProperty(g)&&(i.trim&&(T[g]=T[g].trim()),i.nativeTypeAttributes&&(T[g]=r(T[g])),"attributeValueFn"in i&&(T[g]=i.attributeValueFn(T[g],g,o)),"attributeNameFn"in i)){var _=T[g];delete T[g],T[i.attributeNameFn(g,T[g],o)]=_}}return T}function v(T){var g={};if(T.body&&(T.name.toLowerCase()==="xml"||i.instructionHasAttributes)){for(var _=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,u;(u=_.exec(T.body))!==null;)g[u[1]]=u[2]||u[3]||u[4];g=h(g)}if(T.name.toLowerCase()==="xml"){if(i.ignoreDeclaration)return;o[i.declarationKey]={},Object.keys(g).length&&(o[i.declarationKey][i.attributesKey]=g),i.addParent&&(o[i.declarationKey][i.parentKey]=o)}else{if(i.ignoreInstruction)return;i.trim&&(T.body=T.body.trim());var b={};i.instructionHasAttributes&&Object.keys(g).length?(b[T.name]={},b[T.name][i.attributesKey]=g):b[T.name]=T.body,d("instruction",b)}}function p(T,g){var _;if(typeof T=="object"&&(g=T.attributes,T=T.name),g=h(g),"elementNameFn"in i&&(T=i.elementNameFn(T,o)),i.compact){if(_={},!i.ignoreAttributes&&g&&Object.keys(g).length){_[i.attributesKey]={};var u;for(u in g)g.hasOwnProperty(u)&&(_[i.attributesKey][u]=g[u])}!(T in o)&&(a(i.alwaysArray)?i.alwaysArray.indexOf(T)!==-1:i.alwaysArray)&&(o[T]=[]),o[T]&&!a(o[T])&&(o[T]=[o[T]]),a(o[T])?o[T].push(_):o[T]=_}else o[i.elementsKey]||(o[i.elementsKey]=[]),_={},_[i.typeKey]="element",_[i.nameKey]=T,!i.ignoreAttributes&&g&&Object.keys(g).length&&(_[i.attributesKey]=g),i.alwaysChildren&&(_[i.elementsKey]=[]),o[i.elementsKey].push(_);_[i.parentKey]=o,o=_}function m(T){i.ignoreText||!T.trim()&&!i.captureSpacesBetweenElements||(i.trim&&(T=T.trim()),i.nativeType&&(T=r(T)),i.sanitize&&(T=T.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),d("text",T))}function A(T){i.ignoreComment||(i.trim&&(T=T.trim()),d("comment",T))}function y(T){var g=o[i.parentKey];i.addParent||delete o[i.parentKey],o=g}function x(T){i.ignoreCdata||(i.trim&&(T=T.trim()),d("cdata",T))}function P(T){i.ignoreDoctype||(T=T.replace(/^ /,""),i.trim&&(T=T.trim()),d("doctype",T))}function L(T){T.note=T}n.exports=function(T,g){var _=e.parser(!0,{}),u={};if(o=u,i=l(g),_.opt={strictEntities:!0},_.onopentag=p,_.ontext=m,_.oncomment=A,_.onclosetag=y,_.onerror=L,_.oncdata=x,_.ondoctype=P,_.onprocessinginstruction=v,_.write(T).close(),u[i.elementsKey]){var b=u[i.elementsKey];delete u[i.elementsKey],u[i.elementsKey]=b,delete u.text}return u}},{"./array-helper":29,"./options-helper":33,sax:10}],35:[function(t,n,s){var e=t("./options-helper"),c=t("./xml2js");function a(i){var o=e.copyOptions(i);return e.ensureSpacesExists(o),o}n.exports=function(i,o){var l,r,d,h;return l=a(o),r=c(i,l),h="compact"in l&&l.compact?"_parent":"parent","addParent"in l&&l.addParent?d=JSON.stringify(r,function(v,p){return v===h?"_":p},l.spaces):d=JSON.stringify(r,null,l.spaces),d.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}},{"./options-helper":33,"./xml2js":34}],36:[function(t,n,s){var e,c;c=function(a,i,o){var l,r;return l=i*Math.min(o,1-o),r=function(d,h=(d+a*12)%12){return o-l*Math.max(Math.min(h-3,9-h,1),-1)},[r(0),r(8),r(4)].map(function(d){return d})},e=["red","green","blue","hue","saturation","lightness","value","cyan","magenta","yellow","key","alpha","x","y","z","l","a","b"],n.exports=class{constructor(i){var o,l,r,d,h,v,p,m;for({red:this.red,green:this.green,blue:this.blue,hue:this.hue,saturation:this.saturation,value:this.value,lightness:this.lightness,cyan:l,magenta:v,yellow:m,key:d,alpha:this.alpha,name:this.name}=i,r=0,h=e.length;r<h;r++)if(o=e[r],i[o]!=null){if(!isFinite(i[o])||typeof i[o]!="number")throw new TypeError(`Color component option ${o} is not a finite number: ${JSON.stringify(i[o])}`);if(i[o]<0||i[o]>1)throw new TypeError(`Color component option ${o} outside range of [0,1]: ${i[o]}`)}if(p=function(){throw new TypeError(`Color constructor must be called with {red,green,blue} or {hue,saturation,value} or {hue,saturation,lightness} or {cyan,magenta,yellow,key} or {x,y,z} or {l,a,b}, ${function(){try{return`got ${JSON.stringify(i)}`}catch{return"got something that couldn't be displayed with JSON.stringify for this error message"}}()}`)},!(this.red!=null&&this.green!=null&&this.blue!=null))if(this.hue!=null&&this.saturation!=null){if(this.value!=null)this.lightness=(2-this.saturation)*this.value/2,this.saturation=this.saturation*this.value/(this.lightness<.5?this.lightness*2:2-this.lightness*2),isNaN(this.saturation)&&(this.saturation=0);else if(this.lightness==null){if(i.brightness!=null)throw new TypeError("{hue, saturation, brightness} not supported. Use {hue, saturation, value} instead for an equivalent color space");p()}[this.red,this.green,this.blue]=c(this.hue,this.saturation,this.lightness)}else{if(l!=null&&v!=null&&m!=null&&d!=null)throw new Error("CMYK color space is not currently supported");if(i.l!=null&&i.a!=null&&i.b!=null)throw new Error("L*a*b* color space is not currently supported");if(i.x!=null&&i.y!=null&&i.z!=null)throw new Error("XYZ color space is not currently supported");p()}}toString(){if(this.hue!=null)return this.alpha!=null?`hsla(${this.hue*360}, ${this.saturation*100}%, ${this.lightness*100}%, ${this.alpha})`:`hsl(${this.hue*360}, ${this.saturation*100}%, ${this.lightness*100}%)`;if(this.red!=null)return this.alpha!=null?`rgba(${this.red*255}, ${this.green*255}, ${this.blue*255}, ${this.alpha})`:`rgb(${this.red*255}, ${this.green*255}, ${this.blue*255})`}static is(i,o,l=1e-4){var r,d;return Math.abs(i.red-o.red)<l&&Math.abs(i.green-o.green)<l&&Math.abs(i.blue-o.blue)<l&&Math.abs(((r=i.alpha)!=null?r:1)-((d=o.alpha)!=null?d:1))<l}}},{}],37:[function(t,n,s){var e,c;e=t("./Color"),c=["r","g","b","h","s","l","v","x","y","z","a","b","c","m","y","k","red","green","blue","hue","saturation","lightness","value","cyan","magenta","yellow","key","alpha"],n.exports=class extends Array{constructor(...i){super(...i),this.name=void 0,this.description=void 0,this.numberOfColumns=void 0,this.geometrySpecifiedByFile=void 0}add(i){var o,l,r,d;for(l=0,r=c.length;l<r;l++)if(o=c[l],i[o]!=null){if(!isFinite(i[o])||typeof i[o]!="number")throw new TypeError(`palette.add() component option ${o} is not a finite number: ${JSON.stringify(i[o])}`);if(i[o]<0||i[o]>1)throw new TypeError(`palette.add() component option ${o} outside range of [0,1]: ${i[o]}`)}return d=i instanceof e?i:new e(i),this.push(d)}}},{"./Color":36}],38:[function(t,n,s){var e,c,a,i,o;o=t("jdataview"),c=t("../Palette"),e=2**16-1,a=Object.freeze({RGB:0,HSB:1,CMYK:2,PANTONE:3,FOCOLTONE:4,TRUMATCH:5,TOYO:6,LAB:7,GRAYSCALE:8,WIDE_CMYK:9,HKS:10,DIC:11,TOTAL_INK:12,MONITOR_RGB:13,DUOTONE:14,OPACITY:15,WEB:16,GRAY_FLOAT:17,RGB_FLOAT:18,OPACITY_FLOAT:19,0:"RGB",1:"HSB",2:"CMYK",3:"PANTONE",4:"FOCOLTONE",5:"TRUMATCH",6:"TOYO",7:"LAB",8:"GRAYSCALE",9:"WIDE_CMYK",10:"HKS",11:"DIC",12:"TOTAL_INK",13:"MONITOR_RGB",14:"DUOTONE",15:"OPACITY",16:"WEB",17:"GRAY_FLOAT",18:"RGB_FLOAT",19:"OPACITY_FLOAT"}),i=function(l,r,d){var h,v,p;for(d&&(r-=1),p="",h=0,v=r;0<=v?h<v:h>v;0<=v?h++:h--)p+=String.fromCharCode(l.getUint16());return d&&l.getUint16(),p},n.exports.read_adobe_color_swatch=function({data:l}){var r,d,h,v,p,m,A,y,x,P,L,T,g;if(x=new c,g=new o(l),P=function(_){var u,b,S,M,R,C,D;switch(u=g.getUint16(),M=g.getUint16()/e,R=g.getUint16()/e,C=g.getUint16()/e,D=g.getUint16()/e,_?(g.getUint16(),b=g.getUint16(),S=i(g,b,!0)):S=void 0,u){case a.RGB:return x.add({red:M,green:R,blue:C,name:S});case a.HSB:return x.add({hue:M,saturation:R,value:C,name:S});case a.CMYK:case a.WIDE_CMYK:return x.add({cyan:M,magenta:R,yellow:C,key:D,name:S});case a.LAB:return x.add({l:M,a:R,b:C,name:S});case a.GRAYSCALE:return x.add({red:M,green:M,blue:M,name:S})}},r=g.getUint16(),y=g.getUint16(),r!==1)throw new Error("Not an Adobe Color Swatch file");if(p=4,h=p+y*(5*2),g.byteLength<=h){for(m=0,L=y;0<=L?m<L:m>L;0<=L?m++:m--)P(!1);return x}if(g.seek(h),v=g.getUint16(),d=g.getUint16(),v!==2)throw new Error("Not an Adobe Color Swatch file v2");if(d!==y)throw new Error("Number of colors mismatch between ACO v1 and v2 sections");for(A=0,T=y;0<=T?A<T:A>T;0<=T?A++:A--)P(!0);return x},n.exports.write_adobe_color_swatch=function(l){var r,d,h,v,p,m,A,y,x,P,L;for(L=function(T,g){var _,u,b,S,M,R,C,D,B,Z,J,q;for(Z=(J=T.name)!=null?J:T.toString(),u=a.RGB,M=[T.red,T.green,T.blue,0],q=2+M.length*2,g&&(q+=4+(Z.length+1)*2),b=new o(q),b.writeUint16(u),R=0,D=M.length;R<D;R++)S=M[R],b.writeUint16(S*e);if(g){for(b.writeUint16(0),b.writeUint16(Z.length+1),C=0,B=Z.length;C<B;C++)_=Z[C],b.writeUint16(_.charCodeAt(0));b.writeUint16(0)}return b.buffer},r=function(){var T,g,_;for(_=[],T=0,g=l.length;T<g;T++)v=l[T],_.push(L(v,!1));return _}(),d=function(){var T,g,_;for(_=[],T=0,g=l.length;T<g;T++)v=l[T],_.push(L(v,!0));return _}(),p=4+r.reduce(function(T,g){return T+g.byteLength},0)+2+2+d.reduce(function(T,g){return T+g.byteLength},0),m=new o(p),m.writeUint16(1),m.writeUint16(l.length),A=0,x=r.length;A<x;A++)h=r[A],m.writeBytes(new Uint8Array(h));for(m.writeUint16(2),m.writeUint16(l.length),y=0,P=d.length;y<P;y++)h=d[y],m.writeBytes(new Uint8Array(h));return m.buffer},n.exports.read_adobe_swatch_exchange=function({data:l}){var r,d,h,v,p,m,A,y,x,P,L,T,g,_,u,b,S,M,R;if(b=new c,M=new o(l),M.getString(4)!=="ASEF")throw new Error("Not an Adobe Swatch Exchange file");for(M.getUint32(),u=M.getUint32(),h=49153,d=49154,r=1,v="CMYK",m="RGB ",p="GRAY",R=[],T=0,S=u;0<=S?T<S:T>S;0<=S?T++:T--){switch(x=M.getUint16(),y=M.getUint32(),A=M.tell()+y,x){case h:_=M.getUint16(),g=i(M,_,!0),R.push({name:g});break;case d:R.pop();break;case r:switch(_=M.getUint16(),g=i(M,_,!0),P=M.getString(4),P){case v:b.add({cyan:M.getFloat32(),magenta:M.getFloat32(),yellow:M.getFloat32(),key:M.getFloat32(),name:g});break;case m:b.add({red:M.getFloat32(),green:M.getFloat32(),blue:M.getFloat32(),name:g});break;case p:L=M.getFloat32(),b.add({red:L,green:L,blue:L,name:g})}M.getUint16()}M.seek(A)}return b},n.exports.write_adobe_swatch_exchange=function(l){var r,d,h,v,p,m,A,y,x,P,L,T,g,_,u,b,S,M,R,C,D,B,Z;for(r=1,h="RGB ",d=0,y=[],D=0,g=0,b=l.length;g<b;g++){for(L=l[g],R=(C=L.name)!=null?C:L.toString(),m=r,x=2+(R.length+1)*2+4+3*4+2,p=6+x,A=o(p),A.writeUint16(m),A.writeUint32(x),A.writeUint16(R.length+1),_=0,S=R.length;_<S;_++)P=R[_],A.writeUint16(P.charCodeAt(0));A.writeUint16(0),A.writeString(h),A.writeFloat32(L.red),A.writeFloat32(L.green),A.writeFloat32(L.blue),A.writeUint16(d),y.push(A.buffer),D+=p}for(T=12+D,Z=new o(T),Z.writeString("ASEF"),B=1,Z.writeUint32(B),Z.writeUint32(y.length),u=0,M=y.length;u<M;u++)v=y[u],Z.writeBytes(new Uint8Array(v));return Z.buffer},n.exports.read_adobe_color_book=function({data:l}){var r,d,h,v,p,m,A,y,x,P,L,T,g,_,u,b,S,M;if(g=new c,M=new o(l),b=M.getString(4),b!=="8BCB")throw new Error("Not an Adobe Color Book");if(S=M.getUint16(),S!==1)throw new Error(`Unknown Adobe Color Book version: ${S}?`);for(L=function(R){var C;return C=R.replace(/^"(.*)"$/,"$1"),C.startsWith("$$$")&&(C=C.split("=")[1]),C=C.replace("^R","Â®"),C=C.replace("^C","Â©"),C},M.getUint16(),v=L(i(M,M.getUint32(),!1)),y=L(i(M,M.getUint32(),!1)),x=L(i(M,M.getUint32(),!1)),h=L(i(M,M.getUint32())),m=M.getUint16(),M.getUint16(),M.getUint16(),P=M.getUint16(),T=0,u=m;0<=u?T<u:T>u;0<=u?T++:T--)switch(A=L(i(M,M.getUint32(),!1)),p=M.getString(6).trim(),p=p.replace(/^0*(\d+)$/,"$1"),p=p.replace("X","-"),p&&!A&&(_=p.lastIndexOf(x.trim()),A=_>=0?p.slice(0,_):p),r=function(R){if(!(!A.trim()&&!p.trim()))return R.name=y+A+x,g.add(R)},d=function(){throw new Error(`Color space #${P} (${a[P]}) not supported.`)},P){case 0:r({red:M.getUint8()/255,green:M.getUint8()/255,blue:M.getUint8()/255});break;case 1:r({hue:M.getUint8()/255,saturation:M.getUint8()/255,value:M.getUint8()/255});break;case 2:r({cyan:1-M.getUint8()/255,magenta:1-M.getUint8()/255,yellow:1-M.getUint8()/255,key:1-M.getUint8()/255});break;case 3:d();break;case 4:d();break;case 5:d();break;case 6:d();break;case 7:r({l:M.getUint8()/255,a:M.getUint8()/255,b:M.getUint8()/255});break;case 8:d();break;case 9:d();break;case 10:d();break;default:d()}return g.name=v,g.description=h,g}},{"../Palette":37,jdataview:7}],39:[function(t,n,s){var e,c;c=t("jdataview"),e=t("../Palette"),n.exports=function({data:a,fileExt:i}){var o,l,r,d;if(l=new e,d=new c(a),!((r=d.byteLength)===768||r===772||i==="act"))throw new Error(`file size must be 768 or 772 bytes (saw ${d.byteLength}), OR file extension must be '.act' (saw '.${i}')`);for(var o=0;o<256;o++)l.add({red:d.getUint8()/255,green:d.getUint8()/255,blue:d.getUint8()/255});return l.numberOfColumns=16,l},n.exports.write=function(a){var i,o,l;for(l=new c(256*3),i=o=0;o<256;i=++o)l.writeUint8(a[i]?Math.round(a[i].red*255):0),l.writeUint8(a[i]?Math.round(a[i].green*255):0),l.writeUint8(a[i]?Math.round(a[i].blue*255):0);return l.buffer}},{"../Palette":37,jdataview:7}],40:[function(t,n,s){var e,c;c=t("css.escape"),e=t("../Palette"),n.exports=function({fileContentString:a}){var i,o,l,r,d,h,v,p,m,A,y,x,P,L,T,g,_;for(m=0,l=0,d=a.length;l<d;l++)i=a[l],(i==="\0"||i===""||i===""||i===""||i===""||i===""||i===""||i==="\x07"||i==="\b"||i==="\v"||i==="\f"||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i==="\x1B"||i===""||i===""||i===""||i===""||i==="")&&m++;if(m>5)throw new Error("looks like a binary file");for(_=[y=new e,x=new e,T=new e,P=new e,L=new e,g=new e],o=function(u){return parseInt(u,16)},a.replace(/\#([0-9A-F]{3}|[0-9A-F]{6}|[0-9A-F]{4}|[0-9A-F]{8})(?![0-9A-F])/gim,function(u,b){return b.length>4?y.add({red:o(b[0]+b[1])/255,green:o(b[2]+b[3])/255,blue:o(b[4]+b[5])/255,alpha:b.length===8?o(b[6]+b[7])/255:void 0}):x.add({red:o(b[0]+b[0])/255,green:o(b[1]+b[1])/255,blue:o(b[2]+b[2])/255,alpha:b.length===4?o(b[3]+b[3])/255:void 0})}),a.replace(/rgb\(\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*\)/gim,function(u,b,S,M,R,C,D){return T.add({red:Number(b)/(S==="%"?100:255),green:Number(M)/(R==="%"?100:255),blue:Number(C)/(D==="%"?100:255)})}),a.replace(/rgba?\(\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\/)\s*([0-9]*\.?[0-9]+)(%?)\s*\)/gim,function(u,b,S,M,R,C,D,B,Z){return g.add({red:Number(b)/(S==="%"?100:255),green:Number(M)/(R==="%"?100:255),blue:Number(C)/(D==="%"?100:255),alpha:Number(B)/(Z==="%"?100:1)})}),a.replace(/hsl\(\s*([0-9]*\.?[0-9]+)(deg|rad|turn|)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*\)/gim,function(u,b,S,M,R,C,D){return P.add({hue:Number(b)/(S==="rad"?2*Math.PI:S==="turn"?1:360),saturation:Number(M)/(R==="%"?100:1),lightness:Number(C)/(D==="%"?100:1)})}),a.replace(/hsla?\(\s*([0-9]*\.?[0-9]+)(deg|rad|turn|)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\/)\s*([0-9]*\.?[0-9]+)(%?)\s*\)/gim,function(u,b,S,M,R,C,D,B,Z){return L.add({hue:Number(b)/(S==="rad"?2*Math.PI:S==="turn"?1:360),saturation:Number(M)/(R==="%"?100:1),lightness:Number(C)/(D==="%"?100:1),alpha:Number(B)/(Z==="%"?100:1)})}),v=[],r=0,h=_.length;r<h;r++)A=_[r],A.length>=v.length&&(v=A);if(p=v.length,p<4)throw new Error(["No colors found","Only one color found","Only a couple colors found","Only a few colors found"][p]+` (${p})`);return v},n.exports.write_css=function(a){return`:root {
	${a.map(function(i,o){return`--${i.name?c(i.name.replace(/\s/g,"-")):`color-${o+1}`}: ${i};`}).join(`
	`)}
}`},n.exports.write_styl=function(a){return a.map(function(i,o){return`${i.name?c(i.name.replace(/\s/g,"-")):`color-${o+1}`} = ${i};`}).join(`
`)},n.exports.write_less=function(a){return a.map(function(i,o){return`@${i.name?c(i.name.replace(/\s/g,"-")):`color-${o+1}`}: ${i};`}).join(`
`)},n.exports.write_scss=function(a){return a.map(function(i,o){return`$${i.name?c(i.name.replace(/\s/g,"-")):`color-${o+1}`}: ${i};`}).join(`
`)},n.exports.write_sass=function(a){return a.map(function(i,o){return`$${i.name?c(i.name.replace(/\s/g,"-")):`color-${o+1}`}: ${i}`}).join(`
`)}},{"../Palette":37,"css.escape":4}],41:[function(t,n,s){var e,c;c=t("jdataview"),e=t("../Palette"),n.exports=function({data:a,fileExt:i}){var o,l,r,d,h,v,p;if(i!=="cs")throw new Error(`ColorSchemer loader is only enabled when file extension is '.cs' (saw '.${i}' instead)`);for(h=new e,d=!0,p=new c(a,0,void 0,d),p.getUint16(),o=p.getUint16(),l=r=0,v=o;0<=v?r<v:r>v;l=0<=v?++r:--r)p.seek(8+l*26),h.add({red:p.getUint8()/255,green:p.getUint8()/255,blue:p.getUint8()/255});return h}},{"../Palette":37,jdataview:7}],42:[function(t,n,s){var e,c,a;e=t("../Palette"),c=function(i,o){var l,r,d,h,v,p;if(d=i.split(/\r?\n/),d[0]!==o)throw new Error(`Not a ${o}`);for(v=new e,r=0;(r+=1)<d.length;)if(l=d[r],!(l[0]==="#"||l==="")){if(h=l.match(/Name:\s*(.*)/),h){v.name=h[1];continue}if(h=l.match(/Columns:\s*(.*)/),h){v.numberOfColumns=Number(h[1]),v.geometrySpecifiedByFile=!0;continue}if(p=l.match(/^\s*([0-9]+)\s+([0-9]+)\s+([0-9]+)(?:\s+(.*))?$/),!p)throw new Error(`Line ${r+1} doesn't match pattern of red green blue name`);v.add({red:Number(p[1])/255,green:Number(p[2])/255,blue:Number(p[3])/255,name:p[4]})}return v},n.exports=function({fileContentString:i}){return c(i,"GIMP Palette")},a=function(i,o){return`${o||"GIMP Palette"}
Name: ${i.name||"Saved Colors"}
Columns: ${i.numberOfColumns||8}
#
${i.map(l=>{var r,d,h;return{red:h,green:d,blue:r}=l,`${[h,d,r].map(v=>`${Math.round(v*255)}`.padEnd(3," ")).join(" ")}   ${l.name||l}`}).join(`
`)}`},n.exports.write=function(i){return a(i,"GIMP Palette")},n.exports.extension="gpl",n.exports.write_gimp_or_kde_rgb_palette=a,n.exports.parse_gimp_or_kde_rgb_palette=c},{"../Palette":37}],43:[function(t,n,s){var e;e=t("../Palette"),n.exports=function({fileContentString:c}){var a,i,o,l,r,d;if(l=c.split(/\r?\n/),l[0]!=="Palette")throw new Error("Not a Homesite palette");if(!l[1].match(/Version [34]\.0/))throw new Error("Unsupported Homesite palette version");for(d=new e,a=0,i=l.length;a<i;a++)o=l[a],r=o.match(/(\d+)\s+(\d+)\s+(\d+)/),r&&d.add({red:Number(r[1])/255,green:Number(r[2])/255,blue:Number(r[3])/255});return d},n.exports.write=function(c){return`Palette
Version 4.0
-----------
${c.map(function(a){return`${Math.round(a.red*255)} ${Math.round(a.green*255)} ${Math.round(a.blue*255)}`}).join(`
`)}`}},{"../Palette":37}],44:[function(t,n,s){var e,c;({parse_gimp_or_kde_rgb_palette:e,write_gimp_or_kde_rgb_palette:c}=t("./GIMP")),n.exports=function({fileContentString:a}){return e(a,"KDE RGB Palette")},n.exports.write=function(a){return c(a,"KDE RGB Palette")},n.exports.extension="colors"},{"./GIMP":42}],45:[function(t,n,s){var e;e=t("../Palette"),n.exports=function({fileContentString:c}){var a,i,o,l,r,d,h;for(d=new e,a=function(v){return parseInt(v,16)},h=c.split(/\r?\n/),i=0,o=h.length;i<o;i++)l=h[i],r=l.match(/^([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i),r&&d.add({alpha:a(r[1])/255,red:a(r[2])/255,green:a(r[3])/255,blue:a(r[4])/255});return d},n.exports.write=function(c){var a,i,o;return i=function(l){var r;return r=Math.round(l*255).toString(16),r.length===1?`0${r}`:r},o=function(l){var r,d,h,v;return{alpha:r,red:v,green:h,blue:d}=l,r==null&&(r=1),[r,v,h,d].map(i).join("")},a=`Paint.NET Palette File
Lines that start with a semicolon are comments
Colors are written as 8-digit hexadecimal numbers: aarrggbb
For example, this would specify green: FF00FF00
The alpha ('aa') value specifies how transparent a color is. FF is fully opaque, 00 is fully transparent.
A palette must consist of ninety six (96) colors. If there are less than this, the remaining color
slots will be set to white (FFFFFFFF). If there are more, then the remaining colors will be ignored.

`,c.name&&(a+=`Palette Name: ${c.name}
`),c.description&&(a+=`Description: ${c.description}
`),a+=`Colors: ${c.length}
`,c.numberOfColumns&&(a+=`Columns: ${c.numberOfColumns}
`),a=`; ${a}`.replace(/\n/g,`
; `).replace(/\s*\n/g,`
`),`${a}
${c.map(o).join(`
`)}`}},{"../Palette":37}],46:[function(t,n,s){var e;e=t("../Palette"),n.exports=function({fileContentString:c}){var a,i,o,l,r,d,h;if(r=c.split(/[\n\r]+/m),r[0]!=="JASC-PAL")throw new Error("Not a JASC-PAL");if(r[1]!=="0100")throw new Error("Unknown JASC-PAL version");for(d=new e,a=i=0,o=r.length;i<o;a=++i)l=r[a],l!==""&&a>2&&(h=l.split(" "),d.add({red:Number(h[0])/255,green:Number(h[1])/255,blue:Number(h[2])/255}));return d},n.exports.write=function(c){return`JASC-PAL
0100
${c.length}
${c.map(function(a){return`${Math.round(a.red*255)} ${Math.round(a.green*255)} ${Math.round(a.blue*255)}`}).join(`
`)}`}},{"../Palette":37}],47:[function(t,n,s){var e,c;c=t("jdataview"),e=t("../Palette"),n.exports=function({data:a}){var i,o,l,r,d,h,v,p,m,A;if(r=!0,A=new c(a,0,void 0,r),p=A.getString(4),A.getUint32(),m=A.getString(4),p!=="RIFF")throw new Error("RIFF header not found; not a RIFF PAL file");if(m!=="PAL ")throw new Error(`RIFF header says this isn't a PAL file,
more of a sort of ${(m+"").trim()} file`);if(i=A.getString(4),A.getUint32(),d=A.getUint16(),o=A.getUint16(),i!=="data")throw new Error(`Data chunk not found (...'${i}'?)`);if(d!==768)throw new Error(`Unsupported PAL file format version: 0x${d.toString(16)}`);for(h=new e,l=0,v=o;0<=v?l<v:l>v;0<=v?l++:l--)h.add({red:A.getUint8()/255,green:A.getUint8()/255,blue:A.getUint8()/255}),A.getUint8();return h},n.exports.write=function(a){var i,o,l,r,d,h,v,p;for(o=4+4*a.length,l=8+o,r=12+l,p=!0,d=new c(r,0,void 0,p),d.writeString("RIFF"),d.writeUint32(l+4),d.writeString("PAL "),d.writeString("data"),d.writeUint32(o),d.writeUint16(768),d.writeUint16(a.length),h=0,v=a.length;h<v;h++)i=a[h],d.writeUint8(Math.round(i.red*255)),d.writeUint8(Math.round(i.green*255)),d.writeUint8(Math.round(i.blue*255)),d.writeUint8(0);return d.buffer}},{"../Palette":37,jdataview:7}],48:[function(t,n,s){var e,c;e=t("../Palette"),{parse_css_hex_color:c}=t("../helpers"),n.exports=function({fileContentString:a}){var i,o,l,r,d,h,v,p,m,A,y,x,P,L,T;for(y=a.split(/[\n\r]+/m),L=new e,h={set_name:function(g){return L.name=g},add_comments:function(g){return L.description==null&&(L.description=""),L.description.length>0&&(L.description+=`
`),L.description+=g},set_columns:function(g){return L.numberOfColumns=g,L.geometrySpecifiedByFile=!0},hexcolor:function(g,_){var u;return u=c("#"+g),u.name=_,L.add(u)},rgbcolor:function(g,_,u,b){return L.add({red:g/255,green:_/255,blue:u/255,name:b})},color:function([g,_,u,b]){switch(g){case"RGB":return L.add({red:_[0],green:_[1],blue:_[2],alpha:u,name:b});case"Grayscale":return L.add({red:_[0],green:_[0],blue:_[0],alpha:u,name:b});case"CMYK":return L.add({cyan:_[0],magenta:_[1],yellow:_[2],key:_[3],alpha:u,name:b});case"HSL":return L.add({hue:_[0],saturation:_[1],lightness:_[2],alpha:u,name:b})}}},T=function(g,_){var u,b,S,M,R,C,D;for(u=[],b=0,R=function(){var B,Z;if(Z="",B=g[b],B!=="'"&&B!=='"')throw new Error("Expected to start parsing string on a quote character");for(b+=1;b<g.length;){if(g[b]==="\\")b+=1,g[b]==="\\"?Z+="\\":g[b]==="r"?Z+="\r":g[b]==="n"?Z+=`
`:g[b]==="t"?Z+="	":g[b]==="v"?Z+="\v":g[b]==="a"?Z+="a":g[b]==="b"?Z+="\b":g[b]==="'"?Z+="'":g[b]==='"'?Z+='"':g[b].match(/\d/)||g[b]==="x"||g[b]==="N"||g[b]==="u"||g[b]==="U"||(console.log(`Warning: unecessary escape in python string: \\${g[b]}`),Z+=g[b]);else{if(g[b]===B)return Z;Z+=g[b]}b+=1}throw new SyntaxError(`Expected end of string on line ${_}`)},M=function(){var B;for(B="";b<g.length&&g[b].match(/[\d\.]/);){B+=g[b];b+=1}return b-=1,parseFloat(B)},S=function(){var B,Z,J;for(b+=1,J=[];b<g.length;){if(g[b]==="u")if(b+=1,(B=g[b])==="'"||B==='"')J.push(R());else throw new SyntaxError(`Unexpected 'u${g.slice(b)}' on line ${_}`);else if((Z=g[b])==="'"||Z==='"')J.push(R());else if(g[b]==="[")J.push(S());else if(g[b].match(/\d/))J.push(M());else{if(g[b]==="]")return J;if(g[b]!==","){if(g[b].match(/\S/))throw new SyntaxError(`Unexpected '${g.slice(b)}' on line ${_}`)}}b+=1}throw new SyntaxError(`Expected end of array on line ${_}`)};b<g.length;){if(g[b]==="u")if(b+=1,(C=g[b])==="'"||C==='"')u.push(R());else throw new SyntaxError(`Unexpected 'u${g.slice(b)}' on line ${_}`);else if((D=g[b])==="'"||D==='"')u.push(R());else if(g[b]==="[")u.push(S());else if(g[b].match(/\d/))u.push(M());else if(g[b]!==","){if(g[b].match(/\S/))throw new SyntaxError(`Unexpected '${g.slice(b)}' on line ${_}`)}b+=1}return u},A=v=0,p=y.length;v<p;A=++v)m=y[A],x=m.match(/([\w_]+)\((.*)\)/),x&&([i,d,l]=x,r=h[d],r&&(o=T(l,A+1),r(...o)));if(P=L.length,P<2)throw new Error(["No colors found","Only one color found"][P]+` (${P})`);return L},n.exports.write=function(a){var i,o,l,r,d,h,v,p,m,A,y,x,P,L,T;if(L=function(g){return`'${g.replace(/[\r\n]+/g," ").replace(/'/g,"\\'")}'`},T=`##sK1 palette
`,T+=`palette()
`,a.name&&(T+=`set_name(${L(a.name)})
`),a.source&&(T+=`set_source(${L(a.source)})
`),a.description)for(y=a.description.split(/\r?\n/g),d=0,p=y.length;d<p;d++)h=y[d],T+=`add_comments(${L(h)})
`;for(a.numberOfColumns&&(T+=`set_columns(${a.numberOfColumns})
`),v=0,m=a.length;v<m;v++)o=a[v],o.hue!=null?(l="HSL",r=[o.hue,o.saturation,o.lightness]):(l="RGB",r=[o.red,o.green,o.blue]),i=(x=o.alpha)!=null?x:1,A=(P=o.name)!=null?P:o.toString(),T+=`color([${L(l)}, [${r.join(", ")}], ${i}, ${L(A)}])
`;return T+=`palette_end()
`,T}},{"../Palette":37,"../helpers":56}],49:[function(t,n,s){var e;e=t("../Palette"),n.exports=function({fileContentString:c}){var a,i,o,l,r,d,h;if(r=c.split(/[\n\r]+/m),r[0]!=="##Sketch RGBPalette 0")throw new Error("Not a Skencil palette");for(d=new e,l=a=0,i=r.length;a<i;l=++a)if(o=r[l],!(o[0]==="#"||o==="")){if(h=o.match(/^\s*([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)(?:\s+(.*))?$/),!h)throw new Error(`Line ${l+1} doesn't match pattern of red green blue name`);d.add({red:Number(h[1]),green:Number(h[2]),blue:Number(h[3]),name:h[4]})}return d},n.exports.write=function(c){return`##Sketch RGBPalette 0
${c.map(function(a){var i;return`${a.red.toFixed(6)} ${a.green.toFixed(6)} ${a.blue.toFixed(6)} ${(i=a.name)!=null?i:a}`}).join(`
`)}`}},{"../Palette":37}],50:[function(t,n,s){var e,c;c=t("jdataview"),e=t("../Palette"),n.exports=function({data:a}){var i,o,l;if(o=new e,l=new c(a),l.byteLength!==768)throw new Error(`Wrong file size, must be 768 bytes long (not ${l.byteLength})`);for(var i=0;i<256;i++)o.add({red:l.getUint8()/255,green:l.getUint8()/255,blue:l.getUint8()/255});return o},n.exports.write=function(a){var i,o,l;for(l=new c(256*3),i=o=0;o<256;i=++o)l.writeUint8(a[i]?Math.round(a[i].red*255):0),l.writeUint8(a[i]?Math.round(a[i].green*255):0),l.writeUint8(a[i]?Math.round(a[i].blue*255):0);return l.buffer}},{"../Palette":37,jdataview:7}],51:[function(t,n,s){var e,c;c=t("jdataview"),e=t("../Palette"),n.exports=function({data:a}){var i,o,l;if(o=new e,l=new c(a),l.byteLength!==1024)throw new Error(`Wrong file size, must be 1024 bytes long (not ${l.byteLength})`);for(var i=0;i<256;i++)o.add({red:l.getUint8()/255,green:l.getUint8()/255,blue:l.getUint8()/255}),l.getUint8();return o.numberOfColumns=16,o},n.exports.write=function(a){var i,o,l;for(l=new c(256*4),i=o=0;o<256;i=++o)l.writeUint8(a[i]?Math.round(a[i].red*255):0),l.writeUint8(a[i]?Math.round(a[i].green*255):0),l.writeUint8(a[i]?Math.round(a[i].blue*255):0),l.writeUint8(0);return l.buffer}},{"../Palette":37,jdataview:7}],52:[function(t,n,s){var e,c,a,i;c=t("xml-js"),e=t("../Palette"),{parse_css_hex_color:a}=t("../helpers"),n.exports.read_soc=function({fileContentString:o}){var l,r,d,h,v,p,m,A,y,x,P,L,T,g;if(!o.match(/^\s*<\?\s*xml/i))throw new Error("not a StarOffice palette (no <?xml...?> declaration)");if(A=new e,y=c.xml2js(o,{compact:!1}),!((x=y.elements)!=null&&x.length))throw new Error("No XML elements found");for(P=y.elements,h=0,p=P.length;h<p;h++)if(d=P[h],(L=d.name)!=null&&L.match(/:color-table$/)&&d.elements)for(T=d.elements,v=0,m=T.length;v<m;v++)l=T[v],l.name==="draw:color"&&((g=l.attributes["draw:color"])!=null&&g.match(/#/))&&(r=a(l.attributes["draw:color"]),r.name=l.attributes["draw:name"],A.add(r));return A},i=function(o,l){var r,d,h;return d=function(v){var p;return p=Math.round(v*255).toString(16),p.length===1?`0${p}`:p},h=function(v){var p,m,A;return{red:A,green:m,blue:p}=v,"#"+[A,m,p].map(d).join("")},c.js2xml({declaration:{attributes:{version:"1.0",encoding:"UTF-8"}},elements:[{type:"element",name:l?"ooo:color-table":"office:color-table",attributes:l?{"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:svg":"http://www.w3.org/2000/svg","xmlns:ooo":"http://openoffice.org/2004/office"}:{"xmlns:form":"http://openoffice.org/2000/form","xmlns:number":"http://openoffice.org/2000/datastyle","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:office":"http://openoffice.org/2000/office","xmlns:meta":"http://openoffice.org/2000/meta","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:svg":"http://www.w3.org/2000/svg","xmlns:dr3d":"http://openoffice.org/2000/dr3d","xmlns:text":"http://openoffice.org/2000/text","xmlns:style":"http://openoffice.org/2000/style","xmlns:script":"http://openoffice.org/2000/script","xmlns:chart":"http://openoffice.org/2000/chart","xmlns:draw":"http://openoffice.org/2000/drawing","xmlns:table":"http://openoffice.org/2000/table","xmlns:fo":"http://www.w3.org/1999/XSL/Format","xmlns:config":"http://openoffice.org/2001/config","xmlns:dc":"http://purl.org/dc/elements/1.1/"},elements:function(){var v,p,m;for(m=[],v=0,p=o.length;v<p;v++)r=o[v],m.push({type:"element",name:"draw:color",attributes:{"draw:name":r.name||r.toString(),"draw:color":h(r)}});return m}()}]},{spaces:"	"})},n.exports.write_staroffice_soc=function(o){return i(o,!1)},n.exports.write_libreoffice_soc=function(o){return i(o,!0)}},{"../Palette":37,"../helpers":56,"xml-js":30}],53:[function(t,n,s){var e,c,a;e=t("../Palette"),{parse_css_hex_color:c}=t("../helpers"),a=1.4,n.exports=function({fileContentString:i}){var o,l,r,d,h,v,p,m,A,y,x;if(!i.match(/^\s*{/))throw new Error("not sketchpalette JSON");if(y=JSON.parse(i),r=y.compatibleVersion,o=(x=y.colors)!=null?x:[],A=new e,r&&r>a)throw new Error(`Can't handle compatibleVersion of ${r}.`);if(!r||r<1.4)for(h=0,p=o.length;h<p;h++)d=o[h],A.add(c(d));else if(o.length>0)for(v=0,m=o.length;v<m;v++)l=o[v],A.add(l);return A},n.exports.write=function(i){return JSON.stringify({compatibleVersion:"1.4",pluginVersion:"1.4",colors:i.map(function(o){var l,r,d,h;return{red:h,green:d,blue:r,alpha:l}=o,l==null&&(l=1),{red:h,green:d,blue:r,alpha:l}})},null,"	")},n.exports.extension="sketchpalette"},{"../Palette":37,"../helpers":56}],54:[function(t,n,s){var e;e=t("../Palette"),n.exports=function({fileContentString:c}){var a,i,o,l,r,d,h,v,p,m,A,y,x;for(h=c.split(/[\n\r]+/m),A=[a=new e,y=new e],x=function(P,L,T){var g;if(g=P.match(T),g)return L.add({red:Number(g[1])/255,green:Number(g[2])/255,blue:Number(g[3])/255})},i=0,l=h.length;i<l;i++)d=h[i],x(d,a,/([0-9]*\.?[0-9]+),\s*([0-9]*\.?[0-9]+),\s*([0-9]*\.?[0-9]+)/),x(d,y,/([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)/);for(v=[],o=0,r=A.length;o<r;o++)m=A[o],m.length>=v.length&&(v=m);if(p=v.length,p<4)throw new Error(["No colors found","Only one color found","Only a couple colors found","Only a few colors found"][p]+` (${p})`);return v.every(function(P){return P.red<=1/255&&P.green<=1/255&&P.blue<=1/255})&&v.forEach(function(P){return P.red*=255,P.green*=255,P.blue*=255}),v}},{"../Palette":37}],55:[function(t,n,s){var e,c,a;e=t("../Palette"),c=function(i){var o,l,r,d;return l={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([^=]+?)\s*=\s*(.*?)\s*$/,comment:/^\s*;.*$/},d={},o=i.split(/[\r\n]+/),r=null,o.forEach(function(h){var v;l.comment.test(h)||(l.param.test(h)?(v=h.match(l.param),r?d[r][v[1]]=v[2]:d[v[1]]=v[2]):l.section.test(h)?(v=h.match(l.section),d[v[1]]={},r=v[1]):h.length===0&&r&&(r=null))}),d},a=function(i){var o,l,r,d,h,v,p,m,A,y;if(y=c(i),o=y["Control Panel\\Colors"],!o)throw new Error("Invalid theme file, no [Control Panel\\Colors] section");m=new e;for(v in o)if(!v.match(/\W/)&&(r=o[v].split(" "),r.length===3)){for(d=h=0,p=r.length;h<p;d=++h)l=r[d],r[d]=parseInt(l,10);r.every(function(x){return isFinite(x)})&&m.add({red:r[0]/255,green:r[1]/255,blue:r[2]/255,name:v})}return m.name=(A=y.Theme)!=null?A.DisplayName:void 0,m},n.exports=function({fileContentString:i}){return a(i)}},{"../Palette":37}],56:[function(t,n,s){n.exports.parse_css_hex_color=function(e){var c,a,i,o;return i=function(l){return parseInt(l,16)},o=e.match(/\#([0-9A-F]{3}|[0-9A-F]{6}|[0-9A-F]{4}|[0-9A-F]{8})(?![0-9A-F])/im),[c,a]=o,a.length>4?{red:i(a[0]+a[1])/255,green:i(a[2]+a[3])/255,blue:i(a[4]+a[5])/255,alpha:a.length===8?i(a[6]+a[7])/255:void 0}:{red:i(a[0]+a[0])/255,green:i(a[1]+a[1])/255,blue:i(a[2]+a[2])/255,alpha:a.length===4?i(a[3]+a[3])/255:void 0}}},{}],57:[function(t,n,s){var e,c,a,i,o,l,r,d,h,v,p,m,A=[].splice;for(i=t("./Palette"),c=t("./Color"),a=class extends Error{constructor(x){var P;super(),this.errors=x,this.message="Some errors were encountered when loading:"+(function(){var L,T,g,_;for(g=this.errors,_=[],L=0,T=g.length;L<T;L++)P=g[L],_.push(`
	`+P.message);return _}).call(this)}},r={PAINT_SHOP_PRO_PALETTE:{name:"Paint Shop Pro palette",fileExtensions:["psppalette","pal"],readFromText:t("./formats/PaintShopPro"),write:t("./formats/PaintShopPro").write},RIFF_PALETTE:{name:"RIFF PAL",fileExtensions:["pal"],read:t("./formats/RIFF"),write:t("./formats/RIFF").write},COLORSCHEMER_PALETTE:{name:"ColorSchemer palette",fileExtensions:["cs"],read:t("./formats/ColorSchemer")},PAINTDOTNET_PALETTE:{name:"Paint.NET palette",fileExtensions:["txt"],readFromText:t("./formats/Paint.NET"),write:t("./formats/Paint.NET").write},GIMP_PALETTE:{name:"GIMP palette",fileExtensions:["gpl","gimp","colors"],readFromText:t("./formats/GIMP"),write:t("./formats/GIMP").write},KDE_RGB_PALETTE:{name:"KolourPaint palette",fileExtensions:["colors"],readFromText:t("./formats/KolourPaint"),write:t("./formats/KolourPaint").write},SKENCIL_PALETTE:{name:"Skencil palette",fileExtensions:["spl"],readFromText:t("./formats/SPL"),write:t("./formats/SPL").write},SKETCH_JSON_PALETTE:{name:"Sketch palette",fileExtensions:["sketchpalette"],readFromText:t("./formats/sketchpalette"),write:t("./formats/sketchpalette").write},SK1_PALETTE:{name:"sK1 palette",fileExtensions:["skp"],readFromText:t("./formats/SKP"),write:t("./formats/SKP").write},WINDOWS_THEME_COLORS:{name:"Windows desktop theme",fileExtensions:["theme","themepack"],readFromText:t("./formats/theme")},ADOBE_SWATCH_EXCHANGE_PALETTE:{name:"Adobe Swatch Exchange",fileExtensions:["ase"],read:t("./formats/Adobe").read_adobe_swatch_exchange,write:t("./formats/Adobe").write_adobe_swatch_exchange},ADOBE_COLOR_BOOK_PALETTE:{name:"Adobe Color Book",fileExtensions:["acb"],read:t("./formats/Adobe").read_adobe_color_book},STAROFFICE_PALETTE:{name:"StarOffice Colors",fileExtensions:["soc"],readFromText:t("./formats/StarOffice").read_soc,write:t("./formats/StarOffice").write_libreoffice_soc},CSS_VARIABLES:{name:"CSS variables",fileExtensions:["css"],write:t("./formats/CSS").write_css},SCSS_VARIABLES:{name:"SCSS variables",fileExtensions:["scss"],write:t("./formats/CSS").write_scss},SASS_VARIABLES:{name:"SASS variables",fileExtensions:["sass"],write:t("./formats/CSS").write_sass},LESS_VARIABLES:{name:"LESS variables",fileExtensions:["less"],write:t("./formats/CSS").write_less},STYLUS_VARIABLES:{name:"Stylus variables",fileExtensions:["styl"],write:t("./formats/CSS").write_styl},CSS_COLORS:{name:"CSS colors",fileExtensions:["css","scss","sass","less","styl","html","htm","svg","js","ts","xml","txt"],readFromText:t("./formats/CSS")},HOMESITE_PALETTE:{name:"Homesite palette",fileExtensions:["hpl"],readFromText:t("./formats/Homesite"),write:t("./formats/Homesite").write},ADOBE_COLOR_SWATCH_PALETTE:{name:"Adobe Color Swatch",fileExtensions:["aco"],read:t("./formats/Adobe").read_adobe_color_swatch,write:t("./formats/Adobe").write_adobe_color_swatch},ADOBE_COLOR_TABLE_PALETTE:{name:"Adobe Color Table",fileExtensions:["act"],read:t("./formats/AdobeColorTable"),write:t("./formats/AdobeColorTable").write},STARCRAFT_PALETTE:{name:"StarCraft palette",fileExtensions:["pal"],read:t("./formats/StarCraft"),write:t("./formats/StarCraft").write},STARCRAFT_PADDED:{name:"StarCraft terrain palette",fileExtensions:["wpe"],read:t("./formats/StarCraftPadded"),write:t("./formats/StarCraftPadded").write},TABULAR:{name:"tabular colors",fileExtensions:["csv","tsv","txt"],readFromText:t("./formats/tabular")}},m=Object.keys(r),d=0,h=m.length;d<h;d++)l=m[d],o=r[l],o.fileExtensionsPretty=`.${o.fileExtensions.join(", .")}`;p=function(y,x){var P,L,T,g,_,u,b,S,M,R,C,D;for(y.fileContentString=typeof y.data=="string"?y.data:new TextDecoder().decode(y.data),M={},D=Object.keys(r),_=0,u=D.length;_<u;_++)l=D[_],r[l].fileExtensions.indexOf(y.fileExt)>-1&&(M[l]=!0);for(g=Object.keys(r),g.sort(function(B,Z){return(M[Z]!=null)-(M[B]!=null)}),T=[],S=0,b=g.length;S<b;S++)if(l=g[S],o=r[l],!!(o.read||o.readFromText)){try{if(o.readFromText?C=o.readFromText(y):C=o.read(y),C.length===0)throw C=null,new Error("no colors returned")}catch(B){P=B,R=`failed to load ${y.fileName} as ${o.name}: ${P.message}`,L=new Error(R),L.error=P,L.__PATCHED_LIB_TO_ADD_THIS__format=o,T.push(L)}if(C){C.confidence=M[l]!=null?.9:.01,x(null,C,o,M[l]!=null,{__errors_before_success:T});return}}x(new a(T))},v=function(y={}){var x,P;return(typeof y=="string"||y instanceof String)&&(y={filePath:y}),typeof File<"u"&&File!==null&&y instanceof File&&(y={file:y}),y.fileName==null&&(y.fileName=(x=(P=y.file)!=null?P.name:void 0)!=null?x:y.filePath?t("path").basename(y.filePath):void 0),y.fileExt==null&&(y.fileExt=`${y.fileName}`.split(".").pop()),y.fileExt=`${y.fileExt}`.toLowerCase(),y},e={Color:c,Palette:i,formats:r},e.loadPalette=function(y,x){var P,L;if(!y)throw new TypeError("parameters required: AnyPalette.loadPalette(options, function callback(error, palette){})");if(!x)throw new TypeError("callback required: AnyPalette.loadPalette(options, function callback(error, palette){})");if(y=v(y),y.data)return p(y,x);if(y.file){if(!(y.file instanceof File))throw new TypeError("options.file was passed but it is not a File");return P=new FileReader,P.onerror=function(){return x(P.error)},P.onload=function(){return y.data=P.result,p(y,x)},P.readAsArrayBuffer(y.file)}else{if(y.filePath!=null)return L=t("fs"),L.readFile(y.filePath,function(T,g){return T?x(T):(y.data=g,p(y,x))});throw new TypeError("either options.data or options.file or options.filePath must be passed")}},e.writePalette=function(y,x){return x==null&&(x=e.formats.GIMP_PALETTE),x.write(y)},e.uniqueColors=function(y,x){var P,L,T,g,_;for(_=new i,_.name=this.name,_.description=this.description,A.apply(_,[0,9e9].concat(y.slice(0))),P=0;P<_.length;){for(L=_[P],T=P+1;T<_.length;)g=_[T],c.is(L,g,x)&&(_.splice(T,1),T-=1),T+=1;P+=1}return _},n.exports=e,exportAnyPalette=e},{"./Color":36,"./Palette":37,"./formats/Adobe":38,"./formats/AdobeColorTable":39,"./formats/CSS":40,"./formats/ColorSchemer":41,"./formats/GIMP":42,"./formats/Homesite":43,"./formats/KolourPaint":44,"./formats/Paint.NET":45,"./formats/PaintShopPro":46,"./formats/RIFF":47,"./formats/SKP":48,"./formats/SPL":49,"./formats/StarCraft":50,"./formats/StarCraftPadded":51,"./formats/StarOffice":52,"./formats/sketchpalette":53,"./formats/tabular":54,"./formats/theme":55,fs:"fs",path:"path"}]},{},[57])(57)});const AnyPalette=exportAnyPalette;console.log("AnyPlatteLib",AnyPalette);console.log("JS ì¤í:","OnCanvasObject.js");class OnCanvasObject{constructor(n,s,e,c,a){this.x=n,this.y=s,this.width=e,this.height=c,this.hideMainCanvasHandles=a,this.$el=$(E("div")).addClass("on-canvas-object").appendTo($canvas_area),this.hideMainCanvasHandles&&canvas_handles.hide(),$G$1.on("resize theme-load",this._global_resize_handler=()=>{this.position()})}position(n){const s=parseFloat($canvas_area.css("padding-left")),e=parseFloat($canvas_area.css("padding-top"));this.$el.css({position:"absolute",left:magnification*this.x+s,top:magnification*this.y+e,width:magnification*this.width,height:magnification*this.height}),n&&($status_position.text(`${this.x}, ${this.y}px`),$status_size.text(`${this.width} x ${this.height}px`))}destroy(){this.$el.remove(),this.hideMainCanvasHandles&&canvas_handles.show(),$G$1.off("resize theme-load",this._global_resize_handler)}}console.log("JS ì¤í:","OnCanvasHelpLayer.js");class OnCanvasHelperLayer extends OnCanvasObject{constructor(n,s,e,c,a,i=1){super(n,s,e,c,a),this.$el.addClass("helper-layer"),this.$el.css({pointerEvents:"none"}),this.position(),this.canvas=make_canvas(this.width*i,this.height*i),this.$el.append(this.canvas)}}console.log("JS ì¤í:","Hendles.js");function Handles(t){const{$handles_container:n,$object_container:s}=t,e=t.outset||0,c=t.get_handles_offset_left||(()=>0),a=t.get_handles_offset_top||(()=>0),i=t.get_ghost_offset_left||(()=>0),o=t.get_ghost_offset_top||(()=>0),l=t.size_only||!1,r=0,d=-1,h=1,v=d,p=h,m=d,A=h,y=$(E("div")).addClass("resize-ghost");t.thick&&y.addClass("thick");const x=[];[[m,p],[m,r],[m,v],[r,v],[A,v],[A,r],[A,p],[r,p]].forEach(([P,L])=>{const T=$(E("div")).addClass("handle");T.appendTo(n);const g=$(E("div")).addClass("grab-region").appendTo(n);(P===r||L===r)&&g.addClass("is-middle"),T.css("touch-action","none");let _,u=!1;const b=P!==r,S=L!==r;if(l&&(P===m||L===v))T.addClass("useless-handle"),g.remove();else{let R;L===v&&P===m||L===p&&P===A?R="nwse-resize":L===p&&P===m||L===v&&P===A?R="nesw-resize":S?R="ew-resize":b&&(R="ns-resize");let C="";P===m&&(C+="n"),P===A&&(C+="s"),L===v&&(C+="w"),L===p&&(C+="e"),C+="-resize";const D=make_css_cursor(R,[16,16],C);T.add(g).css({cursor:D});const B=Z=>{y.appendTo(s),u=!0,_=t.get_rect();const J=to_canvas_coords(Z);let q=0,z=0,w,N;L===p?(q=0,w=~~(J.x-_.x)):L===v?(q=~~(J.x-_.x),w=~~(_.x+_.width-J.x)):w=~~_.width,P===A?(z=0,N=~~(J.y-_.y)):P===m?(z=~~(J.y-_.y),N=~~(_.y+_.height-J.y)):N=~~_.height;let G={x:_.x+q,y:_.y+z,width:w,height:N};G.width=Math.max(1,G.width),G.height=Math.max(1,G.height),t.constrain_rect?G=t.constrain_rect(G,L,P):(G.x=Math.min(G.x,_.x+_.width),G.y=Math.min(G.y,_.y+_.height)),y.css({position:"absolute",left:magnification*G.x+i(),top:magnification*G.y+o(),width:magnification*G.width-2,height:magnification*G.height-2}),_=G};T.add(g).on("pointerdown",Z=>{u=!1,Z.button===0&&($G$1.on("pointermove",B),$("body").css({cursor:D}).addClass("cursor-bully")),$G$1.one("pointerup",()=>{$G$1.off("pointermove",B),$("body").css({cursor:""}).removeClass("cursor-bully"),y.remove(),u&&t.set_rect(_),n.trigger("update")})}),T.on("mousedown selectstart",Z=>{Z.preventDefault()})}const M=()=>{const R=t.get_rect(),C=T.width(),D=c(),B=a(),Z=32;for(const{len_key:J,pos_key:q,region:z,offset:w}of[{len_key:"width",pos_key:"left",region:L,offset:D},{len_key:"height",pos_key:"top",region:P,offset:B}]){let N=Math.max(R[J]*magnification/2-Z/2,Math.min(Z/2,R[J]*magnification/3)),G=R[J]*magnification-N;G-N<magnification&&(N=0,G=magnification);const V=-Z/2,H=Math.min(Z/2,N),X=R[J]*magnification-H,Q=R[J]*magnification-V;l&&(N=Math.max(-w,Math.min(N,G-Z))),z===d?(T.css({[q]:w-e}),g.css({[q]:w+V,[J]:H-V})):z===r?(T.css({[q]:w+(R[J]*magnification-C)/2}),g.css({[q]:w+N,[J]:G-N})):z===h&&(T.css({[q]:w+(R[J]*magnification-C/2)}),g.css({[q]:w+X,[J]:Q-X}))}};n.on("update resize scroll",M),$G$1.on("resize theme-load",M),setTimeout(M,50),x.push(T[0],g[0])}),this.handles=x,this.hide=()=>{$(x).css({opacity:0,pointerEvents:"none"})},this.show=()=>{$(x).css({opacity:"",pointerEvents:""})}}console.log("JS ì¤í:","image-manipulation.js");const fill_threshold=1;function get_brush_canvas_size(t,n){return Math.ceil(t*(n==="circle"?2.1:1)/2)*2}function render_brush(t,n,s){n.match(/diagonal/)&&(s-=.4);const e=Math.round(t.canvas.width/2),c=Math.round(e-s/2),a=Math.round(e+s/2),i=Math.round(t.canvas.height/2),o=Math.round(i-s/2),l=Math.round(i+s/2);n==="circle"?draw_ellipse(t,c,o,s,s,!1,!0):n==="square"?t.fillRect(c,o,~~s,~~s):n==="diagonal"?draw_line_without_pattern_support(t,c,o,a,l):n==="reverse_diagonal"?draw_line_without_pattern_support(t,c,l,a,o):n==="horizontal"?draw_line_without_pattern_support(t,c,i,s,i):n==="vertical"&&draw_line_without_pattern_support(t,e,o,e,s)}function draw_ellipse(t,n,s,e,c,a,i){const o=n+e/2,l=s+c/2;if(aliasing){const r=[];for(let h=0;h<TAU;h+=.05)r.push({x:o+Math.cos(h)*e/2,y:l+Math.sin(h)*c/2});draw_polygon(t,r,a,i)}else t.beginPath(),t.ellipse(o,l,Math.abs(e/2),Math.abs(c/2),0,0,TAU,!1),t.stroke(),t.fill()}function draw_rounded_rectangle(t,n,s,e,c,a,i,o,l){if(aliasing){const r=[],d=(m,A)=>{r.push({x:m,y:A})},h=(m,A,y,x,P,L)=>{for(let g=P;g<L;g+=.05)r.push({x:m+Math.cos(g)*y,y:A+Math.sin(g)*x});r.push({x:m+Math.cos(L)*y,y:A+Math.sin(L)*x})},v=n+e,p=s+c;h(v-a,s+i,a,i,TAU*3/4,TAU),d(v,p-i),h(v-a,p-i,a,i,0,TAU*1/4),d(n+a,p),h(n+a,p-i,a,i,TAU*1/4,TAU*1/2),d(n,s+i),h(n+a,s+i,a,i,TAU/2,TAU*3/4),draw_polygon(t,r,o,l)}else t.beginPath(),t.moveTo(n+a,s),t.lineTo(n+e-a,s),t.quadraticCurveTo(n+e,s,n+e,s+i),t.lineTo(n+e,s+c-i),t.quadraticCurveTo(n+e,s+c,n+e-a,s+c),t.lineTo(n+a,s+c),t.quadraticCurveTo(n,s+c,n,s+c-i),t.lineTo(n,s+i),t.quadraticCurveTo(n,s,n+a,s),t.closePath(),o&&t.stroke(),l&&t.fill()}const get_brush_canvas_implementation=(t,n)=>{const s=get_brush_canvas_size(n,t),e=make_canvas(s,s);return render_brush(e.ctx,t,n),e},get_brush_canvas=memoize_synchronous_function(get_brush_canvas_implementation,20);$G$1.on("invalidate-brush-canvases",()=>{get_brush_canvas.clear_memo_cache()});const stamp_brush_canvas=(t,n,s,e,c)=>{const a=get_brush_canvas(e,c),i=-Math.ceil(a.width/2),o=-Math.ceil(a.height/2);t.drawImage(a,n+i,s+o)},get_circumference_points_for_brush_implementation=(t,n)=>{const s=get_brush_canvas(t,n),e=s.ctx.getImageData(0,0,s.width,s.height),c=(l,r)=>l>=0&&r>=0&&l<e.width&&r<e.height&&e.data[(r*e.width+l)*4+3]>127,a=-Math.ceil(s.width/2),i=-Math.ceil(s.height/2),o=[];for(let l=0;l<e.width;l+=1)for(let r=0;r<e.height;r+=1)c(l,r)&&(!c(l,r-1)||!c(l,r+1)||!c(l-1,r)||!c(l+1,r))&&o.push({x:l+a,y:r+i});return o},get_circumference_points_for_brush=memoize_synchronous_function(get_circumference_points_for_brush_implementation);$G$1.on("invalidate-brush-canvases",()=>{get_circumference_points_for_brush.clear_memo_cache()});let line_brush_canvas;function update_brush_for_drawing_lines(t){aliasing&&t>1&&(line_brush_canvas=get_brush_canvas("circle",t))}function draw_line_without_pattern_support(t,n,s,e,c,a=1){aliasing?a>1?bresenham_line(n,s,e,c,(i,o)=>{t.drawImage(line_brush_canvas,~~(i-line_brush_canvas.width/2),~~(o-line_brush_canvas.height/2))}):bresenham_line(n,s,e,c,(i,o)=>{t.fillRect(i,o,1,1)}):(t.beginPath(),t.moveTo(n,s),t.lineTo(e,c),t.lineWidth=a,t.lineCap="round",t.stroke(),t.lineCap="butt")}function bresenham_line(t,n,s,e,c){t=~~t,s=~~s,n=~~n,e=~~e;const a=Math.abs(s-t),i=Math.abs(e-n),o=t<s?1:-1,l=n<e?1:-1;let r=a-i;for(;c(t,n),!(t===s&&n===e);){const d=r*2;d>-i&&(r-=i,t+=o),d<a&&(r+=a,n+=l)}}function bresenham_dense_line(t,n,s,e,c){t=~~t,s=~~s,n=~~n,e=~~e;const a=Math.abs(s-t),i=Math.abs(e-n),o=t<s?1:-1,l=n<e?1:-1;let r=a-i;for(;c(t,n),!(t===s&&n===e);){const d=r*2;d>-i&&(r-=i,t+=o),c(t,n),d<a&&(r+=a,n+=l)}}function draw_fill_without_pattern_support(t,n,s,e,c,a,i){const o=main_canvas.width,l=main_canvas.height;n=Math.max(0,Math.min(Math.floor(n),o)),s=Math.max(0,Math.min(Math.floor(s),l));const r=[[n,s]],d=t.getImageData(0,0,o,l);let h=(s*o+n)*4;const v=d.data[h+0],p=d.data[h+1],m=d.data[h+2],A=d.data[h+3];if(Math.abs(e-v)<=fill_threshold&&Math.abs(c-p)<=fill_threshold&&Math.abs(a-m)<=fill_threshold&&Math.abs(i-A)<=fill_threshold)return;for(;r.length;){let P,L,T,g,_;for(P=r.pop(),L=P[0],T=P[1],h=(T*o+L)*4;y(h);)T--,h=(T*o+L)*4;for(g=!1,_=!1;T++,h=(T*o+L)*4,!!(T<l&&y(h));)x(h),L>0&&(y(h-4)?g||(r.push([L-1,T]),g=!0):g&&(g=!1)),L<o-1&&(y(h+4)?_||(r.push([L+1,T]),_=!0):_&&(_=!1)),h+=o*4}t.putImageData(d,0,0);function y(P){return Math.abs(d.data[P+0]-v)<=fill_threshold&&Math.abs(d.data[P+1]-p)<=fill_threshold&&Math.abs(d.data[P+2]-m)<=fill_threshold&&Math.abs(d.data[P+3]-A)<=fill_threshold}function x(P){d.data[P+0]=e,d.data[P+1]=c,d.data[P+2]=a,d.data[P+3]=i}}function draw_fill(t,n,s,e){if(typeof e=="string"){const c=get_rgba_from_color(e);draw_fill_without_pattern_support(t,n,s,c[0],c[1],c[2],c[3])}else{const c=t.canvas,a=make_canvas(c.width,c.height);draw_fill_separately(t,a.ctx,n,s,255,255,255,255),replace_colors_with_swatch(a.ctx,e,0,0),t.drawImage(a,0,0)}}function draw_fill_separately(t,n,s,e,c,a,i,o){const l=main_canvas.width,r=main_canvas.height;s=Math.max(0,Math.min(Math.floor(s),l)),e=Math.max(0,Math.min(Math.floor(e),r));const d=[[s,e]],h=t.getImageData(0,0,l,r),v=n.getImageData(0,0,l,r);let p=(e*l+s)*4;const m=h.data[p+0],A=h.data[p+1],y=h.data[p+2],x=h.data[p+3];for(;d.length;){let T,g,_,u,b;for(T=d.pop(),g=T[0],_=T[1],p=(_*l+g)*4;P(p);)_--,p=(_*l+g)*4;for(u=!1,b=!1;_++,p=(_*l+g)*4,!!(_<r&&P(p));)L(p),g>0&&(P(p-4)?u||(d.push([g-1,_]),u=!0):u&&(u=!1)),g<l-1&&(P(p+4)?b||(d.push([g+1,_]),b=!0):b&&(b=!1)),p+=l*4}n.putImageData(v,0,0);function P(T){return v.data[T+3]===0&&Math.abs(h.data[T+0]-m)<=fill_threshold&&Math.abs(h.data[T+1]-A)<=fill_threshold&&Math.abs(h.data[T+2]-y)<=fill_threshold&&Math.abs(h.data[T+3]-x)<=fill_threshold}function L(T){v.data[T+0]=c,v.data[T+1]=a,v.data[T+2]=i,v.data[T+3]=o}}function replace_color_globally(t,n,s,e,c,a,i,o,l){if(n===a&&s===i&&e===o&&c===l)return;const{data:r}=t;for(let d=0;d<r.length;d+=4)Math.abs(r[d+0]-n)<=fill_threshold&&Math.abs(r[d+1]-s)<=fill_threshold&&Math.abs(r[d+2]-e)<=fill_threshold&&Math.abs(r[d+3]-c)<=fill_threshold&&(r[d+0]=a,r[d+1]=i,r[d+2]=o,r[d+3]=l)}function find_color_globally(t,n,s,e,c,a){const i=t.data,o=n.data;for(let l=0;l<i.length;l+=4)Math.abs(i[l+0]-s)<=fill_threshold&&Math.abs(i[l+1]-e)<=fill_threshold&&Math.abs(i[l+2]-c)<=fill_threshold&&Math.abs(i[l+3]-a)<=fill_threshold&&(o[l+0]=255,o[l+1]=255,o[l+2]=255,o[l+3]=255)}function draw_noncontiguous_fill_without_pattern_support(t,n,s,e,c,a,i){n=Math.max(0,Math.min(Math.floor(n),t.canvas.width)),s=Math.max(0,Math.min(Math.floor(s),t.canvas.height));const o=t.getImageData(0,0,t.canvas.width,t.canvas.height),l=(s*o.width+n)*4,r=o.data[l+0],d=o.data[l+1],h=o.data[l+2],v=o.data[l+3];replace_color_globally(o,r,d,h,v,e,c,a,i),t.putImageData(o,0,0)}function draw_noncontiguous_fill(t,n,s,e){if(typeof e=="string"){const c=get_rgba_from_color(e);draw_noncontiguous_fill_without_pattern_support(t,n,s,c[0],c[1],c[2],c[3])}else{const c=t.canvas,a=make_canvas(c.width,c.height);draw_noncontiguous_fill_separately(t,a.ctx,n,s),replace_colors_with_swatch(a.ctx,e,0,0),t.drawImage(a,0,0)}}function draw_noncontiguous_fill_separately(t,n,s,e){s=Math.max(0,Math.min(Math.floor(s),t.canvas.width)),e=Math.max(0,Math.min(Math.floor(e),t.canvas.height));const c=t.getImageData(0,0,t.canvas.width,t.canvas.height),a=n.getImageData(0,0,n.canvas.width,n.canvas.height),i=(e*c.width+s)*4,o=c.data[i+0],l=c.data[i+1],r=c.data[i+2],d=c.data[i+3];find_color_globally(c,a,o,l,r,d),n.putImageData(a,0,0)}function apply_image_transformation(t,n){const s=selection?selection.source_canvas:main_canvas,e=make_canvas(s.width,s.height),c=s.ctx,a=e.ctx;n(s,c,e,a),selection?undoable({name:`${t.name} (${localize("Selection")})`,icon:t.icon,soft:!0},()=>{selection.replace_source_canvas(e)}):(deselect(),cancel(),undoable({name:t.name,icon:t.icon},()=>{saved=!1,update_title(),main_ctx.copy(e),$canvas_area.trigger("resize")}))}function flip_horizontal(){apply_image_transformation({name:localize("Flip horizontal"),icon:get_help_folder_icon("p_fliph.png")},(t,n,s,e)=>{e.translate(s.width,0),e.scale(-1,1),e.drawImage(t,0,0)})}function flip_vertical(){apply_image_transformation({name:localize("Flip vertical"),icon:get_help_folder_icon("p_flipv.png")},(t,n,s,e)=>{e.translate(0,s.height),e.scale(1,-1),e.drawImage(t,0,0)})}function rotate(t){apply_image_transformation({name:`${localize("Rotate by angle")} ${t/TAU*360} ${localize("Degrees")}`,icon:get_help_folder_icon(`p_rotate_${t>=0?"cw":"ccw"}.png`)},(n,s,e,c)=>{switch(c.save(),t){case TAU/4:case TAU*-3/4:e.width=n.height,e.height=n.width,c.disable_image_smoothing(),c.translate(e.width,0),c.rotate(TAU/4);break;case TAU/2:case TAU/-2:c.translate(e.width,e.height),c.rotate(TAU/2);break;case TAU*3/4:case TAU/-4:e.width=n.height,e.height=n.width,c.disable_image_smoothing(),c.translate(0,e.height),c.rotate(TAU/-4);break;default:{const a=n.width,i=n.height;let o=1/0,l=-1/0,r=1/0,d=-1/0;const h=(y,x)=>{const P=Math.sin(-t)*i*y+Math.cos(+t)*a*x,L=Math.sin(+t)*a*x+Math.cos(-t)*i*y;o=Math.min(o,P),l=Math.max(l,P),r=Math.min(r,L),d=Math.max(d,L)};h(0,0),h(0,1),h(1,0),h(1,1);const v=o,p=r,m=l-o,A=d-r;e.width=m,e.height=A,c.disable_image_smoothing(),transparency||(c.fillStyle=selected_colors.background,c.fillRect(0,0,e.width,e.height)),c.translate(-v,-p),c.rotate(t),c.drawImage(n,0,0,a,i);break}}c.drawImage(n,0,0),c.restore()})}function stretch_and_skew(t,n,s,e){apply_image_transformation({name:s!==0||e!==0?t!==1||n!==1?localize("Stretch and Skew"):localize("Skew"):localize("Stretch"),icon:get_help_folder_icon(s!==0?"p_skew_h.png":e!==0?"p_skew_v.png":n!==1?t!==1?"p_stretch_both.png":"p_stretch_v.png":"p_stretch_h.png")},(c,a,i,o)=>{const l=c.width*t,r=c.height*n;let d=1/0,h=-1/0,v=1/0,p=-1/0;const m=(L,T)=>{const g=Math.tan(s)*r*L+l*T,_=Math.tan(e)*l*T+r*L;d=Math.min(d,g),h=Math.max(h,g),v=Math.min(v,_),p=Math.max(p,_)};m(0,0),m(0,1),m(1,0),m(1,1);const A=d,y=v,x=h-d,P=p-v;i.width=Math.max(1,x),i.height=Math.max(1,P),o.disable_image_smoothing(),transparency||(o.fillStyle=selected_colors.background,o.fillRect(0,0,i.width,i.height)),o.save(),o.transform(1,Math.tan(e),Math.tan(s),1,-A,-y),o.drawImage(c,0,0,l,r),o.restore()})}function invert_rgb(t,n=t){const s=t.getImageData(0,0,t.canvas.width,t.canvas.height);for(let e=0;e<s.data.length;e+=4)s.data[e+0]=255-s.data[e+0],s.data[e+1]=255-s.data[e+1],s.data[e+2]=255-s.data[e+2];n.putImageData(s,0,0)}function replace_colors_with_swatch(t,n,s=0,e=0){t.globalCompositeOperation="source-in",t.fillStyle=n,t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.save(),t.translate(-s,-e),t.fill(),t.restore()}function compute_bezier(t,n,s,e,c,a,i,o,l){const r=1-t,d=r*r,h=t*t;let v,p,m,A=0;return v=d*r,p=d*t*3,m=r*h*3,A=t*h,{x:v*n+p*e+m*a+A*o,y:v*s+p*c+m*i+A*l}}function draw_bezier_curve_without_pattern_support(t,n,s,e,c,a,i,o,l,r){let h={x:n,y:s};for(let v=0;v<1;v+=1/100){const p=compute_bezier(v,n,s,e,c,a,i,o,l);draw_line_without_pattern_support(t,h.x,h.y,p.x,p.y,r),h=p}}function draw_quadratic_curve(t,n,s,e,c,a,i,o){draw_bezier_curve(t,n,s,e,c,e,c,a,i,o)}function draw_bezier_curve(t,n,s,e,c,a,i,o,l,r){const d=Math.min(n,e,a,o),h=Math.min(s,c,i,l),v=Math.max(n,e,a,o),p=Math.max(s,c,i,l);draw_with_swatch(t,d,h,v,p,stroke_color,m=>{draw_bezier_curve_without_pattern_support(m,n,s,e,c,a,i,o,l,r)})}function draw_line(t,n,s,e,c,a){const i=Math.min(n,e),o=Math.min(s,c),l=Math.max(n,e),r=Math.max(s,c);draw_with_swatch(t,i,o,l,r,stroke_color,d=>{draw_line_without_pattern_support(d,n,s,e,c,a)})}let grid_pattern,grid_pattern_size=-1;function draw_grid(t,n){const s=Math.floor(n);if(!grid_pattern||grid_pattern_size!==s){grid_pattern_size=s;const e=make_canvas(s,s),c="#808080",a="#c0c0c0";e.ctx.fillStyle=c,e.ctx.fillRect(0,0,1,s),e.ctx.fillStyle=c,e.ctx.fillRect(0,0,s,1),e.ctx.fillStyle=a;for(let i=1;i<s;i+=2)e.ctx.fillRect(i,0,1,1),e.ctx.fillRect(0,i,1,1);grid_pattern=t.createPattern(e,"repeat")}t.save(),t.rect(0,0,t.canvas.width,t.canvas.height),n!==s&&t.translate(-.5,-.75),t.scale(n/s,n/s),t.enable_image_smoothing(),t.fillStyle=grid_pattern,t.fill(),t.restore()}const svg_for_creating_matrices=document.createElementNS("http://www.w3.org/2000/svg","svg"),horizontal_pattern_canvas=make_canvas(8,4),vertical_pattern_canvas=make_canvas(4,8);let horizontal_pattern,vertical_pattern;function draw_dashes(t,n,s,e,c,a,i,o){vertical_pattern||(horizontal_pattern_canvas.ctx.fillStyle="white",horizontal_pattern_canvas.ctx.fillRect(4,0,4,4),vertical_pattern_canvas.ctx.fillStyle="white",vertical_pattern_canvas.ctx.fillRect(0,4,4,4),horizontal_pattern=t.createPattern(horizontal_pattern_canvas,"repeat"),vertical_pattern=t.createPattern(vertical_pattern_canvas,"repeat"));const l=1,r=1/a;if(t.save(),t.scale(a,a),t.translate(i,o),t.translate(n,s),t.globalCompositeOperation="difference",e>0){const d=svg_for_creating_matrices.createSVGMatrix();horizontal_pattern.setTransform&&horizontal_pattern.setTransform(d.translate(-n,-s).translate(r,0).scale(1/a)),t.fillStyle=horizontal_pattern,t.fillRect(0,0,e,l)}else if(c>0){const d=svg_for_creating_matrices.createSVGMatrix();vertical_pattern.setTransform&&vertical_pattern.setTransform(d.translate(-n,-s).translate(0,r).scale(1/a)),t.fillStyle=vertical_pattern,t.fillRect(0,0,l,c)}t.restore()}function draw_selection_box(t,n,s,e,c,a,i,o){draw_dashes(t,n,s,e-1,0,a,i,o),c===1?draw_dashes(t,n,s,0,1,a,i,o):draw_dashes(t,n,s+1,0,c-2,a,i,o),draw_dashes(t,n+e-1,s,0,c,a,i,o),draw_dashes(t,n,s+c-1,e-1,0,a,i,o),draw_dashes(t,n,s+1,0,1,a,i,o)}let tessy,gl,positionLoc,op_canvas_webgl,op_canvas_2d,op_ctx_2d;function initTesselator(){function t(i,o){o[o.length]=i[0],o[o.length]=i[1]}function n(i){var o;i!==libtess.primitiveType.GL_TRIANGLES&&((o=window.console)==null||o.log(`Expected TRIANGLES but got type: ${i}`))}function s(i){var o,l;(o=window.console)==null||o.log("error callback"),(l=window.console)==null||l.log(`error number: ${i}`)}function e(i,o,l){return[i[0],i[1],i[2]]}function c(i){}const a=new libtess.GluTesselator;return a.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA,t),a.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN,n),a.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR,s),a.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE,e),a.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG,c),a}function triangulate(t){tessy.gluTessNormal(0,0,1);const n=[];tessy.gluTessBeginPolygon(n);for(let s=0;s<t.length;s++){tessy.gluTessBeginContour();const e=t[s];for(let c=0;c<e.length;c+=2){const a=[e[c],e[c+1],0];tessy.gluTessVertex(a,a)}tessy.gluTessEndContour()}return tessy.gluTessEndPolygon(),n}function initWebGL(t){try{gl=t.getContext("webgl",{antialias:!1})}catch(s){show_error_message$1("Failed to get WebGL context. You may need to refresh the web page, or restart your computer.",s);return}if(!gl){show_error_message$1("Failed to get WebGL context. You may need to refresh the web page, or restart your computer.");return}window.WEBGL_lose_context=gl.getExtension("WEBGL_lose_context");const n=createShaderProgram();positionLoc=gl.getAttribLocation(n,"position"),gl.enableVertexAttribArray(positionLoc)}function initArrayBuffer(t){const n=new Float32Array(t),s=gl.createBuffer();return gl.bindBuffer(gl.ARRAY_BUFFER,s),gl.bufferData(gl.ARRAY_BUFFER,n,gl.STATIC_DRAW),gl.vertexAttribPointer(positionLoc,2,gl.FLOAT,!1,0,0),t.length/2}function createShaderProgram(){var a,i;const t=["attribute vec4 position;","void main() {","	/* already in normalized coordinates, so just pass through */","	gl_Position = position;","}"].join(""),n=gl.createShader(gl.VERTEX_SHADER);gl.shaderSource(n,t),gl.compileShader(n),gl.getShaderParameter(n,gl.COMPILE_STATUS)||(a=window.console)==null||a.log(`Vertex shader failed to compile. Log: ${gl.getShaderInfoLog(n)}`);const s=["precision mediump float;","void main() {","	gl_FragColor = vec4(0, 0, 0, 1);","}"].join(""),e=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(e,s),gl.compileShader(e),gl.getShaderParameter(e,gl.COMPILE_STATUS)||(i=window.console)==null||i.log(`Fragment shader failed to compile. Log: ${gl.getShaderInfoLog(e)}`);const c=gl.createProgram();return gl.attachShader(c,n),gl.attachShader(c,e),gl.linkProgram(c),gl.useProgram(c),c}function init_webgl_stuff(){tessy=initTesselator(),op_canvas_webgl=document.createElement("canvas"),op_canvas_2d=document.createElement("canvas"),op_ctx_2d=op_canvas_2d.getContext("2d"),initWebGL(op_canvas_webgl);let t;op_canvas_webgl.addEventListener("webglcontextlost",n=>{var s;n.preventDefault(),(s=window.console)==null||s.warn("WebGL context lost"),clamp_brush_sizes(),t=setTimeout(()=>{show_error_message$1("The WebGL context was lost. You may need to refresh the web page, or restart your computer.")},3e3)},!1),op_canvas_webgl.addEventListener("webglcontextrestored",()=>{var n;initWebGL(op_canvas_webgl),(n=window.console)==null||n.warn("WebGL context restored"),clearTimeout(t),clamp_brush_sizes(),$G$1.triggerHandler("invalidate-brush-canvases"),$G$1.triggerHandler("redraw-tool-options-because-webglcontextrestored")},!1)}function clamp_brush_sizes(){brush_size>100&&(brush_size=100,show_error_message$1("Brush size clamped to 100")),pencil_size>100&&(pencil_size=100,show_error_message$1("Pencil size clamped to 100")),stroke_size>100&&(stroke_size=100,show_error_message$1("Stroke size clamped to 100"))}function draw_line_strip(t,n){draw_polygon_or_line_strip(t,n,!0,!1,!1)}function draw_polygon(t,n,s,e){draw_polygon_or_line_strip(t,n,s,e,!0)}function draw_polygon_or_line_strip(t,n,s,e,c){if(!gl){show_error_message$1("Failed to get WebGL context. You may need to refresh the web page, or restart your computer.");return}s&&stroke_size>1&&update_brush_for_drawing_lines(stroke_size);const a=t.strokeStyle,i=t.fillStyle,o=n.length,l=o*2;if(o===0)return;let r=1/0,d=-1/0,h=1/0,v=-1/0;for(const{x:m,y:A}of n)r=Math.min(m,r),d=Math.max(m,d),h=Math.min(A,h),v=Math.max(A,v);d+=1,v+=1,r-=1,h-=1,op_canvas_webgl.width=d-r,op_canvas_webgl.height=v-h,gl.viewport(0,0,op_canvas_webgl.width,op_canvas_webgl.height);const p=new Float32Array(l);for(let m=0;m<o;m++)p[m*2+0]=(n[m].x-r)/op_canvas_webgl.width*2-1,p[m*2+1]=1-(n[m].y-h)/op_canvas_webgl.height*2;if(e){const A=triangulate([p]);let y=initArrayBuffer(A);gl.clear(gl.COLOR_BUFFER_BIT),gl.drawArrays(gl.TRIANGLES,0,y),op_canvas_2d.width=op_canvas_webgl.width,op_canvas_2d.height=op_canvas_webgl.height,op_ctx_2d.drawImage(op_canvas_webgl,0,0),replace_colors_with_swatch(op_ctx_2d,i,r,h),t.drawImage(op_canvas_2d,r,h)}if(s)if(stroke_size>1){const m=~~(stroke_size*1.1),A=r-m,y=h-m;op_canvas_2d.width=d-r+m*2,op_canvas_2d.height=v-h+m*2;for(let x=0;x<o-(c?0:1);x++){const P=n[x],L=n[(x+1)%o];draw_line_without_pattern_support(op_ctx_2d,P.x-A,P.y-y,L.x-A,L.y-y,stroke_size)}replace_colors_with_swatch(op_ctx_2d,a,A,y),t.drawImage(op_canvas_2d,A,y)}else{let m=initArrayBuffer(p);gl.clear(gl.COLOR_BUFFER_BIT),gl.drawArrays(c?gl.LINE_LOOP:gl.LINE_STRIP,0,m),op_canvas_2d.width=op_canvas_webgl.width,op_canvas_2d.height=op_canvas_webgl.height,op_ctx_2d.drawImage(op_canvas_webgl,0,0),replace_colors_with_swatch(op_ctx_2d,a,r,h),t.drawImage(op_canvas_2d,r,h)}}function copy_contents_within_polygon(t,n,s,e,c,a){c=Math.max(c,s+1),a=Math.max(a,e+1);const i=c-s,o=a-e,l=make_canvas(t);l.ctx.save(),l.ctx.globalCompositeOperation="destination-in",draw_polygon(l.ctx,n,!1,!0),l.ctx.restore();const r=make_canvas(i,o);return r.ctx.drawImage(l,s,e,i,o,0,0,i,o),r}function draw_with_swatch(t,n,s,e,c,a,i){const o=~~(stroke_size*1.1);e=Math.max(e,n+1),c=Math.max(c,s+1),op_canvas_2d.width=e-n+o*2,op_canvas_2d.height=c-s+o*2;const l=n-o,r=s-o;op_ctx_2d.save(),op_ctx_2d.translate(-l,-r),i(op_ctx_2d),op_ctx_2d.restore(),replace_colors_with_swatch(op_ctx_2d,a,l,r),t.drawImage(op_canvas_2d,l,r)}console.log("JS ì¤í:","$FontBox.js");const eachFont=async(t,n)=>{function s(){FontDetective.each(t),FontDetective.all(n)}if(window.queryLocalFonts){let e;try{e=await window.queryLocalFonts()}catch(a){console.log("queryLocalFonts failed:",a,`
Falling back to FontDetective.`),s();return}if(e.length===0){console.log("queryLocalFonts returned no fonts; falling back to FontDetective."),s();return}const c=new Set;for(const a of e)c.has(a.family)||(c.add(a.family),t({name:a.family,toString(){return'"'+this.name.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}}));n()}else console.log("queryLocalFonts unavailable; falling back to FontDetective."),s()};function $FontBox(){const t=$(E("div")).addClass("font-box"),n=$(E("select")).addClass("inset-deep").attr({"aria-label":"Font Family","aria-description":localize("Selects the font used by the text.")}),s=$(E("input")).addClass("inset-deep").attr({type:"number",min:8,max:72,value:text_tool_font.size,"aria-label":"Font Size","aria-description":localize("Selects the point size of the text.")}).css({maxWidth:50}),e=$(E("span")).addClass("text-toolbar-button-group"),c=h(0,"bold","Bold",localize("Sets or clears the text bold attribute.")),a=h(1,"italic","Italic",localize("Sets or clears the text italic attribute.")),i=h(2,"underline","Underline",localize("Sets or clears the text underline attribute.")),o=h(3,"vertical","Vertical Writing Mode",localize("Only a Far East font can be used for vertical editing."));o.prop("disabled",!0),e.append(c,a,i,o),t.append(n,s,e);const l=()=>{text_tool_font.size=Number(s.val()),text_tool_font.family=n.val(),$G$1.trigger("option-changed")},r=text_tool_font.family;eachFont(v=>{const p=$(E("option"));p.val(v).text(v.name);const m=n.children("option");let A=0;for(;A<m.length&&!(m.eq(A).text().localeCompare(v.name)>0);A++);m.eq(A).length?m.eq(A).before(p):n.append(p),text_tool_font.family||l()},()=>{n.val(r),n.val()||n.val('"Liberation Sans"'),n.val()||n.val(n.children("option").eq(0).val()),l()}),text_tool_font.family&&n.val(text_tool_font.family),n.on("change",l),s.on("change",l);const d=$ToolWindow();return d.title(localize("Fonts")),d.$content.append(t),d.center(),d;function h(v,p,m,A){const y=$(E("button")).addClass("toggle").attr({"aria-pressed":!1,"aria-label":m,"aria-description":A}),x=$(E("span")).addClass("icon").appendTo(y);return y.css({width:23,height:22,padding:0,display:"inline-flex",alignContent:"center",alignItems:"center",justifyContent:"center"}),x.css({flex:"0 0 auto",display:"block",width:16,height:16,"--icon-index":v}),y.on("click",()=>{y.toggleClass("selected"),text_tool_font[p]=y.hasClass("selected"),y.attr("aria-pressed",y.hasClass("selected")?"true":"false"),l()}),text_tool_font[p]&&y.addClass("selected").attr("aria-pressed","true"),y}}console.log("JS ì¤í:","OnCanvasTextBox.js");class OnCanvasTextBox extends OnCanvasObject{constructor(n,s,e,c,a=""){super(n,s,e,c,!0),this.$el.addClass("textbox");var i=E("textarea");this.$editor=$(i).addClass("textbox-editor");var o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("version","1.1");var l=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");l.setAttribute("x","0"),l.setAttribute("y","0"),o.append(l),this.$editor.css({position:"absolute",left:"0",top:"0",right:"0",bottom:"0",padding:"0",margin:"0",border:"0",resize:"none",overflow:"hidden",minWidth:"3em"});var r=i.cloneNode(!1);l.append(r),i.value=a,this.canvas=make_canvas(e,c),this.canvas.style.pointerEvents="none",this.$el.append(this.canvas);const d=()=>{this.position(),this.$el.triggerHandler("update"),this.$editor.add(r).css({width:this.width,height:this.height})},h=()=>{i.style.height="",i.style.minHeight="0px",i.style.bottom="",i.setAttribute("rows","1"),this.height=Math.max(i.scrollHeight,this.height),i.removeAttribute("rows"),this.width=i.scrollWidth,i.style.bottom="0",d()},v=()=>{requestAnimationFrame(()=>{i.scrollTop=0});const P=text_tool_font,L=u=>`rgba(${get_rgba_from_color(u).join(", ")}`;for(P.color=L(selected_colors.foreground),P.background=tool_transparent_mode?"transparent":L(selected_colors.background),this.$editor.add(this.canvas).css({transform:`scale(${magnification})`,transformOrigin:"left top"}),this.$editor.add(r).css({width:this.width,height:this.height,fontFamily:P.family,fontSize:`${P.size}pt`,fontWeight:P.bold?"bold":"normal",fontStyle:P.italic?"italic":"normal",textDecoration:P.underline?"underline":"none",writingMode:P.vertical?"vertical-lr":"",MsWritingMode:P.vertical?"vertical-lr":"",WebkitWritingMode:P.vertical?"vertical-lr":"",lineHeight:`${P.size*P.line_scale}px`,color:P.color,background:P.background}),h();r.firstChild;)r.removeChild(r.firstChild);r.appendChild(document.createTextNode(i.value)),o.setAttribute("width",this.width.toString()),o.setAttribute("height",this.height.toString()),l.setAttribute("width",this.width.toString()),l.setAttribute("height",this.height.toString());var T=new XMLSerializer().serializeToString(o),g=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(T)}`,_=new Image;_.onload=()=>{this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.ctx.drawImage(_,0,0),update_helper_layer()},_.onerror=u=>{var b;(b=window.console)==null||b.log("Failed to load image",u)},_.src=g};$G$1.on("option-changed",this._on_option_changed=v),this.$editor.on("input",this._on_input=v),this.$editor.on("scroll",this._on_scroll=()=>{requestAnimationFrame(()=>{i.scrollTop=0})}),this.$el.css({cursor:make_css_cursor("move",[8,8],"move"),touchAction:"none"}),this.position(),this.$el.append(this.$editor),this.$editor[0].focus(),this.handles=new Handles({$handles_container:this.$el,$object_container:$canvas_area,outset:2,thick:!0,get_rect:()=>({x:this.x,y:this.y,width:this.width,height:this.height}),set_rect:({x:P,y:L,width:T,height:g})=>{this.x=P,this.y=L,this.width=T,this.height=g,this.position(),v(),this.canvas.width=T,this.canvas.height=g},constrain_rect:({x:P,y:L,width:T,height:g},_,u)=>{const b=this.x,S=this.y,M=this.width,R=this.height;return this.x=P,this.y=L,this.width=T,this.height=g,d(),h(),_===-1&&(P=Math.min(this.x,b+M-this.width)),u===-1&&(L=Math.min(this.y,S+R-this.height)),T=this.width,g=this.height,this.x=b,this.y=S,this.width=M,this.height=R,d(),{x:P,y:L,width:T,height:g}},get_ghost_offset_left:()=>parseFloat($canvas_area.css("padding-left"))+1,get_ghost_offset_top:()=>parseFloat($canvas_area.css("padding-top"))+1});let p,m;const A=P=>{const L=to_canvas_coords(P);this.x=Math.max(Math.min(L.x-p,main_canvas.width),-this.width),this.y=Math.max(Math.min(L.y-m,main_canvas.height),-this.height),this.position(),P.shiftKey};this.$el.on("pointerdown",P=>{if(P.target instanceof HTMLInputElement||P.target instanceof HTMLTextAreaElement||P.target.classList.contains("handle")||P.target.classList.contains("grab-region"))return;P.preventDefault();const L=this.$el[0].getBoundingClientRect(),T=P.clientX-L.left,g=P.clientY-L.top;p=~~(T/L.width*this.canvas.width),m=~~(g/L.height*this.canvas.height),this.dragging=!0,update_helper_layer(),$G$1.on("pointermove",A),$G$1.one("pointerup",()=>{$G$1.off("pointermove",A),this.dragging=!1,update_helper_layer()})}),$status_position.text(""),$status_size.text(""),$canvas_area.trigger("resize"),OnCanvasTextBox.$fontbox&&OnCanvasTextBox.$fontbox.closed&&(OnCanvasTextBox.$fontbox=null);const y=OnCanvasTextBox.$fontbox=OnCanvasTextBox.$fontbox||$FontBox(),x=()=>{const P=y[0].getBoundingClientRect(),L=this.$el[0].getBoundingClientRect();P.left<=L.right&&L.left<=P.right&&P.top<=L.bottom&&L.top<=P.bottom&&y.css({top:this.$el.position().top-y.height()}),y.applyBounds()};v(),x(),$(window).on("resize",this._on_window_resize=()=>{this.$editor[0].scrollIntoView({block:"nearest",inline:"nearest"}),x()})}position(){super.position(!0),update_helper_layer()}destroy(){super.destroy(),OnCanvasTextBox.$fontbox&&!OnCanvasTextBox.$fontbox.closed&&OnCanvasTextBox.$fontbox.close(),OnCanvasTextBox.$fontbox=null,$G$1.off("option-changed",this._on_option_changed),this.$editor.off("input",this._on_input),this.$editor.off("scroll",this._on_scroll),$(window).off("resize",this._on_window_resize),update_helper_layer()}}OnCanvasTextBox.$fontbox=null;console.log("JS ì¤í:","tool-options.js");const ChooserCanvas=(t,n,s,e,c,a,i,o,l,r,d,h,v)=>{const p=v(s,e);let m=ChooserCanvas.cache[t];m||(m=ChooserCanvas.cache[t]=E("img"),m.onerror=()=>{delete ChooserCanvas.cache[t]},m.src=t);const A=()=>{try{p.ctx.drawImage(m,c,a,i,o,l,r,d,h)}catch{}p.style.filter=n?"invert()":""};return $(m).on("load",A),A(),p};ChooserCanvas.cache={};const ChooserDiv=(t,n,s,e,c,a,i,o,l,r,d,h,v,p)=>{const m=v(s,e);m.classList.add(t),m.style.width=i+"px",m.style.height=o+"px";const A=()=>{const y=window.devicePixelRatio!==1;m.classList.toggle("use-svg",y),m.style.backgroundPosition=`${-c}px ${-a-(p?1:0)}px`};return m._on_zoom_etc&&$G$1.off("theme-load resize",m._on_zoom_etc),$G$1.on("theme-load resize",A),m._on_zoom_etc=A,A(),m.style.borderColor="transparent",m.style.borderStyle="solid",m.style.borderLeftWidth=l+"px",m.style.borderTopWidth=r+"px",m.style.borderRightWidth=s-l-d+"px",m.style.borderBottomWidth=e-r-h+"px",m.style.backgroundClip="content-box",m.style.filter=n?"invert()":"",m},$Choose=(t,n,s,e,c)=>{const a=$(E("div")).addClass("chooser").css("touch-action","none"),i=o=>{e(o)||(s(o),$G$1.trigger("option-changed"))};return a.on("update",()=>{if(!a.is(":visible"))return;a.empty();for(let r=0;r<t.length;r++)(d=>{const h=$(E("div")).addClass("chooser-option").appendTo(a);h.data("thing",d);const v=(A,y)=>{let x=h.find("canvas")[0];return x?(x.width!==A&&(x.width=A),x.height!==y&&(x.height=y)):(x=make_canvas(A,y),h.append(x)),x},p=(A,y)=>{let x=h.find("div")[0];return x?(x.style.width!==A+"px"&&(x.style.width=A+"px"),x.style.height!==y+"px"&&(x.style.height=y+"px")):(x=E("div"),x.style.width=A+"px",x.style.height=y+"px",h.append(x)),x},m=()=>{const A=getComputedStyle(a[0]).getPropertyValue("--Hilight"),y=c?"rgb(192, 192, 192)":"";h.css({backgroundColor:e(d)?A:y}),n(d,e(d),v,p)};m(),$G$1.on("option-changed theme-load redraw-tool-options-because-webglcontextrestored",m)})(t[r]);const o=r=>{const d=r.target.closest(".chooser-option");d&&i($(d).data("thing"))},l=r=>{const d=r.originalEvent.changedTouches[0],v=document.elementFromPoint(d.clientX,d.clientY).closest(".chooser-option");v&&i($(v).data("thing")),r.preventDefault()};a.on("pointerdown click",r=>{const d=r.target.closest(".chooser-option");d&&i($(d).data("thing")),r.type==="pointerdown"&&(a.on("pointerover",o),a.on("touchmove",l))}),$G$1.on("pointerup pointercancel",()=>{a.off("pointerover",o),a.off("touchmove",l)})}),a},$ChooseShapeStyle=()=>{const t=$Choose([{stroke:!0,fill:!1},{stroke:!0,fill:!0},{stroke:!1,fill:!0}],({stroke:n,fill:s},e,c)=>{const a=c(39,21),i=a.ctx;let o=5;const l=getComputedStyle(a);return i.fillStyle=e?l.getPropertyValue("--HilightText"):l.getPropertyValue("--WindowText"),n&&i.fillRect(o,o,a.width-o*2,a.height-o*2),o+=1,i.fillStyle=l.getPropertyValue("--ButtonShadow"),s?i.fillRect(o,o,a.width-o*2,a.height-o*2):i.clearRect(o,o,a.width-o*2,a.height-o*2),a},({stroke:n,fill:s})=>{t.stroke=n,t.fill=s},({stroke:n,fill:s})=>t.stroke===n&&t.fill===s).addClass("choose-shape-style");return t.fill=!1,t.stroke=!0,t},$choose_brush=$Choose((()=>{const t=["circle","square","reverse_diagonal","diagonal"],n=[7,4,1],s=[8,5,2],e=[];return t.forEach(c=>{(c==="circle"?n:s).forEach(i=>{e.push({shape:c,size:i})})}),e})(),(t,n,s)=>{const e=s(10,10),c=getComputedStyle(e),a=t.shape,i=t.size,o=n?c.getPropertyValue("--HilightText"):c.getPropertyValue("--WindowText");return stamp_brush_canvas(e.ctx,5,5,a,i),replace_colors_with_swatch(e.ctx,o),e},({shape:t,size:n})=>{brush_shape=t,brush_size=n},({shape:t,size:n})=>brush_shape===t&&brush_size===n).addClass("choose-brush"),$choose_eraser_size=$Choose([4,6,8,10],(t,n,s)=>{const e=s(39,16),c=getComputedStyle(e);return e.ctx.fillStyle=n?c.getPropertyValue("--HilightText"):c.getPropertyValue("--WindowText"),render_brush(e.ctx,"square",t),e},t=>{eraser_size=t},t=>eraser_size===t).addClass("choose-eraser"),$choose_stroke_size=$Choose([1,2,3,4,5],(t,n,s)=>{const i=s(39,12),o=(12-t)/2,l=getComputedStyle(i);return i.ctx.fillStyle=n?l.getPropertyValue("--HilightText"):l.getPropertyValue("--WindowText"),i.ctx.fillRect(5,~~o,39-5*2,t),i},t=>{stroke_size=t},t=>stroke_size===t).addClass("choose-stroke-size"),magnifications=[1,2,6,8,10],$choose_magnification=$Choose(magnifications,(t,n,s,e)=>{const c=magnifications.indexOf(t),a=t===10,i=ChooserDiv("magnification-option",n,39,a?2:13,c*23,0,23,9,8,2,23,9,e);return a&&$(i).addClass("secret-option"),i},t=>{set_magnification(t)},t=>t===magnification,!0).addClass("choose-magnification").css({position:"relative"});$choose_magnification.on("update",()=>{$choose_magnification.find(".secret-option").parent().css({position:"absolute",bottom:"-2px",left:0,opacity:0,height:2,overflow:"hidden"})});const airbrush_sizes=[9,16,24],$choose_airbrush_size=$Choose(airbrush_sizes,(t,n,s)=>{const c=airbrush_sizes.indexOf(t),a=airbrush_sizes.length,o=c===2?0:4,l=72/a-o*2,r=23,d=72/a*c+o;return ChooserCanvas("images/options-airbrush-size.png",n,l,r,d,0,l,r,0,0,l,r,s)},t=>{airbrush_size=t},t=>t===airbrush_size,!0).addClass("choose-airbrush-size"),$choose_transparent_mode=$Choose([!1,!0],(t,n,s,e)=>ChooserDiv("transparent-mode-option",!1,39,27,0,t?22:0,35,23,2,2,35,23,e,t),t=>{tool_transparent_mode=t},t=>t===tool_transparent_mode,!0).addClass("choose-transparent-mode");console.log("JS ì¤í:","tools.js");const TOOL_FREE_FORM_SELECT="TOOL_FREE_FORM_SELECT",TOOL_SELECT="TOOL_SELECT",TOOL_ERASER="TOOL_ERASER",TOOL_FILL="TOOL_FILL",TOOL_PICK_COLOR="TOOL_PICK_COLOR",TOOL_MAGNIFIER="TOOL_MAGNIFIER",TOOL_PENCIL="TOOL_PENCIL",TOOL_BRUSH="TOOL_BRUSH",TOOL_AIRBRUSH="TOOL_AIRBRUSH",TOOL_TEXT="TOOL_TEXT",TOOL_LINE="TOOL_LINE",TOOL_CURVE="TOOL_CURVE",TOOL_RECTANGLE="TOOL_RECTANGLE",TOOL_POLYGON="TOOL_POLYGON",TOOL_ELLIPSE="TOOL_ELLIPSE",TOOL_ROUNDED_RECTANGLE="TOOL_ROUNDED_RECTANGLE",tools=[{id:TOOL_FREE_FORM_SELECT,name:localize("Free-Form Select"),speech_recognition:["lasso","select with lasso","select by lassoing","lassoing","lasso select","freeform select","free-form select","free form select","polygonal select","polygon select","shape select","outline select","select by outline","select by outlining","star select","shape select","select by shape","select by drawing a shape","select by drawing shape","lasso selection","freeform selection","free-form selection","free form selection","polygonal selection","polygon selection","shape selection","outline selection","selection by outline","selection by outlining","star selection","shape selection","selection by shape","selection by drawing a shape","selection by drawing shape","lasso selecting","freeform selecting","free-form selecting","free form selecting","polygonal selecting","polygon selecting","shape selecting","outline selecting","selecting by outline","selecting by outlining","star selecting","shape selecting","selecting by shape","selecting by drawing a shape","selecting by drawing shape","lasso selector","freeform selector","free-form selector","free form selector","polygonal selector","polygon selector","shape selector","outline selector","by outline selector","outlining selector","star selector","shape selector","by shape selector","by drawing a shape selector","by drawing shape selector"],help_icon:"p_free.gif",description:localize("Selects a free-form part of the picture to move, copy, or edit."),cursor:["precise",[16,16],"crosshair"],preview_canvas:null,points:[],x_min:1/0,x_max:-1/0,y_min:1/0,y_max:-1/0,pointerdown(){this.x_min=pointer.x,this.x_max=pointer.x+1,this.y_min=pointer.y,this.y_max=pointer.y+1,this.points=[],this.preview_canvas=make_canvas(main_canvas.width,main_canvas.height),deselect()},paint(t,n,s){pointer.x=Math.min(main_canvas.width,pointer.x),pointer.x=Math.max(0,pointer.x),pointer.y=Math.min(main_canvas.height,pointer.y),pointer.y=Math.max(0,pointer.y),this.points.push(pointer),this.x_min=Math.min(pointer.x,this.x_min),this.x_max=Math.max(pointer.x,this.x_max),this.y_min=Math.min(pointer.y,this.y_min),this.y_max=Math.max(pointer.y,this.y_max),bresenham_line(pointer_previous.x,pointer_previous.y,pointer.x,pointer.y,(e,c)=>{this.ffs_paint_iteration(e,c)}),$status_size.text(`${this.x_max-this.x_min}x${this.y_max-this.y_min}`)},ffs_paint_iteration(t,n){t=Math.min(main_canvas.width,t),t=Math.max(0,t),n=Math.min(main_canvas.height,n),n=Math.max(0,n);const s=2,e=~~(t-s/2),c=~~(n-s/2),a=s,i=s,o=this.preview_canvas.ctx,l=main_ctx.getImageData(e,c,a,i),r=o.getImageData(e,c,a,i);for(let d=0,h=r.data.length;d<h;d+=4)r.data[d+0]=255-l.data[d+0],r.data[d+1]=255-l.data[d+1],r.data[d+2]=255-l.data[d+2],r.data[d+3]=255;o.putImageData(r,e,c)},pointerup(){this.preview_canvas.width=1,this.preview_canvas.height=1;const t=copy_contents_within_polygon(main_canvas,this.points,this.x_min,this.y_min,this.x_max,this.y_max);selection&&(show_error_message$1("This isn't supposed to happen: Free-Form Select after Select in the tool chain?"),meld_selection_into_canvas()),undoable({name:localize("Free-Form Select"),icon:get_icon_for_tool(get_tool_by_id(TOOL_FREE_FORM_SELECT)),soft:!0},()=>{selection=new OnCanvasSelection(this.x_min,this.y_min,this.x_max-this.x_min,this.y_max-this.y_min,t),selection.cut_out_background()})},cancel(){this.preview_canvas&&(this.preview_canvas.width=1,this.preview_canvas.height=1)},drawPreviewUnderGrid(t,n,s,e,c,a,i){!pointer_active&&!pointer_over_canvas||this.preview_canvas&&(t.scale(c,c),t.translate(a,i),t.drawImage(this.preview_canvas,0,0))},$options:$choose_transparent_mode},{id:TOOL_SELECT,name:localize("Select"),speech_recognition:[],help_icon:"p_sel.gif",description:localize("Selects a rectangular part of the picture to move, copy, or edit."),cursor:["precise",[16,16],"crosshair"],selectBox(t,n,s,e){if(s>1&&e>1){var c=selection;if(selection&&meld_selection_into_canvas(),ctrl)undoable({name:"Crop"},()=>{var h=make_canvas(s,e);h.ctx.drawImage(main_canvas,-t,-n),main_ctx.copy(h),canvas_handles.show(),$canvas_area.trigger("resize")});else if(c){var a=Math.min(c.x,t),i=Math.min(c.y,n),o=Math.max(c.x+c.width,t+s),l=Math.max(c.y+c.height,n+e),r=make_canvas(o-a,l-i),d=make_canvas(o-a,l-i);d.ctx.drawImage(main_canvas,t,n,s,e,t-a,n-i,s,e),r.ctx.drawImage(c.canvas,c.x-a,c.y-i),r.ctx.globalCompositeOperation="xor",r.ctx.drawImage(d,0,0),undoable({name:`${localize("Free-Form Select")}â${localize("Select")}`,icon:get_icon_for_tools([get_tool_by_id(TOOL_FREE_FORM_SELECT),get_tool_by_id(TOOL_SELECT)]),soft:!0},()=>{selection=new OnCanvasSelection(a,i,o-a,l-i,r),selection.cut_out_background()})}else undoable({name:localize("Select"),icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{selection=new OnCanvasSelection(t,n,s,e)})}},$options:$choose_transparent_mode},{id:TOOL_ERASER,name:localize("Eraser/Color Eraser"),speech_recognition:[],help_icon:"p_erase.gif",description:localize("Erases a portion of the picture, using the selected eraser shape."),cursor:["precise",[16,16],"crosshair"],mask_canvas:null,get_rect(t,n){const s=Math.ceil(t-eraser_size/2),e=Math.ceil(n-eraser_size/2),c=eraser_size,a=eraser_size;return{rect_x:s,rect_y:e,rect_w:c,rect_h:a}},drawPreviewUnderGrid(t,n,s,e,c,a,i){if(!pointer_active&&!pointer_over_canvas)return;const{rect_x:o,rect_y:l,rect_w:r,rect_h:d}=this.get_rect(n,s);t.scale(c,c),t.translate(a,i),this.mask_canvas&&this.render_from_mask(t,!0),t.fillStyle=selected_colors.background,t.fillRect(o,l,r,d)},drawPreviewAboveGrid(t,n,s,e,c,a,i){if(!pointer_active&&!pointer_over_canvas)return;const{rect_x:o,rect_y:l,rect_w:r,rect_h:d}=this.get_rect(n,s);t.scale(c,c),t.translate(a,i);const h=1/c;t.strokeStyle="black",t.lineWidth=h,e?t.strokeRect(o+t.lineWidth/2,l+t.lineWidth/2,r,d):t.strokeRect(o+t.lineWidth/2,l+t.lineWidth/2,r-t.lineWidth,d-t.lineWidth)},pointerdown(){this.mask_canvas=make_canvas(main_canvas.width,main_canvas.height)},render_from_mask(t,n){t.save(),t.globalCompositeOperation="destination-out",t.drawImage(this.mask_canvas,0,0),t.restore();let s=selected_colors.background;get_rgba_from_color(s)[3]<1&&(s=n?"rgba(255, 0, 0, 0.3)":selected_colors.background);const c=make_canvas(this.mask_canvas);replace_colors_with_swatch(c.ctx,s,0,0),t.drawImage(c,0,0)},pointerup(){this.mask_canvas&&undoable({name:get_language().match(/^en\b/)?this.color_eraser_mode?"Color Eraser":"Eraser":localize("Eraser/Color Eraser"),icon:get_icon_for_tool(this)},()=>{this.render_from_mask(main_ctx),this.mask_canvas=null})},cancel(){this.mask_canvas=null},paint(t,n,s){bresenham_line(pointer_previous.x,pointer_previous.y,pointer.x,pointer.y,(e,c)=>{this.eraser_paint_iteration(t,e,c)})},eraser_paint_iteration(t,n,s){const{rect_x:e,rect_y:c,rect_w:a,rect_h:i}=this.get_rect(n,s);if(this.color_eraser_mode=button!==0,!this.color_eraser_mode)this.mask_canvas.ctx.fillStyle="white",this.mask_canvas.ctx.fillRect(e,c,a,i);else{const o=get_rgba_from_color(selected_colors.foreground),l=t.getImageData(e,c,a,i),r=this.mask_canvas.ctx.getImageData(e,c,a,i),d=1;for(let h=0,v=l.data.length;h<v;h+=4)Math.abs(l.data[h+0]-o[0])<=d&&Math.abs(l.data[h+1]-o[1])<=d&&Math.abs(l.data[h+2]-o[2])<=d&&Math.abs(l.data[h+3]-o[3])<=d&&(r.data[h+0]=255,r.data[h+1]=255,r.data[h+2]=255,r.data[h+3]=255);this.mask_canvas.ctx.putImageData(r,e,c)}},$options:$choose_eraser_size},{id:TOOL_FILL,name:localize("Fill With Color"),speech_recognition:[],help_icon:"p_paint.gif",description:"Fills an area with the selected drawing color.",cursor:["fill-bucket",[8,22],"crosshair"],pointerdown(t,n,s){shift?undoable({name:"Replace Color",icon:get_icon_for_tool(this)},()=>{draw_noncontiguous_fill(t,n,s,fill_color)}):undoable({name:localize("Fill With Color"),icon:get_icon_for_tool(this)},()=>{draw_fill(t,n,s,fill_color)})}},{id:TOOL_PICK_COLOR,name:localize("Pick Color"),speech_recognition:[],help_icon:"p_eye.gif",description:localize("Picks up a color from the picture for drawing."),cursor:["eye-dropper",[9,22],"crosshair"],deselect:!0,current_color:"",display_current_color(){this.$options.css({background:this.current_color})},pointerdown(){$G$1.one("pointerup",()=>{this.$options.css({background:""})})},paint(t,n,s){if(n>=0&&s>=0&&n<main_canvas.width&&s<main_canvas.height){const e=t.getImageData(~~n,~~s,1,1),[c,a,i,o]=e.data;this.current_color=`rgba(${c},${a},${i},${o/255})`}else this.current_color="white";this.display_current_color()},pointerup(){selected_colors[pick_color_slot]=this.current_color,$G$1.trigger("option-changed")},$options:$(E("div"))},{id:TOOL_MAGNIFIER,name:localize("Magnifier"),speech_recognition:[],help_icon:"p_zoom.gif",description:localize("Changes the magnification."),cursor:["magnifier",[16,16],"zoom-in"],deselect:!1,getProspectiveMagnification:(t=1)=>{const n={.125:.25,.25:.5,.5:1,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:8},s={8:7,7:6,6:5,5:4,4:3,3:2,2:1,1:.5,.5:.125,.125:.125};return t==2?s[magnification]:n[magnification]},drawPreviewAboveGrid(t,n,s,e,c,a,i){if(!pointer_active&&!pointer_over_canvas||pointer_active)return;const o=this.getProspectiveMagnification();if(o<magnification?$canvas.css({cursor:make_css_cursor("magnifier",[16,16],"zoom-out")}):$canvas.css({cursor:make_css_cursor("magnifier",[16,16],"zoom-in")}),o<magnification)return;const l=$canvas_area.width()/o,r=$canvas_area.height()/o;let d=~~(n-l/2),h=~~(s-r/2);d=Math.max(0,d),h=Math.max(0,h),d=Math.min(main_canvas.width-l,d),h=Math.min(main_canvas.height-r,h);let v=d+l,p=h+r;d=Math.max(0,d),h=Math.max(0,h),v=Math.min(main_canvas.width,v),p=Math.min(main_canvas.height,p);const m=v-d,A=p-h,y=d,x=h,P=main_canvas.ctx.getImageData(y,x,m+1,A+1),L=t.getImageData((y+a)*c,(x+i)*c,m*c+1,A*c+1);function T(g,_){const u=~~(g/c),b=~~(_/c),S=(u+b*P.width)*4,M=(g+_*L.width)*4;L.data[M+0]=255-P.data[S+0],L.data[M+1]=255-P.data[S+1],L.data[M+2]=255-P.data[S+2],L.data[M+3]=255}for(let g=0,_=L.width;g<_;g+=1)T(g,0),T(g,L.height-1);for(let g=1,_=L.height-1;g<_;g+=1)T(0,g),T(L.width-1,g);t.putImageData(L,(y+a)*c,(x+i)*c)},pointerdown(t,n,s){const e=magnification,c=this.getProspectiveMagnification(button);if(set_magnification(c),magnification>e){const a=$canvas_area.width()/magnification,i=$canvas_area.height()/magnification;$canvas_area.scrollLeft((n-a/2)*magnification),$canvas_area.scrollTop((s-i/2)*magnification),$canvas_area.trigger("scroll")}},$options:$choose_magnification},{id:TOOL_PENCIL,name:localize("Pencil"),speech_recognition:[],help_icon:"p_pencil.gif",description:localize("Draws a free-form line one pixel wide."),cursor:["pencil",[13,23],"crosshair"],stroke_only:!0,get_brush(){return{size:pencil_size,shape:"circle"}}},{id:TOOL_BRUSH,name:localize("Brush"),speech_recognition:[],help_icon:"p_brush.gif",description:localize("Draws using a brush with the selected shape and size."),cursor:["precise-dotted",[16,16],"crosshair"],dynamic_preview_cursor:!0,get_brush(){return{size:brush_size,shape:brush_shape}},$options:$choose_brush},{id:TOOL_AIRBRUSH,name:localize("Airbrush"),speech_recognition:[],help_icon:"p_airb.gif",description:localize("Draws using an airbrush of the selected size."),cursor:["airbrush",[7,22],"crosshair"],paint_on_time_interval:5,paint_mask(t,n,s){const e=airbrush_size/2;for(let c=0;c<6+e/5;c++){const a=(Math.random()*2-1)*e,i=(Math.random()*2-1)*e;a*a+i*i<=e*e&&t.fillRect(n+~~a,s+~~i,1,1)}update_helper_layer()},$options:$choose_airbrush_size},{id:TOOL_TEXT,name:localize("Text"),speech_recognition:["text","type","typography","write","writing","words","text box","text-box","textbox","word","lettering","font","fonts","texts"],help_icon:"p_txt.gif",description:localize("Inserts text into the picture."),cursor:["precise",[16,16],"crosshair"],preload(){setTimeout(FontDetective.preload,10)},selectBox(t,n,s,e){s>1&&e>1&&(textbox=new OnCanvasTextBox(t,n,s,e))},$options:$choose_transparent_mode},{id:TOOL_LINE,name:localize("Line"),speech_recognition:["line","line segment","straight line","lines","line segments","straight lines"],help_icon:"p_line.gif",description:localize("Draws a straight line with the selected line width."),cursor:["precise",[16,16],"crosshair"],stroke_only:!0,shape(t,n,s,e,c){update_brush_for_drawing_lines(stroke_size),draw_line(t,n,s,n+e,s+c,stroke_size)},$options:$choose_stroke_size},{id:TOOL_CURVE,name:localize("Curve"),speech_recognition:["curve","curved line","curvy","curvy line","Bezier","Bezier curve","spline","curves","splines","curved","curving","wave","wavy line","rounded line","round line","oscilloscope","sine wave","cosine","cosine wave"],help_icon:"p_curve.gif",description:localize("Draws a curved line with the selected line width."),cursor:["precise",[16,16],"crosshair"],stroke_only:!0,points:[],preview_canvas:null,pointerup(t,n,s){this.points.length>=4&&(undoable({name:localize("Curve"),icon:get_icon_for_tool(this)},()=>{t.drawImage(this.preview_canvas,0,0)}),this.points=[],$status_size.text(""))},pointerdown(t,n,s){this.points.length<1?(this.preview_canvas=make_canvas(main_canvas.width,main_canvas.height),this.points.push({x:n,y:s}),$("body").hasClass("eye-gaze-mode")||this.points.push({x:n,y:s})):this.points.push({x:n,y:s})},paint(t,n,s){if(this.points.length<1)return;update_brush_for_drawing_lines(stroke_size);const e=this.points.length-1;this.points[e].x=n,this.points[e].y=s,this.preview_canvas.ctx.clearRect(0,0,this.preview_canvas.width,this.preview_canvas.height),this.preview_canvas.ctx.strokeStyle=stroke_color,this.points.length===4?draw_bezier_curve(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[2].x,this.points[2].y,this.points[3].x,this.points[3].y,this.points[1].x,this.points[1].y,stroke_size):this.points.length===3?draw_quadratic_curve(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[2].x,this.points[2].y,this.points[1].x,this.points[1].y,stroke_size):this.points.length===2?draw_line(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[1].x,this.points[1].y,stroke_size):draw_line(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[0].x,this.points[0].y,stroke_size);const c=n-this.points[0].x||1,a=s-this.points[0].y||1;$status_size.text(`${c} x ${a}px`)},drawPreviewUnderGrid(t,n,s,e,c,a,i){this.preview_canvas&&(t.scale(c,c),t.translate(a,i),this.points.length>=1&&t.drawImage(this.preview_canvas,0,0))},cancel(){this.points=[],$status_size.text("")},end(){this.points=[],update_helper_layer(),$status_size.text("")},$options:$choose_stroke_size},{id:TOOL_RECTANGLE,name:localize("Rectangle"),speech_recognition:["rectangle","square","box","rect","sharp rectangle","sharp square","sharp box","sharp rect","sharp corners rectangle","sharp corners square","sharp corners box","sharp corners rect","sharp cornered rectangle","sharp cornered square","sharp cornered box","sharp cornered rect","rectangle with sharp corners","square with sharp corners","box with sharp corners","rect with sharp corners","rectangles","squares","boxes","rects","sharp rectangles","sharp squares","sharp boxes","sharp rects","sharp corners rectangles","sharp corners squares","sharp corners boxes","sharp corners rects","sharp cornered rectangles","sharp cornered squares","sharp cornered boxes","sharp cornered rects","rectangles with sharp corners","squares with sharp corners","boxes with sharp corners","rects with sharp corners"],help_icon:"p_rect.gif",description:localize("Draws a rectangle with the selected fill style."),cursor:["precise",[16,16],"crosshair"],shape(t,n,s,e,c){e<0&&(n+=e,e=-e),c<0&&(s+=c,c=-c),this.$options.fill&&t.fillRect(n,s,e,c),this.$options.stroke&&(e<stroke_size*2||c<stroke_size*2?(t.save(),t.fillStyle=t.strokeStyle,t.fillRect(n,s,e,c),t.restore()):(t.save(),t.fillStyle=t.strokeStyle,t.fillRect(n,s,stroke_size,c),t.fillRect(n+e-stroke_size,s,stroke_size,c),t.fillRect(n,s,e,stroke_size),t.fillRect(n,s+c-stroke_size,e,stroke_size),t.restore()))},$options:$ChooseShapeStyle()},{id:TOOL_POLYGON,name:localize("Polygon"),speech_recognition:["polygon","poly","shape","n-gon","free-form polygon","freeform polygon","free form polygon","triangle","quadrangle","pentagon","hexagon","heptagon","octagon","nonagon","decagon","undecagon","dodecagon","polygons","polys","shapes","n-gons","free-form polygons","freeform polygons","free form polygons","triangles","quadrangles","pentagons","hexagons","heptagons","octagons","nonagons","decagons","undecagons","dodecagons"],help_icon:"p_poly.gif",description:localize("Draws a polygon with the selected fill style."),cursor:["precise",[16,16],"crosshair"],last_click_pointerdown:{x:-1/0,y:-1/0,time:-1/0},last_click_pointerup:{x:-1/0,y:-1/0,time:-1/0},points:[],preview_canvas:null,pointerup(t,n,s){if(this.points.length<1)return;const e=this.points.length-1;this.points[e].x=n,this.points[e].y=s;const c=this.points[e].x-this.points[0].x,a=this.points[e].y-this.points[0].y,i=Math.sqrt(c*c+a*a);$("body").hasClass("eye-gaze-mode")?this.points.length>=3&&i<stroke_size*10+20&&this.complete(t):i<stroke_size*5.1010101&&this.complete(t),this.last_click_pointerup={x:n,y:s,time:+new Date},this.updateStatus()},pointerdown(t,n,s){if(this.points.length<1)this.preview_canvas=make_canvas(main_canvas.width,main_canvas.height),this.points.push({x:n,y:s}),$("body").hasClass("eye-gaze-mode")||this.points.push({x:n,y:s});else{const e=this.last_click_pointerdown.x,c=this.last_click_pointerdown.y,a=this.last_click_pointerdown.time,i=n-e,o=s-c,l=+new Date-a;Math.sqrt(i*i+o*o)<4.1010101&&l<250?this.complete(t):this.points.push({x:n,y:s})}this.last_click_pointerdown={x:n,y:s,time:+new Date}},paint(t,n,s){if(this.points.length<1)return;const e=this.points.length-1;if(this.points[e].x=n,this.points[e].y=s,this.preview_canvas.ctx.clearRect(0,0,this.preview_canvas.width,this.preview_canvas.height),this.$options.fill&&!this.$options.stroke){this.preview_canvas.ctx.drawImage(main_canvas,0,0),this.preview_canvas.ctx.strokeStyle="white",this.preview_canvas.ctx.globalCompositeOperation="difference";var c=stroke_size;stroke_size=2,draw_line_strip(this.preview_canvas.ctx,this.points),stroke_size=c}else this.points.length>1?(this.preview_canvas.ctx.strokeStyle=stroke_color,draw_line_strip(this.preview_canvas.ctx,this.points)):draw_line(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[0].x,this.points[0].y,stroke_size);this.updateStatus()},drawPreviewUnderGrid(t,n,s,e,c,a,i){this.preview_canvas&&(t.scale(c,c),t.translate(a,i),t.drawImage(this.preview_canvas,0,0))},complete(t){this.points.length>=3&&undoable({name:localize("Polygon"),icon:get_icon_for_tool(this)},()=>{t.fillStyle=fill_color,t.strokeStyle=stroke_color;var n=stroke_size;this.$options.fill&&!this.$options.stroke&&(stroke_size=2,t.strokeStyle=fill_color),draw_polygon(t,this.points,this.$options.stroke||this.$options.fill&&!this.$options.stroke,this.$options.fill),stroke_size=n}),this.reset()},cancel(){this.reset()},end(t){this.complete(t),update_helper_layer()},updateStatus(){let t=1/0,n=-1/0,s=1/0,e=-1/0;for(const i of this.points)t=Math.min(i.x,t),n=Math.max(i.x,n),s=Math.min(i.y,s),e=Math.max(i.y,e);const c=n-t||1,a=e-s||1;$status_size.text(`${c} x ${a}px`)},reset(){$status_size.text(""),this.points=[],this.last_click_pointerdown={x:-1/0,y:-1/0,time:-1/0},this.last_click_pointerup={x:-1/0,y:-1/0,time:-1/0},this.preview_canvas&&(this.preview_canvas.width=1,this.preview_canvas.height=1)},shape_colors:!0,$options:$ChooseShapeStyle()},{id:TOOL_ELLIPSE,name:localize("Ellipse"),speech_recognition:["ellipse","circle","oval","ovoid","ovaloid","oviform","elliptical","oblong circle","stretched circle","ball","sphere","round tool","rounded tool","ellipses","circles","ovals","ovoids","ovaloids","oviforms","ellipticals","oblong circles","stretched circles","balls","spheres"],help_icon:"p_oval.gif",description:localize("Draws an ellipse with the selected fill style."),cursor:["precise",[16,16],"crosshair"],shape(t,n,s,e,c){e<0&&(n+=e,e=-e),c<0&&(s+=c,c=-c),e<stroke_size||c<stroke_size?(t.fillStyle=t.strokeStyle,draw_ellipse(t,n,s,e,c,!1,!0)):draw_ellipse(t,n+~~(stroke_size/2),s+~~(stroke_size/2),e-stroke_size,c-stroke_size,this.$options.stroke,this.$options.fill)},$options:$ChooseShapeStyle()},{id:TOOL_ROUNDED_RECTANGLE,name:localize("Rounded Rectangle"),speech_recognition:["rounded rectangle","rounded square","rounded box","round rectangle","round square","round box","rounded corners rectangle","rounded corners square","rounded corners box","round cornered rectangle","round cornered square","round cornered box","rounded cornered rectangle","rounded cornered square","rounded cornered box","rounded corner rectangle","rounded corner square","rounded corner box","rectangle with round corners","square with round corners","box with round corners","rectangle with rounded corners","square with rounded corners","box with rounded corners","soft rectangle","soft square","soft box","soft corners rectangle","soft corners square","soft corners box","soft cornered rectangle","soft cornered square","soft cornered box","soft corner rectangle","soft corner square","soft corner box","rectangle with soft corners","square with soft corners","box with soft corners","round rect","roundrect","rounded rectangles","rounded squares","rounded boxes","round rectangles","round squares","round boxes","rounded corners rectangles","rounded corners squares","rounded corners boxes","round cornered rectangles","round cornered squares","round cornered boxes","rounded cornered rectangles","rounded cornered squares","rounded cornered boxes","rounded corner rectangles","rounded corner squares","rounded corner boxes","rectangles with round corners","squares with round corners","boxes with round corners","rectangles with rounded corners","squares with rounded corners","boxes with rounded corners","soft rectangles","soft squares","soft boxes","soft corners rectangles","soft corners squares","soft corners boxes","soft cornered rectangles","soft cornered squares","soft cornered boxes","soft corner rectangles","soft corner squares","soft corner boxes","rectangles with soft corners","squares with soft corners","boxes with soft corners","round rects","roundrects"],help_icon:"p_rrect.gif",description:localize("Draws a rounded rectangle with the selected fill style."),cursor:["precise",[16,16],"crosshair"],shape(t,n,s,e,c){if(e<0&&(n+=e,e=-e),c<0&&(s+=c,c=-c),e<stroke_size||c<stroke_size){t.fillStyle=t.strokeStyle;const a=Math.min(8,e/2,c/2);draw_rounded_rectangle(t,n,s,e,c,a,a,!1,!0)}else{const a=Math.min(8,(e-stroke_size)/2,(c-stroke_size)/2);draw_rounded_rectangle(t,n+~~(stroke_size/2),s+~~(stroke_size/2),e-stroke_size,c-stroke_size,a,a,this.$options.stroke,this.$options.fill)}},$options:$ChooseShapeStyle()}];tools.forEach(t=>{if(t.selectBox){let n=0,s=0,e=!1,c=0,a=0,i=0,o=0;t.pointerdown=()=>{n=pointer.x,s=pointer.y,e=!1,$G$1.one("pointermove",()=>{e=!0}),selection&&meld_selection_into_canvas(),textbox&&meld_textbox_into_canvas(),canvas_handles.hide()},t.paint=()=>{c=~~Math.max(0,Math.min(n,pointer.x)),a=~~Math.max(0,Math.min(s,pointer.y)),i=~~Math.min(main_canvas.width,Math.max(n,pointer.x)+1)-c,o=~~Math.min(main_canvas.height,Math.max(s,pointer.y+1))-a,$status_size.text(`${i} x ${o}px`)},t.pointerup=()=>{canvas_handles.show(),t.selectBox(c,a,i,o)},t.cancel=()=>{canvas_handles.show()},t.drawPreviewUnderGrid=(l,r,d,h,v,p,m)=>{pointer_active&&e&&(l.scale(v,v),l.translate(p,m),l.drawImage(main_canvas,0,0))},t.drawPreviewAboveGrid=(l,r,d,h,v,p,m)=>{pointer_active&&e&&draw_selection_box(l,c,a,i,o,v,p,m)}}t.shape&&(t.shape_canvas=null,t.pointerdown=()=>{t.shape_canvas=make_canvas(main_canvas.width,main_canvas.height)},t.paint=()=>{t.shape_canvas.ctx.clearRect(0,0,t.shape_canvas.width,t.shape_canvas.height),t.shape_canvas.ctx.fillStyle=main_ctx.fillStyle,t.shape_canvas.ctx.strokeStyle=main_ctx.strokeStyle,t.shape_canvas.ctx.lineWidth=main_ctx.lineWidth,t.shape(t.shape_canvas.ctx,pointer_start.x,pointer_start.y,pointer.x-pointer_start.x,pointer.y-pointer_start.y);const n=pointer.x-pointer_start.x||1,s=pointer.y-pointer_start.y||1;$status_size.text(`${n} x ${s}px`)},t.pointerup=()=>{t.shape_canvas&&undoable({name:t.name,icon:get_icon_for_tool(t)},()=>{main_ctx.drawImage(t.shape_canvas,0,0),t.shape_canvas=null})},t.drawPreviewUnderGrid=(n,s,e,c,a,i,o)=>{pointer_active&&t.shape_canvas&&(n.scale(a,a),n.translate(i,o),n.drawImage(t.shape_canvas,0,0))}),t.paint_mask&&(t.mask_canvas=null,t.pointerdown=(n,s,e)=>{t.mask_canvas||(t.mask_canvas=make_canvas(main_canvas.width,main_canvas.height)),t.mask_canvas.width!==main_canvas.width&&(t.mask_canvas.width=main_canvas.width),t.mask_canvas.height!==main_canvas.height&&(t.mask_canvas.height=main_canvas.height),t.mask_canvas.ctx.disable_image_smoothing()},t.pointerup=()=>{t.mask_canvas&&undoable({name:t.name,icon:get_icon_for_tool(t)},()=>{t.render_from_mask(main_ctx),t.mask_canvas.width=1,t.mask_canvas.height=1})},t.paint=(n,s,e)=>{t.paint_mask(t.mask_canvas.ctx,s,e)},t.cancel=()=>{t.mask_canvas&&(t.mask_canvas.width=1,t.mask_canvas.height=1)},t.render_from_mask=(n,s)=>{n.save(),n.globalCompositeOperation="destination-out",n.drawImage(t.mask_canvas,0,0),n.restore();let e=stroke_color;const c=make_canvas(t.mask_canvas);return replace_colors_with_swatch(c.ctx,e,0,0),n.drawImage(c,0,0),!0},t.drawPreviewUnderGrid=(n,s,e,c,a,i,o)=>{!pointer_active&&!pointer_over_canvas||(n.scale(a,a),n.translate(i,o),t.mask_canvas&&t.render_from_mask(n,!0)&&requestAnimationFrame(()=>{update_helper_layer()}))}),t.get_brush&&(t.mask_canvas=null,t.init_mask_canvas=(n,s,e)=>{t.mask_canvas||(t.mask_canvas=make_canvas(main_canvas.width,main_canvas.height)),t.mask_canvas.width!==main_canvas.width&&(t.mask_canvas.width=main_canvas.width),t.mask_canvas.height!==main_canvas.height&&(t.mask_canvas.height=main_canvas.height),t.mask_canvas.ctx.disable_image_smoothing()},t.pointerdown=(n,s,e)=>{t.init_mask_canvas()},t.pointerup=()=>{undoable({name:t.name,icon:get_icon_for_tool(t)},()=>{t.render_from_mask(main_ctx),t.mask_canvas.width=1,t.mask_canvas.height=1})},t.paint=()=>{const n=t.get_brush(),s=get_circumference_points_for_brush(n.shape,n.size);t.mask_canvas.ctx.fillStyle=stroke_color,(n.size>1?bresenham_dense_line:bresenham_line)(pointer_previous.x,pointer_previous.y,pointer.x,pointer.y,(c,a)=>{for(const i of s)t.mask_canvas.ctx.fillStyle="white",t.mask_canvas.ctx.fillRect(c+i.x,a+i.y,1,1)})},t.cancel=()=>{t.mask_canvas&&(t.mask_canvas.width=1,t.mask_canvas.height=1)},t.render_from_mask=(n,s)=>{let e=stroke_color;const c=make_canvas(t.mask_canvas);if(s&&t.dynamic_preview_cursor){const a=t.get_brush();stamp_brush_canvas(c.ctx,pointer.x,pointer.y,a.shape,a.size)}return replace_colors_with_swatch(c.ctx,e,0,0),n.drawImage(c,0,0),!0},t.drawPreviewUnderGrid=(n,s,e,c,a,i,o)=>{if(!pointer_active&&!pointer_over_canvas)return;n.scale(a,a),n.translate(i,o),t.init_mask_canvas(),t.render_from_mask(n,!0)&&requestAnimationFrame(()=>{update_helper_layer()})})});window.TOOL_PENCIL=TOOL_PENCIL;console.log("JS ì¤í:","OnCanvasSelection.js");class OnCanvasSelection extends OnCanvasObject{constructor(n,s,e,c,a){super(n,s,e,c,!0),this.$el.addClass("selection");let i=tool_transparent_mode,o=selected_colors.background;this._on_option_changed=()=>{this.source_canvas&&(i!==tool_transparent_mode||o!==selected_colors.background)&&(i=tool_transparent_mode,o=selected_colors.background,this.update_tool_transparent_mode())},$G$1.on("option-changed",this._on_option_changed),this.instantiate(a)}position(){super.position(!0),update_helper_layer()}instantiate(n){this.$el.css({cursor:make_css_cursor("move",[8,8],"move"),touchAction:"none"}),this.position(),(()=>{n?(this.source_canvas=make_canvas(n),this.source_canvas.width!==this.width&&(this.source_canvas.width=this.width),this.source_canvas.height!==this.height&&(this.source_canvas.height=this.height),this.canvas=make_canvas(this.source_canvas)):(this.source_canvas=make_canvas(this.width,this.height),this.source_canvas.ctx.drawImage(main_canvas,this.x,this.y,this.width,this.height,0,0,this.width,this.height),this.canvas=make_canvas(this.source_canvas),this.cut_out_background()),this.$el.append(this.canvas),this.handles=new Handles({$handles_container:this.$el,$object_container:$canvas_area,outset:2,get_rect:()=>({x:this.x,y:this.y,width:this.width,height:this.height}),set_rect:({x:i,y:o,width:l,height:r})=>{undoable({name:"Resize Selection",icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{this.x=i,this.y=o,this.width=l,this.height=r,this.position(),this.resize()})},get_ghost_offset_left:()=>parseFloat($canvas_area.css("padding-left"))+1,get_ghost_offset_top:()=>parseFloat($canvas_area.css("padding-top"))+1});let e,c;const a=i=>{make_or_update_undoable({match:o=>i.shiftKey&&/^(Smear|Stamp|Move) Selection$/.test(o.name)||!i.shiftKey&&/^Move Selection$/.test(o.name),name:i.shiftKey?"Smear Selection":"Move Selection",update_name:!0,icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{const o=to_canvas_coords(i);this.x=Math.max(Math.min(o.x-e,main_canvas.width),-this.width),this.y=Math.max(Math.min(o.y-c,main_canvas.height),-this.height),this.position(),i.shiftKey&&this.draw()})};this.canvas_pointerdown=i=>{i.preventDefault();const o=this.canvas.getBoundingClientRect(),l=i.clientX-o.left,r=i.clientY-o.top;e=~~(l/o.width*this.canvas.width),c=~~(r/o.height*this.canvas.height),$G$1.on("pointermove",a),this.dragging=!0,update_helper_layer(),$G$1.one("pointerup",()=>{$G$1.off("pointermove",a),this.dragging=!1,update_helper_layer()}),i.shiftKey?undoable({name:"Stamp Selection",icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{this.draw()}):i.ctrlKey&&undoable({name:"Stamp Selection",icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{this.draw()})},$(this.canvas).on("pointerdown",this.canvas_pointerdown),$canvas_area.trigger("resize"),$status_position.text(""),$status_size.text("")})()}cut_out_background(){const n=this.canvas,s=main_ctx.getImageData(this.x,this.y,this.width,this.height),e=n.ctx.getImageData(0,0,this.width,this.height),c=make_canvas(n);replace_colors_with_swatch(c.ctx,selected_colors.background,this.x,this.y);for(let a=0;a<e.data.length;a+=4)e.data[a+3]>0?(e.data[a+0]=s.data[a+0],e.data[a+1]=s.data[a+1],e.data[a+2]=s.data[a+2],e.data[a+3]=s.data[a+3],s.data[a+0]=0,s.data[a+1]=0,s.data[a+2]=0,s.data[a+3]=0):(e.data[a+0]=0,e.data[a+1]=0,e.data[a+2]=0,e.data[a+3]=0);main_ctx.putImageData(s,this.x,this.y),n.ctx.putImageData(e,0,0),this.update_tool_transparent_mode(),(!transparency||tool_transparent_mode)&&main_ctx.drawImage(c,this.x,this.y),$G$1.triggerHandler("session-update"),update_helper_layer()}update_tool_transparent_mode(){const n=this.source_canvas.ctx.getImageData(0,0,this.width,this.height),s=this.canvas.ctx.createImageData(this.width,this.height),e=get_rgba_from_color(selected_colors.background),c=1;for(let a=0;a<s.data.length;a+=4){let i=n.data[a+3]>1;tool_transparent_mode&&Math.abs(n.data[a+0]-e[0])<=c&&Math.abs(n.data[a+1]-e[1])<=c&&Math.abs(n.data[a+2]-e[2])<=c&&Math.abs(n.data[a+3]-e[3])<=c&&(i=!1),i&&(s.data[a+0]=n.data[a+0],s.data[a+1]=n.data[a+1],s.data[a+2]=n.data[a+2],s.data[a+3]=n.data[a+3])}this.canvas.ctx.putImageData(s,0,0),update_helper_layer()}replace_source_canvas(n){this.source_canvas=n;const s=make_canvas(n);$(this.canvas).replaceWith(s),this.canvas=s;const e=this.x+this.width/2,c=this.y+this.height/2,a=s.width,i=s.height;this.x=~~(e-a/2),this.y=~~(c-i/2),this.width=a,this.height=i,this.position(),$(this.canvas).on("pointerdown",this.canvas_pointerdown),this.$el.triggerHandler("resize"),this.update_tool_transparent_mode()}resize(){const n=make_canvas(this.width,this.height);n.ctx.drawImage(this.source_canvas,0,0,this.width,this.height),this.replace_source_canvas(n)}scale(n){const s=Math.max(1,this.width*n),e=Math.max(1,this.height*n),c=make_canvas(s,e);c.ctx.drawImage(this.source_canvas,0,0,c.width,c.height),this.replace_source_canvas(c)}draw(){try{main_ctx.drawImage(this.canvas,this.x,this.y)}catch{}}destroy(){super.destroy(),$G$1.off("option-changed",this._on_option_changed),update_helper_layer()}}console.log("JS ì¤í:","color-data.js");const default_palette=["rgb(0,0,0)","rgb(128,128,128)","rgb(128,0,0)","rgb(128,128,0)","rgb(0,128,0)","rgb(0,128,128)","rgb(0,0,128)","rgb(128,0,128)","rgb(128,128,64)","rgb(0,64,64)","rgb(0,128,255)","rgb(0,64,128)","rgb(64,0,255)","rgb(128,64,0)","rgb(128,64,0,0.1)","rgb(128,64,0,0.2)","rgb(255,255,255)","rgb(192,192,192)","rgb(255,0,0)","rgb(255,255,0)","rgb(0,255,0)","rgb(0,255,255)","rgb(0,0,255)","rgb(255,0,255)","rgb(255,255,128)","rgb(0,255,128)","rgb(128,255,255)","rgb(128,128,255)","rgb(255,0,128)","rgb(255,128,64)","rgb(128,64,0,0.3)","rgb(128,64,0,0)"],basic_colors=["#FF8080","#FFFF80","#80FF80","#00FF80","#80FFFF","#0080FF","#FF80C0","#FF80FF","#FF0000","#FFFF00","#80FF00","#00FF40","#00FFFF","#0080C0","#8080C0","#FF00FF","#804040","#FF8040","#00FF00","#008080","#004080","#8080FF","#800040","#FF0080","#800000","#FF8000","#008000","#008040","#0000FF","#0000A0","#800080","#8000FF","#400000","#804000","#004000","#004040","#000080","#000040","#400040","#400080","#000000","#808000","#808040","#808080","#408080","#C0C0C0","#400040","#FFFFFF"],custom_colors=["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"];window.default_palette=default_palette;console.log("JS ì¤í:","file-format-data.js");let image_formats=[];const add_image_format=(t,n,s=image_formats)=>{const e={formatID:t,mimeType:t,name:localize(n).replace(/\s+\([^(]+$/,""),nameWithExtensions:localize(n),extensions:[]},c=/\*\.([^);,]+)/g;if(get_direction()==="rtl"){const i="â",o="â";e.nameWithExtensions=e.nameWithExtensions.replace(c,`${i}*.${o}$1${i}`)}let a;for(;a=c.exec(n);){const i=a[1];e.extensions.push(i)}s.push(e)};add_image_format("image/png","PNG (*.png)");add_image_format("image/webp","WebP (*.webp)");add_image_format("image/gif","GIF (*.gif)");add_image_format("image/tiff","TIFF (*.tif;*.tiff)");add_image_format("image/jpeg","JPEG (*.jpg;*.jpeg;*.jpe;*.jfif)");add_image_format("image/x-bmp-1bpp","Monochrome Bitmap (*.bmp;*.dib)");add_image_format("image/x-bmp-4bpp","16 Color Bitmap (*.bmp;*.dib)");add_image_format("image/x-bmp-8bpp","256 Color Bitmap (*.bmp;*.dib)");add_image_format("image/bmp","24-bit Bitmap (*.bmp;*.dib)");const formats_unique_per_file_extension=t=>(t=t.filter(n=>n.extensions.includes("bmp")?n.mimeType==="image/bmp":!0),t.filter((n,s)=>!n.extensions.some(e=>t.some((c,a)=>a<s&&c.extensions.includes(e))))),palette_formats=[];console.log("AnyPalette:",AnyPalette);for(const[t,n]of Object.entries(AnyPalette.formats))if(n.write){const s=n.fileExtensions.map(e=>`*.${e}`).join(";");palette_formats.push({formatID:t,name:n.name,nameWithExtensions:`${n.name} (${s})`,extensions:n.fileExtensions})}palette_formats.sort((t,n)=>+(n.formatID==="RIFF_PALETTE")-+(t.formatID==="RIFF_PALETTE")||+(n.formatID==="GIMP_PALETTE")-+(t.formatID==="GIMP_PALETTE")||0);window.formats_unique_per_file_extension=formats_unique_per_file_extension;console.log("JS ì¤í:","storage.js");const localStore={get(t,n){let s;try{if(typeof t=="string"){const e=t,c=localStorage.getItem(e);c&&(s=JSON.parse(c))}else if(s={},Array.isArray(t)){const e=t;for(let c=0,a=e.length;c<a;c++){const i=e[c],o=localStorage.getItem(i);o&&(s[i]=JSON.parse(o))}}else{const e=t;for(const c in e){let a=e[c];const i=localStorage.getItem(c);i?s[c]=JSON.parse(i):s[c]=a}}}catch(e){n(e);return}n(null,s)},set(t,n,s){let e={};if(typeof t=="string")e={[t]:n};else{if(Array.isArray(t))throw new TypeError("Cannot set an array of keys (to what?)");e=t,s=n}for(const c in e){const a=e[c];try{localStorage.setItem(c,JSON.stringify(a))}catch(i){i.quotaExceeded=i.code===22||i.name==="NS_ERROR_DOM_QUOTA_REACHED"||i.number===-2147024882,s(i);return}}return s(null)}};console.log("JS ì¤í:","functions.js");const param_types={"eye-gaze-mode":"bool","vertical-color-box-mode":"bool","speech-recognition-mode":"bool",local:"string",session:"string",load:"string"},exclusive_params=["local","session","load"];function get_all_url_params(){const t={};location.hash.replace(/^#/,"").split(/,/).forEach(n=>{const s=n.indexOf(":");if(s===-1){const e=n;t[e]=!0}else{const e=n.slice(0,s),c=n.slice(s+1);t[e]=decodeURIComponent(c)}});for(const[n,s]of Object.entries(param_types))s==="bool"&&!t[n]&&(t[n]=!1);return t}function change_url_param(t,n,{replace_history_state:s=!1}={}){change_some_url_params({[t]:n},{replace_history_state:s})}function change_some_url_params(t,{replace_history_state:n=!1}={}){for(const s of exclusive_params)t[s]&&exclusive_params.forEach(e=>{e!==s&&(t[e]=null)});set_all_url_params(Object.assign({},get_all_url_params(),t),{replace_history_state:n})}function set_all_url_params(t,{replace_history_state:n=!1}={}){let s="";for(const[a,i]of Object.entries(param_types))t[a]&&(s.length&&(s+=","),s+=encodeURIComponent(a),i!=="bool"&&(s+=":"+encodeURIComponent(t[a])));let e=location.search;e.includes("frame_id")||(e="");const c=`${location.origin}${location.pathname}${e}#${s}`;try{n?history.replaceState(null,document.title,c):history.pushState(null,document.title,c)}catch{location.hash=s}$G$1.triggerHandler("change-url-params")}function update_magnified_canvas_size(){$canvas.css("width",main_canvas.width*magnification),$canvas.css("height",main_canvas.height*magnification),update_canvas_rect()}function update_canvas_rect(){window.canvas_bounding_client_rect=main_canvas.getBoundingClientRect(),update_helper_layer()}let helper_layer_update_queued=!1,info_for_updating_pointer;function update_helper_layer(t){t&&isFinite(t.clientX)&&(info_for_updating_pointer={clientX:t.clientX,clientY:t.clientY,devicePixelRatio}),!helper_layer_update_queued&&(helper_layer_update_queued=!0,requestAnimationFrame(()=>{helper_layer_update_queued=!1,update_helper_layer_immediately()}))}function update_helper_layer_immediately(){if(info_for_updating_pointer){const d=info_for_updating_pointer.devicePixelRatio/devicePixelRatio;info_for_updating_pointer.clientX*=d,info_for_updating_pointer.clientY*=d,info_for_updating_pointer.devicePixelRatio=devicePixelRatio,pointer=to_canvas_coords(info_for_updating_pointer)}const t=magnification*window.devicePixelRatio;helper_layer||(helper_layer=new OnCanvasHelperLayer(0,0,main_canvas.width,main_canvas.height,!1,t));const n=15,s=Math.floor(Math.max($canvas_area.scrollLeft()/magnification-n,0)),e=Math.floor(Math.max($canvas_area.scrollTop()/magnification-n,0)),c=Math.floor(Math.min(s+$canvas_area.width()/magnification+n*2,main_canvas.width)),a=Math.floor(Math.min(e+$canvas_area.height()/magnification+n*2,main_canvas.height)),i=c-s,o=a-e,l=i*t,r=o*t;if((helper_layer.canvas.width!==l||helper_layer.canvas.height!==r)&&(helper_layer.canvas.width=l,helper_layer.canvas.height=r,helper_layer.canvas.ctx.disable_image_smoothing(),helper_layer.width=i,helper_layer.height=o),helper_layer.x=s,helper_layer.y=e,helper_layer.position(),render_canvas_view(helper_layer.canvas,t,s,e,!0),thumbnail_canvas&&$thumbnail_window.is(":visible")){const d=parseFloat($canvas_area.css("padding-left")),h=parseFloat($canvas_area.css("padding-top")),v=main_canvas.clientWidth+d-$canvas_area[0].clientWidth,p=main_canvas.clientHeight+h-$canvas_area[0].clientHeight;let m=$canvas_area[0].scrollLeft/Math.max(1,v),A=$canvas_area[0].scrollTop/Math.max(1,p);m=Math.min(m,1),A=Math.min(A,1);let y=Math.floor(Math.max(m*(main_canvas.width-thumbnail_canvas.width),0)),x=Math.floor(Math.max(A*(main_canvas.height-thumbnail_canvas.height),0));render_canvas_view(thumbnail_canvas,1,y,x,!1)}}function render_canvas_view(t,n,s,e,c){update_fill_and_stroke_colors_and_lineWidth(selected_tool);const a=show_grid&&magnification>=4&&window.devicePixelRatio*magnification>=4&&c,i=t.ctx;i.clearRect(0,0,t.width,t.height),c||i.drawImage(main_canvas,s,e,t.width,t.height,0,0,t.width,t.height);var o=[...selected_tools];$("body").hasClass("dragging")&&!pointer_active&&(o=o.filter(r=>r.id===TOOL_CURVE||r.id===TOOL_POLYGON)),o.sort((r,d)=>r.selectBox&&!d.selectBox?-1:!r.selectBox&&d.selectBox?1:0);var l=o.findIndex(r=>r.selectBox);l>=0&&(o=o.filter((r,d)=>!r.selectBox||d==l)),o.forEach(r=>{r.drawPreviewUnderGrid&&pointer&&pointers.length<2&&(i.save(),r.drawPreviewUnderGrid(i,pointer.x,pointer.y,a,n,-s,-e),i.restore())}),selection&&(i.save(),i.scale(n,n),i.translate(-s,-e),i.drawImage(selection.canvas,selection.x,selection.y),i.restore(),!c&&!selection.dragging&&draw_selection_box(i,selection.x,selection.y,selection.width,selection.height,n,-s,-e)),textbox&&(i.save(),i.scale(n,n),i.translate(-s,-e),i.drawImage(textbox.canvas,textbox.x,textbox.y),i.restore(),!c&&!textbox.dragging&&draw_selection_box(i,textbox.x,textbox.y,textbox.width,textbox.height,n,-s,-e)),a&&draw_grid(i,n),o.forEach(r=>{r.drawPreviewAboveGrid&&pointer&&pointers.length<2&&(i.save(),r.drawPreviewAboveGrid(i,pointer.x,pointer.y,a,n,-s,-e),i.restore())})}function update_disable_aa(){const t=window.devicePixelRatio*magnification,n=Math.floor(t)===t;$canvas_area.toggleClass("disable-aa-for-things-at-main-canvas-scale",t>=3||n)}function set_magnification(t,n){window.$zoomText.text(t==.125?"12.50%":`${t*100}%`),n=n??{x:$canvas_area.scrollLeft()/magnification,y:$canvas_area.scrollTop()/magnification};const s=from_canvas_coords(n);magnification=t,t!==1&&(return_to_magnification=t),update_magnified_canvas_size();const e=from_canvas_coords(n);$canvas_area[0].scrollBy({left:e.clientX-s.clientX,top:e.clientY-s.clientY,behavior:"instant"}),$G$1.triggerHandler("resize"),$G$1.trigger("option-changed"),$G$1.trigger("magnification-changed")}function reset_selected_colors(){selected_colors={foreground:"#000000",background:"#ffffff",ternary:""},$G$1.trigger("option-changed")}function reset_file(){system_file_handle=null,file_name=localize("untitled"),file_format="image/png",saved=!0,update_title()}function reset_canvas_and_history(){undos.length=0,redos.length=0,current_history_node=root_history_node=make_history_node({name:localize("New"),icon:get_help_folder_icon("p_blank.png")}),history_node_to_cancel_to=null,main_canvas.width=Math.max(1,my_canvas_width),main_canvas.height=Math.max(1,my_canvas_height),main_ctx.disable_image_smoothing(),main_ctx.fillStyle=selected_colors.background,main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height),current_history_node.image_data=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height),$canvas_area.trigger("resize"),$G$1.triggerHandler("history-update")}function make_history_node({parent:t=null,futures:n=[],timestamp:s=Date.now(),soft:e=!1,image_data:c=null,selection_image_data:a=null,selection_x:i,selection_y:o,textbox_text:l,textbox_x:r,textbox_y:d,textbox_width:h,textbox_height:v,text_tool_font:p=null,tool_transparent_mode:m=!1,foreground_color:A,background_color:y,ternary_color:x,name:P,icon:L=null}){return{parent:t,futures:n,timestamp:s,soft:e,image_data:c,selection_image_data:a,selection_x:i,selection_y:o,textbox_text:l,textbox_x:r,textbox_y:d,textbox_width:h,textbox_height:v,text_tool_font:p,tool_transparent_mode:m,foreground_color:A,background_color:y,ternary_color:x,name:P,icon:L}}function update_title(){document.title=`${file_name} - ${is_pride_month?"June Solidarity ":""}${localize("Paint")}`,is_pride_month&&$("link[rel~='icon']").attr("href","./images/icons/gay-es-paint-16x16-light-outline.png"),window.setRepresentedFilename&&window.setRepresentedFilename(system_file_handle??""),window.setDocumentEdited&&window.setDocumentEdited(!saved)}function get_uris(t){const n=t.split(/[\n\r]+/).filter(e=>e[0]!=="#"&&e);if(n.length>15)return[];const s=[];for(let e=0;e<n.length;e++)try{const c=new URL(n[e]);s.push(c.href)}catch{}return s}async function load_image_from_uri(t){const n=t.match(/^blob:/i),s=!t.match(/^(blob|data|file):/i),e=t.match(/^(http|https):\/\/((127\.0\.0\.1|localhost)|.*(\.(local|localdomain|domain|lan|home|host|corp|invalid)))\b/i);if(n&&t.indexOf(`blob:${location.origin}`)===-1){const o=new Error("can't load blob: URI from another domain");throw o.code="cross-origin-blob-uri",o}const c=s&&!e?[t,`https://cors.bridged.cc/${t}`,`https://jspaint-cors-proxy.herokuapp.com/${t}`,`https://web.archive.org/${t}`]:[t],a=[];for(let o=0;o<c.length;o+=1){const l=c[o];try{const r=({loaded:m,total:A})=>{};s&&console.log(`Try loading image from URI (${o+1}/${c.length}): "${l}"`);const d=await fetch(l);let h=d;if(!d.ok){a.push({status:d.status,statusText:d.statusText,url:l});continue}if(!d.body)s&&console.log("ReadableStream not yet supported in this browser. Progress won't be shown for image requests.");else{const m=d.headers.get("content-encoding"),A=d.headers.get(m?"x-file-size":"content-length");if(A===null)s&&console.log("Response size header unavailable. Progress won't be shown for this image request.");else{const y=parseInt(A,10);let x=0;h=new Response(new ReadableStream({start(P){const L=d.body.getReader();T();function T(){L.read().then(({done:g,value:_})=>{if(g){P.close();return}x+=_.byteLength,r({loaded:x,total:y}),P.enqueue(_),T()}).catch(g=>{console.error(g),P.error(g)})}}}))}}const v=await h.blob();return s&&console.log("Download complete."),await new Promise((m,A)=>{read_image_file(v,(y,x)=>{y?A(y):m(x)})})}catch(r){a.push({url:l,error:r})}}const i=new Error(`failed to fetch image from any of ${c.length} URI(s):
  ${a.map(o=>(o.statusText?`${o.status} ${o.statusText} `:"")+o.url+(o.error?`
    ${o.error}`:"")).join(`
  `)}`);throw i.code="access-failure",i.fails=a,i}function open_from_image_info(t,n,s,e,c){are_you_sure$1(({canvas_modified_while_loading:a}={})=>{deselect(),cancel(),e||($G$1.triggerHandler("session-update"),new_local_session()),reset_file(),reset_selected_colors(),reset_canvas_and_history(),set_magnification(default_magnification),main_ctx.copy(t.image||t.image_data),apply_file_format_and_palette_info(t),transparency=has_any_transparency(main_ctx),$canvas_area.trigger("resize"),current_history_node.name=localize("Open"),current_history_node.image_data=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height),current_history_node.icon=get_help_folder_icon("p_open.png"),(a||!c)&&$G$1.triggerHandler("session-update"),$G$1.triggerHandler("history-update"),t.source_blob instanceof File&&(file_name=t.source_blob.name,system_file_handle=t.source_blob.path),t.source_file_handle&&(system_file_handle=t.source_file_handle),saved=!0,update_title(),n==null||n()},s,c)}function open_from_file(t,n){if(t instanceof File&&t.name.match(/\.theme(pack)?$/i)){t.text().then(load_theme_from_text,s=>{show_error_message$1(localize("Paint cannot open this file."),s)});return}read_image_file(t,(s,e)=>{if(s){AnyPalette.loadPalette(t,(c,a)=>{var i;if(c){show_file_format_errors({as_image_error:s,as_palette_error:c});return}palette=a.map(o=>o.toString()),$colorbox.rebuild_palette(),(i=window.console)==null||i.log(`Loaded palette: ${palette.map(()=>"%câ").join("")}`,...palette.map(o=>`color: ${o};`))});return}e.source_file_handle=n,open_from_image_info(e)})}function apply_file_format_and_palette_info(t){var n;file_format=t.file_format,enable_palette_loading_from_indexed_images&&(t.palette?((n=window.console)==null||n.log(`Loaded palette from image file: ${t.palette.map(()=>"%câ").join("")}`,...t.palette.map(s=>`color: ${s};`)),palette=t.palette,selected_colors.foreground=palette[0],selected_colors.background=palette.length===14*2?palette[14]:palette[1],$G$1.trigger("option-changed")):monochrome&&!t.monochrome&&(palette=default_palette,reset_selected_colors()),$colorbox.rebuild_palette(),monochrome=t.monochrome)}function load_theme_from_text(t){var n=parseThemeFileString(t);if(!n){show_error_message$1(localize("Paint cannot open this file."));return}applyCSSProperties(n,{recurseIntoIframes:!0}),window.themeCSSProperties=n,$G$1.triggerHandler("theme-load")}function file_new(){are_you_sure$1(()=>{deselect(),cancel(),$G$1.triggerHandler("session-update"),new_local_session(),reset_file(),reset_selected_colors(),reset_canvas_and_history(),set_magnification(default_magnification),$G$1.triggerHandler("session-update")})}async function file_open(){const{file:t,fileHandle:n}=await systemHooks.showOpenFileDialog({formats:image_formats});open_from_file(t,n)}let acknowledged_overwrite_capability=!1;const confirmed_overwrite_key="jspaint confirmed overwrite capable";try{acknowledged_overwrite_capability=localStorage[confirmed_overwrite_key]==="true"}catch(t){acknowledged_overwrite_capability=Date.now()>=2e12}async function confirm_overwrite_capability(){if(acknowledged_overwrite_capability)return!0;const{$window:t,promise:n}=showMessageBox$1({messageHTML:`
			<p>JS Paint can now save over existing files.</p>
			<p>Do you want to overwrite the file?</p>
			<p>
				<input type="checkbox" id="do-not-ask-me-again-checkbox"/>
				<label for="do-not-ask-me-again-checkbox">Don't ask me again</label>
			</p>
		`,buttons:[{label:localize("Yes"),value:"overwrite",default:!0},{label:localize("Cancel"),value:"cancel"}]});if(await n==="overwrite"){acknowledged_overwrite_capability=t.$content.find("#do-not-ask-me-again-checkbox").prop("checked");try{localStorage[confirmed_overwrite_key]=acknowledged_overwrite_capability}catch{}return!0}return!1}function file_save(t=()=>{},n=!0){deselect();const s=system_file_handle;if(!s||file_name.match(/\.(svg|pdf)$/i))return file_save_as(t,n);write_image_file(main_canvas,file_format,async e=>{const c=await systemHooks.writeBlobToHandle(s,e);c===!0&&(saved=!0,update_title()),c!==!1&&(n&&update_from_saved_file(e),t())})}function file_save_as(t=()=>{},n=!0){deselect(),systemHooks.showSaveFileDialog({dialogTitle:localize("Save As"),formats:image_formats,defaultFileName:file_name,defaultPath:typeof system_file_handle=="string"?system_file_handle:null,defaultFileFormatID:file_format,getBlob:s=>new Promise(e=>{write_image_file(main_canvas,s,c=>{e(c)})}),savedCallbackUnreliable:({newFileName:s,newFileFormatID:e,newFileHandle:c,newBlob:a})=>{saved=!0,system_file_handle=c,file_name=s,file_format=e,update_title(),t(),n&&update_from_saved_file(a)}})}function are_you_sure$1(t,n,s){saved?t():s?showMessageBox$1({message:localize(`You've modified the document while an existing document was loading.
Save the new document?`,file_name),buttons:[{label:localize("Yes"),value:"save",default:!0},{label:localize("No"),value:"discard"}]}).then(e=>{e==="save"?file_save(()=>{t()},!1):e==="discard"?t({canvas_modified_while_loading:!0}):t()}):showMessageBox$1({message:localize("Save changes to %1?",file_name),buttons:[{label:localize("Yes"),value:"save",default:!0},{label:localize("No"),value:"discard"},{label:localize("Cancel"),value:"cancel"}]}).then(e=>{e==="save"?file_save(()=>{t()},!1):e==="discard"?t():n==null||n()})}function please_enter_a_number(){showMessageBox$1({message:localize("Please enter a number.")})}function show_error_message$1(t,n){var e,c,a,i;const{$message:s}=showMessageBox$1({iconID:"error",message:t});if(n){const o=$("<details><summary><span>Details</span></summary></details>").appendTo(s),l=n;let r=l.stack;if(r)l.message&&r.indexOf(l.message)===-1?r=`${n.toString()}

${r}`:l.name&&r.indexOf(l.name)===-1&&(r=`${l.name}

${r}`);else if(r=n.toString(),r==="[object Object]")try{r=JSON.stringify(n,null,2)}catch(d){r="Error details could not be stringified: "+d}$(E("pre")).text(r).appendTo(o).css({background:"white",color:"#333",fontFamily:"monospace",width:"500px",maxWidth:"100%",overflow:"auto"})}n?(c=(e=window.console)==null?void 0:e.error)==null||c.call(e,t,n):(i=(a=window.console)==null?void 0:a.error)==null||i.call(a,t)}function show_resource_load_error_message(t){const{$window:n,$message:s}=showMessageBox$1({}),e=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;t.code==="cross-origin-blob-uri"?s.html(`
			<p>Can't load image from address starting with "blob:".</p>
			${e?'<p>Try "Copy Image" instead of "Copy Image Location".</p>':'<p>Try "Copy image" instead of "Copy image address".</p>'}
		`):t.code==="html-not-image"?s.html(`
			<p>Address points to a web page, not an image file.</p>
			<p>Try copying and pasting an image instead of a URL.</p>
		`):t.code==="decoding-failure"?s.html(`
			<p>Address doesn't point to an image file of a supported format.</p>
			<p>Try copying and pasting an image instead of a URL.</p>
		`):t.code==="access-failure"?navigator.onLine?(s.html(`
				<p>Failed to download image.</p>
				<p>Try copying and pasting an image instead of a URL.</p>
			`),t.fails&&$("<ul>").append(t.fails.map(({status:c,statusText:a,url:i})=>$("<li>").text(i).prepend($("<b>").text(`${c||""} ${a||"Failed"} `)))).appendTo(s)):s.html(`
				<p>Failed to download image.</p>
				<p>You're offline. Connect to the internet and try again.</p>
				<p>Or copy and paste an image instead of a URL, if possible.</p>
			`):s.html(`
			<p>Failed to load image from URL.</p>
			<p>Check your browser's devtools for details.</p>
		`),s.css({maxWidth:"500px"}),n.center()}function show_file_format_errors({as_image_error:t,as_palette_error:n}){let s=`
		<p>${localize("Paint cannot open this file.")}</p>
	`;t&&(s+=`
			<details>
				<summary>${localize("Bitmap Image")}</summary>
				<p>${localize("This is not a valid bitmap file, or its format is not currently supported.")}</p>
			</details>
		`);var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};const c=o=>String(o).replace(/[&<>"'`=/]/g,l=>e[l]),a=o=>o.charAt(0).toUpperCase()+o.slice(1),i=n&&!t;if(n){let o="";"errors"in n?o=`<ul dir="ltr">${n.errors.map(l=>{const r=l.__PATCHED_LIB_TO_ADD_THIS__format;return r&&l.error?`<li><b>${c(`${r.name}`)}</b>: ${c(a(l.error.message))}</li>`:`<li>${c(l.message||l)}</li>`}).join(`
`)}</ul>`:o=`<p>${c(n.message||n)}</p>`,s+=`
			<details>
				<summary>${i?"Details":localize("Palette|*.pal|").split("|")[0]}</summary>
				<p>${localize("Unexpected file format.")}</p>
				${o}
			</details>
		`}showMessageBox$1({messageHTML:s})}let $about_paint_window;const $about_paint_content=$("#about-paint"),$this_version_news=$("#news");let $latest_news=$this_version_news;location.origin!=="https://jspaint.app"&&$this_version_news.prepend($("<p>For the latest news, visit <a href='https://jspaint.app'>jspaint.app</a></p>").css({padding:"8px 15px"}));function show_about_paint(){$about_paint_window&&$about_paint_window.close(),$about_paint_window=$Window({title:localize("About Paint"),resizable:!1,maximizeButton:!1,minimizeButton:!1}),$about_paint_window.addClass("about-paint squish"),is_pride_month&&$("#about-paint-icon").attr("src","./images/icons/gay-es-paint-128x128.png"),$about_paint_window.$content.append($about_paint_content.show()).css({padding:"15px"}),$("#jspaint-update-status-area").removeAttr("hidden"),$("#failed-to-check-if-outdated").attr("hidden","hidden"),$("#outdated").attr("hidden","hidden"),$about_paint_window.$Button(localize("OK"),()=>{$about_paint_window.close()}).attr("id","close-about-paint").focus().css({float:"right",marginBottom:"10px"}),$("#refresh-to-update").on("click",n=>{n.preventDefault(),are_you_sure$1(()=>{exit_fullscreen_if_ios$1(),location.reload()})}),$about_paint_window.css({left:-innerWidth,top:-innerHeight}),$about_paint_window.center(),$("#checking-for-updates").removeAttr("hidden");const t="https://jspaint.app/?news";fetch(t).then(n=>n.text()).then(n=>{const e=new DOMParser().parseFromString(n,"text/html");$latest_news=$(e).find("#news");const c=$latest_news.find(".news-entry"),a=$this_version_news.find(".news-entry");if(!c.length)throw $latest_news=$this_version_news,new Error(`No news found at fetched site (${t})`);function i(r,d){return r.get().some(h=>d===h.id)}const o=c.get().filter(r=>!i(a,r.id)),l=a.get().filter(r=>!i(c,r.id));o.length>0?$("#outdated").removeAttr("hidden"):l.length>0&&($latest_news=$this_version_news),$("#checking-for-updates").attr("hidden","hidden"),update_css_classes_for_conditional_messages()}).catch(n=>{var s;$("#failed-to-check-if-outdated").removeAttr("hidden"),$("#checking-for-updates").attr("hidden","hidden"),update_css_classes_for_conditional_messages(),(s=window.console)==null||s.log("Couldn't check for updates.",n)})}function exit_fullscreen_if_ios$1(){if($("body").hasClass("ios"))try{document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}catch{}}function update_css_classes_for_conditional_messages(){$(".on-dev-host, .on-third-party-host, .on-official-host").hide(),location.hostname.match(/localhost|127.0.0.1/)?$(".on-dev-host").show():location.hostname.match(/jspaint.app/)?$(".on-official-host").show():$(".on-third-party-host").show(),$(".navigator-online, .navigator-offline").hide(),navigator.onLine?$(".navigator-online").show():$(".navigator-offline").show()}function paste_image_from_file(t){read_image_file(t,(n,s)=>{if(n){show_file_format_errors({as_image_error:n});return}paste(s.image||make_canvas(s.image_data))})}async function choose_file_to_paste(){const{file:t}=await systemHooks.showOpenFileDialog({formats:image_formats});if(t.type.match(/^image|application\/pdf/)){paste_image_from_file(t);return}show_error_message$1(localize("This is not a valid bitmap file, or its format is not currently supported."))}function paste(t){if(t.width>main_canvas.width||t.height>main_canvas.height){const s=localize("The image in the clipboard is larger than the bitmap.")+`
`+localize("Would you like the bitmap enlarged?");showMessageBox$1({message:s,iconID:"question",windowOptions:{icons:{16:"images/windows-16x16.png",32:"images/windows-32x32.png"}},buttons:[{label:localize("Yes"),value:"enlarge",default:!0},{label:localize("No"),value:"crop"},{label:localize("Cancel"),value:"cancel"}]}).then(e=>{e==="enlarge"?(resize_canvas_and_save_dimensions(Math.max(main_canvas.width,t.width),Math.max(main_canvas.height,t.height),{name:"Enlarge Canvas For Paste",icon:get_help_folder_icon("p_stretch_both.png")}),n(),$canvas_area.trigger("resize")):e==="crop"&&n()})}else n();function n(){deselect(),select_tool(get_tool_by_id(TOOL_SELECT));const s=Math.max(0,Math.ceil($canvas_area.scrollLeft()/magnification)),e=Math.max(0,Math.ceil($canvas_area.scrollTop()/magnification));undoable({name:localize("Paste"),icon:get_help_folder_icon("p_paste.png"),soft:!0},()=>{selection=new OnCanvasSelection(s,e,t.width,t.height,t)})}}function go_to_history_node(t,n){var i;const s=current_history_node;if(!t.image_data){n||(show_error_message$1("History entry has no image data."),(i=window.console)==null||i.log("Target history entry has no image data:",t));return}if(current_history_node=t,deselect(!0),n||cancel(!0),saved=!1,update_title(),main_ctx.copy(t.image_data),t.selection_image_data&&(selection&&selection.destroy(),t.name===localize("Free-Form Select")?select_tool(get_tool_by_id(TOOL_FREE_FORM_SELECT)):select_tool(get_tool_by_id(TOOL_SELECT)),selection=new OnCanvasSelection(t.selection_x,t.selection_y,t.selection_image_data.width,t.selection_image_data.height,t.selection_image_data)),t.textbox_text!=null){textbox&&textbox.destroy();for(const[o,l]of Object.entries(t.text_tool_font))text_tool_font[o]=l;selected_colors.foreground=t.foreground_color,selected_colors.background=t.background_color,tool_transparent_mode=t.tool_transparent_mode,$G$1.trigger("option-changed"),select_tool(get_tool_by_id(TOOL_TEXT)),textbox=new OnCanvasTextBox(t.textbox_x,t.textbox_y,t.textbox_width,t.textbox_height,t.textbox_text)}const e=get_history_ancestors(t);undos=[...e],undos.reverse();const c=redos.length>0?[redos[0],...get_history_ancestors(redos[0])]:[s,...get_history_ancestors(s)];redos.length=0;let a=t;for(;a.futures.length>0;){const o=[...a.futures];o.sort((l,r)=>c.indexOf(l)>-1?-1:c.indexOf(r)>-1?1:0),a=o[0],redos.unshift(a)}$canvas_area.trigger("resize"),$G$1.triggerHandler("session-update"),$G$1.triggerHandler("history-update")}function undoable({name:t,icon:n,use_loose_canvas_changes:s,soft:e,assume_saved:c},a){var r;c||(saved=!1,update_title());const i=current_history_node;a==null||a(),current_history_node!==i&&(show_error_message$1(`History node switched during undoable callback for ${t}. This shouldn't happen.`),(r=window.console)==null||r.log(`History node switched during undoable callback for ${t}, from`,i,"to",current_history_node));const o=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height);redos.length=0,undos.push(current_history_node);const l=make_history_node({image_data:o,selection_image_data:selection&&selection.canvas.ctx.getImageData(0,0,selection.canvas.width,selection.canvas.height),selection_x:selection&&selection.x,selection_y:selection&&selection.y,textbox_text:textbox&&textbox.$editor.val(),textbox_x:textbox&&textbox.x,textbox_y:textbox&&textbox.y,textbox_width:textbox&&textbox.width,textbox_height:textbox&&textbox.height,text_tool_font:JSON.parse(JSON.stringify(text_tool_font)),tool_transparent_mode,foreground_color:selected_colors.foreground,background_color:selected_colors.background,ternary_color:selected_colors.ternary,parent:current_history_node,name:t,icon:n,soft:e});current_history_node.futures.push(l),current_history_node=l,$G$1.triggerHandler("history-update"),$G$1.triggerHandler("session-update")}function make_or_update_undoable(t,n){current_history_node.futures.length===0&&t.match(current_history_node)?(n(),current_history_node.image_data=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height),current_history_node.selection_image_data=selection&&selection.canvas.ctx.getImageData(0,0,selection.canvas.width,selection.canvas.height),current_history_node.selection_x=selection&&selection.x,current_history_node.selection_y=selection&&selection.y,t.update_name&&(current_history_node.name=t.name),$G$1.triggerHandler("history-update")):undoable(t,n)}function undo(){if(undos.length<1)return!1;redos.push(current_history_node);let t=undos.pop();for(;t.soft&&undos.length;)redos.push(t),t=undos.pop();return go_to_history_node(t),!0}let $document_history_prompt_window;function redo(){if(redos.length<1)return $document_history_prompt_window&&$document_history_prompt_window.close(),(!$document_history_window||$document_history_window.closed)&&($document_history_prompt_window=showMessageBox$1({title:"Redo",messageHTML:"To view all branches of the history tree, click <b>Edit > History</b>.",iconID:"info"}).$window),!1;undos.push(current_history_node);let t=redos.pop();for(;t.soft&&redos.length;)undos.push(t),t=redos.pop();return go_to_history_node(t),!0}function get_history_ancestors(t){const n=[];for(t=t.parent;t;t=t.parent)n.push(t);return n}let $document_history_window;function show_document_history(){$document_history_prompt_window&&$document_history_prompt_window.close(),$document_history_window&&$document_history_window.close();const t=$document_history_window=$Window({title:"Document History",resizable:!1,maximizeButton:!1,minimizeButton:!1});t.addClass("history-window squish"),t.$content.html(`
		<label>
			<select id="history-view-mode" class="inset-deep">
				<option value="linear">Linear timeline</option>
				<option value="tree">Tree</option>
			</select>
		</label>
		<div class="history-view" tabIndex="0"></div>
	`);const n=t.$content.find(".history-view");n.focus();let s=0,e=[],c,a=t.$content.find("#history-view-mode");a.css({margin:"10px"});let i=a.val();a.on("change",()=>{i=a.val(),l()});function o(d){const h=$(`
			<div class="history-entry">
				<div class="history-entry-icon-area"></div>
				<div class="history-entry-name"></div>
			</div>
		`);if(h.find(".history-entry-name").text((d.name||"Unknown")+(d===root_history_node?" (Start of History)":"")),h.find(".history-entry-icon-area").append(d.icon),i==="tree"){let v=0;for(let p=d.parent;p;p=p.parent)v++;h.css({marginInlineStart:`${v*8}px`})}d===current_history_node?(h.addClass("current"),c=h,requestAnimationFrame(()=>{n[0].scrollTop=Math.min(h[0].offsetTop,Math.max(s,h[0].offsetTop-n[0].clientHeight+h.outerHeight()))})):get_history_ancestors(current_history_node).indexOf(d)>-1&&h.addClass("ancestor-of-current");for(const v of d.futures)o(v);h.on("click",()=>{go_to_history_node(d)}),h.history_node=d,e.push(h)}const l=()=>{s=n.scrollTop(),n.empty(),e=[],o(root_history_node),i==="linear"?e.sort((d,h)=>d.history_node.timestamp<h.history_node.timestamp?-1:h.history_node.timestamp<d.history_node.timestamp?1:0):e.reverse(),e.forEach(d=>{n.append(d)})};l();const r=d=>{const v=e.indexOf(c)+d;e[v]&&e[v].click()};n.on("keydown",d=>{!d.ctrlKey&&!d.altKey&&!d.shiftKey&&!d.metaKey&&(d.key==="ArrowDown"||d.key==="Down"?(r(1),d.preventDefault()):(d.key==="ArrowUp"||d.key==="Up")&&(r(-1),d.preventDefault()))}),$G$1.on("history-update",l),t.on("close",()=>{$G$1.off("history-update",l)}),t.center()}function cancel(t,n){var e;if(!history_node_to_cancel_to)return;const s=n&&current_history_node.parent&&current_history_node!==history_node_to_cancel_to&&current_history_node.futures.length===0?current_history_node:null;$G$1.triggerHandler("pointerup",["canceling",n]);for(const c of selected_tools)(e=c.cancel)==null||e.call(c);if(!t&&(go_to_history_node(history_node_to_cancel_to,!0),s)){const c=s.parent.futures.indexOf(s);c===-1?(show_error_message$1("History node not found. Please report this bug."),console.log("history_node_to_discard",s),console.log("current_history_node",current_history_node),console.log("history_node_to_discard.parent",s.parent)):(s.parent.futures.splice(c,1),$G$1.triggerHandler("history-update"))}history_node_to_cancel_to=null,update_helper_layer()}function meld_selection_into_canvas(t){selection.draw(),selection.destroy(),selection=null,t||undoable({name:"Deselect",icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),use_loose_canvas_changes:!0},()=>{})}function meld_textbox_into_canvas(t){textbox.$editor.val()&&!t?(undoable({name:localize("Text"),icon:get_icon_for_tool(get_tool_by_id(TOOL_TEXT)),soft:!0},()=>{}),undoable({name:"Finish Text",icon:get_icon_for_tool(get_tool_by_id(TOOL_TEXT))},()=>{main_ctx.drawImage(textbox.canvas,textbox.x,textbox.y),textbox.destroy(),textbox=null})):(textbox.destroy(),textbox=null)}function deselect(t){var n;selection&&meld_selection_into_canvas(t),textbox&&meld_textbox_into_canvas(t);for(const s of selected_tools)(n=s.end)==null||n.call(s,main_ctx)}function delete_selection(t={}){selection&&undoable({name:t.name||localize("Clear Selection"),icon:t.icon||get_help_folder_icon("p_delete.png")},()=>{selection.destroy(),selection=null})}function select_all(){deselect(),select_tool(get_tool_by_id(TOOL_SELECT)),undoable({name:localize("Select All"),icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{selection=new OnCanvasSelection(0,0,main_canvas.width,main_canvas.height)})}const ctrlOrCmd=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)?"â":"Ctrl",recommendationForClipboardAccess=`Please use the keyboard: ${ctrlOrCmd}+C to copy, ${ctrlOrCmd}+X to cut, ${ctrlOrCmd}+V to paste. If keyboard is not an option, try using Chrome version 76 or higher.`;function try_exec_command(t){if(document.queryCommandEnabled(t)){if(document.execCommand(t),!navigator.userAgent.includes("Firefox")||t==="paste")return show_error_message$1(`That ${t} probably didn't work. ${recommendationForClipboardAccess}`)}else return show_error_message$1(`Cannot perform ${t}. ${recommendationForClipboardAccess}`)}function getSelectionText(){const t=document.activeElement,n=t?t.tagName.toLowerCase():null;if(n=="textarea"||n=="input"&&/^(?:text|search|password|tel|url)$/i.test(t.type)){const s=t;if(typeof s.selectionStart=="number")return s.value.slice(s.selectionStart,s.selectionEnd)}return window.getSelection?window.getSelection().toString():""}function edit_copy(t){const n=getSelectionText();if(n.length>0){if(!navigator.clipboard||!navigator.clipboard.writeText){if(t)return try_exec_command("copy");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}navigator.clipboard.writeText(n)}else if(selection&&selection.canvas){if(!navigator.clipboard||!navigator.clipboard.write){if(t)return try_exec_command("copy");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}selection.canvas.toBlob(s=>{sanity_check_blob(s,()=>{navigator.clipboard.write([new ClipboardItem(Object.defineProperty({},s.type,{value:s,enumerable:!0}))]).then(()=>{var e;(e=window.console)==null||e.log("Copied image to the clipboard.")},e=>{show_error_message$1("Failed to copy to the Clipboard.",e)})})})}}function edit_cut(t){if(!navigator.clipboard||!navigator.clipboard.write){if(t)return try_exec_command("cut");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}edit_copy(),delete_selection({name:localize("Cut"),icon:get_help_folder_icon("p_cut.png")})}async function edit_paste(t){if(document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement){if(!navigator.clipboard||!navigator.clipboard.readText){if(t)return try_exec_command("paste");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}const n=await navigator.clipboard.readText();document.execCommand("InsertText",!1,n);return}if(!navigator.clipboard||!navigator.clipboard.read){if(t)return try_exec_command("paste");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}try{const s=await(await navigator.clipboard.read())[0].getType("image/png");paste_image_from_file(s)}catch(n){if(n.name==="NotFoundError")try{const s=await navigator.clipboard.readText();if(s){const e=get_uris(s);e.length>0?load_image_from_uri(e[0]).then(c=>{paste(c.image||make_canvas(c.image_data))},c=>{show_resource_load_error_message(c)}):show_error_message$1("The information on the Clipboard can't be inserted into Paint.")}else show_error_message$1("The information on the Clipboard can't be inserted into Paint.")}catch(s){show_error_message$1(localize("Error getting the Clipboard Data!"),s)}else show_error_message$1(localize("Error getting the Clipboard Data!"),n)}}function image_invert_colors(){apply_image_transformation({name:localize("Invert Colors"),icon:get_help_folder_icon("p_invert.png")},(t,n,s,e)=>{invert_rgb(n,e)})}function clear(){deselect(),cancel(),undoable({name:localize("Clear Image"),icon:get_help_folder_icon("p_blank.png")},()=>{saved=!1,update_title(),transparency?main_ctx.clearRect(0,0,main_canvas.width,main_canvas.height):(main_ctx.fillStyle=selected_colors.background,main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height))})}let cleanup_bitmap_view=()=>{};function view_bitmap(){cleanup_bitmap_view();const t=document.createElement("div");t.classList.add("bitmap-view","inset-deep"),document.body.appendChild(t),$(t).css({display:"flex",alignItems:"center",justifyContent:"center",position:"fixed",top:"0",left:"0",width:"100%",height:"100%",zIndex:"9999",background:"var(--Background)"}),t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen();let n,s=!1,e=setInterval(()=>{document.fullscreenElement===t||document.webkitFullscreenElement===t?s=!0:s&&cleanup_bitmap_view()},100);cleanup_bitmap_view=()=>{document.removeEventListener("fullscreenchange",c),document.removeEventListener("webkitfullscreenchange",c),document.removeEventListener("keydown",i),document.removeEventListener("mousedown",o),setTimeout(()=>{document.removeEventListener("contextmenu",l)},100),URL.revokeObjectURL(n),clearInterval(e),(document.fullscreenElement===t||document.webkitFullscreenElement===t)&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()),t.remove(),cleanup_bitmap_view=()=>{}},document.addEventListener("fullscreenchange",c,{once:!0}),document.addEventListener("webkitfullscreenchange",c,{once:!0}),document.addEventListener("keydown",i),document.addEventListener("mousedown",o),document.addEventListener("contextmenu",l);function c(){document.fullscreenElement!==t&&document.webkitFullscreenElement!==t&&cleanup_bitmap_view()}let a=!1;function i(r){if(a=a||r.repeat&&(r.key==="f"||r.key==="F"),!r.repeat){if(a&&(r.key==="f"||r.key==="F")){a=!1;return}r.preventDefault(),cleanup_bitmap_view()}}function o(r){cleanup_bitmap_view()}function l(r){r.preventDefault(),cleanup_bitmap_view()}main_canvas.toBlob(r=>{n=URL.createObjectURL(r);const d=document.createElement("img");d.src=n,t.appendChild(d)},"image/png")}function get_tool_by_id(t){for(let n=0;n<tools.length;n++)if(tools[n].id==t)return tools[n]}function select_tools(t){for(let n=0;n<t.length;n++)select_tool(t[n],n>0);update_helper_layer()}function select_tool(t,n){if(deselect(),selected_tools.length===1&&selected_tool.deselect||(return_to_tools=[...selected_tools]),n){const s=selected_tools.indexOf(t);s===-1?(selected_tools.push(t),selected_tools.sort((e,c)=>tools.indexOf(e)<tools.indexOf(c)?-1:tools.indexOf(e)>tools.indexOf(c)?1:0)):selected_tools.splice(s,1),selected_tools.length>0?selected_tool=selected_tools[selected_tools.length-1]:(selected_tool=default_tool,selected_tools=[selected_tool])}else selected_tool=t,selected_tools=[t];t.preload&&t.preload(),$toolbox.update_selected_tool()}function has_any_transparency(t){const n=t.getImageData(0,0,main_canvas.width,main_canvas.height);for(let s=0,e=n.data.length;s<e;s+=4)if(n.data[s+3]<253)return!0;return!1}function make_opaque(){undoable({name:"Make Opaque",icon:get_help_folder_icon("p_make_opaque.png")},()=>{main_ctx.save(),main_ctx.globalCompositeOperation="destination-atop",main_ctx.fillStyle="white",main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height),main_ctx.restore()})}function resize_canvas_without_saving_dimensions(t,n,s={}){const e=Math.max(1,t),c=Math.max(1,n);(main_canvas.width!==e||main_canvas.height!==c)&&undoable({name:s.name||"Resize Canvas",icon:s.icon||get_help_folder_icon("p_stretch_both.png")},()=>{try{const a=main_ctx.getImageData(0,0,e,c);main_canvas.width=e,main_canvas.height=c,main_ctx.disable_image_smoothing(),transparency||(main_ctx.fillStyle=selected_colors.background,main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height));const i=make_canvas(a);main_ctx.drawImage(i,0,0)}catch(a){a.name==="NS_ERROR_FAILURE"?show_error_message$1(localize("Insufficient memory to perform operation."),a):show_error_message$1(localize("An unknown error has occurred."),a);return}$canvas_area.trigger("resize")})}function resize_canvas_and_save_dimensions(t,n,s={}){resize_canvas_without_saving_dimensions(t,n,s),localStore.set({width:main_canvas.width.toString(),height:main_canvas.height.toString()},e=>{})}function image_attributes(){image_attributes.$window&&image_attributes.$window.close();const t=image_attributes.$window=$DialogWindow(localize("Attributes"));t.addClass("attributes-window");const n=t.$main,s={[localize("File last saved:")]:localize("Not Available"),[localize("Size on disk:")]:localize("Not Available"),[localize("Resolution:")]:"72 x 72 dots per inch"},e=$(E("table")).appendTo(n);for(const A in s){const y=$(E("tr")).appendTo(e);$(E("td")).appendTo(y).text(A);const x=$(E("td")).appendTo(y).text(s[A]);s[A].indexOf("72")!==-1&&x.css("direction","ltr")}const c={px:1,in:72,cm:28.3465};let a=image_attributes.unit=image_attributes.unit||"px",i=main_canvas.width,o=main_canvas.height;const l=$(E("label")).appendTo(n).html(render_access_key(localize("&Width:"))),r=$(E("label")).appendTo(n).html(render_access_key(localize("&Height:"))),d=$(E("input")).attr({type:"number",min:1,"aria-keyshortcuts":"Alt+W W W"}).addClass("no-spinner inset-deep").appendTo(l),h=$(E("input")).attr({type:"number",min:1,"aria-keyshortcuts":"Alt+H H H"}).addClass("no-spinner inset-deep").appendTo(r);n.find("input").css({width:"40px"}).on("change keyup keydown keypress pointerdown pointermove paste drop",()=>{i=Number(d.val())*c[a],o=Number(h.val())*c[a]});const v=$(E("fieldset")).appendTo(n).append(`
		<legend>${localize("Units")}</legend>
		<div class="fieldset-body">
			<div class="radio-field"><input type="radio" name="units" id="unit-in" value="in" aria-keyshortcuts="Alt+I I"><label for="unit-in">${render_access_key(localize("&Inches"))}</label></div>
			<div class="radio-field"><input type="radio" name="units" id="unit-cm" value="cm" aria-keyshortcuts="Alt+M M"><label for="unit-cm">${render_access_key(localize("C&m"))}</label></div>
			<div class="radio-field"><input type="radio" name="units" id="unit-px" value="px" aria-keyshortcuts="Alt+P P"><label for="unit-px">${render_access_key(localize("&Pixels"))}</label></div>
		</div>
	`);v.find(`[value=${a}]`).attr({checked:!0}),v.on("change",()=>{const A=String(v.find(":checked").val());d.val(i/c[A]),h.val(o/c[A]),a=A}).triggerHandler("change");const p=$(E("fieldset")).appendTo(n).append(`
		<legend>${localize("Colors")}</legend>
		<div class="fieldset-body">
			<div class="radio-field"><input type="radio" name="colors" id="attribute-monochrome" value="monochrome" aria-keyshortcuts="Alt+B B"><label for="attribute-monochrome">${render_access_key(localize("&Black and white"))}</label></div>
			<div class="radio-field"><input type="radio" name="colors" id="attribute-polychrome" value="polychrome" aria-keyshortcuts="Alt+L L"><label for="attribute-polychrome">${render_access_key(localize("Co&lors"))}</label></div>
		</div>
	`);p.find(`[value=${monochrome?"monochrome":"polychrome"}]`).attr({checked:!0});const m=$(E("fieldset")).appendTo(n).append(`
		<legend>${localize("Transparency")}</legend>
		<div class="fieldset-body">
			<div class="radio-field"><input type="radio" name="transparency" id="attribute-transparent" value="transparent"><label for="attribute-transparent">${localize("Transparent")}</label></div>
			<div class="radio-field"><input type="radio" name="transparency" id="attribute-opaque" value="opaque"><label for="attribute-opaque">${localize("Opaque")}</label></div>
		</div>
	`);m.find(`[value=${transparency?"transparent":"opaque"}]`).attr({checked:!0}),t.$Button(localize("OK"),()=>{const A=m.find(":checked").val();p.find(":checked").val();const y=String(v.find(":checked").val());image_attributes.unit=y,transparency=A=="transparent",A=="transparent"&&(selected_colors.background="transparent");const x=c[y],P=Number(d.val())*x,L=Number(h.val())*x;resize_canvas_and_save_dimensions(~~P,~~L),!transparency&&has_any_transparency(main_ctx)&&make_opaque(),image_attributes.$window.close()},{type:"submit"}),t.$Button(localize("Cancel"),()=>{image_attributes.$window.close()}),t.$Button($.parseHTML(render_access_key(localize("&Default")))[0],()=>{i=default_canvas_width,o=default_canvas_height,d.val(i/c[a]),h.val(o/c[a])}).attr("aria-keyshortcuts","Alt+D D"),handle_keyshortcuts(t),d.select(),image_attributes.$window.center()}image_attributes.$window=null;image_attributes.unit="px";function image_flip_and_rotate(){const t=$DialogWindow(localize("Flip and Rotate"));t.addClass("flip-and-rotate");const n=$(E("fieldset")).appendTo(t.$main);n.append(`
		<legend>${localize("Flip or rotate")}</legend>
		<div class="radio-wrapper">
			<input
				type="radio"
				name="flip-or-rotate"
				id="flip-horizontal"
				value="flip-horizontal"
				aria-keyshortcuts="Alt+F"
				checked
			/><label for="flip-horizontal">${render_access_key(localize("&Flip horizontal"))}</label>
		</div>
		<div class="radio-wrapper">
			<input
				type="radio"
				name="flip-or-rotate"
				id="flip-vertical"
				value="flip-vertical"
				aria-keyshortcuts="Alt+V"
			/><label for="flip-vertical">${render_access_key(localize("Flip &vertical"))}</label>
		</div>
		<div class="radio-wrapper">
			<input
				type="radio"
				name="flip-or-rotate"
				id="rotate-by-angle"
				value="rotate-by-angle"
				aria-keyshortcuts="Alt+R"
			/><label for="rotate-by-angle">${render_access_key(localize("&Rotate by angle"))}</label>
		</div>
	`);const s=$(E("div")).appendTo(n);s.addClass("sub-options");for(const e of["&90Â°","&180Â°","&270Â°"]){const c=parseInt(AccessKeys.toText(e),10);s.append(`
			<div class="radio-wrapper">
				<input
					type="radio"
					name="rotate-by-angle"
					value="${c}"
					id="rotate-${c}"
					aria-keyshortcuts="Alt+${AccessKeys.get(e).toUpperCase()}"
				/><label
					for="rotate-${c}"
				>${render_access_key(e)}</label>
			</div>
		`)}s.append(`
		<div class="radio-wrapper">
			<input
				type="radio"
				name="rotate-by-angle"
				value="arbitrary"
			/><input
				type="number"
				min="-360"
				max="360"
				name="rotate-by-arbitrary-angle"
				id="custom-degrees"
				value=""
				class="no-spinner inset-deep"
				style="width: 50px"
			/>
			<label for="custom-degrees">${localize("Degrees")}</label>
		</div>
	`),s.find("#rotate-90").attr({checked:!0}),s.find("input").attr({disabled:!0}),n.find("input").on("change",()=>{const e=n.find("input[name='flip-or-rotate']:checked").val();s.find("input").attr({disabled:e!=="rotate-by-angle"})}),s.find(".radio-wrapper").on("click",e=>{n.find("input[value='rotate-by-angle']").prop("checked",!0),n.find("input").triggerHandler("change");const c=$(e.target).closest(".radio-wrapper"),a=c.find("input[type='number']")[0];a&&a.focus(),c.find("input[type='radio']").prop("checked",!0)}),n.find("input[name='rotate-by-arbitrary-angle']").on("input",()=>{n.find("input[value='rotate-by-angle']").prop("checked",!0),n.find("input[value='arbitrary']").prop("checked",!0)}),t.$Button(localize("OK"),()=>{switch(n.find("input[name='flip-or-rotate']:checked").val()){case"flip-horizontal":flip_horizontal();break;case"flip-vertical":flip_vertical();break;case"rotate-by-angle":{let c=n.find("input[name='rotate-by-angle']:checked").val();c==="arbitrary"&&(c=n.find("input[name='rotate-by-arbitrary-angle']").val());const i=Number(c)/360*TAU;if(isNaN(i)){please_enter_a_number();return}rotate(i);break}}t.close()},{type:"submit"}),t.$Button(localize("Cancel"),()=>{t.close()}),n.find("input[type='radio']").first().focus(),t.center(),handle_keyshortcuts(t)}function image_stretch_and_skew(){const t=$DialogWindow(localize("Stretch and Skew"));t.addClass("stretch-and-skew");const n=$(E("fieldset")).appendTo(t.$main);n.append(`<legend>${localize("Stretch")}</legend><table></table>`);const s=$(E("fieldset")).appendTo(t.$main);s.append(`<legend>${localize("Skew")}</legend><table></table>`);const e=(l,r,d,h,v,p,m)=>{const A=$(E("tr")).appendTo(l),y=$(E("img")).attr({src:`images/transforms/${r}.png`,width:32,height:32}).css({marginRight:"20px"}),x=("input"+Math.random()+Math.random()).replace(/\./,""),P=$(E("input")).attr({type:"number",min:p,max:m,value:h,id:x,"aria-keyshortcuts":`Alt+${AccessKeys.get(d).toUpperCase()}`}).css({width:"40px"}).addClass("no-spinner inset-deep");return $(E("td")).appendTo(A).append(y),$(E("td")).appendTo(A).append($(E("label")).html(render_access_key(d)).attr("for",x)),$(E("td")).appendTo(A).append(P),$(E("td")).appendTo(A).text(v),P},c=e(n.find("table"),"stretch-x",localize("&Horizontal:"),100,"%",1,5e3),a=e(n.find("table"),"stretch-y",localize("&Vertical:"),100,"%",1,5e3),i=e(s.find("table"),"skew-x",localize("H&orizontal:"),0,localize("Degrees"),-90,90),o=e(s.find("table"),"skew-y",localize("V&ertical:"),0,localize("Degrees"),-90,90);t.$Button(localize("OK"),()=>{const l=parseFloat(c.val())/100,r=parseFloat(a.val())/100,d=parseFloat(i.val())/360*TAU,h=parseFloat(o.val())/360*TAU;if(isNaN(l)||isNaN(r)||isNaN(d)||isNaN(h)){please_enter_a_number();return}try{stretch_and_skew(l,r,d,h)}catch(v){v.name==="NS_ERROR_FAILURE"?show_error_message$1(localize("Insufficient memory to perform operation."),v):show_error_message$1(localize("An unknown error has occurred."),v);return}t.close()},{type:"submit"}),t.$Button(localize("Cancel"),()=>{t.close()}),t.$main.find("input").first().focus().select(),t.center(),handle_keyshortcuts(t)}function handle_keyshortcuts(t){t.on("keydown",n=>{const s=t.find("[aria-keyshortcuts]");for(let e of s){const c=$(e).attr("aria-keyshortcuts").split(" ");for(const a of c)if(!!a.match(/Alt\+/i)===n.altKey&&!!a.match(/Ctrl\+/i)===n.ctrlKey&&!!a.match(/Meta\+/i)===n.metaKey&&!!a.match(/Shift\+/i)===n.shiftKey&&a.split("+").pop().toUpperCase()===n.key.toUpperCase()){n.preventDefault(),n.stopPropagation(),e.disabled&&(e=e.closest(".radio-wrapper")),e.click(),e.focus();return}}}),t.on("focusin focusout",n=>{if($(n.target).is('textarea, input:not([type="checkbox"]):not([type="radio"]):not([type="button"]):not([type="submit"]):not([type="reset"]):not([type="image"]):not([type="file"]):not([type="color"]):not([type="range"])'))for(const s of t.find("[aria-keyshortcuts]"))s._original_aria_keyshortcuts=s._original_aria_keyshortcuts??s.getAttribute("aria-keyshortcuts"),s.setAttribute("aria-keyshortcuts",s.getAttribute("aria-keyshortcuts").split(" ").filter(e=>e.match(/(Alt|Ctrl|Meta)\+/i)).join(" "));else for(const s of t.find("[aria-keyshortcuts]"))s._original_aria_keyshortcuts&&s.setAttribute("aria-keyshortcuts",s._original_aria_keyshortcuts)})}function save_as_prompt({dialogTitle:t=localize("Save As"),defaultFileName:n="",defaultFileFormatID:s,formats:e,promptForName:c=!0}){return new Promise(a=>{const i=$DialogWindow(t);i.addClass("save-as"),i.$content.attr("tabIndex",null),c&&i.$main.append(`
				<label>
					File name:
					<input type="text" class="file-name inset-deep"/>
				</label>
			`),i.$main.append(`
			<label>
				Save as type:
				<select class="file-type-select inset-deep"></select>
			</label>
		`);const o=i.$main.find(".file-type-select"),l=i.$main.find(".file-name");for(const p of e)o.append($("<option>").val(p.formatID).text(p.nameWithExtensions));c&&l.val(n);const r=()=>{const p=o.val();for(const m of e)if(m.formatID===p)return m},d=()=>{const p=(c?String(l.val()):n).match(/\.([\w\d]+)$/);if(p){const m=r(),A=p[1].toLowerCase();if(m&&m.extensions.includes(A))return;for(const y of e)y.extensions.includes(A)&&o.val(y.formatID)}};c&&l.on("input",d),s&&e.some(p=>p.formatID===s)?o.val(s):d();const h=p=>{if(!c)return;let m=l.val();const A=r();if(!A)return;const y=A.extensions,x=y[0],P=m.replace(/\.(\w{1,3}|apng|jpeg|jfif|tiff|webp|psppalette|sketchpalette|gimp|colors|scss|sass|less|styl|html|theme|themepack)$/i,""),L=P!==m,T=m.slice(P.length+1).toLowerCase();(p||L)&&y.indexOf(T)===-1&&(m=`${P}.${x}`,l.val(m))};o.on("change",()=>{h(!1)}),h(!1);const v=i.$Button(localize("Save"),()=>{i.close(),h(!0),a({newFileName:c?String(l.val()):n,newFileFormatID:String(o.val())})},{type:"submit"});i.$Button(localize("Cancel"),()=>{i.close()}),i.center(),(window.innerWidth<500||window.innerHeight<700)&&i.css({top:20}),c?l.focus().select():v.focus()})}function write_image_file(t,n,s){const e=t.getContext("2d"),c=n.match(/^image\/(?:x-)?bmp\s*(?:-(\d+)bpp)?/);if(c){const a=encodeBMP(e.getImageData(0,0,t.width,t.height),parseInt(c[1]||"24",10)),i=new Blob([a]);sanity_check_blob(i,()=>{s(i)})}else if(n==="image/png"){const a=e.getImageData(0,0,t.width,t.height),i=UPNG.encode([a.data.buffer],a.width,a.height),o=new Blob([i]);sanity_check_blob(o,()=>{s(o)})}else if(n==="image/tiff"){const a=e.getImageData(0,0,t.width,t.height),i={t305:["jspaint (UTIF.js)"]},o=UTIF.encodeImage(a.data.buffer,a.width,a.height,i),l=new Blob([o]);sanity_check_blob(l,()=>{s(l)})}else t.toBlob(a=>{sanity_check_blob(a,()=>{s(a)},[137,80,78,71,13,10,26,10],n==="image/png")},n)}function read_image_file(t,n){let s,e,c=!1;t.arrayBuffer().then(a=>{const i={png:[137,80,78,71,13,10,26,10],bmp:[66,77],jpeg:[255,216,255],gif:[71,73,70,56],webp:[87,69,66,80],tiff_be:[77,77,0,42],tiff_le:[73,73,42,0],ico:[0,0,1,0],cur:[0,0,2,0],icns:[105,99,110,115]},o=new Uint8Array(a);let l;for(const[P,L]of Object.entries(i))L.every((g,_)=>g===o[_])&&(l=P);if(l||String.fromCharCode(...o.slice(0,1024)).includes("%PDF")&&(l="pdf"),l==="bmp"){const{colorTable:P,bitsPerPixel:L,imageData:T}=decodeBMP(a);s=L===24?"image/bmp":`image/bmp;bpp=${L}`,P.length>=2&&(e=P.map(g=>`rgb(${g.r}, ${g.g}, ${g.b})`),c=!1),n(null,{file_format:s,monochrome:c,palette:e,image_data:T,source_blob:t})}else if(l==="png"){const P=UPNG.decode(a),L=UPNG.toRGBA8(P)[0],{width:T,height:g,tabs:_,ctype:u}=P;if(_.PLTE&&_.PLTE.length>=3*2&&u===3){e=new Array(_.PLTE.length/3);for(let S=0;S<e.length;S++)_.tRNS&&_.tRNS.length>=S+1?e[S]=`rgba(${_.PLTE[S*3+0]}, ${_.PLTE[S*3+1]}, ${_.PLTE[S*3+2]}, ${_.tRNS[S]/255})`:e[S]=`rgb(${_.PLTE[S*3+0]}, ${_.PLTE[S*3+1]}, ${_.PLTE[S*3+2]})`;c=!1}s="image/png";const b=new ImageData(new Uint8ClampedArray(L),T,g);n(null,{file_format:s,monochrome:c,palette:e,image_data:b,source_blob:t})}else if(l==="tiff_be"||l==="tiff_le"){var r=UTIF.decode(a),d=r,h=0,v=d[0];r[0].subIFD&&(d=d.concat(r[0].subIFD));for(var p=0;p<d.length;p++){var m=d[p];if(!(m.t258==null||m.t258.length<3)){var A=m.t256*m.t257;A>h&&(h=A,v=m)}}UTIF.decodeImage(a,v,r);var y=UTIF.toRGBA8(v),x=new ImageData(new Uint8ClampedArray(y.buffer),v.width,v.height);s="image/tiff",n(null,{file_format:s,monochrome:c,palette:e,image_data:x,source_blob:t})}else if(l==="pdf"){s="application/pdf",pdfjs$1.GlobalWorkerOptions.workerSrc="lib/pdf.js/build/pdf.worker.js";const P=new Uint8Array(a);pdfjs$1.getDocument({data:P,cMapUrl:"lib/pdf.js/web/cmaps/",cMapPacked:!0}).promise.then(T=>{console.log("PDF loaded");var g=1;T.getPage(g).then(_=>{console.log("Page loaded");var u=1.5,b=_.getViewport({scale:u}),S=make_canvas(b.width,b.height),M={canvasContext:S.ctx,viewport:b},R=_.render(M);R.promise.then(()=>{console.log("Page rendered");const C=S.ctx.getImageData(0,0,S.width,S.height);n(null,{file_format:s,monochrome:c,palette:e,image_data:C,source_blob:t})})})},T=>{n(new Error(`Failed to load PDF. ${T}`))})}else{c=!1,s={png:"image/png",webp:"image/webp",jpeg:"image/jpeg",gif:"image/gif",tiff_be:"image/tiff",tiff_le:"image/tiff",ico:"image/x-icon",cur:"image/x-win-bitmap",icns:"image/icns"}[l]||t.type;const P=URL.createObjectURL(t),L=new Image,T=()=>{URL.revokeObjectURL(P),t.text().then(g=>{const _=new Error("failed to decode blob as an image");_.code=g.match(/^\s*<!doctype\s+html/i)?"html-not-image":"decoding-failure",n(_)},g=>{const _=new Error("failed to decode blob as image or text");_.code="decoding-failure",n(_)})};L.onload=()=>{if(URL.revokeObjectURL(P),!L.complete||typeof L.naturalWidth>"u"||L.naturalWidth===0){T();return}n(null,{file_format:s,monochrome:c,palette:e,image:L,source_blob:t})},L.onerror=T,L.src=P}},a=>{n(a)})}function update_from_saved_file(t){read_image_file(t,(n,s)=>{if(n){show_error_message$1("The file has been saved, however... "+localize("Paint cannot read this file."),n);return}apply_file_format_and_palette_info(s);const e=image_formats.find(({mimeType:c})=>c===s.file_format);undoable({name:`${localize("Save As")} ${e?e.name:s.file_format}`,icon:get_help_folder_icon("p_save.png"),assume_saved:!0},()=>{main_ctx.copy(s.image||s.image_data)})})}function save_selection_to_file(){selection&&selection.canvas&&systemHooks.showSaveFileDialog({dialogTitle:localize("Save As"),defaultFileName:"selection.png",defaultFileFormatID:"image/png",formats:image_formats,getBlob:t=>new Promise(n=>{write_image_file(selection.canvas,t,s=>{n(s)})})})}function sanity_check_blob(t,n,s,e=!0){t.size>0?s?t.arrayBuffer().then(c=>{const a=new Uint8Array(c);s.every((o,l)=>o===a[l])===e?n():showMessageBox$1({message:window.is_electron_app?"Writing images in this file format is not supported.":"Your browser does not support writing images in this file format.",iconID:"error"})},c=>{show_error_message$1(localize("An unknown error has occurred."),c)}):n():show_error_message$1(localize("Failed to save document."))}window.make_history_node=make_history_node;window.open_from_file=open_from_file;window.are_you_sure=are_you_sure$1;window.show_error_message=show_error_message$1;window.show_about_paint=show_about_paint;window.exit_fullscreen_if_ios=exit_fullscreen_if_ios$1;window.get_tool_by_id=get_tool_by_id;window.sanity_check_blob=sanity_check_blob;console.log("JS ì¤í:","$Component.js");function get_segments(t,n,s){return $(t).find(".component").not(s).toArray().map(c=>{const a={element:c};return n==="top"?(a.pos=c.offsetTop,a.length=c.clientHeight):n==="left"?(a.pos=c.offsetLeft,a.length=c.clientWidth):n==="right"&&(a.pos=t.scrollWidth-c.offsetLeft,a.length=c.clientWidth),a})}function adjust_segments(t,n){t.sort((s,e)=>s.pos-e.pos);for(const s of t)s.pos=Math.max(s.pos,0),s.pos=Math.min(s.pos,n-s.length);for(let s=1;s<t.length;s++){const e=t[s],c=t[s-1],a=c.pos+c.length-e.pos;a>0&&(e.pos+=a)}for(const s of t)s.pos=Math.max(s.pos,0),s.pos=Math.min(s.pos,n-s.length);for(let s=t.length-2;s>=0;s--){const e=t[s],c=t[s+1],a=e.pos+e.length-c.pos;a>0&&(e.pos-=a)}}function apply_segments(t,n,s){let e=0;for(const c of s)c.margin_before=c.pos-e,e=c.length+c.pos;for(const c of s)t.appendChild(c.element),$(c.element).css(`margin-${n}`,c.margin_before)}function $Component(t,n,s,e){const c=$(E("div")).addClass("component");c.addClass(n),c.addClass(s),c.append(e),c.css("touch-action","none");const a=$ToolWindow(c);a.title(t),a.hide(),a.$content.addClass({tall:"vertical",wide:"horizontal"}[s]),n==="colors-component"&&s==="wide"&&(c.css("position","relative"),c.css(`margin-${get_direction()==="rtl"?"right":"left"}`,"3px"));let i;$("body").hasClass("eye-gaze-mode")&&(i=setInterval(()=>{c.css({transform:"scale(3)",transformOrigin:"0 0",marginRight:c[0].scrollWidth*2,marginBottom:c[0].scrollHeight*2})},200));let o,l,r,d,h,v,p=0,m,A,y,x,P;s==="tall"?m="top":get_direction()==="rtl"?m="right":m="left";const L=M=>{a.hide();const R=get_segments(M[0],m,c[0]);M.append(c),R.push({element:c[0],pos:p,length:c[0][m==="top"?"clientHeight":"clientWidth"]});const C=m==="top"?M.height():M.width();adjust_segments(R,C),apply_segments(M[0],m,R),y=M,A=p},T=(M,R)=>{const C=c.closest(".component-area")[0],D=get_segments(C,m,c[0]);c.css("position","relative"),c.css(`margin-${m}`,""),a.$content.append(c),a.show(),a.css({left:M,top:R});const B=m==="top"?$(C).height():$(C).width();adjust_segments(D,B),apply_segments(C,m,D)};a.on("window-drag-start",M=>{M.preventDefault()});const g=()=>{const M=a.is(":visible");a.show();let R,{offsetLeft:C,offsetTop:D}=c[0];if(c.closest(".tool-window").length==0){const J=getComputedStyle(c[0]);R=$(E("div")).addClass("component").css({width:J.width,height:J.height}),a.append(R),{offsetLeft:C,offsetTop:D}=R[0]}const B=a[0].getBoundingClientRect();R&&R.remove(),M||a.hide();const Z=getComputedStyle(a[0]);return C+=parseFloat(Z.borderLeftWidth),D+=parseFloat(Z.borderTopWidth),{rect:B,offsetLeft:C,offsetTop:D}},_=(M=m==="top"?$left:$bottom)=>{if(c.closest(".tool-window").length==0)return{rect:c[0].getBoundingClientRect()};const R=getComputedStyle(c[0]),C=$(E("div")).addClass("component").css({width:R.width,height:R.height,flex:"0 0 auto"});M.prepend(C);const D=C[0].getBoundingClientRect();return C&&C.remove(),{rect:D}},u=M=>{const{rect:R}=x?_(x):g();h=~~(R.width/2)*2+1,v=~~(R.height/2)*2+1,P||(P=$(E("div")).addClass("component-ghost dock"),P.appendTo("body"));const C=x?0:3;P.css({position:"absolute",display:"block",width:h-C*2,height:v-C*2,left:M.clientX+(x?o:r)+C,top:M.clientY+(x?l:d)+C}),x?P.addClass("dock"):P.removeClass("dock")};c.add(a.$titlebar).on("pointerdown",M=>{if(M.button!==0||!(c.is(M.target)||$(M.target).closest(a.$titlebar).length>0&&$(M.target).closest("button").length===0)||$("body").hasClass("eye-gaze-mode"))return;const C=_(),D=c[0].getBoundingClientRect();o=D.left-M.clientX,l=D.top-M.clientY,o=-Math.min(Math.max(-o,0),C.rect.width),l=-Math.min(Math.max(-l,0),C.rect.height);const{offsetLeft:B,offsetTop:Z}=g();r=D.left-B-M.clientX,d=D.top-Z-M.clientY,$("body").addClass("dragging"),$("body").css({cursor:"default"}).addClass("cursor-bully"),$G$1.on("pointermove",b),$G$1.one("pointerup",J=>{$G$1.off("pointermove",b),S(J),$("body").removeClass("dragging"),$("body").css({cursor:""}).removeClass("cursor-bully"),$canvas.trigger("pointerleave")}),u(M),b(M),M.preventDefault()});const b=M=>{P.css({left:M.clientX+o,top:M.clientY+l}),x=null;const{width:R,height:C}=_().rect,D=M.clientX+o,B=M.clientY+l,Z=D+R,J=B+C,q=5;if(s==="tall"?(m="top",D-q<$left[0].getBoundingClientRect().right&&(x=$left),Z+q>$right[0].getBoundingClientRect().left&&(x=$right)):(m=get_direction()==="rtl"?"right":"left",B-q<$top[0].getBoundingClientRect().bottom&&(x=$top),J+q>$bottom[0].getBoundingClientRect().top&&(x=$bottom)),x){const z=x[0].getBoundingClientRect();p=(m==="top"?B:m==="right"?Z:D)-z[m],m==="right"&&(p*=-1)}u(M),M.preventDefault()},S=M=>{a.hide(),c.parent().is(".component-area")&&(y=c.parent(),x&&(A=p)),x?L(x):T(M.clientX+r,M.clientY+d),P==null||P.remove(),P=null,$G$1.trigger("resize")};return c.dock=M=>{p=A??0,L(M??y)},c.undock_to=T,c.show=()=>($(c[0]).show(),$.contains(a[0],c[0])&&a.show(),c),c.hide=()=>(c.add(a).hide(),c),c.toggle=()=>(c.is(":visible")?c.hide():c.show(),c),c.destroy=()=>{a.close(),c.remove(),clearInterval(i)},a.on("close",M=>{M.preventDefault(),a.hide()}),c}console.log("JS ì¤í:","error-handling-enhanced.js");var old_onerror=window.onerror;window.onerror=function(t,n,s,e,c){try{var a="";c?"stack"in c&&c.stack.indexOf(n)===-1?a=`${t}

URL: ${n}
Line: ${s}
Column: ${e}`:a=c:a=t,show_error_message$1(localize("Internal application error."),a)}catch(i){old_onerror(t,n,s,e,c),console.warn("Error in error handler:",i)}};var old_onunhandledrejection=window.onunhandledrejection,restore_new_onunhandledrejection_tid,new_onunhandledrejection=function(t){window.onunhandledrejection=old_onunhandledrejection,clearTimeout(restore_new_onunhandledrejection_tid),restore_new_onunhandledrejection_tid=setTimeout(function(){window.onunhandledrejection=new_onunhandledrejection},0);try{show_error_message$1(localize("Internal application error.")+`
Unhandled Rejection.`,t.reason)}catch(n){old_onunhandledrejection.call(window,t),console.warn("Error in unhandledrejection handler:",n)}};window.onunhandledrejection=new_onunhandledrejection;console.log("JS ì¤í:","$ToolBox.js");let theme_dev_blob_url;function $ToolBox(t,n){const s=$(E("div")).addClass("tools"),e=$(E("div")).addClass("tool-options");let c=!1;s.on("pointerleave",()=>{c=!1});const a=$($.map(t,(o,l)=>{const r=$(E("div")).addClass("tool");r.appendTo(s),o.$button=r,r.attr("title",o.name);const d=$(E("span")).addClass("tool-icon");d.appendTo(r);const h=()=>{const v=!theme_dev_blob_url&&(window.devicePixelRatio!==1||$("body").hasClass("eye-gaze-mode"));d.css({display:"block",position:"absolute",left:4,top:4,width:16,height:16,backgroundImage:theme_dev_blob_url?`url(${theme_dev_blob_url})`:"","--icon-index":l.toString()}),d.toggleClass("use-svg",v)};return h(),$G$1.on("theme-load resize",h),r.on("click",v=>{selected_tool===o&&o.deselect?select_tools(return_to_tools):select_tool(o)}),r.on("pointerenter",()=>{const v=()=>{c=!0};if(c)v();else{const p=setTimeout(v,300);r.on("pointerleave",()=>{clearTimeout(p)})}}),r[0]})),i=$Component(localize("Tools"),"tools-component","tall",s.add(e));return i.appendTo(get_direction()==="rtl"?$right:$left),i.update_selected_tool=()=>{a.removeClass("selected"),selected_tools.forEach(o=>{o.$button.addClass("selected")}),e.children().detach(),e.append(selected_tool.$options),e.children().trigger("update"),$canvas.css({cursor:make_css_cursor(...selected_tool.cursor)})},i.update_selected_tool(),i}let dev_theme_tool_icons=!1;try{dev_theme_tool_icons=localStorage.dev_theme_tool_icons==="true"}catch(t){}if(dev_theme_tool_icons){let t=0;$G$1.on("session-update",()=>{t+=1;const n=t;main_canvas.toBlob(s=>{n===t&&(URL.revokeObjectURL(theme_dev_blob_url),theme_dev_blob_url=URL.createObjectURL(s),$G$1.triggerHandler("theme-load"))})})}console.log("JS ì¤í:","edit-colors.js");let $edit_colors_window,dev_edit_colors=!1;try{dev_edit_colors=localStorage.dev_edit_colors==="true"}catch(t){}dev_edit_colors&&$(()=>{show_edit_colors_window(),$(".define-custom-colors-button").click(),$edit_colors_window.css({left:80,top:50,opacity:.5})});function show_edit_colors_window(t,n){t=t||$colorbox.data("$last_fg_color_button"),n=n||"foreground";const s=t.closest(".palette, .color-box"),e=s.find(".swatch").toArray().indexOf(t[0]),c=selected_colors[n];choose_color(c,a=>{var i;if(t=$(s.find(".swatch")[e]),!t.length){show_error_message$1("Swatch no longer exists.");return}palette[e]=a,update_$swatch(t,a),selected_colors[n]=a,$G$1.triggerHandler("option-changed"),(i=window.console)==null||i.log(`Updated palette: ${palette.map(()=>"%câ").join("")}`,...palette.map(o=>`color: ${o};`))})}function choose_color(t,n){$edit_colors_window&&$edit_colors_window.close();const s=$DialogWindow(localize("Edit Colors"));s.addClass("edit-colors-window"),$edit_colors_window=s;let e=0,c=50,a=50,i=0;const o=()=>`hsl(${e}deg, ${c}%, ${a}%)`,l=(w,N,G)=>{const[V,H,X]=rgb_to_hsl(w,N,G);e=V*360,c=H*100,a=X*100},r=w=>{const[N,G,V]=get_rgba_from_color(w);l(N,G,V)},d=w=>{s.$content.find(".swatch").removeClass("selected"),w.addClass("selected"),r(w[0].dataset.color),w.closest("#custom-colors")&&(i=Math.max(0,L.indexOf(x.find(".swatch.selected")[0]))),q("hslrgb")},h=(w,N)=>{const G=$('<div class="color-grid" tabindex="0">').attr({id:N});for(const Q of w){const ce=$Swatch(Q);ce.appendTo(G).addClass("inset-deep"),ce.attr("tabindex",-1)}let V=G.find(".swatch:first-child");const H=8,X=Q=>{const ce=G.find(".swatch:focus");if(!ce.length)return;const pe=G.find(".swatch"),_e=pe.toArray().indexOf(ce[0]);if(Q===-1&&_e%H===0||Q===1&&_e%H===H-1)return;const xe=_e+Q,Y=$(pe.toArray()[xe]);Y.length&&Y.focus()};return G.on("keydown",Q=>{Q.code==="ArrowRight"&&X(1),Q.code==="ArrowLeft"&&X(-1),Q.code==="ArrowDown"&&X(+H),Q.code==="ArrowUp"&&X(-H),Q.code==="Home"&&G.find(".swatch:first-child").focus(),Q.code==="End"&&G.find(".swatch:last-child").focus(),(Q.code==="Space"||Q.code==="Enter")&&(d(G.find(".swatch:focus")),D())}),G.on("pointerdown",Q=>{const ce=$(Q.target).closest(".swatch");ce.length&&(d(ce),D())}),G.on("dragstart",Q=>{Q.preventDefault()}),G.on("focusin",Q=>{Q.target.closest(".swatch")?V=$(Q.target.closest(".swatch")):V.is(":focus")||V.focus(),G.attr("tabindex",-1)}),G.on("focusout",()=>{G.attr("tabindex",0)}),G},v=$('<div class="left-right-split">').appendTo(s.$main),p=$('<div class="left-side">').appendTo(v),m=$('<div class="right-side">').appendTo(v).hide();p.append(`<label for="basic-colors">${render_access_key("&Basic colors:")}</label>`);const A=h(basic_colors,"basic-colors").appendTo(p);p.append(`<label for="custom-colors">${render_access_key("&Custom colors:")}</label>`);const y=[];for(let w=0;w<custom_colors.length;w++){const N=w%2,G=Math.floor(w/2),V=N*8+G;y[V]=custom_colors[w]}const x=h(y,"custom-colors").appendTo(p),P=x.find(".swatch").toArray(),L=[];for(let w=0;w<P.length;w++){const N=Math.floor(w/8),V=w%8*2+N;L[V]=P[w]}const T=$('<button class="define-custom-colors-button" type="button">').html(render_access_key("&Define Custom Colors >>")).appendTo(p).on("click",w=>{w.preventDefault(),m.show(),s.addClass("defining-custom-colors"),T.attr("disabled","disabled"),s.width()>=300&&J.h.focus(),g()}),g=()=>{(s.width()<300||document.body.classList.contains("eye-gaze-mode"))&&T.removeAttr("disabled")};$(window).on("resize",g);const _=$(`<label for="color-solid-canvas">${render_access_key("Color|S&olid")}</label>`);_.css({position:"absolute",left:10,top:244});const u=make_canvas(175,187),b=make_canvas(10,187),S=make_canvas(58,40),M=make_canvas(5,9);$(S).css({position:"absolute",left:10,top:198});let R=!1,C=!1;const D=()=>{if(!R||C){for(let w=0;w<u.height;w+=6)for(let N=-1;N<u.width;N+=3)u.ctx.fillStyle=`hsl(${N/u.width*360}deg, ${(1-w/u.height)*100}%, 50%)`,u.ctx.fillRect(N,w,3,6);if(!R){const w=~~(e/360*u.width),N=~~((1-c/100)*u.height);u.ctx.fillStyle="black",u.ctx.fillRect(w-1,N-9,3,5),u.ctx.fillRect(w-1,N+5,3,5),u.ctx.fillRect(w-9,N-1,5,3),u.ctx.fillRect(w+5,N-1,5,3)}C=!R}for(let w=-2;w<b.height;w+=6)b.ctx.fillStyle=`hsl(${e}deg, ${c}%, ${(1-w/b.height)*100}%)`,b.ctx.fillRect(0,w,b.width,6);M.ctx.fillStyle=getComputedStyle(s.$content[0]).getPropertyValue("--ButtonText");for(let w=0;w<M.width;w++)M.ctx.fillRect(w,M.width-w-1,1,1+w*2);M.style.position="absolute",M.style.left="215px",M.style.top=`${3+~~((1-a/100)*b.height)}px`,S.ctx.fillStyle=o(),S.ctx.fillRect(0,0,S.width,S.height)};D(),$(u).addClass("rainbow-canvas inset-shallow"),$(b).addClass("luminosity-canvas inset-shallow"),$(S).addClass("result-color-canvas inset-shallow").attr("id","color-solid-canvas");const B=w=>{e=Math.min(1,Math.max(0,w.offsetX/u.width))*360,c=Math.min(1,Math.max(0,1-w.offsetY/u.height))*100,q("hsrgb"),D(),w.preventDefault()};$(u).on("pointerdown",w=>{R=!0,B(w),$(u).on("pointermove",B),w.pointerId!==1234567890&&u.setPointerCapture(w.pointerId)}),$G$1.on("pointerup pointercancel",()=>{$(u).off("pointermove",B),R=!1,D()});const Z=w=>{a=Math.min(1,Math.max(0,1-w.offsetY/b.height))*100,q("lrgb"),D(),w.preventDefault()};$(b).on("pointerdown",w=>{Z(w),$(b).on("pointermove",Z),w.pointerId!==1234567890&&b.setPointerCapture(w.pointerId)}),$G$1.on("pointerup pointercancel",()=>{$(b).off("pointermove",Z)});const J={};["hsl","rgb"].forEach((w,N)=>{[...w].forEach((G,V)=>{const H={h:"Hu&e:",s:"&Sat:",l:"&Lum:",r:"&Red:",g:"&Green:",b:"Bl&ue:"}[G],X=document.createElement("input");X.type="text",X.classList.add("inset-deep"),X.dataset.componentLetter=G,X.dataset.min="0",X.dataset.max={h:360,s:100,l:100,r:255,g:255,b:255}[G];const Q=document.createElement("label");Q.innerHTML=render_access_key(H);const ce=22;$(Q).css({position:"absolute",left:63+N*80,top:202+V*ce,textAlign:"right",display:"inline-block",width:40,height:20,lineHeight:"20px"}),$(X).css({position:"absolute",left:106+N*80,top:202+V*ce+(V>1?1:0),width:21,height:14}),m.append(Q,X),J[G]=X})}),m.on("input","input",w=>{const N=w.target,G=N.dataset.componentLetter;if(G)if(N.value.match(/^\d+$/)){let V=Number(N.value);if(V<N.dataset.min?(V=N.dataset.min,N.value=V):V>N.dataset.max&&(V=N.dataset.max,N.value=V),"hsl".indexOf(G)>-1){switch(G){case"h":e=V;break;case"s":c=V;break;case"l":a=V;break}q("rgb")}else{let[H,X,Q]=get_rgba_from_color(o());const ce={r:H,g:X,b:Q};ce[G]=V,l(ce.r,ce.g,ce.b),q("hsl")}D()}else N.value.length&&(q(G),N.select())}),m.on("focusout","input",w=>{const N=w.target,G=N.dataset.componentLetter;G&&(N.value.match(/^\d+$/)||(q(G),N.select()))}),s.on("keydown",w=>{if(w.code==="Enter"&&!w.altKey&&!w.ctrlKey&&!w.metaKey&&!w.shiftKey&&!w.target.closest("button")){n(o()),s.close(),w.preventDefault(),w.stopPropagation();return}if(w.altKey&&!w.ctrlKey&&!w.metaKey&&!w.shiftKey)switch(w.key){case"o":r(o()),q("hslrgb"),D();break;case"b":A.find(".swatch.selected, .swatch").focus();break;case"c":A.find(".swatch.selected, .swatch").focus();break;case"e":J.h.focus();break;case"s":J.s.focus();break;case"l":J.l.focus();break;case"r":J.r.focus();break;case"g":J.g.focus();break;case"u":J.b.focus();break;case"a":z.is(":visible")&&z.click();break;case"d":T.click();break;default:return}else return;w.preventDefault(),w.stopPropagation()});const q=w=>{for(const N of w){const G=J[N],[V,H,X]=get_rgba_from_color(o());G.value=Math.floor({h:e,s:c,l:a,r:V,g:H,b:X}[N])}};m.append(u,b,S,_,M);const z=$('<button class="add-to-custom-colors-button" type="button">').html(render_access_key("&Add To Custom Colors")).appendTo(m).on("click",w=>{w.preventDefault();const N=o();custom_colors[i]=N,update_$swatch($(L[i]),N),i=(i+1)%custom_colors.length,s.removeClass("defining-custom-colors")});s.$Button(localize("OK"),()=>{n(o()),s.close()},{type:"submit"}),s.$Button(localize("Cancel"),()=>{s.close()}),p.append(s.$buttons);for(const w of p.find(".swatch").toArray())if(get_rgba_from_color(w.dataset.color).join(",")===get_rgba_from_color(t).join(",")){d($(w)),w.focus();break}i=Math.max(0,L.indexOf(x.find(".swatch.selected")[0])),s.find(".swatch:focus").length===0&&s.find(".swatch").first().focus(),r(t),q("hslrgb"),s.center()}console.log("JS ì¤í:","$ColorBox.js");function $Swatch(t){const n=$(E("div")).addClass("swatch"),s=make_canvas();return $(s).css({pointerEvents:"none"}).appendTo(n),$G$1.on("theme-load",()=>{update_$swatch(n)}),n.data("swatch",t),update_$swatch(n,t),n}function update_$swatch(t,n){if(n instanceof CanvasPattern)t.addClass("pattern"),t[0].dataset.color="";else if(typeof n=="string")t.removeClass("pattern"),t[0].dataset.color=n;else if(n!==void 0)throw new TypeError(`argument to update_$swatch must be CanvasPattern or string (or undefined); got type ${typeof n}`);n=n||t.data("swatch"),t.data("swatch",n);const s=t.find("canvas")[0];requestAnimationFrame(()=>{s.width=t.innerWidth(),s.height=t.innerHeight(),n&&(s.ctx.fillStyle=n,s.ctx.fillRect(0,0,s.width,s.height))})}function $ColorBox(t){const n=$(E("div")).addClass("color-box"),s=$Swatch(selected_colors.ternary).addClass("current-colors"),e=$(E("div")).addClass("palette");n.append(s,e);const c=$Swatch(selected_colors.foreground).addClass("color-selection foreground-color"),a=$Swatch(selected_colors.background).addClass("color-selection background-color");s.append(a,c),$G$1.on("option-changed",()=>{update_$swatch(c,selected_colors.foreground),update_$swatch(a,selected_colors.background),update_$swatch(s,selected_colors.ternary)}),s.on("pointerdown",()=>{const r=selected_colors.foreground;selected_colors.foreground=selected_colors.background,selected_colors.background=r,$G$1.triggerHandler("option-changed")});const i=r=>{const d=$Swatch(r).addClass("color-button");d.appendTo(e);const h=400;let v=!1,p=null,m;d.on("pointerdown",A=>{button===0&&l.data("$last_fg_color_button",d);const y=A.ctrlKey?"ternary":A.button===0?"foreground":A.button===2?"background":null;y&&(v&&A.button===p?show_edit_colors_window(d,y):(selected_colors[y]=d.data("swatch"),$G$1.trigger("option-changed")),clearTimeout(m),m=setTimeout(()=>{v=!1,p=null},h),v=!0,p=A.button)})},o=()=>{e.empty(),palette.forEach(i);const r=e.find(".color-button");if(t){const d=r.outerHeight()+parseFloat(getComputedStyle(r[0]).getPropertyValue("margin-top"))+parseFloat(getComputedStyle(r[0]).getPropertyValue("margin-bottom"));e.height(Math.ceil(palette.length/2)*d)}else{const d=r.outerWidth()+parseFloat(getComputedStyle(r[0]).getPropertyValue("margin-left"))+parseFloat(getComputedStyle(r[0]).getPropertyValue("margin-right"));e.width(Math.ceil(palette.length/2)*d)}l.data("$last_fg_color_button",e.find(".color-button:first-child"))};let l;return t?(l=$Component(localize("Colors"),"colors-component","tall",n),l.appendTo(get_direction()==="rtl"?$left:$right)):(l=$Component(localize("Colors"),"colors-component","wide",n),l.appendTo($bottom)),o(),$(window).on("theme-change",o),l=l,l.rebuild_palette=o,l}console.log("JS ì¤í:","menus.js");const looksLikeChrome=!!(window.chrome&&(window.chrome.loadTimes||window.chrome.csi)),menus={[localize("&File")]:[{label:localize("&New"),...shortcut(window.is_electron_app?"Ctrl+N":"Ctrl+Alt+N"),speech_recognition:[],action:()=>{file_new()},description:localize("Creates a new document.")},{label:localize("&Open"),...shortcut("Ctrl+O"),speech_recognition:[],action:()=>{file_open()},description:localize("Opens an existing document.")},{label:localize("&Save"),...shortcut("Ctrl+S"),speech_recognition:[],action:()=>{file_save()},description:localize("Saves the active document.")},{label:localize("Save &As"),...shortcut("Ctrl+Shift+S"),speech_recognition:[],action:()=>{file_save_as()},description:localize("Saves the active document with a new name.")},MENU_DIVIDER,{emoji_icon:"ð",label:localize("&Language"),submenu:available_languages.map(t=>({emoji_icon:get_language_emoji(t),label:get_language_endonym(t),action:()=>{set_language(t)},enabled:()=>get_language()!=t,description:localize("Changes the language to %1.",get_iso_language_name(t))}))},{label:localize("&About Paint"),speech_recognition:[],action:()=>{show_about_paint()},description:localize("Displays information about this application.")},MENU_DIVIDER,{label:localize("E&xit"),...shortcut(window.is_electron_app?"Alt+F4":""),speech_recognition:[],action:()=>{are_you_sure$1(()=>{try{if(frameElement&&window.close&&!/\{\s*\[native code\]\s*\}/.test(window.close.toString())||window.is_electron_app){window.close();return}}catch{}window.location="https://98.js.org/"})},description:localize("Quits Paint.")}],[localize("&Edit")]:[{label:localize("&Undo"),...shortcut("Ctrl+Z"),speech_recognition:[],enabled:()=>undos.length>=1,action:()=>{undo()},description:localize("Undoes the last action.")},{label:localize("&Repeat"),...shortcut("F4"),speech_recognition:[],enabled:()=>redos.length>=1,action:()=>{redo()},description:localize("Redoes the previously undone action.")},MENU_DIVIDER,{label:localize("Cu&t"),...shortcut("Ctrl+X"),speech_recognition:[],enabled:()=>!!selection,action:()=>{edit_cut(!0)},description:localize("Cuts the selection and puts it on the Clipboard.")},{label:localize("&Copy"),...shortcut("Ctrl+C"),speech_recognition:[],enabled:()=>!!selection,action:()=>{edit_copy(!0)},description:localize("Copies the selection and puts it on the Clipboard.")},{label:localize("&Paste"),...shortcut("Ctrl+V"),speech_recognition:[],enabled:()=>!0,action:()=>{edit_paste(!0)},description:localize("Inserts the contents of the Clipboard.")},{label:localize("C&lear Selection"),...shortcut("Del"),speech_recognition:[],enabled:()=>!!selection,action:()=>{delete_selection()},description:localize("Deletes the selection.")},{label:localize("Select &All"),...shortcut("Ctrl+A"),speech_recognition:[],action:()=>{select_all()},description:localize("Selects everything.")},MENU_DIVIDER,{label:`${localize("C&opy To")}...`,speech_recognition:[],enabled:()=>!!selection,action:()=>{save_selection_to_file()},description:localize("Copies the selection to a file.")},{label:`${localize("Paste &From")}...`,speech_recognition:[],action:()=>{choose_file_to_paste()},description:localize("Pastes a file into the selection.")}],[localize("&View")]:[{label:localize("Zoom To &Window"),speech_recognition:[],description:localize("Zooms the picture to fit within the view."),action:()=>{const t=$canvas_area[0].getBoundingClientRect(),n=30;let s=Math.min((t.width-n)/main_canvas.width,(t.height-n)/main_canvas.height);s=Math.floor(100*s)/100,set_magnification(s)}},{label:localize("&View Bitmap"),...shortcut("Ctrl+F"),speech_recognition:[],action:()=>{view_bitmap()},description:localize("Displays the entire picture.")},{label:localize("&Fullscreen"),...shortcut("F11"),speech_recognition:[],enabled:()=>!!(document.fullscreenEnabled||document.webkitFullscreenEnabled),checkbox:{check:()=>!!(document.fullscreenElement||document.webkitFullscreenElement),toggle:()=>{document.fullscreenElement||document.webkitFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(),menu_bar.closeMenus()}},description:localize("Makes the application take up the entire screen.")}],[localize("&Image")]:[{label:`${localize("&Attributes")}...`,...shortcut("Ctrl+E"),speech_recognition:[],action:()=>{image_attributes()},description:localize("Changes the attributes of the picture.")},{label:localize("&Clear Image"),...shortcut(window.is_electron_app||!looksLikeChrome?"Ctrl+Shift+N":""),speech_recognition:[],action:()=>{selection||clear()},enabled:()=>!selection,description:localize("Clears the picture.")},{label:localize("&Draw Opaque"),speech_recognition:[],checkbox:{toggle:()=>{tool_transparent_mode=!tool_transparent_mode,$G$1.trigger("option-changed")},check:()=>!tool_transparent_mode},description:localize("Makes the current selection either opaque or transparent.")}]};function shortcut(t){if(!t)return{};const n=t.replace(/Ctrl/g,"Control").replace(/\bDel\b/,"Delete");return validateAriaKeyshortcuts(n)||console.error(`Invalid ARIA key shortcuts: ${JSON.stringify(n)} (from shortcut label: ${JSON.stringify(t)}) (or validator is incomplete)`),{shortcutLabel:t,ariaKeyShortcuts:n}}function validateAriaKeyshortcuts(t){const n=["Alt","Control","Shift","Meta","AltGraph"],s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","1","2","3","4","5","6","7","8","9","0","Delete","Enter","Tab","ArrowRight","ArrowLeft","ArrowUp","ArrowDown","PageUp","PageDown","End","Home","Escape","Space","Plus","Minus","Comma","Period","Slash","Backslash","Quote","Semicolon","BracketLeft","BracketRight","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"],e=t.split(" ");function c(a){const i=a.split("+");if(i.length===0)return!1;let o=!1;for(let l=0;l<i.length;l++){const r=i[l];if(n.includes(r)){if(o)return!1}else if(s.includes(r)){if(o)return!1;o=!0}else return!1}return o}for(let a=0;a<e.length;a++)if(!c(e[a]))return!1;return!0}const ariaKeyShortcutsTestCases=[["Control+A Shift+Alt+B",!0],["Control+Shift+1",!0],["Shift+Alt+T Control+5",!0],["T",!0],["ArrowLeft",!0],["Shift+T Alt+Control",!1],["T+Shift",!1],["Alt",!1],["IncredibleKey",!1],["Ctrl+Shift+A",!1]];for(const[t,n]of ariaKeyShortcutsTestCases){const s=validateAriaKeyshortcuts(t);s!==n&&console.error(`validateAriaKeyshortcuts("${t}") returned ${s} but expected ${n}`)}console.log("JS ì¤í:","app-state.js");const default_magnification$1=1,default_tool$1=window.get_tool_by_id(window.TOOL_PENCIL),default_canvas_width$1=683,default_canvas_height$1=384;let my_canvas_width$1=default_canvas_width$1,my_canvas_height$1=default_canvas_height$1,aliasing$1=!0,transparency$1=!1,magnification$1=default_magnification$1,return_to_magnification$1=4;const main_canvas$1=window.make_canvas();main_canvas$1.classList.add("main-canvas");const main_ctx$1=main_canvas$1.ctx;let palette$1=window.default_palette,polychrome_palette=palette$1,enable_palette_loading_from_indexed_images$1=!1,enable_fs_access_api$1=!1;const default_brush_shape="circle",default_brush_size=4,default_eraser_size=8,default_airbrush_size=9,default_pencil_size=1,default_stroke_size=1;let brush_shape$1=default_brush_shape,brush_size$1=default_brush_size,eraser_size$1=default_eraser_size,airbrush_size$1=default_airbrush_size,pencil_size$1=default_pencil_size,stroke_size$1=default_stroke_size,tool_transparent_mode$1=!1,stroke_color$1,fill_color$1,pick_color_slot$1="background",selected_tool$1=default_tool$1,selected_tools$1=[selected_tool$1],return_to_tools$1=[selected_tool$1],selected_colors$1={foreground:"",background:"",ternary:""},selection$1,textbox$1,helper_layer$1,$thumbnail_window$1,thumbnail_canvas$1,show_grid$1=!1,show_thumbnail=!1,text_tool_font$1={family:'"Arial"',size:12,line_scale:20/12,bold:!1,italic:!1,underline:!1,vertical:!1,color:"",background:""},root_history_node$1=window.make_history_node({name:"App Not Loaded Properly - Please send a bug report."}),current_history_node$1=root_history_node$1,history_node_to_cancel_to$1=null,undos$1=[],redos$1=[],file_name$1,file_format$1,system_file_handle$1,saved$1=!0,pointer$1,pointer_start$1,pointer_previous$1,pointer_active$1=!1,pointer_type$1,pointer_buttons$1,reverse$1,ctrl$1,shift$1,button$1,pointer_over_canvas$1=!1,update_helper_layer_on_pointermove_active$1=!1,pointers$1=[];const state={};state.default_magnification=default_magnification$1;state.default_tool=default_tool$1;state.default_canvas_width=default_canvas_width$1;state.default_canvas_height=default_canvas_height$1;state.my_canvas_width=my_canvas_width$1;state.my_canvas_height=my_canvas_height$1;state.aliasing=aliasing$1;state.transparency=transparency$1;state.magnification=magnification$1;state.return_to_magnification=return_to_magnification$1;state.main_canvas=main_canvas$1;state.main_ctx=main_ctx$1;state.palette=palette$1;state.polychrome_palette=polychrome_palette;state.enable_palette_loading_from_indexed_images=enable_palette_loading_from_indexed_images$1;state.enable_fs_access_api=enable_fs_access_api$1;state.brush_shape=brush_shape$1;state.brush_size=brush_size$1;state.eraser_size=eraser_size$1;state.airbrush_size=airbrush_size$1;state.pencil_size=pencil_size$1;state.stroke_size=stroke_size$1;state.tool_transparent_mode=tool_transparent_mode$1;state.stroke_color=stroke_color$1;state.fill_color=fill_color$1;state.pick_color_slot=pick_color_slot$1;state.selected_tool=selected_tool$1;state.selected_tools=selected_tools$1;state.return_to_tools=return_to_tools$1;state.selected_colors=selected_colors$1;state.selection=selection$1;state.textbox=textbox$1;state.helper_layer=helper_layer$1;state.$thumbnail_window=$thumbnail_window$1;state.thumbnail_canvas=thumbnail_canvas$1;state.show_grid=show_grid$1;state.show_thumbnail=show_thumbnail;state.text_tool_font=text_tool_font$1;state.root_history_node=root_history_node$1;state.current_history_node=current_history_node$1;state.history_node_to_cancel_to=history_node_to_cancel_to$1;state.undos=undos$1;state.redos=redos$1;state.file_name=file_name$1;state.file_format=file_format$1;state.system_file_handle=system_file_handle$1;state.saved=saved$1;state.pointer=pointer$1;state.pointer_start=pointer_start$1;state.pointer_previous=pointer_previous$1;state.pointer_active=pointer_active$1;state.pointer_type=pointer_type$1;state.pointer_buttons=pointer_buttons$1;state.reverse=reverse$1;state.ctrl=ctrl$1;state.shift=shift$1;state.button=button$1;state.pointer_over_canvas=pointer_over_canvas$1;state.update_helper_layer_on_pointermove_active=update_helper_layer_on_pointermove_active$1;state.pointers=pointers$1;Object.keys(state).forEach(t=>{window[t]=state[t]});console.log("JS ì¤í:","app.js");window.update_fill_and_stroke_colors_and_lineWidth=update_fill_and_stroke_colors_and_lineWidth$1;window.tool_go=tool_go;const prependDot=t=>`.${t}`,getMimeType=t=>"mimeType"in t?t.mimeType:`application/x-${t.formatID}`;window.systemHooks=window.systemHooks||{};window.systemHookDefaults={showSaveFileDialog:async({formats:t,defaultFileName:n,defaultPath:s,defaultFileFormatID:e,getBlob:c,savedCallbackUnreliable:a,dialogTitle:i})=>{if(window.showSaveFilePicker&&!window.untrusted_gesture&&enable_fs_access_api){const{newFileFormatID:o}=await save_as_prompt({dialogTitle:i,defaultFileName:n,defaultFileFormatID:e,formats:t,promptForName:!1}),l=t.find(v=>v.formatID===o),r=await c(l&&l.formatID);t=[l];let d,h;try{d=await showSaveFilePicker({types:t.map(A=>({description:A.name,accept:{[getMimeType(A)]:A.extensions.map(prependDot)}}))}),h=d.name;const v=get_file_extension(h),p=async A=>{const y=await showMessageBox$1({message:`${A}

Try adding .${l.extensions[0]} to the name. Sorry about this.`,iconID:"error",buttons:[{label:localize("Save As"),value:"show-save-as-dialog-again",default:!0},{label:localize("Save"),value:"save-without-extension"},{label:localize("Cancel"),value:"cancel"}]});if(y==="show-save-as-dialog-again")return window.systemHookDefaults.showSaveFileDialog({formats:t,defaultFileName:n,defaultPath:s,defaultFileFormatID:e,getBlob:c,savedCallbackUnreliable:a,dialogTitle:i});if(y==="save-without-extension"){const x=await d.createWritable();await x.write(r),await x.close(),a==null||a({newFileName:h,newFileFormatID:l&&l.formatID,newFileHandle:d,newBlob:r})}};if(!v)return await p(`'${h}' doesn't have an extension.`);if(!l.extensions.includes(v))return await p(`File extension '.${v}' does not match the selected file type ${l.name}.`);const m=await d.createWritable();await m.write(r),await m.close()}catch(v){if(v.name==="AbortError")return;if(v.message.match(/gesture|activation/)){show_error_message$1("Sorry, due to browser security measures, you must use the keyboard or mouse directly to save.");return}show_error_message$1(localize("Failed to save document."),v);return}a==null||a({newFileName:h,newFileFormatID:l&&l.formatID,newFileHandle:d,newBlob:r})}else{const{newFileName:o,newFileFormatID:l}=await save_as_prompt({dialogTitle:i,defaultFileName:n,defaultFileFormatID:e,formats:t}),r=await c(l);saveAs(r,o),a==null||a({newFileName:o,newFileFormatID:l,newFileHandle:null,newBlob:r})}},showOpenFileDialog:async({formats:t})=>{if(window.untrusted_gesture)throw show_error_message$1("Sorry, a file picker cannot be shown when using Speech Recognition or Eye Gaze Mode. You must click File > Open directly with the mouse, or press Ctrl+O on the keyboard."),new Error("can't show file picker reliably");if(window.showOpenFilePicker&&enable_fs_access_api){const[n]=await window.showOpenFilePicker({types:t.map(e=>({description:e.name,accept:{[getMimeType(e)]:e.extensions.map(prependDot)}}))});return{file:await n.getFile(),fileHandle:n}}else return new Promise(n=>{const s=$("<input type='file'>").on("change",()=>{n({file:s[0].files[0]}),s.remove()}).appendTo($app$1).hide().trigger("click")})},writeBlobToHandle:async(t,n)=>{if(t&&t.createWritable&&enable_fs_access_api){if(!await confirm_overwrite_capability())return!1;try{const e=await t.createWritable();return await e.write(n),await e.close(),!0}catch(e){if(e.name==="AbortError")return!1;if(e.name==="NotAllowedError")return show_error_message$1(localize("Save was interrupted, so your file has not been saved."),e),!1;if(e.name==="SecurityError"){saveAs(n,file_name);return}}}else{saveAs(n,file_name);return}},readBlobFromHandle:async t=>{if(t&&t.getFile)return await t.getFile();throw new Error(`Unknown file handle (${t})`)},setWallpaperTiled:t=>{const n=make_canvas(screen.width,screen.height),s=n.ctx.createPattern(t,"repeat");n.ctx.fillStyle=s,n.ctx.fillRect(0,0,n.width,n.height),systemHooks.setWallpaperCentered(n)},setWallpaperCentered:t=>{systemHooks.showSaveFileDialog({dialogTitle:localize("Save As"),defaultFileName:`${file_name.replace(/\.(bmp|dib|a?png|gif|jpe?g|jpe|jfif|tiff?|webp|raw)$/i,"")} wallpaper.png`,defaultFileFormatID:"image/png",formats:image_formats,getBlob:n=>new Promise(s=>{write_image_file(t,n,e=>{s(e)})})})}};for(const[t,n]of Object.entries(window.systemHookDefaults))window.systemHooks[t]=window.systemHooks[t]||n;const update_from_url_params=()=>{location.hash.match(/eye-gaze-mode/i)?$("body").hasClass("eye-gaze-mode")||($("body").addClass("eye-gaze-mode"),$G$1.triggerHandler("eye-gaze-mode-toggled"),$G$1.triggerHandler("theme-load")):$("body").hasClass("eye-gaze-mode")&&($("body").removeClass("eye-gaze-mode"),$G$1.triggerHandler("eye-gaze-mode-toggled"),$G$1.triggerHandler("theme-load")),location.hash.match(/vertical-color-box-mode|eye-gaze-mode/i)?$("body").hasClass("vertical-color-box-mode")||($("body").addClass("vertical-color-box-mode"),$G$1.triggerHandler("vertical-color-box-mode-toggled"),$G$1.triggerHandler("theme-load")):$("body").hasClass("vertical-color-box-mode")&&($("body").removeClass("vertical-color-box-mode"),$G$1.triggerHandler("vertical-color-box-mode-toggled"),$G$1.triggerHandler("theme-load")),$("body").toggleClass("compare-reference",!!location.hash.match(/compare-reference/i)),$("body").toggleClass("compare-reference-tool-windows",!!location.hash.match(/compare-reference-tool-windows/i)),setTimeout(()=>{if(location.hash.match(/compare-reference/i)){select_tool(get_tool_by_id(TOOL_SELECT));const t=576,n=432;(main_canvas.width!==t||main_canvas.height!==n)&&resize_canvas_without_saving_dimensions(t,n),location.hash.match(/compare-reference-tool-windows/i)||($toolbox$1.dock($left$1),$colorbox$1.dock($bottom$1),window.debugKeepMenusOpen=!1)}location.hash.match(/compare-reference-tool-windows/i)&&($toolbox$1.undock_to(84,35),$colorbox$1.undock_to(239,195),window.debugKeepMenusOpen=!0,$(".help-menu-button")[0].dispatchEvent(new Event("pointerdown")),$(".help-menu-button")[0].dispatchEvent(new Event("pointerup")),$("[aria-label='About Paint']")[0].dispatchEvent(new Event("pointerenter")))},500)};update_from_url_params();$G$1.on("hashchange popstate change-url-params",update_from_url_params);location.search.match(/eye-gaze-mode/)&&(change_url_param("eye-gaze-mode",!0,{replace_history_state:!0}),update_from_url_params());location.search.match(/vertical-colors?-box/)&&(change_url_param("vertical-color-box",!0,{replace_history_state:!0}),update_from_url_params());const $app$1=$(E("div")).addClass("jspaint").appendTo("body");window.$app=$app$1;const $V=$(E("div")).addClass("vertical").appendTo($app$1),$H=$(E("div")).addClass("horizontal").appendTo($V),$canvas_area$1=$(E("div")).addClass("canvas-area inset-deep").appendTo($H);window.$canvas_area=$canvas_area$1;const $canvas$1=$(main_canvas).appendTo($canvas_area$1);window.$canvas=$canvas$1;$canvas$1.css("touch-action","none");window.canvas_bounding_client_rect=main_canvas.getBoundingClientRect();const canvas_handles$1=new Handles({$handles_container:$canvas_area$1,$object_container:$canvas_area$1,get_rect:()=>({x:0,y:0,width:main_canvas.width,height:main_canvas.height}),set_rect:({width:t,height:n})=>resize_canvas_and_save_dimensions(t,n),outset:4,get_handles_offset_left:()=>parseFloat($canvas_area$1.css("padding-left"))+1,get_handles_offset_top:()=>parseFloat($canvas_area$1.css("padding-top"))+1,get_ghost_offset_left:()=>parseFloat($canvas_area$1.css("padding-left"))+1,get_ghost_offset_top:()=>parseFloat($canvas_area$1.css("padding-top"))+1,size_only:!0});window.canvas_handles=canvas_handles$1;const $top$1=$(E("div")).addClass("component-area top").prependTo($V);window.$top=$top$1;const $bottom$1=$(E("div")).addClass("component-area bottom").appendTo($V);window.$bottom=$bottom$1;const $left$1=$(E("div")).addClass("component-area left").prependTo($H);window.$left=$left$1;const $right$1=$(E("div")).addClass("component-area right").appendTo($H);window.$right=$right$1;get_direction()==="rtl"&&($left$1.appendTo($H),$right$1.prependTo($H));const $status_area=$(E("div")).addClass("status-area").appendTo($V);window.$status_area=$status_area;$(E("div")).addClass("cursor-position").appendTo($status_area);const $status_position$1=$(E("div")).addClass("status-coordinates status-field inset-shallow").appendTo($status_area);window.$status_position=$status_position$1;$(E("div")).addClass("status-divider start").appendTo($status_area);$(E("div")).addClass("shape-size").appendTo($status_area);const $status_size$1=$(E("div")).addClass("status-coordinates status-field inset-shallow").appendTo($status_area);window.$status_size=$status_size$1;$(E("div")).addClass("status-divider").appendTo($status_area);$(E("div")).addClass("screen-size").appendTo($status_area);const $window_Status=$(E("div")).addClass("status-coordinates status-field inset-shallow").appendTo($status_area);window.$window_Status=$window_Status;$(E("div")).addClass("status-divider").appendTo($status_area);$(E("div")).addClass("save-icon").appendTo($status_area);const $file_status=$(E("div")).addClass("status-coordinates status-field inset-shallow").appendTo($status_area);window.$file_status=$file_status;$(E("div")).addClass("status-divider").appendTo($status_area);$(E("div")).addClass("status-spacer").appendTo($status_area);$(E("div")).addClass("status-divider end").appendTo($status_area);const $zoomBox=$(E("div")).addClass("zoom-box").appendTo($status_area),$zoomText=$(E("div")).addClass("zoom-text status-field").text("100%").appendTo($zoomBox);window.$zoomText=$zoomText;const $decreaseButton=$(E("div")).addClass("zoom-button zoom-out").appendTo($zoomBox),$leftSlider=$(E("div")).addClass("added-slider left").appendTo($zoomBox);$(E("div")).addClass("added-slider-content left").appendTo($leftSlider);const sliderArea=$(E("div")).addClass("slider-area").appendTo($zoomBox),$zoomSlider=$(E("div")).appendTo(sliderArea),$rightSlider=$(E("div")).addClass("added-slider right").appendTo($zoomBox);$(E("div")).addClass("added-slider-content right").appendTo($rightSlider);const $increaseButton=$(E("div")).addClass("zoom-button zoom-in").appendTo($zoomBox);$(E("div")).addClass("status-divider end").appendTo($status_area);const values=[0,2,4,8,10,11,12,13,14,15,16],valuesToScale={0:.125,2:.25,4:.5,8:1,10:2,11:3,12:4,13:5,14:6,15:7,16:8};$decreaseButton.on("click",function(){const t=$zoomSlider.slider("value"),n=values.indexOf(t);let s=valuesToScale[t];n>0&&($zoomSlider.slider("value",values[n-1]),s=valuesToScale[values[n-1]]),set_magnification(s)});$increaseButton.on("click",function(){const t=$zoomSlider.slider("value"),n=values.indexOf(t);let s=valuesToScale[t];n<values.length-1&&($zoomSlider.slider("value",values[n+1]),s=valuesToScale[values[n+1]]),set_magnification(s)});$zoomSlider.slider({min:0,max:16,value:8,step:1,create:function(){$(this).find(".ui-slider-handle").html(`
			<svg width="10" height="17" viewBox="0 0 10 17">
				<polygon points="0,0 10,0 10,13 5,17 0,13" fill="#0078D7"></polygon>
			</svg>
		`).addClass("custom-handle")},slide:function(t,n){let s=n.value;if(values.includes(s)){const e=valuesToScale[s];return set_magnification(e),!0}else return!1}});const menu_bar$1=MenuBar(menus);window.menu_bar=menu_bar$1;$(menu_bar$1.element).prependTo($V);$(menu_bar$1.element).on("info",t=>{});$(menu_bar$1.element).on("default-info",()=>{});let $toolbox$1=$ToolBox(tools);window.$toolbox=$toolbox$1;let $colorbox$1=$ColorBox($("body").hasClass("vertical-color-box-mode"));window.$colorbox=$colorbox$1;$G$1.on("vertical-color-box-mode-toggled",()=>{$colorbox$1.destroy(),$colorbox$1=$ColorBox($("body").hasClass("vertical-color-box-mode")),window.$colorbox=$colorbox$1,prevent_selection($colorbox$1)});$G$1.on("eye-gaze-mode-toggled",()=>{$colorbox$1.destroy(),$colorbox$1=$ColorBox($("body").hasClass("vertical-color-box-mode")),window.$colorbox=$colorbox$1,prevent_selection($colorbox$1),$toolbox$1.destroy(),$toolbox$1=$ToolBox(tools),window.$toolbox=$toolbox$1,prevent_selection($toolbox$1)});$G$1.on("resize",()=>{update_canvas_rect(),update_disable_aa()});$canvas_area$1.on("scroll",()=>{update_canvas_rect()});$canvas_area$1.on("resize",()=>{update_magnified_canvas_size()});$G$1.on("scroll focusin",()=>{window.scrollTo(0,0)});$("body").on("dragover dragenter",t=>{const n=t.originalEvent.dataTransfer;n&&Array.from(n.types).includes("Files")&&t.preventDefault()}).on("drop",async t=>{if(t.isDefaultPrevented())return;const n=t.originalEvent.dataTransfer;if(n&&Array.from(n.types).includes("Files")){if(t.preventDefault(),window.FileSystemHandle&&!window.is_electron_app){for(const e of n.items)if(e.kind==="file"){let c;try{"getAsFileSystemHandle"in e&&(c=await e.getAsFileSystemHandle())}catch(a){show_error_message$1(localize("File not found."),a);return}if(!c||c.kind==="file"){let a;try{c&&c instanceof FileSystemFileHandle?a=await c.getFile():a=e.getAsFile()}catch(i){show_error_message$1(localize("File not found."),i);return}if(open_from_file(a,c),window._open_images_serially)await new Promise(i=>setTimeout(i,500));else return}}}else if(n.files&&n.files.length)if(window._open_images_serially){let e=0;const c=setInterval(()=>{console.log("opening",n.files[e].name),open_from_file(n.files[e]),e++,e>=n.files.length&&clearInterval(c)},1500)}else open_from_file(n.files[0])}});$G$1.on("keydown",t=>{var s;const n=t.target;if(!t.isDefaultPrevented()){if(t.key==="Escape"&&textbox&&textbox.$editor.is(n)&&deselect(),(t.ctrlKey||t.metaKey)&&t.shiftKey&&!t.altKey&&t.key.toUpperCase()==="Y"){show_document_history(),t.preventDefault();return}if(!(t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement)){if(selection){const e=(c,a)=>{selection.x+=c,selection.y+=a,selection.position()};switch(t.key){case"ArrowLeft":e(-1,0),t.preventDefault();break;case"ArrowRight":e(1,0),t.preventDefault();break;case"ArrowDown":e(0,1),t.preventDefault();break;case"ArrowUp":e(0,-1),t.preventDefault();break}}if(t.key==="Escape")selection?deselect():cancel();else if(t.key==="Enter")selection&&deselect();else if(t.key==="F4")redo();else if(t.key==="Delete"||t.key==="Backspace")t.key==="Delete"&&t.shiftKey?edit_cut():t.key==="Backspace"&&t.altKey?undo():delete_selection(),t.preventDefault();else if(t.key==="Insert")t.ctrlKey?(edit_copy(),t.preventDefault()):t.shiftKey&&(edit_paste(),t.preventDefault());else if(t.code==="NumpadAdd"||t.code==="NumpadSubtract"||t.key==="+"||t.key==="-"||t.key==="="){const e=t.code==="NumpadAdd"||t.key==="+"||t.key==="=",c=t.code==="NumpadSubtract"||t.key==="-",a=Number(e)-Number(c);selection?selection.scale(2**a):(selected_tool.id===TOOL_BRUSH?brush_size=Math.max(1,Math.min(brush_size+a,500)):selected_tool.id===TOOL_ERASER?eraser_size=Math.max(1,Math.min(eraser_size+a,500)):selected_tool.id===TOOL_AIRBRUSH?airbrush_size=Math.max(1,Math.min(airbrush_size+a,500)):selected_tool.id===TOOL_PENCIL?pencil_size=Math.max(1,Math.min(pencil_size+a,50)):(selected_tool.id===TOOL_LINE||selected_tool.id===TOOL_CURVE||selected_tool.id===TOOL_RECTANGLE||selected_tool.id===TOOL_ROUNDED_RECTANGLE||selected_tool.id===TOOL_ELLIPSE||selected_tool.id===TOOL_POLYGON)&&(stroke_size=Math.max(1,Math.min(stroke_size+a,500))),$G$1.trigger("option-changed"),button!==void 0&&pointer&&selected_tools.forEach(i=>{tool_go(i)}),update_helper_layer()),t.preventDefault();return}else if(t.ctrlKey||t.metaKey){if(textbox)switch(t.key.toUpperCase()){case"A":case"Z":case"Y":case"I":case"B":case"U":return}if(t.key==="PageDown"){set_magnification(4),t.preventDefault();return}else if(t.key==="PageUp"){set_magnification(1),t.preventDefault();return}switch(t.key.toUpperCase()){case",":case"<":case"[":case"{":rotate(-TAU/4);break;case".":case">":case"]":case"}":rotate(+TAU/4);break;case"Z":t.shiftKey?redo():undo();break;case"Y":redo();break;case"G":break;case"F":!t.repeat&&!((s=t.originalEvent)!=null&&s.repeat)&&view_bitmap();break;case"O":file_open();break;case"S":t.shiftKey?file_save_as():file_save();break;case"A":select_all();break;case"I":image_invert_colors();break;case"E":image_attributes();break;case"N":t.shiftKey?clear():file_new();break;case"T":$toolbox$1.toggle();break;case"L":$colorbox$1.toggle();break;case"R":image_flip_and_rotate();break;case"W":image_stretch_and_skew();break;default:return}t.preventDefault()}}}});let alt_zooming=!1;addEventListener("keyup",t=>{t.key==="Alt"&&alt_zooming&&t.preventDefault(),t.altKey||(alt_zooming=!1)});addEventListener("wheel",t=>{if(t.altKey){t.preventDefault();let n=magnification;t.deltaY<0?n*=1.5:n/=1.5,n=Math.max(.5,Math.min(n,80)),set_magnification(n,to_canvas_coords(t)),alt_zooming=!0;return}if(!(t.ctrlKey||t.metaKey)&&location.hash.match(/compare-reference/i)){const n=Math.sign(t.deltaY)*-.2;let s=parseFloat($("body").attr("data-reference-opacity"));isFinite(s)||(s=.5);const e=Math.max(0,Math.min(1,s+n));$("body").attr("data-reference-opacity",e)}},{passive:!1});$G$1.on("cut copy paste",t=>{if(t.isDefaultPrevented()||document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement||!window.getSelection().isCollapsed)return;t.preventDefault();const n=t.originalEvent.clipboardData||window.clipboardData;if(n){if(t.type==="copy"||t.type==="cut"){if(selection&&selection.canvas){const s=()=>{const e=selection.canvas.toDataURL();n.setData("text/x-data-uri; type=image/png",e),n.setData("text/uri-list",e),n.setData("URL",e),t.type==="cut"&&delete_selection({name:localize("Cut"),icon:get_help_folder_icon("p_cut.png")})};if(!navigator.clipboard||!navigator.clipboard.write)return s();try{t.type==="cut"?edit_cut():edit_copy()}catch{s()}}}else if(t.type==="paste"){for(const s of n.items)if(s.type.match(/^text\/(?:x-data-uri|uri-list|plain)|URL$/)){s.getAsString(e=>{const c=get_uris(e);c.length>0?load_image_from_uri(c[0]).then(a=>{paste(a.image||make_canvas(a.image_data))},a=>{show_resource_load_error_message(a)}):show_error_message$1("The information on the Clipboard can't be inserted into Paint.")});break}else if(s.type.match(/^image\//)){paste_image_from_file(s.getAsFile());break}}}});reset_file();reset_selected_colors();reset_canvas_and_history();set_magnification(default_magnification);localStore.get({width:default_canvas_width,height:default_canvas_height},(t,n)=>{t||(my_canvas_width=Number(n.width),my_canvas_height=Number(n.height),make_or_update_undoable({match:s=>s.name===localize("New"),name:"Resize Canvas For New Document",icon:get_help_folder_icon("p_stretch_both.png")},()=>{main_canvas.width=Math.max(1,my_canvas_width),main_canvas.height=Math.max(1,my_canvas_height),main_ctx.disable_image_smoothing(),transparency||(main_ctx.fillStyle=selected_colors.background,main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height)),$canvas_area$1.trigger("resize")}))});window.initial_system_file_handle&&systemHooks.readBlobFromHandle(window.initial_system_file_handle).then(t=>{t&&open_from_file(t,window.initial_system_file_handle)},t=>{show_error_message$1(`Failed to open file ${window.initial_system_file_handle}`,t)});const update_palette_from_theme=()=>{palette=default_palette,$colorbox$1.rebuild_palette()};$G$1.on("theme-load",update_palette_from_theme);update_palette_from_theme();function update_fill_and_stroke_colors_and_lineWidth$1(t){main_ctx.lineWidth=stroke_size;const n=!!(t.$options&&t.$options.fill&&!t.$options.stroke),s=ctrl&&selected_colors.ternary&&pointer_active?"ternary":reverse!==n?"background":"foreground";main_ctx.fillStyle=fill_color=main_ctx.strokeStyle=stroke_color=selected_colors[s];let e=ctrl?"ternary":reverse!==n?"background":"foreground",c=e;(t.shape||t.shape_colors)&&(t.stroke_only||(reverse!==n?(e="foreground",c="background"):(e="background",c="foreground")),main_ctx.fillStyle=fill_color=selected_colors[e],main_ctx.strokeStyle=stroke_color=selected_colors[c]),pick_color_slot=e}function tool_go(t,n){update_fill_and_stroke_colors_and_lineWidth$1(t),t[n]&&t[n](main_ctx,pointer.x,pointer.y),t.paint&&t.paint(main_ctx,pointer.x,pointer.y)}function canvas_pointer_move(t){if(ctrl=t.ctrlKey,shift=t.shiftKey,pointer=to_canvas_coords(t),pointers.length&&t.button!=-1&&(t.pointerType!=pointer_type||(t.buttons|4)!=(pointer_buttons|4))){cancel(),pointer_active=!1;return}if(t.shiftKey){if(selected_tool.id===TOOL_LINE||selected_tool.id===TOOL_CURVE){const n=Math.sqrt((pointer.y-pointer_start.y)*(pointer.y-pointer_start.y)+(pointer.x-pointer_start.x)*(pointer.x-pointer_start.x)),s=TAU/8,e=Math.atan2(pointer.y-pointer_start.y,pointer.x-pointer_start.x)/s,c=Math.round(e)*s;pointer.x=Math.round(pointer_start.x+Math.cos(c)*n),pointer.y=Math.round(pointer_start.y+Math.sin(c)*n)}else if(selected_tool.shape){const n=Math.abs(pointer.x-pointer_start.x),s=Math.abs(pointer.y-pointer_start.y);n<s?pointer.y>pointer_start.y?pointer.y=pointer_start.y+n:pointer.y=pointer_start.y-n:pointer.x>pointer_start.x?pointer.x=pointer_start.x+s:pointer.x=pointer_start.x-s}}selected_tools.forEach(n=>{tool_go(n)}),pointer_previous=pointer}$canvas$1.on("pointermove",t=>{pointer=to_canvas_coords(t),$status_position$1.text(`${pointer.x}, ${pointer.y} px`)});$canvas$1.on("pointerenter",t=>{pointer_over_canvas=!0,update_helper_layer(t),update_helper_layer_on_pointermove_active||($G$1.on("pointermove",update_helper_layer),update_helper_layer_on_pointermove_active=!0)});$canvas$1.on("pointerleave",t=>{pointer_over_canvas=!1,$status_position$1.text(""),update_helper_layer(t),!pointer_active&&update_helper_layer_on_pointermove_active&&($G$1.off("pointermove",update_helper_layer),update_helper_layer_on_pointermove_active=!1)});let last_zoom_pointer_distance,pan_last_pos,first_pointer_time;const discard_quick_undo_period=500;function average_points(t){const n={x:0,y:0};for(const s of t)n.x+=s.x,n.y+=s.y;return n.x/=t.length,n.y/=t.length,n}$canvas_area$1.on("pointerdown",t=>{if(document.activeElement instanceof HTMLElement&&document.activeElement!==document.body&&document.activeElement!==document.documentElement&&document.activeElement.blur(),pointers.every(n=>n.pointerId!==1234567890&&!(n.isPrimary&&(n.pointerType==="mouse"||n.pointerType==="pen")))&&pointers.push({pointerId:t.pointerId,pointerType:t.pointerType,isPrimary:t.originalEvent&&t.originalEvent.isPrimary||t.isPrimary,x:t.clientX,y:t.clientY}),pointers.length===1&&(first_pointer_time=performance.now()),pointers.length==2&&(last_zoom_pointer_distance=Math.hypot(pointers[0].x-pointers[1].x,pointers[0].y-pointers[1].y),pan_last_pos=average_points(pointers)),pointers.length>=2){const n=first_pointer_time&&performance.now()-first_pointer_time<discard_quick_undo_period;cancel(!1,n),pointer_active=!1;return}});$G$1.on("pointerup pointercancel",t=>{pointers=pointers.filter(n=>n.pointerId!==t.pointerId)});$G$1.on("pointermove",t=>{for(const n of pointers)n.pointerId===t.pointerId&&(n.x=t.clientX,n.y=t.clientY);if(pointers.length>=2){const n=average_points(pointers),s=Math.hypot(pointers[0].x-pointers[1].x,pointers[0].y-pointers[1].y),e=s-last_zoom_pointer_distance;let c=magnification;Math.abs(e)>60&&(last_zoom_pointer_distance=s,e>0?c*=1.5:c/=1.5),c=Math.max(.5,Math.min(c,40)),c!=magnification&&set_magnification(c,to_canvas_coords({clientX:n.x,clientY:n.y}));const a=n.x-pan_last_pos.x,i=n.y-pan_last_pos.y;$canvas_area$1.scrollLeft($canvas_area$1.scrollLeft()-a),$canvas_area$1.scrollTop($canvas_area$1.scrollTop()-i),pan_last_pos=n}});$canvas$1.on("pointerdown",t=>{if($status_size$1.text(""),update_canvas_rect(),pointers.length>=1){const s=first_pointer_time&&performance.now()-first_pointer_time<discard_quick_undo_period;cancel(!1,s),pointer_active=!1,pointers=pointers.filter(e=>e.pointerId!==1234567890);return}if(history_node_to_cancel_to=current_history_node,pointer_active=!!(t.buttons&3),pointer_type=t.pointerType,pointer_buttons=t.buttons,$G$1.one("pointerup",s=>{pointer_active=!1,update_helper_layer(s),!pointer_over_canvas&&update_helper_layer_on_pointermove_active&&($G$1.off("pointermove",update_helper_layer),update_helper_layer_on_pointermove_active=!1)}),t.button===0)reverse=!1;else if(t.button===2)reverse=!0;else return;button=t.button,ctrl=t.ctrlKey,shift=t.shiftKey,pointer_start=pointer_previous=pointer=to_canvas_coords(t),(()=>{let s=[];selected_tools.forEach(e=>{(e.paint||e.pointerdown)&&tool_go(e,"pointerdown"),e.paint_on_time_interval!=null&&s.push(setInterval(()=>{tool_go(e)},e.paint_on_time_interval))}),$G$1.on("pointermove",canvas_pointer_move),$G$1.one("pointerup",(e,c,a)=>{button=void 0,reverse=!1,e.clientX!==void 0&&(pointer=to_canvas_coords(e)),a||selected_tools.forEach(i=>{var o;(o=i.pointerup)==null||o.call(i,main_ctx,pointer.x,pointer.y)}),selected_tools.length===1&&selected_tool.deselect&&select_tools(return_to_tools),$G$1.off("pointermove",canvas_pointer_move);for(const i of s)clearInterval(i);c||(history_node_to_cancel_to=null)})})(),update_helper_layer(t)});$canvas_area$1.on("pointerdown",t=>{t.button===0&&$canvas_area$1.is(t.target)&&selection&&deselect()});function prevent_selection(t){t.on("mousedown selectstart contextmenu",n=>{n.isDefaultPrevented()||n.target instanceof HTMLSelectElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLLabelElement&&n.type!=="contextmenu"||n.target instanceof HTMLInputElement&&n.target.type!=="color"||n.button!==1&&(n.preventDefault(),window.getSelection().removeAllRanges())})}prevent_selection($app$1);prevent_selection($toolbox$1);prevent_selection($colorbox$1);$G$1.on("blur",()=>{$G$1.triggerHandler("pointerup")});function iOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}$("html").toggleClass("ios",iOS());$G$1.on("fullscreenchange webkitfullscreenchange",()=>{const t=!!(document.fullscreenElement||document.webkitFullscreenElement);$("html").toggleClass("fullscreen",t)});init_webgl_stuff();console.log("JS ì¤í:","session.js");const log=(...t)=>{var n;(n=window.console)==null||n.log(...t)};let localStorageAvailable=!1;try{localStorage._available=!0,localStorageAvailable=localStorage._available,delete localStorage._available}catch(t){}const match_threshold=1,canvas_has_any_apparent_image_data=()=>main_canvas.ctx.getImageData(0,0,main_canvas.width,main_canvas.height).data.some(t=>t>match_threshold);let $recovery_window;function show_recovery_window(t){$recovery_window==null||$recovery_window.close();const n=$recovery_window=$DialogWindow();n.on("close",()=>{$recovery_window=null}),n.title("Recover Document");let s=!1;try{window.localStorage.getItem("bogus test key")}catch{s=!0}n.$main.append($(`
		<p>Woah! The canvas became empty.</p>
		<p>If this was on purpose, please ignore this message.</p>
		<p>
			If the canvas was cleared due to memory usage,<br>
			click Undo to recover the document.
		</p>
		<!--<p>Remember to save with <b>File > Save</b>!</p>-->
		${s?"<p><b>Note:</b> No automatic backup is possible unless you enable Cookies in your browser.</p>":t?`<hr>
					<p style="opacity: 0.8; font-size: 0.9em;">
						Auto-save is paused while this dialog is open.
					</p>
					<p style="opacity: 0.8; font-size: 0.9em;">
						(See <b>File &gt; Manage Storage</b> to view backups.)
					</p>`:""}
	`));const e=n.$Button("Undo",()=>{undo()}),c=n.$Button("Redo",()=>{redo()}),a=()=>{e.prop("disabled",undos.length<1),c.prop("disabled",redos.length<1)};$G$1.on("session-update.session-hook",a),a(),n.$Button(localize("Close"),()=>{n.close()}),n.center(),n.find("button:enabled").focus()}let last_undos_length=undos.length;function handle_data_loss(){const t=$recovery_window&&!$recovery_window.closed;let n=!1;return canvas_has_any_apparent_image_data()?t&&(undos.length>last_undos_length&&show_recovery_window(!0),n=!0):(t||show_recovery_window(),n=!0),last_undos_length=undos.length,n}class LocalSession{constructor(n){this.id=n;const s=`image#${n}`;log(`Local storage key: ${s}`),this.save_image_to_storage_immediately=()=>{handle_data_loss()||(log(`Saving image to storage: ${s}`),localStore.set(s,main_canvas.toDataURL("image/png"),c=>{}))},this.save_image_to_storage_soon=debounce(this.save_image_to_storage_immediately,100),localStore.get(s,(e,c)=>{e?localStorageAvailable?show_error_message$1("Failed to retrieve image from local storage.",e):showMessageBox$1({message:"Please enable local storage in your browser's settings for local backup. It may be called Cookies, Storage, or Site Data."}):c?load_image_from_uri(c).then(a=>{open_from_image_info(a,null,null,!0,!0)},a=>{show_error_message$1("Failed to open image from local storage.",a)}):this.save_image_to_storage_soon()}),$G$1.on("session-update.session-hook",()=>{this.save_image_to_storage_soon()})}end(){this.save_image_to_storage_soon.cancel(),this.save_image_to_storage_immediately(),$G$1.off(".session-hook")}}let user_id;const user={cursor:{x:0,y:0,away:!0},tool:localize("Pencil"),hue:~~(Math.random()*360),saturation:~~(Math.random()*50)+50,lightness:~~(Math.random()*40)+50};user.color=`hsla(${user.hue}, ${user.saturation}%, ${user.lightness}%, 1)`;user.color_transparent=`hsla(${user.hue}, ${user.saturation}%, ${user.lightness}%, 0.5)`;user.color_desaturated=`hsla(${user.hue}, ${~~(user.saturation*.4)}%, ${user.lightness}%, 0.8)`;const cursor_image=new Image;cursor_image.src="images/cursors/default.png";class FirebaseSession{constructor(n){this.id=n,this._fb_listeners=[],file_name=`[Loading ${this.id}]`,update_title();const s=()=>{file_name=`[${this.id}]`,update_title(),this.start()};if(FirebaseSession.fb_root)s();else{var e=document.createElement("script");e.addEventListener("load",()=>{const c={apiKey:"AIzaSyBgau8Vu9ZE8u_j0rp-Lc044gYTX5O3X9k",authDomain:"jspaint.firebaseapp.com",databaseURL:"https://jspaint.firebaseio.com",projectId:"firebase-jspaint",storageBucket:"",messagingSenderId:"63395010995"};firebase.initializeApp(c),FirebaseSession.fb_root=firebase.database().ref("/"),s()}),e.addEventListener("error",()=>{show_error_message$1("Failed to load Firebase; the document will not load, and changes will not be saved."),file_name=`[Failed to load ${this.id}]`,update_title()}),e.src="lib/firebase.js",document.head.appendChild(e)}}start(){showMessageBox$1({messageHTML:`
				<p>The document may not load. Changes may not save.</p>
				<p>Multiuser sessions are public. There is no security.</p>
			`});const n=(c,a,i,o)=>{this._fb_listeners.push({fb:c,event_type:a,callback:i,error_callback:o}),c.on(a,i,o)};this.fb=FirebaseSession.fb_root.child(this.id),this.fb_data=this.fb.child("data"),this.fb_users=this.fb.child("users"),user_id?this.fb_user=this.fb_users.child(user_id):(this.fb_user=this.fb_users.push(),user_id=this.fb_user.key),this.fb_user.onDisconnect().remove(),this.fb_user.set(user),n(this.fb_users,"child_added",c=>{if(c.key===user_id)return;const a=c.ref;let i=c.val();const o=make_canvas(32,32),l=$(o).addClass("user-cursor").appendTo($app);l.css({display:"none",position:"absolute",left:0,top:0,opacity:0,zIndex:5,pointerEvents:"none",transition:"opacity 0.5s"}),n(a,"value",r=>{if(i=r.val(),i==null)l.remove();else{const d=()=>{o.width=cursor_image.width,o.height=cursor_image.height;const v=o.ctx;v.fillStyle=i.color,v.fillRect(0,0,o.width,o.height),v.globalCompositeOperation="multiply",v.drawImage(cursor_image,0,0),v.globalCompositeOperation="destination-atop",v.drawImage(cursor_image,0,0)};cursor_image.complete?d():$(cursor_image).one("load",d);const h=window.canvas_bounding_client_rect;l.css({display:"block",position:"absolute",left:h.left+magnification*i.cursor.x,top:h.top+magnification*i.cursor.y,opacity:1-i.cursor.away})}})});let s;this.write_canvas_to_database_immediately=()=>{if(handle_data_loss())return;const a=main_canvas.toDataURL();s!==a?(log("Write canvas data to Firebase"),this.fb_data.set(a),s=a):log("(Don't write canvas data to Firebase; it hasn't changed)")},this.write_canvas_to_database_soon=debounce(this.write_canvas_to_database_immediately,100);let e=!1;$G$1.on("session-update.session-hook",()=>{if(e){log("(Ignore session-update from Sync Session undoable)");return}this.write_canvas_to_database_soon()}),n(this.fb_data,"value",c=>{log("Firebase data update");const a=c.val();if(a==null)this.write_canvas_to_database_soon();else{s=a;const i=new Image;i.onload=()=>{const o=make_canvas(i),l=o.ctx.getImageData(0,0,o.width,o.height),r=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height);image_data_match(l,r,5)||(e=!0,undoable({name:"Sync Session",icon:get_help_folder_icon("p_database.png")},()=>{main_ctx.copy(i),$canvas_area.trigger("resize")}),e=!1)},i.src=a}},c=>{show_error_message$1("Failed to retrieve data from Firebase. The document will not load, and changes will not be saved.",c),file_name=`[Failed to load ${this.id}]`,update_title()}),$G$1.on("pointermove.session-hook",c=>{const a=to_canvas_coords(c);this.fb_user.child("cursor").update({x:a.x,y:a.y,away:!1})}),$G$1.on("blur.session-hook",()=>{this.fb_user.child("cursor").update({away:!0})})}end(){this.write_canvas_to_database_soon.cancel(),this.write_canvas_to_database_immediately(),$G$1.off(".session-hook"),this._fb_listeners.forEach(({fb:n,event_type:s,callback:e,_error_callback:c})=>{log(`Remove listener for ${n.path.toString()} .on ${s}`),n.off(s,e)}),this._fb_listeners.length=0,this.fb_user.remove(),$app.find(".user-cursor").remove(),reset_file()}}FirebaseSession.fb_root=null;class RESTSession{constructor(n){this.id=n,file_name=`[Loading ${this.id}]`,update_title(),this.start(),this._previous_uri="",this._ignore_session_update=!1,this._poll_tid=-1,this._poll_fetch_start_time=-1,this._last_write_time=-1}async _write_canvas_to_server_immediately(){if(handle_data_loss())return;const s=main_canvas.toDataURL();this._previous_uri!==s?(log("Write canvas data to server"),this._previous_uri=s,this._last_write_time=performance.now(),await fetch(`/api/rooms/${this.id}/data`,{method:"PUT",body:s}),this._last_write_time=performance.now()):log("(Don't write canvas data to server; it hasn't changed)")}start(){this._write_canvas_to_server_soon=debounce(this._write_canvas_to_server_immediately,100),$G$1.on("session-update.session-hook",()=>{if(this._ignore_session_update){log("(Ignore session-update from Sync Session undoable)");return}this._write_canvas_to_server_soon(),this._last_write_time=performance.now()});const n=async()=>{let s;try{this._poll_fetch_start_time=performance.now();const e=await fetch(`/api/rooms/${this.id}/data`);e.status===404?s=null:s=await e.text()}catch(e){show_error_message$1("Failed to load image document from the server.",e),file_name=`[Failed to load ${this.id}]`,update_title();return}file_name=`[${this.id}]`,update_title(),this.handle_data_snapshot(s,this._poll_fetch_start_time),this._poll_tid=setTimeout(n,1e3)};n()}handle_data_snapshot(n,s){if(!n)this._write_canvas_to_server_soon(),this._last_write_time=performance.now();else{this._previous_uri=n;const e=new Image;e.onload=()=>{if(this._last_write_time>s){log("(Ignore stale image data)");return}const c=make_canvas(e),a=c.ctx.getImageData(0,0,c.width,c.height),i=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height);image_data_match(a,i,5)||(this._ignore_session_update=!0,undoable({name:"Sync Session",icon:get_help_folder_icon("p_database.png")},()=>{main_ctx.copy(e),$canvas_area.trigger("resize")}),this._ignore_session_update=!1)},e.onerror=()=>{show_error_message$1("Failed to load image document from the server. Invalid image data.",n)},e.src=n}}end(){clearTimeout(this._poll_tid),this._write_canvas_to_server_soon.cancel(),this._write_canvas_to_server_immediately(),$G$1.off(".session-hook"),$app.find(".user-cursor").remove(),reset_file()}}let current_session;const end_current_session=()=>{current_session&&(log("Ending current session"),current_session.end(),current_session=null)},generate_session_id=()=>(Math.random()*2**32).toString(16).replace(".",""),update_session_from_location_hash=()=>{const t=location.hash.match(/^#?(?:.*,)?(session|local):(.*)$/i),n=location.hash.match(/^#?(?:.*,)?(load):(.*)$/i);if(t){const s=t[1].toLowerCase()==="local",e=t[2];if(e==="")log("Invalid session ID; session ID cannot be empty"),end_current_session();else if(!s&&e.match(/[./[\]#$]/))log("Session ID is not a valid Firebase location; it cannot contain any of ./[]#$"),end_current_session();else if(!e.match(/[-0-9A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02af\u1d00-\u1d25\u1d62-\u1d65\u1d6b-\u1d77\u1d79-\u1d9a\u1e00-\u1eff\u2090-\u2094\u2184-\u2184\u2488-\u2490\u271d-\u271d\u2c60-\u2c7c\u2c7e-\u2c7f\ua722-\ua76f\ua771-\ua787\ua78b-\ua78c\ua7fb-\ua7ff\ufb00-\ufb06]+/))log("Invalid session ID; it must consist of 'alphanumeric-esque' characters"),end_current_session();else if(current_session&&current_session.id===e&&s===current_session instanceof LocalSession)log("Hash changed but the session ID and session type are the same");else{end_current_session();let c="FirebaseSession";try{c=localStorage.online_session_implementation||c}catch{}s?(log(`Starting a new LocalSession, ID: ${e}`),current_session=new LocalSession(e)):c==="RESTSession"?(log(`Starting a new RESTSession, ID: ${e}`),current_session=new RESTSession(e)):c==="FirebaseSession"?(log(`Starting a new FirebaseSession, ID: ${e}`),current_session=new FirebaseSession(e)):(show_error_message$1(`Invalid online session implementation '${c}'`),current_session=new LocalSession(e))}}else if(n){const s=decodeURIComponent(n[2]);if(get_uris(s).length===0){show_error_message$1("Invalid URL to load (after #load: in the address bar). It must include a protocol (https:// or http://)");return}log("Switching to new session from #load: URL (to #local: URL with session ID)"),end_current_session(),change_url_param("local",generate_session_id()),load_image_from_uri(s).then(c=>{open_from_image_info(c,null,null,!0,!0)},show_resource_load_error_message)}else{log("No session ID in hash");const s=location.hash;end_current_session(),change_url_param("local",generate_session_id(),{replace_history_state:!0}),log("After replaceState:",location.hash),s===location.hash?show_error_message$1("Autosave is disabled. Failed to update URL to start session."):update_session_from_location_hash()}};$G$1.on("hashchange popstate change-url-params",t=>{log(t.type,location.hash),update_session_from_location_hash()});const new_local_session$1=()=>{end_current_session(),log("Changing URL to start new session..."),change_url_param("local",generate_session_id())};log("Initializing with location hash:",location.hash);update_session_from_location_hash();window.new_local_session=new_local_session$1});export default zi();
