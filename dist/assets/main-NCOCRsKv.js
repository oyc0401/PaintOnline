var Qi=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports);var er=Qi((exports,module)=>{(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))t(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function o(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(l){if(l.ep)return;l.ep=!0;const a=o(l);fetch(l.href,a)}})();console.log("JS 실행:","theme.js");const default_theme="modern.css",theme_storage_key="jspaint theme",disable_seasonal_theme_key="jspaint disable seasonal theme",href_for=e=>`styles/themes/${e}`;let iid;function wait_for_theme_loaded(e,n){clearInterval(iid),iid=setInterval(()=>{getComputedStyle(document.documentElement).getPropertyValue("--theme-loaded").replace(/['"]+/g,"").trim()===e&&(clearInterval(iid),n())},15)}let grinch_button,current_theme;try{const e=localStorage[disable_seasonal_theme_key]==="true";new Date().getMonth()===11&&!e?(current_theme="winter.css",wait_for_theme_loaded(current_theme,()=>{make_grinch_button()})):current_theme=localStorage[theme_storage_key]||default_theme}catch(e){console.error(e),current_theme=default_theme}const theme_link=document.createElement("link");theme_link.rel="stylesheet";theme_link.type="text/css";theme_link.href=href_for(current_theme);theme_link.id="theme-link";document.head.appendChild(theme_link);update_not_for_modern_theme();const get_theme=()=>current_theme,set_theme=e=>{console.log(e),current_theme=e;try{localStorage[theme_storage_key]=e,localStorage[disable_seasonal_theme_key]="true",grinch_button==null||grinch_button.remove()}catch{}const n=()=>{$(window).triggerHandler("theme-load"),$(window).trigger("resize")};wait_for_theme_loaded(e,n),theme_link.href=href_for(e),update_not_for_modern_theme(),n()};function update_not_for_modern_theme(){const e=document.querySelectorAll("link.not-for-modern");for(const n of e)n.disabled=current_theme==="modern.css"||current_theme==="modern-dark.css"||current_theme==="bubblegum.css"}function make_grinch_button(){const e=document.createElement("button");e.ariaLabel="Disable seasonal theme",e.className="grinch-button";let n=!1,o=0,t=0,l=0,a;const i=38,s=100;e.onclick=()=>{o===l&&f(),n=!0};const c=e.onmouseleave=()=>{l=n?1:0,h(),document.removeEventListener("touchmove",d)},r=e.onmouseenter=()=>{l=1,t=Math.max(t,.02),h()};e.onpointerdown=g=>{g.pointerType==="touch"&&(c(),document.addEventListener("touchmove",d))};function d(g){var x=g.touches[0];e!==document.elementFromPoint(x.pageX,x.pageY)&&(n=!1,r())}function h(){cancelAnimationFrame(a),o+=t*.5,t*=.9,l?t+=.001:o<.4?t-=5e-4:t-=.001,o>1?(o=1,t=0,n&&f()):o<0&&(o=0,t=0),o!==l&&(a=requestAnimationFrame(h)),e.style.backgroundPosition=`${-Math.floor(o*(i-1))*s}px 0px`}function m(){e.style.transform=`scale(${Math.max(1,Math.floor(devicePixelRatio))/devicePixelRatio})`,e.style.transformOrigin="bottom right",e.style.imageRendering="pixelated"}window.addEventListener("resize",m),m();function f(){let g;try{localStorage[disable_seasonal_theme_key]="true",g=localStorage[theme_storage_key]||default_theme}catch{}g==="winter.css"&&(g=default_theme),set_theme(g),e.remove(),window.removeEventListener("resize",m),document.removeEventListener("touchmove",d)}document.body.appendChild(e),grinch_button=e}/*! jQuery v3.4.1 | (c) JS Foundation and other contributors | jquery.org/license */(function(e,n){typeof module=="object"&&typeof module.exports=="object"?module.exports=e.document?n(e,!0):function(o){if(!o.document)throw new Error("jQuery requires a window with a document");return n(o)}:n(e)})(typeof window<"u"?window:void 0,function(e,n){var o=[],t=e.document,l=Object.getPrototypeOf,a=o.slice,i=o.concat,s=o.push,c=o.indexOf,r={},d=r.toString,h=r.hasOwnProperty,m=h.toString,f=m.call(Object),g={},x=function(p){return typeof p=="function"&&typeof p.nodeType!="number"},b=function(p){return p!=null&&p===p.window},A={type:!0,src:!0,nonce:!0,noModule:!0};function M(p,R,z){var V,ie,ce=(z=z||t).createElement("script");if(ce.text=p,R)for(V in A)(ie=R[V]||R.getAttribute&&R.getAttribute(V))&&ce.setAttribute(V,ie);z.head.appendChild(ce).parentNode.removeChild(ce)}function L(p){return p==null?p+"":typeof p=="object"||typeof p=="function"?r[d.call(p)]||"object":typeof p}var C="3.4.1",u=function(p,R){return new u.fn.init(p,R)},_=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function y(p){var R=!!p&&"length"in p&&p.length,z=L(p);return!x(p)&&!b(p)&&(z==="array"||R===0||typeof R=="number"&&0<R&&R-1 in p)}u.fn=u.prototype={jquery:C,constructor:u,length:0,toArray:function(){return a.call(this)},get:function(p){return p==null?a.call(this):p<0?this[p+this.length]:this[p]},pushStack:function(p){var R=u.merge(this.constructor(),p);return R.prevObject=this,R},each:function(p){return u.each(this,p)},map:function(p){return this.pushStack(u.map(this,function(R,z){return p.call(R,z,R)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(p){var R=this.length,z=+p+(p<0?R:0);return this.pushStack(0<=z&&z<R?[this[z]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:o.sort,splice:o.splice},u.extend=u.fn.extend=function(){var p,R,z,V,ie,ce,de=arguments[0]||{},ye=1,Te=arguments.length,$e=!1;for(typeof de=="boolean"&&($e=de,de=arguments[ye]||{},ye++),typeof de=="object"||x(de)||(de={}),ye===Te&&(de=this,ye--);ye<Te;ye++)if((p=arguments[ye])!=null)for(R in p)V=p[R],R!=="__proto__"&&de!==V&&($e&&V&&(u.isPlainObject(V)||(ie=Array.isArray(V)))?(z=de[R],ce=ie&&!Array.isArray(z)?[]:ie||u.isPlainObject(z)?z:{},ie=!1,de[R]=u.extend($e,ce,V)):V!==void 0&&(de[R]=V));return de},u.extend({expando:"jQuery"+(C+Math.random()).replace(/\D/g,""),isReady:!0,error:function(p){throw new Error(p)},noop:function(){},isPlainObject:function(p){var R,z;return!(!p||d.call(p)!=="[object Object]")&&(!(R=l(p))||typeof(z=h.call(R,"constructor")&&R.constructor)=="function"&&m.call(z)===f)},isEmptyObject:function(p){var R;for(R in p)return!1;return!0},globalEval:function(p,R){M(p,{nonce:R&&R.nonce})},each:function(p,R){var z,V=0;if(y(p))for(z=p.length;V<z&&R.call(p[V],V,p[V])!==!1;V++);else for(V in p)if(R.call(p[V],V,p[V])===!1)break;return p},trim:function(p){return p==null?"":(p+"").replace(_,"")},makeArray:function(p,R){var z=R||[];return p!=null&&(y(Object(p))?u.merge(z,typeof p=="string"?[p]:p):s.call(z,p)),z},inArray:function(p,R,z){return R==null?-1:c.call(R,p,z)},merge:function(p,R){for(var z=+R.length,V=0,ie=p.length;V<z;V++)p[ie++]=R[V];return p.length=ie,p},grep:function(p,R,z){for(var V=[],ie=0,ce=p.length,de=!z;ie<ce;ie++)!R(p[ie],ie)!==de&&V.push(p[ie]);return V},map:function(p,R,z){var V,ie,ce=0,de=[];if(y(p))for(V=p.length;ce<V;ce++)(ie=R(p[ce],ce,z))!=null&&de.push(ie);else for(ce in p)(ie=R(p[ce],ce,z))!=null&&de.push(ie);return i.apply([],de)},guid:1,support:g}),typeof Symbol=="function"&&(u.fn[Symbol.iterator]=o[Symbol.iterator]),u.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(p,R){r["[object "+R+"]"]=R.toLowerCase()});var v=function(p){var R,z,V,ie,ce,de,ye,Te,$e,De,Be,Pe,Le,et,rt,tt,yt,kt,Ft,_t="sizzle"+1*new Date,lt=p.document,Dt=0,pt=0,xt=Sn(),vn=Sn(),En=Sn(),jt=Sn(),on=function(fe,xe){return fe===xe&&(Be=!0),0},dn={}.hasOwnProperty,Nt=[],hn=Nt.pop,Ht=Nt.push,Et=Nt.push,Ot=Nt.slice,Ut=function(fe,xe){for(var ke=0,Ne=fe.length;ke<Ne;ke++)if(fe[ke]===xe)return ke;return-1},Xt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",dt="[\\x20\\t\\r\\n\\f]",mt="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",$t="\\["+dt+"*("+mt+")(?:"+dt+"*([*^$|!~]?=)"+dt+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+mt+"))|)"+dt+"*\\]",Bt=":("+mt+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+$t+")*)|.*)\\)|)",Ct=new RegExp(dt+"+","g"),zt=new RegExp("^"+dt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+dt+"+$","g"),fn=new RegExp("^"+dt+"*,"+dt+"*"),Bn=new RegExp("^"+dt+"*([>+~]|"+dt+")"+dt+"*"),Gi=new RegExp(dt+"|>"),ji=new RegExp(Bt),Hi=new RegExp("^"+mt+"$"),An={ID:new RegExp("^#("+mt+")"),CLASS:new RegExp("^\\.("+mt+")"),TAG:new RegExp("^("+mt+"|[*])"),ATTR:new RegExp("^"+$t),PSEUDO:new RegExp("^"+Bt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+dt+"*(even|odd|(([+-]|)(\\d*)n|)"+dt+"*(?:([+-]|)"+dt+"*(\\d+)|))"+dt+"*\\)|)","i"),bool:new RegExp("^(?:"+Xt+")$","i"),needsContext:new RegExp("^"+dt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+dt+"*((?:-\\d)?\\d*)"+dt+"*\\)|)(?=[^-]|$)","i")},Wi=/HTML$/i,qi=/^(?:input|select|textarea|button)$/i,Vi=/^h\d$/i,wn=/^[^{]+\{\s*\[native \w/,Ki=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,zn=/[+~]/,en=new RegExp("\\\\([\\da-f]{1,6}"+dt+"?|("+dt+")|.)","ig"),tn=function(fe,xe,ke){var Ne="0x"+xe-65536;return Ne!=Ne||ke?xe:Ne<0?String.fromCharCode(Ne+65536):String.fromCharCode(Ne>>10|55296,1023&Ne|56320)},gi=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,mi=function(fe,xe){return xe?fe==="\0"?"�":fe.slice(0,-1)+"\\"+fe.charCodeAt(fe.length-1).toString(16)+" ":"\\"+fe},_i=function(){Pe()},Yi=Tn(function(fe){return fe.disabled===!0&&fe.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{Et.apply(Nt=Ot.call(lt.childNodes),lt.childNodes),Nt[lt.childNodes.length].nodeType}catch{Et={apply:Nt.length?function(xe,ke){Ht.apply(xe,Ot.call(ke))}:function(xe,ke){for(var Ne=xe.length,Me=0;xe[Ne++]=ke[Me++];);xe.length=Ne-1}}}function vt(fe,xe,ke,Ne){var Me,Ge,je,Ke,Qe,ct,ot,st=xe&&xe.ownerDocument,ft=xe?xe.nodeType:9;if(ke=ke||[],typeof fe!="string"||!fe||ft!==1&&ft!==9&&ft!==11)return ke;if(!Ne&&((xe?xe.ownerDocument||xe:lt)!==Le&&Pe(xe),xe=xe||Le,rt)){if(ft!==11&&(Qe=Ki.exec(fe)))if(Me=Qe[1]){if(ft===9){if(!(je=xe.getElementById(Me)))return ke;if(je.id===Me)return ke.push(je),ke}else if(st&&(je=st.getElementById(Me))&&Ft(xe,je)&&je.id===Me)return ke.push(je),ke}else{if(Qe[2])return Et.apply(ke,xe.getElementsByTagName(fe)),ke;if((Me=Qe[3])&&z.getElementsByClassName&&xe.getElementsByClassName)return Et.apply(ke,xe.getElementsByClassName(Me)),ke}if(z.qsa&&!jt[fe+" "]&&(!tt||!tt.test(fe))&&(ft!==1||xe.nodeName.toLowerCase()!=="object")){if(ot=fe,st=xe,ft===1&&Gi.test(fe)){for((Ke=xe.getAttribute("id"))?Ke=Ke.replace(gi,mi):xe.setAttribute("id",Ke=_t),Ge=(ct=de(fe)).length;Ge--;)ct[Ge]="#"+Ke+" "+Cn(ct[Ge]);ot=ct.join(","),st=zn.test(fe)&&jn(xe.parentNode)||xe}try{return Et.apply(ke,st.querySelectorAll(ot)),ke}catch{jt(fe,!0)}finally{Ke===_t&&xe.removeAttribute("id")}}}return Te(fe.replace(zt,"$1"),xe,ke,Ne)}function Sn(){var fe=[];return function xe(ke,Ne){return fe.push(ke+" ")>V.cacheLength&&delete xe[fe.shift()],xe[ke+" "]=Ne}}function Vt(fe){return fe[_t]=!0,fe}function Jt(fe){var xe=Le.createElement("fieldset");try{return!!fe(xe)}catch{return!1}finally{xe.parentNode&&xe.parentNode.removeChild(xe),xe=null}}function Gn(fe,xe){for(var ke=fe.split("|"),Ne=ke.length;Ne--;)V.attrHandle[ke[Ne]]=xe}function vi(fe,xe){var ke=xe&&fe,Ne=ke&&fe.nodeType===1&&xe.nodeType===1&&fe.sourceIndex-xe.sourceIndex;if(Ne)return Ne;if(ke){for(;ke=ke.nextSibling;)if(ke===xe)return-1}return fe?1:-1}function Xi(fe){return function(xe){return xe.nodeName.toLowerCase()==="input"&&xe.type===fe}}function Ji(fe){return function(xe){var ke=xe.nodeName.toLowerCase();return(ke==="input"||ke==="button")&&xe.type===fe}}function wi(fe){return function(xe){return"form"in xe?xe.parentNode&&xe.disabled===!1?"label"in xe?"label"in xe.parentNode?xe.parentNode.disabled===fe:xe.disabled===fe:xe.isDisabled===fe||xe.isDisabled!==!fe&&Yi(xe)===fe:xe.disabled===fe:"label"in xe&&xe.disabled===fe}}function sn(fe){return Vt(function(xe){return xe=+xe,Vt(function(ke,Ne){for(var Me,Ge=fe([],ke.length,xe),je=Ge.length;je--;)ke[Me=Ge[je]]&&(ke[Me]=!(Ne[Me]=ke[Me]))})})}function jn(fe){return fe&&typeof fe.getElementsByTagName<"u"&&fe}for(R in z=vt.support={},ce=vt.isXML=function(fe){var xe=fe.namespaceURI,ke=(fe.ownerDocument||fe).documentElement;return!Wi.test(xe||ke&&ke.nodeName||"HTML")},Pe=vt.setDocument=function(fe){var xe,ke,Ne=fe?fe.ownerDocument||fe:lt;return Ne!==Le&&Ne.nodeType===9&&Ne.documentElement&&(et=(Le=Ne).documentElement,rt=!ce(Le),lt!==Le&&(ke=Le.defaultView)&&ke.top!==ke&&(ke.addEventListener?ke.addEventListener("unload",_i,!1):ke.attachEvent&&ke.attachEvent("onunload",_i)),z.attributes=Jt(function(Me){return Me.className="i",!Me.getAttribute("className")}),z.getElementsByTagName=Jt(function(Me){return Me.appendChild(Le.createComment("")),!Me.getElementsByTagName("*").length}),z.getElementsByClassName=wn.test(Le.getElementsByClassName),z.getById=Jt(function(Me){return et.appendChild(Me).id=_t,!Le.getElementsByName||!Le.getElementsByName(_t).length}),z.getById?(V.filter.ID=function(Me){var Ge=Me.replace(en,tn);return function(je){return je.getAttribute("id")===Ge}},V.find.ID=function(Me,Ge){if(typeof Ge.getElementById<"u"&&rt){var je=Ge.getElementById(Me);return je?[je]:[]}}):(V.filter.ID=function(Me){var Ge=Me.replace(en,tn);return function(je){var Ke=typeof je.getAttributeNode<"u"&&je.getAttributeNode("id");return Ke&&Ke.value===Ge}},V.find.ID=function(Me,Ge){if(typeof Ge.getElementById<"u"&&rt){var je,Ke,Qe,ct=Ge.getElementById(Me);if(ct){if((je=ct.getAttributeNode("id"))&&je.value===Me)return[ct];for(Qe=Ge.getElementsByName(Me),Ke=0;ct=Qe[Ke++];)if((je=ct.getAttributeNode("id"))&&je.value===Me)return[ct]}return[]}}),V.find.TAG=z.getElementsByTagName?function(Me,Ge){return typeof Ge.getElementsByTagName<"u"?Ge.getElementsByTagName(Me):z.qsa?Ge.querySelectorAll(Me):void 0}:function(Me,Ge){var je,Ke=[],Qe=0,ct=Ge.getElementsByTagName(Me);if(Me==="*"){for(;je=ct[Qe++];)je.nodeType===1&&Ke.push(je);return Ke}return ct},V.find.CLASS=z.getElementsByClassName&&function(Me,Ge){if(typeof Ge.getElementsByClassName<"u"&&rt)return Ge.getElementsByClassName(Me)},yt=[],tt=[],(z.qsa=wn.test(Le.querySelectorAll))&&(Jt(function(Me){et.appendChild(Me).innerHTML="<a id='"+_t+"'></a><select id='"+_t+"-\r\\' msallowcapture=''><option selected=''></option></select>",Me.querySelectorAll("[msallowcapture^='']").length&&tt.push("[*^$]="+dt+`*(?:''|"")`),Me.querySelectorAll("[selected]").length||tt.push("\\["+dt+"*(?:value|"+Xt+")"),Me.querySelectorAll("[id~="+_t+"-]").length||tt.push("~="),Me.querySelectorAll(":checked").length||tt.push(":checked"),Me.querySelectorAll("a#"+_t+"+*").length||tt.push(".#.+[+~]")}),Jt(function(Me){Me.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var Ge=Le.createElement("input");Ge.setAttribute("type","hidden"),Me.appendChild(Ge).setAttribute("name","D"),Me.querySelectorAll("[name=d]").length&&tt.push("name"+dt+"*[*^$|!~]?="),Me.querySelectorAll(":enabled").length!==2&&tt.push(":enabled",":disabled"),et.appendChild(Me).disabled=!0,Me.querySelectorAll(":disabled").length!==2&&tt.push(":enabled",":disabled"),Me.querySelectorAll("*,:x"),tt.push(",.*:")})),(z.matchesSelector=wn.test(kt=et.matches||et.webkitMatchesSelector||et.mozMatchesSelector||et.oMatchesSelector||et.msMatchesSelector))&&Jt(function(Me){z.disconnectedMatch=kt.call(Me,"*"),kt.call(Me,"[s!='']:x"),yt.push("!=",Bt)}),tt=tt.length&&new RegExp(tt.join("|")),yt=yt.length&&new RegExp(yt.join("|")),xe=wn.test(et.compareDocumentPosition),Ft=xe||wn.test(et.contains)?function(Me,Ge){var je=Me.nodeType===9?Me.documentElement:Me,Ke=Ge&&Ge.parentNode;return Me===Ke||!(!Ke||Ke.nodeType!==1||!(je.contains?je.contains(Ke):Me.compareDocumentPosition&&16&Me.compareDocumentPosition(Ke)))}:function(Me,Ge){if(Ge){for(;Ge=Ge.parentNode;)if(Ge===Me)return!0}return!1},on=xe?function(Me,Ge){if(Me===Ge)return Be=!0,0;var je=!Me.compareDocumentPosition-!Ge.compareDocumentPosition;return je||(1&(je=(Me.ownerDocument||Me)===(Ge.ownerDocument||Ge)?Me.compareDocumentPosition(Ge):1)||!z.sortDetached&&Ge.compareDocumentPosition(Me)===je?Me===Le||Me.ownerDocument===lt&&Ft(lt,Me)?-1:Ge===Le||Ge.ownerDocument===lt&&Ft(lt,Ge)?1:De?Ut(De,Me)-Ut(De,Ge):0:4&je?-1:1)}:function(Me,Ge){if(Me===Ge)return Be=!0,0;var je,Ke=0,Qe=Me.parentNode,ct=Ge.parentNode,ot=[Me],st=[Ge];if(!Qe||!ct)return Me===Le?-1:Ge===Le?1:Qe?-1:ct?1:De?Ut(De,Me)-Ut(De,Ge):0;if(Qe===ct)return vi(Me,Ge);for(je=Me;je=je.parentNode;)ot.unshift(je);for(je=Ge;je=je.parentNode;)st.unshift(je);for(;ot[Ke]===st[Ke];)Ke++;return Ke?vi(ot[Ke],st[Ke]):ot[Ke]===lt?-1:st[Ke]===lt?1:0}),Le},vt.matches=function(fe,xe){return vt(fe,null,null,xe)},vt.matchesSelector=function(fe,xe){if((fe.ownerDocument||fe)!==Le&&Pe(fe),z.matchesSelector&&rt&&!jt[xe+" "]&&(!yt||!yt.test(xe))&&(!tt||!tt.test(xe)))try{var ke=kt.call(fe,xe);if(ke||z.disconnectedMatch||fe.document&&fe.document.nodeType!==11)return ke}catch{jt(xe,!0)}return 0<vt(xe,Le,null,[fe]).length},vt.contains=function(fe,xe){return(fe.ownerDocument||fe)!==Le&&Pe(fe),Ft(fe,xe)},vt.attr=function(fe,xe){(fe.ownerDocument||fe)!==Le&&Pe(fe);var ke=V.attrHandle[xe.toLowerCase()],Ne=ke&&dn.call(V.attrHandle,xe.toLowerCase())?ke(fe,xe,!rt):void 0;return Ne!==void 0?Ne:z.attributes||!rt?fe.getAttribute(xe):(Ne=fe.getAttributeNode(xe))&&Ne.specified?Ne.value:null},vt.escape=function(fe){return(fe+"").replace(gi,mi)},vt.error=function(fe){throw new Error("Syntax error, unrecognized expression: "+fe)},vt.uniqueSort=function(fe){var xe,ke=[],Ne=0,Me=0;if(Be=!z.detectDuplicates,De=!z.sortStable&&fe.slice(0),fe.sort(on),Be){for(;xe=fe[Me++];)xe===fe[Me]&&(Ne=ke.push(Me));for(;Ne--;)fe.splice(ke[Ne],1)}return De=null,fe},ie=vt.getText=function(fe){var xe,ke="",Ne=0,Me=fe.nodeType;if(Me){if(Me===1||Me===9||Me===11){if(typeof fe.textContent=="string")return fe.textContent;for(fe=fe.firstChild;fe;fe=fe.nextSibling)ke+=ie(fe)}else if(Me===3||Me===4)return fe.nodeValue}else for(;xe=fe[Ne++];)ke+=ie(xe);return ke},(V=vt.selectors={cacheLength:50,createPseudo:Vt,match:An,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(fe){return fe[1]=fe[1].replace(en,tn),fe[3]=(fe[3]||fe[4]||fe[5]||"").replace(en,tn),fe[2]==="~="&&(fe[3]=" "+fe[3]+" "),fe.slice(0,4)},CHILD:function(fe){return fe[1]=fe[1].toLowerCase(),fe[1].slice(0,3)==="nth"?(fe[3]||vt.error(fe[0]),fe[4]=+(fe[4]?fe[5]+(fe[6]||1):2*(fe[3]==="even"||fe[3]==="odd")),fe[5]=+(fe[7]+fe[8]||fe[3]==="odd")):fe[3]&&vt.error(fe[0]),fe},PSEUDO:function(fe){var xe,ke=!fe[6]&&fe[2];return An.CHILD.test(fe[0])?null:(fe[3]?fe[2]=fe[4]||fe[5]||"":ke&&ji.test(ke)&&(xe=de(ke,!0))&&(xe=ke.indexOf(")",ke.length-xe)-ke.length)&&(fe[0]=fe[0].slice(0,xe),fe[2]=ke.slice(0,xe)),fe.slice(0,3))}},filter:{TAG:function(fe){var xe=fe.replace(en,tn).toLowerCase();return fe==="*"?function(){return!0}:function(ke){return ke.nodeName&&ke.nodeName.toLowerCase()===xe}},CLASS:function(fe){var xe=xt[fe+" "];return xe||(xe=new RegExp("(^|"+dt+")"+fe+"("+dt+"|$)"))&&xt(fe,function(ke){return xe.test(typeof ke.className=="string"&&ke.className||typeof ke.getAttribute<"u"&&ke.getAttribute("class")||"")})},ATTR:function(fe,xe,ke){return function(Ne){var Me=vt.attr(Ne,fe);return Me==null?xe==="!=":!xe||(Me+="",xe==="="?Me===ke:xe==="!="?Me!==ke:xe==="^="?ke&&Me.indexOf(ke)===0:xe==="*="?ke&&-1<Me.indexOf(ke):xe==="$="?ke&&Me.slice(-ke.length)===ke:xe==="~="?-1<(" "+Me.replace(Ct," ")+" ").indexOf(ke):xe==="|="&&(Me===ke||Me.slice(0,ke.length+1)===ke+"-"))}},CHILD:function(fe,xe,ke,Ne,Me){var Ge=fe.slice(0,3)!=="nth",je=fe.slice(-4)!=="last",Ke=xe==="of-type";return Ne===1&&Me===0?function(Qe){return!!Qe.parentNode}:function(Qe,ct,ot){var st,ft,At,ut,Mt,Rt,It=Ge!==je?"nextSibling":"previousSibling",wt=Qe.parentNode,Zt=Ke&&Qe.nodeName.toLowerCase(),Pt=!ot&&!Ke,Tt=!1;if(wt){if(Ge){for(;It;){for(ut=Qe;ut=ut[It];)if(Ke?ut.nodeName.toLowerCase()===Zt:ut.nodeType===1)return!1;Rt=It=fe==="only"&&!Rt&&"nextSibling"}return!0}if(Rt=[je?wt.firstChild:wt.lastChild],je&&Pt){for(Tt=(Mt=(st=(ft=(At=(ut=wt)[_t]||(ut[_t]={}))[ut.uniqueID]||(At[ut.uniqueID]={}))[fe]||[])[0]===Dt&&st[1])&&st[2],ut=Mt&&wt.childNodes[Mt];ut=++Mt&&ut&&ut[It]||(Tt=Mt=0)||Rt.pop();)if(ut.nodeType===1&&++Tt&&ut===Qe){ft[fe]=[Dt,Mt,Tt];break}}else if(Pt&&(Tt=Mt=(st=(ft=(At=(ut=Qe)[_t]||(ut[_t]={}))[ut.uniqueID]||(At[ut.uniqueID]={}))[fe]||[])[0]===Dt&&st[1]),Tt===!1)for(;(ut=++Mt&&ut&&ut[It]||(Tt=Mt=0)||Rt.pop())&&!((Ke?ut.nodeName.toLowerCase()===Zt:ut.nodeType===1)&&++Tt&&(Pt&&((ft=(At=ut[_t]||(ut[_t]={}))[ut.uniqueID]||(At[ut.uniqueID]={}))[fe]=[Dt,Tt]),ut===Qe)););return(Tt-=Me)===Ne||Tt%Ne==0&&0<=Tt/Ne}}},PSEUDO:function(fe,xe){var ke,Ne=V.pseudos[fe]||V.setFilters[fe.toLowerCase()]||vt.error("unsupported pseudo: "+fe);return Ne[_t]?Ne(xe):1<Ne.length?(ke=[fe,fe,"",xe],V.setFilters.hasOwnProperty(fe.toLowerCase())?Vt(function(Me,Ge){for(var je,Ke=Ne(Me,xe),Qe=Ke.length;Qe--;)Me[je=Ut(Me,Ke[Qe])]=!(Ge[je]=Ke[Qe])}):function(Me){return Ne(Me,0,ke)}):Ne}},pseudos:{not:Vt(function(fe){var xe=[],ke=[],Ne=ye(fe.replace(zt,"$1"));return Ne[_t]?Vt(function(Me,Ge,je,Ke){for(var Qe,ct=Ne(Me,null,Ke,[]),ot=Me.length;ot--;)(Qe=ct[ot])&&(Me[ot]=!(Ge[ot]=Qe))}):function(Me,Ge,je){return xe[0]=Me,Ne(xe,null,je,ke),xe[0]=null,!ke.pop()}}),has:Vt(function(fe){return function(xe){return 0<vt(fe,xe).length}}),contains:Vt(function(fe){return fe=fe.replace(en,tn),function(xe){return-1<(xe.textContent||ie(xe)).indexOf(fe)}}),lang:Vt(function(fe){return Hi.test(fe||"")||vt.error("unsupported lang: "+fe),fe=fe.replace(en,tn).toLowerCase(),function(xe){var ke;do if(ke=rt?xe.lang:xe.getAttribute("xml:lang")||xe.getAttribute("lang"))return(ke=ke.toLowerCase())===fe||ke.indexOf(fe+"-")===0;while((xe=xe.parentNode)&&xe.nodeType===1);return!1}}),target:function(fe){var xe=p.location&&p.location.hash;return xe&&xe.slice(1)===fe.id},root:function(fe){return fe===et},focus:function(fe){return fe===Le.activeElement&&(!Le.hasFocus||Le.hasFocus())&&!!(fe.type||fe.href||~fe.tabIndex)},enabled:wi(!1),disabled:wi(!0),checked:function(fe){var xe=fe.nodeName.toLowerCase();return xe==="input"&&!!fe.checked||xe==="option"&&!!fe.selected},selected:function(fe){return fe.parentNode&&fe.parentNode.selectedIndex,fe.selected===!0},empty:function(fe){for(fe=fe.firstChild;fe;fe=fe.nextSibling)if(fe.nodeType<6)return!1;return!0},parent:function(fe){return!V.pseudos.empty(fe)},header:function(fe){return Vi.test(fe.nodeName)},input:function(fe){return qi.test(fe.nodeName)},button:function(fe){var xe=fe.nodeName.toLowerCase();return xe==="input"&&fe.type==="button"||xe==="button"},text:function(fe){var xe;return fe.nodeName.toLowerCase()==="input"&&fe.type==="text"&&((xe=fe.getAttribute("type"))==null||xe.toLowerCase()==="text")},first:sn(function(){return[0]}),last:sn(function(fe,xe){return[xe-1]}),eq:sn(function(fe,xe,ke){return[ke<0?ke+xe:ke]}),even:sn(function(fe,xe){for(var ke=0;ke<xe;ke+=2)fe.push(ke);return fe}),odd:sn(function(fe,xe){for(var ke=1;ke<xe;ke+=2)fe.push(ke);return fe}),lt:sn(function(fe,xe,ke){for(var Ne=ke<0?ke+xe:xe<ke?xe:ke;0<=--Ne;)fe.push(Ne);return fe}),gt:sn(function(fe,xe,ke){for(var Ne=ke<0?ke+xe:ke;++Ne<xe;)fe.push(Ne);return fe})}}).pseudos.nth=V.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})V.pseudos[R]=Xi(R);for(R in{submit:!0,reset:!0})V.pseudos[R]=Ji(R);function bi(){}function Cn(fe){for(var xe=0,ke=fe.length,Ne="";xe<ke;xe++)Ne+=fe[xe].value;return Ne}function Tn(fe,xe,ke){var Ne=xe.dir,Me=xe.next,Ge=Me||Ne,je=ke&&Ge==="parentNode",Ke=pt++;return xe.first?function(Qe,ct,ot){for(;Qe=Qe[Ne];)if(Qe.nodeType===1||je)return fe(Qe,ct,ot);return!1}:function(Qe,ct,ot){var st,ft,At,ut=[Dt,Ke];if(ot){for(;Qe=Qe[Ne];)if((Qe.nodeType===1||je)&&fe(Qe,ct,ot))return!0}else for(;Qe=Qe[Ne];)if(Qe.nodeType===1||je)if(ft=(At=Qe[_t]||(Qe[_t]={}))[Qe.uniqueID]||(At[Qe.uniqueID]={}),Me&&Me===Qe.nodeName.toLowerCase())Qe=Qe[Ne]||Qe;else{if((st=ft[Ge])&&st[0]===Dt&&st[1]===Ke)return ut[2]=st[2];if((ft[Ge]=ut)[2]=fe(Qe,ct,ot))return!0}return!1}}function Hn(fe){return 1<fe.length?function(xe,ke,Ne){for(var Me=fe.length;Me--;)if(!fe[Me](xe,ke,Ne))return!1;return!0}:fe[0]}function kn(fe,xe,ke,Ne,Me){for(var Ge,je=[],Ke=0,Qe=fe.length,ct=xe!=null;Ke<Qe;Ke++)(Ge=fe[Ke])&&(ke&&!ke(Ge,Ne,Me)||(je.push(Ge),ct&&xe.push(Ke)));return je}function Wn(fe,xe,ke,Ne,Me,Ge){return Ne&&!Ne[_t]&&(Ne=Wn(Ne)),Me&&!Me[_t]&&(Me=Wn(Me,Ge)),Vt(function(je,Ke,Qe,ct){var ot,st,ft,At=[],ut=[],Mt=Ke.length,Rt=je||function(Zt,Pt,Tt){for(var Kt=0,$n=Pt.length;Kt<$n;Kt++)vt(Zt,Pt[Kt],Tt);return Tt}(xe||"*",Qe.nodeType?[Qe]:Qe,[]),It=!fe||!je&&xe?Rt:kn(Rt,At,fe,Qe,ct),wt=ke?Me||(je?fe:Mt||Ne)?[]:Ke:It;if(ke&&ke(It,wt,Qe,ct),Ne)for(ot=kn(wt,ut),Ne(ot,[],Qe,ct),st=ot.length;st--;)(ft=ot[st])&&(wt[ut[st]]=!(It[ut[st]]=ft));if(je){if(Me||fe){if(Me){for(ot=[],st=wt.length;st--;)(ft=wt[st])&&ot.push(It[st]=ft);Me(null,wt=[],ot,ct)}for(st=wt.length;st--;)(ft=wt[st])&&-1<(ot=Me?Ut(je,ft):At[st])&&(je[ot]=!(Ke[ot]=ft))}}else wt=kn(wt===Ke?wt.splice(Mt,wt.length):wt),Me?Me(null,Ke,wt,ct):Et.apply(Ke,wt)})}function qn(fe){for(var xe,ke,Ne,Me=fe.length,Ge=V.relative[fe[0].type],je=Ge||V.relative[" "],Ke=Ge?1:0,Qe=Tn(function(st){return st===xe},je,!0),ct=Tn(function(st){return-1<Ut(xe,st)},je,!0),ot=[function(st,ft,At){var ut=!Ge&&(At||ft!==$e)||((xe=ft).nodeType?Qe(st,ft,At):ct(st,ft,At));return xe=null,ut}];Ke<Me;Ke++)if(ke=V.relative[fe[Ke].type])ot=[Tn(Hn(ot),ke)];else{if((ke=V.filter[fe[Ke].type].apply(null,fe[Ke].matches))[_t]){for(Ne=++Ke;Ne<Me&&!V.relative[fe[Ne].type];Ne++);return Wn(1<Ke&&Hn(ot),1<Ke&&Cn(fe.slice(0,Ke-1).concat({value:fe[Ke-2].type===" "?"*":""})).replace(zt,"$1"),ke,Ke<Ne&&qn(fe.slice(Ke,Ne)),Ne<Me&&qn(fe=fe.slice(Ne)),Ne<Me&&Cn(fe))}ot.push(ke)}return Hn(ot)}return bi.prototype=V.filters=V.pseudos,V.setFilters=new bi,de=vt.tokenize=function(fe,xe){var ke,Ne,Me,Ge,je,Ke,Qe,ct=vn[fe+" "];if(ct)return xe?0:ct.slice(0);for(je=fe,Ke=[],Qe=V.preFilter;je;){for(Ge in ke&&!(Ne=fn.exec(je))||(Ne&&(je=je.slice(Ne[0].length)||je),Ke.push(Me=[])),ke=!1,(Ne=Bn.exec(je))&&(ke=Ne.shift(),Me.push({value:ke,type:Ne[0].replace(zt," ")}),je=je.slice(ke.length)),V.filter)!(Ne=An[Ge].exec(je))||Qe[Ge]&&!(Ne=Qe[Ge](Ne))||(ke=Ne.shift(),Me.push({value:ke,type:Ge,matches:Ne}),je=je.slice(ke.length));if(!ke)break}return xe?je.length:je?vt.error(fe):vn(fe,Ke).slice(0)},ye=vt.compile=function(fe,xe){var ke,Ne,Me,Ge,je,Ke,Qe=[],ct=[],ot=En[fe+" "];if(!ot){for(xe||(xe=de(fe)),ke=xe.length;ke--;)(ot=qn(xe[ke]))[_t]?Qe.push(ot):ct.push(ot);(ot=En(fe,(Ne=ct,Ge=0<(Me=Qe).length,je=0<Ne.length,Ke=function(st,ft,At,ut,Mt){var Rt,It,wt,Zt=0,Pt="0",Tt=st&&[],Kt=[],$n=$e,yi=st||je&&V.find.TAG("*",Mt),xi=Dt+=$n==null?1:Math.random()||.1,Zi=yi.length;for(Mt&&($e=ft===Le||ft||Mt);Pt!==Zi&&(Rt=yi[Pt])!=null;Pt++){if(je&&Rt){for(It=0,ft||Rt.ownerDocument===Le||(Pe(Rt),At=!rt);wt=Ne[It++];)if(wt(Rt,ft||Le,At)){ut.push(Rt);break}Mt&&(Dt=xi)}Ge&&((Rt=!wt&&Rt)&&Zt--,st&&Tt.push(Rt))}if(Zt+=Pt,Ge&&Pt!==Zt){for(It=0;wt=Me[It++];)wt(Tt,Kt,ft,At);if(st){if(0<Zt)for(;Pt--;)Tt[Pt]||Kt[Pt]||(Kt[Pt]=hn.call(ut));Kt=kn(Kt)}Et.apply(ut,Kt),Mt&&!st&&0<Kt.length&&1<Zt+Me.length&&vt.uniqueSort(ut)}return Mt&&(Dt=xi,$e=$n),Tt},Ge?Vt(Ke):Ke))).selector=fe}return ot},Te=vt.select=function(fe,xe,ke,Ne){var Me,Ge,je,Ke,Qe,ct=typeof fe=="function"&&fe,ot=!Ne&&de(fe=ct.selector||fe);if(ke=ke||[],ot.length===1){if(2<(Ge=ot[0]=ot[0].slice(0)).length&&(je=Ge[0]).type==="ID"&&xe.nodeType===9&&rt&&V.relative[Ge[1].type]){if(!(xe=(V.find.ID(je.matches[0].replace(en,tn),xe)||[])[0]))return ke;ct&&(xe=xe.parentNode),fe=fe.slice(Ge.shift().value.length)}for(Me=An.needsContext.test(fe)?0:Ge.length;Me--&&(je=Ge[Me],!V.relative[Ke=je.type]);)if((Qe=V.find[Ke])&&(Ne=Qe(je.matches[0].replace(en,tn),zn.test(Ge[0].type)&&jn(xe.parentNode)||xe))){if(Ge.splice(Me,1),!(fe=Ne.length&&Cn(Ge)))return Et.apply(ke,Ne),ke;break}}return(ct||ye(fe,ot))(Ne,xe,!rt,ke,!xe||zn.test(fe)&&jn(xe.parentNode)||xe),ke},z.sortStable=_t.split("").sort(on).join("")===_t,z.detectDuplicates=!!Be,Pe(),z.sortDetached=Jt(function(fe){return 1&fe.compareDocumentPosition(Le.createElement("fieldset"))}),Jt(function(fe){return fe.innerHTML="<a href='#'></a>",fe.firstChild.getAttribute("href")==="#"})||Gn("type|href|height|width",function(fe,xe,ke){if(!ke)return fe.getAttribute(xe,xe.toLowerCase()==="type"?1:2)}),z.attributes&&Jt(function(fe){return fe.innerHTML="<input/>",fe.firstChild.setAttribute("value",""),fe.firstChild.getAttribute("value")===""})||Gn("value",function(fe,xe,ke){if(!ke&&fe.nodeName.toLowerCase()==="input")return fe.defaultValue}),Jt(function(fe){return fe.getAttribute("disabled")==null})||Gn(Xt,function(fe,xe,ke){var Ne;if(!ke)return fe[xe]===!0?xe.toLowerCase():(Ne=fe.getAttributeNode(xe))&&Ne.specified?Ne.value:null}),vt}(e);u.find=v,u.expr=v.selectors,u.expr[":"]=u.expr.pseudos,u.uniqueSort=u.unique=v.uniqueSort,u.text=v.getText,u.isXMLDoc=v.isXML,u.contains=v.contains,u.escapeSelector=v.escape;var T=function(p,R,z){for(var V=[],ie=z!==void 0;(p=p[R])&&p.nodeType!==9;)if(p.nodeType===1){if(ie&&u(p).is(z))break;V.push(p)}return V},k=function(p,R){for(var z=[];p;p=p.nextSibling)p.nodeType===1&&p!==R&&z.push(p);return z},P=u.expr.match.needsContext;function S(p,R){return p.nodeName&&p.nodeName.toLowerCase()===R.toLowerCase()}var F=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function K(p,R,z){return x(R)?u.grep(p,function(V,ie){return!!R.call(V,ie,V)!==z}):R.nodeType?u.grep(p,function(V){return V===R!==z}):typeof R!="string"?u.grep(p,function(V){return-1<c.call(R,V)!==z}):u.filter(R,p,z)}u.filter=function(p,R,z){var V=R[0];return z&&(p=":not("+p+")"),R.length===1&&V.nodeType===1?u.find.matchesSelector(V,p)?[V]:[]:u.find.matches(p,u.grep(R,function(ie){return ie.nodeType===1}))},u.fn.extend({find:function(p){var R,z,V=this.length,ie=this;if(typeof p!="string")return this.pushStack(u(p).filter(function(){for(R=0;R<V;R++)if(u.contains(ie[R],this))return!0}));for(z=this.pushStack([]),R=0;R<V;R++)u.find(p,ie[R],z);return 1<V?u.uniqueSort(z):z},filter:function(p){return this.pushStack(K(this,p||[],!1))},not:function(p){return this.pushStack(K(this,p||[],!0))},is:function(p){return!!K(this,typeof p=="string"&&P.test(p)?u(p):p||[],!1).length}});var Q,Z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(u.fn.init=function(p,R,z){var V,ie;if(!p)return this;if(z=z||Q,typeof p=="string"){if(!(V=p[0]==="<"&&p[p.length-1]===">"&&3<=p.length?[null,p,null]:Z.exec(p))||!V[1]&&R)return!R||R.jquery?(R||z).find(p):this.constructor(R).find(p);if(V[1]){if(R=R instanceof u?R[0]:R,u.merge(this,u.parseHTML(V[1],R&&R.nodeType?R.ownerDocument||R:t,!0)),F.test(V[1])&&u.isPlainObject(R))for(V in R)x(this[V])?this[V](R[V]):this.attr(V,R[V]);return this}return(ie=t.getElementById(V[2]))&&(this[0]=ie,this.length=1),this}return p.nodeType?(this[0]=p,this.length=1,this):x(p)?z.ready!==void 0?z.ready(p):p(u):u.makeArray(p,this)}).prototype=u.fn,Q=u(t);var B=/^(?:parents|prev(?:Until|All))/,G={children:!0,contents:!0,next:!0,prev:!0};function w(p,R){for(;(p=p[R])&&p.nodeType!==1;);return p}u.fn.extend({has:function(p){var R=u(p,this),z=R.length;return this.filter(function(){for(var V=0;V<z;V++)if(u.contains(this,R[V]))return!0})},closest:function(p,R){var z,V=0,ie=this.length,ce=[],de=typeof p!="string"&&u(p);if(!P.test(p)){for(;V<ie;V++)for(z=this[V];z&&z!==R;z=z.parentNode)if(z.nodeType<11&&(de?-1<de.index(z):z.nodeType===1&&u.find.matchesSelector(z,p))){ce.push(z);break}}return this.pushStack(1<ce.length?u.uniqueSort(ce):ce)},index:function(p){return p?typeof p=="string"?c.call(u(p),this[0]):c.call(this,p.jquery?p[0]:p):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(p,R){return this.pushStack(u.uniqueSort(u.merge(this.get(),u(p,R))))},addBack:function(p){return this.add(p==null?this.prevObject:this.prevObject.filter(p))}}),u.each({parent:function(p){var R=p.parentNode;return R&&R.nodeType!==11?R:null},parents:function(p){return T(p,"parentNode")},parentsUntil:function(p,R,z){return T(p,"parentNode",z)},next:function(p){return w(p,"nextSibling")},prev:function(p){return w(p,"previousSibling")},nextAll:function(p){return T(p,"nextSibling")},prevAll:function(p){return T(p,"previousSibling")},nextUntil:function(p,R,z){return T(p,"nextSibling",z)},prevUntil:function(p,R,z){return T(p,"previousSibling",z)},siblings:function(p){return k((p.parentNode||{}).firstChild,p)},children:function(p){return k(p.firstChild)},contents:function(p){return typeof p.contentDocument<"u"?p.contentDocument:(S(p,"template")&&(p=p.content||p),u.merge([],p.childNodes))}},function(p,R){u.fn[p]=function(z,V){var ie=u.map(this,R,z);return p.slice(-5)!=="Until"&&(V=z),V&&typeof V=="string"&&(ie=u.filter(V,ie)),1<this.length&&(G[p]||u.uniqueSort(ie),B.test(p)&&ie.reverse()),this.pushStack(ie)}});var D=/[^\x20\t\r\n\f]+/g;function U(p){return p}function q(p){throw p}function j(p,R,z,V){var ie;try{p&&x(ie=p.promise)?ie.call(p).done(R).fail(z):p&&x(ie=p.then)?ie.call(p,R,z):R.apply(void 0,[p].slice(V))}catch(ce){z.apply(void 0,[ce])}}u.Callbacks=function(p){var R,z;p=typeof p=="string"?(R=p,z={},u.each(R.match(D)||[],function(Pe,Le){z[Le]=!0}),z):u.extend({},p);var V,ie,ce,de,ye=[],Te=[],$e=-1,De=function(){for(de=de||p.once,ce=V=!0;Te.length;$e=-1)for(ie=Te.shift();++$e<ye.length;)ye[$e].apply(ie[0],ie[1])===!1&&p.stopOnFalse&&($e=ye.length,ie=!1);p.memory||(ie=!1),V=!1,de&&(ye=ie?[]:"")},Be={add:function(){return ye&&(ie&&!V&&($e=ye.length-1,Te.push(ie)),function Pe(Le){u.each(Le,function(et,rt){x(rt)?p.unique&&Be.has(rt)||ye.push(rt):rt&&rt.length&&L(rt)!=="string"&&Pe(rt)})}(arguments),ie&&!V&&De()),this},remove:function(){return u.each(arguments,function(Pe,Le){for(var et;-1<(et=u.inArray(Le,ye,et));)ye.splice(et,1),et<=$e&&$e--}),this},has:function(Pe){return Pe?-1<u.inArray(Pe,ye):0<ye.length},empty:function(){return ye&&(ye=[]),this},disable:function(){return de=Te=[],ye=ie="",this},disabled:function(){return!ye},lock:function(){return de=Te=[],ie||V||(ye=ie=""),this},locked:function(){return!!de},fireWith:function(Pe,Le){return de||(Le=[Pe,(Le=Le||[]).slice?Le.slice():Le],Te.push(Le),V||De()),this},fire:function(){return Be.fireWith(this,arguments),this},fired:function(){return!!ce}};return Be},u.extend({Deferred:function(p){var R=[["notify","progress",u.Callbacks("memory"),u.Callbacks("memory"),2],["resolve","done",u.Callbacks("once memory"),u.Callbacks("once memory"),0,"resolved"],["reject","fail",u.Callbacks("once memory"),u.Callbacks("once memory"),1,"rejected"]],z="pending",V={state:function(){return z},always:function(){return ie.done(arguments).fail(arguments),this},catch:function(ce){return V.then(null,ce)},pipe:function(){var ce=arguments;return u.Deferred(function(de){u.each(R,function(ye,Te){var $e=x(ce[Te[4]])&&ce[Te[4]];ie[Te[1]](function(){var De=$e&&$e.apply(this,arguments);De&&x(De.promise)?De.promise().progress(de.notify).done(de.resolve).fail(de.reject):de[Te[0]+"With"](this,$e?[De]:arguments)})}),ce=null}).promise()},then:function(ce,de,ye){var Te=0;function $e(De,Be,Pe,Le){return function(){var et=this,rt=arguments,tt=function(){var kt,Ft;if(!(De<Te)){if((kt=Pe.apply(et,rt))===Be.promise())throw new TypeError("Thenable self-resolution");Ft=kt&&(typeof kt=="object"||typeof kt=="function")&&kt.then,x(Ft)?Le?Ft.call(kt,$e(Te,Be,U,Le),$e(Te,Be,q,Le)):(Te++,Ft.call(kt,$e(Te,Be,U,Le),$e(Te,Be,q,Le),$e(Te,Be,U,Be.notifyWith))):(Pe!==U&&(et=void 0,rt=[kt]),(Le||Be.resolveWith)(et,rt))}},yt=Le?tt:function(){try{tt()}catch(kt){u.Deferred.exceptionHook&&u.Deferred.exceptionHook(kt,yt.stackTrace),Te<=De+1&&(Pe!==q&&(et=void 0,rt=[kt]),Be.rejectWith(et,rt))}};De?yt():(u.Deferred.getStackHook&&(yt.stackTrace=u.Deferred.getStackHook()),e.setTimeout(yt))}}return u.Deferred(function(De){R[0][3].add($e(0,De,x(ye)?ye:U,De.notifyWith)),R[1][3].add($e(0,De,x(ce)?ce:U)),R[2][3].add($e(0,De,x(de)?de:q))}).promise()},promise:function(ce){return ce!=null?u.extend(ce,V):V}},ie={};return u.each(R,function(ce,de){var ye=de[2],Te=de[5];V[de[1]]=ye.add,Te&&ye.add(function(){z=Te},R[3-ce][2].disable,R[3-ce][3].disable,R[0][2].lock,R[0][3].lock),ye.add(de[3].fire),ie[de[0]]=function(){return ie[de[0]+"With"](this===ie?void 0:this,arguments),this},ie[de[0]+"With"]=ye.fireWith}),V.promise(ie),p&&p.call(ie,ie),ie},when:function(p){var R=arguments.length,z=R,V=Array(z),ie=a.call(arguments),ce=u.Deferred(),de=function(ye){return function(Te){V[ye]=this,ie[ye]=1<arguments.length?a.call(arguments):Te,--R||ce.resolveWith(V,ie)}};if(R<=1&&(j(p,ce.done(de(z)).resolve,ce.reject,!R),ce.state()==="pending"||x(ie[z]&&ie[z].then)))return ce.then();for(;z--;)j(ie[z],de(z),ce.reject);return ce.promise()}});var Y=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;u.Deferred.exceptionHook=function(p,R){e.console&&e.console.warn&&p&&Y.test(p.name)&&e.console.warn("jQuery.Deferred exception: "+p.message,p.stack,R)},u.readyException=function(p){e.setTimeout(function(){throw p})};var J=u.Deferred();function oe(){t.removeEventListener("DOMContentLoaded",oe),e.removeEventListener("load",oe),u.ready()}u.fn.ready=function(p){return J.then(p).catch(function(R){u.readyException(R)}),this},u.extend({isReady:!1,readyWait:1,ready:function(p){(p===!0?--u.readyWait:u.isReady)||(u.isReady=!0)!==p&&0<--u.readyWait||J.resolveWith(t,[u])}}),u.ready.then=J.then,t.readyState==="complete"||t.readyState!=="loading"&&!t.documentElement.doScroll?e.setTimeout(u.ready):(t.addEventListener("DOMContentLoaded",oe),e.addEventListener("load",oe));var pe=function(p,R,z,V,ie,ce,de){var ye=0,Te=p.length,$e=z==null;if(L(z)==="object")for(ye in ie=!0,z)pe(p,R,ye,z[ye],!0,ce,de);else if(V!==void 0&&(ie=!0,x(V)||(de=!0),$e&&(de?(R.call(p,V),R=null):($e=R,R=function(De,Be,Pe){return $e.call(u(De),Pe)})),R))for(;ye<Te;ye++)R(p[ye],z,de?V:V.call(p[ye],ye,R(p[ye],z)));return ie?p:$e?R.call(p):Te?R(p[0],z):ce},me=/^-ms-/,Ee=/-([a-z])/g;function X(p,R){return R.toUpperCase()}function N(p){return p.replace(me,"ms-").replace(Ee,X)}var te=function(p){return p.nodeType===1||p.nodeType===9||!+p.nodeType};function re(){this.expando=u.expando+re.uid++}re.uid=1,re.prototype={cache:function(p){var R=p[this.expando];return R||(R={},te(p)&&(p.nodeType?p[this.expando]=R:Object.defineProperty(p,this.expando,{value:R,configurable:!0}))),R},set:function(p,R,z){var V,ie=this.cache(p);if(typeof R=="string")ie[N(R)]=z;else for(V in R)ie[N(V)]=R[V];return ie},get:function(p,R){return R===void 0?this.cache(p):p[this.expando]&&p[this.expando][N(R)]},access:function(p,R,z){return R===void 0||R&&typeof R=="string"&&z===void 0?this.get(p,R):(this.set(p,R,z),z!==void 0?z:R)},remove:function(p,R){var z,V=p[this.expando];if(V!==void 0){if(R!==void 0)for(z=(R=Array.isArray(R)?R.map(N):(R=N(R))in V?[R]:R.match(D)||[]).length;z--;)delete V[R[z]];(R===void 0||u.isEmptyObject(V))&&(p.nodeType?p[this.expando]=void 0:delete p[this.expando])}},hasData:function(p){var R=p[this.expando];return R!==void 0&&!u.isEmptyObject(R)}};var se=new re,ve=new re,ee=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,le=/[A-Z]/g;function H(p,R,z){var V,ie;if(z===void 0&&p.nodeType===1)if(V="data-"+R.replace(le,"-$&").toLowerCase(),typeof(z=p.getAttribute(V))=="string"){try{z=(ie=z)==="true"||ie!=="false"&&(ie==="null"?null:ie===+ie+""?+ie:ee.test(ie)?JSON.parse(ie):ie)}catch{}ve.set(p,R,z)}else z=void 0;return z}u.extend({hasData:function(p){return ve.hasData(p)||se.hasData(p)},data:function(p,R,z){return ve.access(p,R,z)},removeData:function(p,R){ve.remove(p,R)},_data:function(p,R,z){return se.access(p,R,z)},_removeData:function(p,R){se.remove(p,R)}}),u.fn.extend({data:function(p,R){var z,V,ie,ce=this[0],de=ce&&ce.attributes;if(p===void 0){if(this.length&&(ie=ve.get(ce),ce.nodeType===1&&!se.get(ce,"hasDataAttrs"))){for(z=de.length;z--;)de[z]&&(V=de[z].name).indexOf("data-")===0&&(V=N(V.slice(5)),H(ce,V,ie[V]));se.set(ce,"hasDataAttrs",!0)}return ie}return typeof p=="object"?this.each(function(){ve.set(this,p)}):pe(this,function(ye){var Te;if(ce&&ye===void 0)return(Te=ve.get(ce,p))!==void 0||(Te=H(ce,p))!==void 0?Te:void 0;this.each(function(){ve.set(this,p,ye)})},null,R,1<arguments.length,null,!0)},removeData:function(p){return this.each(function(){ve.remove(this,p)})}}),u.extend({queue:function(p,R,z){var V;if(p)return R=(R||"fx")+"queue",V=se.get(p,R),z&&(!V||Array.isArray(z)?V=se.access(p,R,u.makeArray(z)):V.push(z)),V||[]},dequeue:function(p,R){R=R||"fx";var z=u.queue(p,R),V=z.length,ie=z.shift(),ce=u._queueHooks(p,R);ie==="inprogress"&&(ie=z.shift(),V--),ie&&(R==="fx"&&z.unshift("inprogress"),delete ce.stop,ie.call(p,function(){u.dequeue(p,R)},ce)),!V&&ce&&ce.empty.fire()},_queueHooks:function(p,R){var z=R+"queueHooks";return se.get(p,z)||se.access(p,z,{empty:u.Callbacks("once memory").add(function(){se.remove(p,[R+"queue",z])})})}}),u.fn.extend({queue:function(p,R){var z=2;return typeof p!="string"&&(R=p,p="fx",z--),arguments.length<z?u.queue(this[0],p):R===void 0?this:this.each(function(){var V=u.queue(this,p,R);u._queueHooks(this,p),p==="fx"&&V[0]!=="inprogress"&&u.dequeue(this,p)})},dequeue:function(p){return this.each(function(){u.dequeue(this,p)})},clearQueue:function(p){return this.queue(p||"fx",[])},promise:function(p,R){var z,V=1,ie=u.Deferred(),ce=this,de=this.length,ye=function(){--V||ie.resolveWith(ce,[ce])};for(typeof p!="string"&&(R=p,p=void 0),p=p||"fx";de--;)(z=se.get(ce[de],p+"queueHooks"))&&z.empty&&(V++,z.empty.add(ye));return ye(),ie.promise(R)}});var I=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,O=new RegExp("^(?:([+-])=|)("+I+")([a-z%]*)$","i"),ae=["Top","Right","Bottom","Left"],_e=t.documentElement,Ae=function(p){return u.contains(p.ownerDocument,p)},Se={composed:!0};_e.getRootNode&&(Ae=function(p){return u.contains(p.ownerDocument,p)||p.getRootNode(Se)===p.ownerDocument});var ze=function(p,R){return(p=R||p).style.display==="none"||p.style.display===""&&Ae(p)&&u.css(p,"display")==="none"},Xe=function(p,R,z,V){var ie,ce,de={};for(ce in R)de[ce]=p.style[ce],p.style[ce]=R[ce];for(ce in ie=z.apply(p,[]),R)p.style[ce]=de[ce];return ie};function Ue(p,R,z,V){var ie,ce,de=20,ye=V?function(){return V.cur()}:function(){return u.css(p,R,"")},Te=ye(),$e=z&&z[3]||(u.cssNumber[R]?"":"px"),De=p.nodeType&&(u.cssNumber[R]||$e!=="px"&&+Te)&&O.exec(u.css(p,R));if(De&&De[3]!==$e){for(Te/=2,$e=$e||De[3],De=+Te||1;de--;)u.style(p,R,De+$e),(1-ce)*(1-(ce=ye()/Te||.5))<=0&&(de=0),De/=ce;De*=2,u.style(p,R,De+$e),z=z||[]}return z&&(De=+De||+Te||0,ie=z[1]?De+(z[1]+1)*z[2]:+z[2],V&&(V.unit=$e,V.start=De,V.end=ie)),ie}var Ze={};function He(p,R){for(var z,V,ie,ce,de,ye,Te,$e=[],De=0,Be=p.length;De<Be;De++)(V=p[De]).style&&(z=V.style.display,R?(z==="none"&&($e[De]=se.get(V,"display")||null,$e[De]||(V.style.display="")),V.style.display===""&&ze(V)&&($e[De]=(Te=de=ce=void 0,de=(ie=V).ownerDocument,ye=ie.nodeName,(Te=Ze[ye])||(ce=de.body.appendChild(de.createElement(ye)),Te=u.css(ce,"display"),ce.parentNode.removeChild(ce),Te==="none"&&(Te="block"),Ze[ye]=Te)))):z!=="none"&&($e[De]="none",se.set(V,"display",z)));for(De=0;De<Be;De++)$e[De]!=null&&(p[De].style.display=$e[De]);return p}u.fn.extend({show:function(){return He(this,!0)},hide:function(){return He(this)},toggle:function(p){return typeof p=="boolean"?p?this.show():this.hide():this.each(function(){ze(this)?u(this).show():u(this).hide()})}});var Je=/^(?:checkbox|radio)$/i,nt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,qe=/^$|^module$|\/(?:java|ecma)script/i,W={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ne(p,R){var z;return z=typeof p.getElementsByTagName<"u"?p.getElementsByTagName(R||"*"):typeof p.querySelectorAll<"u"?p.querySelectorAll(R||"*"):[],R===void 0||R&&S(p,R)?u.merge([p],z):z}function ue(p,R){for(var z=0,V=p.length;z<V;z++)se.set(p[z],"globalEval",!R||se.get(R[z],"globalEval"))}W.optgroup=W.option,W.tbody=W.tfoot=W.colgroup=W.caption=W.thead,W.th=W.td;var he,be,Re=/<|&#?\w+;/;function ge(p,R,z,V,ie){for(var ce,de,ye,Te,$e,De,Be=R.createDocumentFragment(),Pe=[],Le=0,et=p.length;Le<et;Le++)if((ce=p[Le])||ce===0)if(L(ce)==="object")u.merge(Pe,ce.nodeType?[ce]:ce);else if(Re.test(ce)){for(de=de||Be.appendChild(R.createElement("div")),ye=(nt.exec(ce)||["",""])[1].toLowerCase(),Te=W[ye]||W._default,de.innerHTML=Te[1]+u.htmlPrefilter(ce)+Te[2],De=Te[0];De--;)de=de.lastChild;u.merge(Pe,de.childNodes),(de=Be.firstChild).textContent=""}else Pe.push(R.createTextNode(ce));for(Be.textContent="",Le=0;ce=Pe[Le++];)if(V&&-1<u.inArray(ce,V))ie&&ie.push(ce);else if($e=Ae(ce),de=ne(Be.appendChild(ce),"script"),$e&&ue(de),z)for(De=0;ce=de[De++];)qe.test(ce.type||"")&&z.push(ce);return Be}he=t.createDocumentFragment().appendChild(t.createElement("div")),(be=t.createElement("input")).setAttribute("type","radio"),be.setAttribute("checked","checked"),be.setAttribute("name","t"),he.appendChild(be),g.checkClone=he.cloneNode(!0).cloneNode(!0).lastChild.checked,he.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!he.cloneNode(!0).lastChild.defaultValue;var we=/^key/,Ce=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Fe=/^([^.]*)(?:\.(.+)|)/;function Ve(){return!0}function Ye(){return!1}function We(p,R){return p===function(){try{return t.activeElement}catch{}}()==(R==="focus")}function Ie(p,R,z,V,ie,ce){var de,ye;if(typeof R=="object"){for(ye in typeof z!="string"&&(V=V||z,z=void 0),R)Ie(p,ye,z,V,R[ye],ce);return p}if(V==null&&ie==null?(ie=z,V=z=void 0):ie==null&&(typeof z=="string"?(ie=V,V=void 0):(ie=V,V=z,z=void 0)),ie===!1)ie=Ye;else if(!ie)return p;return ce===1&&(de=ie,(ie=function(Te){return u().off(Te),de.apply(this,arguments)}).guid=de.guid||(de.guid=u.guid++)),p.each(function(){u.event.add(this,R,ie,V,z)})}function Oe(p,R,z){z?(se.set(p,R,!1),u.event.add(p,R,{namespace:!1,handler:function(V){var ie,ce,de=se.get(this,R);if(1&V.isTrigger&&this[R]){if(de.length)(u.event.special[R]||{}).delegateType&&V.stopPropagation();else if(de=a.call(arguments),se.set(this,R,de),ie=z(this,R),this[R](),de!==(ce=se.get(this,R))||ie?se.set(this,R,!1):ce={},de!==ce)return V.stopImmediatePropagation(),V.preventDefault(),ce.value}else de.length&&(se.set(this,R,{value:u.event.trigger(u.extend(de[0],u.Event.prototype),de.slice(1),this)}),V.stopImmediatePropagation())}})):se.get(p,R)===void 0&&u.event.add(p,R,Ve)}u.event={global:{},add:function(p,R,z,V,ie){var ce,de,ye,Te,$e,De,Be,Pe,Le,et,rt,tt=se.get(p);if(tt)for(z.handler&&(z=(ce=z).handler,ie=ce.selector),ie&&u.find.matchesSelector(_e,ie),z.guid||(z.guid=u.guid++),(Te=tt.events)||(Te=tt.events={}),(de=tt.handle)||(de=tt.handle=function(yt){return typeof u<"u"&&u.event.triggered!==yt.type?u.event.dispatch.apply(p,arguments):void 0}),$e=(R=(R||"").match(D)||[""]).length;$e--;)Le=rt=(ye=Fe.exec(R[$e])||[])[1],et=(ye[2]||"").split(".").sort(),Le&&(Be=u.event.special[Le]||{},Le=(ie?Be.delegateType:Be.bindType)||Le,Be=u.event.special[Le]||{},De=u.extend({type:Le,origType:rt,data:V,handler:z,guid:z.guid,selector:ie,needsContext:ie&&u.expr.match.needsContext.test(ie),namespace:et.join(".")},ce),(Pe=Te[Le])||((Pe=Te[Le]=[]).delegateCount=0,Be.setup&&Be.setup.call(p,V,et,de)!==!1||p.addEventListener&&p.addEventListener(Le,de)),Be.add&&(Be.add.call(p,De),De.handler.guid||(De.handler.guid=z.guid)),ie?Pe.splice(Pe.delegateCount++,0,De):Pe.push(De),u.event.global[Le]=!0)},remove:function(p,R,z,V,ie){var ce,de,ye,Te,$e,De,Be,Pe,Le,et,rt,tt=se.hasData(p)&&se.get(p);if(tt&&(Te=tt.events)){for($e=(R=(R||"").match(D)||[""]).length;$e--;)if(Le=rt=(ye=Fe.exec(R[$e])||[])[1],et=(ye[2]||"").split(".").sort(),Le){for(Be=u.event.special[Le]||{},Pe=Te[Le=(V?Be.delegateType:Be.bindType)||Le]||[],ye=ye[2]&&new RegExp("(^|\\.)"+et.join("\\.(?:.*\\.|)")+"(\\.|$)"),de=ce=Pe.length;ce--;)De=Pe[ce],!ie&&rt!==De.origType||z&&z.guid!==De.guid||ye&&!ye.test(De.namespace)||V&&V!==De.selector&&(V!=="**"||!De.selector)||(Pe.splice(ce,1),De.selector&&Pe.delegateCount--,Be.remove&&Be.remove.call(p,De));de&&!Pe.length&&(Be.teardown&&Be.teardown.call(p,et,tt.handle)!==!1||u.removeEvent(p,Le,tt.handle),delete Te[Le])}else for(Le in Te)u.event.remove(p,Le+R[$e],z,V,!0);u.isEmptyObject(Te)&&se.remove(p,"handle events")}},dispatch:function(p){var R,z,V,ie,ce,de,ye=u.event.fix(p),Te=new Array(arguments.length),$e=(se.get(this,"events")||{})[ye.type]||[],De=u.event.special[ye.type]||{};for(Te[0]=ye,R=1;R<arguments.length;R++)Te[R]=arguments[R];if(ye.delegateTarget=this,!De.preDispatch||De.preDispatch.call(this,ye)!==!1){for(de=u.event.handlers.call(this,ye,$e),R=0;(ie=de[R++])&&!ye.isPropagationStopped();)for(ye.currentTarget=ie.elem,z=0;(ce=ie.handlers[z++])&&!ye.isImmediatePropagationStopped();)ye.rnamespace&&ce.namespace!==!1&&!ye.rnamespace.test(ce.namespace)||(ye.handleObj=ce,ye.data=ce.data,(V=((u.event.special[ce.origType]||{}).handle||ce.handler).apply(ie.elem,Te))!==void 0&&(ye.result=V)===!1&&(ye.preventDefault(),ye.stopPropagation()));return De.postDispatch&&De.postDispatch.call(this,ye),ye.result}},handlers:function(p,R){var z,V,ie,ce,de,ye=[],Te=R.delegateCount,$e=p.target;if(Te&&$e.nodeType&&!(p.type==="click"&&1<=p.button)){for(;$e!==this;$e=$e.parentNode||this)if($e.nodeType===1&&(p.type!=="click"||$e.disabled!==!0)){for(ce=[],de={},z=0;z<Te;z++)de[ie=(V=R[z]).selector+" "]===void 0&&(de[ie]=V.needsContext?-1<u(ie,this).index($e):u.find(ie,this,null,[$e]).length),de[ie]&&ce.push(V);ce.length&&ye.push({elem:$e,handlers:ce})}}return $e=this,Te<R.length&&ye.push({elem:$e,handlers:R.slice(Te)}),ye},addProp:function(p,R){Object.defineProperty(u.Event.prototype,p,{enumerable:!0,configurable:!0,get:x(R)?function(){if(this.originalEvent)return R(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[p]},set:function(z){Object.defineProperty(this,p,{enumerable:!0,configurable:!0,writable:!0,value:z})}})},fix:function(p){return p[u.expando]?p:new u.Event(p)},special:{load:{noBubble:!0},click:{setup:function(p){var R=this||p;return Je.test(R.type)&&R.click&&S(R,"input")&&Oe(R,"click",Ve),!1},trigger:function(p){var R=this||p;return Je.test(R.type)&&R.click&&S(R,"input")&&Oe(R,"click"),!0},_default:function(p){var R=p.target;return Je.test(R.type)&&R.click&&S(R,"input")&&se.get(R,"click")||S(R,"a")}},beforeunload:{postDispatch:function(p){p.result!==void 0&&p.originalEvent&&(p.originalEvent.returnValue=p.result)}}}},u.removeEvent=function(p,R,z){p.removeEventListener&&p.removeEventListener(R,z)},u.Event=function(p,R){if(!(this instanceof u.Event))return new u.Event(p,R);p&&p.type?(this.originalEvent=p,this.type=p.type,this.isDefaultPrevented=p.defaultPrevented||p.defaultPrevented===void 0&&p.returnValue===!1?Ve:Ye,this.target=p.target&&p.target.nodeType===3?p.target.parentNode:p.target,this.currentTarget=p.currentTarget,this.relatedTarget=p.relatedTarget):this.type=p,R&&u.extend(this,R),this.timeStamp=p&&p.timeStamp||Date.now(),this[u.expando]=!0},u.Event.prototype={constructor:u.Event,isDefaultPrevented:Ye,isPropagationStopped:Ye,isImmediatePropagationStopped:Ye,isSimulated:!1,preventDefault:function(){var p=this.originalEvent;this.isDefaultPrevented=Ve,p&&!this.isSimulated&&p.preventDefault()},stopPropagation:function(){var p=this.originalEvent;this.isPropagationStopped=Ve,p&&!this.isSimulated&&p.stopPropagation()},stopImmediatePropagation:function(){var p=this.originalEvent;this.isImmediatePropagationStopped=Ve,p&&!this.isSimulated&&p.stopImmediatePropagation(),this.stopPropagation()}},u.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(p){var R=p.button;return p.which==null&&we.test(p.type)?p.charCode!=null?p.charCode:p.keyCode:!p.which&&R!==void 0&&Ce.test(p.type)?1&R?1:2&R?3:4&R?2:0:p.which}},u.event.addProp),u.each({focus:"focusin",blur:"focusout"},function(p,R){u.event.special[p]={setup:function(){return Oe(this,p,We),!1},trigger:function(){return Oe(this,p),!0},delegateType:R}}),u.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(p,R){u.event.special[p]={delegateType:R,bindType:R,handle:function(z){var V,ie=z.relatedTarget,ce=z.handleObj;return ie&&(ie===this||u.contains(this,ie))||(z.type=ce.origType,V=ce.handler.apply(this,arguments),z.type=R),V}}}),u.fn.extend({on:function(p,R,z,V){return Ie(this,p,R,z,V)},one:function(p,R,z,V){return Ie(this,p,R,z,V,1)},off:function(p,R,z){var V,ie;if(p&&p.preventDefault&&p.handleObj)return V=p.handleObj,u(p.delegateTarget).off(V.namespace?V.origType+"."+V.namespace:V.origType,V.selector,V.handler),this;if(typeof p=="object"){for(ie in p)this.off(ie,R,p[ie]);return this}return R!==!1&&typeof R!="function"||(z=R,R=void 0),z===!1&&(z=Ye),this.each(function(){u.event.remove(this,p,z,R)})}});var it=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,at=/<script|<style|<link/i,ht=/checked\s*(?:[^=]|=\s*.checked.)/i,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Qt(p,R){return S(p,"table")&&S(R.nodeType!==11?R:R.firstChild,"tr")&&u(p).children("tbody")[0]||p}function ln(p){return p.type=(p.getAttribute("type")!==null)+"/"+p.type,p}function bt(p){return(p.type||"").slice(0,5)==="true/"?p.type=p.type.slice(5):p.removeAttribute("type"),p}function gt(p,R){var z,V,ie,ce,de,ye,Te,$e;if(R.nodeType===1){if(se.hasData(p)&&(ce=se.access(p),de=se.set(R,ce),$e=ce.events))for(ie in delete de.handle,de.events={},$e)for(z=0,V=$e[ie].length;z<V;z++)u.event.add(R,ie,$e[ie][z]);ve.hasData(p)&&(ye=ve.access(p),Te=u.extend({},ye),ve.set(R,Te))}}function Lt(p,R,z,V){R=i.apply([],R);var ie,ce,de,ye,Te,$e,De=0,Be=p.length,Pe=Be-1,Le=R[0],et=x(Le);if(et||1<Be&&typeof Le=="string"&&!g.checkClone&&ht.test(Le))return p.each(function(rt){var tt=p.eq(rt);et&&(R[0]=Le.call(this,rt,tt.html())),Lt(tt,R,z,V)});if(Be&&(ce=(ie=ge(R,p[0].ownerDocument,!1,p,V)).firstChild,ie.childNodes.length===1&&(ie=ce),ce||V)){for(ye=(de=u.map(ne(ie,"script"),ln)).length;De<Be;De++)Te=ie,De!==Pe&&(Te=u.clone(Te,!0,!0),ye&&u.merge(de,ne(Te,"script"))),z.call(p[De],Te,De);if(ye)for($e=de[de.length-1].ownerDocument,u.map(de,bt),De=0;De<ye;De++)Te=de[De],qe.test(Te.type||"")&&!se.access(Te,"globalEval")&&u.contains($e,Te)&&(Te.src&&(Te.type||"").toLowerCase()!=="module"?u._evalUrl&&!Te.noModule&&u._evalUrl(Te.src,{nonce:Te.nonce||Te.getAttribute("nonce")}):M(Te.textContent.replace(St,""),Te,$e))}return p}function Yt(p,R,z){for(var V,ie=R?u.filter(R,p):p,ce=0;(V=ie[ce])!=null;ce++)z||V.nodeType!==1||u.cleanData(ne(V)),V.parentNode&&(z&&Ae(V)&&ue(ne(V,"script")),V.parentNode.removeChild(V));return p}u.extend({htmlPrefilter:function(p){return p.replace(it,"<$1></$2>")},clone:function(p,R,z){var V,ie,ce,de,ye,Te,$e,De=p.cloneNode(!0),Be=Ae(p);if(!(g.noCloneChecked||p.nodeType!==1&&p.nodeType!==11||u.isXMLDoc(p)))for(de=ne(De),V=0,ie=(ce=ne(p)).length;V<ie;V++)ye=ce[V],Te=de[V],($e=Te.nodeName.toLowerCase())==="input"&&Je.test(ye.type)?Te.checked=ye.checked:$e!=="input"&&$e!=="textarea"||(Te.defaultValue=ye.defaultValue);if(R)if(z)for(ce=ce||ne(p),de=de||ne(De),V=0,ie=ce.length;V<ie;V++)gt(ce[V],de[V]);else gt(p,De);return 0<(de=ne(De,"script")).length&&ue(de,!Be&&ne(p,"script")),De},cleanData:function(p){for(var R,z,V,ie=u.event.special,ce=0;(z=p[ce])!==void 0;ce++)if(te(z)){if(R=z[se.expando]){if(R.events)for(V in R.events)ie[V]?u.event.remove(z,V):u.removeEvent(z,V,R.handle);z[se.expando]=void 0}z[ve.expando]&&(z[ve.expando]=void 0)}}}),u.fn.extend({detach:function(p){return Yt(this,p,!0)},remove:function(p){return Yt(this,p)},text:function(p){return pe(this,function(R){return R===void 0?u.text(this):this.empty().each(function(){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||(this.textContent=R)})},null,p,arguments.length)},append:function(){return Lt(this,arguments,function(p){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||Qt(this,p).appendChild(p)})},prepend:function(){return Lt(this,arguments,function(p){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var R=Qt(this,p);R.insertBefore(p,R.firstChild)}})},before:function(){return Lt(this,arguments,function(p){this.parentNode&&this.parentNode.insertBefore(p,this)})},after:function(){return Lt(this,arguments,function(p){this.parentNode&&this.parentNode.insertBefore(p,this.nextSibling)})},empty:function(){for(var p,R=0;(p=this[R])!=null;R++)p.nodeType===1&&(u.cleanData(ne(p,!1)),p.textContent="");return this},clone:function(p,R){return p=p!=null&&p,R=R??p,this.map(function(){return u.clone(this,p,R)})},html:function(p){return pe(this,function(R){var z=this[0]||{},V=0,ie=this.length;if(R===void 0&&z.nodeType===1)return z.innerHTML;if(typeof R=="string"&&!at.test(R)&&!W[(nt.exec(R)||["",""])[1].toLowerCase()]){R=u.htmlPrefilter(R);try{for(;V<ie;V++)(z=this[V]||{}).nodeType===1&&(u.cleanData(ne(z,!1)),z.innerHTML=R);z=0}catch{}}z&&this.empty().append(R)},null,p,arguments.length)},replaceWith:function(){var p=[];return Lt(this,arguments,function(R){var z=this.parentNode;u.inArray(this,p)<0&&(u.cleanData(ne(this)),z&&z.replaceChild(R,this))},p)}}),u.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(p,R){u.fn[p]=function(z){for(var V,ie=[],ce=u(z),de=ce.length-1,ye=0;ye<=de;ye++)V=ye===de?this:this.clone(!0),u(ce[ye])[R](V),s.apply(ie,V.get());return this.pushStack(ie)}});var Gt=new RegExp("^("+I+")(?!px)[a-z%]+$","i"),nn=function(p){var R=p.ownerDocument.defaultView;return R&&R.opener||(R=e),R.getComputedStyle(p)},bn=new RegExp(ae.join("|"),"i");function pn(p,R,z){var V,ie,ce,de,ye=p.style;return(z=z||nn(p))&&((de=z.getPropertyValue(R)||z[R])!==""||Ae(p)||(de=u.style(p,R)),!g.pixelBoxStyles()&&Gt.test(de)&&bn.test(R)&&(V=ye.width,ie=ye.minWidth,ce=ye.maxWidth,ye.minWidth=ye.maxWidth=ye.width=de,de=z.width,ye.width=V,ye.minWidth=ie,ye.maxWidth=ce)),de!==void 0?de+"":de}function Vn(p,R){return{get:function(){if(!p())return(this.get=R).apply(this,arguments);delete this.get}}}(function(){function p(){if(Te){ye.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Te.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",_e.appendChild(ye).appendChild(Te);var $e=e.getComputedStyle(Te);z=$e.top!=="1%",de=R($e.marginLeft)===12,Te.style.right="60%",ce=R($e.right)===36,V=R($e.width)===36,Te.style.position="absolute",ie=R(Te.offsetWidth/3)===12,_e.removeChild(ye),Te=null}}function R($e){return Math.round(parseFloat($e))}var z,V,ie,ce,de,ye=t.createElement("div"),Te=t.createElement("div");Te.style&&(Te.style.backgroundClip="content-box",Te.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle=Te.style.backgroundClip==="content-box",u.extend(g,{boxSizingReliable:function(){return p(),V},pixelBoxStyles:function(){return p(),ce},pixelPosition:function(){return p(),z},reliableMarginLeft:function(){return p(),de},scrollboxSize:function(){return p(),ie}}))})();var Kn=["Webkit","Moz","ms"],Yn=t.createElement("div").style,Xn={};function Mn(p){var R=u.cssProps[p]||Xn[p];return R||(p in Yn?p:Xn[p]=function(z){for(var V=z[0].toUpperCase()+z.slice(1),ie=Kn.length;ie--;)if((z=Kn[ie]+V)in Yn)return z}(p)||p)}var Ei=/^(none|table(?!-c[ea]).+)/,Jn=/^--/,Ai={position:"absolute",visibility:"hidden",display:"block"},Zn={letterSpacing:"0",fontWeight:"400"};function Qn(p,R,z){var V=O.exec(R);return V?Math.max(0,V[2]-(z||0))+(V[3]||"px"):R}function Rn(p,R,z,V,ie,ce){var de=R==="width"?1:0,ye=0,Te=0;if(z===(V?"border":"content"))return 0;for(;de<4;de+=2)z==="margin"&&(Te+=u.css(p,z+ae[de],!0,ie)),V?(z==="content"&&(Te-=u.css(p,"padding"+ae[de],!0,ie)),z!=="margin"&&(Te-=u.css(p,"border"+ae[de]+"Width",!0,ie))):(Te+=u.css(p,"padding"+ae[de],!0,ie),z!=="padding"?Te+=u.css(p,"border"+ae[de]+"Width",!0,ie):ye+=u.css(p,"border"+ae[de]+"Width",!0,ie));return!V&&0<=ce&&(Te+=Math.max(0,Math.ceil(p["offset"+R[0].toUpperCase()+R.slice(1)]-ce-Te-ye-.5))||0),Te}function ei(p,R,z){var V=nn(p),ie=(!g.boxSizingReliable()||z)&&u.css(p,"boxSizing",!1,V)==="border-box",ce=ie,de=pn(p,R,V),ye="offset"+R[0].toUpperCase()+R.slice(1);if(Gt.test(de)){if(!z)return de;de="auto"}return(!g.boxSizingReliable()&&ie||de==="auto"||!parseFloat(de)&&u.css(p,"display",!1,V)==="inline")&&p.getClientRects().length&&(ie=u.css(p,"boxSizing",!1,V)==="border-box",(ce=ye in p)&&(de=p[ye])),(de=parseFloat(de)||0)+Rn(p,R,z||(ie?"border":"content"),ce,V,de)+"px"}function Wt(p,R,z,V,ie){return new Wt.prototype.init(p,R,z,V,ie)}u.extend({cssHooks:{opacity:{get:function(p,R){if(R){var z=pn(p,"opacity");return z===""?"1":z}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(p,R,z,V){if(p&&p.nodeType!==3&&p.nodeType!==8&&p.style){var ie,ce,de,ye=N(R),Te=Jn.test(R),$e=p.style;if(Te||(R=Mn(ye)),de=u.cssHooks[R]||u.cssHooks[ye],z===void 0)return de&&"get"in de&&(ie=de.get(p,!1,V))!==void 0?ie:$e[R];(ce=typeof z)=="string"&&(ie=O.exec(z))&&ie[1]&&(z=Ue(p,R,ie),ce="number"),z!=null&&z==z&&(ce!=="number"||Te||(z+=ie&&ie[3]||(u.cssNumber[ye]?"":"px")),g.clearCloneStyle||z!==""||R.indexOf("background")!==0||($e[R]="inherit"),de&&"set"in de&&(z=de.set(p,z,V))===void 0||(Te?$e.setProperty(R,z):$e[R]=z))}},css:function(p,R,z,V){var ie,ce,de,ye=N(R);return Jn.test(R)||(R=Mn(ye)),(de=u.cssHooks[R]||u.cssHooks[ye])&&"get"in de&&(ie=de.get(p,!0,z)),ie===void 0&&(ie=pn(p,R,V)),ie==="normal"&&R in Zn&&(ie=Zn[R]),z===""||z?(ce=parseFloat(ie),z===!0||isFinite(ce)?ce||0:ie):ie}}),u.each(["height","width"],function(p,R){u.cssHooks[R]={get:function(z,V,ie){if(V)return!Ei.test(u.css(z,"display"))||z.getClientRects().length&&z.getBoundingClientRect().width?ei(z,R,ie):Xe(z,Ai,function(){return ei(z,R,ie)})},set:function(z,V,ie){var ce,de=nn(z),ye=!g.scrollboxSize()&&de.position==="absolute",Te=(ye||ie)&&u.css(z,"boxSizing",!1,de)==="border-box",$e=ie?Rn(z,R,ie,Te,de):0;return Te&&ye&&($e-=Math.ceil(z["offset"+R[0].toUpperCase()+R.slice(1)]-parseFloat(de[R])-Rn(z,R,"border",!1,de)-.5)),$e&&(ce=O.exec(V))&&(ce[3]||"px")!=="px"&&(z.style[R]=V,V=u.css(z,R)),Qn(0,V,$e)}}}),u.cssHooks.marginLeft=Vn(g.reliableMarginLeft,function(p,R){if(R)return(parseFloat(pn(p,"marginLeft"))||p.getBoundingClientRect().left-Xe(p,{marginLeft:0},function(){return p.getBoundingClientRect().left}))+"px"}),u.each({margin:"",padding:"",border:"Width"},function(p,R){u.cssHooks[p+R]={expand:function(z){for(var V=0,ie={},ce=typeof z=="string"?z.split(" "):[z];V<4;V++)ie[p+ae[V]+R]=ce[V]||ce[V-2]||ce[0];return ie}},p!=="margin"&&(u.cssHooks[p+R].set=Qn)}),u.fn.extend({css:function(p,R){return pe(this,function(z,V,ie){var ce,de,ye={},Te=0;if(Array.isArray(V)){for(ce=nn(z),de=V.length;Te<de;Te++)ye[V[Te]]=u.css(z,V[Te],!1,ce);return ye}return ie!==void 0?u.style(z,V,ie):u.css(z,V)},p,R,1<arguments.length)}}),((u.Tween=Wt).prototype={constructor:Wt,init:function(p,R,z,V,ie,ce){this.elem=p,this.prop=z,this.easing=ie||u.easing._default,this.options=R,this.start=this.now=this.cur(),this.end=V,this.unit=ce||(u.cssNumber[z]?"":"px")},cur:function(){var p=Wt.propHooks[this.prop];return p&&p.get?p.get(this):Wt.propHooks._default.get(this)},run:function(p){var R,z=Wt.propHooks[this.prop];return this.options.duration?this.pos=R=u.easing[this.easing](p,this.options.duration*p,0,1,this.options.duration):this.pos=R=p,this.now=(this.end-this.start)*R+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),z&&z.set?z.set(this):Wt.propHooks._default.set(this),this}}).init.prototype=Wt.prototype,(Wt.propHooks={_default:{get:function(p){var R;return p.elem.nodeType!==1||p.elem[p.prop]!=null&&p.elem.style[p.prop]==null?p.elem[p.prop]:(R=u.css(p.elem,p.prop,""))&&R!=="auto"?R:0},set:function(p){u.fx.step[p.prop]?u.fx.step[p.prop](p):p.elem.nodeType!==1||!u.cssHooks[p.prop]&&p.elem.style[Mn(p.prop)]==null?p.elem[p.prop]=p.now:u.style(p.elem,p.prop,p.now+p.unit)}}}).scrollTop=Wt.propHooks.scrollLeft={set:function(p){p.elem.nodeType&&p.elem.parentNode&&(p.elem[p.prop]=p.now)}},u.easing={linear:function(p){return p},swing:function(p){return .5-Math.cos(p*Math.PI)/2},_default:"swing"},u.fx=Wt.prototype.init,u.fx.step={};var cn,yn,un,ti,Si=/^(?:toggle|show|hide)$/,Ci=/queueHooks$/;function Pn(){yn&&(t.hidden===!1&&e.requestAnimationFrame?e.requestAnimationFrame(Pn):e.setTimeout(Pn,u.fx.interval),u.fx.tick())}function ni(){return e.setTimeout(function(){cn=void 0}),cn=Date.now()}function xn(p,R){var z,V=0,ie={height:p};for(R=R?1:0;V<4;V+=2-R)ie["margin"+(z=ae[V])]=ie["padding"+z]=p;return R&&(ie.opacity=ie.width=p),ie}function ii(p,R,z){for(var V,ie=(qt.tweeners[R]||[]).concat(qt.tweeners["*"]),ce=0,de=ie.length;ce<de;ce++)if(V=ie[ce].call(z,R,p))return V}function qt(p,R,z){var V,ie,ce=0,de=qt.prefilters.length,ye=u.Deferred().always(function(){delete Te.elem}),Te=function(){if(ie)return!1;for(var Be=cn||ni(),Pe=Math.max(0,$e.startTime+$e.duration-Be),Le=1-(Pe/$e.duration||0),et=0,rt=$e.tweens.length;et<rt;et++)$e.tweens[et].run(Le);return ye.notifyWith(p,[$e,Le,Pe]),Le<1&&rt?Pe:(rt||ye.notifyWith(p,[$e,1,0]),ye.resolveWith(p,[$e]),!1)},$e=ye.promise({elem:p,props:u.extend({},R),opts:u.extend(!0,{specialEasing:{},easing:u.easing._default},z),originalProperties:R,originalOptions:z,startTime:cn||ni(),duration:z.duration,tweens:[],createTween:function(Be,Pe){var Le=u.Tween(p,$e.opts,Be,Pe,$e.opts.specialEasing[Be]||$e.opts.easing);return $e.tweens.push(Le),Le},stop:function(Be){var Pe=0,Le=Be?$e.tweens.length:0;if(ie)return this;for(ie=!0;Pe<Le;Pe++)$e.tweens[Pe].run(1);return Be?(ye.notifyWith(p,[$e,1,0]),ye.resolveWith(p,[$e,Be])):ye.rejectWith(p,[$e,Be]),this}}),De=$e.props;for(!function(Be,Pe){var Le,et,rt,tt,yt;for(Le in Be)if(rt=Pe[et=N(Le)],tt=Be[Le],Array.isArray(tt)&&(rt=tt[1],tt=Be[Le]=tt[0]),Le!==et&&(Be[et]=tt,delete Be[Le]),(yt=u.cssHooks[et])&&"expand"in yt)for(Le in tt=yt.expand(tt),delete Be[et],tt)Le in Be||(Be[Le]=tt[Le],Pe[Le]=rt);else Pe[et]=rt}(De,$e.opts.specialEasing);ce<de;ce++)if(V=qt.prefilters[ce].call($e,p,De,$e.opts))return x(V.stop)&&(u._queueHooks($e.elem,$e.opts.queue).stop=V.stop.bind(V)),V;return u.map(De,ii,$e),x($e.opts.start)&&$e.opts.start.call(p,$e),$e.progress($e.opts.progress).done($e.opts.done,$e.opts.complete).fail($e.opts.fail).always($e.opts.always),u.fx.timer(u.extend(Te,{elem:p,anim:$e,queue:$e.opts.queue})),$e}u.Animation=u.extend(qt,{tweeners:{"*":[function(p,R){var z=this.createTween(p,R);return Ue(z.elem,p,O.exec(R),z),z}]},tweener:function(p,R){x(p)?(R=p,p=["*"]):p=p.match(D);for(var z,V=0,ie=p.length;V<ie;V++)z=p[V],qt.tweeners[z]=qt.tweeners[z]||[],qt.tweeners[z].unshift(R)},prefilters:[function(p,R,z){var V,ie,ce,de,ye,Te,$e,De,Be="width"in R||"height"in R,Pe=this,Le={},et=p.style,rt=p.nodeType&&ze(p),tt=se.get(p,"fxshow");for(V in z.queue||((de=u._queueHooks(p,"fx")).unqueued==null&&(de.unqueued=0,ye=de.empty.fire,de.empty.fire=function(){de.unqueued||ye()}),de.unqueued++,Pe.always(function(){Pe.always(function(){de.unqueued--,u.queue(p,"fx").length||de.empty.fire()})})),R)if(ie=R[V],Si.test(ie)){if(delete R[V],ce=ce||ie==="toggle",ie===(rt?"hide":"show")){if(ie!=="show"||!tt||tt[V]===void 0)continue;rt=!0}Le[V]=tt&&tt[V]||u.style(p,V)}if((Te=!u.isEmptyObject(R))||!u.isEmptyObject(Le))for(V in Be&&p.nodeType===1&&(z.overflow=[et.overflow,et.overflowX,et.overflowY],($e=tt&&tt.display)==null&&($e=se.get(p,"display")),(De=u.css(p,"display"))==="none"&&($e?De=$e:(He([p],!0),$e=p.style.display||$e,De=u.css(p,"display"),He([p]))),(De==="inline"||De==="inline-block"&&$e!=null)&&u.css(p,"float")==="none"&&(Te||(Pe.done(function(){et.display=$e}),$e==null&&(De=et.display,$e=De==="none"?"":De)),et.display="inline-block")),z.overflow&&(et.overflow="hidden",Pe.always(function(){et.overflow=z.overflow[0],et.overflowX=z.overflow[1],et.overflowY=z.overflow[2]})),Te=!1,Le)Te||(tt?"hidden"in tt&&(rt=tt.hidden):tt=se.access(p,"fxshow",{display:$e}),ce&&(tt.hidden=!rt),rt&&He([p],!0),Pe.done(function(){for(V in rt||He([p]),se.remove(p,"fxshow"),Le)u.style(p,V,Le[V])})),Te=ii(rt?tt[V]:0,V,Pe),V in tt||(tt[V]=Te.start,rt&&(Te.end=Te.start,Te.start=0))}],prefilter:function(p,R){R?qt.prefilters.unshift(p):qt.prefilters.push(p)}}),u.speed=function(p,R,z){var V=p&&typeof p=="object"?u.extend({},p):{complete:z||!z&&R||x(p)&&p,duration:p,easing:z&&R||R&&!x(R)&&R};return u.fx.off?V.duration=0:typeof V.duration!="number"&&(V.duration in u.fx.speeds?V.duration=u.fx.speeds[V.duration]:V.duration=u.fx.speeds._default),V.queue!=null&&V.queue!==!0||(V.queue="fx"),V.old=V.complete,V.complete=function(){x(V.old)&&V.old.call(this),V.queue&&u.dequeue(this,V.queue)},V},u.fn.extend({fadeTo:function(p,R,z,V){return this.filter(ze).css("opacity",0).show().end().animate({opacity:R},p,z,V)},animate:function(p,R,z,V){var ie=u.isEmptyObject(p),ce=u.speed(R,z,V),de=function(){var ye=qt(this,u.extend({},p),ce);(ie||se.get(this,"finish"))&&ye.stop(!0)};return de.finish=de,ie||ce.queue===!1?this.each(de):this.queue(ce.queue,de)},stop:function(p,R,z){var V=function(ie){var ce=ie.stop;delete ie.stop,ce(z)};return typeof p!="string"&&(z=R,R=p,p=void 0),R&&p!==!1&&this.queue(p||"fx",[]),this.each(function(){var ie=!0,ce=p!=null&&p+"queueHooks",de=u.timers,ye=se.get(this);if(ce)ye[ce]&&ye[ce].stop&&V(ye[ce]);else for(ce in ye)ye[ce]&&ye[ce].stop&&Ci.test(ce)&&V(ye[ce]);for(ce=de.length;ce--;)de[ce].elem!==this||p!=null&&de[ce].queue!==p||(de[ce].anim.stop(z),ie=!1,de.splice(ce,1));!ie&&z||u.dequeue(this,p)})},finish:function(p){return p!==!1&&(p=p||"fx"),this.each(function(){var R,z=se.get(this),V=z[p+"queue"],ie=z[p+"queueHooks"],ce=u.timers,de=V?V.length:0;for(z.finish=!0,u.queue(this,p,[]),ie&&ie.stop&&ie.stop.call(this,!0),R=ce.length;R--;)ce[R].elem===this&&ce[R].queue===p&&(ce[R].anim.stop(!0),ce.splice(R,1));for(R=0;R<de;R++)V[R]&&V[R].finish&&V[R].finish.call(this);delete z.finish})}}),u.each(["toggle","show","hide"],function(p,R){var z=u.fn[R];u.fn[R]=function(V,ie,ce){return V==null||typeof V=="boolean"?z.apply(this,arguments):this.animate(xn(R,!0),V,ie,ce)}}),u.each({slideDown:xn("show"),slideUp:xn("hide"),slideToggle:xn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(p,R){u.fn[p]=function(z,V,ie){return this.animate(R,z,V,ie)}}),u.timers=[],u.fx.tick=function(){var p,R=0,z=u.timers;for(cn=Date.now();R<z.length;R++)(p=z[R])()||z[R]!==p||z.splice(R--,1);z.length||u.fx.stop(),cn=void 0},u.fx.timer=function(p){u.timers.push(p),u.fx.start()},u.fx.interval=13,u.fx.start=function(){yn||(yn=!0,Pn())},u.fx.stop=function(){yn=null},u.fx.speeds={slow:600,fast:200,_default:400},u.fn.delay=function(p,R){return p=u.fx&&u.fx.speeds[p]||p,R=R||"fx",this.queue(R,function(z,V){var ie=e.setTimeout(z,p);V.stop=function(){e.clearTimeout(ie)}})},un=t.createElement("input"),ti=t.createElement("select").appendChild(t.createElement("option")),un.type="checkbox",g.checkOn=un.value!=="",g.optSelected=ti.selected,(un=t.createElement("input")).value="t",un.type="radio",g.radioValue=un.value==="t";var ri,gn=u.expr.attrHandle;u.fn.extend({attr:function(p,R){return pe(this,u.attr,p,R,1<arguments.length)},removeAttr:function(p){return this.each(function(){u.removeAttr(this,p)})}}),u.extend({attr:function(p,R,z){var V,ie,ce=p.nodeType;if(ce!==3&&ce!==8&&ce!==2)return typeof p.getAttribute>"u"?u.prop(p,R,z):(ce===1&&u.isXMLDoc(p)||(ie=u.attrHooks[R.toLowerCase()]||(u.expr.match.bool.test(R)?ri:void 0)),z!==void 0?z===null?void u.removeAttr(p,R):ie&&"set"in ie&&(V=ie.set(p,z,R))!==void 0?V:(p.setAttribute(R,z+""),z):ie&&"get"in ie&&(V=ie.get(p,R))!==null?V:(V=u.find.attr(p,R))==null?void 0:V)},attrHooks:{type:{set:function(p,R){if(!g.radioValue&&R==="radio"&&S(p,"input")){var z=p.value;return p.setAttribute("type",R),z&&(p.value=z),R}}}},removeAttr:function(p,R){var z,V=0,ie=R&&R.match(D);if(ie&&p.nodeType===1)for(;z=ie[V++];)p.removeAttribute(z)}}),ri={set:function(p,R,z){return R===!1?u.removeAttr(p,z):p.setAttribute(z,z),z}},u.each(u.expr.match.bool.source.match(/\w+/g),function(p,R){var z=gn[R]||u.find.attr;gn[R]=function(V,ie,ce){var de,ye,Te=ie.toLowerCase();return ce||(ye=gn[Te],gn[Te]=de,de=z(V,ie,ce)!=null?Te:null,gn[Te]=ye),de}});var Ti=/^(?:input|select|textarea|button)$/i,ki=/^(?:a|area)$/i;function rn(p){return(p.match(D)||[]).join(" ")}function an(p){return p.getAttribute&&p.getAttribute("class")||""}function Ln(p){return Array.isArray(p)?p:typeof p=="string"&&p.match(D)||[]}u.fn.extend({prop:function(p,R){return pe(this,u.prop,p,R,1<arguments.length)},removeProp:function(p){return this.each(function(){delete this[u.propFix[p]||p]})}}),u.extend({prop:function(p,R,z){var V,ie,ce=p.nodeType;if(ce!==3&&ce!==8&&ce!==2)return ce===1&&u.isXMLDoc(p)||(R=u.propFix[R]||R,ie=u.propHooks[R]),z!==void 0?ie&&"set"in ie&&(V=ie.set(p,z,R))!==void 0?V:p[R]=z:ie&&"get"in ie&&(V=ie.get(p,R))!==null?V:p[R]},propHooks:{tabIndex:{get:function(p){var R=u.find.attr(p,"tabindex");return R?parseInt(R,10):Ti.test(p.nodeName)||ki.test(p.nodeName)&&p.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(u.propHooks.selected={get:function(p){var R=p.parentNode;return R&&R.parentNode&&R.parentNode.selectedIndex,null},set:function(p){var R=p.parentNode;R&&(R.selectedIndex,R.parentNode&&R.parentNode.selectedIndex)}}),u.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){u.propFix[this.toLowerCase()]=this}),u.fn.extend({addClass:function(p){var R,z,V,ie,ce,de,ye,Te=0;if(x(p))return this.each(function($e){u(this).addClass(p.call(this,$e,an(this)))});if((R=Ln(p)).length){for(;z=this[Te++];)if(ie=an(z),V=z.nodeType===1&&" "+rn(ie)+" "){for(de=0;ce=R[de++];)V.indexOf(" "+ce+" ")<0&&(V+=ce+" ");ie!==(ye=rn(V))&&z.setAttribute("class",ye)}}return this},removeClass:function(p){var R,z,V,ie,ce,de,ye,Te=0;if(x(p))return this.each(function($e){u(this).removeClass(p.call(this,$e,an(this)))});if(!arguments.length)return this.attr("class","");if((R=Ln(p)).length){for(;z=this[Te++];)if(ie=an(z),V=z.nodeType===1&&" "+rn(ie)+" "){for(de=0;ce=R[de++];)for(;-1<V.indexOf(" "+ce+" ");)V=V.replace(" "+ce+" "," ");ie!==(ye=rn(V))&&z.setAttribute("class",ye)}}return this},toggleClass:function(p,R){var z=typeof p,V=z==="string"||Array.isArray(p);return typeof R=="boolean"&&V?R?this.addClass(p):this.removeClass(p):x(p)?this.each(function(ie){u(this).toggleClass(p.call(this,ie,an(this),R),R)}):this.each(function(){var ie,ce,de,ye;if(V)for(ce=0,de=u(this),ye=Ln(p);ie=ye[ce++];)de.hasClass(ie)?de.removeClass(ie):de.addClass(ie);else p!==void 0&&z!=="boolean"||((ie=an(this))&&se.set(this,"__className__",ie),this.setAttribute&&this.setAttribute("class",ie||p===!1?"":se.get(this,"__className__")||""))})},hasClass:function(p){var R,z,V=0;for(R=" "+p+" ";z=this[V++];)if(z.nodeType===1&&-1<(" "+rn(an(z))+" ").indexOf(R))return!0;return!1}});var $i=/\r/g;u.fn.extend({val:function(p){var R,z,V,ie=this[0];return arguments.length?(V=x(p),this.each(function(ce){var de;this.nodeType===1&&((de=V?p.call(this,ce,u(this).val()):p)==null?de="":typeof de=="number"?de+="":Array.isArray(de)&&(de=u.map(de,function(ye){return ye==null?"":ye+""})),(R=u.valHooks[this.type]||u.valHooks[this.nodeName.toLowerCase()])&&"set"in R&&R.set(this,de,"value")!==void 0||(this.value=de))})):ie?(R=u.valHooks[ie.type]||u.valHooks[ie.nodeName.toLowerCase()])&&"get"in R&&(z=R.get(ie,"value"))!==void 0?z:typeof(z=ie.value)=="string"?z.replace($i,""):z??"":void 0}}),u.extend({valHooks:{option:{get:function(p){var R=u.find.attr(p,"value");return R??rn(u.text(p))}},select:{get:function(p){var R,z,V,ie=p.options,ce=p.selectedIndex,de=p.type==="select-one",ye=de?null:[],Te=de?ce+1:ie.length;for(V=ce<0?Te:de?ce:0;V<Te;V++)if(((z=ie[V]).selected||V===ce)&&!z.disabled&&(!z.parentNode.disabled||!S(z.parentNode,"optgroup"))){if(R=u(z).val(),de)return R;ye.push(R)}return ye},set:function(p,R){for(var z,V,ie=p.options,ce=u.makeArray(R),de=ie.length;de--;)((V=ie[de]).selected=-1<u.inArray(u.valHooks.option.get(V),ce))&&(z=!0);return z||(p.selectedIndex=-1),ce}}}}),u.each(["radio","checkbox"],function(){u.valHooks[this]={set:function(p,R){if(Array.isArray(R))return p.checked=-1<u.inArray(u(p).val(),R)}},g.checkOn||(u.valHooks[this].get=function(p){return p.getAttribute("value")===null?"on":p.value})}),g.focusin="onfocusin"in e;var ai=/^(?:focusinfocus|focusoutblur)$/,oi=function(p){p.stopPropagation()};u.extend(u.event,{trigger:function(p,R,z,V){var ie,ce,de,ye,Te,$e,De,Be,Pe=[z||t],Le=h.call(p,"type")?p.type:p,et=h.call(p,"namespace")?p.namespace.split("."):[];if(ce=Be=de=z=z||t,z.nodeType!==3&&z.nodeType!==8&&!ai.test(Le+u.event.triggered)&&(-1<Le.indexOf(".")&&(Le=(et=Le.split(".")).shift(),et.sort()),Te=Le.indexOf(":")<0&&"on"+Le,(p=p[u.expando]?p:new u.Event(Le,typeof p=="object"&&p)).isTrigger=V?2:3,p.namespace=et.join("."),p.rnamespace=p.namespace?new RegExp("(^|\\.)"+et.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,p.result=void 0,p.target||(p.target=z),R=R==null?[p]:u.makeArray(R,[p]),De=u.event.special[Le]||{},V||!De.trigger||De.trigger.apply(z,R)!==!1)){if(!V&&!De.noBubble&&!b(z)){for(ye=De.delegateType||Le,ai.test(ye+Le)||(ce=ce.parentNode);ce;ce=ce.parentNode)Pe.push(ce),de=ce;de===(z.ownerDocument||t)&&Pe.push(de.defaultView||de.parentWindow||e)}for(ie=0;(ce=Pe[ie++])&&!p.isPropagationStopped();)Be=ce,p.type=1<ie?ye:De.bindType||Le,($e=(se.get(ce,"events")||{})[p.type]&&se.get(ce,"handle"))&&$e.apply(ce,R),($e=Te&&ce[Te])&&$e.apply&&te(ce)&&(p.result=$e.apply(ce,R),p.result===!1&&p.preventDefault());return p.type=Le,V||p.isDefaultPrevented()||De._default&&De._default.apply(Pe.pop(),R)!==!1||!te(z)||Te&&x(z[Le])&&!b(z)&&((de=z[Te])&&(z[Te]=null),u.event.triggered=Le,p.isPropagationStopped()&&Be.addEventListener(Le,oi),z[Le](),p.isPropagationStopped()&&Be.removeEventListener(Le,oi),u.event.triggered=void 0,de&&(z[Te]=de)),p.result}},simulate:function(p,R,z){var V=u.extend(new u.Event,z,{type:p,isSimulated:!0});u.event.trigger(V,null,R)}}),u.fn.extend({trigger:function(p,R){return this.each(function(){u.event.trigger(p,R,this)})},triggerHandler:function(p,R){var z=this[0];if(z)return u.event.trigger(p,R,z,!0)}}),g.focusin||u.each({focus:"focusin",blur:"focusout"},function(p,R){var z=function(V){u.event.simulate(R,V.target,u.event.fix(V))};u.event.special[R]={setup:function(){var V=this.ownerDocument||this,ie=se.access(V,R);ie||V.addEventListener(p,z,!0),se.access(V,R,(ie||0)+1)},teardown:function(){var V=this.ownerDocument||this,ie=se.access(V,R)-1;ie?se.access(V,R,ie):(V.removeEventListener(p,z,!0),se.remove(V,R))}}});var mn=e.location,si=Date.now(),In=/\?/;u.parseXML=function(p){var R;if(!p||typeof p!="string")return null;try{R=new e.DOMParser().parseFromString(p,"text/xml")}catch{R=void 0}return R&&!R.getElementsByTagName("parsererror").length||u.error("Invalid XML: "+p),R};var Mi=/\[\]$/,li=/\r?\n/g,Ri=/^(?:submit|button|image|reset|file)$/i,Pi=/^(?:input|select|textarea|keygen)/i;function Dn(p,R,z,V){var ie;if(Array.isArray(R))u.each(R,function(ce,de){z||Mi.test(p)?V(p,de):Dn(p+"["+(typeof de=="object"&&de!=null?ce:"")+"]",de,z,V)});else if(z||L(R)!=="object")V(p,R);else for(ie in R)Dn(p+"["+ie+"]",R[ie],z,V)}u.param=function(p,R){var z,V=[],ie=function(ce,de){var ye=x(de)?de():de;V[V.length]=encodeURIComponent(ce)+"="+encodeURIComponent(ye??"")};if(p==null)return"";if(Array.isArray(p)||p.jquery&&!u.isPlainObject(p))u.each(p,function(){ie(this.name,this.value)});else for(z in p)Dn(z,p[z],R,ie);return V.join("&")},u.fn.extend({serialize:function(){return u.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var p=u.prop(this,"elements");return p?u.makeArray(p):this}).filter(function(){var p=this.type;return this.name&&!u(this).is(":disabled")&&Pi.test(this.nodeName)&&!Ri.test(p)&&(this.checked||!Je.test(p))}).map(function(p,R){var z=u(this).val();return z==null?null:Array.isArray(z)?u.map(z,function(V){return{name:R.name,value:V.replace(li,`\r
`)}}):{name:R.name,value:z.replace(li,`\r
`)}}).get()}});var Li=/%20/g,Ii=/#.*$/,Di=/([?&])_=[^&]*/,Ni=/^(.*?):[ \t]*([^\r\n]*)$/gm,Fi=/^(?:GET|HEAD)$/,Oi=/^\/\//,ci={},Nn={},ui="*/".concat("*"),Fn=t.createElement("a");function di(p){return function(R,z){typeof R!="string"&&(z=R,R="*");var V,ie=0,ce=R.toLowerCase().match(D)||[];if(x(z))for(;V=ce[ie++];)V[0]==="+"?(V=V.slice(1)||"*",(p[V]=p[V]||[]).unshift(z)):(p[V]=p[V]||[]).push(z)}}function hi(p,R,z,V){var ie={},ce=p===Nn;function de(ye){var Te;return ie[ye]=!0,u.each(p[ye]||[],function($e,De){var Be=De(R,z,V);return typeof Be!="string"||ce||ie[Be]?ce?!(Te=Be):void 0:(R.dataTypes.unshift(Be),de(Be),!1)}),Te}return de(R.dataTypes[0])||!ie["*"]&&de("*")}function On(p,R){var z,V,ie=u.ajaxSettings.flatOptions||{};for(z in R)R[z]!==void 0&&((ie[z]?p:V||(V={}))[z]=R[z]);return V&&u.extend(!0,p,V),p}Fn.href=mn.href,u.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:mn.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(mn.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ui,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":u.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(p,R){return R?On(On(p,u.ajaxSettings),R):On(u.ajaxSettings,p)},ajaxPrefilter:di(ci),ajaxTransport:di(Nn),ajax:function(p,R){typeof p=="object"&&(R=p,p=void 0),R=R||{};var z,V,ie,ce,de,ye,Te,$e,De,Be,Pe=u.ajaxSetup({},R),Le=Pe.context||Pe,et=Pe.context&&(Le.nodeType||Le.jquery)?u(Le):u.event,rt=u.Deferred(),tt=u.Callbacks("once memory"),yt=Pe.statusCode||{},kt={},Ft={},_t="canceled",lt={readyState:0,getResponseHeader:function(pt){var xt;if(Te){if(!ce)for(ce={};xt=Ni.exec(ie);)ce[xt[1].toLowerCase()+" "]=(ce[xt[1].toLowerCase()+" "]||[]).concat(xt[2]);xt=ce[pt.toLowerCase()+" "]}return xt==null?null:xt.join(", ")},getAllResponseHeaders:function(){return Te?ie:null},setRequestHeader:function(pt,xt){return Te==null&&(pt=Ft[pt.toLowerCase()]=Ft[pt.toLowerCase()]||pt,kt[pt]=xt),this},overrideMimeType:function(pt){return Te==null&&(Pe.mimeType=pt),this},statusCode:function(pt){var xt;if(pt)if(Te)lt.always(pt[lt.status]);else for(xt in pt)yt[xt]=[yt[xt],pt[xt]];return this},abort:function(pt){var xt=pt||_t;return z&&z.abort(xt),Dt(0,xt),this}};if(rt.promise(lt),Pe.url=((p||Pe.url||mn.href)+"").replace(Oi,mn.protocol+"//"),Pe.type=R.method||R.type||Pe.method||Pe.type,Pe.dataTypes=(Pe.dataType||"*").toLowerCase().match(D)||[""],Pe.crossDomain==null){ye=t.createElement("a");try{ye.href=Pe.url,ye.href=ye.href,Pe.crossDomain=Fn.protocol+"//"+Fn.host!=ye.protocol+"//"+ye.host}catch{Pe.crossDomain=!0}}if(Pe.data&&Pe.processData&&typeof Pe.data!="string"&&(Pe.data=u.param(Pe.data,Pe.traditional)),hi(ci,Pe,R,lt),Te)return lt;for(De in($e=u.event&&Pe.global)&&u.active++==0&&u.event.trigger("ajaxStart"),Pe.type=Pe.type.toUpperCase(),Pe.hasContent=!Fi.test(Pe.type),V=Pe.url.replace(Ii,""),Pe.hasContent?Pe.data&&Pe.processData&&(Pe.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(Pe.data=Pe.data.replace(Li,"+")):(Be=Pe.url.slice(V.length),Pe.data&&(Pe.processData||typeof Pe.data=="string")&&(V+=(In.test(V)?"&":"?")+Pe.data,delete Pe.data),Pe.cache===!1&&(V=V.replace(Di,"$1"),Be=(In.test(V)?"&":"?")+"_="+si+++Be),Pe.url=V+Be),Pe.ifModified&&(u.lastModified[V]&&lt.setRequestHeader("If-Modified-Since",u.lastModified[V]),u.etag[V]&&lt.setRequestHeader("If-None-Match",u.etag[V])),(Pe.data&&Pe.hasContent&&Pe.contentType!==!1||R.contentType)&&lt.setRequestHeader("Content-Type",Pe.contentType),lt.setRequestHeader("Accept",Pe.dataTypes[0]&&Pe.accepts[Pe.dataTypes[0]]?Pe.accepts[Pe.dataTypes[0]]+(Pe.dataTypes[0]!=="*"?", "+ui+"; q=0.01":""):Pe.accepts["*"]),Pe.headers)lt.setRequestHeader(De,Pe.headers[De]);if(Pe.beforeSend&&(Pe.beforeSend.call(Le,lt,Pe)===!1||Te))return lt.abort();if(_t="abort",tt.add(Pe.complete),lt.done(Pe.success),lt.fail(Pe.error),z=hi(Nn,Pe,R,lt)){if(lt.readyState=1,$e&&et.trigger("ajaxSend",[lt,Pe]),Te)return lt;Pe.async&&0<Pe.timeout&&(de=e.setTimeout(function(){lt.abort("timeout")},Pe.timeout));try{Te=!1,z.send(kt,Dt)}catch(pt){if(Te)throw pt;Dt(-1,pt)}}else Dt(-1,"No Transport");function Dt(pt,xt,vn,En){var jt,on,dn,Nt,hn,Ht=xt;Te||(Te=!0,de&&e.clearTimeout(de),z=void 0,ie=En||"",lt.readyState=0<pt?4:0,jt=200<=pt&&pt<300||pt===304,vn&&(Nt=function(Et,Ot,Ut){for(var Xt,dt,mt,$t,Bt=Et.contents,Ct=Et.dataTypes;Ct[0]==="*";)Ct.shift(),Xt===void 0&&(Xt=Et.mimeType||Ot.getResponseHeader("Content-Type"));if(Xt){for(dt in Bt)if(Bt[dt]&&Bt[dt].test(Xt)){Ct.unshift(dt);break}}if(Ct[0]in Ut)mt=Ct[0];else{for(dt in Ut){if(!Ct[0]||Et.converters[dt+" "+Ct[0]]){mt=dt;break}$t||($t=dt)}mt=mt||$t}if(mt)return mt!==Ct[0]&&Ct.unshift(mt),Ut[mt]}(Pe,lt,vn)),Nt=function(Et,Ot,Ut,Xt){var dt,mt,$t,Bt,Ct,zt={},fn=Et.dataTypes.slice();if(fn[1])for($t in Et.converters)zt[$t.toLowerCase()]=Et.converters[$t];for(mt=fn.shift();mt;)if(Et.responseFields[mt]&&(Ut[Et.responseFields[mt]]=Ot),!Ct&&Xt&&Et.dataFilter&&(Ot=Et.dataFilter(Ot,Et.dataType)),Ct=mt,mt=fn.shift()){if(mt==="*")mt=Ct;else if(Ct!=="*"&&Ct!==mt){if(!($t=zt[Ct+" "+mt]||zt["* "+mt])){for(dt in zt)if((Bt=dt.split(" "))[1]===mt&&($t=zt[Ct+" "+Bt[0]]||zt["* "+Bt[0]])){$t===!0?$t=zt[dt]:zt[dt]!==!0&&(mt=Bt[0],fn.unshift(Bt[1]));break}}if($t!==!0)if($t&&Et.throws)Ot=$t(Ot);else try{Ot=$t(Ot)}catch(Bn){return{state:"parsererror",error:$t?Bn:"No conversion from "+Ct+" to "+mt}}}}return{state:"success",data:Ot}}(Pe,Nt,lt,jt),jt?(Pe.ifModified&&((hn=lt.getResponseHeader("Last-Modified"))&&(u.lastModified[V]=hn),(hn=lt.getResponseHeader("etag"))&&(u.etag[V]=hn)),pt===204||Pe.type==="HEAD"?Ht="nocontent":pt===304?Ht="notmodified":(Ht=Nt.state,on=Nt.data,jt=!(dn=Nt.error))):(dn=Ht,!pt&&Ht||(Ht="error",pt<0&&(pt=0))),lt.status=pt,lt.statusText=(xt||Ht)+"",jt?rt.resolveWith(Le,[on,Ht,lt]):rt.rejectWith(Le,[lt,Ht,dn]),lt.statusCode(yt),yt=void 0,$e&&et.trigger(jt?"ajaxSuccess":"ajaxError",[lt,Pe,jt?on:dn]),tt.fireWith(Le,[lt,Ht]),$e&&(et.trigger("ajaxComplete",[lt,Pe]),--u.active||u.event.trigger("ajaxStop")))}return lt},getJSON:function(p,R,z){return u.get(p,R,z,"json")},getScript:function(p,R){return u.get(p,void 0,R,"script")}}),u.each(["get","post"],function(p,R){u[R]=function(z,V,ie,ce){return x(V)&&(ce=ce||ie,ie=V,V=void 0),u.ajax(u.extend({url:z,type:R,dataType:ce,data:V,success:ie},u.isPlainObject(z)&&z))}}),u._evalUrl=function(p,R){return u.ajax({url:p,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(z){u.globalEval(z,R)}})},u.fn.extend({wrapAll:function(p){var R;return this[0]&&(x(p)&&(p=p.call(this[0])),R=u(p,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&R.insertBefore(this[0]),R.map(function(){for(var z=this;z.firstElementChild;)z=z.firstElementChild;return z}).append(this)),this},wrapInner:function(p){return x(p)?this.each(function(R){u(this).wrapInner(p.call(this,R))}):this.each(function(){var R=u(this),z=R.contents();z.length?z.wrapAll(p):R.append(p)})},wrap:function(p){var R=x(p);return this.each(function(z){u(this).wrapAll(R?p.call(this,z):p)})},unwrap:function(p){return this.parent(p).not("body").each(function(){u(this).replaceWith(this.childNodes)}),this}}),u.expr.pseudos.hidden=function(p){return!u.expr.pseudos.visible(p)},u.expr.pseudos.visible=function(p){return!!(p.offsetWidth||p.offsetHeight||p.getClientRects().length)},u.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch{}};var Ui={0:200,1223:204},_n=u.ajaxSettings.xhr();g.cors=!!_n&&"withCredentials"in _n,g.ajax=_n=!!_n,u.ajaxTransport(function(p){var R,z;if(g.cors||_n&&!p.crossDomain)return{send:function(V,ie){var ce,de=p.xhr();if(de.open(p.type,p.url,p.async,p.username,p.password),p.xhrFields)for(ce in p.xhrFields)de[ce]=p.xhrFields[ce];for(ce in p.mimeType&&de.overrideMimeType&&de.overrideMimeType(p.mimeType),p.crossDomain||V["X-Requested-With"]||(V["X-Requested-With"]="XMLHttpRequest"),V)de.setRequestHeader(ce,V[ce]);R=function(ye){return function(){R&&(R=z=de.onload=de.onerror=de.onabort=de.ontimeout=de.onreadystatechange=null,ye==="abort"?de.abort():ye==="error"?typeof de.status!="number"?ie(0,"error"):ie(de.status,de.statusText):ie(Ui[de.status]||de.status,de.statusText,(de.responseType||"text")!=="text"||typeof de.responseText!="string"?{binary:de.response}:{text:de.responseText},de.getAllResponseHeaders()))}},de.onload=R(),z=de.onerror=de.ontimeout=R("error"),de.onabort!==void 0?de.onabort=z:de.onreadystatechange=function(){de.readyState===4&&e.setTimeout(function(){R&&z()})},R=R("abort");try{de.send(p.hasContent&&p.data||null)}catch(ye){if(R)throw ye}},abort:function(){R&&R()}}}),u.ajaxPrefilter(function(p){p.crossDomain&&(p.contents.script=!1)}),u.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(p){return u.globalEval(p),p}}}),u.ajaxPrefilter("script",function(p){p.cache===void 0&&(p.cache=!1),p.crossDomain&&(p.type="GET")}),u.ajaxTransport("script",function(p){var R,z;if(p.crossDomain||p.scriptAttrs)return{send:function(V,ie){R=u("<script>").attr(p.scriptAttrs||{}).prop({charset:p.scriptCharset,src:p.url}).on("load error",z=function(ce){R.remove(),z=null,ce&&ie(ce.type==="error"?404:200,ce.type)}),t.head.appendChild(R[0])},abort:function(){z&&z()}}});var fi,pi=[],Un=/(=)\?(?=&|$)|\?\?/;u.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var p=pi.pop()||u.expando+"_"+si++;return this[p]=!0,p}}),u.ajaxPrefilter("json jsonp",function(p,R,z){var V,ie,ce,de=p.jsonp!==!1&&(Un.test(p.url)?"url":typeof p.data=="string"&&(p.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Un.test(p.data)&&"data");if(de||p.dataTypes[0]==="jsonp")return V=p.jsonpCallback=x(p.jsonpCallback)?p.jsonpCallback():p.jsonpCallback,de?p[de]=p[de].replace(Un,"$1"+V):p.jsonp!==!1&&(p.url+=(In.test(p.url)?"&":"?")+p.jsonp+"="+V),p.converters["script json"]=function(){return ce||u.error(V+" was not called"),ce[0]},p.dataTypes[0]="json",ie=e[V],e[V]=function(){ce=arguments},z.always(function(){ie===void 0?u(e).removeProp(V):e[V]=ie,p[V]&&(p.jsonpCallback=R.jsonpCallback,pi.push(V)),ce&&x(ie)&&ie(ce[0]),ce=ie=void 0}),"script"}),g.createHTMLDocument=((fi=t.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",fi.childNodes.length===2),u.parseHTML=function(p,R,z){return typeof p!="string"?[]:(typeof R=="boolean"&&(z=R,R=!1),R||(g.createHTMLDocument?((V=(R=t.implementation.createHTMLDocument("")).createElement("base")).href=t.location.href,R.head.appendChild(V)):R=t),ce=!z&&[],(ie=F.exec(p))?[R.createElement(ie[1])]:(ie=ge([p],R,ce),ce&&ce.length&&u(ce).remove(),u.merge([],ie.childNodes)));var V,ie,ce},u.fn.load=function(p,R,z){var V,ie,ce,de=this,ye=p.indexOf(" ");return-1<ye&&(V=rn(p.slice(ye)),p=p.slice(0,ye)),x(R)?(z=R,R=void 0):R&&typeof R=="object"&&(ie="POST"),0<de.length&&u.ajax({url:p,type:ie||"GET",dataType:"html",data:R}).done(function(Te){ce=arguments,de.html(V?u("<div>").append(u.parseHTML(Te)).find(V):Te)}).always(z&&function(Te,$e){de.each(function(){z.apply(this,ce||[Te.responseText,$e,Te])})}),this},u.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(p,R){u.fn[R]=function(z){return this.on(R,z)}}),u.expr.pseudos.animated=function(p){return u.grep(u.timers,function(R){return p===R.elem}).length},u.offset={setOffset:function(p,R,z){var V,ie,ce,de,ye,Te,$e=u.css(p,"position"),De=u(p),Be={};$e==="static"&&(p.style.position="relative"),ye=De.offset(),ce=u.css(p,"top"),Te=u.css(p,"left"),($e==="absolute"||$e==="fixed")&&-1<(ce+Te).indexOf("auto")?(de=(V=De.position()).top,ie=V.left):(de=parseFloat(ce)||0,ie=parseFloat(Te)||0),x(R)&&(R=R.call(p,z,u.extend({},ye))),R.top!=null&&(Be.top=R.top-ye.top+de),R.left!=null&&(Be.left=R.left-ye.left+ie),"using"in R?R.using.call(p,Be):De.css(Be)}},u.fn.extend({offset:function(p){if(arguments.length)return p===void 0?this:this.each(function(ie){u.offset.setOffset(this,p,ie)});var R,z,V=this[0];return V?V.getClientRects().length?(R=V.getBoundingClientRect(),z=V.ownerDocument.defaultView,{top:R.top+z.pageYOffset,left:R.left+z.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var p,R,z,V=this[0],ie={top:0,left:0};if(u.css(V,"position")==="fixed")R=V.getBoundingClientRect();else{for(R=this.offset(),z=V.ownerDocument,p=V.offsetParent||z.documentElement;p&&(p===z.body||p===z.documentElement)&&u.css(p,"position")==="static";)p=p.parentNode;p&&p!==V&&p.nodeType===1&&((ie=u(p).offset()).top+=u.css(p,"borderTopWidth",!0),ie.left+=u.css(p,"borderLeftWidth",!0))}return{top:R.top-ie.top-u.css(V,"marginTop",!0),left:R.left-ie.left-u.css(V,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var p=this.offsetParent;p&&u.css(p,"position")==="static";)p=p.offsetParent;return p||_e})}}),u.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(p,R){var z=R==="pageYOffset";u.fn[p]=function(V){return pe(this,function(ie,ce,de){var ye;if(b(ie)?ye=ie:ie.nodeType===9&&(ye=ie.defaultView),de===void 0)return ye?ye[R]:ie[ce];ye?ye.scrollTo(z?ye.pageXOffset:de,z?de:ye.pageYOffset):ie[ce]=de},p,V,arguments.length)}}),u.each(["top","left"],function(p,R){u.cssHooks[R]=Vn(g.pixelPosition,function(z,V){if(V)return V=pn(z,R),Gt.test(V)?u(z).position()[R]+"px":V})}),u.each({Height:"height",Width:"width"},function(p,R){u.each({padding:"inner"+p,content:R,"":"outer"+p},function(z,V){u.fn[V]=function(ie,ce){var de=arguments.length&&(z||typeof ie!="boolean"),ye=z||(ie===!0||ce===!0?"margin":"border");return pe(this,function(Te,$e,De){var Be;return b(Te)?V.indexOf("outer")===0?Te["inner"+p]:Te.document.documentElement["client"+p]:Te.nodeType===9?(Be=Te.documentElement,Math.max(Te.body["scroll"+p],Be["scroll"+p],Te.body["offset"+p],Be["offset"+p],Be["client"+p])):De===void 0?u.css(Te,$e,ye):u.style(Te,$e,De,ye)},R,de?ie:void 0,de)}})}),u.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(p,R){u.fn[R]=function(z,V){return 0<arguments.length?this.on(R,null,z,V):this.trigger(R)}}),u.fn.extend({hover:function(p,R){return this.mouseenter(p).mouseleave(R||p)}}),u.fn.extend({bind:function(p,R,z){return this.on(p,null,R,z)},unbind:function(p,R){return this.off(p,null,R)},delegate:function(p,R,z,V){return this.on(R,p,z,V)},undelegate:function(p,R,z){return arguments.length===1?this.off(p,"**"):this.off(R,p||"**",z)}}),u.proxy=function(p,R){var z,V,ie;if(typeof R=="string"&&(z=p[R],R=p,p=z),x(p))return V=a.call(arguments,2),(ie=function(){return p.apply(R||this,V.concat(a.call(arguments)))}).guid=p.guid=p.guid||u.guid++,ie},u.holdReady=function(p){p?u.readyWait++:u.ready(!0)},u.isArray=Array.isArray,u.parseJSON=JSON.parse,u.nodeName=S,u.isFunction=x,u.isWindow=b,u.camelCase=N,u.type=L,u.now=Date.now,u.isNumeric=function(p){var R=u.type(p);return(R==="number"||R==="string")&&!isNaN(p-parseFloat(p))},typeof define=="function"&&define.amd&&define("jquery",[],function(){return u});var Bi=e.jQuery,zi=e.$;return u.noConflict=function(p){return e.$===u&&(e.$=zi),p&&e.jQuery===u&&(e.jQuery=Bi),u},n||(e.jQuery=e.$=u),u});(function(e){if(typeof exports=="object"&&typeof module<"u")module.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var n;typeof window<"u"?n=window:typeof global<"u"?n=global:typeof self<"u"?n=self:n=this,n.GIF=e()}})(function(){return function(){function e(n,o,t){function l(s,c){if(!o[s]){if(!n[s]){var r=typeof require=="function"&&require;if(!c&&r)return r(s,!0);if(a)return a(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var h=o[s]={exports:{}};n[s][0].call(h.exports,function(m){var f=n[s][1][m];return l(f||m)},h,h.exports,e,n,o,t)}return o[s].exports}for(var a=typeof require=="function"&&require,i=0;i<t.length;i++)l(t[i]);return l}return e}()({1:[function(e,n,o){function t(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}n.exports=t,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._maxListeners=void 0,t.defaultMaxListeners=10,t.prototype.setMaxListeners=function(c){if(!a(c)||c<0||isNaN(c))throw TypeError("n must be a positive number");return this._maxListeners=c,this},t.prototype.emit=function(c){var r,d,h,m,f,g;if(this._events||(this._events={}),c==="error"&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(r=arguments[1],r instanceof Error)throw r;var x=new Error('Uncaught, unspecified "error" event. ('+r+")");throw x.context=r,x}if(d=this._events[c],s(d))return!1;if(l(d))switch(arguments.length){case 1:d.call(this);break;case 2:d.call(this,arguments[1]);break;case 3:d.call(this,arguments[1],arguments[2]);break;default:m=Array.prototype.slice.call(arguments,1),d.apply(this,m)}else if(i(d))for(m=Array.prototype.slice.call(arguments,1),g=d.slice(),h=g.length,f=0;f<h;f++)g[f].apply(this,m);return!0},t.prototype.addListener=function(c,r){var d;if(!l(r))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",c,l(r.listener)?r.listener:r),this._events[c]?i(this._events[c])?this._events[c].push(r):this._events[c]=[this._events[c],r]:this._events[c]=r,i(this._events[c])&&!this._events[c].warned&&(s(this._maxListeners)?d=t.defaultMaxListeners:d=this._maxListeners,d&&d>0&&this._events[c].length>d&&(this._events[c].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[c].length),typeof console.trace=="function"&&console.trace())),this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(c,r){if(!l(r))throw TypeError("listener must be a function");var d=!1;function h(){this.removeListener(c,h),d||(d=!0,r.apply(this,arguments))}return h.listener=r,this.on(c,h),this},t.prototype.removeListener=function(c,r){var d,h,m,f;if(!l(r))throw TypeError("listener must be a function");if(!this._events||!this._events[c])return this;if(d=this._events[c],m=d.length,h=-1,d===r||l(d.listener)&&d.listener===r)delete this._events[c],this._events.removeListener&&this.emit("removeListener",c,r);else if(i(d)){for(f=m;f-- >0;)if(d[f]===r||d[f].listener&&d[f].listener===r){h=f;break}if(h<0)return this;d.length===1?(d.length=0,delete this._events[c]):d.splice(h,1),this._events.removeListener&&this.emit("removeListener",c,r)}return this},t.prototype.removeAllListeners=function(c){var r,d;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[c]&&delete this._events[c],this;if(arguments.length===0){for(r in this._events)r!=="removeListener"&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events={},this}if(d=this._events[c],l(d))this.removeListener(c,d);else if(d)for(;d.length;)this.removeListener(c,d[d.length-1]);return delete this._events[c],this},t.prototype.listeners=function(c){var r;return!this._events||!this._events[c]?r=[]:l(this._events[c])?r=[this._events[c]]:r=this._events[c].slice(),r},t.prototype.listenerCount=function(c){if(this._events){var r=this._events[c];if(l(r))return 1;if(r)return r.length}return 0},t.listenerCount=function(c,r){return c.listenerCount(r)};function l(c){return typeof c=="function"}function a(c){return typeof c=="number"}function i(c){return typeof c=="object"&&c!==null}function s(c){return c===void 0}},{}],2:[function(e,n,o){var t,l,a,i,s;s=navigator.userAgent.toLowerCase(),i=navigator.platform.toLowerCase(),t=s.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],a=t[1]==="ie"&&document.documentMode,l={name:t[1]==="version"?t[3]:t[1],version:a||parseFloat(t[1]==="opera"&&t[4]?t[4]:t[2]),platform:{name:s.match(/ip(?:ad|od|hone)/)?"ios":(s.match(/(?:webos|android)/)||i.match(/mac|win|linux/)||["other"])[0]}},l[l.name]=!0,l[l.name+parseInt(l.version,10)]=!0,l.platform[l.platform.name]=!0,n.exports=l},{}],3:[function(e,n,o){var t,l,a,i=function(d,h){for(var m in h)s.call(h,m)&&(d[m]=h[m]);function f(){this.constructor=d}return f.prototype=h.prototype,d.prototype=new f,d.__super__=h.prototype,d},s={}.hasOwnProperty,c=[].indexOf||function(d){for(var h=0,m=this.length;h<m;h++)if(h in this&&this[h]===d)return h;return-1},r=[].slice;t=e("events").EventEmitter,a=e("./browser.coffee"),l=function(d){var h,m;i(f,d),h={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},m={delay:500,copy:!1,dispose:-1};function f(g){var x,b,A;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(g);for(b in h)A=h[b],(x=this.options)[b]==null&&(x[b]=A)}return f.prototype.setOption=function(g,x){if(this.options[g]=x,this._canvas!=null&&(g==="width"||g==="height"))return this._canvas[g]=x},f.prototype.setOptions=function(g){var x,b,A;b=[];for(x in g)s.call(g,x)&&(A=g[x],b.push(this.setOption(x,A)));return b},f.prototype.addFrame=function(g,x){var b,A;x==null&&(x={}),b={},b.transparent=this.options.transparent;for(A in m)b[A]=x[A]||m[A];if(this.options.width==null&&this.setOption("width",g.width),this.options.height==null&&this.setOption("height",g.height),typeof ImageData<"u"&&ImageData!==null&&g instanceof ImageData)b.data=g.data;else if(typeof CanvasRenderingContext2D<"u"&&CanvasRenderingContext2D!==null&&g instanceof CanvasRenderingContext2D||typeof WebGLRenderingContext<"u"&&WebGLRenderingContext!==null&&g instanceof WebGLRenderingContext)x.copy?b.data=this.getContextData(g):b.context=g;else if(g.childNodes!=null)x.copy?b.data=this.getImageData(g):b.image=g;else throw new Error("Invalid image");return this.frames.push(b)},f.prototype.render=function(){var g,x,b;if(this.running)throw new Error("Already running");if(this.options.width==null||this.options.height==null)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=(function(){var A,M,L;for(L=[],A=0,M=this.frames.length;0<=M?A<M:A>M;0<=M?++A:--A)L.push(null);return L}).call(this),x=this.spawnWorkers(),this.options.globalPalette===!0)this.renderNextFrame();else for(g=0,b=x;0<=b?g<b:g>b;0<=b?++g:--g)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},f.prototype.abort=function(){for(var g;g=this.activeWorkers.shift(),g!=null;)this.log("killing active worker"),g.terminate();return this.running=!1,this.emit("abort")},f.prototype.spawnWorkers=function(){var g,x,b;return g=Math.min(this.options.workers,this.frames.length),(function(){b=[];for(var A=x=this.freeWorkers.length;x<=g?A<g:A>g;x<=g?A++:A--)b.push(A);return b}).apply(this).forEach(function(A){return function(M){var L;return A.log("spawning worker "+M),L=new Worker(A.options.workerScript),L.onmessage=function(C){return A.activeWorkers.splice(A.activeWorkers.indexOf(L),1),A.freeWorkers.push(L),A.frameFinished(C.data)},A.freeWorkers.push(L)}}(this)),g},f.prototype.frameFinished=function(g){var x,b;if(this.log("frame "+g.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[g.index]=g,this.options.globalPalette===!0&&(this.options.globalPalette=g.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(x=1,b=this.freeWorkers.length;1<=b?x<b:x>b;1<=b?++x:--x)this.renderNextFrame();return c.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},f.prototype.finishRendering=function(){var g,x,b,A,M,L,C,u,_,y,v,T,k,P,S,F;for(u=0,P=this.imageParts,M=0,_=P.length;M<_;M++)x=P[M],u+=(x.data.length-1)*x.pageSize+x.cursor;for(u+=x.pageSize-x.cursor,this.log("rendering finished - filesize "+Math.round(u/1e3)+"kb"),g=new Uint8Array(u),T=0,S=this.imageParts,L=0,y=S.length;L<y;L++)for(x=S[L],F=x.data,b=C=0,v=F.length;C<v;b=++C)k=F[b],g.set(k,T),b===x.data.length-1?T+=x.cursor:T+=x.pageSize;return A=new Blob([g],{type:"image/gif"}),this.emit("finished",A,g)},f.prototype.renderNextFrame=function(){var g,x,b;if(this.freeWorkers.length===0)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return g=this.frames[this.nextFrame++],b=this.freeWorkers.shift(),x=this.getTask(g),this.log("starting frame "+(x.index+1)+" of "+this.frames.length),this.activeWorkers.push(b),b.postMessage(x)},f.prototype.getContextData=function(g){return g.getImageData(0,0,this.options.width,this.options.height).data},f.prototype.getImageData=function(g){var x;return this._canvas==null&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),x=this._canvas.getContext("2d"),x.fillStyle=this.options.background,x.fillRect(0,0,this.options.width,this.options.height),x.drawImage(g,0,0),this.getContextData(x)},f.prototype.getTask=function(g){var x,b;if(x=this.frames.indexOf(g),b={index:x,last:x===this.frames.length-1,delay:g.delay,dispose:g.dispose,transparent:g.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:a.name==="chrome"},g.data!=null)b.data=g.data;else if(g.context!=null)b.data=this.getContextData(g.context);else if(g.image!=null)b.data=this.getImageData(g.image);else throw new Error("Invalid frame");return b},f.prototype.log=function(){var g;if(g=1<=arguments.length?r.call(arguments,0):[],!!this.options.debug)return console.log.apply(console,g)},f}(t),n.exports=l},{"./browser.coffee":2,events:1}]},{},[3])(3)});const UPNG={};UPNG.toRGBA8=function(e){var n=e.width,o=e.height;if(e.tabs.acTL==null)return[UPNG.toRGBA8.decodeImage(e.data,n,o,e).buffer];var t=[];e.frames[0].data==null&&(e.frames[0].data=e.data);for(var l=n*o*4,a=new Uint8Array(l),i=new Uint8Array(l),s=new Uint8Array(l),c=0;c<e.frames.length;c++){var r=e.frames[c],d=r.rect.x,h=r.rect.y,m=r.rect.width,f=r.rect.height,g=UPNG.toRGBA8.decodeImage(r.data,m,f,e);if(c!=0)for(var x=0;x<l;x++)s[x]=a[x];if(r.blend==0?UPNG._copyTile(g,m,f,a,n,o,d,h,0):r.blend==1&&UPNG._copyTile(g,m,f,a,n,o,d,h,1),t.push(a.buffer.slice(0)),r.dispose!=0){if(r.dispose==1)UPNG._copyTile(i,m,f,a,n,o,d,h,0);else if(r.dispose==2)for(var x=0;x<l;x++)a[x]=s[x]}}return t};UPNG.toRGBA8.decodeImage=function(e,n,o,t){var l=n*o,a=UPNG.decode._getBPP(t),i=Math.ceil(n*a/8),s=new Uint8Array(l*4),c=new Uint32Array(s.buffer),r=t.ctype,d=t.depth,h=UPNG._bin.readUshort;if(r==6){var m=l<<2;if(d==8)for(var f=0;f<m;f+=4)s[f]=e[f],s[f+1]=e[f+1],s[f+2]=e[f+2],s[f+3]=e[f+3];if(d==16)for(var f=0;f<m;f++)s[f]=e[f<<1]}else if(r==2){var g=t.tabs.tRNS;if(g==null){if(d==8)for(var f=0;f<l;f++){var x=f*3;c[f]=255<<24|e[x+2]<<16|e[x+1]<<8|e[x]}if(d==16)for(var f=0;f<l;f++){var x=f*6;c[f]=255<<24|e[x+4]<<16|e[x+2]<<8|e[x]}}else{var b=g[0],A=g[1],M=g[2];if(d==8)for(var f=0;f<l;f++){var L=f<<2,x=f*3;c[f]=255<<24|e[x+2]<<16|e[x+1]<<8|e[x],e[x]==b&&e[x+1]==A&&e[x+2]==M&&(s[L+3]=0)}if(d==16)for(var f=0;f<l;f++){var L=f<<2,x=f*6;c[f]=255<<24|e[x+4]<<16|e[x+2]<<8|e[x],h(e,x)==b&&h(e,x+2)==A&&h(e,x+4)==M&&(s[L+3]=0)}}}else if(r==3){var C=t.tabs.PLTE,u=t.tabs.tRNS,_=u?u.length:0;if(d==1)for(var y=0;y<o;y++)for(var v=y*i,T=y*n,f=0;f<n;f++){var L=T+f<<2,k=e[v+(f>>3)]>>7-((f&7)<<0)&1,P=3*k;s[L]=C[P],s[L+1]=C[P+1],s[L+2]=C[P+2],s[L+3]=k<_?u[k]:255}if(d==2)for(var y=0;y<o;y++)for(var v=y*i,T=y*n,f=0;f<n;f++){var L=T+f<<2,k=e[v+(f>>2)]>>6-((f&3)<<1)&3,P=3*k;s[L]=C[P],s[L+1]=C[P+1],s[L+2]=C[P+2],s[L+3]=k<_?u[k]:255}if(d==4)for(var y=0;y<o;y++)for(var v=y*i,T=y*n,f=0;f<n;f++){var L=T+f<<2,k=e[v+(f>>1)]>>4-((f&1)<<2)&15,P=3*k;s[L]=C[P],s[L+1]=C[P+1],s[L+2]=C[P+2],s[L+3]=k<_?u[k]:255}if(d==8)for(var f=0;f<l;f++){var L=f<<2,k=e[f],P=3*k;s[L]=C[P],s[L+1]=C[P+1],s[L+2]=C[P+2],s[L+3]=k<_?u[k]:255}}else if(r==4){if(d==8)for(var f=0;f<l;f++){var L=f<<2,S=f<<1,F=e[S];s[L]=F,s[L+1]=F,s[L+2]=F,s[L+3]=e[S+1]}if(d==16)for(var f=0;f<l;f++){var L=f<<2,S=f<<2,F=e[S];s[L]=F,s[L+1]=F,s[L+2]=F,s[L+3]=e[S+2]}}else if(r==0)for(var b=t.tabs.tRNS?t.tabs.tRNS:-1,y=0;y<o;y++){var K=y*i,Q=y*n;if(d==1)for(var Z=0;Z<n;Z++){var F=255*(e[K+(Z>>>3)]>>>7-(Z&7)&1),B=F==b*255?0:255;c[Q+Z]=B<<24|F<<16|F<<8|F}else if(d==2)for(var Z=0;Z<n;Z++){var F=85*(e[K+(Z>>>2)]>>>6-((Z&3)<<1)&3),B=F==b*85?0:255;c[Q+Z]=B<<24|F<<16|F<<8|F}else if(d==4)for(var Z=0;Z<n;Z++){var F=17*(e[K+(Z>>>1)]>>>4-((Z&1)<<2)&15),B=F==b*17?0:255;c[Q+Z]=B<<24|F<<16|F<<8|F}else if(d==8)for(var Z=0;Z<n;Z++){var F=e[K+Z],B=F==b?0:255;c[Q+Z]=B<<24|F<<16|F<<8|F}else if(d==16)for(var Z=0;Z<n;Z++){var F=e[K+(Z<<1)],B=h(e,K+(Z<<f))==b?0:255;c[Q+Z]=B<<24|F<<16|F<<8|F}}return s};UPNG.decode=function(e){for(var n=new Uint8Array(e),o=8,t=UPNG._bin,l=t.readUshort,a=t.readUint,i={tabs:{},frames:[]},s=new Uint8Array(n.length),c=0,r,d=0,h=[137,80,78,71,13,10,26,10],m=0;m<8;m++)if(n[m]!=h[m])throw"The input is not a PNG file!";for(;o<n.length;){var f=t.readUint(n,o);o+=4;var g=t.readASCII(n,o,4);if(o+=4,g=="IHDR")UPNG.decode._IHDR(n,o,i);else if(g=="CgBI")i.tabs[g]=n.slice(o,o+4);else if(g=="IDAT"){for(var m=0;m<f;m++)s[c+m]=n[o+m];c+=f}else if(g=="acTL")i.tabs[g]={num_frames:a(n,o),num_plays:a(n,o+4)},r=new Uint8Array(n.length);else if(g=="fcTL"){if(d!=0){var x=i.frames[i.frames.length-1];x.data=UPNG.decode._decompress(i,r.slice(0,d),x.rect.width,x.rect.height),d=0}var b={x:a(n,o+12),y:a(n,o+16),width:a(n,o+4),height:a(n,o+8)},A=l(n,o+22);A=l(n,o+20)/(A==0?100:A);var M={rect:b,delay:Math.round(A*1e3),dispose:n[o+24],blend:n[o+25]};i.frames.push(M)}else if(g=="fdAT"){for(var m=0;m<f-4;m++)r[d+m]=n[o+m+4];d+=f-4}else if(g=="pHYs")i.tabs[g]=[t.readUint(n,o),t.readUint(n,o+4),n[o+8]];else if(g=="cHRM"){i.tabs[g]=[];for(var m=0;m<8;m++)i.tabs[g].push(t.readUint(n,o+m*4))}else if(g=="tEXt"||g=="zTXt"){i.tabs[g]==null&&(i.tabs[g]={});var L=t.nextZero(n,o),C=t.readASCII(n,o,L-o),u,_=o+f-L-1;if(g=="tEXt")u=t.readASCII(n,L+1,_);else{var y=UPNG.decode._inflate(n.slice(L+2,L+2+_));u=t.readUTF8(y,0,y.length)}i.tabs[g][C]=u}else if(g=="iTXt"){i.tabs[g]==null&&(i.tabs[g]={});var L=0,v=o;L=t.nextZero(n,v);var C=t.readASCII(n,v,L-v);v=L+1;var T=n[v];n[v+1],v+=2,L=t.nextZero(n,v),t.readASCII(n,v,L-v),v=L+1,L=t.nextZero(n,v),t.readUTF8(n,v,L-v),v=L+1;var u,_=f-(v-o);if(T==0)u=t.readUTF8(n,v,_);else{var y=UPNG.decode._inflate(n.slice(v,v+_));u=t.readUTF8(y,0,y.length)}i.tabs[g][C]=u}else if(g=="PLTE")i.tabs[g]=t.readBytes(n,o,f);else if(g=="hIST"){var k=i.tabs.PLTE.length/3;i.tabs[g]=[];for(var m=0;m<k;m++)i.tabs[g].push(l(n,o+m*2))}else if(g=="tRNS")i.ctype==3?i.tabs[g]=t.readBytes(n,o,f):i.ctype==0?i.tabs[g]=l(n,o):i.ctype==2&&(i.tabs[g]=[l(n,o),l(n,o+2),l(n,o+4)]);else if(g=="gAMA")i.tabs[g]=t.readUint(n,o)/1e5;else if(g=="sRGB")i.tabs[g]=n[o];else if(g=="bKGD")i.ctype==0||i.ctype==4?i.tabs[g]=[l(n,o)]:i.ctype==2||i.ctype==6?i.tabs[g]=[l(n,o),l(n,o+2),l(n,o+4)]:i.ctype==3&&(i.tabs[g]=n[o]);else if(g=="IEND")break;o+=f,t.readUint(n,o),o+=4}if(d!=0){var x=i.frames[i.frames.length-1];x.data=UPNG.decode._decompress(i,r.slice(0,d),x.rect.width,x.rect.height),d=0}return i.data=UPNG.decode._decompress(i,s,i.width,i.height),delete i.compress,delete i.interlace,delete i.filter,i};UPNG.decode._decompress=function(e,n,o,t){var l=UPNG.decode._getBPP(e),a=Math.ceil(o*l/8),i=new Uint8Array((a+1+e.interlace)*t);return e.tabs.CgBI?n=UPNG.inflateRaw(n,i):n=UPNG.decode._inflate(n,i),e.interlace==0?n=UPNG.decode._filterZero(n,e,0,o,t):e.interlace==1&&(n=UPNG.decode._readInterlace(n,e)),n};UPNG.decode._inflate=function(e,n){var o=UPNG.inflateRaw(new Uint8Array(e.buffer,2,e.length-6),n);return o};UPNG.inflateRaw=function(){var e={};return e.H={},e.H.N=function(n,o){var t=Uint8Array,l=0,a=0,i=0,s=0,c=0,r=0,d=0,h=0,m=0,f,g;if(n[0]==3&&n[1]==0)return o||new t(0);var x=e.H,b=x.b,A=x.e,M=x.R,L=x.n,C=x.A,u=x.Z,_=x.m,y=o==null;for(y&&(o=new t(n.length>>>2<<5));l==0;){if(l=b(n,m,1),a=b(n,m+1,2),m+=3,a==0){m&7&&(m+=8-(m&7));var v=(m>>>3)+4,T=n[v-4]|n[v-3]<<8;y&&(o=e.H.W(o,h+T)),o.set(new t(n.buffer,n.byteOffset+v,T),h),m=v+T<<3,h+=T;continue}if(y&&(o=e.H.W(o,h+(1<<17))),a==1&&(f=_.J,g=_.h,r=511,d=31),a==2){i=A(n,m,5)+257,s=A(n,m+5,5)+1,c=A(n,m+10,4)+4,m+=14;for(var k=1,P=0;P<38;P+=2)_.Q[P]=0,_.Q[P+1]=0;for(var P=0;P<c;P++){var S=A(n,m+P*3,3);_.Q[(_.X[P]<<1)+1]=S,S>k&&(k=S)}m+=3*c,L(_.Q,k),C(_.Q,k,_.u),f=_.w,g=_.d,m=M(_.u,(1<<k)-1,i+s,n,m,_.v);var F=x.V(_.v,0,i,_.C);r=(1<<F)-1;var K=x.V(_.v,i,s,_.D);d=(1<<K)-1,L(_.C,F),C(_.C,F,f),L(_.D,K),C(_.D,K,g)}for(;;){var Q=f[u(n,m)&r];m+=Q&15;var Z=Q>>>4;if(!(Z>>>8))o[h++]=Z;else{if(Z==256)break;var B=h+Z-254;if(Z>264){var G=_.q[Z-257];B=h+(G>>>3)+A(n,m,G&7),m+=G&7}var w=g[u(n,m)&d];m+=w&15;var D=w>>>4,U=_.c[D],q=(U>>>4)+b(n,m,U&15);for(m+=U&15;h<B;)o[h]=o[h++-q],o[h]=o[h++-q],o[h]=o[h++-q],o[h]=o[h++-q];h=B}}}return o.length==h?o:o.slice(0,h)},e.H.W=function(n,o){var t=n.length;if(o<=t)return n;var l=new Uint8Array(t<<1);return l.set(n,0),l},e.H.R=function(n,o,t,l,a,i){for(var s=e.H.e,c=e.H.Z,r=0;r<t;){var d=n[c(l,a)&o];a+=d&15;var h=d>>>4;if(h<=15)i[r]=h,r++;else{var m=0,f=0;h==16?(f=3+s(l,a,2),a+=2,m=i[r-1]):h==17?(f=3+s(l,a,3),a+=3):h==18&&(f=11+s(l,a,7),a+=7);for(var g=r+f;r<g;)i[r]=m,r++}}return a},e.H.V=function(n,o,t,l){for(var a=0,i=0,s=l.length>>>1;i<t;){var c=n[i+o];l[i<<1]=0,l[(i<<1)+1]=c,c>a&&(a=c),i++}for(;i<s;)l[i<<1]=0,l[(i<<1)+1]=0,i++;return a},e.H.n=function(n,o){for(var t=e.H.m,l=n.length,a,i,s,c,r,d=t.j,c=0;c<=o;c++)d[c]=0;for(c=1;c<l;c+=2)d[n[c]]++;var h=t.K;for(a=0,d[0]=0,i=1;i<=o;i++)a=a+d[i-1]<<1,h[i]=a;for(s=0;s<l;s+=2)r=n[s+1],r!=0&&(n[s]=h[r],h[r]++)},e.H.A=function(n,o,t){for(var l=n.length,a=e.H.m,i=a.r,s=0;s<l;s+=2)if(n[s+1]!=0)for(var c=s>>1,r=n[s+1],d=c<<4|r,h=o-r,m=n[s]<<h,f=m+(1<<h);m!=f;){var g=i[m]>>>15-o;t[g]=d,m++}},e.H.l=function(n,o){for(var t=e.H.m.r,l=15-o,a=0;a<n.length;a+=2){var i=n[a]<<o-n[a+1];n[a]=t[i]>>>l}},e.H.M=function(n,o,t){t=t<<(o&7);var l=o>>>3;n[l]|=t,n[l+1]|=t>>>8},e.H.I=function(n,o,t){t=t<<(o&7);var l=o>>>3;n[l]|=t,n[l+1]|=t>>>8,n[l+2]|=t>>>16},e.H.e=function(n,o,t){return(n[o>>>3]|n[(o>>>3)+1]<<8)>>>(o&7)&(1<<t)-1},e.H.b=function(n,o,t){return(n[o>>>3]|n[(o>>>3)+1]<<8|n[(o>>>3)+2]<<16)>>>(o&7)&(1<<t)-1},e.H.Z=function(n,o){return(n[o>>>3]|n[(o>>>3)+1]<<8|n[(o>>>3)+2]<<16)>>>(o&7)},e.H.i=function(n,o){return(n[o>>>3]|n[(o>>>3)+1]<<8|n[(o>>>3)+2]<<16|n[(o>>>3)+3]<<24)>>>(o&7)},e.H.m=function(){var n=Uint16Array,o=Uint32Array;return{K:new n(16),j:new n(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new n(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new o(32),J:new n(512),_:[],h:new n(32),$:[],w:new n(32768),C:[],v:[],d:new n(32768),D:[],u:new n(512),Q:[],r:new n(32768),s:new o(286),Y:new o(30),a:new o(19),t:new o(15e3),k:new n(65536),g:new n(32768)}}(),function(){for(var n=e.H.m,o=32768,t=0;t<o;t++){var l=t;l=(l&2863311530)>>>1|(l&1431655765)<<1,l=(l&3435973836)>>>2|(l&858993459)<<2,l=(l&4042322160)>>>4|(l&252645135)<<4,l=(l&4278255360)>>>8|(l&16711935)<<8,n.r[t]=(l>>>16|l<<16)>>>17}function a(i,s,c){for(;s--!=0;)i.push(0,c)}for(var t=0;t<32;t++)n.q[t]=n.S[t]<<3|n.T[t],n.c[t]=n.p[t]<<4|n.z[t];a(n._,144,8),a(n._,112,9),a(n._,24,7),a(n._,8,8),e.H.n(n._,9),e.H.A(n._,9,n.J),e.H.l(n._,9),a(n.$,32,5),e.H.n(n.$,5),e.H.A(n.$,5,n.h),e.H.l(n.$,5),a(n.Q,19,0),a(n.C,286,0),a(n.D,30,0),a(n.v,320,0)}(),e.H.N}();UPNG.decode._readInterlace=function(e,n){for(var o=n.width,t=n.height,l=UPNG.decode._getBPP(n),a=l>>3,i=Math.ceil(o*l/8),s=new Uint8Array(t*i),c=0,r=[0,0,4,0,2,0,1],d=[0,4,0,2,0,1,0],h=[8,8,8,4,4,2,2],m=[8,8,4,4,2,2,1],f=0;f<7;){for(var g=h[f],x=m[f],b=0,A=0,M=r[f];M<t;)M+=g,A++;for(var L=d[f];L<o;)L+=x,b++;var C=Math.ceil(b*l/8);UPNG.decode._filterZero(e,n,c,b,A);for(var u=0,_=r[f];_<t;){for(var y=d[f],v=c+u*C<<3;y<o;){if(l==1){var T=e[v>>3];T=T>>7-(v&7)&1,s[_*i+(y>>3)]|=T<<7-((y&7)<<0)}if(l==2){var T=e[v>>3];T=T>>6-(v&7)&3,s[_*i+(y>>2)]|=T<<6-((y&3)<<1)}if(l==4){var T=e[v>>3];T=T>>4-(v&7)&15,s[_*i+(y>>1)]|=T<<4-((y&1)<<2)}if(l>=8)for(var k=_*i+y*a,P=0;P<a;P++)s[k+P]=e[(v>>3)+P];v+=l,y+=x}u++,_+=g}b*A!=0&&(c+=A*(1+C)),f=f+1}return s};UPNG.decode._getBPP=function(e){var n=[1,null,3,1,2,null,4][e.ctype];return n*e.depth};UPNG.decode._filterZero=function(e,n,o,t,l){var a=UPNG.decode._getBPP(n),i=Math.ceil(t*a/8),s=UPNG.decode._paeth;a=Math.ceil(a/8);var c=0,r=1,d=e[o],h=0;if(d>1&&(e[o]=[0,0,1][d-2]),d==3)for(h=a;h<i;h++)e[h+1]=e[h+1]+(e[h+1-a]>>>1)&255;for(var m=0;m<l;m++)if(c=o+m*i,r=c+m+1,d=e[r-1],h=0,d==0)for(;h<i;h++)e[c+h]=e[r+h];else if(d==1){for(;h<a;h++)e[c+h]=e[r+h];for(;h<i;h++)e[c+h]=e[r+h]+e[c+h-a]}else if(d==2)for(;h<i;h++)e[c+h]=e[r+h]+e[c+h-i];else if(d==3){for(;h<a;h++)e[c+h]=e[r+h]+(e[c+h-i]>>>1);for(;h<i;h++)e[c+h]=e[r+h]+(e[c+h-i]+e[c+h-a]>>>1)}else{for(;h<a;h++)e[c+h]=e[r+h]+s(0,e[c+h-i],0);for(;h<i;h++)e[c+h]=e[r+h]+s(e[c+h-a],e[c+h-i],e[c+h-a-i])}return e};UPNG.decode._paeth=function(e,n,o){var t=e+n-o,l=t-e,a=t-n,i=t-o;return l*l<=a*a&&l*l<=i*i?e:a*a<=i*i?n:o};UPNG.decode._IHDR=function(e,n,o){var t=UPNG._bin;o.width=t.readUint(e,n),n+=4,o.height=t.readUint(e,n),n+=4,o.depth=e[n],n++,o.ctype=e[n],n++,o.compress=e[n],n++,o.filter=e[n],n++,o.interlace=e[n],n++};UPNG._bin={nextZero:function(e,n){for(;e[n]!=0;)n++;return n},readUshort:function(e,n){return e[n]<<8|e[n+1]},writeUshort:function(e,n,o){e[n]=o>>8&255,e[n+1]=o&255},readUint:function(e,n){return e[n]*(256*256*256)+(e[n+1]<<16|e[n+2]<<8|e[n+3])},writeUint:function(e,n,o){e[n]=o>>24&255,e[n+1]=o>>16&255,e[n+2]=o>>8&255,e[n+3]=o&255},readASCII:function(e,n,o){for(var t="",l=0;l<o;l++)t+=String.fromCharCode(e[n+l]);return t},writeASCII:function(e,n,o){for(var t=0;t<o.length;t++)e[n+t]=o.charCodeAt(t)},readBytes:function(e,n,o){for(var t=[],l=0;l<o;l++)t.push(e[n+l]);return t},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,n,o){for(var t="",l,a=0;a<o;a++)t+="%"+UPNG._bin.pad(e[n+a].toString(16));try{l=decodeURIComponent(t)}catch{return UPNG._bin.readASCII(e,n,o)}return l}};UPNG._copyTile=function(e,n,o,t,l,a,i,s,c){for(var r=Math.min(n,l),d=Math.min(o,a),h=0,m=0,f=0;f<d;f++)for(var g=0;g<r;g++)if(i>=0&&s>=0?(h=f*n+g<<2,m=(s+f)*l+i+g<<2):(h=(-s+f)*n-i+g<<2,m=f*l+g<<2),c==0)t[m]=e[h],t[m+1]=e[h+1],t[m+2]=e[h+2],t[m+3]=e[h+3];else if(c==1){var x=e[h+3]*.00392156862745098,b=e[h]*x,A=e[h+1]*x,M=e[h+2]*x,L=t[m+3]*(1/255),C=t[m]*L,u=t[m+1]*L,_=t[m+2]*L,y=1-x,v=x+L*y,T=v==0?0:1/v;t[m+3]=255*v,t[m+0]=(b+C*y)*T,t[m+1]=(A+u*y)*T,t[m+2]=(M+_*y)*T}else if(c==2){var x=e[h+3],b=e[h],A=e[h+1],M=e[h+2],L=t[m+3],C=t[m],u=t[m+1],_=t[m+2];x==L&&b==C&&A==u&&M==_?(t[m]=0,t[m+1]=0,t[m+2]=0,t[m+3]=0):(t[m]=b,t[m+1]=A,t[m+2]=M,t[m+3]=x)}else if(c==3){var x=e[h+3],b=e[h],A=e[h+1],M=e[h+2],L=t[m+3],C=t[m],u=t[m+1],_=t[m+2];if(x==L&&b==C&&A==u&&M==_)continue;if(x<220&&L>20)return!1}return!0};UPNG.encode=function(e,n,o,t,l,a,i){t==null&&(t=0),i==null&&(i=!1);var s=UPNG.encode.compress(e,n,o,t,[!1,!1,!1,0,i]);return UPNG.encode.compressPNG(s,-1),UPNG.encode._main(s,n,o,l,a)};UPNG.encodeLL=function(e,n,o,t,l,a,i,s){for(var c={ctype:0+(t==1?0:2)+(l==0?0:4),depth:a,frames:[]},r=(t+l)*a,d=r*n,h=0;h<e.length;h++)c.frames.push({rect:{x:0,y:0,width:n,height:o},img:new Uint8Array(e[h]),blend:0,dispose:1,bpp:Math.ceil(r/8),bpl:Math.ceil(d/8)});UPNG.encode.compressPNG(c,0,!0);var m=UPNG.encode._main(c,n,o,i,s);return m};UPNG.encode._main=function(e,n,o,t,l){l==null&&(l={});var a=UPNG.crc.crc,i=UPNG._bin.writeUint,s=UPNG._bin.writeUshort,c=UPNG._bin.writeASCII,r=8,d=e.frames.length>1,h=!1,m=33+(d?20:0);if(l.sRGB!=null&&(m+=13),l.pHYs!=null&&(m+=21),e.ctype==3){for(var f=e.plte.length,g=0;g<f;g++)e.plte[g]>>>24!=255&&(h=!0);m+=8+f*3+4+(h?8+f*1+4:0)}for(var x=0;x<e.frames.length;x++){var b=e.frames[x];d&&(m+=38),m+=b.cimg.length+12,x!=0&&(m+=4)}m+=12;for(var A=new Uint8Array(m),M=[137,80,78,71,13,10,26,10],g=0;g<8;g++)A[g]=M[g];if(i(A,r,13),r+=4,c(A,r,"IHDR"),r+=4,i(A,r,n),r+=4,i(A,r,o),r+=4,A[r]=e.depth,r++,A[r]=e.ctype,r++,A[r]=0,r++,A[r]=0,r++,A[r]=0,r++,i(A,r,a(A,r-17,17)),r+=4,l.sRGB!=null&&(i(A,r,1),r+=4,c(A,r,"sRGB"),r+=4,A[r]=l.sRGB,r++,i(A,r,a(A,r-5,5)),r+=4),l.pHYs!=null&&(i(A,r,9),r+=4,c(A,r,"pHYs"),r+=4,i(A,r,l.pHYs[0]),r+=4,i(A,r,l.pHYs[1]),r+=4,A[r]=l.pHYs[2],r++,i(A,r,a(A,r-13,13)),r+=4),d&&(i(A,r,8),r+=4,c(A,r,"acTL"),r+=4,i(A,r,e.frames.length),r+=4,i(A,r,l.loop!=null?l.loop:0),r+=4,i(A,r,a(A,r-12,12)),r+=4),e.ctype==3){var f=e.plte.length;i(A,r,f*3),r+=4,c(A,r,"PLTE"),r+=4;for(var g=0;g<f;g++){var L=g*3,C=e.plte[g],u=C&255,_=C>>>8&255,y=C>>>16&255;A[r+L+0]=u,A[r+L+1]=_,A[r+L+2]=y}if(r+=f*3,i(A,r,a(A,r-f*3-4,f*3+4)),r+=4,h){i(A,r,f),r+=4,c(A,r,"tRNS"),r+=4;for(var g=0;g<f;g++)A[r+g]=e.plte[g]>>>24&255;r+=f,i(A,r,a(A,r-f-4,f+4)),r+=4}}for(var v=0,x=0;x<e.frames.length;x++){var b=e.frames[x];d&&(i(A,r,26),r+=4,c(A,r,"fcTL"),r+=4,i(A,r,v++),r+=4,i(A,r,b.rect.width),r+=4,i(A,r,b.rect.height),r+=4,i(A,r,b.rect.x),r+=4,i(A,r,b.rect.y),r+=4,s(A,r,t[x]),r+=2,s(A,r,1e3),r+=2,A[r]=b.dispose,r++,A[r]=b.blend,r++,i(A,r,a(A,r-30,30)),r+=4);var T=b.cimg,f=T.length;i(A,r,f+(x==0?0:4)),r+=4;var k=r;c(A,r,x==0?"IDAT":"fdAT"),r+=4,x!=0&&(i(A,r,v++),r+=4),A.set(T,r),r+=f,i(A,r,a(A,k,r-k)),r+=4}return i(A,r,0),r+=4,c(A,r,"IEND"),r+=4,i(A,r,a(A,r-4,4)),r+=4,A.buffer};UPNG.encode.compressPNG=function(e,n,o){for(var t=0;t<e.frames.length;t++){var l=e.frames[t];l.rect.width;var a=l.rect.height,i=new Uint8Array(a*l.bpl+a);l.cimg=UPNG.encode._filterZero(l.img,a,l.bpp,l.bpl,i,n,o)}};UPNG.encode.compress=function(e,n,o,t,l){for(var a=l[0],i=l[1],s=l[2],c=l[3],r=l[4],d=6,h=8,m=255,f=0;f<e.length;f++)for(var g=new Uint8Array(e[f]),x=g.length,b=0;b<x;b+=4)m&=g[b+3];var A=m!=255,M=UPNG.encode.framize(e,n,o,a,i,s),L={},C=[],u=[];if(t!=0){for(var _=[],b=0;b<M.length;b++)_.push(M[b].img.buffer);var y=UPNG.encode.concatRGBA(_),v=UPNG.quantize(y,t);console.log(v);for(var T=0,k=new Uint8Array(v.abuf),b=0;b<M.length;b++){var P=M[b].img,S=P.length;u.push(new Uint8Array(v.inds.buffer,T>>2,S>>2));for(var f=0;f<S;f+=4)P[f]=k[T+f],P[f+1]=k[T+f+1],P[f+2]=k[T+f+2],P[f+3]=k[T+f+3];T+=S}for(var b=0;b<v.plte.length;b++)C.push(v.plte[b].est.rgba)}else for(var f=0;f<M.length;f++){var F=M[f],K=new Uint32Array(F.img.buffer),Q=F.rect.width,x=K.length,Z=new Uint8Array(x);u.push(Z);for(var b=0;b<x;b++){var B=K[b];if(b!=0&&B==K[b-1])Z[b]=Z[b-1];else if(b>Q&&B==K[b-Q])Z[b]=Z[b-Q];else{var G=L[B];if(G==null&&(L[B]=G=C.length,C.push(B),C.length>=300))break;Z[b]=G}}}var w=C.length;w<=256&&r==!1&&(w<=2?h=1:w<=4?h=2:w<=16?h=4:h=8,h=Math.max(h,c));for(var f=0;f<M.length;f++){var F=M[f];F.rect.x,F.rect.y;var Q=F.rect.width,D=F.rect.height,U=F.img;new Uint32Array(U.buffer);var q=4*Q,j=4;if(w<=256&&r==!1){q=Math.ceil(h*Q/8);for(var Y=new Uint8Array(q*D),J=u[f],oe=0;oe<D;oe++){var b=oe*q,pe=oe*Q;if(h==8)for(var me=0;me<Q;me++)Y[b+me]=J[pe+me];else if(h==4)for(var me=0;me<Q;me++)Y[b+(me>>1)]|=J[pe+me]<<4-(me&1)*4;else if(h==2)for(var me=0;me<Q;me++)Y[b+(me>>2)]|=J[pe+me]<<6-(me&3)*2;else if(h==1)for(var me=0;me<Q;me++)Y[b+(me>>3)]|=J[pe+me]<<7-(me&7)*1}U=Y,d=3,j=1}else if(A==!1&&M.length==1){for(var Y=new Uint8Array(Q*D*3),Ee=Q*D,b=0;b<Ee;b++){var P=b*3,X=b*4;Y[P]=U[X],Y[P+1]=U[X+1],Y[P+2]=U[X+2]}U=Y,d=2,j=3,q=3*Q}F.img=U,F.bpl=q,F.bpp=j}return{ctype:d,depth:h,plte:C,frames:M}};UPNG.encode.framize=function(e,n,o,t,l,a){for(var i=[],s=0;s<e.length;s++){var c=new Uint8Array(e[s]),r=new Uint32Array(c.buffer),d,h=0,m=0,f=n,g=o,x=t?1:0;if(s!=0){for(var b=a||t||s==1||i[s-2].dispose!=0?1:2,A=0,M=1e9,L=0;L<b;L++){for(var F=new Uint8Array(e[s-1-L]),C=new Uint32Array(e[s-1-L]),u=n,_=o,y=-1,v=-1,T=0;T<o;T++)for(var k=0;k<n;k++){var P=T*n+k;r[P]!=C[P]&&(k<u&&(u=k),k>y&&(y=k),T<_&&(_=T),T>v&&(v=T))}y==-1&&(u=_=y=v=0),l&&((u&1)==1&&u--,(_&1)==1&&_--);var S=(y-u+1)*(v-_+1);S<M&&(M=S,A=L,h=u,m=_,f=y-u+1,g=v-_+1)}var F=new Uint8Array(e[s-1-A]);A==1&&(i[s-1].dispose=2),d=new Uint8Array(f*g*4),UPNG._copyTile(F,n,o,d,f,g,-h,-m,0),x=UPNG._copyTile(c,n,o,d,f,g,-h,-m,3)?1:0,x==1?UPNG.encode._prepareDiff(c,n,o,d,{x:h,y:m,width:f,height:g}):UPNG._copyTile(c,n,o,d,f,g,-h,-m,0)}else d=c.slice(0);i.push({rect:{x:h,y:m,width:f,height:g},img:d,blend:x,dispose:0})}if(t)for(var s=0;s<i.length;s++){var K=i[s];if(K.blend!=1){var Q=K.rect,Z=i[s-1].rect,B=Math.min(Q.x,Z.x),G=Math.min(Q.y,Z.y),w=Math.max(Q.x+Q.width,Z.x+Z.width),D=Math.max(Q.y+Q.height,Z.y+Z.height),U={x:B,y:G,width:w-B,height:D-G};i[s-1].dispose=1,s-1!=0&&UPNG.encode._updateFrame(e,n,o,i,s-1,U,l),UPNG.encode._updateFrame(e,n,o,i,s,U,l)}}var q=0;if(e.length!=1)for(var P=0;P<i.length;P++){var K=i[P];q+=K.rect.width*K.rect.height}return i};UPNG.encode._updateFrame=function(e,n,o,t,l,a,i){for(var s=Uint8Array,c=Uint32Array,r=new s(e[l-1]),d=new c(e[l-1]),h=l+1<e.length?new s(e[l+1]):null,m=new s(e[l]),f=new c(m.buffer),g=n,x=o,b=-1,A=-1,M=0;M<a.height;M++)for(var L=0;L<a.width;L++){var C=a.x+L,u=a.y+M,_=u*n+C,y=f[_];y==0||t[l-1].dispose==0&&d[_]==y&&(h==null||h[_*4+3]!=0)||(C<g&&(g=C),C>b&&(b=C),u<x&&(x=u),u>A&&(A=u))}b==-1&&(g=x=b=A=0),i&&((g&1)==1&&g--,(x&1)==1&&x--),a={x:g,y:x,width:b-g+1,height:A-x+1};var v=t[l];v.rect=a,v.blend=1,v.img=new Uint8Array(a.width*a.height*4),t[l-1].dispose==0?(UPNG._copyTile(r,n,o,v.img,a.width,a.height,-a.x,-a.y,0),UPNG.encode._prepareDiff(m,n,o,v.img,a)):UPNG._copyTile(m,n,o,v.img,a.width,a.height,-a.x,-a.y,0)};UPNG.encode._prepareDiff=function(e,n,o,t,l){UPNG._copyTile(e,n,o,t,l.width,l.height,-l.x,-l.y,2)};UPNG.encode._filterZero=function(e,n,o,t,l,a,i){var s=[],c=[0,1,2,3,4];a!=-1?c=[a]:(n*t>5e5||o==1)&&(c=[0]);var r;i&&(r={level:0});for(var d=l.length>1e7&&typeof UZIP<"u"&&UZIP!=null?UZIP:pako,h=0;h<c.length;h++){for(var m=0;m<n;m++)UPNG.encode._filterLine(l,e,m,t,o,c[h]);s.push(d.deflate(l,r))}for(var f,g=1e9,h=0;h<s.length;h++)s[h].length<g&&(f=h,g=s[h].length);return s[f]};UPNG.encode._filterLine=function(e,n,o,t,l,a){var i=o*t,s=i+o,c=UPNG.decode._paeth;if(e[s]=a,s++,a==0)if(t<500)for(var r=0;r<t;r++)e[s+r]=n[i+r];else e.set(new Uint8Array(n.buffer,i,t),s);else if(a==1){for(var r=0;r<l;r++)e[s+r]=n[i+r];for(var r=l;r<t;r++)e[s+r]=n[i+r]-n[i+r-l]+256&255}else if(o==0){for(var r=0;r<l;r++)e[s+r]=n[i+r];if(a==2)for(var r=l;r<t;r++)e[s+r]=n[i+r];if(a==3)for(var r=l;r<t;r++)e[s+r]=n[i+r]-(n[i+r-l]>>1)+256&255;if(a==4)for(var r=l;r<t;r++)e[s+r]=n[i+r]-c(n[i+r-l],0,0)+256&255}else{if(a==2)for(var r=0;r<t;r++)e[s+r]=n[i+r]+256-n[i+r-t]&255;if(a==3){for(var r=0;r<l;r++)e[s+r]=n[i+r]+256-(n[i+r-t]>>1)&255;for(var r=l;r<t;r++)e[s+r]=n[i+r]+256-(n[i+r-t]+n[i+r-l]>>1)&255}if(a==4){for(var r=0;r<l;r++)e[s+r]=n[i+r]+256-c(0,n[i+r-t],0)&255;for(var r=l;r<t;r++)e[s+r]=n[i+r]+256-c(n[i+r-l],n[i+r-t],n[i+r-l-t])&255}}};UPNG.crc={table:function(){for(var e=new Uint32Array(256),n=0;n<256;n++){for(var o=n,t=0;t<8;t++)o&1?o=3988292384^o>>>1:o=o>>>1;e[n]=o}return e}(),update:function(e,n,o,t){for(var l=0;l<t;l++)e=UPNG.crc.table[(e^n[o+l])&255]^e>>>8;return e},crc:function(e,n,o){return UPNG.crc.update(4294967295,e,n,o)^4294967295}};UPNG.quantize=function(e,n){var o=new Uint8Array(e),t=o.slice(0),l=new Uint32Array(t.buffer),a=UPNG.quantize.getKDtree(t,n),i=a[0],s=a[1],c=UPNG.quantize.planeDst,r=o,d=l,h=r.length,m=new Uint8Array(o.length>>2),f;if(o.length<2e7)for(var g=0;g<h;g+=4){var x=r[g]*.00392156862745098,b=r[g+1]*(1/255),A=r[g+2]*(1/255),M=r[g+3]*(1/255);f=UPNG.quantize.getNearest(i,x,b,A,M),m[g>>2]=f.ind,d[g>>2]=f.est.rgba}else for(var g=0;g<h;g+=4){var x=r[g]*.00392156862745098,b=r[g+1]*(1/255),A=r[g+2]*(1/255),M=r[g+3]*(1/255);for(f=i;f.left;)f=c(f.est,x,b,A,M)<=0?f.left:f.right;m[g>>2]=f.ind,d[g>>2]=f.est.rgba}return{abuf:t.buffer,inds:m,plte:s}};UPNG.quantize.getKDtree=function(e,n,o){o==null&&(o=1e-4);var t=new Uint32Array(e.buffer),l={i0:0,i1:e.length,bst:null,est:null,tdst:0,left:null,right:null};l.bst=UPNG.quantize.stats(e,l.i0,l.i1),l.est=UPNG.quantize.estats(l.bst);for(var a=[l];a.length<n;){for(var i=0,s=0,c=0;c<a.length;c++)a[c].est.L>i&&(i=a[c].est.L,s=c);if(i<o)break;var r=a[s],d=UPNG.quantize.splitPixels(e,t,r.i0,r.i1,r.est.e,r.est.eMq255),h=r.i0>=d||r.i1<=d;if(h){r.est.L=0;continue}var m={i0:r.i0,i1:d,bst:null,est:null,tdst:0,left:null,right:null};m.bst=UPNG.quantize.stats(e,m.i0,m.i1),m.est=UPNG.quantize.estats(m.bst);var f={i0:d,i1:r.i1,bst:null,est:null,tdst:0,left:null,right:null};f.bst={R:[],m:[],N:r.bst.N-m.bst.N};for(var c=0;c<16;c++)f.bst.R[c]=r.bst.R[c]-m.bst.R[c];for(var c=0;c<4;c++)f.bst.m[c]=r.bst.m[c]-m.bst.m[c];f.est=UPNG.quantize.estats(f.bst),r.left=m,r.right=f,a[s]=m,a.push(f)}a.sort(function(g,x){return x.bst.N-g.bst.N});for(var c=0;c<a.length;c++)a[c].ind=c;return[l,a]};UPNG.quantize.getNearest=function(e,n,o,t,l){if(e.left==null)return e.tdst=UPNG.quantize.dist(e.est.q,n,o,t,l),e;var a=UPNG.quantize.planeDst(e.est,n,o,t,l),i=e.left,s=e.right;a>0&&(i=e.right,s=e.left);var c=UPNG.quantize.getNearest(i,n,o,t,l);if(c.tdst<=a*a)return c;var r=UPNG.quantize.getNearest(s,n,o,t,l);return r.tdst<c.tdst?r:c};UPNG.quantize.planeDst=function(e,n,o,t,l){var a=e.e;return a[0]*n+a[1]*o+a[2]*t+a[3]*l-e.eMq};UPNG.quantize.dist=function(e,n,o,t,l){var a=n-e[0],i=o-e[1],s=t-e[2],c=l-e[3];return a*a+i*i+s*s+c*c};UPNG.quantize.splitPixels=function(e,n,o,t,l,a){var i=UPNG.quantize.vecDot;for(t-=4;o<t;){for(;i(e,o,l)<=a;)o+=4;for(;i(e,t,l)>a;)t-=4;if(o>=t)break;var s=n[o>>2];n[o>>2]=n[t>>2],n[t>>2]=s,o+=4,t-=4}for(;i(e,o,l)>a;)o-=4;return o+4};UPNG.quantize.vecDot=function(e,n,o){return e[n]*o[0]+e[n+1]*o[1]+e[n+2]*o[2]+e[n+3]*o[3]};UPNG.quantize.stats=function(e,n,o){for(var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=[0,0,0,0],a=o-n>>2,i=n;i<o;i+=4){var s=e[i]*.00392156862745098,c=e[i+1]*(1/255),r=e[i+2]*(1/255),d=e[i+3]*(1/255);l[0]+=s,l[1]+=c,l[2]+=r,l[3]+=d,t[0]+=s*s,t[1]+=s*c,t[2]+=s*r,t[3]+=s*d,t[5]+=c*c,t[6]+=c*r,t[7]+=c*d,t[10]+=r*r,t[11]+=r*d,t[15]+=d*d}return t[4]=t[1],t[8]=t[2],t[9]=t[6],t[12]=t[3],t[13]=t[7],t[14]=t[11],{R:t,m:l,N:a}};UPNG.quantize.estats=function(e){var n=e.R,o=e.m,t=e.N,l=o[0],a=o[1],i=o[2],s=o[3],c=t==0?0:1/t,r=[n[0]-l*l*c,n[1]-l*a*c,n[2]-l*i*c,n[3]-l*s*c,n[4]-a*l*c,n[5]-a*a*c,n[6]-a*i*c,n[7]-a*s*c,n[8]-i*l*c,n[9]-i*a*c,n[10]-i*i*c,n[11]-i*s*c,n[12]-s*l*c,n[13]-s*a*c,n[14]-s*i*c,n[15]-s*s*c],d=r,h=UPNG.M4,m=[Math.random(),Math.random(),Math.random(),Math.random()],f=0,g=0;if(t!=0)for(var x=0;x<16&&(m=h.multVec(d,m),g=Math.sqrt(h.dot(m,m)),m=h.sml(1/g,m),!(x!=0&&Math.abs(g-f)<1e-9));x++)f=g;var b=[l*c,a*c,i*c,s*c],A=h.dot(h.sml(255,b),m);return{Cov:r,q:b,e:m,L:f,eMq255:A,eMq:h.dot(m,b),rgba:(Math.round(255*b[3])<<24|Math.round(255*b[2])<<16|Math.round(255*b[1])<<8|Math.round(255*b[0])<<0)>>>0}};UPNG.M4={multVec:function(e,n){return[e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3],e[4]*n[0]+e[5]*n[1]+e[6]*n[2]+e[7]*n[3],e[8]*n[0]+e[9]*n[1]+e[10]*n[2]+e[11]*n[3],e[12]*n[0]+e[13]*n[1]+e[14]*n[2]+e[15]*n[3]]},dot:function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3]},sml:function(e,n){return[e*n[0],e*n[1],e*n[2],e*n[3]]}};UPNG.encode.concatRGBA=function(e){for(var n=0,o=0;o<e.length;o++)n+=e[o].byteLength;for(var t=new Uint8Array(n),l=0,o=0;o<e.length;o++){for(var a=new Uint8Array(e[o]),i=a.length,s=0;s<i;s+=4){var c=a[s],r=a[s+1],d=a[s+2],h=a[s+3];h==0&&(c=r=d=0),t[l+s]=c,t[l+s+1]=r,t[l+s+2]=d,t[l+s+3]=h}l+=i}return t.buffer};(function(){var e={};typeof module=="object"?module.exports=e:self.UTIF=e;var n=typeof require=="function"?require("pako"):self.pako;function o(){typeof process>"u"&&console.log.apply(console,arguments)}(function(t,l){(function(){var a=function(){function r(d){this.message="JPEG error: "+d}return r.prototype=new Error,r.prototype.name="JpegError",r.constructor=r,r}(),i=function(){var r=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),d=4017,h=799,m=3406,f=2276,g=1567,x=3784,b=5793,A=2896;function M(T){T==null&&(T={}),T.w==null&&(T.w=-1),this.V=T.n,this.N=T.w}function L(T,k){for(var P=0,S=[],F,K,Q=16,Z;Q>0&&!T[Q-1];)Q--;S.push({children:[],index:0});var B=S[0];for(F=0;F<Q;F++){for(K=0;K<T[F];K++){for(B=S.pop(),B.children[B.index]=k[P];B.index>0;)B=S.pop();for(B.index++,S.push(B);S.length<=F;)S.push(Z={children:[],index:0}),B.children[B.index]=Z.children,B=Z;P++}F+1<Q&&(S.push(Z={children:[],index:0}),B.children[B.index]=Z.children,B=Z)}return S[0].children}function C(T,k,P){return 64*((T.P+1)*k+P)}function u(T,k,P,S,F,K,Q,Z,B,G){G==null&&(G=!1);var w=P.m,D=P.Z,U=k,q=0,j=0,Y=0,J=0,oe,pe=0,me,Ee,X,N,te,re,se=0,ve,ee,le,H;function I(){if(j>0)return j--,q>>j&1;if(q=T[k++],q===255){var qe=T[k++];if(qe){if(qe===220&&G){k+=2;var W=s(T,k);if(k+=2,W>0&&W!==P.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",W)}else if(qe===217){if(G){var ne=pe*8;if(ne>0&&ne<P.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",ne)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new a("unexpected marker")}}return j=7,q>>>7}function O(qe){for(var W=qe;;){switch(W=W[I()],typeof W){case"number":return W;case"object":continue}throw new a("invalid huffman sequence")}}function ae(qe){for(var W=0;qe>0;)W=W<<1|I(),qe--;return W}function _e(qe){if(qe===1)return I()===1?1:-1;var W=ae(qe);return W>=1<<qe-1?W:W+(-1<<qe)+1}function Ae(qe,W){var ne=O(qe.J),ue=ne===0?0:_e(ne),he=1;for(qe.D[W]=qe.Q+=ue;he<64;){var be=O(qe.i),Re=be&15,ge=be>>4;if(Re===0){if(ge<15)break;he+=16;continue}he+=ge;var we=r[he];qe.D[W+we]=_e(Re),he++}}function Se(qe,W){var ne=O(qe.J),ue=ne===0?0:_e(ne)<<B;qe.D[W]=qe.Q+=ue}function ze(qe,W){qe.D[W]|=I()<<B}function Xe(qe,W){if(Y>0){Y--;return}for(var ne=K,ue=Q;ne<=ue;){var he=O(qe.i),be=he&15,Re=he>>4;if(be===0){if(Re<15){Y=ae(Re)+(1<<Re)-1;break}ne+=16;continue}ne+=Re;var ge=r[ne];qe.D[W+ge]=_e(be)*(1<<B),ne++}}function Ue(qe,W){for(var ne=K,ue=Q,he=0,be,Re;ne<=ue;){var ge=W+r[ne],we=qe.D[ge]<0?-1:1;switch(J){case 0:if(Re=O(qe.i),be=Re&15,he=Re>>4,be===0)he<15?(Y=ae(he)+(1<<he),J=4):(he=16,J=1);else{if(be!==1)throw new a("invalid ACn encoding");oe=_e(be),J=he?2:3}continue;case 1:case 2:qe.D[ge]?qe.D[ge]+=we*(I()<<B):(he--,he===0&&(J=J===2?3:0));break;case 3:qe.D[ge]?qe.D[ge]+=we*(I()<<B):(qe.D[ge]=oe<<B,J=0);break;case 4:qe.D[ge]&&(qe.D[ge]+=we*(I()<<B));break}ne++}J===4&&(Y--,Y===0&&(J=0))}function Ze(qe,W,ne,ue,he){var be=ne/w|0,Re=ne%w;pe=be*qe.A+ue;var ge=Re*qe.h+he,we=C(qe,pe,ge);W(qe,we)}function He(qe,W,ne){pe=ne/qe.P|0;var ue=ne%qe.P,he=C(qe,pe,ue);W(qe,he)}var Je=S.length;for(D?K===0?re=Z===0?Se:ze:re=Z===0?Xe:Ue:re=Ae,Je===1?ee=S[0].P*S[0].c:ee=w*P.R;se<=ee;){var nt=F?Math.min(ee-se,F):ee;if(nt>0){for(Ee=0;Ee<Je;Ee++)S[Ee].Q=0;if(Y=0,Je===1)for(me=S[0],te=0;te<nt;te++)He(me,re,se),se++;else for(te=0;te<nt;te++){for(Ee=0;Ee<Je;Ee++)for(me=S[Ee],le=me.h,H=me.A,X=0;X<H;X++)for(N=0;N<le;N++)Ze(me,re,se,X,N);se++}}if(j=0,ve=v(T,k),!ve)break;if(ve.u&&(k=ve.offset),ve.M>=65488&&ve.M<=65495)k+=2;else break}return k-U}function _(T,k,P){var S=T.$,F=T.D,K,Q,Z,B,G,w,D,U,q,j,Y,J,oe,pe,me,Ee,X;if(!S)throw new a("missing required Quantization Table.");for(var N=0;N<64;N+=8){if(q=F[k+N],j=F[k+N+1],Y=F[k+N+2],J=F[k+N+3],oe=F[k+N+4],pe=F[k+N+5],me=F[k+N+6],Ee=F[k+N+7],q*=S[N],!(j|Y|J|oe|pe|me|Ee)){X=b*q+512>>10,P[N]=X,P[N+1]=X,P[N+2]=X,P[N+3]=X,P[N+4]=X,P[N+5]=X,P[N+6]=X,P[N+7]=X;continue}j*=S[N+1],Y*=S[N+2],J*=S[N+3],oe*=S[N+4],pe*=S[N+5],me*=S[N+6],Ee*=S[N+7],K=b*q+128>>8,Q=b*oe+128>>8,Z=Y,B=me,G=A*(j-Ee)+128>>8,U=A*(j+Ee)+128>>8,w=J<<4,D=pe<<4,K=K+Q+1>>1,Q=K-Q,X=Z*x+B*g+128>>8,Z=Z*g-B*x+128>>8,B=X,G=G+D+1>>1,D=G-D,U=U+w+1>>1,w=U-w,K=K+B+1>>1,B=K-B,Q=Q+Z+1>>1,Z=Q-Z,X=G*f+U*m+2048>>12,G=G*m-U*f+2048>>12,U=X,X=w*h+D*d+2048>>12,w=w*d-D*h+2048>>12,D=X,P[N]=K+U,P[N+7]=K-U,P[N+1]=Q+D,P[N+6]=Q-D,P[N+2]=Z+w,P[N+5]=Z-w,P[N+3]=B+G,P[N+4]=B-G}for(var te=0;te<8;++te){if(q=P[te],j=P[te+8],Y=P[te+16],J=P[te+24],oe=P[te+32],pe=P[te+40],me=P[te+48],Ee=P[te+56],!(j|Y|J|oe|pe|me|Ee)){X=b*q+8192>>14,X<-2040?X=0:X>=2024?X=255:X=X+2056>>4,F[k+te]=X,F[k+te+8]=X,F[k+te+16]=X,F[k+te+24]=X,F[k+te+32]=X,F[k+te+40]=X,F[k+te+48]=X,F[k+te+56]=X;continue}K=b*q+2048>>12,Q=b*oe+2048>>12,Z=Y,B=me,G=A*(j-Ee)+2048>>12,U=A*(j+Ee)+2048>>12,w=J,D=pe,K=(K+Q+1>>1)+4112,Q=K-Q,X=Z*x+B*g+2048>>12,Z=Z*g-B*x+2048>>12,B=X,G=G+D+1>>1,D=G-D,U=U+w+1>>1,w=U-w,K=K+B+1>>1,B=K-B,Q=Q+Z+1>>1,Z=Q-Z,X=G*f+U*m+2048>>12,G=G*m-U*f+2048>>12,U=X,X=w*h+D*d+2048>>12,w=w*d-D*h+2048>>12,D=X,q=K+U,Ee=K-U,j=Q+D,me=Q-D,Y=Z+w,pe=Z-w,J=B+G,oe=B-G,q<16?q=0:q>=4080?q=255:q>>=4,j<16?j=0:j>=4080?j=255:j>>=4,Y<16?Y=0:Y>=4080?Y=255:Y>>=4,J<16?J=0:J>=4080?J=255:J>>=4,oe<16?oe=0:oe>=4080?oe=255:oe>>=4,pe<16?pe=0:pe>=4080?pe=255:pe>>=4,me<16?me=0:me>=4080?me=255:me>>=4,Ee<16?Ee=0:Ee>=4080?Ee=255:Ee>>=4,F[k+te]=q,F[k+te+8]=j,F[k+te+16]=Y,F[k+te+24]=J,F[k+te+32]=oe,F[k+te+40]=pe,F[k+te+48]=me,F[k+te+56]=Ee}}function y(T,k){for(var P=k.P,S=k.c,F=new Int16Array(64),K=0;K<S;K++)for(var Q=0;Q<P;Q++){var Z=C(k,K,Q);_(k,Z,F)}return k.D}function v(T,k,P){P==null&&(P=k);var S=T.length-1,F=P<k?P:k;if(k>=S)return null;var K=s(T,k);if(K>=65472&&K<=65534)return{u:null,M:K,offset:k};for(var Q=s(T,F);!(Q>=65472&&Q<=65534);){if(++F>=S)return null;Q=s(T,F)}return{u:K.toString(16),M:Q,offset:F}}return M.prototype={parse(T,k){k==null&&(k={});var P=k.F,S=0,F=null,K=null,Q,Z,B=0;function G(){var ge=s(T,S);S+=2;var we=S+ge-2,Ce=v(T,we,S);Ce&&Ce.u&&(we=Ce.offset);var Fe=T.subarray(S,we);return S+=Fe.length,Fe}function w(ge){for(var we=Math.ceil(ge.o/8/ge.X),Ce=Math.ceil(ge.s/8/ge.B),Fe=0;Fe<ge.W.length;Fe++){Ue=ge.W[Fe];var Ve=Math.ceil(Math.ceil(ge.o/8)*Ue.h/ge.X),Ye=Math.ceil(Math.ceil(ge.s/8)*Ue.A/ge.B),We=we*Ue.h,Ie=Ce*Ue.A,Oe=64*Ie*(We+1);Ue.D=new Int16Array(Oe),Ue.P=Ve,Ue.c=Ye}ge.m=we,ge.R=Ce}var D=[],U=[],q=[],j=s(T,S);if(S+=2,j!==65496)throw new a("SOI not found");j=s(T,S),S+=2;e:for(;j!==65497;){var Y,J,oe;switch(j){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var pe=G();j===65504&&pe[0]===74&&pe[1]===70&&pe[2]===73&&pe[3]===70&&pe[4]===0&&(F={version:{d:pe[5],T:pe[6]},K:pe[7],j:pe[8]<<8|pe[9],H:pe[10]<<8|pe[11],S:pe[12],I:pe[13],C:pe.subarray(14,14+3*pe[12]*pe[13])}),j===65518&&pe[0]===65&&pe[1]===100&&pe[2]===111&&pe[3]===98&&pe[4]===101&&(K={version:pe[5]<<8|pe[6],k:pe[7]<<8|pe[8],q:pe[9]<<8|pe[10],a:pe[11]});break;case 65499:var me=s(T,S),Ee;S+=2;for(var X=me+S-2;S<X;){var N=T[S++],te=new Uint16Array(64);if(N>>4)if(N>>4===1)for(J=0;J<64;J++)Ee=r[J],te[Ee]=s(T,S),S+=2;else throw new a("DQT - invalid table spec");else for(J=0;J<64;J++)Ee=r[J],te[Ee]=T[S++];D[N&15]=te}break;case 65472:case 65473:case 65474:if(Q)throw new a("Only single frame JPEGs supported");S+=2,Q={},Q.G=j===65473,Q.Z=j===65474,Q.precision=T[S++];var re=s(T,S),se,ve=0,ee=0;S+=2,Q.s=P||re,Q.o=s(T,S),S+=2,Q.W=[],Q._={};var le=T[S++];for(Y=0;Y<le;Y++){se=T[S];var H=T[S+1]>>4,I=T[S+1]&15;ve<H&&(ve=H),ee<I&&(ee=I);var O=T[S+2];oe=Q.W.push({h:H,A:I,L:O,$:null}),Q._[se]=oe-1,S+=3}Q.X=ve,Q.B=ee,w(Q);break;case 65476:var ae=s(T,S);for(S+=2,Y=2;Y<ae;){var _e=T[S++],Ae=new Uint8Array(16),Se=0;for(J=0;J<16;J++,S++)Se+=Ae[J]=T[S];var ze=new Uint8Array(Se);for(J=0;J<Se;J++,S++)ze[J]=T[S];Y+=17+Se,(_e>>4?U:q)[_e&15]=L(Ae,ze)}break;case 65501:S+=2,Z=s(T,S),S+=2;break;case 65498:var Xe=++B===1&&!P,Ue;S+=2;var Ze=T[S++],He=[];for(Y=0;Y<Ze;Y++){var Je=T[S++],nt=Q._[Je];Ue=Q.W[nt],Ue.index=Je;var qe=T[S++];Ue.J=q[qe>>4],Ue.i=U[qe&15],He.push(Ue)}var W=T[S++],ne=T[S++],ue=T[S++];try{var he=u(T,S,Q,He,Z,W,ne,ue>>4,ue&15,Xe);S+=he}catch(ge){if(ge instanceof DNLMarkerError)return this.parse(T,{F:ge.s});if(ge instanceof EOIMarkerError)break e;throw ge}break;case 65500:S+=4;break;case 65535:T[S]!==255&&S--;break;default:var be=v(T,S-2,S-3);if(be&&be.u){S=be.offset;break}if(S>=T.length-1)break e;throw new a("JpegImage.parse - unknown marker: "+j.toString(16))}j=s(T,S),S+=2}for(this.width=Q.o,this.height=Q.s,this.g=F,this.b=K,this.W=[],Y=0;Y<Q.W.length;Y++){Ue=Q.W[Y];var Re=D[Ue.L];Re&&(Ue.$=Re),this.W.push({index:Ue.index,e:y(Q,Ue),l:Ue.h/Q.X,t:Ue.A/Q.B,P:Ue.P,c:Ue.c})}this.p=this.W.length},Y(T,k,P){P==null&&(P=!1);var S=this.width/T,F=this.height/k,K,Q,Z,B,G,w,D,U,q,j,Y=0,J,oe=this.W.length,pe=T*k*oe,me=new Uint8ClampedArray(pe),Ee=new Uint32Array(T),X=4294967288,N;for(D=0;D<oe;D++){if(K=this.W[D],Q=K.l*S,Z=K.t*F,Y=D,J=K.e,B=K.P+1<<3,Q!==N){for(G=0;G<T;G++)U=0|G*Q,Ee[G]=(U&X)<<3|U&7;N=Q}for(w=0;w<k;w++)for(U=0|w*Z,j=B*(U&X)|(U&7)<<3,G=0;G<T;G++)me[Y]=J[j+Ee[G]],Y+=oe}var te=this.V;if(!P&&oe===4&&!te&&(te=new Int32Array([-256,255,-256,255,-256,255,-256,255])),te)for(D=0;D<pe;)for(U=0,q=0;U<oe;U++,D++,q+=2)me[D]=(me[D]*te[q]>>8)+te[q+1];return me},get f(){return this.b?!!this.b.a:this.p===3?this.N===0?!1:!(this.W[0].index===82&&this.W[1].index===71&&this.W[2].index===66):this.N===1},z:function(k){for(var P,S,F,K=0,Q=k.length;K<Q;K+=3)P=k[K],S=k[K+1],F=k[K+2],k[K]=P-179.456+1.402*F,k[K+1]=P+135.459-.344*S-.714*F,k[K+2]=P-226.816+1.772*S;return k},O:function(k){for(var P,S,F,K,Q=0,Z=0,B=k.length;Z<B;Z+=4)P=k[Z],S=k[Z+1],F=k[Z+2],K=k[Z+3],k[Q++]=-122.67195406894+S*(-660635669420364e-19*S+.000437130475926232*F-54080610064599e-18*P+.00048449797120281*K-.154362151871126)+F*(-.000957964378445773*F+.000817076911346625*P-.00477271405408747*K+1.53380253221734)+P*(.000961250184130688*P-.00266257332283933*K+.48357088451265)+K*(-.000336197177618394*K+.484791561490776),k[Q++]=107.268039397724+S*(219927104525741e-19*S-.000640992018297945*F+.000659397001245577*P+.000426105652938837*K-.176491792462875)+F*(-.000778269941513683*F+.00130872261408275*P+.000770482631801132*K-.151051492775562)+P*(.00126935368114843*P-.00265090189010898*K+.25802910206845)+K*(-.000318913117588328*K-.213742400323665),k[Q++]=-20.810012546947+S*(-.000570115196973677*S-263409051004589e-19*F+.0020741088115012*P-.00288260236853442*K+.814272968359295)+F*(-153496057440975e-19*F-.000132689043961446*P+.000560833691242812*K-.195152027534049)+P*(.00174418132927582*P-.00255243321439347*K+.116935020465145)+K*(-.000343531996510555*K+.24165260232407);return k.subarray(0,Q)},r:function(k){for(var P,S,F,K=0,Q=k.length;K<Q;K+=4)P=k[K],S=k[K+1],F=k[K+2],k[K]=434.456-P-1.402*F,k[K+1]=119.541-P+.344*S+.714*F,k[K+2]=481.816-P-1.772*S;return k},U:function(k){for(var P,S,F,K,Q=0,Z=0,B=k.length;Z<B;Z+=4)P=k[Z],S=k[Z+1],F=k[Z+2],K=k[Z+3],k[Q++]=255+P*(-6747147073602441e-20*P+.0008379262121013727*S+.0002894718188643294*F+.003264231057537806*K-1.1185611867203937)+S*(26374107616089405e-21*S-8626949158638572e-20*F-.0002748769067499491*K-.02155688794978967)+F*(-3878099212869363e-20*F-.0003267808279485286*K+.0686742238595345)-K*(.0003361971776183937*K+.7430659151342254),k[Q++]=255+P*(.00013596372813588848*P+.000924537132573585*S+.00010567359618683593*F+.0004791864687436512*K-.3109689587515875)+S*(-.00023545346108370344*S+.0002702845253534714*F+.0020200308977307156*K-.7488052167015494)+F*(6834815998235662e-20*F+.00015168452363460973*K-.09751927774728933)-K*(.0003189131175883281*K+.7364883807733168),k[Q++]=255+P*(13598650411385307e-21*P+.00012423956175490851*S+.0004751985097583589*F-36729317476630422e-22*K-.05562186980264034)+S*(.00016141380598724676*S+.0009692239130725186*F+.0007782692450036253*K-.44015232367526463)+F*(5068882914068769e-22*F+.0017778369011375071*K-.7591454649749609)-K*(.0003435319965105553*K+.7063770186160144);return k.subarray(0,Q)},getData:function(T){var k=T.width,P=T.height,S=T.forceRGB,F=T.isSourcePDF;if(this.p>4)throw new a("Unsupported color mode");var K=this.Y(k,P,F);if(this.p===1&&S){for(var Q=K.length,Z=new Uint8ClampedArray(Q*3),B=0,G=0;G<Q;G++){var w=K[G];Z[B++]=w,Z[B++]=w,Z[B++]=w}return Z}else{if(this.p===3&&this.f)return this.z(K);if(this.p===4){if(this.f)return S?this.O(K):this.r(K);if(S)return this.U(K)}}return K}},M}();function s(c,r){return c[r]<<8|c[r+1]}t.JpegDecoder=i})(),t.encodeImage=function(a,i,s,c){var r={t256:[i],t257:[s],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[s],t279:[i*s*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(c)for(var d in c)r[d]=c[d];for(var h=new Uint8Array(t.encode([r])),m=new Uint8Array(a),f=new Uint8Array(1e3+i*s*4),d=0;d<h.length;d++)f[d]=h[d];for(var d=0;d<m.length;d++)f[1e3+d]=m[d];return f.buffer},t.encode=function(a){var i=new Uint8Array(2e4),s=4,c=t._binBE;i[0]=i[1]=77,c.writeUshort(i,2,42);var r=8;c.writeUint(i,s,r),s+=4;for(var d=0;d<a.length;d++){var h=t._writeIFD(c,t._types.basic,i,r,a[d]);r=h[1],d<a.length-1&&(r&3&&(r+=4-(r&3)),c.writeUint(i,h[0],r))}return i.slice(0,r).buffer},t.decode=function(a,i){i==null&&(i={parseMN:!0,debug:!1});var s=new Uint8Array(a),c=0,r=t._binBE.readASCII(s,c,2);c+=2;var d=r=="II"?t._binLE:t._binBE;d.readUshort(s,c),c+=2;var h=d.readUint(s,c);c+=4;for(var m=[];;){var f=d.readUshort(s,h),g=d.readUshort(s,h+4);if(f!=0&&(g<1||13<g)){o("error in TIFF");break}if(t._readIFD(d,s,h,m,0,i),h=d.readUint(s,h+2+f*12),h==0)break}return m},t.decodeImage=function(a,i,s){if(!i.data){var c=new Uint8Array(a),r=t._binBE.readASCII(c,0,2);if(i.t256!=null){i.isLE=r=="II",i.width=i.t256[0],i.height=i.t257[0];var d=i.t259?i.t259[0]:1,h=i.t266?i.t266[0]:1;i.t284&&i.t284[0]==2&&o("PlanarConfiguration 2 should not be used!");var m;i.t258?m=Math.min(32,i.t258[0])*i.t258.length:m=i.t277?i.t277[0]:1,d==1&&i.t279!=null&&i.t278&&i.t262[0]==32803&&(m=Math.round(i.t279[0]*8/(i.width*i.t278[0])));var f=Math.ceil(i.width*m/8)*8,g=i.t273;g==null&&(g=i.t324);var x=i.t279;d==1&&g.length==1&&(x=[i.height*(f>>>3)]),x==null&&(x=i.t325);var b=new Uint8Array(i.height*(f>>>3)),A=0;if(i.t322!=null){for(var M=i.t322[0],L=i.t323[0],C=Math.floor((i.width+M-1)/M),u=Math.floor((i.height+L-1)/L),_=new Uint8Array(Math.ceil(M*L*m/8)|0),y=0;y<u;y++)for(var v=0;v<C;v++){for(var T=y*C+v,k=0;k<_.length;k++)_[k]=0;t.decode._decompress(i,s,c,g[T],x[T],d,_,0,h),d==6?b=_:t._copyTile(_,Math.ceil(M*m/8)|0,L,b,Math.ceil(i.width*m/8)|0,i.height,Math.ceil(v*M*m/8)|0,y*L)}A=b.length*8}else{var P=i.t278?i.t278[0]:i.height;P=Math.min(P,i.height);for(var T=0;T<g.length;T++)t.decode._decompress(i,s,c,g[T],x[T],d,b,Math.ceil(A/8)|0,h),A+=f*P;A=Math.min(A,b.length*8)}i.data=new Uint8Array(b.buffer,0,Math.ceil(A/8)|0)}}},t.decode._decompress=function(a,i,s,c,r,d,h,m,f){if(d==1)for(var g=0;g<r;g++)h[m+g]=s[c+g];else if(d==3)t.decode._decodeG3(s,c,r,h,m,a.width,f,a.t292?(a.t292[0]&1)==1:!1);else if(d==4)t.decode._decodeG4(s,c,r,h,m,a.width,f);else if(d==5)t.decode._decodeLZW(s,c,r,h,m,8);else if(d==6)t.decode._decodeOldJPEG(a,s,c,r,h,m);else if(d==7||d==34892)t.decode._decodeNewJPEG(a,s,c,r,h,m);else if(d==8||d==32946)for(var x=new Uint8Array(s.buffer,c,r),b=l.inflate(x),A=0;A<b.length;A++)h[m+A]=b[A];else d==9?t.decode._decodeVC5(s,c,r,h,m):d==32767?t.decode._decodeARW(a,s,c,r,h,m):d==32773?t.decode._decodePackBits(s,c,r,h,m):d==32809?t.decode._decodeThunder(s,c,r,h,m):d==34713?t.decode._decodeNikon(a,i,s,c,r,h,m):o("Unknown compression",d);var M=a.t258?Math.min(32,a.t258[0]):1,L=a.t277?a.t277[0]:1,C=M*L>>>3,u=a.t278?a.t278[0]:a.height,_=Math.ceil(M*L*a.width/8);if(M==16&&!a.isLE&&a.t33422==null)for(var y=0;y<u;y++)for(var v=m+y*_,T=1;T<_;T+=2){var k=h[v+T];h[v+T]=h[v+T-1],h[v+T-1]=k}if(a.t317&&a.t317[0]==2)for(var y=0;y<u;y++){var P=m+y*_;if(M==16)for(var g=C;g<_;g+=2){var S=(h[P+g+1]<<8|h[P+g])+(h[P+g-C+1]<<8|h[P+g-C]);h[P+g]=S&255,h[P+g+1]=S>>>8&255}else if(L==3)for(var g=3;g<_;g+=3)h[P+g]=h[P+g]+h[P+g-3]&255,h[P+g+1]=h[P+g+1]+h[P+g-2]&255,h[P+g+2]=h[P+g+2]+h[P+g-1]&255;else for(var g=C;g<_;g++)h[P+g]=h[P+g]+h[P+g-C]&255}},t.decode._decodeVC5=t.decode._decodeVC5=function(){var a=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],i,s,c,r=[3,3,3,3,2,2,2,1,1,1],d=24576,h=16384,m=8192,f=h|m;function g(y){var v=y[1],T=y[0][v>>>3]>>>7-(v&7)&1;return y[1]++,T}function x(y,v){if(i==null){i={};for(var T=0;T<a.length;T+=4)i[a[T+1]]=a.slice(T,T+4)}for(var k=g(y),P=i[k];P==null;)k=k<<1|g(y),P=i[k];var S=P[3];S!=0&&(S=g(y)==0?S:-S),v[0]=P[2],v[1]=S}function b(y,v){for(var T=0;T<v;T++)(y&1)==1&&y++,y=y>>>1;return y}function A(y,v){return y>>v}function M(y,v,T,k,P,S){v[T]=A(A(11*y[P]-4*y[P+S]+y[P+S+S]+4,3)+y[k],1),v[T+S]=A(A(5*y[P]+4*y[P+S]-y[P+S+S]+4,3)-y[k],1)}function L(y,v,T,k,P,S){var F=y[P-S]-y[P+S],K=y[P],Q=y[k];v[T]=A(A(F+4,3)+K+Q,1),v[T+S]=A(A(-F+4,3)+K-Q,1)}function C(y,v,T,k,P,S){v[T]=A(A(5*y[P]+4*y[P-S]-y[P-S-S]+4,3)+y[k],1),v[T+S]=A(A(11*y[P]-4*y[P-S]+y[P-S-S]+4,3)-y[k],1)}function u(y){return y=y<0?0:y>4095?4095:y,y=c[y]>>>2,y}function _(y,v,T,k,P){k=new Uint16Array(k.buffer);var S=Date.now(),F=t._binBE,K=v+T,Q,Z,B,G,w,D,U,q,j,Y;for(v+=4;v<K;){var J=F.readShort(y,v),oe=F.readUshort(y,v+2);if(v+=4,J==12)Q=oe;else if(J==20)Z=oe;else if(J==21)B=oe;else if(J==48)G=oe;else if(J==53)w=oe;else if(J!=35){if(J==62)D=oe;else if(J!=101){if(J==109)U=oe;else if(J!=84){if(J!=106){if(J!=107){if(J!=108){if(J!=102){if(J==104)q=oe;else if(J!=105){var pe=J<0?-J:J,me=pe&65280,Ee=0;if(pe&f&&(pe&m?(Ee=oe&65535,Ee+=(pe&255)<<16):Ee=oe&65535),(pe&d)==d){if(j==null){j=[];for(var X=0;X<4;X++)j[X]=new Int16Array((Z>>>1)*(B>>>1));Y=new Int16Array((Z>>>1)*(B>>>1)),s=new Int16Array(1024);for(var X=0;X<1024;X++){var N=X-512,te=Math.abs(N),Q=Math.floor(768*te*te*te/(255*255*255))+te;s[X]=Math.sign(N)*Q}c=new Uint16Array(4096);for(var re=65535,X=0;X<4096;X++){var se=X,ve=re*(Math.pow(113,se/4095)-1)/112;c[X]=Math.min(ve,re)}}var ee=j[D],le=b(Z,1+r[G]),H=b(B,1+r[G]);if(G==0)for(var I=0;I<H;I++)for(var O=0;O<le;O++){var ae=v+(I*le+O)*2;ee[I*(Z>>>1)+O]=y[ae]<<8|y[ae+1]}else{for(var _e=[y,v*8],Ae=[],Se=0,ze=le*H,Xe=[0,0],Ue=0,oe=0;Se<ze;)for(x(_e,Xe),Ue=Xe[0],oe=Xe[1];Ue>0;)Ae[Se++]=oe,Ue--;for(var Ze=(G-1)%3,He=Ze!=1?le:0,Je=Ze!=0?H:0,I=0;I<H;I++)for(var nt=(I+Je)*(Z>>>1)+He,qe=I*le,O=0;O<le;O++)ee[nt+O]=s[Ae[qe+O]+512]*w;if(Ze==2){for(var q=Z>>>1,W=le*2,ne=H*2,I=0;I<H;I++)for(var O=0;O<W;O++){var X=I*2*q+O,ue=I*q+O,he=H*q+ue;I==0?M(ee,Y,X,he,ue,q):I==H-1?C(ee,Y,X,he,ue,q):L(ee,Y,X,he,ue,q)}var be=ee;ee=Y,Y=be;for(var I=0;I<ne;I++)for(var O=0;O<le;O++){var X=I*q+2*O,ue=I*q+O,he=le+ue;O==0?M(ee,Y,X,he,ue,1):O==le-1?C(ee,Y,X,he,ue,1):L(ee,Y,X,he,ue,1)}var be=ee;ee=Y,Y=be;for(var Re=[],ge=2-~~((G-1)/3),we=0;we<3;we++)Re[we]=U>>14-we*2&3;var Ce=Re[ge];if(Ce!=0)for(var I=0;I<ne;I++)for(var O=0;O<W;O++){var X=I*q+O;ee[X]=ee[X]<<Ce}}}if(G==9&&D==3)for(var Fe=j[0],Ve=j[1],Ye=j[2],We=j[3],I=0;I<B;I+=2)for(var O=0;O<Z;O+=2){var Ie=I*Z+O,ae=(I>>>1)*(Z>>>1)+(O>>>1),Oe=Fe[ae],it=Ve[ae]-2048,at=Ye[ae]-2048,ht=We[ae]-2048,St=(it<<1)+Oe,Qt=(at<<1)+Oe,ln=Oe+ht,bt=Oe-ht;k[Ie]=u(St),k[Ie+1]=u(ln),k[Ie+Z]=u(bt),k[Ie+Z+1]=u(Qt)}v+=Ee*4}else if(pe==16388)v+=Ee*4;else if(!(me==8192||me==8448||me==9216))throw pe.toString(16)}}}}}}}}}console.log(Date.now()-S)}return _}(),t.decode._ljpeg_diff=function(a,i,s){var c=t.decode._getbithuff,r,d;return r=c(a,i,s[0],s),d=c(a,i,r,0),d&1<<r-1||(d-=(1<<r)-1),d},t.decode._decodeARW=function(a,i,s,c,r,d){var h=a.t256[0],m=a.t257[0],f=a.t258[0],g=a.isLE?t._binLE:t._binBE,x=h*m==c||h*m*1.5==c;if(!x){m+=8;var b=[s,0,0,0],A=new Uint16Array(32770),M=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],q,L,C,K,F,u=0,_=t.decode._ljpeg_diff;for(A[0]=15,C=q=0;q<18;q++)for(var y=32768>>>(M[q]>>>8),L=0;L<y;L++)A[++C]=M[q];for(K=h;K--;)for(F=0;F<m+1;F+=2)if(F==m&&(F=1),u+=_(i,b,A),F<m){var v=u&4095;t.decode._putsF(r,(F*h+K)*f,v<<16-f)}return}if(h*m*1.5==c){for(var q=0;q<c;q+=3){var T=i[s+q+0],k=i[s+q+1],P=i[s+q+2];r[d+q]=k<<4|T>>>4,r[d+q+1]=T<<4|P>>>4,r[d+q+2]=P<<4|k>>>4}return}var S=new Uint16Array(16),F,K,Q,Z,B,G,w,D,U,q,j,Y=new Uint8Array(h+1);for(F=0;F<m;F++){for(var J=0;J<h;J++)Y[J]=i[s++];for(j=0,K=0;K<h-30;j+=16){for(Z=2047&(Q=g.readUint(Y,j)),B=2047&Q>>>11,G=15&Q>>>22,w=15&Q>>>26,D=0;D<4&&128<<D<=Z-B;D++);for(U=30,q=0;q<16;q++)q==G?S[q]=Z:q==w?S[q]=B:(S[q]=((g.readUshort(Y,j+(U>>3))>>>(U&7)&127)<<D)+B,S[q]>2047&&(S[q]=2047),U+=7);for(q=0;q<16;q++,K+=2){var v=S[q]<<1;t.decode._putsF(r,(F*h+K)*f,v<<16-f)}K-=K&1?1:31}}},t.decode._decodeNikon=function(a,i,s,c,r,d,h){var m=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],f=a.t256[0],g=a.t257[0],x=a.t258[0],b=0,A=0,M=t.decode._make_decoder,L=t.decode._getbithuff,C=i[0].exifIFD.makerNote,u=C.t150?C.t150:C.t140,_=0,y=u[_++],v=u[_++];(y==73||v==88)&&(_+=2110),y==70&&(b=2),x==14&&(b+=3);for(var T=[[0,0],[0,0]],k=a.isLE?t._binLE:t._binBE,Q=0;Q<2;Q++)for(var P=0;P<2;P++)T[Q][P]=k.readShort(u,_),_+=2;var S=1<<x&32767,F=0,K=k.readShort(u,_);_+=2,K>1&&(F=Math.floor(S/(K-1))),y==68&&v==32&&F>0&&(A=k.readShort(u,562));var Q,Z,B,G,w,D,U=[0,0],q=M(m[b]),j=[c,0,0,0];for(Z=0;Z<g;Z++)for(A&&Z==A&&(q=M(m[b+1])),B=0;B<f;B++){Q=L(s,j,q[0],q),G=Q&15,w=Q>>>4,D=(L(s,j,G-w,0)<<1)+1<<w>>>1,D&1<<G-1||(D-=(1<<G)-(w==0?1:0)),B<2?U[B]=T[Z&1][B]+=D:U[B&1]+=D;var Y=Math.min(Math.max(U[B&1],0),(1<<x)-1),J=(Z*f+B)*x;t.decode._putsF(d,J,Y<<16-x)}},t.decode._putsF=function(a,i,s){s=s<<8-(i&7);var c=i>>>3;a[c]|=s>>>16,a[c+1]|=s>>>8,a[c+2]|=s},t.decode._getbithuff=function(a,i,s,c){var r=0;t.decode._get_byte;var d,h=i[0],m=i[1],f=i[2],g=i[3];if(s==0||f<0)return 0;for(;!g&&f<s&&(d=a[h++])!=-1&&!(g=r);)m=(m<<8)+d,f+=8;if(d=m<<32-f>>>32-s,c?(f-=c[d+1]>>>8,d=c[d+1]&255):f-=s,f<0)throw"e";return i[0]=h,i[1]=m,i[2]=f,i[3]=g,d},t.decode._make_decoder=function(a){var i,s,c,r,d,h=[];for(i=16;i!=0&&!a[i];i--);var m=17;for(h[0]=i,c=s=1;s<=i;s++)for(r=0;r<a[s];r++,++m)for(d=0;d<1<<i-s;d++)c<=1<<i&&(h[c++]=s<<8|a[m]);return h},t.decode._decodeNewJPEG=function(a,i,s,c,r,d){c=Math.min(c,i.length-s);var h=a.t347,m=h?h.length:0,f=new Uint8Array(m+c);if(h){for(var g=216,x=217,b=0,A=0;A<m-1&&!(h[A]==255&&h[A+1]==x);A++)f[b++]=h[A];var M=i[s],L=i[s+1];(M!=255||L!=g)&&(f[b++]=M,f[b++]=L);for(var A=2;A<c;A++)f[b++]=i[s+A]}else for(var A=0;A<c;A++)f[A]=i[s+A];if(a.t262[0]==32803||a.t259[0]==7&&a.t262[0]==34892){var C=a.t258[0],u=t.LosslessJpegDecode(f),_=u.length;if(C==16)if(a.isLE)for(var A=0;A<_;A++)r[d+(A<<1)]=u[A]&255,r[d+(A<<1)+1]=u[A]>>>8;else for(var A=0;A<_;A++)r[d+(A<<1)]=u[A]>>>8,r[d+(A<<1)+1]=u[A]&255;else if(C==14||C==12)for(var y=16-C,A=0;A<_;A++)t.decode._putsF(r,A*C,u[A]<<y);else if(C==8)for(var A=0;A<_;A++)r[d+A]=u[A];else throw new Error("unsupported bit depth "+C)}else{var v=new t.JpegDecoder;v.parse(f);for(var T=v.getData({width:v.width,height:v.height,forceRGB:!0,isSourcePDF:!1}),A=0;A<T.length;A++)r[d+A]=T[A]}a.t262[0]==6&&(a.t262[0]=2)},t.decode._decodeOldJPEGInit=function(a,i,s,c){var r=216,d=219,h=196,m=221,f=192,g=218,x=0,b=0,A,M,L=!1,C,u,_,y=a.t513,v=y?y[0]:0,T=a.t514,k=T?T[0]:0,P=a.t324||a.t273||y,S=a.t530,F=0,K=0,Q=a.t277?a.t277[0]:1,Z=a.t515;if(P&&(b=P[0],L=P.length>1),!L){if(i[s]==255&&i[s+1]==r)return{jpegOffset:s};if(y!=null&&(i[s+v]==255&&i[s+v+1]==r?x=s+v:o("JPEGInterchangeFormat does not point to SOI"),T==null?o("JPEGInterchangeFormatLength field is missing"):(v>=b||v+k<=b)&&o("JPEGInterchangeFormatLength field value is invalid"),x!=null))return{jpegOffset:x}}if(S!=null&&(F=S[0],K=S[1]),y!=null&&T!=null)if(k>=2&&v+k<=b){for(i[s+v+k-2]==255&&i[s+v+k-1]==r?A=new Uint8Array(k-2):A=new Uint8Array(k),C=0;C<A.length;C++)A[C]=i[s+v+C];o("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else o("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(A==null){var B=0,G=[];G[B++]=255,G[B++]=r;var w=a.t519;if(w==null)throw new Error("JPEGQTables tag is missing");for(C=0;C<w.length;C++)for(G[B++]=255,G[B++]=d,G[B++]=0,G[B++]=67,G[B++]=C,u=0;u<64;u++)G[B++]=i[s+w[C]+u];for(_=0;_<2;_++){var D=a[_==0?"t520":"t521"];if(D==null)throw new Error((_==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(C=0;C<D.length;C++){G[B++]=255,G[B++]=h;var U=19;for(u=0;u<16;u++)U+=i[s+D[C]+u];for(G[B++]=U>>>8,G[B++]=U&255,G[B++]=C|_<<4,u=0;u<16;u++)G[B++]=i[s+D[C]+u];for(u=0;u<U;u++)G[B++]=i[s+D[C]+16+u]}}if(G[B++]=255,G[B++]=f,G[B++]=0,G[B++]=8+3*Q,G[B++]=8,G[B++]=a.height>>>8&255,G[B++]=a.height&255,G[B++]=a.width>>>8&255,G[B++]=a.width&255,G[B++]=Q,Q==1)G[B++]=1,G[B++]=17,G[B++]=0;else for(C=0;C<3;C++)G[B++]=C+1,G[B++]=C!=0?17:(F&15)<<4|K&15,G[B++]=C;Z!=null&&Z[0]!=0&&(G[B++]=255,G[B++]=m,G[B++]=0,G[B++]=4,G[B++]=Z[0]>>>8&255,G[B++]=Z[0]&255),A=new Uint8Array(G)}var q=-1;for(C=0;C<A.length-1;){if(A[C]==255&&A[C+1]==f){q=C;break}C++}if(q==-1){var j=new Uint8Array(A.length+10+3*Q);j.set(A);var Y=A.length;if(q=A.length,A=j,A[Y++]=255,A[Y++]=f,A[Y++]=0,A[Y++]=8+3*Q,A[Y++]=8,A[Y++]=a.height>>>8&255,A[Y++]=a.height&255,A[Y++]=a.width>>>8&255,A[Y++]=a.width&255,A[Y++]=Q,Q==1)A[Y++]=1,A[Y++]=17,A[Y++]=0;else for(C=0;C<3;C++)A[Y++]=C+1,A[Y++]=C!=0?17:(F&15)<<4|K&15,A[Y++]=C}if(i[b]==255&&i[b+1]==g){var J=i[b+2]<<8|i[b+3];for(M=new Uint8Array(J+2),M[0]=i[b],M[1]=i[b+1],M[2]=i[b+2],M[3]=i[b+3],C=0;C<J-2;C++)M[C+4]=i[b+C+4]}else{M=new Uint8Array(8+2*Q);var oe=0;if(M[oe++]=255,M[oe++]=g,M[oe++]=0,M[oe++]=6+2*Q,M[oe++]=Q,Q==1)M[oe++]=1,M[oe++]=0;else for(C=0;C<3;C++)M[oe++]=C+1,M[oe++]=C<<4|C;M[oe++]=0,M[oe++]=63,M[oe++]=0}return{jpegOffset:s,tables:A,sosMarker:M,sofPosition:q}},t.decode._decodeOldJPEG=function(a,i,s,c,r,d){var h,m,f,g,x,b=t.decode._decodeOldJPEGInit(a,i,s,c);if(b.jpegOffset!=null)for(m=s+c-b.jpegOffset,g=new Uint8Array(m),h=0;h<m;h++)g[h]=i[b.jpegOffset+h];else{for(f=b.tables.length,g=new Uint8Array(f+b.sosMarker.length+c+2),g.set(b.tables),x=f,g[b.sofPosition+5]=a.height>>>8&255,g[b.sofPosition+6]=a.height&255,g[b.sofPosition+7]=a.width>>>8&255,g[b.sofPosition+8]=a.width&255,(i[s]!=255||i[s+1]!=SOS)&&(g.set(b.sosMarker,x),x+=sosMarker.length),h=0;h<c;h++)g[x++]=i[s+h];g[x++]=255,g[x++]=EOI}var A=new t.JpegDecoder;A.parse(g);for(var M=A.getData({width:A.width,height:A.height,forceRGB:!0,isSourcePDF:!1}),h=0;h<M.length;h++)r[d+h]=M[h];a.t262&&a.t262[0]==6&&(a.t262[0]=2)},t.decode._decodePackBits=function(a,i,s,c,r){for(var d=new Int8Array(a.buffer),h=new Int8Array(c.buffer),m=i+s;i<m;){var f=d[i];if(i++,f>=0&&f<128)for(var g=0;g<f+1;g++)h[r]=d[i],r++,i++;if(f>=-127&&f<0){for(var g=0;g<-f+1;g++)h[r]=d[i],r++;i++}}},t.decode._decodeThunder=function(a,i,s,c,r){for(var d=[0,1,0,-1],h=[0,1,2,3,0,-3,-2,-1],m=i+s,f=r*2,g=0;i<m;){var x=a[i],b=x>>>6,A=x&63;if(i++,b==3&&(g=A&15,c[f>>>1]|=g<<4*(1-f&1),f++),b==0)for(var M=0;M<A;M++)c[f>>>1]|=g<<4*(1-f&1),f++;if(b==2)for(var M=0;M<2;M++){var L=A>>>3*(1-M)&7;L!=4&&(g+=h[L],c[f>>>1]|=g<<4*(1-f&1),f++)}if(b==1)for(var M=0;M<3;M++){var L=A>>>2*(2-M)&3;L!=2&&(g+=d[L],c[f>>>1]|=g<<4*(1-f&1),f++)}}},t.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},t.decode._lens=function(){var a=function(f,g,x,b){for(var A=0;A<g.length;A++)f[g[A]]=x+A*b},i="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",s="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",c="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",r="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",d="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";i=i.split(","),s=s.split(","),c=c.split(","),r=r.split(","),d=d.split(",");var h={},m={};return a(h,i,0,1),a(h,c,64,64),a(h,d,1792,64),a(m,s,0,1),a(m,r,64,64),a(m,d,1792,64),[h,m]}(),t.decode._decodeG4=function(a,i,s,c,r,d,h){for(var m=t.decode,f=i<<3,g=0,x="",b=[],A=[],M=0;M<d;M++)A.push(0);A=m._makeDiff(A);for(var L=0,C=0,u=0,_=0,y=0,v=0,T="",k=0,P=Math.ceil(d/8)*8;f>>>3<i+s;){u=m._findDiff(A,L+(L==0?0:1),1-y),_=m._findDiff(A,u,y);var S=0;if(h==1&&(S=a[f>>>3]>>>7-(f&7)&1),h==2&&(S=a[f>>>3]>>>(f&7)&1),f++,x+=S,T=="H"){if(m._lens[y][x]!=null){var F=m._lens[y][x];x="",g+=F,F<64&&(m._addNtimes(b,g,y),L+=g,y=1-y,g=0,k--,k==0&&(T=""))}}else x=="0001"&&(x="",m._addNtimes(b,_-L,y),L=_),x=="001"&&(x="",T="H",k=2),m._dmap[x]!=null&&(C=u+m._dmap[x],m._addNtimes(b,C-L,y),L=C,x="",y=1-y);b.length==d&&T==""&&(m._writeBits(b,c,r*8+v*P),y=0,v++,L=0,A=m._makeDiff(b),b=[])}},t.decode._findDiff=function(a,i,s){for(var c=0;c<a.length;c+=2)if(a[c]>=i&&a[c+1]==s)return a[c]},t.decode._makeDiff=function(a){var i=[];a[0]==1&&i.push(0,1);for(var s=1;s<a.length;s++)a[s-1]!=a[s]&&i.push(s,a[s]);return i.push(a.length,0,a.length,1),i},t.decode._decodeG3=function(a,i,s,c,r,d,h,m){for(var f=t.decode,g=i<<3,x=0,b="",A=[],M=[],L=0;L<d;L++)A.push(0);for(var C=0,u=0,_=0,y=0,v=0,T=-1,k="",P=0,S=!0,F=Math.ceil(d/8)*8;g>>>3<i+s;){_=f._findDiff(M,C+(C==0?0:1),1-v),y=f._findDiff(M,_,v);var K=0;if(h==1&&(K=a[g>>>3]>>>7-(g&7)&1),h==2&&(K=a[g>>>3]>>>(g&7)&1),g++,b+=K,S){if(f._lens[v][b]!=null){var Q=f._lens[v][b];b="",x+=Q,Q<64&&(f._addNtimes(A,x,v),v=1-v,x=0)}}else if(k=="H"){if(f._lens[v][b]!=null){var Q=f._lens[v][b];b="",x+=Q,Q<64&&(f._addNtimes(A,x,v),C+=x,v=1-v,x=0,P--,P==0&&(k=""))}}else b=="0001"&&(b="",f._addNtimes(A,y-C,v),C=y),b=="001"&&(b="",k="H",P=2),f._dmap[b]!=null&&(u=_+f._dmap[b],f._addNtimes(A,u-C,v),C=u,b="",v=1-v);b.endsWith("000000000001")&&(T>=0&&f._writeBits(A,c,r*8+T*F),m&&(h==1&&(S=(a[g>>>3]>>>7-(g&7)&1)==1),h==2&&(S=(a[g>>>3]>>>(g&7)&1)==1),g++),b="",v=0,T++,C=0,M=f._makeDiff(A),A=[])}A.length==d&&f._writeBits(A,c,r*8+T*F)},t.decode._addNtimes=function(a,i,s){for(var c=0;c<i;c++)a.push(s)},t.decode._writeBits=function(a,i,s){for(var c=0;c<a.length;c++)i[s+c>>>3]|=a[c]<<7-(s+c&7)},t.decode._decodeLZW=t.decode._decodeLZW=function(){var a,i,s,c,r=0,d=0,h=0,m=0,f=function(){var u=a>>>3,_=i[u]<<16|i[u+1]<<8|i[u+2],y=_>>>24-(a&7)-d&(1<<d)-1;return a+=d,y},g=new Uint32Array(4096*4),x=0,b=function(u){if(u!=x){x=u,h=1<<u,m=h+1;for(var _=0;_<m+1;_++)g[4*_]=g[4*_+3]=_,g[4*_+1]=65535,g[4*_+2]=1}},A=function(u){d=u+1,r=m+1},M=function(u){for(var _=u<<2,y=g[_+2],v=c+y-1;_!=65535;)s[v--]=g[_],_=g[_+1];c+=y},L=function(u,_){var y=r<<2,v=u<<2;g[y]=g[(_<<2)+3],g[y+1]=v,g[y+2]=g[v+2]+1,g[y+3]=g[v+3],r++,r+1==1<<d&&d!=12&&d++},C=function(u,_,y,v,T,k){a=_<<3,i=u,s=v,c=T;var P=_+y<<3,S=0,F=0;for(b(k),A(k);a<P&&(S=f())!=m;){if(S==h){if(A(k),S=f(),S==m)break;M(S)}else S<r?(M(S),L(F,S)):(L(F,F),M(r-1));F=S}return c};return C}(),t.tags={},t._types=function(){var a=new Array(250);a.fill(0),a=a.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);var i={33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7};return{basic:{main:a,rest:i},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),t._readIFD=function(a,i,s,c,r,d){var h=a.readUshort(i,s);s+=2;var m={};d.debug&&o("   ".repeat(r),c.length-1,">>>----------------");for(var f=0;f<h;f++){var g=a.readUshort(i,s);s+=2;var x=a.readUshort(i,s);s+=2;var b=a.readUint(i,s);s+=4;var A=a.readUint(i,s);s+=4;var M=[];if((x==1||x==7)&&(M=new Uint8Array(i.buffer,b<5?s-4:A,b)),x==2){var L=b<5?s-4:A,C=i[L],u=Math.max(0,Math.min(b-1,i.length-L));C<128||u==0?M.push(a.readASCII(i,L,u)):M=new Uint8Array(i.buffer,L,u)}if(x==3)for(var _=0;_<b;_++)M.push(a.readUshort(i,(b<3?s-4:A)+2*_));if(x==4||x==13)for(var _=0;_<b;_++)M.push(a.readUint(i,(b<2?s-4:A)+4*_));if(x==5||x==10)for(var y=x==5?a.readUint:a.readInt,_=0;_<b;_++)M.push([y(i,A+_*8),y(i,A+_*8+4)]);if(x==8)for(var _=0;_<b;_++)M.push(a.readShort(i,(b<3?s-4:A)+2*_));if(x==9)for(var _=0;_<b;_++)M.push(a.readInt(i,(b<2?s-4:A)+4*_));if(x==11)for(var _=0;_<b;_++)M.push(a.readFloat(i,A+_*4));if(x==12)for(var _=0;_<b;_++)M.push(a.readDouble(i,A+_*8));if(b!=0&&M.length==0){if(o(g,"unknown TIFF tag type: ",x,"num:",b),f==0)return;continue}if(d.debug&&o("   ".repeat(r),g,x,t.tags[g],M),m["t"+g]=M,!(g==330&&m.t272&&m.t272[0]=="DSLR-A100")){if(g==330||g==34665||g==34853||g==50740&&a.readUshort(i,a.readUint(M,0))<300||g==61440){for(var v=g==50740?[a.readUint(M,0)]:M,T=[],_=0;_<v.length;_++)t._readIFD(a,i,v[_],T,r+1,d);g==330&&(m.subIFD=T),g==34665&&(m.exifIFD=T[0]),g==34853&&(m.gpsiIFD=T[0]),g==50740&&(m.dngPrvt=T[0]),g==61440&&(m.fujiIFD=T[0])}}if(g==37500&&d.parseMN){var k=M;if(a.readASCII(k,0,5)=="Nikon")m.makerNote=t.decode(k.slice(10).buffer)[0];else if(a.readUshort(i,A)<300&&a.readUshort(i,A+4)<=12){var P=[];t._readIFD(a,i,A,P,r+1,d),m.makerNote=P[0]}}}return c.push(m),d.debug&&o("   ".repeat(r),"<<<---------------"),s},t._writeIFD=function(a,i,s,c,r){var d=Object.keys(r),h=d.length;r.exifIFD&&h--,r.gpsiIFD&&h--,a.writeUshort(s,c,h),c+=2;for(var m=c+h*12+4,f=0;f<d.length;f++){var g=d[f];if(!(g=="t34665"||g=="t34853")){g=="exifIFD"&&(g="t34665"),g=="gpsiIFD"&&(g="t34853");var x=parseInt(g.slice(1)),b=i.main[x];if(b==null&&(b=i.rest[x]),b==null||b==0)throw new Error("unknown type of tag: "+x);var A=r[g];if(x==34665){var M=t._writeIFD(a,i,s,m,r.exifIFD);A=[m],m=M[1]}if(x==34853){var M=t._writeIFD(a,t._types.gps,s,m,r.gpsiIFD);A=[m],m=M[1]}b==2&&(A=A[0]+"\0");var L=A.length;a.writeUshort(s,c,x),c+=2,a.writeUshort(s,c,b),c+=2,a.writeUint(s,c,L),c+=4;var C=[-1,1,1,2,4,8,0,1,0,4,8,0,8][b]*L,u=c;if(C>4&&(a.writeUint(s,c,m),u=m),b==1||b==7)for(var _=0;_<L;_++)s[u+_]=A[_];else if(b==2)a.writeASCII(s,u,A);else if(b==3)for(var _=0;_<L;_++)a.writeUshort(s,u+2*_,A[_]);else if(b==4)for(var _=0;_<L;_++)a.writeUint(s,u+4*_,A[_]);else if(b==5||b==10)for(var y=b==5?a.writeUint:a.writeInt,_=0;_<L;_++){var v=A[_],T=v[0],k=v[1];if(T==null)throw"e";y(s,u+8*_,T),y(s,u+8*_+4,k)}else if(b==9)for(var _=0;_<L;_++)a.writeInt(s,u+4*_,A[_]);else if(b==12)for(var _=0;_<L;_++)a.writeDouble(s,u+8*_,A[_]);else throw b;C>4&&(C+=C&1,m+=C),c+=4}}return[c,m]},t.toRGBA8=function(a,i){var s=a.width,c=a.height,r=s*c,d=r*4,h=a.data,m=new Uint8Array(r*4),f=a.t262?a.t262[0]:2,g=a.t258?Math.min(32,a.t258[0]):1;if(a.t262==null&&g==1&&(f=0),f==0)for(var x=Math.ceil(g*s/8),b=0;b<c;b++){var A=b*x,M=b*s;if(g==1)for(var L=0;L<s;L++){var C=M+L<<2,u=h[A+(L>>3)]>>7-(L&7)&1;m[C]=m[C+1]=m[C+2]=(1-u)*255,m[C+3]=255}if(g==4)for(var L=0;L<s;L++){var C=M+L<<2,u=h[A+(L>>1)]>>4-4*(L&1)&15;m[C]=m[C+1]=m[C+2]=(15-u)*17,m[C+3]=255}if(g==8)for(var L=0;L<s;L++){var C=M+L<<2,u=h[A+L];m[C]=m[C+1]=m[C+2]=255-u,m[C+3]=255}}else if(f==1){var _=a.t258?a.t258.length:1,x=Math.ceil(_*g*s/8);i==null&&(i=1/256);for(var b=0;b<c;b++){var A=b*x,M=b*s;if(g==1)for(var L=0;L<s;L++){var C=M+L<<2,u=h[A+(L>>3)]>>7-(L&7)&1;m[C]=m[C+1]=m[C+2]=u*255,m[C+3]=255}if(g==2)for(var L=0;L<s;L++){var C=M+L<<2,u=h[A+(L>>2)]>>6-2*(L&3)&3;m[C]=m[C+1]=m[C+2]=u*85,m[C+3]=255}if(g==8)for(var L=0;L<s;L++){var C=M+L<<2,u=h[A+L*_];m[C]=m[C+1]=m[C+2]=u,m[C+3]=255}if(g==16)for(var L=0;L<s;L++){var C=M+L<<2,y=A+2*L,u=h[y+1]<<8|h[y];m[C]=m[C+1]=m[C+2]=Math.min(255,~~(u*i)),m[C+3]=255}}}else if(f==2){var _=a.t258?a.t258.length:3;if(g==8){if(_==4)for(var L=0;L<d;L++)m[L]=h[L];if(_==3)for(var L=0;L<r;L++){var C=L<<2,v=L*3;m[C]=h[v],m[C+1]=h[v+1],m[C+2]=h[v+2],m[C+3]=255}if(_==5)for(var L=0;L<r;L++){var C=L<<2,v=L*5;m[C]=h[v],m[C+1]=h[v+1],m[C+2]=h[v+2],m[C+3]=h[v+3]}}else{if(_==4)for(var L=0;L<r;L++){var C=L<<2,v=L*8+1;m[C]=h[v],m[C+1]=h[v+2],m[C+2]=h[v+4],m[C+3]=h[v+6]}if(_==3)for(var L=0;L<r;L++){var C=L<<2,v=L*6+1;m[C]=h[v],m[C+1]=h[v+2],m[C+2]=h[v+4],m[C+3]=255}}}else if(f==3)for(var T=a.t320,_=a.t258?a.t258.length:1,x=Math.ceil(_*g*s/8),k=1<<g,b=0;b<c;b++)for(var P=0;P<s;P++){var L=b*s+P,C=L<<2,S=0,F=b*x;if(g==1)S=h[F+(P>>>3)]>>>7-(P&7)&1;else if(g==2)S=h[F+(P>>>2)]>>>6-2*(P&3)&3;else if(g==4)S=h[F+(P>>>1)]>>>4-4*(P&1)&15;else if(g==8)S=h[F+P*_];else throw g;m[C]=T[S]>>8,m[C+1]=T[k+S]>>8,m[C+2]=T[k+k+S]>>8,m[C+3]=255}else if(f==5)for(var _=a.t258?a.t258.length:4,K=_>4?1:0,L=0;L<r;L++){var C=L<<2,Q=L*_,Z=255-h[Q],B=255-h[Q+1],G=255-h[Q+2],w=(255-h[Q+3])*(1/255);m[C]=~~(Z*w+.5),m[C+1]=~~(B*w+.5),m[C+2]=~~(G*w+.5),m[C+3]=255*(1-K)+h[Q+4]*K}else if(f==6&&a.t278)for(var D=a.t278[0],b=0;b<c;b+=D)for(var L=b*s,U=D*s,q=0;q<U;q++){var C=4*(L+q),Q=3*L+4*(q>>>1),G=h[Q+(q&1)],j=h[Q+2]-128,Y=h[Q+3]-128,J=G+((Y>>2)+(Y>>3)+(Y>>5)),oe=G-((j>>2)+(j>>4)+(j>>5))-((Y>>1)+(Y>>3)+(Y>>4)+(Y>>5)),pe=G+(j+(j>>1)+(j>>2)+(j>>6));m[C]=Math.max(0,Math.min(255,J)),m[C+1]=Math.max(0,Math.min(255,oe)),m[C+2]=Math.max(0,Math.min(255,pe)),m[C+3]=255}else o("Unknown Photometric interpretation: "+f);return m},t.replaceIMG=function(a){a==null&&(a=document.getElementsByTagName("img"));for(var i=["tif","tiff","dng","cr2","nef"],s=0;s<a.length;s++){var c=a[s],r=c.getAttribute("src");if(r!=null){var d=r.split(".").pop().toLowerCase();if(i.indexOf(d)!=-1){var h=new XMLHttpRequest;t._xhrs.push(h),t._imgs.push(c),h.open("GET",r),h.responseType="arraybuffer",h.onload=t._imgLoaded,h.send()}}}},t._xhrs=[],t._imgs=[],t._imgLoaded=function(a){var i=t._xhrs.indexOf(a.target),s=t._imgs[i];t._xhrs.splice(i,1),t._imgs.splice(i,1),s.setAttribute("src",t.bufferToURI(a.target.response))},t.bufferToURI=function(a){var i=t.decode(a),s=i,c=0,r=s[0];i[0].subIFD&&(s=s.concat(i[0].subIFD));for(var d=0;d<s.length;d++){var h=s[d];if(!(h.t258==null||h.t258.length<3)){var m=h.t256*h.t257;m>c&&(c=m,r=h)}}t.decodeImage(a,r,i);var f=t.toRGBA8(r),g=r.width,x=r.height,b=document.createElement("canvas");b.width=g,b.height=x;var A=b.getContext("2d"),M=new ImageData(new Uint8ClampedArray(f.buffer),g,x);return A.putImageData(M,0,0),b.toDataURL()},t._binBE={nextZero:function(a,i){for(;a[i]!=0;)i++;return i},readUshort:function(a,i){return a[i]<<8|a[i+1]},readShort:function(a,i){var s=t._binBE.ui8;return s[0]=a[i+1],s[1]=a[i+0],t._binBE.i16[0]},readInt:function(a,i){var s=t._binBE.ui8;return s[0]=a[i+3],s[1]=a[i+2],s[2]=a[i+1],s[3]=a[i+0],t._binBE.i32[0]},readUint:function(a,i){var s=t._binBE.ui8;return s[0]=a[i+3],s[1]=a[i+2],s[2]=a[i+1],s[3]=a[i+0],t._binBE.ui32[0]},readASCII:function(a,i,s){for(var c="",r=0;r<s;r++)c+=String.fromCharCode(a[i+r]);return c},readFloat:function(a,i){for(var s=t._binBE.ui8,c=0;c<4;c++)s[c]=a[i+3-c];return t._binBE.fl32[0]},readDouble:function(a,i){for(var s=t._binBE.ui8,c=0;c<8;c++)s[c]=a[i+7-c];return t._binBE.fl64[0]},writeUshort:function(a,i,s){a[i]=s>>8&255,a[i+1]=s&255},writeInt:function(a,i,s){var c=t._binBE.ui8;t._binBE.i32[0]=s,a[i+3]=c[0],a[i+2]=c[1],a[i+1]=c[2],a[i+0]=c[3]},writeUint:function(a,i,s){a[i]=s>>24&255,a[i+1]=s>>16&255,a[i+2]=s>>8&255,a[i+3]=s>>0&255},writeASCII:function(a,i,s){for(var c=0;c<s.length;c++)a[i+c]=s.charCodeAt(c)},writeDouble:function(a,i,s){t._binBE.fl64[0]=s;for(var c=0;c<8;c++)a[i+c]=t._binBE.ui8[7-c]}},t._binBE.ui8=new Uint8Array(8),t._binBE.i16=new Int16Array(t._binBE.ui8.buffer),t._binBE.i32=new Int32Array(t._binBE.ui8.buffer),t._binBE.ui32=new Uint32Array(t._binBE.ui8.buffer),t._binBE.fl32=new Float32Array(t._binBE.ui8.buffer),t._binBE.fl64=new Float64Array(t._binBE.ui8.buffer),t._binLE={nextZero:t._binBE.nextZero,readUshort:function(a,i){return a[i+1]<<8|a[i]},readShort:function(a,i){var s=t._binBE.ui8;return s[0]=a[i+0],s[1]=a[i+1],t._binBE.i16[0]},readInt:function(a,i){var s=t._binBE.ui8;return s[0]=a[i+0],s[1]=a[i+1],s[2]=a[i+2],s[3]=a[i+3],t._binBE.i32[0]},readUint:function(a,i){var s=t._binBE.ui8;return s[0]=a[i+0],s[1]=a[i+1],s[2]=a[i+2],s[3]=a[i+3],t._binBE.ui32[0]},readASCII:t._binBE.readASCII,readFloat:function(a,i){for(var s=t._binBE.ui8,c=0;c<4;c++)s[c]=a[i+c];return t._binBE.fl32[0]},readDouble:function(a,i){for(var s=t._binBE.ui8,c=0;c<8;c++)s[c]=a[i+c];return t._binBE.fl64[0]},writeUshort:function(a,i,s){a[i]=s&255,a[i+1]=s>>8&255},writeInt:function(a,i,s){var c=t._binBE.ui8;t._binBE.i32[0]=s,a[i+0]=c[0],a[i+1]=c[1],a[i+2]=c[2],a[i+3]=c[3]},writeUint:function(a,i,s){a[i]=s>>>0&255,a[i+1]=s>>>8&255,a[i+2]=s>>>16&255,a[i+3]=s>>>24&255},writeASCII:t._binBE.writeASCII},t._copyTile=function(a,i,s,c,r,d,h,m){for(var f=Math.min(i,r-h),g=Math.min(s,d-m),x=0;x<g;x++)for(var b=(m+x)*r+h,A=x*i,M=0;M<f;M++)c[b+M]=a[A+M]},t.LosslessJpegDecode=function(){var a,i,s,c,r,d,h,m,f,g;function x(){return a[i++]}function b(){return a[i++]<<8|a[i++]}function A(){for(var S=x(),F=[0,0,0,255],K=[],Q=8,Z=0;Z<16;Z++)K[Z]=x();for(var Z=0;Z<16;Z++)for(var B=0;B<K[Z];B++){var G=M(F,0,Z+1,1);F[G+3]=x()}var w=new Uint8Array(1<<Q);f[S]=[new Uint8Array(F),w];for(var Z=0;Z<1<<Q;Z++){for(var D=Q,U=Z,q=0,j=0;F[q+3]==255&&D!=0;)j=U>>--D&1,q=F[q+j];w[Z]=q}}function M(S,F,K,Q){if(S[F+3]!=255)return 0;if(K==0)return F;for(var Z=0;Z<2;Z++){S[F+Z]==0&&(S[F+Z]=S.length,S.push(0,0,Q,255));var B=M(S,S[F+Z],K-1,Q+1);if(B!=0)return B}return 0}function L(S){for(var F=S.e,K=S.c;F<25&&S.a<S.d;){var Q=S.data[S.a++];S.b||(S.a+=Q+1>>>8),K=K<<8|Q,F+=8}S.e=F,S.c=K}function C(S,F){return F.e<S&&L(F),F.c>>(F.e-=S)&65535>>16-S}function u(S,F){var K=S[0],Q=0,Z=255,B=0;F.e<16&&L(F);var G=F.c>>F.e-8&255;for(Q=S[1][G],Z=K[Q+3],F.e-=K[Q+2];Z==255;)B=F.c>>--F.e&1,Q=K[Q+B],Z=K[Q+3];return Z}function _(S,F){return S<32768>>16-F&&(S+=-(1<<F)+1),S}function y(S,F){var K=u(S,F);if(K==0)return 0;if(K==16)return-32768;var Q=C(K,F);return _(Q,K)}function v(S,F,K){for(var Q=d,Z=c,B=h,G=g,w=0;w<Q;w++)S[w]=y(G[w],K)+(1<<s-1);for(var D=Q;D<F;D+=Q)for(var w=0;w<Q;w++)S[D+w]=y(G[w],K)+S[D+w-Q];for(var U=F,q=1;q<Z;q++){for(var w=0;w<Q;w++)S[U+w]=y(G[w],K)+S[U+w-F];for(var D=Q;D<F;D+=Q)for(var w=0;w<Q;w++){var j=U+D+w,Y=S[j-Q],J=0;if(B==0)J=0;else if(B==1)J=Y;else if(B==2)J=S[j-F];else if(B==3)J=S[j-F-Q];else if(B==4)J=Y+(S[j-F]-S[j-F-Q]);else if(B==5)J=Y+(S[j-F]-S[j-F-Q]>>>1);else if(B==6)J=S[j-F]+(Y-S[j-F-Q]>>>1);else if(B==7)J=Y+S[j-F]>>>1;else throw B;S[j]=J+y(G[w],K)}U+=F}}function T(S,F){return _(C(S,F),S)}function k(S,F,K){for(var Q=a.length-i,Z=0;Z<Q;Z+=4){var B=a[i+Z];a[i+Z]=a[i+Z+3],a[i+Z+3]=B;var B=a[i+Z+1];a[i+Z+1]=a[i+Z+2],a[i+Z+2]=B}for(var G=g[0],w=0;w<c;w++)for(var D=32768,U=32768,q=0;q<F;q+=2){var j=u(G,K),Y=u(G,K);j!=0&&(D+=T(j,K)),Y!=0&&(U+=T(Y,K)),S[w*F+q]=D&65535,S[w*F+q+1]=U&65535}}function P(S){if(a=S,i=0,f=[],g=[],b()!=65496)throw"e";for(;;){var F=b();if(F==65535){i--;continue}var K=b();if(F==65475){s=x(),c=b(),r=b(),d=x(),m=[];for(var Q=0;Q<d;Q++){var Z=x(),B=x();if(B!=17)throw"e";var G=x();if(G!=0)throw"e";m[Z]=Q}}else if(F==65476)for(var w=i+K-2;i<w;)A();else if(F==65498){i++;for(var Q=0;Q<d;Q++){var D=x();g[m[D]]=f[x()>>>4]}h=x(),i+=2;break}else i+=K-2}var U=s>8?Uint16Array:Uint8Array,q=r*d,j=new U(c*q),Y={e:0,c:0,b:h==8,a:i,data:a,d:a.length};return Y.b?k(j,q,Y):v(j,q,Y),j}return P}(),function(){var a=0,i=1,s=2,c=3,r=4,d=5,h=6,m=7,f=8,g=9,x=10,b=11,A=12,M=13,L=14,C=15,u=16,_=17,y=18;function v(j){var Y=t._binBE.readUshort,J={m:Y(j,0),f:j[2],r:j[3],a:j[4],d:Y(j,5),t:Y(j,7),h:Y(j,9),n:Y(j,11),v:j[13],p:Y(j,14)};if(J.m!=18771||J.f>1||J.d<6||J.d%6||J.h<768||J.h%24||J.n!=768||J.t<J.n||J.t%J.n||J.t-J.h>=J.n||J.v>16||J.v!=J.t/J.n||J.v!=Math.ceil(J.h/J.n)||J.p!=J.d/6||J.a!=12&&J.a!=14&&J.a!=16||J.r!=16&&J.r!=0)throw"Invalid data";if(J.f==0)throw"Not implemented. We need this file!";return J.o=J.r==16,J.c=(J.o?J.n*2/3:J.n>>>1)|0,J.g=J.c+2,J.q=64,J.j=(1<<J.a)-1,J.w=4*J.a,J}function T(j,Y){for(var J=new Array(Y.v),oe=16+4*Y.v,pe=0,me=16;pe<Y.v;me+=4){var Ee=t._binBE.readUint(j,me);J[pe]=j.slice(oe,oe+Ee),J[pe].l=0,J[pe].s=0,oe+=Ee,pe++}if(oe!=j.length)throw"Invalid data";return J}function k(j,Y){for(var J=-Y[4],oe=0;J<=Y[4];oe++,J++)j[oe]=J<=-Y[3]?-4:J<=-Y[2]?-3:J<=-Y[1]?-2:J<-Y[0]?-1:J<=Y[0]?0:J<Y[1]?1:J<Y[2]?2:J<Y[3]?3:4}function P(j,Y,J){var oe=[Y,3*Y+18,5*Y+67,7*Y+276,J];j.k=Y,j.i=(oe[4]+2*Y)/(2*Y+1)+1|0,j.b=Math.ceil(Math.log2(j.i)),j.e=9,k(j.u,oe)}function S(j){var Y={u:new Int8Array(2<<j.a)};return P(Y,0,j.j),Y}function F(j){for(var Y=[[],[],[]],J=Math.max(2,j.i+32>>>6),oe=0;oe<3;oe++)for(var pe=0;pe<41;pe++)Y[oe][pe]=[J,1];return Y}function K(j){for(var Y=-1,J=0;!J;Y++)J=j[j.l]>>>7-j.s&1,j.s++,j.s&=7,j.s||j.l++;return Y}function Q(j,Y){var J=0,oe=8-j.s;if(j.l,j.s,Y){if(Y>=oe)do J<<=oe,Y-=oe,J|=j[j.l]&(1<<oe)-1,j.l++,oe=8;while(Y>=8);Y&&(J<<=Y,oe-=Y,J|=j[j.l]>>>oe&(1<<Y)-1),j.s=8-oe}return J}function Z(j,Y){var J=0;if(Y<j)for(;J<=14&&Y<<++J<j;);return J}function B(j,Y,J,oe,pe,me,Ee,X){X==null&&(X=0);var N=me+1,te=N%2,re=0,se,ve,ee=oe[pe],le=oe[pe-1],H=oe[pe-2][N],I=le[N-1],O=le[N],ae=le[N+1],_e=ee[N-1],Ae=ee[N+1],Se=Math.abs,ze,Xe,Ue,Ze;if(te&&(ze=Se(ae-O),Xe=Se(H-O),Ue=Se(I-O)),te){if(Ze=ze>Ue&&Xe<ze?H+I:ze<Ue&&Xe<Ue?H+ae:ae+I,Ze=Ze+2*O>>>2,X){ee[N]=Ze;return}se=Y.e*Y.u[j.j+O-H]+Y.u[j.j+I-O]}else Ze=O>I&&O>ae||O<I&&O<ae?Ae+_e+2*O>>>2:_e+Ae>>>1,se=Y.e*Y.u[j.j+O-I]+Y.u[j.j+I-_e];ve=Se(se);var He=K(J);if(He<j.w-Y.b-1){var Je=Z(Ee[ve][0],Ee[ve][1]);re=Q(J,Je)+(He<<Je)}else re=Q(J,Y.b)+1;re=re&1?-1-(re>>>1):re>>>1,Ee[ve][0]+=Se(re),Ee[ve][1]==j.q&&(Ee[ve][0]>>>=1,Ee[ve][1]>>>=1),Ee[ve][1]++,Ze=se<0?Ze-re:Ze+re,j.f&&(Ze<0?Ze+=Y.i:Ze>j.j&&(Ze-=Y.i)),ee[N]=Ze>=0?Math.min(Ze,j.j):0}function G(j,Y,J){for(var oe=j[0].length,pe=Y;pe<=J;pe++)j[pe][0]=j[pe-1][1],j[pe][oe-1]=j[pe-1][oe-2]}function w(j){G(j,m,A),G(j,s,r),G(j,C,_)}function D(j,Y,J,oe,pe,me,Ee,X,N,te,re,se,ve){for(var ee=0,le=1,H=pe<M&&pe>r;le<j.c;)ee<j.c&&(B(j,Y,J,oe,pe,ee,Ee[N],j.o&&(H&&te||!H&&(re||(ee&se)==ve))),B(j,Y,J,oe,me,ee,Ee[N],j.o&&(!H&&te||H&&(re||(ee&se)==ve))),ee+=2),ee>8&&(B(j,Y,J,oe,pe,le,X[N]),B(j,Y,J,oe,me,le,X[N]),le+=2);w(oe)}function U(j,Y,J,oe,pe,me){D(j,Y,J,oe,s,m,pe,me,0,0,1,0,8),D(j,Y,J,oe,f,C,pe,me,1,0,1,0,8),D(j,Y,J,oe,c,g,pe,me,2,1,0,3,0),D(j,Y,J,oe,x,u,pe,me,0,0,0,3,2),D(j,Y,J,oe,r,b,pe,me,1,0,0,3,2),D(j,Y,J,oe,A,_,pe,me,2,1,0,3,0)}function q(j,Y,J,oe,pe,me){var Ee=me.length,X=j.n;pe+1==j.v&&(X=j.h-pe*j.n);for(var N=6*j.h*oe+pe*j.n,te=0;te<6;te++){for(var re=0;re<X;re++){var se=me[te%Ee][re%Ee],ve;se==0?ve=s+(te>>>1):se==2?ve=C+(te>>>1):ve=m+te;var ee=j.o?(re*2/3&2147483646|re%3&1)+(re%3>>>1):re>>>1;Y[N+re]=J[ve][ee+1]}N+=j.h}}t._decompressRAF=function(j,Y){var J=v(j),oe=T(j,J),pe=S(J),me=new Int16Array(J.h*J.d);Y==null&&(Y=J.o?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var Ee=[[a,c],[i,r],[d,b],[h,A],[M,u],[L,_]],X=[],N=0;N<y;N++)X[N]=new Uint16Array(J.g);for(var te=0;te<J.v;te++){for(var re=F(pe),se=F(pe),N=0;N<y;N++)for(var ve=0;ve<J.g;ve++)X[N][ve]=0;for(var ee=0;ee<J.p;ee++){U(J,pe,oe[te],X,re,se);for(var N=0;N<6;N++)for(var ve=0;ve<J.g;ve++)X[Ee[N][0]][ve]=X[Ee[N][1]][ve];q(J,me,X,ee,te,Y);for(var N=s;N<y;N++)if([d,h,M,L].indexOf(N)==-1)for(var ve=0;ve<J.g;ve++)X[N][ve]=0;w(X)}}return me}}()})(e,n)})();/**
 * Based on: https://github.com/shaozilee/bmp-js/blob/db2c466ca1869ddc09e4b2143404eb03ecd490db/lib/encoder.js
 * @author shaozilee
 * @author 1j01
 * @license MIT
 *
 * BMP format encoder, encodes 24bit, 8bit, 4bit, and 1bit BMP files.
 * Doesn't support compression.
 *
 *//**
 * Based on: https://github.com/hipstersmoothie/bmp-ts
 * @license MIT
 */const HeaderTypes={};HeaderTypes[HeaderTypes.BITMAP_INFO_HEADER=40]="BITMAP_INFO_HEADER";HeaderTypes[HeaderTypes.BITMAP_V2_INFO_HEADER=52]="BITMAP_V2_INFO_HEADER";HeaderTypes[HeaderTypes.BITMAP_V3_INFO_HEADER=56]="BITMAP_V3_INFO_HEADER";HeaderTypes[HeaderTypes.BITMAP_V4_HEADER=108]="BITMAP_V4_HEADER";HeaderTypes[HeaderTypes.BITMAP_V5_HEADER=124]="BITMAP_V5_HEADER";Object.freeze(HeaderTypes);/**
 * Modules in this bundle
 * @license
 *
 * anypalette:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Isaiah Odhner <isaiahodhner@gmail.com>
 *   homepage: https://1j01.github.io/anypalette.js/
 *   version: 0.6.0
 *
 * base64-js:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: T. Jameson Little <t.jameson.little@gmail.com>
 *   homepage: https://github.com/beatgammit/base64-js
 *   version: 1.5.1
 *
 * browser-resolve:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Roman Shtylman <shtylman@gmail.com>
 *   homepage: https://github.com/browserify/browser-resolve#readme
 *   version: 2.0.0
 *
 * buffer:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Feross Aboukhadijeh <feross@feross.org>
 *   contributors: Romain Beauxis <toots@rastageeks.org>, James Halliday <mail@substack.net>
 *   homepage: https://github.com/feross/buffer
 *   version: 5.2.1
 *
 * css.escape:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Mathias Bynens
 *   homepage: https://mths.be/cssescape
 *   version: 1.5.1
 *
 * events:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Irakli Gozalishvili <rfobic@gmail.com>
 *   homepage: https://github.com/Gozala/events#readme
 *   version: 3.2.0
 *
 * ieee754:
 *   license: BSD-3-Clause (http://opensource.org/licenses/BSD-3-Clause)
 *   author: Feross Aboukhadijeh <feross@feross.org>
 *   contributors: Romain Beauxis <toots@rastageeks.org>
 *   homepage: https://github.com/feross/ieee754#readme
 *   version: 1.2.1
 *
 * inherits:
 *   license: ISC (http://opensource.org/licenses/ISC)
 *   homepage: https://github.com/isaacs/inherits#readme
 *   version: 2.0.4
 *
 * jdataview:
 *   licenses: WTFPL (http://www.wtfpl.net/about/)
 *   author: Vjeux <vjeuxx@gmail.com>
 *   contributors: Vjeux <vjeuxx@gmail.com>, RReverser <me@rreverser.com>
 *   homepage: http://jDataView.github.io/
 *   version: 2.5.0
 *
 * process:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Roman Shtylman <shtylman@gmail.com>
 *   homepage: https://github.com/shtylman/node-process#readme
 *   version: 0.11.10
 *
 * readable-stream:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   homepage: https://github.com/nodejs/readable-stream#readme
 *   version: 3.6.0
 *
 * safe-buffer:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Feross Aboukhadijeh <feross@feross.org>
 *   homepage: https://github.com/feross/safe-buffer
 *   version: 5.1.2
 *
 * sax:
 *   license: ISC (http://opensource.org/licenses/ISC)
 *   author: Isaac Z. Schlueter <i@izs.me>
 *   homepage: https://github.com/isaacs/sax-js#readme
 *   version: 1.2.4
 *
 * stream-browserify:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: James Halliday <mail@substack.net>
 *   homepage: https://github.com/browserify/stream-browserify
 *   version: 3.0.0
 *
 * string_decoder:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   homepage: https://github.com/nodejs/string_decoder
 *   version: 1.1.1
 *
 * util-deprecate:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Nathan Rajlich <nathan@tootallnate.net>
 *   homepage: https://github.com/TooTallNate/util-deprecate
 *   version: 1.0.2
 *
 * xml-js:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Yousuf Almarzooqi <ysf953@gmail.com>
 *   homepage: https://github.com/nashwaan/xml-js#readme
 *   version: 1.6.11
 *
 * This header is generated by licensify (https://github.com/twada/licensify)
 */(function(e){if(typeof exports=="object"&&typeof module<"u")module.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var n;typeof window<"u"?n=window:typeof global<"u"?n=global:typeof self<"u"?n=self:n=this,n.AnyPalette=e()}})(function(){return function(){function e(n,o,t){function l(s,c){if(!o[s]){if(!n[s]){var r=typeof require=="function"&&require;if(!c&&r)return r(s,!0);if(a)return a(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var h=o[s]={exports:{}};n[s][0].call(h.exports,function(m){var f=n[s][1][m];return l(f||m)},h,h.exports,e,n,o,t)}return o[s].exports}for(var a=typeof require=="function"&&require,i=0;i<t.length;i++)l(t[i]);return l}return e}()({1:[function(e,n,o){o.byteLength=d,o.toByteArray=m,o.fromByteArray=x;for(var t=[],l=[],a=typeof Uint8Array<"u"?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=i.length;s<c;++s)t[s]=i[s],l[i.charCodeAt(s)]=s;l[45]=62,l[95]=63;function r(b){var A=b.length;if(A%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var M=b.indexOf("=");M===-1&&(M=A);var L=M===A?0:4-M%4;return[M,L]}function d(b){var A=r(b),M=A[0],L=A[1];return(M+L)*3/4-L}function h(b,A,M){return(A+M)*3/4-M}function m(b){var A,M=r(b),L=M[0],C=M[1],u=new a(h(b,L,C)),_=0,y=C>0?L-4:L,v;for(v=0;v<y;v+=4)A=l[b.charCodeAt(v)]<<18|l[b.charCodeAt(v+1)]<<12|l[b.charCodeAt(v+2)]<<6|l[b.charCodeAt(v+3)],u[_++]=A>>16&255,u[_++]=A>>8&255,u[_++]=A&255;return C===2&&(A=l[b.charCodeAt(v)]<<2|l[b.charCodeAt(v+1)]>>4,u[_++]=A&255),C===1&&(A=l[b.charCodeAt(v)]<<10|l[b.charCodeAt(v+1)]<<4|l[b.charCodeAt(v+2)]>>2,u[_++]=A>>8&255,u[_++]=A&255),u}function f(b){return t[b>>18&63]+t[b>>12&63]+t[b>>6&63]+t[b&63]}function g(b,A,M){for(var L,C=[],u=A;u<M;u+=3)L=(b[u]<<16&16711680)+(b[u+1]<<8&65280)+(b[u+2]&255),C.push(f(L));return C.join("")}function x(b){for(var A,M=b.length,L=M%3,C=[],u=16383,_=0,y=M-L;_<y;_+=u)C.push(g(b,_,_+u>y?y:_+u));return L===1?(A=b[M-1],C.push(t[A>>2]+t[A<<4&63]+"==")):L===2&&(A=(b[M-2]<<8)+b[M-1],C.push(t[A>>10]+t[A>>4&63]+t[A<<2&63]+"=")),C.join("")}},{}],2:[function(e,n,o){},{}],3:[function(e,n,o){(function(t){(function(){var l=e("base64-js"),a=e("ieee754");o.Buffer=r,o.SlowBuffer=L,o.INSPECT_MAX_BYTES=50;var i=2147483647;o.kMaxLength=i,r.TYPED_ARRAY_SUPPORT=s(),!r.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{var H=new Uint8Array(1);return H.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},H.foo()===42}catch{return!1}}Object.defineProperty(r.prototype,"parent",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.buffer}}),Object.defineProperty(r.prototype,"offset",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.byteOffset}});function c(H){if(H>i)throw new RangeError('The value "'+H+'" is invalid for option "size"');var I=new Uint8Array(H);return I.__proto__=r.prototype,I}function r(H,I,O){if(typeof H=="number"){if(typeof I=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(H)}return d(H,I,O)}typeof Symbol<"u"&&Symbol.species!=null&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192;function d(H,I,O){if(typeof H=="string")return g(H,I);if(ArrayBuffer.isView(H))return x(H);if(H==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof H);if(ee(H,ArrayBuffer)||H&&ee(H.buffer,ArrayBuffer))return b(H,I,O);if(typeof H=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ae=H.valueOf&&H.valueOf();if(ae!=null&&ae!==H)return r.from(ae,I,O);var _e=A(H);if(_e)return _e;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof H[Symbol.toPrimitive]=="function")return r.from(H[Symbol.toPrimitive]("string"),I,O);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof H)}r.from=function(H,I,O){return d(H,I,O)},r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array;function h(H){if(typeof H!="number")throw new TypeError('"size" argument must be of type number');if(H<0)throw new RangeError('The value "'+H+'" is invalid for option "size"')}function m(H,I,O){return h(H),H<=0?c(H):I!==void 0?typeof O=="string"?c(H).fill(I,O):c(H).fill(I):c(H)}r.alloc=function(H,I,O){return m(H,I,O)};function f(H){return h(H),c(H<0?0:M(H)|0)}r.allocUnsafe=function(H){return f(H)},r.allocUnsafeSlow=function(H){return f(H)};function g(H,I){if((typeof I!="string"||I==="")&&(I="utf8"),!r.isEncoding(I))throw new TypeError("Unknown encoding: "+I);var O=C(H,I)|0,ae=c(O),_e=ae.write(H,I);return _e!==O&&(ae=ae.slice(0,_e)),ae}function x(H){for(var I=H.length<0?0:M(H.length)|0,O=c(I),ae=0;ae<I;ae+=1)O[ae]=H[ae]&255;return O}function b(H,I,O){if(I<0||H.byteLength<I)throw new RangeError('"offset" is outside of buffer bounds');if(H.byteLength<I+(O||0))throw new RangeError('"length" is outside of buffer bounds');var ae;return I===void 0&&O===void 0?ae=new Uint8Array(H):O===void 0?ae=new Uint8Array(H,I):ae=new Uint8Array(H,I,O),ae.__proto__=r.prototype,ae}function A(H){if(r.isBuffer(H)){var I=M(H.length)|0,O=c(I);return O.length===0||H.copy(O,0,0,I),O}if(H.length!==void 0)return typeof H.length!="number"||le(H.length)?c(0):x(H);if(H.type==="Buffer"&&Array.isArray(H.data))return x(H.data)}function M(H){if(H>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return H|0}function L(H){return+H!=H&&(H=0),r.alloc(+H)}r.isBuffer=function(I){return I!=null&&I._isBuffer===!0&&I!==r.prototype},r.compare=function(I,O){if(ee(I,Uint8Array)&&(I=r.from(I,I.offset,I.byteLength)),ee(O,Uint8Array)&&(O=r.from(O,O.offset,O.byteLength)),!r.isBuffer(I)||!r.isBuffer(O))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===O)return 0;for(var ae=I.length,_e=O.length,Ae=0,Se=Math.min(ae,_e);Ae<Se;++Ae)if(I[Ae]!==O[Ae]){ae=I[Ae],_e=O[Ae];break}return ae<_e?-1:_e<ae?1:0},r.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(I,O){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(I.length===0)return r.alloc(0);var ae;if(O===void 0)for(O=0,ae=0;ae<I.length;++ae)O+=I[ae].length;var _e=r.allocUnsafe(O),Ae=0;for(ae=0;ae<I.length;++ae){var Se=I[ae];if(ee(Se,Uint8Array)&&(Se=r.from(Se)),!r.isBuffer(Se))throw new TypeError('"list" argument must be an Array of Buffers');Se.copy(_e,Ae),Ae+=Se.length}return _e};function C(H,I){if(r.isBuffer(H))return H.length;if(ArrayBuffer.isView(H)||ee(H,ArrayBuffer))return H.byteLength;if(typeof H!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof H);var O=H.length,ae=arguments.length>2&&arguments[2]===!0;if(!ae&&O===0)return 0;for(var _e=!1;;)switch(I){case"ascii":case"latin1":case"binary":return O;case"utf8":case"utf-8":return N(H).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O*2;case"hex":return O>>>1;case"base64":return se(H).length;default:if(_e)return ae?-1:N(H).length;I=(""+I).toLowerCase(),_e=!0}}r.byteLength=C;function u(H,I,O){var ae=!1;if((I===void 0||I<0)&&(I=0),I>this.length||((O===void 0||O>this.length)&&(O=this.length),O<=0)||(O>>>=0,I>>>=0,O<=I))return"";for(H||(H="utf8");;)switch(H){case"hex":return U(this,I,O);case"utf8":case"utf-8":return Z(this,I,O);case"ascii":return w(this,I,O);case"latin1":case"binary":return D(this,I,O);case"base64":return Q(this,I,O);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,I,O);default:if(ae)throw new TypeError("Unknown encoding: "+H);H=(H+"").toLowerCase(),ae=!0}}r.prototype._isBuffer=!0;function _(H,I,O){var ae=H[I];H[I]=H[O],H[O]=ae}r.prototype.swap16=function(){var I=this.length;if(I%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var O=0;O<I;O+=2)_(this,O,O+1);return this},r.prototype.swap32=function(){var I=this.length;if(I%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var O=0;O<I;O+=4)_(this,O,O+3),_(this,O+1,O+2);return this},r.prototype.swap64=function(){var I=this.length;if(I%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var O=0;O<I;O+=8)_(this,O,O+7),_(this,O+1,O+6),_(this,O+2,O+5),_(this,O+3,O+4);return this},r.prototype.toString=function(){var I=this.length;return I===0?"":arguments.length===0?Z(this,0,I):u.apply(this,arguments)},r.prototype.toLocaleString=r.prototype.toString,r.prototype.equals=function(I){if(!r.isBuffer(I))throw new TypeError("Argument must be a Buffer");return this===I?!0:r.compare(this,I)===0},r.prototype.inspect=function(){var I="",O=o.INSPECT_MAX_BYTES;return I=this.toString("hex",0,O).replace(/(.{2})/g,"$1 ").trim(),this.length>O&&(I+=" ... "),"<Buffer "+I+">"},r.prototype.compare=function(I,O,ae,_e,Ae){if(ee(I,Uint8Array)&&(I=r.from(I,I.offset,I.byteLength)),!r.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(O===void 0&&(O=0),ae===void 0&&(ae=I?I.length:0),_e===void 0&&(_e=0),Ae===void 0&&(Ae=this.length),O<0||ae>I.length||_e<0||Ae>this.length)throw new RangeError("out of range index");if(_e>=Ae&&O>=ae)return 0;if(_e>=Ae)return-1;if(O>=ae)return 1;if(O>>>=0,ae>>>=0,_e>>>=0,Ae>>>=0,this===I)return 0;for(var Se=Ae-_e,ze=ae-O,Xe=Math.min(Se,ze),Ue=this.slice(_e,Ae),Ze=I.slice(O,ae),He=0;He<Xe;++He)if(Ue[He]!==Ze[He]){Se=Ue[He],ze=Ze[He];break}return Se<ze?-1:ze<Se?1:0};function y(H,I,O,ae,_e){if(H.length===0)return-1;if(typeof O=="string"?(ae=O,O=0):O>2147483647?O=2147483647:O<-2147483648&&(O=-2147483648),O=+O,le(O)&&(O=_e?0:H.length-1),O<0&&(O=H.length+O),O>=H.length){if(_e)return-1;O=H.length-1}else if(O<0)if(_e)O=0;else return-1;if(typeof I=="string"&&(I=r.from(I,ae)),r.isBuffer(I))return I.length===0?-1:v(H,I,O,ae,_e);if(typeof I=="number")return I=I&255,typeof Uint8Array.prototype.indexOf=="function"?_e?Uint8Array.prototype.indexOf.call(H,I,O):Uint8Array.prototype.lastIndexOf.call(H,I,O):v(H,[I],O,ae,_e);throw new TypeError("val must be string, number or Buffer")}function v(H,I,O,ae,_e){var Ae=1,Se=H.length,ze=I.length;if(ae!==void 0&&(ae=String(ae).toLowerCase(),ae==="ucs2"||ae==="ucs-2"||ae==="utf16le"||ae==="utf-16le")){if(H.length<2||I.length<2)return-1;Ae=2,Se/=2,ze/=2,O/=2}function Xe(nt,qe){return Ae===1?nt[qe]:nt.readUInt16BE(qe*Ae)}var Ue;if(_e){var Ze=-1;for(Ue=O;Ue<Se;Ue++)if(Xe(H,Ue)===Xe(I,Ze===-1?0:Ue-Ze)){if(Ze===-1&&(Ze=Ue),Ue-Ze+1===ze)return Ze*Ae}else Ze!==-1&&(Ue-=Ue-Ze),Ze=-1}else for(O+ze>Se&&(O=Se-ze),Ue=O;Ue>=0;Ue--){for(var He=!0,Je=0;Je<ze;Je++)if(Xe(H,Ue+Je)!==Xe(I,Je)){He=!1;break}if(He)return Ue}return-1}r.prototype.includes=function(I,O,ae){return this.indexOf(I,O,ae)!==-1},r.prototype.indexOf=function(I,O,ae){return y(this,I,O,ae,!0)},r.prototype.lastIndexOf=function(I,O,ae){return y(this,I,O,ae,!1)};function T(H,I,O,ae){O=Number(O)||0;var _e=H.length-O;ae?(ae=Number(ae),ae>_e&&(ae=_e)):ae=_e;var Ae=I.length;ae>Ae/2&&(ae=Ae/2);for(var Se=0;Se<ae;++Se){var ze=parseInt(I.substr(Se*2,2),16);if(le(ze))return Se;H[O+Se]=ze}return Se}function k(H,I,O,ae){return ve(N(I,H.length-O),H,O,ae)}function P(H,I,O,ae){return ve(te(I),H,O,ae)}function S(H,I,O,ae){return P(H,I,O,ae)}function F(H,I,O,ae){return ve(se(I),H,O,ae)}function K(H,I,O,ae){return ve(re(I,H.length-O),H,O,ae)}r.prototype.write=function(I,O,ae,_e){if(O===void 0)_e="utf8",ae=this.length,O=0;else if(ae===void 0&&typeof O=="string")_e=O,ae=this.length,O=0;else if(isFinite(O))O=O>>>0,isFinite(ae)?(ae=ae>>>0,_e===void 0&&(_e="utf8")):(_e=ae,ae=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Ae=this.length-O;if((ae===void 0||ae>Ae)&&(ae=Ae),I.length>0&&(ae<0||O<0)||O>this.length)throw new RangeError("Attempt to write outside buffer bounds");_e||(_e="utf8");for(var Se=!1;;)switch(_e){case"hex":return T(this,I,O,ae);case"utf8":case"utf-8":return k(this,I,O,ae);case"ascii":return P(this,I,O,ae);case"latin1":case"binary":return S(this,I,O,ae);case"base64":return F(this,I,O,ae);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,I,O,ae);default:if(Se)throw new TypeError("Unknown encoding: "+_e);_e=(""+_e).toLowerCase(),Se=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Q(H,I,O){return I===0&&O===H.length?l.fromByteArray(H):l.fromByteArray(H.slice(I,O))}function Z(H,I,O){O=Math.min(H.length,O);for(var ae=[],_e=I;_e<O;){var Ae=H[_e],Se=null,ze=Ae>239?4:Ae>223?3:Ae>191?2:1;if(_e+ze<=O){var Xe,Ue,Ze,He;switch(ze){case 1:Ae<128&&(Se=Ae);break;case 2:Xe=H[_e+1],(Xe&192)===128&&(He=(Ae&31)<<6|Xe&63,He>127&&(Se=He));break;case 3:Xe=H[_e+1],Ue=H[_e+2],(Xe&192)===128&&(Ue&192)===128&&(He=(Ae&15)<<12|(Xe&63)<<6|Ue&63,He>2047&&(He<55296||He>57343)&&(Se=He));break;case 4:Xe=H[_e+1],Ue=H[_e+2],Ze=H[_e+3],(Xe&192)===128&&(Ue&192)===128&&(Ze&192)===128&&(He=(Ae&15)<<18|(Xe&63)<<12|(Ue&63)<<6|Ze&63,He>65535&&He<1114112&&(Se=He))}}Se===null?(Se=65533,ze=1):Se>65535&&(Se-=65536,ae.push(Se>>>10&1023|55296),Se=56320|Se&1023),ae.push(Se),_e+=ze}return G(ae)}var B=4096;function G(H){var I=H.length;if(I<=B)return String.fromCharCode.apply(String,H);for(var O="",ae=0;ae<I;)O+=String.fromCharCode.apply(String,H.slice(ae,ae+=B));return O}function w(H,I,O){var ae="";O=Math.min(H.length,O);for(var _e=I;_e<O;++_e)ae+=String.fromCharCode(H[_e]&127);return ae}function D(H,I,O){var ae="";O=Math.min(H.length,O);for(var _e=I;_e<O;++_e)ae+=String.fromCharCode(H[_e]);return ae}function U(H,I,O){var ae=H.length;(!I||I<0)&&(I=0),(!O||O<0||O>ae)&&(O=ae);for(var _e="",Ae=I;Ae<O;++Ae)_e+=X(H[Ae]);return _e}function q(H,I,O){for(var ae=H.slice(I,O),_e="",Ae=0;Ae<ae.length;Ae+=2)_e+=String.fromCharCode(ae[Ae]+ae[Ae+1]*256);return _e}r.prototype.slice=function(I,O){var ae=this.length;I=~~I,O=O===void 0?ae:~~O,I<0?(I+=ae,I<0&&(I=0)):I>ae&&(I=ae),O<0?(O+=ae,O<0&&(O=0)):O>ae&&(O=ae),O<I&&(O=I);var _e=this.subarray(I,O);return _e.__proto__=r.prototype,_e};function j(H,I,O){if(H%1!==0||H<0)throw new RangeError("offset is not uint");if(H+I>O)throw new RangeError("Trying to access beyond buffer length")}r.prototype.readUIntLE=function(I,O,ae){I=I>>>0,O=O>>>0,ae||j(I,O,this.length);for(var _e=this[I],Ae=1,Se=0;++Se<O&&(Ae*=256);)_e+=this[I+Se]*Ae;return _e},r.prototype.readUIntBE=function(I,O,ae){I=I>>>0,O=O>>>0,ae||j(I,O,this.length);for(var _e=this[I+--O],Ae=1;O>0&&(Ae*=256);)_e+=this[I+--O]*Ae;return _e},r.prototype.readUInt8=function(I,O){return I=I>>>0,O||j(I,1,this.length),this[I]},r.prototype.readUInt16LE=function(I,O){return I=I>>>0,O||j(I,2,this.length),this[I]|this[I+1]<<8},r.prototype.readUInt16BE=function(I,O){return I=I>>>0,O||j(I,2,this.length),this[I]<<8|this[I+1]},r.prototype.readUInt32LE=function(I,O){return I=I>>>0,O||j(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+this[I+3]*16777216},r.prototype.readUInt32BE=function(I,O){return I=I>>>0,O||j(I,4,this.length),this[I]*16777216+(this[I+1]<<16|this[I+2]<<8|this[I+3])},r.prototype.readIntLE=function(I,O,ae){I=I>>>0,O=O>>>0,ae||j(I,O,this.length);for(var _e=this[I],Ae=1,Se=0;++Se<O&&(Ae*=256);)_e+=this[I+Se]*Ae;return Ae*=128,_e>=Ae&&(_e-=Math.pow(2,8*O)),_e},r.prototype.readIntBE=function(I,O,ae){I=I>>>0,O=O>>>0,ae||j(I,O,this.length);for(var _e=O,Ae=1,Se=this[I+--_e];_e>0&&(Ae*=256);)Se+=this[I+--_e]*Ae;return Ae*=128,Se>=Ae&&(Se-=Math.pow(2,8*O)),Se},r.prototype.readInt8=function(I,O){return I=I>>>0,O||j(I,1,this.length),this[I]&128?(255-this[I]+1)*-1:this[I]},r.prototype.readInt16LE=function(I,O){I=I>>>0,O||j(I,2,this.length);var ae=this[I]|this[I+1]<<8;return ae&32768?ae|4294901760:ae},r.prototype.readInt16BE=function(I,O){I=I>>>0,O||j(I,2,this.length);var ae=this[I+1]|this[I]<<8;return ae&32768?ae|4294901760:ae},r.prototype.readInt32LE=function(I,O){return I=I>>>0,O||j(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},r.prototype.readInt32BE=function(I,O){return I=I>>>0,O||j(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},r.prototype.readFloatLE=function(I,O){return I=I>>>0,O||j(I,4,this.length),a.read(this,I,!0,23,4)},r.prototype.readFloatBE=function(I,O){return I=I>>>0,O||j(I,4,this.length),a.read(this,I,!1,23,4)},r.prototype.readDoubleLE=function(I,O){return I=I>>>0,O||j(I,8,this.length),a.read(this,I,!0,52,8)},r.prototype.readDoubleBE=function(I,O){return I=I>>>0,O||j(I,8,this.length),a.read(this,I,!1,52,8)};function Y(H,I,O,ae,_e,Ae){if(!r.isBuffer(H))throw new TypeError('"buffer" argument must be a Buffer instance');if(I>_e||I<Ae)throw new RangeError('"value" argument is out of bounds');if(O+ae>H.length)throw new RangeError("Index out of range")}r.prototype.writeUIntLE=function(I,O,ae,_e){if(I=+I,O=O>>>0,ae=ae>>>0,!_e){var Ae=Math.pow(2,8*ae)-1;Y(this,I,O,ae,Ae,0)}var Se=1,ze=0;for(this[O]=I&255;++ze<ae&&(Se*=256);)this[O+ze]=I/Se&255;return O+ae},r.prototype.writeUIntBE=function(I,O,ae,_e){if(I=+I,O=O>>>0,ae=ae>>>0,!_e){var Ae=Math.pow(2,8*ae)-1;Y(this,I,O,ae,Ae,0)}var Se=ae-1,ze=1;for(this[O+Se]=I&255;--Se>=0&&(ze*=256);)this[O+Se]=I/ze&255;return O+ae},r.prototype.writeUInt8=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,1,255,0),this[O]=I&255,O+1},r.prototype.writeUInt16LE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,2,65535,0),this[O]=I&255,this[O+1]=I>>>8,O+2},r.prototype.writeUInt16BE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,2,65535,0),this[O]=I>>>8,this[O+1]=I&255,O+2},r.prototype.writeUInt32LE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,4,4294967295,0),this[O+3]=I>>>24,this[O+2]=I>>>16,this[O+1]=I>>>8,this[O]=I&255,O+4},r.prototype.writeUInt32BE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,4,4294967295,0),this[O]=I>>>24,this[O+1]=I>>>16,this[O+2]=I>>>8,this[O+3]=I&255,O+4},r.prototype.writeIntLE=function(I,O,ae,_e){if(I=+I,O=O>>>0,!_e){var Ae=Math.pow(2,8*ae-1);Y(this,I,O,ae,Ae-1,-Ae)}var Se=0,ze=1,Xe=0;for(this[O]=I&255;++Se<ae&&(ze*=256);)I<0&&Xe===0&&this[O+Se-1]!==0&&(Xe=1),this[O+Se]=(I/ze>>0)-Xe&255;return O+ae},r.prototype.writeIntBE=function(I,O,ae,_e){if(I=+I,O=O>>>0,!_e){var Ae=Math.pow(2,8*ae-1);Y(this,I,O,ae,Ae-1,-Ae)}var Se=ae-1,ze=1,Xe=0;for(this[O+Se]=I&255;--Se>=0&&(ze*=256);)I<0&&Xe===0&&this[O+Se+1]!==0&&(Xe=1),this[O+Se]=(I/ze>>0)-Xe&255;return O+ae},r.prototype.writeInt8=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,1,127,-128),I<0&&(I=255+I+1),this[O]=I&255,O+1},r.prototype.writeInt16LE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,2,32767,-32768),this[O]=I&255,this[O+1]=I>>>8,O+2},r.prototype.writeInt16BE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,2,32767,-32768),this[O]=I>>>8,this[O+1]=I&255,O+2},r.prototype.writeInt32LE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,4,2147483647,-2147483648),this[O]=I&255,this[O+1]=I>>>8,this[O+2]=I>>>16,this[O+3]=I>>>24,O+4},r.prototype.writeInt32BE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,4,2147483647,-2147483648),I<0&&(I=4294967295+I+1),this[O]=I>>>24,this[O+1]=I>>>16,this[O+2]=I>>>8,this[O+3]=I&255,O+4};function J(H,I,O,ae,_e,Ae){if(O+ae>H.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("Index out of range")}function oe(H,I,O,ae,_e){return I=+I,O=O>>>0,_e||J(H,I,O,4),a.write(H,I,O,ae,23,4),O+4}r.prototype.writeFloatLE=function(I,O,ae){return oe(this,I,O,!0,ae)},r.prototype.writeFloatBE=function(I,O,ae){return oe(this,I,O,!1,ae)};function pe(H,I,O,ae,_e){return I=+I,O=O>>>0,_e||J(H,I,O,8),a.write(H,I,O,ae,52,8),O+8}r.prototype.writeDoubleLE=function(I,O,ae){return pe(this,I,O,!0,ae)},r.prototype.writeDoubleBE=function(I,O,ae){return pe(this,I,O,!1,ae)},r.prototype.copy=function(I,O,ae,_e){if(!r.isBuffer(I))throw new TypeError("argument should be a Buffer");if(ae||(ae=0),!_e&&_e!==0&&(_e=this.length),O>=I.length&&(O=I.length),O||(O=0),_e>0&&_e<ae&&(_e=ae),_e===ae||I.length===0||this.length===0)return 0;if(O<0)throw new RangeError("targetStart out of bounds");if(ae<0||ae>=this.length)throw new RangeError("Index out of range");if(_e<0)throw new RangeError("sourceEnd out of bounds");_e>this.length&&(_e=this.length),I.length-O<_e-ae&&(_e=I.length-O+ae);var Ae=_e-ae;if(this===I&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(O,ae,_e);else if(this===I&&ae<O&&O<_e)for(var Se=Ae-1;Se>=0;--Se)I[Se+O]=this[Se+ae];else Uint8Array.prototype.set.call(I,this.subarray(ae,_e),O);return Ae},r.prototype.fill=function(I,O,ae,_e){if(typeof I=="string"){if(typeof O=="string"?(_e=O,O=0,ae=this.length):typeof ae=="string"&&(_e=ae,ae=this.length),_e!==void 0&&typeof _e!="string")throw new TypeError("encoding must be a string");if(typeof _e=="string"&&!r.isEncoding(_e))throw new TypeError("Unknown encoding: "+_e);if(I.length===1){var Ae=I.charCodeAt(0);(_e==="utf8"&&Ae<128||_e==="latin1")&&(I=Ae)}}else typeof I=="number"&&(I=I&255);if(O<0||this.length<O||this.length<ae)throw new RangeError("Out of range index");if(ae<=O)return this;O=O>>>0,ae=ae===void 0?this.length:ae>>>0,I||(I=0);var Se;if(typeof I=="number")for(Se=O;Se<ae;++Se)this[Se]=I;else{var ze=r.isBuffer(I)?I:r.from(I,_e),Xe=ze.length;if(Xe===0)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(Se=0;Se<ae-O;++Se)this[Se+O]=ze[Se%Xe]}return this};var me=/[^+/0-9A-Za-z-_]/g;function Ee(H){if(H=H.split("=")[0],H=H.trim().replace(me,""),H.length<2)return"";for(;H.length%4!==0;)H=H+"=";return H}function X(H){return H<16?"0"+H.toString(16):H.toString(16)}function N(H,I){I=I||1/0;for(var O,ae=H.length,_e=null,Ae=[],Se=0;Se<ae;++Se){if(O=H.charCodeAt(Se),O>55295&&O<57344){if(!_e){if(O>56319){(I-=3)>-1&&Ae.push(239,191,189);continue}else if(Se+1===ae){(I-=3)>-1&&Ae.push(239,191,189);continue}_e=O;continue}if(O<56320){(I-=3)>-1&&Ae.push(239,191,189),_e=O;continue}O=(_e-55296<<10|O-56320)+65536}else _e&&(I-=3)>-1&&Ae.push(239,191,189);if(_e=null,O<128){if((I-=1)<0)break;Ae.push(O)}else if(O<2048){if((I-=2)<0)break;Ae.push(O>>6|192,O&63|128)}else if(O<65536){if((I-=3)<0)break;Ae.push(O>>12|224,O>>6&63|128,O&63|128)}else if(O<1114112){if((I-=4)<0)break;Ae.push(O>>18|240,O>>12&63|128,O>>6&63|128,O&63|128)}else throw new Error("Invalid code point")}return Ae}function te(H){for(var I=[],O=0;O<H.length;++O)I.push(H.charCodeAt(O)&255);return I}function re(H,I){for(var O,ae,_e,Ae=[],Se=0;Se<H.length&&!((I-=2)<0);++Se)O=H.charCodeAt(Se),ae=O>>8,_e=O%256,Ae.push(_e),Ae.push(ae);return Ae}function se(H){return l.toByteArray(Ee(H))}function ve(H,I,O,ae){for(var _e=0;_e<ae&&!(_e+O>=I.length||_e>=H.length);++_e)I[_e+O]=H[_e];return _e}function ee(H,I){return H instanceof I||H!=null&&H.constructor!=null&&H.constructor.name!=null&&H.constructor.name===I.name}function le(H){return H!==H}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:6}],4:[function(e,n,o){(function(t){(function(){(function(l,a){typeof o=="object"?n.exports=a(l):a(l)})(typeof t<"u"?t:this,function(l){if(l.CSS&&l.CSS.escape)return l.CSS.escape;var a=function(i){if(arguments.length==0)throw new TypeError("`CSS.escape` requires an argument.");for(var s=String(i),c=s.length,r=-1,d,h="",m=s.charCodeAt(0);++r<c;){if(d=s.charCodeAt(r),d==0){h+="�";continue}if(d>=1&&d<=31||d==127||r==0&&d>=48&&d<=57||r==1&&d>=48&&d<=57&&m==45){h+="\\"+d.toString(16)+" ";continue}if(r==0&&c==1&&d==45){h+="\\"+s.charAt(r);continue}if(d>=128||d==45||d==95||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122){h+=s.charAt(r);continue}h+="\\"+s.charAt(r)}return h};return l.CSS||(l.CSS={}),l.CSS.escape=a,a})}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],5:[function(e,n,o){var t=typeof Reflect=="object"?Reflect:null,l=t&&typeof t.apply=="function"?t.apply:function(_,y,v){return Function.prototype.apply.call(_,y,v)},a;t&&typeof t.ownKeys=="function"?a=t.ownKeys:Object.getOwnPropertySymbols?a=function(_){return Object.getOwnPropertyNames(_).concat(Object.getOwnPropertySymbols(_))}:a=function(_){return Object.getOwnPropertyNames(_)};function i(u){console&&console.warn&&console.warn(u)}var s=Number.isNaN||function(_){return _!==_};function c(){c.init.call(this)}n.exports=c,n.exports.once=C,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var r=10;function d(u){if(typeof u!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof u)}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return r},set:function(u){if(typeof u!="number"||u<0||s(u))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+u+".");r=u}}),c.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(_){if(typeof _!="number"||_<0||s(_))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+_+".");return this._maxListeners=_,this};function h(u){return u._maxListeners===void 0?c.defaultMaxListeners:u._maxListeners}c.prototype.getMaxListeners=function(){return h(this)},c.prototype.emit=function(_){for(var y=[],v=1;v<arguments.length;v++)y.push(arguments[v]);var T=_==="error",k=this._events;if(k!==void 0)T=T&&k.error===void 0;else if(!T)return!1;if(T){var P;if(y.length>0&&(P=y[0]),P instanceof Error)throw P;var S=new Error("Unhandled error."+(P?" ("+P.message+")":""));throw S.context=P,S}var F=k[_];if(F===void 0)return!1;if(typeof F=="function")l(F,this,y);else for(var K=F.length,Q=A(F,K),v=0;v<K;++v)l(Q[v],this,y);return!0};function m(u,_,y,v){var T,k,P;if(d(y),k=u._events,k===void 0?(k=u._events=Object.create(null),u._eventsCount=0):(k.newListener!==void 0&&(u.emit("newListener",_,y.listener?y.listener:y),k=u._events),P=k[_]),P===void 0)P=k[_]=y,++u._eventsCount;else if(typeof P=="function"?P=k[_]=v?[y,P]:[P,y]:v?P.unshift(y):P.push(y),T=h(u),T>0&&P.length>T&&!P.warned){P.warned=!0;var S=new Error("Possible EventEmitter memory leak detected. "+P.length+" "+String(_)+" listeners added. Use emitter.setMaxListeners() to increase limit");S.name="MaxListenersExceededWarning",S.emitter=u,S.type=_,S.count=P.length,i(S)}return u}c.prototype.addListener=function(_,y){return m(this,_,y,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(_,y){return m(this,_,y,!0)};function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(u,_,y){var v={fired:!1,wrapFn:void 0,target:u,type:_,listener:y},T=f.bind(v);return T.listener=y,v.wrapFn=T,T}c.prototype.once=function(_,y){return d(y),this.on(_,g(this,_,y)),this},c.prototype.prependOnceListener=function(_,y){return d(y),this.prependListener(_,g(this,_,y)),this},c.prototype.removeListener=function(_,y){var v,T,k,P,S;if(d(y),T=this._events,T===void 0)return this;if(v=T[_],v===void 0)return this;if(v===y||v.listener===y)--this._eventsCount===0?this._events=Object.create(null):(delete T[_],T.removeListener&&this.emit("removeListener",_,v.listener||y));else if(typeof v!="function"){for(k=-1,P=v.length-1;P>=0;P--)if(v[P]===y||v[P].listener===y){S=v[P].listener,k=P;break}if(k<0)return this;k===0?v.shift():M(v,k),v.length===1&&(T[_]=v[0]),T.removeListener!==void 0&&this.emit("removeListener",_,S||y)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(_){var y,v,T;if(v=this._events,v===void 0)return this;if(v.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):v[_]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete v[_]),this;if(arguments.length===0){var k=Object.keys(v),P;for(T=0;T<k.length;++T)P=k[T],P!=="removeListener"&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(y=v[_],typeof y=="function")this.removeListener(_,y);else if(y!==void 0)for(T=y.length-1;T>=0;T--)this.removeListener(_,y[T]);return this};function x(u,_,y){var v=u._events;if(v===void 0)return[];var T=v[_];return T===void 0?[]:typeof T=="function"?y?[T.listener||T]:[T]:y?L(T):A(T,T.length)}c.prototype.listeners=function(_){return x(this,_,!0)},c.prototype.rawListeners=function(_){return x(this,_,!1)},c.listenerCount=function(u,_){return typeof u.listenerCount=="function"?u.listenerCount(_):b.call(u,_)},c.prototype.listenerCount=b;function b(u){var _=this._events;if(_!==void 0){var y=_[u];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}c.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]};function A(u,_){for(var y=new Array(_),v=0;v<_;++v)y[v]=u[v];return y}function M(u,_){for(;_+1<u.length;_++)u[_]=u[_+1];u.pop()}function L(u){for(var _=new Array(u.length),y=0;y<_.length;++y)_[y]=u[y].listener||u[y];return _}function C(u,_){return new Promise(function(y,v){function T(){k!==void 0&&u.removeListener("error",k),y([].slice.call(arguments))}var k;_!=="error"&&(k=function(S){u.removeListener(_,T),v(S)},u.once("error",k)),u.once(_,T)})}},{}],6:[function(e,n,o){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */o.read=function(t,l,a,i,s){var c,r,d=s*8-i-1,h=(1<<d)-1,m=h>>1,f=-7,g=a?s-1:0,x=a?-1:1,b=t[l+g];for(g+=x,c=b&(1<<-f)-1,b>>=-f,f+=d;f>0;c=c*256+t[l+g],g+=x,f-=8);for(r=c&(1<<-f)-1,c>>=-f,f+=i;f>0;r=r*256+t[l+g],g+=x,f-=8);if(c===0)c=1-m;else{if(c===h)return r?NaN:(b?-1:1)*(1/0);r=r+Math.pow(2,i),c=c-m}return(b?-1:1)*r*Math.pow(2,c-i)},o.write=function(t,l,a,i,s,c){var r,d,h,m=c*8-s-1,f=(1<<m)-1,g=f>>1,x=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=i?0:c-1,A=i?1:-1,M=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(d=isNaN(l)?1:0,r=f):(r=Math.floor(Math.log(l)/Math.LN2),l*(h=Math.pow(2,-r))<1&&(r--,h*=2),r+g>=1?l+=x/h:l+=x*Math.pow(2,1-g),l*h>=2&&(r++,h/=2),r+g>=f?(d=0,r=f):r+g>=1?(d=(l*h-1)*Math.pow(2,s),r=r+g):(d=l*Math.pow(2,g-1)*Math.pow(2,s),r=0));s>=8;t[a+b]=d&255,b+=A,d/=256,s-=8);for(r=r<<s|d,m+=s;m>0;t[a+b]=r&255,b+=A,r/=256,m-=8);t[a+b-A]|=M*128}},{}],7:[function(e,n,o){(function(t){(function(){(function(l){var a=this;n.exports=l(a)})(function(l){function a(u,_){return typeof u!="object"||u===null?!1:u.constructor===_||Object.prototype.toString.call(u)==="[object "+_.name+"]"}function i(u,_){return!_&&a(u,Array)?u:Array.prototype.slice.call(u)}function s(u,_){return u!==void 0?u:_}function c(u,_,y,v){if(c.is(u)){var T=u.slice(_,_+y);return T._littleEndian=s(v,T._littleEndian),T}if(!c.is(this))return new c(u,_,y,v);if(this.buffer=u=c.wrapBuffer(u),this._isArrayBuffer=f.ArrayBuffer&&a(u,ArrayBuffer),this._isPixelData=!1,this._isDataView=f.DataView&&this._isArrayBuffer,this._isNodeBuffer=f.NodeBuffer&&a(u,t),!this._isNodeBuffer&&!this._isArrayBuffer&&!a(u,Array))throw new TypeError("jDataView buffer has an incompatible type");this._littleEndian=!!v;var k="byteLength"in u?u.byteLength:u.length;this.byteOffset=_=s(_,0),this.byteLength=y=s(y,k-_),this._offset=this._bitOffset=0,this._isDataView?this._view=new DataView(u,_,y):this._checkBounds(_,y,k),this._engineAction=this._isDataView?this._dataViewAction:this._isNodeBuffer?this._nodeBufferAction:this._isArrayBuffer?this._arrayBufferAction:this._arrayAction}function r(u){if(f.NodeBuffer)return new t(u,"binary");for(var _=f.ArrayBuffer?Uint8Array:Array,y=new _(u.length),v=0,T=u.length;T>v;v++)y[v]=255&u.charCodeAt(v);return y}function d(u){return u>=0&&31>u?1<<u:d[u]||(d[u]=Math.pow(2,u))}function h(u,_){this.lo=u,this.hi=_}function m(){h.apply(this,arguments)}var f={NodeBuffer:"Buffer"in window,DataView:"DataView"in window,ArrayBuffer:"ArrayBuffer"in window,PixelData:!1},g=window.TextEncoder,x=window.TextDecoder;f.NodeBuffer&&function(u){try{u.writeFloatLE(1/0,0)}catch{f.NodeBuffer=!1}}(new t(4));var b={Int8:1,Int16:2,Int32:4,Uint8:1,Uint16:2,Uint32:4,Float32:4,Float64:8};c.wrapBuffer=function(u){switch(typeof u){case"number":if(f.NodeBuffer)u=new t(u),u.fill(0);else if(f.ArrayBuffer)u=new Uint8Array(u).buffer;else{u=new Array(u);for(var _=0;_<u.length;_++)u[_]=0}return u;case"string":u=r(u);default:return"length"in u&&!(f.NodeBuffer&&a(u,t)||f.ArrayBuffer&&a(u,ArrayBuffer))&&(f.NodeBuffer?u=new t(u):f.ArrayBuffer?a(u,ArrayBuffer)||(u=new Uint8Array(u).buffer,a(u,ArrayBuffer)||(u=new Uint8Array(i(u,!0)).buffer)):u=i(u)),u}},c.is=function(u){return u&&u.jDataView},c.from=function(){return new c(arguments)},c.Uint64=h,h.prototype={valueOf:function(){return this.lo+d(32)*this.hi},toString:function(){return Number.prototype.toString.apply(this.valueOf(),arguments)}},h.fromNumber=function(u){var _=Math.floor(u/d(32)),y=u-_*d(32);return new h(y,_)},c.Int64=m,m.prototype="create"in Object?Object.create(h.prototype):new h,m.prototype.valueOf=function(){return this.hi<d(31)?h.prototype.valueOf.apply(this,arguments):-(d(32)-this.lo+d(32)*(d(32)-1-this.hi))},m.fromNumber=function(u){var _,y;if(u>=0){var v=h.fromNumber(u);_=v.lo,y=v.hi}else y=Math.floor(u/d(32)),_=u-y*d(32),y+=d(32);return new m(_,y)};var A=c.prototype={compatibility:f,jDataView:!0,_checkBounds:function(u,_,y){if(typeof u!="number")throw new TypeError("Offset is not a number.");if(typeof _!="number")throw new TypeError("Size is not a number.");if(0>_)throw new RangeError("Length is negative.");if(0>u||u+_>s(y,this.byteLength))throw new RangeError("Offsets are out of bounds.")},_action:function(u,_,y,v,T){return this._engineAction(u,_,s(y,this._offset),s(v,this._littleEndian),T)},_dataViewAction:function(u,_,y,v,T){return this._offset=y+b[u],_?this._view["get"+u](y,v):this._view["set"+u](y,T,v)},_arrayBufferAction:function(u,_,y,v,T){var k,P=b[u],S=l[u+"Array"];if(v=s(v,this._littleEndian),P===1||(this.byteOffset+y)%P===0&&v)return k=new S(this.buffer,this.byteOffset+y,1),this._offset=y+P,_?k[0]:k[0]=T;var F=new Uint8Array(_?this.getBytes(P,y,v,!0):P);return k=new S(F.buffer,0,1),_?k[0]:(k[0]=T,void this._setBytes(y,F,v))},_arrayAction:function(u,_,y,v,T){return _?this["_get"+u](y,v):this["_set"+u](y,T,v)},_getBytes:function(u,_,y){y=s(y,this._littleEndian),_=s(_,this._offset),u=s(u,this.byteLength-_),this._checkBounds(_,u),_+=this.byteOffset,this._offset=_-this.byteOffset+u;var v=this._isArrayBuffer?new Uint8Array(this.buffer,_,u):(this.buffer.slice||Array.prototype.slice).call(this.buffer,_,_+u);return y||1>=u?v:i(v).reverse()},getBytes:function(u,_,y,v){var T=this._getBytes(u,_,s(y,!0));return v?i(T):T},_setBytes:function(u,_,y){var v=_.length;if(v!==0){if(y=s(y,this._littleEndian),u=s(u,this._offset),this._checkBounds(u,v),!y&&v>1&&(_=i(_,!0).reverse()),u+=this.byteOffset,this._isArrayBuffer)new Uint8Array(this.buffer,u,v).set(_);else if(this._isNodeBuffer)new t(_).copy(this.buffer,u);else for(var T=0;v>T;T++)this.buffer[u+T]=_[T];this._offset=u-this.byteOffset+v}},setBytes:function(u,_,y){this._setBytes(u,_,s(y,!0))},getString:function(u,_,y){if(this._isNodeBuffer)return _=s(_,this._offset),u=s(u,this.byteLength-_),this._checkBounds(_,u),this._offset=_+u,this.buffer.toString(y||"binary",this.byteOffset+_,this.byteOffset+this._offset);var v=this._getBytes(u,_,!0);if(y=y==="utf8"?"utf-8":y||"binary",x&&y!=="binary")return new x(y).decode(this._isArrayBuffer?v:new Uint8Array(v));var T="";u=v.length;for(var k=0;u>k;k++)T+=String.fromCharCode(v[k]);return y==="utf-8"&&(T=decodeURIComponent(escape(T))),T},setString:function(u,_,y){if(this._isNodeBuffer)return u=s(u,this._offset),this._checkBounds(u,_.length),void(this._offset=u+this.buffer.write(_,this.byteOffset+u,y||"binary"));y=y==="utf8"?"utf-8":y||"binary";var v;g&&y!=="binary"?v=new g(y).encode(_):(y==="utf-8"&&(_=unescape(encodeURIComponent(_))),v=r(_)),this._setBytes(u,v,!0)},getChar:function(u){return this.getString(1,u)},setChar:function(u,_){this.setString(u,_)},tell:function(){return this._offset},seek:function(u){return this._checkBounds(u,0),this._offset=u},skip:function(u){return this.seek(this._offset+u)},slice:function(u,_,y){function v(T,k){return 0>T?T+k:T}return u=v(u,this.byteLength),_=v(s(_,this.byteLength),this.byteLength),y?new c(this.getBytes(_-u,u,!0,!0),void 0,void 0,this._littleEndian):new c(this.buffer,this.byteOffset+u,_-u,this._littleEndian)},alignBy:function(u){return this._bitOffset=0,s(u,1)!==1?this.skip(u-(this._offset%u||u)):this._offset},_getFloat64:function(u,_){var y=this._getBytes(8,u,_),v=1-2*(y[7]>>7),T=((y[7]<<1&255)<<3|y[6]>>4)-1023,k=(15&y[6])*d(48)+y[5]*d(40)+y[4]*d(32)+y[3]*d(24)+y[2]*d(16)+y[1]*d(8)+y[0];return T===1024?k!==0?NaN:1/0*v:T===-1023?v*k*d(-1074):v*(1+k*d(-52))*d(T)},_getFloat32:function(u,_){var y=this._getBytes(4,u,_),v=1-2*(y[3]>>7),T=(y[3]<<1&255|y[2]>>7)-127,k=(127&y[2])<<16|y[1]<<8|y[0];return T===128?k!==0?NaN:1/0*v:T===-127?v*k*d(-149):v*(1+k*d(-23))*d(T)},_get64:function(u,_,y){y=s(y,this._littleEndian),_=s(_,this._offset);for(var v=y?[0,4]:[4,0],T=0;2>T;T++)v[T]=this.getUint32(_+v[T],y);return this._offset=_+8,new u(v[0],v[1])},getInt64:function(u,_){return this._get64(m,u,_)},getUint64:function(u,_){return this._get64(h,u,_)},_getInt32:function(u,_){var y=this._getBytes(4,u,_);return y[3]<<24|y[2]<<16|y[1]<<8|y[0]},_getUint32:function(u,_){return this._getInt32(u,_)>>>0},_getInt16:function(u,_){return this._getUint16(u,_)<<16>>16},_getUint16:function(u,_){var y=this._getBytes(2,u,_);return y[1]<<8|y[0]},_getInt8:function(u){return this._getUint8(u)<<24>>24},_getUint8:function(u){return this._getBytes(1,u)[0]},_getBitRangeData:function(u,_){var y=(s(_,this._offset)<<3)+this._bitOffset,v=y+u,T=y>>>3,k=v+7>>>3,P=this._getBytes(k-T,T,!0),S=0;(this._bitOffset=7&v)&&(this._bitOffset-=8);for(var F=0,K=P.length;K>F;F++)S=S<<8|P[F];return{start:T,bytes:P,wideValue:S}},getSigned:function(u,_){var y=32-u;return this.getUnsigned(u,_)<<y>>y},getUnsigned:function(u,_){var y=this._getBitRangeData(u,_).wideValue>>>-this._bitOffset;return 32>u?y&~(-1<<u):y},_setBinaryFloat:function(u,_,y,v,T){var k,P,S=0>_?1:0,F=~(-1<<v-1),K=1-F;0>_&&(_=-_),_===0?(k=0,P=0):isNaN(_)?(k=2*F+1,P=1):_===1/0?(k=2*F+1,P=0):(k=Math.floor(Math.log(_)/Math.LN2),k>=K&&F>=k?(P=Math.floor((_*d(-k)-1)*d(y)),k+=F):(P=Math.floor(_/d(K-y)),k=0));for(var Q=[];y>=8;)Q.push(P%256),P=Math.floor(P/256),y-=8;for(k=k<<y|P,v+=y;v>=8;)Q.push(255&k),k>>>=8,v-=8;Q.push(S<<v|k),this._setBytes(u,Q,T)},_setFloat32:function(u,_,y){this._setBinaryFloat(u,_,23,8,y)},_setFloat64:function(u,_,y){this._setBinaryFloat(u,_,52,11,y)},_set64:function(u,_,y,v){typeof y!="object"&&(y=u.fromNumber(y)),v=s(v,this._littleEndian),_=s(_,this._offset);var T=v?{lo:0,hi:4}:{lo:4,hi:0};for(var k in T)this.setUint32(_+T[k],y[k],v);this._offset=_+8},setInt64:function(u,_,y){this._set64(m,u,_,y)},setUint64:function(u,_,y){this._set64(h,u,_,y)},_setUint32:function(u,_,y){this._setBytes(u,[255&_,_>>>8&255,_>>>16&255,_>>>24],y)},_setUint16:function(u,_,y){this._setBytes(u,[255&_,_>>>8&255],y)},_setUint8:function(u,_){this._setBytes(u,[255&_])},setUnsigned:function(u,_,y){var v=this._getBitRangeData(y,u),T=v.wideValue,k=v.bytes;T&=~(~(-1<<y)<<-this._bitOffset),T|=(32>y?_&~(-1<<y):_)<<-this._bitOffset;for(var P=k.length-1;P>=0;P--)k[P]=255&T,T>>>=8;this._setBytes(v.start,k,!0)}},M={Int8:"Int8",Int16:"Int16",Int32:"Int32",Uint8:"UInt8",Uint16:"UInt16",Uint32:"UInt32",Float32:"Float",Float64:"Double"};A._nodeBufferAction=function(u,_,y,v,T){this._offset=y+b[u];var k=M[u]+(u==="Int8"||u==="Uint8"?"":v?"LE":"BE");return y+=this.byteOffset,_?this.buffer["read"+k](y):this.buffer["write"+k](T,y)};for(var L in b)(function(u){A["get"+u]=function(_,y){return this._action(u,!0,_,y)},A["set"+u]=function(_,y,v){this._action(u,!1,_,v,y)}})(L);A._setInt32=A._setUint32,A._setInt16=A._setUint16,A._setInt8=A._setUint8,A.setSigned=A.setUnsigned;for(var C in A)C.slice(0,3)==="set"&&function(u){A["write"+u]=function(){Array.prototype.unshift.call(arguments,void 0),this["set"+u].apply(this,arguments)}}(C.slice(3));return c})}).call(this)}).call(this,e("buffer").Buffer)},{buffer:3}],8:[function(e,n,o){var t=n.exports={},l,a;function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?l=setTimeout:l=i}catch{l=i}try{typeof clearTimeout=="function"?a=clearTimeout:a=s}catch{a=s}})();function c(M){if(l===setTimeout)return setTimeout(M,0);if((l===i||!l)&&setTimeout)return l=setTimeout,setTimeout(M,0);try{return l(M,0)}catch{try{return l.call(null,M,0)}catch{return l.call(this,M,0)}}}function r(M){if(a===clearTimeout)return clearTimeout(M);if((a===s||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(M);try{return a(M)}catch{try{return a.call(null,M)}catch{return a.call(this,M)}}}var d=[],h=!1,m,f=-1;function g(){!h||!m||(h=!1,m.length?d=m.concat(d):f=-1,d.length&&x())}function x(){if(!h){var M=c(g);h=!0;for(var L=d.length;L;){for(m=d,d=[];++f<L;)m&&m[f].run();f=-1,L=d.length}m=null,h=!1,r(M)}}t.nextTick=function(M){var L=new Array(arguments.length-1);if(arguments.length>1)for(var C=1;C<arguments.length;C++)L[C-1]=arguments[C];d.push(new b(M,L)),d.length===1&&!h&&c(x)};function b(M,L){this.fun=M,this.array=L}b.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={};function A(){}t.on=A,t.addListener=A,t.once=A,t.off=A,t.removeListener=A,t.removeAllListeners=A,t.emit=A,t.prependListener=A,t.prependOnceListener=A,t.listeners=function(M){return[]},t.binding=function(M){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(M){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],9:[function(e,n,o){var t=e("buffer"),l=t.Buffer;function a(s,c){for(var r in s)c[r]=s[r]}l.from&&l.alloc&&l.allocUnsafe&&l.allocUnsafeSlow?n.exports=t:(a(t,o),o.Buffer=i);function i(s,c,r){return l(s,c,r)}a(l,i),i.from=function(s,c,r){if(typeof s=="number")throw new TypeError("Argument must not be a number");return l(s,c,r)},i.alloc=function(s,c,r){if(typeof s!="number")throw new TypeError("Argument must be a number");var d=l(s);return c!==void 0?typeof r=="string"?d.fill(c,r):d.fill(c):d.fill(0),d},i.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return l(s)},i.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(s)}},{buffer:3}],10:[function(e,n,o){(function(t){(function(){(function(l){l.parser=function(X,N){return new i(X,N)},l.SAXParser=i,l.SAXStream=f,l.createStream=m,l.MAX_BUFFER_LENGTH=64*1024;var a=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];l.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function i(X,N){if(!(this instanceof i))return new i(X,N);var te=this;c(te),te.q=te.c="",te.bufferCheckPosition=l.MAX_BUFFER_LENGTH,te.opt=N||{},te.opt.lowercase=te.opt.lowercase||te.opt.lowercasetags,te.looseCase=te.opt.lowercase?"toLowerCase":"toUpperCase",te.tags=[],te.closed=te.closedRoot=te.sawRoot=!1,te.tag=te.error=null,te.strict=!!X,te.noscript=!!(X||te.opt.noscript),te.state=S.BEGIN,te.strictEntities=te.opt.strictEntities,te.ENTITIES=te.strictEntities?Object.create(l.XML_ENTITIES):Object.create(l.ENTITIES),te.attribList=[],te.opt.xmlns&&(te.ns=Object.create(M)),te.trackPosition=te.opt.position!==!1,te.trackPosition&&(te.position=te.line=te.column=0),K(te,"onready")}Object.create||(Object.create=function(X){function N(){}N.prototype=X;var te=new N;return te}),Object.keys||(Object.keys=function(X){var N=[];for(var te in X)X.hasOwnProperty(te)&&N.push(te);return N});function s(X){for(var N=Math.max(l.MAX_BUFFER_LENGTH,10),te=0,re=0,se=a.length;re<se;re++){var ve=X[a[re]].length;if(ve>N)switch(a[re]){case"textNode":Z(X);break;case"cdata":Q(X,"oncdata",X.cdata),X.cdata="";break;case"script":Q(X,"onscript",X.script),X.script="";break;default:G(X,"Max buffer length exceeded: "+a[re])}te=Math.max(te,ve)}var ee=l.MAX_BUFFER_LENGTH-te;X.bufferCheckPosition=ee+X.position}function c(X){for(var N=0,te=a.length;N<te;N++)X[a[N]]=""}function r(X){Z(X),X.cdata!==""&&(Q(X,"oncdata",X.cdata),X.cdata=""),X.script!==""&&(Q(X,"onscript",X.script),X.script="")}i.prototype={end:function(){w(this)},write:Ee,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){r(this)}};var d;try{d=e("stream").Stream}catch{d=function(){}}var h=l.EVENTS.filter(function(X){return X!=="error"&&X!=="end"});function m(X,N){return new f(X,N)}function f(X,N){if(!(this instanceof f))return new f(X,N);d.apply(this),this._parser=new i(X,N),this.writable=!0,this.readable=!0;var te=this;this._parser.onend=function(){te.emit("end")},this._parser.onerror=function(re){te.emit("error",re),te._parser.error=null},this._decoder=null,h.forEach(function(re){Object.defineProperty(te,"on"+re,{get:function(){return te._parser["on"+re]},set:function(se){if(!se)return te.removeAllListeners(re),te._parser["on"+re]=se,se;te.on(re,se)},enumerable:!0,configurable:!1})})}f.prototype=Object.create(d.prototype,{constructor:{value:f}}),f.prototype.write=function(X){if(typeof t=="function"&&typeof t.isBuffer=="function"&&t.isBuffer(X)){if(!this._decoder){var N=e("string_decoder").StringDecoder;this._decoder=new N("utf8")}X=this._decoder.write(X)}return this._parser.write(X.toString()),this.emit("data",X),!0},f.prototype.end=function(X){return X&&X.length&&this.write(X),this._parser.end(),!0},f.prototype.on=function(X,N){var te=this;return!te._parser["on"+X]&&h.indexOf(X)!==-1&&(te._parser["on"+X]=function(){var re=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);re.splice(0,0,X),te.emit.apply(te,re)}),d.prototype.on.call(te,X,N)};var g="[CDATA[",x="DOCTYPE",b="http://www.w3.org/XML/1998/namespace",A="http://www.w3.org/2000/xmlns/",M={xml:b,xmlns:A},L=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,C=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,u=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function y(X){return X===" "||X===`
`||X==="\r"||X==="	"}function v(X){return X==='"'||X==="'"}function T(X){return X===">"||y(X)}function k(X,N){return X.test(N)}function P(X,N){return!k(X,N)}var S=0;l.STATE={BEGIN:S++,BEGIN_WHITESPACE:S++,TEXT:S++,TEXT_ENTITY:S++,OPEN_WAKA:S++,SGML_DECL:S++,SGML_DECL_QUOTED:S++,DOCTYPE:S++,DOCTYPE_QUOTED:S++,DOCTYPE_DTD:S++,DOCTYPE_DTD_QUOTED:S++,COMMENT_STARTING:S++,COMMENT:S++,COMMENT_ENDING:S++,COMMENT_ENDED:S++,CDATA:S++,CDATA_ENDING:S++,CDATA_ENDING_2:S++,PROC_INST:S++,PROC_INST_BODY:S++,PROC_INST_ENDING:S++,OPEN_TAG:S++,OPEN_TAG_SLASH:S++,ATTRIB:S++,ATTRIB_NAME:S++,ATTRIB_NAME_SAW_WHITE:S++,ATTRIB_VALUE:S++,ATTRIB_VALUE_QUOTED:S++,ATTRIB_VALUE_CLOSED:S++,ATTRIB_VALUE_UNQUOTED:S++,ATTRIB_VALUE_ENTITY_Q:S++,ATTRIB_VALUE_ENTITY_U:S++,CLOSE_TAG:S++,CLOSE_TAG_SAW_WHITE:S++,SCRIPT:S++,SCRIPT_ENDING:S++},l.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},l.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(l.ENTITIES).forEach(function(X){var N=l.ENTITIES[X],te=typeof N=="number"?String.fromCharCode(N):N;l.ENTITIES[X]=te});for(var F in l.STATE)l.STATE[l.STATE[F]]=F;S=l.STATE;function K(X,N,te){X[N]&&X[N](te)}function Q(X,N,te){X.textNode&&Z(X),K(X,N,te)}function Z(X){X.textNode=B(X.opt,X.textNode),X.textNode&&K(X,"ontext",X.textNode),X.textNode=""}function B(X,N){return X.trim&&(N=N.trim()),X.normalize&&(N=N.replace(/\s+/g," ")),N}function G(X,N){return Z(X),X.trackPosition&&(N+=`
Line: `+X.line+`
Column: `+X.column+`
Char: `+X.c),N=new Error(N),X.error=N,K(X,"onerror",N),X}function w(X){return X.sawRoot&&!X.closedRoot&&D(X,"Unclosed root tag"),X.state!==S.BEGIN&&X.state!==S.BEGIN_WHITESPACE&&X.state!==S.TEXT&&G(X,"Unexpected end"),Z(X),X.c="",X.closed=!0,K(X,"onend"),i.call(X,X.strict,X.opt),X}function D(X,N){if(typeof X!="object"||!(X instanceof i))throw new Error("bad call to strictFail");X.strict&&G(X,N)}function U(X){X.strict||(X.tagName=X.tagName[X.looseCase]());var N=X.tags[X.tags.length-1]||X,te=X.tag={name:X.tagName,attributes:{}};X.opt.xmlns&&(te.ns=N.ns),X.attribList.length=0,Q(X,"onopentagstart",te)}function q(X,N){var te=X.indexOf(":"),re=te<0?["",X]:X.split(":"),se=re[0],ve=re[1];return N&&X==="xmlns"&&(se="xmlns",ve=""),{prefix:se,local:ve}}function j(X){if(X.strict||(X.attribName=X.attribName[X.looseCase]()),X.attribList.indexOf(X.attribName)!==-1||X.tag.attributes.hasOwnProperty(X.attribName)){X.attribName=X.attribValue="";return}if(X.opt.xmlns){var N=q(X.attribName,!0),te=N.prefix,re=N.local;if(te==="xmlns")if(re==="xml"&&X.attribValue!==b)D(X,"xml: prefix must be bound to "+b+`
Actual: `+X.attribValue);else if(re==="xmlns"&&X.attribValue!==A)D(X,"xmlns: prefix must be bound to "+A+`
Actual: `+X.attribValue);else{var se=X.tag,ve=X.tags[X.tags.length-1]||X;se.ns===ve.ns&&(se.ns=Object.create(ve.ns)),se.ns[re]=X.attribValue}X.attribList.push([X.attribName,X.attribValue])}else X.tag.attributes[X.attribName]=X.attribValue,Q(X,"onattribute",{name:X.attribName,value:X.attribValue});X.attribName=X.attribValue=""}function Y(X,N){if(X.opt.xmlns){var te=X.tag,re=q(X.tagName);te.prefix=re.prefix,te.local=re.local,te.uri=te.ns[re.prefix]||"",te.prefix&&!te.uri&&(D(X,"Unbound namespace prefix: "+JSON.stringify(X.tagName)),te.uri=re.prefix);var se=X.tags[X.tags.length-1]||X;te.ns&&se.ns!==te.ns&&Object.keys(te.ns).forEach(function(ze){Q(X,"onopennamespace",{prefix:ze,uri:te.ns[ze]})});for(var ve=0,ee=X.attribList.length;ve<ee;ve++){var le=X.attribList[ve],H=le[0],I=le[1],O=q(H,!0),ae=O.prefix,_e=O.local,Ae=ae===""?"":te.ns[ae]||"",Se={name:H,value:I,prefix:ae,local:_e,uri:Ae};ae&&ae!=="xmlns"&&!Ae&&(D(X,"Unbound namespace prefix: "+JSON.stringify(ae)),Se.uri=ae),X.tag.attributes[H]=Se,Q(X,"onattribute",Se)}X.attribList.length=0}X.tag.isSelfClosing=!!N,X.sawRoot=!0,X.tags.push(X.tag),Q(X,"onopentag",X.tag),N||(!X.noscript&&X.tagName.toLowerCase()==="script"?X.state=S.SCRIPT:X.state=S.TEXT,X.tag=null,X.tagName=""),X.attribName=X.attribValue="",X.attribList.length=0}function J(X){if(!X.tagName){D(X,"Weird empty close tag."),X.textNode+="</>",X.state=S.TEXT;return}if(X.script){if(X.tagName!=="script"){X.script+="</"+X.tagName+">",X.tagName="",X.state=S.SCRIPT;return}Q(X,"onscript",X.script),X.script=""}var N=X.tags.length,te=X.tagName;X.strict||(te=te[X.looseCase]());for(var re=te;N--;){var se=X.tags[N];if(se.name!==re)D(X,"Unexpected close tag");else break}if(N<0){D(X,"Unmatched closing tag: "+X.tagName),X.textNode+="</"+X.tagName+">",X.state=S.TEXT;return}X.tagName=te;for(var ve=X.tags.length;ve-- >N;){var ee=X.tag=X.tags.pop();X.tagName=X.tag.name,Q(X,"onclosetag",X.tagName);var le={};for(var H in ee.ns)le[H]=ee.ns[H];var I=X.tags[X.tags.length-1]||X;X.opt.xmlns&&ee.ns!==I.ns&&Object.keys(ee.ns).forEach(function(O){var ae=ee.ns[O];Q(X,"onclosenamespace",{prefix:O,uri:ae})})}N===0&&(X.closedRoot=!0),X.tagName=X.attribValue=X.attribName="",X.attribList.length=0,X.state=S.TEXT}function oe(X){var N=X.entity,te=N.toLowerCase(),re,se="";return X.ENTITIES[N]?X.ENTITIES[N]:X.ENTITIES[te]?X.ENTITIES[te]:(N=te,N.charAt(0)==="#"&&(N.charAt(1)==="x"?(N=N.slice(2),re=parseInt(N,16),se=re.toString(16)):(N=N.slice(1),re=parseInt(N,10),se=re.toString(10))),N=N.replace(/^0+/,""),isNaN(re)||se.toLowerCase()!==N?(D(X,"Invalid character entity"),"&"+X.entity+";"):String.fromCodePoint(re))}function pe(X,N){N==="<"?(X.state=S.OPEN_WAKA,X.startTagPosition=X.position):y(N)||(D(X,"Non-whitespace before first tag."),X.textNode=N,X.state=S.TEXT)}function me(X,N){var te="";return N<X.length&&(te=X.charAt(N)),te}function Ee(X){var N=this;if(this.error)throw this.error;if(N.closed)return G(N,"Cannot write after close. Assign an onready handler.");if(X===null)return w(N);typeof X=="object"&&(X=X.toString());for(var te=0,re="";re=me(X,te++),N.c=re,!!re;)switch(N.trackPosition&&(N.position++,re===`
`?(N.line++,N.column=0):N.column++),N.state){case S.BEGIN:if(N.state=S.BEGIN_WHITESPACE,re==="\uFEFF")continue;pe(N,re);continue;case S.BEGIN_WHITESPACE:pe(N,re);continue;case S.TEXT:if(N.sawRoot&&!N.closedRoot){for(var se=te-1;re&&re!=="<"&&re!=="&";)re=me(X,te++),re&&N.trackPosition&&(N.position++,re===`
`?(N.line++,N.column=0):N.column++);N.textNode+=X.substring(se,te-1)}re==="<"&&!(N.sawRoot&&N.closedRoot&&!N.strict)?(N.state=S.OPEN_WAKA,N.startTagPosition=N.position):(!y(re)&&(!N.sawRoot||N.closedRoot)&&D(N,"Text data outside of root node."),re==="&"?N.state=S.TEXT_ENTITY:N.textNode+=re);continue;case S.SCRIPT:re==="<"?N.state=S.SCRIPT_ENDING:N.script+=re;continue;case S.SCRIPT_ENDING:re==="/"?N.state=S.CLOSE_TAG:(N.script+="<"+re,N.state=S.SCRIPT);continue;case S.OPEN_WAKA:if(re==="!")N.state=S.SGML_DECL,N.sgmlDecl="";else if(!y(re))if(k(L,re))N.state=S.OPEN_TAG,N.tagName=re;else if(re==="/")N.state=S.CLOSE_TAG,N.tagName="";else if(re==="?")N.state=S.PROC_INST,N.procInstName=N.procInstBody="";else{if(D(N,"Unencoded <"),N.startTagPosition+1<N.position){var ve=N.position-N.startTagPosition;re=new Array(ve).join(" ")+re}N.textNode+="<"+re,N.state=S.TEXT}continue;case S.SGML_DECL:(N.sgmlDecl+re).toUpperCase()===g?(Q(N,"onopencdata"),N.state=S.CDATA,N.sgmlDecl="",N.cdata=""):N.sgmlDecl+re==="--"?(N.state=S.COMMENT,N.comment="",N.sgmlDecl=""):(N.sgmlDecl+re).toUpperCase()===x?(N.state=S.DOCTYPE,(N.doctype||N.sawRoot)&&D(N,"Inappropriately located doctype declaration"),N.doctype="",N.sgmlDecl=""):re===">"?(Q(N,"onsgmldeclaration",N.sgmlDecl),N.sgmlDecl="",N.state=S.TEXT):(v(re)&&(N.state=S.SGML_DECL_QUOTED),N.sgmlDecl+=re);continue;case S.SGML_DECL_QUOTED:re===N.q&&(N.state=S.SGML_DECL,N.q=""),N.sgmlDecl+=re;continue;case S.DOCTYPE:re===">"?(N.state=S.TEXT,Q(N,"ondoctype",N.doctype),N.doctype=!0):(N.doctype+=re,re==="["?N.state=S.DOCTYPE_DTD:v(re)&&(N.state=S.DOCTYPE_QUOTED,N.q=re));continue;case S.DOCTYPE_QUOTED:N.doctype+=re,re===N.q&&(N.q="",N.state=S.DOCTYPE);continue;case S.DOCTYPE_DTD:N.doctype+=re,re==="]"?N.state=S.DOCTYPE:v(re)&&(N.state=S.DOCTYPE_DTD_QUOTED,N.q=re);continue;case S.DOCTYPE_DTD_QUOTED:N.doctype+=re,re===N.q&&(N.state=S.DOCTYPE_DTD,N.q="");continue;case S.COMMENT:re==="-"?N.state=S.COMMENT_ENDING:N.comment+=re;continue;case S.COMMENT_ENDING:re==="-"?(N.state=S.COMMENT_ENDED,N.comment=B(N.opt,N.comment),N.comment&&Q(N,"oncomment",N.comment),N.comment=""):(N.comment+="-"+re,N.state=S.COMMENT);continue;case S.COMMENT_ENDED:re!==">"?(D(N,"Malformed comment"),N.comment+="--"+re,N.state=S.COMMENT):N.state=S.TEXT;continue;case S.CDATA:re==="]"?N.state=S.CDATA_ENDING:N.cdata+=re;continue;case S.CDATA_ENDING:re==="]"?N.state=S.CDATA_ENDING_2:(N.cdata+="]"+re,N.state=S.CDATA);continue;case S.CDATA_ENDING_2:re===">"?(N.cdata&&Q(N,"oncdata",N.cdata),Q(N,"onclosecdata"),N.cdata="",N.state=S.TEXT):re==="]"?N.cdata+="]":(N.cdata+="]]"+re,N.state=S.CDATA);continue;case S.PROC_INST:re==="?"?N.state=S.PROC_INST_ENDING:y(re)?N.state=S.PROC_INST_BODY:N.procInstName+=re;continue;case S.PROC_INST_BODY:if(!N.procInstBody&&y(re))continue;re==="?"?N.state=S.PROC_INST_ENDING:N.procInstBody+=re;continue;case S.PROC_INST_ENDING:re===">"?(Q(N,"onprocessinginstruction",{name:N.procInstName,body:N.procInstBody}),N.procInstName=N.procInstBody="",N.state=S.TEXT):(N.procInstBody+="?"+re,N.state=S.PROC_INST_BODY);continue;case S.OPEN_TAG:k(C,re)?N.tagName+=re:(U(N),re===">"?Y(N):re==="/"?N.state=S.OPEN_TAG_SLASH:(y(re)||D(N,"Invalid character in tag name"),N.state=S.ATTRIB));continue;case S.OPEN_TAG_SLASH:re===">"?(Y(N,!0),J(N)):(D(N,"Forward-slash in opening tag not followed by >"),N.state=S.ATTRIB);continue;case S.ATTRIB:if(y(re))continue;re===">"?Y(N):re==="/"?N.state=S.OPEN_TAG_SLASH:k(L,re)?(N.attribName=re,N.attribValue="",N.state=S.ATTRIB_NAME):D(N,"Invalid attribute name");continue;case S.ATTRIB_NAME:re==="="?N.state=S.ATTRIB_VALUE:re===">"?(D(N,"Attribute without value"),N.attribValue=N.attribName,j(N),Y(N)):y(re)?N.state=S.ATTRIB_NAME_SAW_WHITE:k(C,re)?N.attribName+=re:D(N,"Invalid attribute name");continue;case S.ATTRIB_NAME_SAW_WHITE:if(re==="=")N.state=S.ATTRIB_VALUE;else{if(y(re))continue;D(N,"Attribute without value"),N.tag.attributes[N.attribName]="",N.attribValue="",Q(N,"onattribute",{name:N.attribName,value:""}),N.attribName="",re===">"?Y(N):k(L,re)?(N.attribName=re,N.state=S.ATTRIB_NAME):(D(N,"Invalid attribute name"),N.state=S.ATTRIB)}continue;case S.ATTRIB_VALUE:if(y(re))continue;v(re)?(N.q=re,N.state=S.ATTRIB_VALUE_QUOTED):(D(N,"Unquoted attribute value"),N.state=S.ATTRIB_VALUE_UNQUOTED,N.attribValue=re);continue;case S.ATTRIB_VALUE_QUOTED:if(re!==N.q){re==="&"?N.state=S.ATTRIB_VALUE_ENTITY_Q:N.attribValue+=re;continue}j(N),N.q="",N.state=S.ATTRIB_VALUE_CLOSED;continue;case S.ATTRIB_VALUE_CLOSED:y(re)?N.state=S.ATTRIB:re===">"?Y(N):re==="/"?N.state=S.OPEN_TAG_SLASH:k(L,re)?(D(N,"No whitespace between attributes"),N.attribName=re,N.attribValue="",N.state=S.ATTRIB_NAME):D(N,"Invalid attribute name");continue;case S.ATTRIB_VALUE_UNQUOTED:if(!T(re)){re==="&"?N.state=S.ATTRIB_VALUE_ENTITY_U:N.attribValue+=re;continue}j(N),re===">"?Y(N):N.state=S.ATTRIB;continue;case S.CLOSE_TAG:if(N.tagName)re===">"?J(N):k(C,re)?N.tagName+=re:N.script?(N.script+="</"+N.tagName,N.tagName="",N.state=S.SCRIPT):(y(re)||D(N,"Invalid tagname in closing tag"),N.state=S.CLOSE_TAG_SAW_WHITE);else{if(y(re))continue;P(L,re)?N.script?(N.script+="</"+re,N.state=S.SCRIPT):D(N,"Invalid tagname in closing tag."):N.tagName=re}continue;case S.CLOSE_TAG_SAW_WHITE:if(y(re))continue;re===">"?J(N):D(N,"Invalid characters in closing tag");continue;case S.TEXT_ENTITY:case S.ATTRIB_VALUE_ENTITY_Q:case S.ATTRIB_VALUE_ENTITY_U:var ee,le;switch(N.state){case S.TEXT_ENTITY:ee=S.TEXT,le="textNode";break;case S.ATTRIB_VALUE_ENTITY_Q:ee=S.ATTRIB_VALUE_QUOTED,le="attribValue";break;case S.ATTRIB_VALUE_ENTITY_U:ee=S.ATTRIB_VALUE_UNQUOTED,le="attribValue";break}re===";"?(N[le]+=oe(N),N.entity="",N.state=ee):k(N.entity.length?_:u,re)?N.entity+=re:(D(N,"Invalid character in entity name"),N[le]+="&"+N.entity+re,N.entity="",N.state=ee);continue;default:throw new Error(N,"Unknown state: "+N.state)}return N.position>=N.bufferCheckPosition&&s(N),N}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var X=String.fromCharCode,N=Math.floor,te=function(){var re=16384,se=[],ve,ee,le=-1,H=arguments.length;if(!H)return"";for(var I="";++le<H;){var O=Number(arguments[le]);if(!isFinite(O)||O<0||O>1114111||N(O)!==O)throw RangeError("Invalid code point: "+O);O<=65535?se.push(O):(O-=65536,ve=(O>>10)+55296,ee=O%1024+56320,se.push(ve,ee)),(le+1===H||se.length>re)&&(I+=X.apply(null,se),se.length=0)}return I};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:te,configurable:!0,writable:!0}):String.fromCodePoint=te}()})(typeof o>"u"?this.sax={}:o)}).call(this)}).call(this,e("buffer").Buffer)},{buffer:3,stream:11,string_decoder:27}],11:[function(e,n,o){n.exports=a;var t=e("events").EventEmitter,l=e("inherits");l(a,t),a.Readable=e("readable-stream/lib/_stream_readable.js"),a.Writable=e("readable-stream/lib/_stream_writable.js"),a.Duplex=e("readable-stream/lib/_stream_duplex.js"),a.Transform=e("readable-stream/lib/_stream_transform.js"),a.PassThrough=e("readable-stream/lib/_stream_passthrough.js"),a.finished=e("readable-stream/lib/internal/streams/end-of-stream.js"),a.pipeline=e("readable-stream/lib/internal/streams/pipeline.js"),a.Stream=a;function a(){t.call(this)}a.prototype.pipe=function(i,s){var c=this;function r(b){i.writable&&i.write(b)===!1&&c.pause&&c.pause()}c.on("data",r);function d(){c.readable&&c.resume&&c.resume()}i.on("drain",d),!i._isStdio&&(!s||s.end!==!1)&&(c.on("end",m),c.on("close",f));var h=!1;function m(){h||(h=!0,i.end())}function f(){h||(h=!0,typeof i.destroy=="function"&&i.destroy())}function g(b){if(x(),t.listenerCount(this,"error")===0)throw b}c.on("error",g),i.on("error",g);function x(){c.removeListener("data",r),i.removeListener("drain",d),c.removeListener("end",m),c.removeListener("close",f),c.removeListener("error",g),i.removeListener("error",g),c.removeListener("end",x),c.removeListener("close",x),i.removeListener("close",x)}return c.on("end",x),c.on("close",x),i.on("close",x),i.emit("pipe",c),i}},{events:5,inherits:12,"readable-stream/lib/_stream_duplex.js":14,"readable-stream/lib/_stream_passthrough.js":15,"readable-stream/lib/_stream_readable.js":16,"readable-stream/lib/_stream_transform.js":17,"readable-stream/lib/_stream_writable.js":18,"readable-stream/lib/internal/streams/end-of-stream.js":22,"readable-stream/lib/internal/streams/pipeline.js":24}],12:[function(e,n,o){typeof Object.create=="function"?n.exports=function(l,a){a&&(l.super_=a,l.prototype=Object.create(a.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(l,a){if(a){l.super_=a;var i=function(){};i.prototype=a.prototype,l.prototype=new i,l.prototype.constructor=l}}},{}],13:[function(e,n,o){function t(d,h){d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.__proto__=h}var l={};function a(d,h,m){m||(m=Error);function f(x,b,A){return typeof h=="string"?h:h(x,b,A)}var g=function(x){t(b,x);function b(A,M,L){return x.call(this,f(A,M,L))||this}return b}(m);g.prototype.name=m.name,g.prototype.code=d,l[d]=g}function i(d,h){if(Array.isArray(d)){var m=d.length;return d=d.map(function(f){return String(f)}),m>2?"one of ".concat(h," ").concat(d.slice(0,m-1).join(", "),", or ")+d[m-1]:m===2?"one of ".concat(h," ").concat(d[0]," or ").concat(d[1]):"of ".concat(h," ").concat(d[0])}else return"of ".concat(h," ").concat(String(d))}function s(d,h,m){return d.substr(0,h.length)===h}function c(d,h,m){return(m===void 0||m>d.length)&&(m=d.length),d.substring(m-h.length,m)===h}function r(d,h,m){return typeof m!="number"&&(m=0),m+h.length>d.length?!1:d.indexOf(h,m)!==-1}a("ERR_INVALID_OPT_VALUE",function(d,h){return'The value "'+h+'" is invalid for option "'+d+'"'},TypeError),a("ERR_INVALID_ARG_TYPE",function(d,h,m){var f;typeof h=="string"&&s(h,"not ")?(f="must not be",h=h.replace(/^not /,"")):f="must be";var g;if(c(d," argument"))g="The ".concat(d," ").concat(f," ").concat(i(h,"type"));else{var x=r(d,".")?"property":"argument";g='The "'.concat(d,'" ').concat(x," ").concat(f," ").concat(i(h,"type"))}return g+=". Received type ".concat(typeof m),g},TypeError),a("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),a("ERR_METHOD_NOT_IMPLEMENTED",function(d){return"The "+d+" method is not implemented"}),a("ERR_STREAM_PREMATURE_CLOSE","Premature close"),a("ERR_STREAM_DESTROYED",function(d){return"Cannot call "+d+" after a stream was destroyed"}),a("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),a("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),a("ERR_STREAM_WRITE_AFTER_END","write after end"),a("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),a("ERR_UNKNOWN_ENCODING",function(d){return"Unknown encoding: "+d},TypeError),a("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),n.exports.codes=l},{}],14:[function(e,n,o){(function(t){(function(){var l=Object.keys||function(f){var g=[];for(var x in f)g.push(x);return g};n.exports=d;var a=e("./_stream_readable"),i=e("./_stream_writable");e("inherits")(d,a);for(var s=l(i.prototype),c=0;c<s.length;c++){var r=s[c];d.prototype[r]||(d.prototype[r]=i.prototype[r])}function d(f){if(!(this instanceof d))return new d(f);a.call(this,f),i.call(this,f),this.allowHalfOpen=!0,f&&(f.readable===!1&&(this.readable=!1),f.writable===!1&&(this.writable=!1),f.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",h)))}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function h(){this._writableState.ended||t.nextTick(m,this)}function m(f){f.end()}Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=g,this._writableState.destroyed=g)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":16,"./_stream_writable":18,_process:8,inherits:12}],15:[function(e,n,o){n.exports=l;var t=e("./_stream_transform");e("inherits")(l,t);function l(a){if(!(this instanceof l))return new l(a);t.call(this,a)}l.prototype._transform=function(a,i,s){s(null,a)}},{"./_stream_transform":17,inherits:12}],16:[function(e,n,o){(function(t,l){(function(){n.exports=K;var a;K.ReadableState=F,e("events").EventEmitter;var i=function(le,H){return le.listeners(H).length},s=e("./internal/streams/stream"),c=e("buffer").Buffer,r=l.Uint8Array||function(){};function d(ee){return c.from(ee)}function h(ee){return c.isBuffer(ee)||ee instanceof r}var m=e("util"),f;m&&m.debuglog?f=m.debuglog("stream"):f=function(){};var g=e("./internal/streams/buffer_list"),x=e("./internal/streams/destroy"),b=e("./internal/streams/state"),A=b.getHighWaterMark,M=e("../errors").codes,L=M.ERR_INVALID_ARG_TYPE,C=M.ERR_STREAM_PUSH_AFTER_EOF,u=M.ERR_METHOD_NOT_IMPLEMENTED,_=M.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,y,v,T;e("inherits")(K,s);var k=x.errorOrDestroy,P=["error","close","destroy","pause","resume"];function S(ee,le,H){if(typeof ee.prependListener=="function")return ee.prependListener(le,H);!ee._events||!ee._events[le]?ee.on(le,H):Array.isArray(ee._events[le])?ee._events[le].unshift(H):ee._events[le]=[H,ee._events[le]]}function F(ee,le,H){a=a||e("./_stream_duplex"),ee=ee||{},typeof H!="boolean"&&(H=le instanceof a),this.objectMode=!!ee.objectMode,H&&(this.objectMode=this.objectMode||!!ee.readableObjectMode),this.highWaterMark=A(this,ee,"readableHighWaterMark",H),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=ee.emitClose!==!1,this.autoDestroy=!!ee.autoDestroy,this.destroyed=!1,this.defaultEncoding=ee.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,ee.encoding&&(y||(y=e("string_decoder/").StringDecoder),this.decoder=new y(ee.encoding),this.encoding=ee.encoding)}function K(ee){if(a=a||e("./_stream_duplex"),!(this instanceof K))return new K(ee);var le=this instanceof a;this._readableState=new F(ee,this,le),this.readable=!0,ee&&(typeof ee.read=="function"&&(this._read=ee.read),typeof ee.destroy=="function"&&(this._destroy=ee.destroy)),s.call(this)}Object.defineProperty(K.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(le){this._readableState&&(this._readableState.destroyed=le)}}),K.prototype.destroy=x.destroy,K.prototype._undestroy=x.undestroy,K.prototype._destroy=function(ee,le){le(ee)},K.prototype.push=function(ee,le){var H=this._readableState,I;return H.objectMode?I=!0:typeof ee=="string"&&(le=le||H.defaultEncoding,le!==H.encoding&&(ee=c.from(ee,le),le=""),I=!0),Q(this,ee,le,!1,I)},K.prototype.unshift=function(ee){return Q(this,ee,null,!0,!1)};function Q(ee,le,H,I,O){f("readableAddChunk",le);var ae=ee._readableState;if(le===null)ae.reading=!1,U(ee,ae);else{var _e;if(O||(_e=B(ae,le)),_e)k(ee,_e);else if(ae.objectMode||le&&le.length>0)if(typeof le!="string"&&!ae.objectMode&&Object.getPrototypeOf(le)!==c.prototype&&(le=d(le)),I)ae.endEmitted?k(ee,new _):Z(ee,ae,le,!0);else if(ae.ended)k(ee,new C);else{if(ae.destroyed)return!1;ae.reading=!1,ae.decoder&&!H?(le=ae.decoder.write(le),ae.objectMode||le.length!==0?Z(ee,ae,le,!1):Y(ee,ae)):Z(ee,ae,le,!1)}else I||(ae.reading=!1,Y(ee,ae))}return!ae.ended&&(ae.length<ae.highWaterMark||ae.length===0)}function Z(ee,le,H,I){le.flowing&&le.length===0&&!le.sync?(le.awaitDrain=0,ee.emit("data",H)):(le.length+=le.objectMode?1:H.length,I?le.buffer.unshift(H):le.buffer.push(H),le.needReadable&&q(ee)),Y(ee,le)}function B(ee,le){var H;return!h(le)&&typeof le!="string"&&le!==void 0&&!ee.objectMode&&(H=new L("chunk",["string","Buffer","Uint8Array"],le)),H}K.prototype.isPaused=function(){return this._readableState.flowing===!1},K.prototype.setEncoding=function(ee){y||(y=e("string_decoder/").StringDecoder);var le=new y(ee);this._readableState.decoder=le,this._readableState.encoding=this._readableState.decoder.encoding;for(var H=this._readableState.buffer.head,I="";H!==null;)I+=le.write(H.data),H=H.next;return this._readableState.buffer.clear(),I!==""&&this._readableState.buffer.push(I),this._readableState.length=I.length,this};var G=1073741824;function w(ee){return ee>=G?ee=G:(ee--,ee|=ee>>>1,ee|=ee>>>2,ee|=ee>>>4,ee|=ee>>>8,ee|=ee>>>16,ee++),ee}function D(ee,le){return ee<=0||le.length===0&&le.ended?0:le.objectMode?1:ee!==ee?le.flowing&&le.length?le.buffer.head.data.length:le.length:(ee>le.highWaterMark&&(le.highWaterMark=w(ee)),ee<=le.length?ee:le.ended?le.length:(le.needReadable=!0,0))}K.prototype.read=function(ee){f("read",ee),ee=parseInt(ee,10);var le=this._readableState,H=ee;if(ee!==0&&(le.emittedReadable=!1),ee===0&&le.needReadable&&((le.highWaterMark!==0?le.length>=le.highWaterMark:le.length>0)||le.ended))return f("read: emitReadable",le.length,le.ended),le.length===0&&le.ended?re(this):q(this),null;if(ee=D(ee,le),ee===0&&le.ended)return le.length===0&&re(this),null;var I=le.needReadable;f("need readable",I),(le.length===0||le.length-ee<le.highWaterMark)&&(I=!0,f("length less than watermark",I)),le.ended||le.reading?(I=!1,f("reading or ended",I)):I&&(f("do read"),le.reading=!0,le.sync=!0,le.length===0&&(le.needReadable=!0),this._read(le.highWaterMark),le.sync=!1,le.reading||(ee=D(H,le)));var O;return ee>0?O=te(ee,le):O=null,O===null?(le.needReadable=le.length<=le.highWaterMark,ee=0):(le.length-=ee,le.awaitDrain=0),le.length===0&&(le.ended||(le.needReadable=!0),H!==ee&&le.ended&&re(this)),O!==null&&this.emit("data",O),O};function U(ee,le){if(f("onEofChunk"),!le.ended){if(le.decoder){var H=le.decoder.end();H&&H.length&&(le.buffer.push(H),le.length+=le.objectMode?1:H.length)}le.ended=!0,le.sync?q(ee):(le.needReadable=!1,le.emittedReadable||(le.emittedReadable=!0,j(ee)))}}function q(ee){var le=ee._readableState;f("emitReadable",le.needReadable,le.emittedReadable),le.needReadable=!1,le.emittedReadable||(f("emitReadable",le.flowing),le.emittedReadable=!0,t.nextTick(j,ee))}function j(ee){var le=ee._readableState;f("emitReadable_",le.destroyed,le.length,le.ended),!le.destroyed&&(le.length||le.ended)&&(ee.emit("readable"),le.emittedReadable=!1),le.needReadable=!le.flowing&&!le.ended&&le.length<=le.highWaterMark,N(ee)}function Y(ee,le){le.readingMore||(le.readingMore=!0,t.nextTick(J,ee,le))}function J(ee,le){for(;!le.reading&&!le.ended&&(le.length<le.highWaterMark||le.flowing&&le.length===0);){var H=le.length;if(f("maybeReadMore read 0"),ee.read(0),H===le.length)break}le.readingMore=!1}K.prototype._read=function(ee){k(this,new u("_read()"))},K.prototype.pipe=function(ee,le){var H=this,I=this._readableState;switch(I.pipesCount){case 0:I.pipes=ee;break;case 1:I.pipes=[I.pipes,ee];break;default:I.pipes.push(ee);break}I.pipesCount+=1,f("pipe count=%d opts=%j",I.pipesCount,le);var O=(!le||le.end!==!1)&&ee!==t.stdout&&ee!==t.stderr,ae=O?Ae:nt;I.endEmitted?t.nextTick(ae):H.once("end",ae),ee.on("unpipe",_e);function _e(qe,W){f("onunpipe"),qe===H&&W&&W.hasUnpiped===!1&&(W.hasUnpiped=!0,Xe())}function Ae(){f("onend"),ee.end()}var Se=oe(H);ee.on("drain",Se);var ze=!1;function Xe(){f("cleanup"),ee.removeListener("close",He),ee.removeListener("finish",Je),ee.removeListener("drain",Se),ee.removeListener("error",Ze),ee.removeListener("unpipe",_e),H.removeListener("end",Ae),H.removeListener("end",nt),H.removeListener("data",Ue),ze=!0,I.awaitDrain&&(!ee._writableState||ee._writableState.needDrain)&&Se()}H.on("data",Ue);function Ue(qe){f("ondata");var W=ee.write(qe);f("dest.write",W),W===!1&&((I.pipesCount===1&&I.pipes===ee||I.pipesCount>1&&ve(I.pipes,ee)!==-1)&&!ze&&(f("false write response, pause",I.awaitDrain),I.awaitDrain++),H.pause())}function Ze(qe){f("onerror",qe),nt(),ee.removeListener("error",Ze),i(ee,"error")===0&&k(ee,qe)}S(ee,"error",Ze);function He(){ee.removeListener("finish",Je),nt()}ee.once("close",He);function Je(){f("onfinish"),ee.removeListener("close",He),nt()}ee.once("finish",Je);function nt(){f("unpipe"),H.unpipe(ee)}return ee.emit("pipe",H),I.flowing||(f("pipe resume"),H.resume()),ee};function oe(ee){return function(){var H=ee._readableState;f("pipeOnDrain",H.awaitDrain),H.awaitDrain&&H.awaitDrain--,H.awaitDrain===0&&i(ee,"data")&&(H.flowing=!0,N(ee))}}K.prototype.unpipe=function(ee){var le=this._readableState,H={hasUnpiped:!1};if(le.pipesCount===0)return this;if(le.pipesCount===1)return ee&&ee!==le.pipes?this:(ee||(ee=le.pipes),le.pipes=null,le.pipesCount=0,le.flowing=!1,ee&&ee.emit("unpipe",this,H),this);if(!ee){var I=le.pipes,O=le.pipesCount;le.pipes=null,le.pipesCount=0,le.flowing=!1;for(var ae=0;ae<O;ae++)I[ae].emit("unpipe",this,{hasUnpiped:!1});return this}var _e=ve(le.pipes,ee);return _e===-1?this:(le.pipes.splice(_e,1),le.pipesCount-=1,le.pipesCount===1&&(le.pipes=le.pipes[0]),ee.emit("unpipe",this,H),this)},K.prototype.on=function(ee,le){var H=s.prototype.on.call(this,ee,le),I=this._readableState;return ee==="data"?(I.readableListening=this.listenerCount("readable")>0,I.flowing!==!1&&this.resume()):ee==="readable"&&!I.endEmitted&&!I.readableListening&&(I.readableListening=I.needReadable=!0,I.flowing=!1,I.emittedReadable=!1,f("on readable",I.length,I.reading),I.length?q(this):I.reading||t.nextTick(me,this)),H},K.prototype.addListener=K.prototype.on,K.prototype.removeListener=function(ee,le){var H=s.prototype.removeListener.call(this,ee,le);return ee==="readable"&&t.nextTick(pe,this),H},K.prototype.removeAllListeners=function(ee){var le=s.prototype.removeAllListeners.apply(this,arguments);return(ee==="readable"||ee===void 0)&&t.nextTick(pe,this),le};function pe(ee){var le=ee._readableState;le.readableListening=ee.listenerCount("readable")>0,le.resumeScheduled&&!le.paused?le.flowing=!0:ee.listenerCount("data")>0&&ee.resume()}function me(ee){f("readable nexttick read 0"),ee.read(0)}K.prototype.resume=function(){var ee=this._readableState;return ee.flowing||(f("resume"),ee.flowing=!ee.readableListening,Ee(this,ee)),ee.paused=!1,this};function Ee(ee,le){le.resumeScheduled||(le.resumeScheduled=!0,t.nextTick(X,ee,le))}function X(ee,le){f("resume",le.reading),le.reading||ee.read(0),le.resumeScheduled=!1,ee.emit("resume"),N(ee),le.flowing&&!le.reading&&ee.read(0)}K.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function N(ee){var le=ee._readableState;for(f("flow",le.flowing);le.flowing&&ee.read()!==null;);}K.prototype.wrap=function(ee){var le=this,H=this._readableState,I=!1;ee.on("end",function(){if(f("wrapped end"),H.decoder&&!H.ended){var _e=H.decoder.end();_e&&_e.length&&le.push(_e)}le.push(null)}),ee.on("data",function(_e){if(f("wrapped data"),H.decoder&&(_e=H.decoder.write(_e)),!(H.objectMode&&_e==null)&&!(!H.objectMode&&(!_e||!_e.length))){var Ae=le.push(_e);Ae||(I=!0,ee.pause())}});for(var O in ee)this[O]===void 0&&typeof ee[O]=="function"&&(this[O]=function(Ae){return function(){return ee[Ae].apply(ee,arguments)}}(O));for(var ae=0;ae<P.length;ae++)ee.on(P[ae],this.emit.bind(this,P[ae]));return this._read=function(_e){f("wrapped _read",_e),I&&(I=!1,ee.resume())},this},typeof Symbol=="function"&&(K.prototype[Symbol.asyncIterator]=function(){return v===void 0&&(v=e("./internal/streams/async_iterator")),v(this)}),Object.defineProperty(K.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(K.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(K.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(le){this._readableState&&(this._readableState.flowing=le)}}),K._fromList=te,Object.defineProperty(K.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function te(ee,le){if(le.length===0)return null;var H;return le.objectMode?H=le.buffer.shift():!ee||ee>=le.length?(le.decoder?H=le.buffer.join(""):le.buffer.length===1?H=le.buffer.first():H=le.buffer.concat(le.length),le.buffer.clear()):H=le.buffer.consume(ee,le.decoder),H}function re(ee){var le=ee._readableState;f("endReadable",le.endEmitted),le.endEmitted||(le.ended=!0,t.nextTick(se,le,ee))}function se(ee,le){if(f("endReadableNT",ee.endEmitted,ee.length),!ee.endEmitted&&ee.length===0&&(ee.endEmitted=!0,le.readable=!1,le.emit("end"),ee.autoDestroy)){var H=le._writableState;(!H||H.autoDestroy&&H.finished)&&le.destroy()}}typeof Symbol=="function"&&(K.from=function(ee,le){return T===void 0&&(T=e("./internal/streams/from")),T(K,ee,le)});function ve(ee,le){for(var H=0,I=ee.length;H<I;H++)if(ee[H]===le)return H;return-1}}).call(this)}).call(this,e("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":13,"./_stream_duplex":14,"./internal/streams/async_iterator":19,"./internal/streams/buffer_list":20,"./internal/streams/destroy":21,"./internal/streams/from":23,"./internal/streams/state":25,"./internal/streams/stream":26,_process:8,buffer:3,events:5,inherits:12,"string_decoder/":27,util:2}],17:[function(e,n,o){n.exports=d;var t=e("../errors").codes,l=t.ERR_METHOD_NOT_IMPLEMENTED,a=t.ERR_MULTIPLE_CALLBACK,i=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=t.ERR_TRANSFORM_WITH_LENGTH_0,c=e("./_stream_duplex");e("inherits")(d,c);function r(f,g){var x=this._transformState;x.transforming=!1;var b=x.writecb;if(b===null)return this.emit("error",new a);x.writechunk=null,x.writecb=null,g!=null&&this.push(g),b(f);var A=this._readableState;A.reading=!1,(A.needReadable||A.length<A.highWaterMark)&&this._read(A.highWaterMark)}function d(f){if(!(this instanceof d))return new d(f);c.call(this,f),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,f&&(typeof f.transform=="function"&&(this._transform=f.transform),typeof f.flush=="function"&&(this._flush=f.flush)),this.on("prefinish",h)}function h(){var f=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(g,x){m(f,g,x)}):m(this,null,null)}d.prototype.push=function(f,g){return this._transformState.needTransform=!1,c.prototype.push.call(this,f,g)},d.prototype._transform=function(f,g,x){x(new l("_transform()"))},d.prototype._write=function(f,g,x){var b=this._transformState;if(b.writecb=x,b.writechunk=f,b.writeencoding=g,!b.transforming){var A=this._readableState;(b.needTransform||A.needReadable||A.length<A.highWaterMark)&&this._read(A.highWaterMark)}},d.prototype._read=function(f){var g=this._transformState;g.writechunk!==null&&!g.transforming?(g.transforming=!0,this._transform(g.writechunk,g.writeencoding,g.afterTransform)):g.needTransform=!0},d.prototype._destroy=function(f,g){c.prototype._destroy.call(this,f,function(x){g(x)})};function m(f,g,x){if(g)return f.emit("error",g);if(x!=null&&f.push(x),f._writableState.length)throw new s;if(f._transformState.transforming)throw new i;return f.push(null)}},{"../errors":13,"./_stream_duplex":14,inherits:12}],18:[function(e,n,o){(function(t,l){(function(){n.exports=F;function a(N){var te=this;this.next=null,this.entry=null,this.finish=function(){X(te,N)}}var i;F.WritableState=P;var s={deprecate:e("util-deprecate")},c=e("./internal/streams/stream"),r=e("buffer").Buffer,d=l.Uint8Array||function(){};function h(N){return r.from(N)}function m(N){return r.isBuffer(N)||N instanceof d}var f=e("./internal/streams/destroy"),g=e("./internal/streams/state"),x=g.getHighWaterMark,b=e("../errors").codes,A=b.ERR_INVALID_ARG_TYPE,M=b.ERR_METHOD_NOT_IMPLEMENTED,L=b.ERR_MULTIPLE_CALLBACK,C=b.ERR_STREAM_CANNOT_PIPE,u=b.ERR_STREAM_DESTROYED,_=b.ERR_STREAM_NULL_VALUES,y=b.ERR_STREAM_WRITE_AFTER_END,v=b.ERR_UNKNOWN_ENCODING,T=f.errorOrDestroy;e("inherits")(F,c);function k(){}function P(N,te,re){i=i||e("./_stream_duplex"),N=N||{},typeof re!="boolean"&&(re=te instanceof i),this.objectMode=!!N.objectMode,re&&(this.objectMode=this.objectMode||!!N.writableObjectMode),this.highWaterMark=x(this,N,"writableHighWaterMark",re),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var se=N.decodeStrings===!1;this.decodeStrings=!se,this.defaultEncoding=N.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ve){U(te,ve)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=N.emitClose!==!1,this.autoDestroy=!!N.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}P.prototype.getBuffer=function(){for(var te=this.bufferedRequest,re=[];te;)re.push(te),te=te.next;return re},function(){try{Object.defineProperty(P.prototype,"buffer",{get:s.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var S;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(S=Function.prototype[Symbol.hasInstance],Object.defineProperty(F,Symbol.hasInstance,{value:function(te){return S.call(this,te)?!0:this!==F?!1:te&&te._writableState instanceof P}})):S=function(te){return te instanceof this};function F(N){i=i||e("./_stream_duplex");var te=this instanceof i;if(!te&&!S.call(F,this))return new F(N);this._writableState=new P(N,this,te),this.writable=!0,N&&(typeof N.write=="function"&&(this._write=N.write),typeof N.writev=="function"&&(this._writev=N.writev),typeof N.destroy=="function"&&(this._destroy=N.destroy),typeof N.final=="function"&&(this._final=N.final)),c.call(this)}F.prototype.pipe=function(){T(this,new C)};function K(N,te){var re=new y;T(N,re),t.nextTick(te,re)}function Q(N,te,re,se){var ve;return re===null?ve=new _:typeof re!="string"&&!te.objectMode&&(ve=new A("chunk",["string","Buffer"],re)),ve?(T(N,ve),t.nextTick(se,ve),!1):!0}F.prototype.write=function(N,te,re){var se=this._writableState,ve=!1,ee=!se.objectMode&&m(N);return ee&&!r.isBuffer(N)&&(N=h(N)),typeof te=="function"&&(re=te,te=null),ee?te="buffer":te||(te=se.defaultEncoding),typeof re!="function"&&(re=k),se.ending?K(this,re):(ee||Q(this,se,N,re))&&(se.pendingcb++,ve=B(this,se,ee,N,te,re)),ve},F.prototype.cork=function(){this._writableState.corked++},F.prototype.uncork=function(){var N=this._writableState;N.corked&&(N.corked--,!N.writing&&!N.corked&&!N.bufferProcessing&&N.bufferedRequest&&Y(this,N))},F.prototype.setDefaultEncoding=function(te){if(typeof te=="string"&&(te=te.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((te+"").toLowerCase())>-1))throw new v(te);return this._writableState.defaultEncoding=te,this},Object.defineProperty(F.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function Z(N,te,re){return!N.objectMode&&N.decodeStrings!==!1&&typeof te=="string"&&(te=r.from(te,re)),te}Object.defineProperty(F.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function B(N,te,re,se,ve,ee){if(!re){var le=Z(te,se,ve);se!==le&&(re=!0,ve="buffer",se=le)}var H=te.objectMode?1:se.length;te.length+=H;var I=te.length<te.highWaterMark;if(I||(te.needDrain=!0),te.writing||te.corked){var O=te.lastBufferedRequest;te.lastBufferedRequest={chunk:se,encoding:ve,isBuf:re,callback:ee,next:null},O?O.next=te.lastBufferedRequest:te.bufferedRequest=te.lastBufferedRequest,te.bufferedRequestCount+=1}else G(N,te,!1,H,se,ve,ee);return I}function G(N,te,re,se,ve,ee,le){te.writelen=se,te.writecb=le,te.writing=!0,te.sync=!0,te.destroyed?te.onwrite(new u("write")):re?N._writev(ve,te.onwrite):N._write(ve,ee,te.onwrite),te.sync=!1}function w(N,te,re,se,ve){--te.pendingcb,re?(t.nextTick(ve,se),t.nextTick(me,N,te),N._writableState.errorEmitted=!0,T(N,se)):(ve(se),N._writableState.errorEmitted=!0,T(N,se),me(N,te))}function D(N){N.writing=!1,N.writecb=null,N.length-=N.writelen,N.writelen=0}function U(N,te){var re=N._writableState,se=re.sync,ve=re.writecb;if(typeof ve!="function")throw new L;if(D(re),te)w(N,re,se,te,ve);else{var ee=J(re)||N.destroyed;!ee&&!re.corked&&!re.bufferProcessing&&re.bufferedRequest&&Y(N,re),se?t.nextTick(q,N,re,ee,ve):q(N,re,ee,ve)}}function q(N,te,re,se){re||j(N,te),te.pendingcb--,se(),me(N,te)}function j(N,te){te.length===0&&te.needDrain&&(te.needDrain=!1,N.emit("drain"))}function Y(N,te){te.bufferProcessing=!0;var re=te.bufferedRequest;if(N._writev&&re&&re.next){var se=te.bufferedRequestCount,ve=new Array(se),ee=te.corkedRequestsFree;ee.entry=re;for(var le=0,H=!0;re;)ve[le]=re,re.isBuf||(H=!1),re=re.next,le+=1;ve.allBuffers=H,G(N,te,!0,te.length,ve,"",ee.finish),te.pendingcb++,te.lastBufferedRequest=null,ee.next?(te.corkedRequestsFree=ee.next,ee.next=null):te.corkedRequestsFree=new a(te),te.bufferedRequestCount=0}else{for(;re;){var I=re.chunk,O=re.encoding,ae=re.callback,_e=te.objectMode?1:I.length;if(G(N,te,!1,_e,I,O,ae),re=re.next,te.bufferedRequestCount--,te.writing)break}re===null&&(te.lastBufferedRequest=null)}te.bufferedRequest=re,te.bufferProcessing=!1}F.prototype._write=function(N,te,re){re(new M("_write()"))},F.prototype._writev=null,F.prototype.end=function(N,te,re){var se=this._writableState;return typeof N=="function"?(re=N,N=null,te=null):typeof te=="function"&&(re=te,te=null),N!=null&&this.write(N,te),se.corked&&(se.corked=1,this.uncork()),se.ending||Ee(this,se,re),this},Object.defineProperty(F.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function J(N){return N.ending&&N.length===0&&N.bufferedRequest===null&&!N.finished&&!N.writing}function oe(N,te){N._final(function(re){te.pendingcb--,re&&T(N,re),te.prefinished=!0,N.emit("prefinish"),me(N,te)})}function pe(N,te){!te.prefinished&&!te.finalCalled&&(typeof N._final=="function"&&!te.destroyed?(te.pendingcb++,te.finalCalled=!0,t.nextTick(oe,N,te)):(te.prefinished=!0,N.emit("prefinish")))}function me(N,te){var re=J(te);if(re&&(pe(N,te),te.pendingcb===0&&(te.finished=!0,N.emit("finish"),te.autoDestroy))){var se=N._readableState;(!se||se.autoDestroy&&se.endEmitted)&&N.destroy()}return re}function Ee(N,te,re){te.ending=!0,me(N,te),re&&(te.finished?t.nextTick(re):N.once("finish",re)),te.ended=!0,N.writable=!1}function X(N,te,re){var se=N.entry;for(N.entry=null;se;){var ve=se.callback;te.pendingcb--,ve(re),se=se.next}te.corkedRequestsFree.next=N}Object.defineProperty(F.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(te){this._writableState&&(this._writableState.destroyed=te)}}),F.prototype.destroy=f.destroy,F.prototype._undestroy=f.undestroy,F.prototype._destroy=function(N,te){te(N)}}).call(this)}).call(this,e("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":13,"./_stream_duplex":14,"./internal/streams/destroy":21,"./internal/streams/state":25,"./internal/streams/stream":26,_process:8,buffer:3,inherits:12,"util-deprecate":28}],19:[function(e,n,o){(function(t){(function(){var l;function a(u,_,y){return _ in u?Object.defineProperty(u,_,{value:y,enumerable:!0,configurable:!0,writable:!0}):u[_]=y,u}var i=e("./end-of-stream"),s=Symbol("lastResolve"),c=Symbol("lastReject"),r=Symbol("error"),d=Symbol("ended"),h=Symbol("lastPromise"),m=Symbol("handlePromise"),f=Symbol("stream");function g(u,_){return{value:u,done:_}}function x(u){var _=u[s];if(_!==null){var y=u[f].read();y!==null&&(u[h]=null,u[s]=null,u[c]=null,_(g(y,!1)))}}function b(u){t.nextTick(x,u)}function A(u,_){return function(y,v){u.then(function(){if(_[d]){y(g(void 0,!0));return}_[m](y,v)},v)}}var M=Object.getPrototypeOf(function(){}),L=Object.setPrototypeOf((l={get stream(){return this[f]},next:function(){var _=this,y=this[r];if(y!==null)return Promise.reject(y);if(this[d])return Promise.resolve(g(void 0,!0));if(this[f].destroyed)return new Promise(function(P,S){t.nextTick(function(){_[r]?S(_[r]):P(g(void 0,!0))})});var v=this[h],T;if(v)T=new Promise(A(v,this));else{var k=this[f].read();if(k!==null)return Promise.resolve(g(k,!1));T=new Promise(this[m])}return this[h]=T,T}},a(l,Symbol.asyncIterator,function(){return this}),a(l,"return",function(){var _=this;return new Promise(function(y,v){_[f].destroy(null,function(T){if(T){v(T);return}y(g(void 0,!0))})})}),l),M),C=function(_){var y,v=Object.create(L,(y={},a(y,f,{value:_,writable:!0}),a(y,s,{value:null,writable:!0}),a(y,c,{value:null,writable:!0}),a(y,r,{value:null,writable:!0}),a(y,d,{value:_._readableState.endEmitted,writable:!0}),a(y,m,{value:function(k,P){var S=v[f].read();S?(v[h]=null,v[s]=null,v[c]=null,k(g(S,!1))):(v[s]=k,v[c]=P)},writable:!0}),y));return v[h]=null,i(_,function(T){if(T&&T.code!=="ERR_STREAM_PREMATURE_CLOSE"){var k=v[c];k!==null&&(v[h]=null,v[s]=null,v[c]=null,k(T)),v[r]=T;return}var P=v[s];P!==null&&(v[h]=null,v[s]=null,v[c]=null,P(g(void 0,!0))),v[d]=!0}),_.on("readable",b.bind(null,v)),v};n.exports=C}).call(this)}).call(this,e("_process"))},{"./end-of-stream":22,_process:8}],20:[function(e,n,o){function t(x,b){var A=Object.keys(x);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(x);b&&(M=M.filter(function(L){return Object.getOwnPropertyDescriptor(x,L).enumerable})),A.push.apply(A,M)}return A}function l(x){for(var b=1;b<arguments.length;b++){var A=arguments[b]!=null?arguments[b]:{};b%2?t(Object(A),!0).forEach(function(M){a(x,M,A[M])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(A)):t(Object(A)).forEach(function(M){Object.defineProperty(x,M,Object.getOwnPropertyDescriptor(A,M))})}return x}function a(x,b,A){return b in x?Object.defineProperty(x,b,{value:A,enumerable:!0,configurable:!0,writable:!0}):x[b]=A,x}function i(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function s(x,b){for(var A=0;A<b.length;A++){var M=b[A];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(x,M.key,M)}}function c(x,b,A){return b&&s(x.prototype,b),x}var r=e("buffer"),d=r.Buffer,h=e("util"),m=h.inspect,f=m&&m.custom||"inspect";function g(x,b,A){d.prototype.copy.call(x,b,A)}n.exports=function(){function x(){i(this,x),this.head=null,this.tail=null,this.length=0}return c(x,[{key:"push",value:function(A){var M={data:A,next:null};this.length>0?this.tail.next=M:this.head=M,this.tail=M,++this.length}},{key:"unshift",value:function(A){var M={data:A,next:this.head};this.length===0&&(this.tail=M),this.head=M,++this.length}},{key:"shift",value:function(){if(this.length!==0){var A=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,A}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(A){if(this.length===0)return"";for(var M=this.head,L=""+M.data;M=M.next;)L+=A+M.data;return L}},{key:"concat",value:function(A){if(this.length===0)return d.alloc(0);for(var M=d.allocUnsafe(A>>>0),L=this.head,C=0;L;)g(L.data,M,C),C+=L.data.length,L=L.next;return M}},{key:"consume",value:function(A,M){var L;return A<this.head.data.length?(L=this.head.data.slice(0,A),this.head.data=this.head.data.slice(A)):A===this.head.data.length?L=this.shift():L=M?this._getString(A):this._getBuffer(A),L}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(A){var M=this.head,L=1,C=M.data;for(A-=C.length;M=M.next;){var u=M.data,_=A>u.length?u.length:A;if(_===u.length?C+=u:C+=u.slice(0,A),A-=_,A===0){_===u.length?(++L,M.next?this.head=M.next:this.head=this.tail=null):(this.head=M,M.data=u.slice(_));break}++L}return this.length-=L,C}},{key:"_getBuffer",value:function(A){var M=d.allocUnsafe(A),L=this.head,C=1;for(L.data.copy(M),A-=L.data.length;L=L.next;){var u=L.data,_=A>u.length?u.length:A;if(u.copy(M,M.length-A,0,_),A-=_,A===0){_===u.length?(++C,L.next?this.head=L.next:this.head=this.tail=null):(this.head=L,L.data=u.slice(_));break}++C}return this.length-=C,M}},{key:f,value:function(A,M){return m(this,l({},M,{depth:0,customInspect:!1}))}}]),x}()},{buffer:3,util:2}],21:[function(e,n,o){(function(t){(function(){function l(d,h){var m=this,f=this._readableState&&this._readableState.destroyed,g=this._writableState&&this._writableState.destroyed;return f||g?(h?h(d):d&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(c,this,d)):t.nextTick(c,this,d)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(d||null,function(x){!h&&x?m._writableState?m._writableState.errorEmitted?t.nextTick(i,m):(m._writableState.errorEmitted=!0,t.nextTick(a,m,x)):t.nextTick(a,m,x):h?(t.nextTick(i,m),h(x)):t.nextTick(i,m)}),this)}function a(d,h){c(d,h),i(d)}function i(d){d._writableState&&!d._writableState.emitClose||d._readableState&&!d._readableState.emitClose||d.emit("close")}function s(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function c(d,h){d.emit("error",h)}function r(d,h){var m=d._readableState,f=d._writableState;m&&m.autoDestroy||f&&f.autoDestroy?d.destroy(h):d.emit("error",h)}n.exports={destroy:l,undestroy:s,errorOrDestroy:r}}).call(this)}).call(this,e("_process"))},{_process:8}],22:[function(e,n,o){var t=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function l(c){var r=!1;return function(){if(!r){r=!0;for(var d=arguments.length,h=new Array(d),m=0;m<d;m++)h[m]=arguments[m];c.apply(this,h)}}}function a(){}function i(c){return c.setHeader&&typeof c.abort=="function"}function s(c,r,d){if(typeof r=="function")return s(c,null,r);r||(r={}),d=l(d||a);var h=r.readable||r.readable!==!1&&c.readable,m=r.writable||r.writable!==!1&&c.writable,f=function(){c.writable||x()},g=c._writableState&&c._writableState.finished,x=function(){m=!1,g=!0,h||d.call(c)},b=c._readableState&&c._readableState.endEmitted,A=function(){h=!1,b=!0,m||d.call(c)},M=function(_){d.call(c,_)},L=function(){var _;if(h&&!b)return(!c._readableState||!c._readableState.ended)&&(_=new t),d.call(c,_);if(m&&!g)return(!c._writableState||!c._writableState.ended)&&(_=new t),d.call(c,_)},C=function(){c.req.on("finish",x)};return i(c)?(c.on("complete",x),c.on("abort",L),c.req?C():c.on("request",C)):m&&!c._writableState&&(c.on("end",f),c.on("close",f)),c.on("end",A),c.on("finish",x),r.error!==!1&&c.on("error",M),c.on("close",L),function(){c.removeListener("complete",x),c.removeListener("abort",L),c.removeListener("request",C),c.req&&c.req.removeListener("finish",x),c.removeListener("end",f),c.removeListener("close",f),c.removeListener("finish",x),c.removeListener("end",A),c.removeListener("error",M),c.removeListener("close",L)}}n.exports=s},{"../../../errors":13}],23:[function(e,n,o){n.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],24:[function(e,n,o){var t;function l(x){var b=!1;return function(){b||(b=!0,x.apply(void 0,arguments))}}var a=e("../../../errors").codes,i=a.ERR_MISSING_ARGS,s=a.ERR_STREAM_DESTROYED;function c(x){if(x)throw x}function r(x){return x.setHeader&&typeof x.abort=="function"}function d(x,b,A,M){M=l(M);var L=!1;x.on("close",function(){L=!0}),t===void 0&&(t=e("./end-of-stream")),t(x,{readable:b,writable:A},function(u){if(u)return M(u);L=!0,M()});var C=!1;return function(u){if(!L&&!C){if(C=!0,r(x))return x.abort();if(typeof x.destroy=="function")return x.destroy();M(u||new s("pipe"))}}}function h(x){x()}function m(x,b){return x.pipe(b)}function f(x){return!x.length||typeof x[x.length-1]!="function"?c:x.pop()}function g(){for(var x=arguments.length,b=new Array(x),A=0;A<x;A++)b[A]=arguments[A];var M=f(b);if(Array.isArray(b[0])&&(b=b[0]),b.length<2)throw new i("streams");var L,C=b.map(function(u,_){var y=_<b.length-1,v=_>0;return d(u,y,v,function(T){L||(L=T),T&&C.forEach(h),!y&&(C.forEach(h),M(L))})});return b.reduce(m)}n.exports=g},{"../../../errors":13,"./end-of-stream":22}],25:[function(e,n,o){var t=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;function l(i,s,c){return i.highWaterMark!=null?i.highWaterMark:s?i[c]:null}function a(i,s,c,r){var d=l(s,r,c);if(d!=null){if(!(isFinite(d)&&Math.floor(d)===d)||d<0){var h=r?c:"highWaterMark";throw new t(h,d)}return Math.floor(d)}return i.objectMode?16:16*1024}n.exports={getHighWaterMark:a}},{"../../../errors":13}],26:[function(e,n,o){n.exports=e("events").EventEmitter},{events:5}],27:[function(e,n,o){var t=e("safe-buffer").Buffer,l=t.isEncoding||function(C){switch(C=""+C,C&&C.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(C){if(!C)return"utf8";for(var u;;)switch(C){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return C;default:if(u)return;C=(""+C).toLowerCase(),u=!0}}function i(C){var u=a(C);if(typeof u!="string"&&(t.isEncoding===l||!l(C)))throw new Error("Unknown encoding: "+C);return u||C}o.StringDecoder=s;function s(C){this.encoding=i(C);var u;switch(this.encoding){case"utf16le":this.text=g,this.end=x,u=4;break;case"utf8":this.fillLast=h,u=4;break;case"base64":this.text=b,this.end=A,u=3;break;default:this.write=M,this.end=L;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(u)}s.prototype.write=function(C){if(C.length===0)return"";var u,_;if(this.lastNeed){if(u=this.fillLast(C),u===void 0)return"";_=this.lastNeed,this.lastNeed=0}else _=0;return _<C.length?u?u+this.text(C,_):this.text(C,_):u||""},s.prototype.end=f,s.prototype.text=m,s.prototype.fillLast=function(C){if(this.lastNeed<=C.length)return C.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);C.copy(this.lastChar,this.lastTotal-this.lastNeed,0,C.length),this.lastNeed-=C.length};function c(C){return C<=127?0:C>>5===6?2:C>>4===14?3:C>>3===30?4:C>>6===2?-1:-2}function r(C,u,_){var y=u.length-1;if(y<_)return 0;var v=c(u[y]);return v>=0?(v>0&&(C.lastNeed=v-1),v):--y<_||v===-2?0:(v=c(u[y]),v>=0?(v>0&&(C.lastNeed=v-2),v):--y<_||v===-2?0:(v=c(u[y]),v>=0?(v>0&&(v===2?v=0:C.lastNeed=v-3),v):0))}function d(C,u,_){if((u[0]&192)!==128)return C.lastNeed=0,"�";if(C.lastNeed>1&&u.length>1){if((u[1]&192)!==128)return C.lastNeed=1,"�";if(C.lastNeed>2&&u.length>2&&(u[2]&192)!==128)return C.lastNeed=2,"�"}}function h(C){var u=this.lastTotal-this.lastNeed,_=d(this,C);if(_!==void 0)return _;if(this.lastNeed<=C.length)return C.copy(this.lastChar,u,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);C.copy(this.lastChar,u,0,C.length),this.lastNeed-=C.length}function m(C,u){var _=r(this,C,u);if(!this.lastNeed)return C.toString("utf8",u);this.lastTotal=_;var y=C.length-(_-this.lastNeed);return C.copy(this.lastChar,0,y),C.toString("utf8",u,y)}function f(C){var u=C&&C.length?this.write(C):"";return this.lastNeed?u+"�":u}function g(C,u){if((C.length-u)%2===0){var _=C.toString("utf16le",u);if(_){var y=_.charCodeAt(_.length-1);if(y>=55296&&y<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=C[C.length-2],this.lastChar[1]=C[C.length-1],_.slice(0,-1)}return _}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=C[C.length-1],C.toString("utf16le",u,C.length-1)}function x(C){var u=C&&C.length?this.write(C):"";if(this.lastNeed){var _=this.lastTotal-this.lastNeed;return u+this.lastChar.toString("utf16le",0,_)}return u}function b(C,u){var _=(C.length-u)%3;return _===0?C.toString("base64",u):(this.lastNeed=3-_,this.lastTotal=3,_===1?this.lastChar[0]=C[C.length-1]:(this.lastChar[0]=C[C.length-2],this.lastChar[1]=C[C.length-1]),C.toString("base64",u,C.length-_))}function A(C){var u=C&&C.length?this.write(C):"";return this.lastNeed?u+this.lastChar.toString("base64",0,3-this.lastNeed):u}function M(C){return C.toString(this.encoding)}function L(C){return C&&C.length?this.write(C):""}},{"safe-buffer":9}],28:[function(e,n,o){(function(t){(function(){n.exports=l;function l(i,s){if(a("noDeprecation"))return i;var c=!1;function r(){if(!c){if(a("throwDeprecation"))throw new Error(s);a("traceDeprecation")?console.trace(s):console.warn(s),c=!0}return i.apply(this,arguments)}return r}function a(i){try{if(!t.localStorage)return!1}catch{return!1}var s=t.localStorage[i];return s==null?!1:String(s).toLowerCase()==="true"}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],29:[function(e,n,o){n.exports={isArray:function(t){return Array.isArray?Array.isArray(t):Object.prototype.toString.call(t)==="[object Array]"}}},{}],30:[function(e,n,o){var t=e("./xml2js"),l=e("./xml2json"),a=e("./js2xml"),i=e("./json2xml");n.exports={xml2js:t,xml2json:l,js2xml:a,json2xml:i}},{"./js2xml":31,"./json2xml":32,"./xml2js":34,"./xml2json":35}],31:[function(e,n,o){var t=e("./options-helper"),l=e("./array-helper").isArray,a,i;function s(_){var y=t.copyOptions(_);return t.ensureFlagExists("ignoreDeclaration",y),t.ensureFlagExists("ignoreInstruction",y),t.ensureFlagExists("ignoreAttributes",y),t.ensureFlagExists("ignoreText",y),t.ensureFlagExists("ignoreComment",y),t.ensureFlagExists("ignoreCdata",y),t.ensureFlagExists("ignoreDoctype",y),t.ensureFlagExists("compact",y),t.ensureFlagExists("indentText",y),t.ensureFlagExists("indentCdata",y),t.ensureFlagExists("indentAttributes",y),t.ensureFlagExists("indentInstruction",y),t.ensureFlagExists("fullTagEmptyElement",y),t.ensureFlagExists("noQuotesForNativeAttributes",y),t.ensureSpacesExists(y),typeof y.spaces=="number"&&(y.spaces=Array(y.spaces+1).join(" ")),t.ensureKeyExists("declaration",y),t.ensureKeyExists("instruction",y),t.ensureKeyExists("attributes",y),t.ensureKeyExists("text",y),t.ensureKeyExists("comment",y),t.ensureKeyExists("cdata",y),t.ensureKeyExists("doctype",y),t.ensureKeyExists("type",y),t.ensureKeyExists("name",y),t.ensureKeyExists("elements",y),t.checkFnExists("doctype",y),t.checkFnExists("instruction",y),t.checkFnExists("cdata",y),t.checkFnExists("comment",y),t.checkFnExists("text",y),t.checkFnExists("instructionName",y),t.checkFnExists("elementName",y),t.checkFnExists("attributeName",y),t.checkFnExists("attributeValue",y),t.checkFnExists("attributes",y),t.checkFnExists("fullTagEmptyElement",y),y}function c(_,y,v){return(!v&&_.spaces?`
`:"")+Array(y+1).join(_.spaces)}function r(_,y,v){if(y.ignoreAttributes)return"";"attributesFn"in y&&(_=y.attributesFn(_,i,a));var T,k,P,S,F=[];for(T in _)_.hasOwnProperty(T)&&_[T]!==null&&_[T]!==void 0&&(S=y.noQuotesForNativeAttributes&&typeof _[T]!="string"?"":'"',k=""+_[T],k=k.replace(/"/g,"&quot;"),P="attributeNameFn"in y?y.attributeNameFn(T,k,i,a):T,F.push(y.spaces&&y.indentAttributes?c(y,v+1,!1):" "),F.push(P+"="+S+("attributeValueFn"in y?y.attributeValueFn(k,T,i,a):k)+S));return _&&Object.keys(_).length&&y.spaces&&y.indentAttributes&&F.push(c(y,v,!1)),F.join("")}function d(_,y,v){return a=_,i="xml",y.ignoreDeclaration?"":"<?xml"+r(_[y.attributesKey],y,v)+"?>"}function h(_,y,v){if(y.ignoreInstruction)return"";var T;for(T in _)if(_.hasOwnProperty(T))break;var k="instructionNameFn"in y?y.instructionNameFn(T,_[T],i,a):T;if(typeof _[T]=="object")return a=_,i=k,"<?"+k+r(_[T][y.attributesKey],y,v)+"?>";var P=_[T]?_[T]:"";return"instructionFn"in y&&(P=y.instructionFn(P,T,i,a)),"<?"+k+(P?" "+P:"")+"?>"}function m(_,y){return y.ignoreComment?"":"<!--"+("commentFn"in y?y.commentFn(_,i,a):_)+"-->"}function f(_,y){return y.ignoreCdata?"":"<![CDATA["+("cdataFn"in y?y.cdataFn(_,i,a):_.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function g(_,y){return y.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in y?y.doctypeFn(_,i,a):_)+">"}function x(_,y){return y.ignoreText?"":(_=""+_,_=_.replace(/&amp;/g,"&"),_=_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in y?y.textFn(_,i,a):_)}function b(_,y){var v;if(_.elements&&_.elements.length)for(v=0;v<_.elements.length;++v)switch(_.elements[v][y.typeKey]){case"text":if(y.indentText)return!0;break;case"cdata":if(y.indentCdata)return!0;break;case"instruction":if(y.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function A(_,y,v){a=_,i=_.name;var T=[],k="elementNameFn"in y?y.elementNameFn(_.name,_):_.name;T.push("<"+k),_[y.attributesKey]&&T.push(r(_[y.attributesKey],y,v));var P=_[y.elementsKey]&&_[y.elementsKey].length||_[y.attributesKey]&&_[y.attributesKey]["xml:space"]==="preserve";return P||("fullTagEmptyElementFn"in y?P=y.fullTagEmptyElementFn(_.name,_):P=y.fullTagEmptyElement),P?(T.push(">"),_[y.elementsKey]&&_[y.elementsKey].length&&(T.push(M(_[y.elementsKey],y,v+1)),a=_,i=_.name),T.push(y.spaces&&b(_,y)?`
`+Array(v+1).join(y.spaces):""),T.push("</"+k+">")):T.push("/>"),T.join("")}function M(_,y,v,T){return _.reduce(function(k,P){var S=c(y,v,T&&!k);switch(P.type){case"element":return k+S+A(P,y,v);case"comment":return k+S+m(P[y.commentKey],y);case"doctype":return k+S+g(P[y.doctypeKey],y);case"cdata":return k+(y.indentCdata?S:"")+f(P[y.cdataKey],y);case"text":return k+(y.indentText?S:"")+x(P[y.textKey],y);case"instruction":var F={};return F[P[y.nameKey]]=P[y.attributesKey]?P:P[y.instructionKey],k+(y.indentInstruction?S:"")+h(F,y,v)}},"")}function L(_,y,v){var T;for(T in _)if(_.hasOwnProperty(T))switch(T){case y.parentKey:case y.attributesKey:break;case y.textKey:if(y.indentText||v)return!0;break;case y.cdataKey:if(y.indentCdata||v)return!0;break;case y.instructionKey:if(y.indentInstruction||v)return!0;break;case y.doctypeKey:case y.commentKey:return!0;default:return!0}return!1}function C(_,y,v,T,k){a=_,i=y;var P="elementNameFn"in v?v.elementNameFn(y,_):y;if(typeof _>"u"||_===null||_==="")return"fullTagEmptyElementFn"in v&&v.fullTagEmptyElementFn(y,_)||v.fullTagEmptyElement?"<"+P+"></"+P+">":"<"+P+"/>";var S=[];if(y){if(S.push("<"+P),typeof _!="object")return S.push(">"+x(_,v)+"</"+P+">"),S.join("");_[v.attributesKey]&&S.push(r(_[v.attributesKey],v,T));var F=L(_,v,!0)||_[v.attributesKey]&&_[v.attributesKey]["xml:space"]==="preserve";if(F||("fullTagEmptyElementFn"in v?F=v.fullTagEmptyElementFn(y,_):F=v.fullTagEmptyElement),F)S.push(">");else return S.push("/>"),S.join("")}return S.push(u(_,v,T+1,!1)),a=_,i=y,y&&S.push((k?c(v,T,!1):"")+"</"+P+">"),S.join("")}function u(_,y,v,T){var k,P,S,F=[];for(P in _)if(_.hasOwnProperty(P))for(S=l(_[P])?_[P]:[_[P]],k=0;k<S.length;++k){switch(P){case y.declarationKey:F.push(d(S[k],y,v));break;case y.instructionKey:F.push((y.indentInstruction?c(y,v,T):"")+h(S[k],y,v));break;case y.attributesKey:case y.parentKey:break;case y.textKey:F.push((y.indentText?c(y,v,T):"")+x(S[k],y));break;case y.cdataKey:F.push((y.indentCdata?c(y,v,T):"")+f(S[k],y));break;case y.doctypeKey:F.push(c(y,v,T)+g(S[k],y));break;case y.commentKey:F.push(c(y,v,T)+m(S[k],y));break;default:F.push(c(y,v,T)+C(S[k],P,y,v,L(S[k],y)))}T=T&&!F.length}return F.join("")}n.exports=function(_,y){y=s(y);var v=[];return a=_,i="_root_",y.compact?v.push(u(_,y,0,!0)):(_[y.declarationKey]&&v.push(d(_[y.declarationKey],y,0)),_[y.elementsKey]&&_[y.elementsKey].length&&v.push(M(_[y.elementsKey],y,0,!v.length))),v.join("")}},{"./array-helper":29,"./options-helper":33}],32:[function(e,n,o){(function(t){(function(){var l=e("./js2xml.js");n.exports=function(a,i){a instanceof t&&(a=a.toString());var s=null;if(typeof a=="string")try{s=JSON.parse(a)}catch{throw new Error("The JSON structure is invalid")}else s=a;return l(s,i)}}).call(this)}).call(this,e("buffer").Buffer)},{"./js2xml.js":31,buffer:3}],33:[function(e,n,o){var t=e("./array-helper").isArray;n.exports={copyOptions:function(l){var a,i={};for(a in l)l.hasOwnProperty(a)&&(i[a]=l[a]);return i},ensureFlagExists:function(l,a){(!(l in a)||typeof a[l]!="boolean")&&(a[l]=!1)},ensureSpacesExists:function(l){(!("spaces"in l)||typeof l.spaces!="number"&&typeof l.spaces!="string")&&(l.spaces=0)},ensureAlwaysArrayExists:function(l){(!("alwaysArray"in l)||typeof l.alwaysArray!="boolean"&&!t(l.alwaysArray))&&(l.alwaysArray=!1)},ensureKeyExists:function(l,a){(!(l+"Key"in a)||typeof a[l+"Key"]!="string")&&(a[l+"Key"]=a.compact?"_"+l:l)},checkFnExists:function(l,a){return l+"Fn"in a}}},{"./array-helper":29}],34:[function(e,n,o){var t=e("sax"),l=e("./options-helper"),a=e("./array-helper").isArray,i,s;function c(C){return i=l.copyOptions(C),l.ensureFlagExists("ignoreDeclaration",i),l.ensureFlagExists("ignoreInstruction",i),l.ensureFlagExists("ignoreAttributes",i),l.ensureFlagExists("ignoreText",i),l.ensureFlagExists("ignoreComment",i),l.ensureFlagExists("ignoreCdata",i),l.ensureFlagExists("ignoreDoctype",i),l.ensureFlagExists("compact",i),l.ensureFlagExists("alwaysChildren",i),l.ensureFlagExists("addParent",i),l.ensureFlagExists("trim",i),l.ensureFlagExists("nativeType",i),l.ensureFlagExists("nativeTypeAttributes",i),l.ensureFlagExists("sanitize",i),l.ensureFlagExists("instructionHasAttributes",i),l.ensureFlagExists("captureSpacesBetweenElements",i),l.ensureAlwaysArrayExists(i),l.ensureKeyExists("declaration",i),l.ensureKeyExists("instruction",i),l.ensureKeyExists("attributes",i),l.ensureKeyExists("text",i),l.ensureKeyExists("comment",i),l.ensureKeyExists("cdata",i),l.ensureKeyExists("doctype",i),l.ensureKeyExists("type",i),l.ensureKeyExists("name",i),l.ensureKeyExists("elements",i),l.ensureKeyExists("parent",i),l.checkFnExists("doctype",i),l.checkFnExists("instruction",i),l.checkFnExists("cdata",i),l.checkFnExists("comment",i),l.checkFnExists("text",i),l.checkFnExists("instructionName",i),l.checkFnExists("elementName",i),l.checkFnExists("attributeName",i),l.checkFnExists("attributeValue",i),l.checkFnExists("attributes",i),i}function r(C){var u=Number(C);if(!isNaN(u))return u;var _=C.toLowerCase();return _==="true"?!0:_==="false"?!1:C}function d(C,u){var _;if(i.compact){if(!s[i[C+"Key"]]&&(a(i.alwaysArray)?i.alwaysArray.indexOf(i[C+"Key"])!==-1:i.alwaysArray)&&(s[i[C+"Key"]]=[]),s[i[C+"Key"]]&&!a(s[i[C+"Key"]])&&(s[i[C+"Key"]]=[s[i[C+"Key"]]]),C+"Fn"in i&&typeof u=="string"&&(u=i[C+"Fn"](u,s)),C==="instruction"&&("instructionFn"in i||"instructionNameFn"in i)){for(_ in u)if(u.hasOwnProperty(_))if("instructionFn"in i)u[_]=i.instructionFn(u[_],_,s);else{var y=u[_];delete u[_],u[i.instructionNameFn(_,y,s)]=y}}a(s[i[C+"Key"]])?s[i[C+"Key"]].push(u):s[i[C+"Key"]]=u}else{s[i.elementsKey]||(s[i.elementsKey]=[]);var v={};if(v[i.typeKey]=C,C==="instruction"){for(_ in u)if(u.hasOwnProperty(_))break;v[i.nameKey]="instructionNameFn"in i?i.instructionNameFn(_,u,s):_,i.instructionHasAttributes?(v[i.attributesKey]=u[_][i.attributesKey],"instructionFn"in i&&(v[i.attributesKey]=i.instructionFn(v[i.attributesKey],_,s))):("instructionFn"in i&&(u[_]=i.instructionFn(u[_],_,s)),v[i.instructionKey]=u[_])}else C+"Fn"in i&&(u=i[C+"Fn"](u,s)),v[i[C+"Key"]]=u;i.addParent&&(v[i.parentKey]=s),s[i.elementsKey].push(v)}}function h(C){if("attributesFn"in i&&C&&(C=i.attributesFn(C,s)),(i.trim||"attributeValueFn"in i||"attributeNameFn"in i||i.nativeTypeAttributes)&&C){var u;for(u in C)if(C.hasOwnProperty(u)&&(i.trim&&(C[u]=C[u].trim()),i.nativeTypeAttributes&&(C[u]=r(C[u])),"attributeValueFn"in i&&(C[u]=i.attributeValueFn(C[u],u,s)),"attributeNameFn"in i)){var _=C[u];delete C[u],C[i.attributeNameFn(u,C[u],s)]=_}}return C}function m(C){var u={};if(C.body&&(C.name.toLowerCase()==="xml"||i.instructionHasAttributes)){for(var _=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,y;(y=_.exec(C.body))!==null;)u[y[1]]=y[2]||y[3]||y[4];u=h(u)}if(C.name.toLowerCase()==="xml"){if(i.ignoreDeclaration)return;s[i.declarationKey]={},Object.keys(u).length&&(s[i.declarationKey][i.attributesKey]=u),i.addParent&&(s[i.declarationKey][i.parentKey]=s)}else{if(i.ignoreInstruction)return;i.trim&&(C.body=C.body.trim());var v={};i.instructionHasAttributes&&Object.keys(u).length?(v[C.name]={},v[C.name][i.attributesKey]=u):v[C.name]=C.body,d("instruction",v)}}function f(C,u){var _;if(typeof C=="object"&&(u=C.attributes,C=C.name),u=h(u),"elementNameFn"in i&&(C=i.elementNameFn(C,s)),i.compact){if(_={},!i.ignoreAttributes&&u&&Object.keys(u).length){_[i.attributesKey]={};var y;for(y in u)u.hasOwnProperty(y)&&(_[i.attributesKey][y]=u[y])}!(C in s)&&(a(i.alwaysArray)?i.alwaysArray.indexOf(C)!==-1:i.alwaysArray)&&(s[C]=[]),s[C]&&!a(s[C])&&(s[C]=[s[C]]),a(s[C])?s[C].push(_):s[C]=_}else s[i.elementsKey]||(s[i.elementsKey]=[]),_={},_[i.typeKey]="element",_[i.nameKey]=C,!i.ignoreAttributes&&u&&Object.keys(u).length&&(_[i.attributesKey]=u),i.alwaysChildren&&(_[i.elementsKey]=[]),s[i.elementsKey].push(_);_[i.parentKey]=s,s=_}function g(C){i.ignoreText||!C.trim()&&!i.captureSpacesBetweenElements||(i.trim&&(C=C.trim()),i.nativeType&&(C=r(C)),i.sanitize&&(C=C.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),d("text",C))}function x(C){i.ignoreComment||(i.trim&&(C=C.trim()),d("comment",C))}function b(C){var u=s[i.parentKey];i.addParent||delete s[i.parentKey],s=u}function A(C){i.ignoreCdata||(i.trim&&(C=C.trim()),d("cdata",C))}function M(C){i.ignoreDoctype||(C=C.replace(/^ /,""),i.trim&&(C=C.trim()),d("doctype",C))}function L(C){C.note=C}n.exports=function(C,u){var _=t.parser(!0,{}),y={};if(s=y,i=c(u),_.opt={strictEntities:!0},_.onopentag=f,_.ontext=g,_.oncomment=x,_.onclosetag=b,_.onerror=L,_.oncdata=A,_.ondoctype=M,_.onprocessinginstruction=m,_.write(C).close(),y[i.elementsKey]){var v=y[i.elementsKey];delete y[i.elementsKey],y[i.elementsKey]=v,delete y.text}return y}},{"./array-helper":29,"./options-helper":33,sax:10}],35:[function(e,n,o){var t=e("./options-helper"),l=e("./xml2js");function a(i){var s=t.copyOptions(i);return t.ensureSpacesExists(s),s}n.exports=function(i,s){var c,r,d,h;return c=a(s),r=l(i,c),h="compact"in c&&c.compact?"_parent":"parent","addParent"in c&&c.addParent?d=JSON.stringify(r,function(m,f){return m===h?"_":f},c.spaces):d=JSON.stringify(r,null,c.spaces),d.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}},{"./options-helper":33,"./xml2js":34}],36:[function(e,n,o){var t,l;l=function(a,i,s){var c,r;return c=i*Math.min(s,1-s),r=function(d,h=(d+a*12)%12){return s-c*Math.max(Math.min(h-3,9-h,1),-1)},[r(0),r(8),r(4)].map(function(d){return d})},t=["red","green","blue","hue","saturation","lightness","value","cyan","magenta","yellow","key","alpha","x","y","z","l","a","b"],n.exports=class{constructor(i){var s,c,r,d,h,m,f,g;for({red:this.red,green:this.green,blue:this.blue,hue:this.hue,saturation:this.saturation,value:this.value,lightness:this.lightness,cyan:c,magenta:m,yellow:g,key:d,alpha:this.alpha,name:this.name}=i,r=0,h=t.length;r<h;r++)if(s=t[r],i[s]!=null){if(!isFinite(i[s])||typeof i[s]!="number")throw new TypeError(`Color component option ${s} is not a finite number: ${JSON.stringify(i[s])}`);if(i[s]<0||i[s]>1)throw new TypeError(`Color component option ${s} outside range of [0,1]: ${i[s]}`)}if(f=function(){throw new TypeError(`Color constructor must be called with {red,green,blue} or {hue,saturation,value} or {hue,saturation,lightness} or {cyan,magenta,yellow,key} or {x,y,z} or {l,a,b}, ${function(){try{return`got ${JSON.stringify(i)}`}catch{return"got something that couldn't be displayed with JSON.stringify for this error message"}}()}`)},!(this.red!=null&&this.green!=null&&this.blue!=null))if(this.hue!=null&&this.saturation!=null){if(this.value!=null)this.lightness=(2-this.saturation)*this.value/2,this.saturation=this.saturation*this.value/(this.lightness<.5?this.lightness*2:2-this.lightness*2),isNaN(this.saturation)&&(this.saturation=0);else if(this.lightness==null){if(i.brightness!=null)throw new TypeError("{hue, saturation, brightness} not supported. Use {hue, saturation, value} instead for an equivalent color space");f()}[this.red,this.green,this.blue]=l(this.hue,this.saturation,this.lightness)}else{if(c!=null&&m!=null&&g!=null&&d!=null)throw new Error("CMYK color space is not currently supported");if(i.l!=null&&i.a!=null&&i.b!=null)throw new Error("L*a*b* color space is not currently supported");if(i.x!=null&&i.y!=null&&i.z!=null)throw new Error("XYZ color space is not currently supported");f()}}toString(){if(this.hue!=null)return this.alpha!=null?`hsla(${this.hue*360}, ${this.saturation*100}%, ${this.lightness*100}%, ${this.alpha})`:`hsl(${this.hue*360}, ${this.saturation*100}%, ${this.lightness*100}%)`;if(this.red!=null)return this.alpha!=null?`rgba(${this.red*255}, ${this.green*255}, ${this.blue*255}, ${this.alpha})`:`rgb(${this.red*255}, ${this.green*255}, ${this.blue*255})`}static is(i,s,c=1e-4){var r,d;return Math.abs(i.red-s.red)<c&&Math.abs(i.green-s.green)<c&&Math.abs(i.blue-s.blue)<c&&Math.abs(((r=i.alpha)!=null?r:1)-((d=s.alpha)!=null?d:1))<c}}},{}],37:[function(e,n,o){var t,l;t=e("./Color"),l=["r","g","b","h","s","l","v","x","y","z","a","b","c","m","y","k","red","green","blue","hue","saturation","lightness","value","cyan","magenta","yellow","key","alpha"],n.exports=class extends Array{constructor(...i){super(...i),this.name=void 0,this.description=void 0,this.numberOfColumns=void 0,this.geometrySpecifiedByFile=void 0}add(i){var s,c,r,d;for(c=0,r=l.length;c<r;c++)if(s=l[c],i[s]!=null){if(!isFinite(i[s])||typeof i[s]!="number")throw new TypeError(`palette.add() component option ${s} is not a finite number: ${JSON.stringify(i[s])}`);if(i[s]<0||i[s]>1)throw new TypeError(`palette.add() component option ${s} outside range of [0,1]: ${i[s]}`)}return d=i instanceof t?i:new t(i),this.push(d)}}},{"./Color":36}],38:[function(e,n,o){var t,l,a,i,s;s=e("jdataview"),l=e("../Palette"),t=2**16-1,a=Object.freeze({RGB:0,HSB:1,CMYK:2,PANTONE:3,FOCOLTONE:4,TRUMATCH:5,TOYO:6,LAB:7,GRAYSCALE:8,WIDE_CMYK:9,HKS:10,DIC:11,TOTAL_INK:12,MONITOR_RGB:13,DUOTONE:14,OPACITY:15,WEB:16,GRAY_FLOAT:17,RGB_FLOAT:18,OPACITY_FLOAT:19,0:"RGB",1:"HSB",2:"CMYK",3:"PANTONE",4:"FOCOLTONE",5:"TRUMATCH",6:"TOYO",7:"LAB",8:"GRAYSCALE",9:"WIDE_CMYK",10:"HKS",11:"DIC",12:"TOTAL_INK",13:"MONITOR_RGB",14:"DUOTONE",15:"OPACITY",16:"WEB",17:"GRAY_FLOAT",18:"RGB_FLOAT",19:"OPACITY_FLOAT"}),i=function(c,r,d){var h,m,f;for(d&&(r-=1),f="",h=0,m=r;0<=m?h<m:h>m;0<=m?h++:h--)f+=String.fromCharCode(c.getUint16());return d&&c.getUint16(),f},n.exports.read_adobe_color_swatch=function({data:c}){var r,d,h,m,f,g,x,b,A,M,L,C,u;if(A=new l,u=new s(c),M=function(_){var y,v,T,k,P,S,F;switch(y=u.getUint16(),k=u.getUint16()/t,P=u.getUint16()/t,S=u.getUint16()/t,F=u.getUint16()/t,_?(u.getUint16(),v=u.getUint16(),T=i(u,v,!0)):T=void 0,y){case a.RGB:return A.add({red:k,green:P,blue:S,name:T});case a.HSB:return A.add({hue:k,saturation:P,value:S,name:T});case a.CMYK:case a.WIDE_CMYK:return A.add({cyan:k,magenta:P,yellow:S,key:F,name:T});case a.LAB:return A.add({l:k,a:P,b:S,name:T});case a.GRAYSCALE:return A.add({red:k,green:k,blue:k,name:T})}},r=u.getUint16(),b=u.getUint16(),r!==1)throw new Error("Not an Adobe Color Swatch file");if(f=4,h=f+b*(5*2),u.byteLength<=h){for(g=0,L=b;0<=L?g<L:g>L;0<=L?g++:g--)M(!1);return A}if(u.seek(h),m=u.getUint16(),d=u.getUint16(),m!==2)throw new Error("Not an Adobe Color Swatch file v2");if(d!==b)throw new Error("Number of colors mismatch between ACO v1 and v2 sections");for(x=0,C=b;0<=C?x<C:x>C;0<=C?x++:x--)M(!0);return A},n.exports.write_adobe_color_swatch=function(c){var r,d,h,m,f,g,x,b,A,M,L;for(L=function(C,u){var _,y,v,T,k,P,S,F,K,Q,Z,B;for(Q=(Z=C.name)!=null?Z:C.toString(),y=a.RGB,k=[C.red,C.green,C.blue,0],B=2+k.length*2,u&&(B+=4+(Q.length+1)*2),v=new s(B),v.writeUint16(y),P=0,F=k.length;P<F;P++)T=k[P],v.writeUint16(T*t);if(u){for(v.writeUint16(0),v.writeUint16(Q.length+1),S=0,K=Q.length;S<K;S++)_=Q[S],v.writeUint16(_.charCodeAt(0));v.writeUint16(0)}return v.buffer},r=function(){var C,u,_;for(_=[],C=0,u=c.length;C<u;C++)m=c[C],_.push(L(m,!1));return _}(),d=function(){var C,u,_;for(_=[],C=0,u=c.length;C<u;C++)m=c[C],_.push(L(m,!0));return _}(),f=4+r.reduce(function(C,u){return C+u.byteLength},0)+2+2+d.reduce(function(C,u){return C+u.byteLength},0),g=new s(f),g.writeUint16(1),g.writeUint16(c.length),x=0,A=r.length;x<A;x++)h=r[x],g.writeBytes(new Uint8Array(h));for(g.writeUint16(2),g.writeUint16(c.length),b=0,M=d.length;b<M;b++)h=d[b],g.writeBytes(new Uint8Array(h));return g.buffer},n.exports.read_adobe_swatch_exchange=function({data:c}){var r,d,h,m,f,g,x,b,A,M,L,C,u,_,y,v,T,k,P;if(v=new l,k=new s(c),k.getString(4)!=="ASEF")throw new Error("Not an Adobe Swatch Exchange file");for(k.getUint32(),y=k.getUint32(),h=49153,d=49154,r=1,m="CMYK",g="RGB ",f="GRAY",P=[],C=0,T=y;0<=T?C<T:C>T;0<=T?C++:C--){switch(A=k.getUint16(),b=k.getUint32(),x=k.tell()+b,A){case h:_=k.getUint16(),u=i(k,_,!0),P.push({name:u});break;case d:P.pop();break;case r:switch(_=k.getUint16(),u=i(k,_,!0),M=k.getString(4),M){case m:v.add({cyan:k.getFloat32(),magenta:k.getFloat32(),yellow:k.getFloat32(),key:k.getFloat32(),name:u});break;case g:v.add({red:k.getFloat32(),green:k.getFloat32(),blue:k.getFloat32(),name:u});break;case f:L=k.getFloat32(),v.add({red:L,green:L,blue:L,name:u})}k.getUint16()}k.seek(x)}return v},n.exports.write_adobe_swatch_exchange=function(c){var r,d,h,m,f,g,x,b,A,M,L,C,u,_,y,v,T,k,P,S,F,K,Q;for(r=1,h="RGB ",d=0,b=[],F=0,u=0,v=c.length;u<v;u++){for(L=c[u],P=(S=L.name)!=null?S:L.toString(),g=r,A=2+(P.length+1)*2+4+3*4+2,f=6+A,x=s(f),x.writeUint16(g),x.writeUint32(A),x.writeUint16(P.length+1),_=0,T=P.length;_<T;_++)M=P[_],x.writeUint16(M.charCodeAt(0));x.writeUint16(0),x.writeString(h),x.writeFloat32(L.red),x.writeFloat32(L.green),x.writeFloat32(L.blue),x.writeUint16(d),b.push(x.buffer),F+=f}for(C=12+F,Q=new s(C),Q.writeString("ASEF"),K=1,Q.writeUint32(K),Q.writeUint32(b.length),y=0,k=b.length;y<k;y++)m=b[y],Q.writeBytes(new Uint8Array(m));return Q.buffer},n.exports.read_adobe_color_book=function({data:c}){var r,d,h,m,f,g,x,b,A,M,L,C,u,_,y,v,T,k;if(u=new l,k=new s(c),v=k.getString(4),v!=="8BCB")throw new Error("Not an Adobe Color Book");if(T=k.getUint16(),T!==1)throw new Error(`Unknown Adobe Color Book version: ${T}?`);for(L=function(P){var S;return S=P.replace(/^"(.*)"$/,"$1"),S.startsWith("$$$")&&(S=S.split("=")[1]),S=S.replace("^R","®"),S=S.replace("^C","©"),S},k.getUint16(),m=L(i(k,k.getUint32(),!1)),b=L(i(k,k.getUint32(),!1)),A=L(i(k,k.getUint32(),!1)),h=L(i(k,k.getUint32())),g=k.getUint16(),k.getUint16(),k.getUint16(),M=k.getUint16(),C=0,y=g;0<=y?C<y:C>y;0<=y?C++:C--)switch(x=L(i(k,k.getUint32(),!1)),f=k.getString(6).trim(),f=f.replace(/^0*(\d+)$/,"$1"),f=f.replace("X","-"),f&&!x&&(_=f.lastIndexOf(A.trim()),x=_>=0?f.slice(0,_):f),r=function(P){if(!(!x.trim()&&!f.trim()))return P.name=b+x+A,u.add(P)},d=function(){throw new Error(`Color space #${M} (${a[M]}) not supported.`)},M){case 0:r({red:k.getUint8()/255,green:k.getUint8()/255,blue:k.getUint8()/255});break;case 1:r({hue:k.getUint8()/255,saturation:k.getUint8()/255,value:k.getUint8()/255});break;case 2:r({cyan:1-k.getUint8()/255,magenta:1-k.getUint8()/255,yellow:1-k.getUint8()/255,key:1-k.getUint8()/255});break;case 3:d();break;case 4:d();break;case 5:d();break;case 6:d();break;case 7:r({l:k.getUint8()/255,a:k.getUint8()/255,b:k.getUint8()/255});break;case 8:d();break;case 9:d();break;case 10:d();break;default:d()}return u.name=m,u.description=h,u}},{"../Palette":37,jdataview:7}],39:[function(e,n,o){var t,l;l=e("jdataview"),t=e("../Palette"),n.exports=function({data:a,fileExt:i}){var s,c,r,d;if(c=new t,d=new l(a),!((r=d.byteLength)===768||r===772||i==="act"))throw new Error(`file size must be 768 or 772 bytes (saw ${d.byteLength}), OR file extension must be '.act' (saw '.${i}')`);for(var s=0;s<256;s++)c.add({red:d.getUint8()/255,green:d.getUint8()/255,blue:d.getUint8()/255});return c.numberOfColumns=16,c},n.exports.write=function(a){var i,s,c;for(c=new l(256*3),i=s=0;s<256;i=++s)c.writeUint8(a[i]?Math.round(a[i].red*255):0),c.writeUint8(a[i]?Math.round(a[i].green*255):0),c.writeUint8(a[i]?Math.round(a[i].blue*255):0);return c.buffer}},{"../Palette":37,jdataview:7}],40:[function(e,n,o){var t,l;l=e("css.escape"),t=e("../Palette"),n.exports=function({fileContentString:a}){var i,s,c,r,d,h,m,f,g,x,b,A,M,L,C,u,_;for(g=0,c=0,d=a.length;c<d;c++)i=a[c],(i==="\0"||i===""||i===""||i===""||i===""||i===""||i===""||i==="\x07"||i==="\b"||i==="\v"||i==="\f"||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i==="\x1B"||i===""||i===""||i===""||i===""||i==="")&&g++;if(g>5)throw new Error("looks like a binary file");for(_=[b=new t,A=new t,C=new t,M=new t,L=new t,u=new t],s=function(y){return parseInt(y,16)},a.replace(/\#([0-9A-F]{3}|[0-9A-F]{6}|[0-9A-F]{4}|[0-9A-F]{8})(?![0-9A-F])/gim,function(y,v){return v.length>4?b.add({red:s(v[0]+v[1])/255,green:s(v[2]+v[3])/255,blue:s(v[4]+v[5])/255,alpha:v.length===8?s(v[6]+v[7])/255:void 0}):A.add({red:s(v[0]+v[0])/255,green:s(v[1]+v[1])/255,blue:s(v[2]+v[2])/255,alpha:v.length===4?s(v[3]+v[3])/255:void 0})}),a.replace(/rgb\(\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*\)/gim,function(y,v,T,k,P,S,F){return C.add({red:Number(v)/(T==="%"?100:255),green:Number(k)/(P==="%"?100:255),blue:Number(S)/(F==="%"?100:255)})}),a.replace(/rgba?\(\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\/)\s*([0-9]*\.?[0-9]+)(%?)\s*\)/gim,function(y,v,T,k,P,S,F,K,Q){return u.add({red:Number(v)/(T==="%"?100:255),green:Number(k)/(P==="%"?100:255),blue:Number(S)/(F==="%"?100:255),alpha:Number(K)/(Q==="%"?100:1)})}),a.replace(/hsl\(\s*([0-9]*\.?[0-9]+)(deg|rad|turn|)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*\)/gim,function(y,v,T,k,P,S,F){return M.add({hue:Number(v)/(T==="rad"?2*Math.PI:T==="turn"?1:360),saturation:Number(k)/(P==="%"?100:1),lightness:Number(S)/(F==="%"?100:1)})}),a.replace(/hsla?\(\s*([0-9]*\.?[0-9]+)(deg|rad|turn|)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\/)\s*([0-9]*\.?[0-9]+)(%?)\s*\)/gim,function(y,v,T,k,P,S,F,K,Q){return L.add({hue:Number(v)/(T==="rad"?2*Math.PI:T==="turn"?1:360),saturation:Number(k)/(P==="%"?100:1),lightness:Number(S)/(F==="%"?100:1),alpha:Number(K)/(Q==="%"?100:1)})}),m=[],r=0,h=_.length;r<h;r++)x=_[r],x.length>=m.length&&(m=x);if(f=m.length,f<4)throw new Error(["No colors found","Only one color found","Only a couple colors found","Only a few colors found"][f]+` (${f})`);return m},n.exports.write_css=function(a){return`:root {
	${a.map(function(i,s){return`--${i.name?l(i.name.replace(/\s/g,"-")):`color-${s+1}`}: ${i};`}).join(`
	`)}
}`},n.exports.write_styl=function(a){return a.map(function(i,s){return`${i.name?l(i.name.replace(/\s/g,"-")):`color-${s+1}`} = ${i};`}).join(`
`)},n.exports.write_less=function(a){return a.map(function(i,s){return`@${i.name?l(i.name.replace(/\s/g,"-")):`color-${s+1}`}: ${i};`}).join(`
`)},n.exports.write_scss=function(a){return a.map(function(i,s){return`$${i.name?l(i.name.replace(/\s/g,"-")):`color-${s+1}`}: ${i};`}).join(`
`)},n.exports.write_sass=function(a){return a.map(function(i,s){return`$${i.name?l(i.name.replace(/\s/g,"-")):`color-${s+1}`}: ${i}`}).join(`
`)}},{"../Palette":37,"css.escape":4}],41:[function(e,n,o){var t,l;l=e("jdataview"),t=e("../Palette"),n.exports=function({data:a,fileExt:i}){var s,c,r,d,h,m,f;if(i!=="cs")throw new Error(`ColorSchemer loader is only enabled when file extension is '.cs' (saw '.${i}' instead)`);for(h=new t,d=!0,f=new l(a,0,void 0,d),f.getUint16(),s=f.getUint16(),c=r=0,m=s;0<=m?r<m:r>m;c=0<=m?++r:--r)f.seek(8+c*26),h.add({red:f.getUint8()/255,green:f.getUint8()/255,blue:f.getUint8()/255});return h}},{"../Palette":37,jdataview:7}],42:[function(e,n,o){var t,l,a;t=e("../Palette"),l=function(i,s){var c,r,d,h,m,f;if(d=i.split(/\r?\n/),d[0]!==s)throw new Error(`Not a ${s}`);for(m=new t,r=0;(r+=1)<d.length;)if(c=d[r],!(c[0]==="#"||c==="")){if(h=c.match(/Name:\s*(.*)/),h){m.name=h[1];continue}if(h=c.match(/Columns:\s*(.*)/),h){m.numberOfColumns=Number(h[1]),m.geometrySpecifiedByFile=!0;continue}if(f=c.match(/^\s*([0-9]+)\s+([0-9]+)\s+([0-9]+)(?:\s+(.*))?$/),!f)throw new Error(`Line ${r+1} doesn't match pattern of red green blue name`);m.add({red:Number(f[1])/255,green:Number(f[2])/255,blue:Number(f[3])/255,name:f[4]})}return m},n.exports=function({fileContentString:i}){return l(i,"GIMP Palette")},a=function(i,s){return`${s||"GIMP Palette"}
Name: ${i.name||"Saved Colors"}
Columns: ${i.numberOfColumns||8}
#
${i.map(c=>{var r,d,h;return{red:h,green:d,blue:r}=c,`${[h,d,r].map(m=>`${Math.round(m*255)}`.padEnd(3," ")).join(" ")}   ${c.name||c}`}).join(`
`)}`},n.exports.write=function(i){return a(i,"GIMP Palette")},n.exports.extension="gpl",n.exports.write_gimp_or_kde_rgb_palette=a,n.exports.parse_gimp_or_kde_rgb_palette=l},{"../Palette":37}],43:[function(e,n,o){var t;t=e("../Palette"),n.exports=function({fileContentString:l}){var a,i,s,c,r,d;if(c=l.split(/\r?\n/),c[0]!=="Palette")throw new Error("Not a Homesite palette");if(!c[1].match(/Version [34]\.0/))throw new Error("Unsupported Homesite palette version");for(d=new t,a=0,i=c.length;a<i;a++)s=c[a],r=s.match(/(\d+)\s+(\d+)\s+(\d+)/),r&&d.add({red:Number(r[1])/255,green:Number(r[2])/255,blue:Number(r[3])/255});return d},n.exports.write=function(l){return`Palette
Version 4.0
-----------
${l.map(function(a){return`${Math.round(a.red*255)} ${Math.round(a.green*255)} ${Math.round(a.blue*255)}`}).join(`
`)}`}},{"../Palette":37}],44:[function(e,n,o){var t,l;({parse_gimp_or_kde_rgb_palette:t,write_gimp_or_kde_rgb_palette:l}=e("./GIMP")),n.exports=function({fileContentString:a}){return t(a,"KDE RGB Palette")},n.exports.write=function(a){return l(a,"KDE RGB Palette")},n.exports.extension="colors"},{"./GIMP":42}],45:[function(e,n,o){var t;t=e("../Palette"),n.exports=function({fileContentString:l}){var a,i,s,c,r,d,h;for(d=new t,a=function(m){return parseInt(m,16)},h=l.split(/\r?\n/),i=0,s=h.length;i<s;i++)c=h[i],r=c.match(/^([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i),r&&d.add({alpha:a(r[1])/255,red:a(r[2])/255,green:a(r[3])/255,blue:a(r[4])/255});return d},n.exports.write=function(l){var a,i,s;return i=function(c){var r;return r=Math.round(c*255).toString(16),r.length===1?`0${r}`:r},s=function(c){var r,d,h,m;return{alpha:r,red:m,green:h,blue:d}=c,r==null&&(r=1),[r,m,h,d].map(i).join("")},a=`Paint.NET Palette File
Lines that start with a semicolon are comments
Colors are written as 8-digit hexadecimal numbers: aarrggbb
For example, this would specify green: FF00FF00
The alpha ('aa') value specifies how transparent a color is. FF is fully opaque, 00 is fully transparent.
A palette must consist of ninety six (96) colors. If there are less than this, the remaining color
slots will be set to white (FFFFFFFF). If there are more, then the remaining colors will be ignored.

`,l.name&&(a+=`Palette Name: ${l.name}
`),l.description&&(a+=`Description: ${l.description}
`),a+=`Colors: ${l.length}
`,l.numberOfColumns&&(a+=`Columns: ${l.numberOfColumns}
`),a=`; ${a}`.replace(/\n/g,`
; `).replace(/\s*\n/g,`
`),`${a}
${l.map(s).join(`
`)}`}},{"../Palette":37}],46:[function(e,n,o){var t;t=e("../Palette"),n.exports=function({fileContentString:l}){var a,i,s,c,r,d,h;if(r=l.split(/[\n\r]+/m),r[0]!=="JASC-PAL")throw new Error("Not a JASC-PAL");if(r[1]!=="0100")throw new Error("Unknown JASC-PAL version");for(d=new t,a=i=0,s=r.length;i<s;a=++i)c=r[a],c!==""&&a>2&&(h=c.split(" "),d.add({red:Number(h[0])/255,green:Number(h[1])/255,blue:Number(h[2])/255}));return d},n.exports.write=function(l){return`JASC-PAL
0100
${l.length}
${l.map(function(a){return`${Math.round(a.red*255)} ${Math.round(a.green*255)} ${Math.round(a.blue*255)}`}).join(`
`)}`}},{"../Palette":37}],47:[function(e,n,o){var t,l;l=e("jdataview"),t=e("../Palette"),n.exports=function({data:a}){var i,s,c,r,d,h,m,f,g,x;if(r=!0,x=new l(a,0,void 0,r),f=x.getString(4),x.getUint32(),g=x.getString(4),f!=="RIFF")throw new Error("RIFF header not found; not a RIFF PAL file");if(g!=="PAL ")throw new Error(`RIFF header says this isn't a PAL file,
more of a sort of ${(g+"").trim()} file`);if(i=x.getString(4),x.getUint32(),d=x.getUint16(),s=x.getUint16(),i!=="data")throw new Error(`Data chunk not found (...'${i}'?)`);if(d!==768)throw new Error(`Unsupported PAL file format version: 0x${d.toString(16)}`);for(h=new t,c=0,m=s;0<=m?c<m:c>m;0<=m?c++:c--)h.add({red:x.getUint8()/255,green:x.getUint8()/255,blue:x.getUint8()/255}),x.getUint8();return h},n.exports.write=function(a){var i,s,c,r,d,h,m,f;for(s=4+4*a.length,c=8+s,r=12+c,f=!0,d=new l(r,0,void 0,f),d.writeString("RIFF"),d.writeUint32(c+4),d.writeString("PAL "),d.writeString("data"),d.writeUint32(s),d.writeUint16(768),d.writeUint16(a.length),h=0,m=a.length;h<m;h++)i=a[h],d.writeUint8(Math.round(i.red*255)),d.writeUint8(Math.round(i.green*255)),d.writeUint8(Math.round(i.blue*255)),d.writeUint8(0);return d.buffer}},{"../Palette":37,jdataview:7}],48:[function(e,n,o){var t,l;t=e("../Palette"),{parse_css_hex_color:l}=e("../helpers"),n.exports=function({fileContentString:a}){var i,s,c,r,d,h,m,f,g,x,b,A,M,L,C;for(b=a.split(/[\n\r]+/m),L=new t,h={set_name:function(u){return L.name=u},add_comments:function(u){return L.description==null&&(L.description=""),L.description.length>0&&(L.description+=`
`),L.description+=u},set_columns:function(u){return L.numberOfColumns=u,L.geometrySpecifiedByFile=!0},hexcolor:function(u,_){var y;return y=l("#"+u),y.name=_,L.add(y)},rgbcolor:function(u,_,y,v){return L.add({red:u/255,green:_/255,blue:y/255,name:v})},color:function([u,_,y,v]){switch(u){case"RGB":return L.add({red:_[0],green:_[1],blue:_[2],alpha:y,name:v});case"Grayscale":return L.add({red:_[0],green:_[0],blue:_[0],alpha:y,name:v});case"CMYK":return L.add({cyan:_[0],magenta:_[1],yellow:_[2],key:_[3],alpha:y,name:v});case"HSL":return L.add({hue:_[0],saturation:_[1],lightness:_[2],alpha:y,name:v})}}},C=function(u,_){var y,v,T,k,P,S,F;for(y=[],v=0,P=function(){var K,Q;if(Q="",K=u[v],K!=="'"&&K!=='"')throw new Error("Expected to start parsing string on a quote character");for(v+=1;v<u.length;){if(u[v]==="\\")v+=1,u[v]==="\\"?Q+="\\":u[v]==="r"?Q+="\r":u[v]==="n"?Q+=`
`:u[v]==="t"?Q+="	":u[v]==="v"?Q+="\v":u[v]==="a"?Q+="a":u[v]==="b"?Q+="\b":u[v]==="'"?Q+="'":u[v]==='"'?Q+='"':u[v].match(/\d/)||u[v]==="x"||u[v]==="N"||u[v]==="u"||u[v]==="U"||(console.log(`Warning: unecessary escape in python string: \\${u[v]}`),Q+=u[v]);else{if(u[v]===K)return Q;Q+=u[v]}v+=1}throw new SyntaxError(`Expected end of string on line ${_}`)},k=function(){var K;for(K="";v<u.length&&u[v].match(/[\d\.]/);){K+=u[v];v+=1}return v-=1,parseFloat(K)},T=function(){var K,Q,Z;for(v+=1,Z=[];v<u.length;){if(u[v]==="u")if(v+=1,(K=u[v])==="'"||K==='"')Z.push(P());else throw new SyntaxError(`Unexpected 'u${u.slice(v)}' on line ${_}`);else if((Q=u[v])==="'"||Q==='"')Z.push(P());else if(u[v]==="[")Z.push(T());else if(u[v].match(/\d/))Z.push(k());else{if(u[v]==="]")return Z;if(u[v]!==","){if(u[v].match(/\S/))throw new SyntaxError(`Unexpected '${u.slice(v)}' on line ${_}`)}}v+=1}throw new SyntaxError(`Expected end of array on line ${_}`)};v<u.length;){if(u[v]==="u")if(v+=1,(S=u[v])==="'"||S==='"')y.push(P());else throw new SyntaxError(`Unexpected 'u${u.slice(v)}' on line ${_}`);else if((F=u[v])==="'"||F==='"')y.push(P());else if(u[v]==="[")y.push(T());else if(u[v].match(/\d/))y.push(k());else if(u[v]!==","){if(u[v].match(/\S/))throw new SyntaxError(`Unexpected '${u.slice(v)}' on line ${_}`)}v+=1}return y},x=m=0,f=b.length;m<f;x=++m)g=b[x],A=g.match(/([\w_]+)\((.*)\)/),A&&([i,d,c]=A,r=h[d],r&&(s=C(c,x+1),r(...s)));if(M=L.length,M<2)throw new Error(["No colors found","Only one color found"][M]+` (${M})`);return L},n.exports.write=function(a){var i,s,c,r,d,h,m,f,g,x,b,A,M,L,C;if(L=function(u){return`'${u.replace(/[\r\n]+/g," ").replace(/'/g,"\\'")}'`},C=`##sK1 palette
`,C+=`palette()
`,a.name&&(C+=`set_name(${L(a.name)})
`),a.source&&(C+=`set_source(${L(a.source)})
`),a.description)for(b=a.description.split(/\r?\n/g),d=0,f=b.length;d<f;d++)h=b[d],C+=`add_comments(${L(h)})
`;for(a.numberOfColumns&&(C+=`set_columns(${a.numberOfColumns})
`),m=0,g=a.length;m<g;m++)s=a[m],s.hue!=null?(c="HSL",r=[s.hue,s.saturation,s.lightness]):(c="RGB",r=[s.red,s.green,s.blue]),i=(A=s.alpha)!=null?A:1,x=(M=s.name)!=null?M:s.toString(),C+=`color([${L(c)}, [${r.join(", ")}], ${i}, ${L(x)}])
`;return C+=`palette_end()
`,C}},{"../Palette":37,"../helpers":56}],49:[function(e,n,o){var t;t=e("../Palette"),n.exports=function({fileContentString:l}){var a,i,s,c,r,d,h;if(r=l.split(/[\n\r]+/m),r[0]!=="##Sketch RGBPalette 0")throw new Error("Not a Skencil palette");for(d=new t,c=a=0,i=r.length;a<i;c=++a)if(s=r[c],!(s[0]==="#"||s==="")){if(h=s.match(/^\s*([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)(?:\s+(.*))?$/),!h)throw new Error(`Line ${c+1} doesn't match pattern of red green blue name`);d.add({red:Number(h[1]),green:Number(h[2]),blue:Number(h[3]),name:h[4]})}return d},n.exports.write=function(l){return`##Sketch RGBPalette 0
${l.map(function(a){var i;return`${a.red.toFixed(6)} ${a.green.toFixed(6)} ${a.blue.toFixed(6)} ${(i=a.name)!=null?i:a}`}).join(`
`)}`}},{"../Palette":37}],50:[function(e,n,o){var t,l;l=e("jdataview"),t=e("../Palette"),n.exports=function({data:a}){var i,s,c;if(s=new t,c=new l(a),c.byteLength!==768)throw new Error(`Wrong file size, must be 768 bytes long (not ${c.byteLength})`);for(var i=0;i<256;i++)s.add({red:c.getUint8()/255,green:c.getUint8()/255,blue:c.getUint8()/255});return s},n.exports.write=function(a){var i,s,c;for(c=new l(256*3),i=s=0;s<256;i=++s)c.writeUint8(a[i]?Math.round(a[i].red*255):0),c.writeUint8(a[i]?Math.round(a[i].green*255):0),c.writeUint8(a[i]?Math.round(a[i].blue*255):0);return c.buffer}},{"../Palette":37,jdataview:7}],51:[function(e,n,o){var t,l;l=e("jdataview"),t=e("../Palette"),n.exports=function({data:a}){var i,s,c;if(s=new t,c=new l(a),c.byteLength!==1024)throw new Error(`Wrong file size, must be 1024 bytes long (not ${c.byteLength})`);for(var i=0;i<256;i++)s.add({red:c.getUint8()/255,green:c.getUint8()/255,blue:c.getUint8()/255}),c.getUint8();return s.numberOfColumns=16,s},n.exports.write=function(a){var i,s,c;for(c=new l(256*4),i=s=0;s<256;i=++s)c.writeUint8(a[i]?Math.round(a[i].red*255):0),c.writeUint8(a[i]?Math.round(a[i].green*255):0),c.writeUint8(a[i]?Math.round(a[i].blue*255):0),c.writeUint8(0);return c.buffer}},{"../Palette":37,jdataview:7}],52:[function(e,n,o){var t,l,a,i;l=e("xml-js"),t=e("../Palette"),{parse_css_hex_color:a}=e("../helpers"),n.exports.read_soc=function({fileContentString:s}){var c,r,d,h,m,f,g,x,b,A,M,L,C,u;if(!s.match(/^\s*<\?\s*xml/i))throw new Error("not a StarOffice palette (no <?xml...?> declaration)");if(x=new t,b=l.xml2js(s,{compact:!1}),!((A=b.elements)!=null&&A.length))throw new Error("No XML elements found");for(M=b.elements,h=0,f=M.length;h<f;h++)if(d=M[h],(L=d.name)!=null&&L.match(/:color-table$/)&&d.elements)for(C=d.elements,m=0,g=C.length;m<g;m++)c=C[m],c.name==="draw:color"&&((u=c.attributes["draw:color"])!=null&&u.match(/#/))&&(r=a(c.attributes["draw:color"]),r.name=c.attributes["draw:name"],x.add(r));return x},i=function(s,c){var r,d,h;return d=function(m){var f;return f=Math.round(m*255).toString(16),f.length===1?`0${f}`:f},h=function(m){var f,g,x;return{red:x,green:g,blue:f}=m,"#"+[x,g,f].map(d).join("")},l.js2xml({declaration:{attributes:{version:"1.0",encoding:"UTF-8"}},elements:[{type:"element",name:c?"ooo:color-table":"office:color-table",attributes:c?{"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:svg":"http://www.w3.org/2000/svg","xmlns:ooo":"http://openoffice.org/2004/office"}:{"xmlns:form":"http://openoffice.org/2000/form","xmlns:number":"http://openoffice.org/2000/datastyle","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:office":"http://openoffice.org/2000/office","xmlns:meta":"http://openoffice.org/2000/meta","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:svg":"http://www.w3.org/2000/svg","xmlns:dr3d":"http://openoffice.org/2000/dr3d","xmlns:text":"http://openoffice.org/2000/text","xmlns:style":"http://openoffice.org/2000/style","xmlns:script":"http://openoffice.org/2000/script","xmlns:chart":"http://openoffice.org/2000/chart","xmlns:draw":"http://openoffice.org/2000/drawing","xmlns:table":"http://openoffice.org/2000/table","xmlns:fo":"http://www.w3.org/1999/XSL/Format","xmlns:config":"http://openoffice.org/2001/config","xmlns:dc":"http://purl.org/dc/elements/1.1/"},elements:function(){var m,f,g;for(g=[],m=0,f=s.length;m<f;m++)r=s[m],g.push({type:"element",name:"draw:color",attributes:{"draw:name":r.name||r.toString(),"draw:color":h(r)}});return g}()}]},{spaces:"	"})},n.exports.write_staroffice_soc=function(s){return i(s,!1)},n.exports.write_libreoffice_soc=function(s){return i(s,!0)}},{"../Palette":37,"../helpers":56,"xml-js":30}],53:[function(e,n,o){var t,l,a;t=e("../Palette"),{parse_css_hex_color:l}=e("../helpers"),a=1.4,n.exports=function({fileContentString:i}){var s,c,r,d,h,m,f,g,x,b,A;if(!i.match(/^\s*{/))throw new Error("not sketchpalette JSON");if(b=JSON.parse(i),r=b.compatibleVersion,s=(A=b.colors)!=null?A:[],x=new t,r&&r>a)throw new Error(`Can't handle compatibleVersion of ${r}.`);if(!r||r<1.4)for(h=0,f=s.length;h<f;h++)d=s[h],x.add(l(d));else if(s.length>0)for(m=0,g=s.length;m<g;m++)c=s[m],x.add(c);return x},n.exports.write=function(i){return JSON.stringify({compatibleVersion:"1.4",pluginVersion:"1.4",colors:i.map(function(s){var c,r,d,h;return{red:h,green:d,blue:r,alpha:c}=s,c==null&&(c=1),{red:h,green:d,blue:r,alpha:c}})},null,"	")},n.exports.extension="sketchpalette"},{"../Palette":37,"../helpers":56}],54:[function(e,n,o){var t;t=e("../Palette"),n.exports=function({fileContentString:l}){var a,i,s,c,r,d,h,m,f,g,x,b,A;for(h=l.split(/[\n\r]+/m),x=[a=new t,b=new t],A=function(M,L,C){var u;if(u=M.match(C),u)return L.add({red:Number(u[1])/255,green:Number(u[2])/255,blue:Number(u[3])/255})},i=0,c=h.length;i<c;i++)d=h[i],A(d,a,/([0-9]*\.?[0-9]+),\s*([0-9]*\.?[0-9]+),\s*([0-9]*\.?[0-9]+)/),A(d,b,/([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)/);for(m=[],s=0,r=x.length;s<r;s++)g=x[s],g.length>=m.length&&(m=g);if(f=m.length,f<4)throw new Error(["No colors found","Only one color found","Only a couple colors found","Only a few colors found"][f]+` (${f})`);return m.every(function(M){return M.red<=1/255&&M.green<=1/255&&M.blue<=1/255})&&m.forEach(function(M){return M.red*=255,M.green*=255,M.blue*=255}),m}},{"../Palette":37}],55:[function(e,n,o){var t,l,a;t=e("../Palette"),l=function(i){var s,c,r,d;return c={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([^=]+?)\s*=\s*(.*?)\s*$/,comment:/^\s*;.*$/},d={},s=i.split(/[\r\n]+/),r=null,s.forEach(function(h){var m;c.comment.test(h)||(c.param.test(h)?(m=h.match(c.param),r?d[r][m[1]]=m[2]:d[m[1]]=m[2]):c.section.test(h)?(m=h.match(c.section),d[m[1]]={},r=m[1]):h.length===0&&r&&(r=null))}),d},a=function(i){var s,c,r,d,h,m,f,g,x,b;if(b=l(i),s=b["Control Panel\\Colors"],!s)throw new Error("Invalid theme file, no [Control Panel\\Colors] section");g=new t;for(m in s)if(!m.match(/\W/)&&(r=s[m].split(" "),r.length===3)){for(d=h=0,f=r.length;h<f;d=++h)c=r[d],r[d]=parseInt(c,10);r.every(function(A){return isFinite(A)})&&g.add({red:r[0]/255,green:r[1]/255,blue:r[2]/255,name:m})}return g.name=(x=b.Theme)!=null?x.DisplayName:void 0,g},n.exports=function({fileContentString:i}){return a(i)}},{"../Palette":37}],56:[function(e,n,o){n.exports.parse_css_hex_color=function(t){var l,a,i,s;return i=function(c){return parseInt(c,16)},s=t.match(/\#([0-9A-F]{3}|[0-9A-F]{6}|[0-9A-F]{4}|[0-9A-F]{8})(?![0-9A-F])/im),[l,a]=s,a.length>4?{red:i(a[0]+a[1])/255,green:i(a[2]+a[3])/255,blue:i(a[4]+a[5])/255,alpha:a.length===8?i(a[6]+a[7])/255:void 0}:{red:i(a[0]+a[0])/255,green:i(a[1]+a[1])/255,blue:i(a[2]+a[2])/255,alpha:a.length===4?i(a[3]+a[3])/255:void 0}}},{}],57:[function(e,n,o){var t,l,a,i,s,c,r,d,h,m,f,g,x=[].splice;for(i=e("./Palette"),l=e("./Color"),a=class extends Error{constructor(A){var M;super(),this.errors=A,this.message="Some errors were encountered when loading:"+(function(){var L,C,u,_;for(u=this.errors,_=[],L=0,C=u.length;L<C;L++)M=u[L],_.push(`
	`+M.message);return _}).call(this)}},r={PAINT_SHOP_PRO_PALETTE:{name:"Paint Shop Pro palette",fileExtensions:["psppalette","pal"],readFromText:e("./formats/PaintShopPro"),write:e("./formats/PaintShopPro").write},RIFF_PALETTE:{name:"RIFF PAL",fileExtensions:["pal"],read:e("./formats/RIFF"),write:e("./formats/RIFF").write},COLORSCHEMER_PALETTE:{name:"ColorSchemer palette",fileExtensions:["cs"],read:e("./formats/ColorSchemer")},PAINTDOTNET_PALETTE:{name:"Paint.NET palette",fileExtensions:["txt"],readFromText:e("./formats/Paint.NET"),write:e("./formats/Paint.NET").write},GIMP_PALETTE:{name:"GIMP palette",fileExtensions:["gpl","gimp","colors"],readFromText:e("./formats/GIMP"),write:e("./formats/GIMP").write},KDE_RGB_PALETTE:{name:"KolourPaint palette",fileExtensions:["colors"],readFromText:e("./formats/KolourPaint"),write:e("./formats/KolourPaint").write},SKENCIL_PALETTE:{name:"Skencil palette",fileExtensions:["spl"],readFromText:e("./formats/SPL"),write:e("./formats/SPL").write},SKETCH_JSON_PALETTE:{name:"Sketch palette",fileExtensions:["sketchpalette"],readFromText:e("./formats/sketchpalette"),write:e("./formats/sketchpalette").write},SK1_PALETTE:{name:"sK1 palette",fileExtensions:["skp"],readFromText:e("./formats/SKP"),write:e("./formats/SKP").write},WINDOWS_THEME_COLORS:{name:"Windows desktop theme",fileExtensions:["theme","themepack"],readFromText:e("./formats/theme")},ADOBE_SWATCH_EXCHANGE_PALETTE:{name:"Adobe Swatch Exchange",fileExtensions:["ase"],read:e("./formats/Adobe").read_adobe_swatch_exchange,write:e("./formats/Adobe").write_adobe_swatch_exchange},ADOBE_COLOR_BOOK_PALETTE:{name:"Adobe Color Book",fileExtensions:["acb"],read:e("./formats/Adobe").read_adobe_color_book},STAROFFICE_PALETTE:{name:"StarOffice Colors",fileExtensions:["soc"],readFromText:e("./formats/StarOffice").read_soc,write:e("./formats/StarOffice").write_libreoffice_soc},CSS_VARIABLES:{name:"CSS variables",fileExtensions:["css"],write:e("./formats/CSS").write_css},SCSS_VARIABLES:{name:"SCSS variables",fileExtensions:["scss"],write:e("./formats/CSS").write_scss},SASS_VARIABLES:{name:"SASS variables",fileExtensions:["sass"],write:e("./formats/CSS").write_sass},LESS_VARIABLES:{name:"LESS variables",fileExtensions:["less"],write:e("./formats/CSS").write_less},STYLUS_VARIABLES:{name:"Stylus variables",fileExtensions:["styl"],write:e("./formats/CSS").write_styl},CSS_COLORS:{name:"CSS colors",fileExtensions:["css","scss","sass","less","styl","html","htm","svg","js","ts","xml","txt"],readFromText:e("./formats/CSS")},HOMESITE_PALETTE:{name:"Homesite palette",fileExtensions:["hpl"],readFromText:e("./formats/Homesite"),write:e("./formats/Homesite").write},ADOBE_COLOR_SWATCH_PALETTE:{name:"Adobe Color Swatch",fileExtensions:["aco"],read:e("./formats/Adobe").read_adobe_color_swatch,write:e("./formats/Adobe").write_adobe_color_swatch},ADOBE_COLOR_TABLE_PALETTE:{name:"Adobe Color Table",fileExtensions:["act"],read:e("./formats/AdobeColorTable"),write:e("./formats/AdobeColorTable").write},STARCRAFT_PALETTE:{name:"StarCraft palette",fileExtensions:["pal"],read:e("./formats/StarCraft"),write:e("./formats/StarCraft").write},STARCRAFT_PADDED:{name:"StarCraft terrain palette",fileExtensions:["wpe"],read:e("./formats/StarCraftPadded"),write:e("./formats/StarCraftPadded").write},TABULAR:{name:"tabular colors",fileExtensions:["csv","tsv","txt"],readFromText:e("./formats/tabular")}},g=Object.keys(r),d=0,h=g.length;d<h;d++)c=g[d],s=r[c],s.fileExtensionsPretty=`.${s.fileExtensions.join(", .")}`;f=function(b,A){var M,L,C,u,_,y,v,T,k,P,S,F;for(b.fileContentString=typeof b.data=="string"?b.data:new TextDecoder().decode(b.data),k={},F=Object.keys(r),_=0,y=F.length;_<y;_++)c=F[_],r[c].fileExtensions.indexOf(b.fileExt)>-1&&(k[c]=!0);for(u=Object.keys(r),u.sort(function(K,Q){return(k[Q]!=null)-(k[K]!=null)}),C=[],T=0,v=u.length;T<v;T++)if(c=u[T],s=r[c],!!(s.read||s.readFromText)){try{if(s.readFromText?S=s.readFromText(b):S=s.read(b),S.length===0)throw S=null,new Error("no colors returned")}catch(K){M=K,P=`failed to load ${b.fileName} as ${s.name}: ${M.message}`,L=new Error(P),L.error=M,L.__PATCHED_LIB_TO_ADD_THIS__format=s,C.push(L)}if(S){S.confidence=k[c]!=null?.9:.01,A(null,S,s,k[c]!=null,{__errors_before_success:C});return}}A(new a(C))},m=function(b={}){var A,M;return(typeof b=="string"||b instanceof String)&&(b={filePath:b}),typeof File<"u"&&File!==null&&b instanceof File&&(b={file:b}),b.fileName==null&&(b.fileName=(A=(M=b.file)!=null?M.name:void 0)!=null?A:b.filePath?e("path").basename(b.filePath):void 0),b.fileExt==null&&(b.fileExt=`${b.fileName}`.split(".").pop()),b.fileExt=`${b.fileExt}`.toLowerCase(),b},t={Color:l,Palette:i,formats:r},t.loadPalette=function(b,A){var M,L;if(!b)throw new TypeError("parameters required: AnyPalette.loadPalette(options, function callback(error, palette){})");if(!A)throw new TypeError("callback required: AnyPalette.loadPalette(options, function callback(error, palette){})");if(b=m(b),b.data)return f(b,A);if(b.file){if(!(b.file instanceof File))throw new TypeError("options.file was passed but it is not a File");return M=new FileReader,M.onerror=function(){return A(M.error)},M.onload=function(){return b.data=M.result,f(b,A)},M.readAsArrayBuffer(b.file)}else{if(b.filePath!=null)return L=e("fs"),L.readFile(b.filePath,function(C,u){return C?A(C):(b.data=u,f(b,A))});throw new TypeError("either options.data or options.file or options.filePath must be passed")}},t.writePalette=function(b,A){return A==null&&(A=t.formats.GIMP_PALETTE),A.write(b)},t.uniqueColors=function(b,A){var M,L,C,u,_;for(_=new i,_.name=this.name,_.description=this.description,x.apply(_,[0,9e9].concat(b.slice(0))),M=0;M<_.length;){for(L=_[M],C=M+1;C<_.length;)u=_[C],l.is(L,u,A)&&(_.splice(C,1),C-=1),C+=1;M+=1}return _},n.exports=t},{"./Color":36,"./Palette":37,"./formats/Adobe":38,"./formats/AdobeColorTable":39,"./formats/CSS":40,"./formats/ColorSchemer":41,"./formats/GIMP":42,"./formats/Homesite":43,"./formats/KolourPaint":44,"./formats/Paint.NET":45,"./formats/PaintShopPro":46,"./formats/RIFF":47,"./formats/SKP":48,"./formats/SPL":49,"./formats/StarCraft":50,"./formats/StarCraftPadded":51,"./formats/StarOffice":52,"./formats/sketchpalette":53,"./formats/tabular":54,"./formats/theme":55,fs:"fs",path:"path"}]},{},[57])(57)});const AnyPalette$1=AnyPalette;(function(e,n){if(typeof define=="function"&&define.amd)define([],n);else if(typeof exports<"u")n();else{var o={exports:{}};n(),window.FileSaver=o.exports}})(void 0,function(){var e=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0;function n(s,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function o(s,c,r){var d=new XMLHttpRequest;d.open("GET",s),d.responseType="blob",d.onload=function(){i(d.response,c,r)},d.onerror=function(){console.error("could not download file")},d.send()}function t(s){var c=new XMLHttpRequest;c.open("HEAD",s,!1);try{c.send()}catch{}return c.status>=200&&c.status<=299}function l(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(c)}}var a=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=e.saveAs||(typeof window!="object"||window!==e?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(c,r,d){var h=e.URL||e.webkitURL,m=document.createElement("a");r=r||c.name||"download",m.download=r,m.rel="noopener",typeof c=="string"?(m.href=c,m.origin!==location.origin?t(m.href)?o(c,r,d):l(m,m.target="_blank"):l(m)):(m.href=h.createObjectURL(c),setTimeout(function(){h.revokeObjectURL(m.href)},4e4),setTimeout(function(){l(m)},0))}:"msSaveOrOpenBlob"in navigator?function(c,r,d){if(r=r||c.name||"download",typeof c=="string")if(t(c))o(c,r,d);else{var h=document.createElement("a");h.href=c,h.target="_blank",setTimeout(function(){l(h)})}else navigator.msSaveOrOpenBlob(n(c,d),r)}:function(c,r,d,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof c=="string")return o(c,r,d);var m=c.type==="application/octet-stream",f=/constructor/i.test(e.HTMLElement)||e.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||m&&f||a)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var M=x.result;M=g?M:M.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=M:location=M,h=null},x.readAsDataURL(c)}else{var b=e.URL||e.webkitURL,A=b.createObjectURL(c);h?h.location=A:location.href=A,h=null,setTimeout(function(){b.revokeObjectURL(A)},4e4)}});e.saveAs=i.saveAs=i,typeof module<"u"&&(module.exports=i)});(function e(n,o,t){function l(s,c){if(!o[s]){if(!n[s]){var r=typeof require=="function"&&require;if(!c&&r)return r(s,!0);if(a)return a(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var h=o[s]={exports:{}};n[s][0].call(h.exports,function(m){var f=n[s][1][m];return l(f||m)},h,h.exports,e,n,o,t)}return o[s].exports}for(var a=typeof require=="function"&&require,i=0;i<t.length;i++)l(t[i]);return l})({1:[function(e,n,o){var t,l,a;t=function(i,s){var c;return c=setTimeout(s,i),{stop:function(){return clearTimeout(c)}}},a=function(i,s){var c;return c=setInterval(s,i),{stop:function(){return clearInterval(c)}}},l=function(i){return/in/.test(document.readyState)?t(10,function(){return l(i)}):i()},function(i){var s,c,r,d,h,m,f,g,x,b;return s=i.FontDetective={},f="Helvetica,Lucida Grande,Lucida Sans,Tahoma,Arial,Geneva,Monaco,Verdana,Microsoft Sans Serif,Trebuchet MS,Courier New,Times New Roman,Courier,Lucida Bright,Lucida Sans Typewriter,URW Chancery L,Comic Sans MS,Georgia,Palatino Linotype,Lucida Sans Unicode,Times,Century Schoolbook L,URW Gothic L,Franklin Gothic Medium,Lucida Console,Impact,URW Bookman L,Helvetica Neue,Nimbus Sans L,URW Palladio L,Nimbus Mono L,Nimbus Roman No9 L,Arial Black,Sylfaen,MV Boli,Estrangelo Edessa,Tunga,Gautami,Raavi,Mangal,Shruti,Latha,Kartika,Vrinda,Arial Narrow,Century Gothic,Garamond,Book Antiqua,Bookman Old Style,Calibri,Cambria,Candara,Corbel,Monotype Corsiva,Cambria Math,Consolas,Constantia,MS Reference Sans Serif,MS Mincho,Segoe UI,Arial Unicode MS,Tempus Sans ITC,Kristen ITC,Mistral,Meiryo UI,Juice ITC,Papyrus,Bradley Hand ITC,French Script MT,Malgun Gothic,Microsoft YaHei,Gisha,Leelawadee,Microsoft JhengHei,Haettenschweiler,Microsoft Himalaya,Microsoft Uighur,MoolBoran,Jokerman,DFKai-SB,KaiTi,SimSun-ExtB,Freestyle Script,Vivaldi,FangSong,MingLiU-ExtB,MingLiU_HKSCS,MingLiU_HKSCS-ExtB,PMingLiU-ExtB,Copperplate Gothic Light,Copperplate Gothic Bold,Franklin Gothic Book,Maiandra GD,Perpetua,Eras Demi ITC,Felix Titling,Franklin Gothic Demi,Pristina,Edwardian Script ITC,OCR A Extended,Engravers MT,Eras Light ITC,Franklin Gothic Medium Cond,Rockwell Extra Bold,Rockwell,Curlz MT,Blackadder ITC,Franklin Gothic Heavy,Franklin Gothic Demi Cond,Lucida Handwriting,Segoe UI Light,Segoe UI Semibold,Lucida Calligraphy,Cooper Black,Viner Hand ITC,Britannic Bold,Wide Latin,Old English Text MT,Broadway,Footlight MT Light,Harrington,Snap ITC,Onyx,Playbill,Bauhaus 93,Baskerville Old Face,Algerian,Matura MT Script Capitals,Stencil,Batang,Chiller,Harlow Solid Italic,Kunstler Script,Bernard MT Condensed,Informal Roman,Vladimir Script,Bell MT,Colonna MT,High Tower Text,Californian FB,Ravie,Segoe Script,Brush Script MT,SimSun,Arial Rounded MT Bold,Berlin Sans FB,Centaur,Niagara Solid,Showcard Gothic,Niagara Engraved,Segoe Print,Gabriola,Gill Sans MT,Iskoola Pota,Calisto MT,Script MT Bold,Century Schoolbook,Berlin Sans FB Demi,Magneto,Arabic Typesetting,DaunPenh,Mongolian Baiti,DokChampa,Euphemia,Kalinga,Microsoft Yi Baiti,Nyala,Bodoni MT Poster Compressed,Goudy Old Style,Imprint MT Shadow,Gill Sans MT Condensed,Gill Sans Ultra Bold,Palace Script MT,Lucida Fax,Gill Sans MT Ext Condensed Bold,Goudy Stout,Eras Medium ITC,Rage Italic,Rockwell Condensed,Castellar,Eras Bold ITC,Forte,Gill Sans Ultra Bold Condensed,Perpetua Titling MT,Agency FB,Tw Cen MT,Gigi,Tw Cen MT Condensed,Aparajita,Gloucester MT Extra Condensed,Tw Cen MT Condensed Extra Bold,PMingLiU,Bodoni MT,Bodoni MT Black,Bodoni MT Condensed,MS Gothic,GulimChe,MS UI Gothic,MS PGothic,Gulim,MS PMincho,BatangChe,Dotum,DotumChe,Gungsuh,GungsuhChe,MingLiU,NSimSun,SimHei,DejaVu Sans,DejaVu Sans Condensed,DejaVu Sans Mono,DejaVu Serif,DejaVu Serif Condensed,Eurostile,Matisse ITC,Bitstream Vera Sans Mono,Bitstream Vera Sans,Staccato222 BT,Bitstream Vera Serif,Broadway BT,ParkAvenue BT,Square721 BT,Calligraph421 BT,MisterEarl BT,Cataneo BT,Ruach LET,Rage Italic LET,La Bamba LET,Blackletter686 BT,John Handy LET,Scruff LET,Westwood LET".split(",").sort(),b=[],d=!1,g=!1,r=document.createElement("div"),r.id="font-detective",c=function(){function A(M,L,C){this.name=M,this.type=L,this.style=C}return A.prototype.toString=function(){return'"'+this.name.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},A}(),h=function(){var A,M,L,C;return A=["monospace","sans-serif","serif"],C=document.createElement("span"),C.innerHTML="mmmmmmmmmmlli",C.style.fontSize="72px",L={},M={},{init:function(){var u,_,y,v;for(document.body.appendChild(r),v=[],_=0,y=A.length;_<y;_++)u=A[_],C.style.fontFamily=u,r.appendChild(C),L[u]=C.offsetWidth,M[u]=C.offsetHeight,v.push(r.removeChild(C));return v},check:function(u){var _,y,v,T;for(v=0,T=A.length;v<T;v++)if(_=A[v],C.style.fontFamily=u+", "+_,r.appendChild(C),y=C.offsetWidth!==L[_]||C.offsetHeight!==M[_],r.removeChild(C),y)return!0;return!1}}}(),m=function(){if(!g)return g=!0,s.incomplete=!0,l(function(A){return function(){var M;return x(function(){var L,C,u;for(u=[],L=0,C=f.length;L<C;L++)M=f[L],u.push(new c(M));return u}())}}())},x=function(A){var M,L;return h.init(),M=0,L=a(20,function(){var C,u,_,y,v,T,k,P,S,F;for(y=0;y<=5;y++){if(_=A[M],C=h.check(_),C)for(b.push(_),S=s.each.callbacks,v=0,k=S.length;v<k;v++)u=S[v],u(_);if(M++,M>=A.length){for(L.stop(),F=s.all.callbacks,T=0,P=F.length;T<P;T++)u=F[T],u(b);s.all.callbacks=[],s.each.callbacks=[],d=!0;return}}})},s.preload=m,s.each=function(A){var M,L,C;for(L=0,C=b.length;L<C;L++)M=b[L],A(M);if(!d)return s.each.callbacks.push(A),m()},s.each.callbacks=[],s.all=function(A){return d?A(b):(s.all.callbacks.push(A),m())},s.all.callbacks=[]}(window)},{}]},{},[1]);const libtess=(function(){var e;function n(W,ne){return W.b===ne.b&&W.a===ne.a}function o(W,ne){return W.b<ne.b||W.b===ne.b&&W.a<=ne.a}function t(W,ne,ue){var he=ne.b-W.b,be=ue.b-ne.b;return 0<he+be?he<be?ne.a-W.a+he/(he+be)*(W.a-ue.a):ne.a-ue.a+be/(he+be)*(ue.a-W.a):0}function l(W,ne,ue){var he=ne.b-W.b,be=ue.b-ne.b;return 0<he+be?(ne.a-ue.a)*he+(ne.a-W.a)*be:0}function a(W,ne){return W.a<ne.a||W.a===ne.a&&W.b<=ne.b}function i(W,ne,ue){var he=ne.a-W.a,be=ue.a-ne.a;return 0<he+be?he<be?ne.b-W.b+he/(he+be)*(W.b-ue.b):ne.b-ue.b+be/(he+be)*(ue.b-W.b):0}function s(W,ne,ue){var he=ne.a-W.a,be=ue.a-ne.a;return 0<he+be?(ne.b-ue.b)*he+(ne.b-W.b)*be:0}function c(W){return o(W.b.a,W.a)}function r(W){return o(W.a,W.b.a)}function d(W,ne,ue,he){return W=0>W?0:W,ue=0>ue?0:ue,W<=ue?ue===0?(ne+he)/2:ne+W/(W+ue)*(he-ne):he+ue/(W+ue)*(ne-he)}function h(W){var ne=b(W.b);return M(ne,W.c),M(ne.b,W.c),L(ne,W.a),ne}function m(W,ne){var ue=!1,he=!1;W!==ne&&(ne.a!==W.a&&(he=!0,u(ne.a,W.a)),ne.d!==W.d&&(ue=!0,_(ne.d,W.d)),A(ne,W),he||(M(ne,W.a),W.a.c=W),ue||(L(ne,W.d),W.d.a=W))}function f(W){var ne=W.b,ue=!1;W.d!==W.b.d&&(ue=!0,_(W.d,W.b.d)),W.c===W?u(W.a,null):(W.b.d.a=ee(W),W.a.c=W.c,A(W,ee(W)),ue||L(W,W.d)),ne.c===ne?(u(ne.a,null),_(ne.d,null)):(W.d.a=ee(ne),ne.a.c=ne.c,A(ne,ee(ne))),C(W)}function g(W){var ne=b(W),ue=ne.b;return A(ne,W.e),ne.a=W.b.a,M(ue,ne.a),ne.d=ue.d=W.d,ne=ne.b,A(W.b,ee(W.b)),A(W.b,ne),W.b.a=ne.a,ne.b.a.c=ne.b,ne.b.d=W.b.d,ne.f=W.f,ne.b.f=W.b.f,ne}function x(W,ne){var ue=!1,he=b(W),be=he.b;return ne.d!==W.d&&(ue=!0,_(ne.d,W.d)),A(he,W.e),A(be,ne),he.a=W.b.a,be.a=ne.a,he.d=be.d=W.d,W.d.a=be,ue||L(he,W.d),he}function b(W){var ne=new ve,ue=new ve,he=W.b.h;return ue.h=he,he.b.h=ne,ne.h=W,W.b.h=ue,ne.b=ue,ne.c=ne,ne.e=ue,ue.b=ne,ue.c=ue,ue.e=ne}function A(W,ne){var ue=W.c,he=ne.c;ue.b.e=ne,he.b.e=W,W.c=he,ne.c=ue}function M(W,ne){var ue=ne.f,he=new H(ne,ue);ue.e=he,ne.f=he,ue=he.c=W;do ue.a=he,ue=ue.c;while(ue!==W)}function L(W,ne){var ue=ne.d,he=new se(ne,ue);ue.b=he,ne.d=he,he.a=W,he.c=ne.c,ue=W;do ue.d=he,ue=ue.e;while(ue!==W)}function C(W){var ne=W.h;W=W.b.h,ne.b.h=W,W.b.h=ne}function u(W,ne){var ue=W.c,he=ue;do he.a=ne,he=he.c;while(he!==ue);ue=W.f,he=W.e,he.f=ue,ue.e=he}function _(W,ne){var ue=W.a,he=ue;do he.d=ne,he=he.e;while(he!==ue);ue=W.d,he=W.b,he.d=ue,ue.b=he}function y(W){var ne=0;return Math.abs(W[1])>Math.abs(W[0])&&(ne=1),Math.abs(W[2])>Math.abs(W[ne])&&(ne=2),ne}var v=4*1e150;function T(W,ne){W.f+=ne.f,W.b.f+=ne.b.f}function k(W,ne,ue){return W=W.a,ne=ne.a,ue=ue.a,ne.b.a===W?ue.b.a===W?o(ne.a,ue.a)?0>=l(ue.b.a,ne.a,ue.a):0<=l(ne.b.a,ue.a,ne.a):0>=l(ue.b.a,W,ue.a):ue.b.a===W?0<=l(ne.b.a,W,ne.a):(ne=t(ne.b.a,W,ne.a),W=t(ue.b.a,W,ue.a),ne>=W)}function P(W){W.a.i=null;var ne=W.e;ne.a.c=ne.c,ne.c.a=ne.a,W.e=null}function S(W,ne){f(W.a),W.c=!1,W.a=ne,ne.i=W}function F(W){var ne=W.a.a;do W=qe(W);while(W.a.a===ne);return W.c&&(ne=x(nt(W).a.b,W.a.e),S(W,ne),W=qe(W)),W}function K(W,ne,ue){var he=new Je;return he.a=ue,he.e=me(W.f,ne.e,he),ue.i=he}function Q(W,ne){switch(W.s){case 100130:return(ne&1)!==0;case 100131:return ne!==0;case 100132:return 0<ne;case 100133:return 0>ne;case 100134:return 2<=ne||-2>=ne}return!1}function Z(W){var ne=W.a,ue=ne.d;ue.c=W.d,ue.a=ne,P(W)}function B(W,ne,ue){for(W=ne,ne=ne.a;W!==ue;){W.c=!1;var he=nt(W),be=he.a;if(be.a!==ne.a){if(!he.c){Z(W);break}be=x(ne.c.b,be.b),S(he,be)}ne.c!==be&&(m(ee(be),be),m(ne,be)),Z(W),ne=he.a,W=he}return ne}function G(W,ne,ue,he,be,Re){var ge=!0;do K(W,ne,ue.b),ue=ue.c;while(ue!==he);for(be===null&&(be=nt(ne).a.b.c);he=nt(ne),ue=he.a.b,ue.a===be.a;)ue.c!==be&&(m(ee(ue),ue),m(ee(be),ue)),he.f=ne.f-ue.f,he.d=Q(W,he.f),ne.b=!0,!ge&&q(W,ne)&&(T(ue,be),P(ne),f(be)),ge=!1,ne=he,be=ue;ne.b=!0,Re&&Y(W,ne)}function w(W,ne,ue,he,be){var Re=[ne.g[0],ne.g[1],ne.g[2]];ne.d=null,ne.d=W.o&&W.o(Re,ue,he,W.c)||null,ne.d===null&&(be?W.n||(re(W,100156),W.n=!0):ne.d=ue[0])}function D(W,ne,ue){var he=[null,null,null,null];he[0]=ne.a.d,he[1]=ue.a.d,w(W,ne.a,he,[.5,.5,0,0],!1),m(ne,ue)}function U(W,ne,ue,he,be){var Re=Math.abs(ne.b-W.b)+Math.abs(ne.a-W.a),ge=Math.abs(ue.b-W.b)+Math.abs(ue.a-W.a),we=be+1;he[be]=.5*ge/(Re+ge),he[we]=.5*Re/(Re+ge),W.g[0]+=he[be]*ne.g[0]+he[we]*ue.g[0],W.g[1]+=he[be]*ne.g[1]+he[we]*ue.g[1],W.g[2]+=he[be]*ne.g[2]+he[we]*ue.g[2]}function q(W,ne){var ue=nt(ne),he=ne.a,be=ue.a;if(o(he.a,be.a)){if(0<l(be.b.a,he.a,be.a))return!1;if(!n(he.a,be.a))g(be.b),m(he,ee(be)),ne.b=ue.b=!0;else if(he.a!==be.a){var ue=W.e,Re=he.a.h;if(0<=Re){var ue=ue.b,ge=ue.d,we=ue.e,Ce=ue.c,Fe=Ce[Re];ge[Fe]=ge[ue.a],Ce[ge[Fe]]=Fe,Fe<=--ue.a&&(1>=Fe||o(we[ge[Fe>>1]],we[ge[Fe]])?Ze(ue,Fe):He(ue,Fe)),we[Re]=null,Ce[Re]=ue.b,ue.b=Re}else for(ue.c[-(Re+1)]=null;0<ue.a&&ue.c[ue.d[ue.a-1]]===null;)--ue.a;D(W,ee(be),he)}}else{if(0>l(he.b.a,be.a,he.a))return!1;qe(ne).b=ne.b=!0,g(he.b),m(ee(be),he)}return!0}function j(W,ne){var ue=nt(ne),he=ne.a,be=ue.a,Re=he.a,ge=be.a,we=he.b.a,Ce=be.b.a,Fe=new H;if(l(we,W.a,Re),l(Ce,W.a,ge),Re===ge||Math.min(Re.a,we.a)>Math.max(ge.a,Ce.a))return!1;if(o(Re,ge)){if(0<l(Ce,Re,ge))return!1}else if(0>l(we,ge,Re))return!1;var Ve=we,Ye=Re,We=Ce,Ie=ge,Oe,it;if(o(Ve,Ye)||(Oe=Ve,Ve=Ye,Ye=Oe),o(We,Ie)||(Oe=We,We=Ie,Ie=Oe),o(Ve,We)||(Oe=Ve,Ve=We,We=Oe,Oe=Ye,Ye=Ie,Ie=Oe),o(We,Ye)?o(Ye,Ie)?(Oe=t(Ve,We,Ye),it=t(We,Ye,Ie),0>Oe+it&&(Oe=-Oe,it=-it),Fe.b=d(Oe,We.b,it,Ye.b)):(Oe=l(Ve,We,Ye),it=-l(Ve,Ie,Ye),0>Oe+it&&(Oe=-Oe,it=-it),Fe.b=d(Oe,We.b,it,Ie.b)):Fe.b=(We.b+Ye.b)/2,a(Ve,Ye)||(Oe=Ve,Ve=Ye,Ye=Oe),a(We,Ie)||(Oe=We,We=Ie,Ie=Oe),a(Ve,We)||(Oe=Ve,Ve=We,We=Oe,Oe=Ye,Ye=Ie,Ie=Oe),a(We,Ye)?a(Ye,Ie)?(Oe=i(Ve,We,Ye),it=i(We,Ye,Ie),0>Oe+it&&(Oe=-Oe,it=-it),Fe.a=d(Oe,We.a,it,Ye.a)):(Oe=s(Ve,We,Ye),it=-s(Ve,Ie,Ye),0>Oe+it&&(Oe=-Oe,it=-it),Fe.a=d(Oe,We.a,it,Ie.a)):Fe.a=(We.a+Ye.a)/2,o(Fe,W.a)&&(Fe.b=W.a.b,Fe.a=W.a.a),Ve=o(Re,ge)?Re:ge,o(Ve,Fe)&&(Fe.b=Ve.b,Fe.a=Ve.a),n(Fe,Re)||n(Fe,ge))return q(W,ne),!1;if(!n(we,W.a)&&0<=l(we,W.a,Fe)||!n(Ce,W.a)&&0>=l(Ce,W.a,Fe)){if(Ce===W.a)return g(he.b),m(be.b,he),ne=F(ne),he=nt(ne).a,B(W,nt(ne),ue),G(W,ne,ee(he),he,he,!0),!0;if(we===W.a){g(be.b),m(he.e,ee(be)),Re=ue=ne,ge=Re.a.b.a;do Re=qe(Re);while(Re.a.b.a===ge);return ne=Re,Re=nt(ne).a.b.c,ue.a=ee(be),be=B(W,ue,null),G(W,ne,be.c,he.b.c,Re,!0),!0}return 0<=l(we,W.a,Fe)&&(qe(ne).b=ne.b=!0,g(he.b),he.a.b=W.a.b,he.a.a=W.a.a),0>=l(Ce,W.a,Fe)&&(ne.b=ue.b=!0,g(be.b),be.a.b=W.a.b,be.a.a=W.a.a),!1}return g(he.b),g(be.b),m(ee(be),he),he.a.b=Fe.b,he.a.a=Fe.a,he.a.h=ae(W.e,he.a),he=he.a,be=[0,0,0,0],Fe=[Re.d,we.d,ge.d,Ce.d],he.g[0]=he.g[1]=he.g[2]=0,U(he,Re,we,be,0),U(he,ge,Ce,be,2),w(W,he,Fe,be,!0),qe(ne).b=ne.b=ue.b=!0,!1}function Y(W,ne){for(var ue=nt(ne);;){for(;ue.b;)ne=ue,ue=nt(ue);if(!ne.b&&(ue=ne,ne=qe(ne),ne===null||!ne.b))break;ne.b=!1;var he=ne.a,be=ue.a,Re;if(Re=he.b.a!==be.b.a)e:{Re=ne;var ge=nt(Re),we=Re.a,Ce=ge.a,Fe=void 0;if(o(we.b.a,Ce.b.a)){if(0>l(we.b.a,Ce.b.a,we.a)){Re=!1;break e}qe(Re).b=Re.b=!0,Fe=g(we),m(Ce.b,Fe),Fe.d.c=Re.d}else{if(0<l(Ce.b.a,we.b.a,Ce.a)){Re=!1;break e}Re.b=ge.b=!0,Fe=g(Ce),m(we.e,Ce.b),Fe.b.d.c=Re.d}Re=!0}if(Re&&(ue.c?(P(ue),f(be),ue=nt(ne),be=ue.a):ne.c&&(P(ne),f(he),ne=qe(ue),he=ne.a)),he.a!==be.a){if(he.b.a===be.b.a||ne.c||ue.c||he.b.a!==W.a&&be.b.a!==W.a)q(W,ne);else if(j(W,ne))break}he.a===be.a&&he.b.a===be.b.a&&(T(be,he),P(ne),f(he),ne=qe(ue))}}function J(W,ne){W.a=ne;for(var ue=ne.c;ue.i===null;)if(ue=ue.c,ue===ne.c){var ue=W,he=ne,ge=new Je;ge.a=he.c.b;var be=ue.f,we=be.a;do we=we.a;while(we.b!==null&&!be.c(be.b,ge,we.b));var be=we.b,Re=nt(be),ge=be.a,we=Re.a;if(l(ge.b.a,he,ge.a)===0)ge=be.a,n(ge.a,he)||n(ge.b.a,he)||(g(ge.b),be.c&&(f(ge.c),be.c=!1),m(he.c,ge),J(ue,he));else{var Ce=o(we.b.a,ge.b.a)?be:Re,Re=void 0;be.d||Ce.c?(Ce===be?Re=x(he.c.b,ge.e):Re=x(we.b.c.b,he.c).b,Ce.c?S(Ce,Re):(ge=ue,be=K(ue,be,Re),be.f=qe(be).f+be.a.f,be.d=Q(ge,be.f)),J(ue,he)):G(ue,be,he.c,he.c,null,!0)}return}if(ue=F(ue.i),ge=nt(ue),be=ge.a,ge=B(W,ge,null),ge.c===be){var be=ge,ge=be.c,we=nt(ue),Re=ue.a,Ce=we.a,Fe=!1;Re.b.a!==Ce.b.a&&j(W,ue),n(Re.a,W.a)&&(m(ee(ge),Re),ue=F(ue),ge=nt(ue).a,B(W,nt(ue),we),Fe=!0),n(Ce.a,W.a)&&(m(be,ee(Ce)),be=B(W,we,null),Fe=!0),Fe?G(W,ue,be.c,ge,ge,!0):(o(Ce.a,Re.a)?he=ee(Ce):he=Re,he=x(be.c.b,he),G(W,ue,he,he.c,he.c,!1),he.b.i.c=!0,Y(W,ue))}else G(W,ue,ge.c,be,be,!0)}function oe(W,ne){var ue=new Je,he=h(W.b);he.a.b=v,he.a.a=ne,he.b.a.b=-v,he.b.a.a=ne,W.a=he.b.a,ue.a=he,ue.f=0,ue.d=!1,ue.c=!1,ue.h=!0,ue.b=!1,he=W.f,he=me(he,he.a,ue),ue.e=he}function pe(W){this.a=new Ee,this.b=W,this.c=k}function me(W,ne,ue){do ne=ne.c;while(ne.b!==null&&!W.c(W.b,ne.b,ue));return W=new Ee(ue,ne.a,ne),ne.a.c=W,ne.a=W}function Ee(W,ne,ue){this.b=W||null,this.a=ne||this,this.c=ue||this}function X(){this.d=N,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}var N=0;e=X.prototype,e.x=function(){te(this,N)},e.B=function(W,ne){switch(W){case 100142:return;case 100140:switch(ne){case 100130:case 100131:case 100132:case 100133:case 100134:this.s=ne;return}break;case 100141:this.m=!!ne;return;default:re(this,100900);return}re(this,100901)},e.y=function(W){switch(W){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:re(this,100900)}return!1},e.A=function(W,ne,ue){this.j[0]=W,this.j[1]=ne,this.j[2]=ue},e.z=function(W,ne){var ue=ne||null;switch(W){case 100100:case 100106:this.h=ue;break;case 100104:case 100110:this.l=ue;break;case 100101:case 100107:this.k=ue;break;case 100102:case 100108:this.i=ue;break;case 100103:case 100109:this.p=ue;break;case 100105:case 100111:this.o=ue;break;case 100112:this.r=ue;break;default:re(this,100900)}},e.C=function(W,ne){var ue=!1,he=[0,0,0];te(this,2);for(var be=0;3>be;++be){var Re=W[be];-1e150>Re&&(Re=-1e150,ue=!0),1e150<Re&&(Re=1e150,ue=!0),he[be]=Re}ue&&re(this,100155),ue=this.q,ue===null?(ue=h(this.b),m(ue,ue.b)):(g(ue),ue=ue.e),ue.a.d=ne,ue.a.g[0]=he[0],ue.a.g[1]=he[1],ue.a.g[2]=he[2],ue.f=1,ue.b.f=-1,this.q=ue},e.u=function(W){te(this,N),this.d=1,this.b=new le,this.c=W},e.t=function(){te(this,1),this.d=2,this.q=null},e.v=function(){te(this,2),this.d=1},e.w=function(){te(this,1),this.d=N;var W=this.j[0],ne=this.j[1],ue=this.j[2],he=!1,be=[W,ne,ue];if(W===0&&ne===0&&ue===0){for(var ne=[-2*1e150,-2*1e150,-2*1e150],Re=[2*1e150,2*1e150,2*1e150],ue=[],ge=[],he=this.b.c,W=he.e;W!==he;W=W.e)for(var we=0;3>we;++we){var Ce=W.g[we];Ce<Re[we]&&(Re[we]=Ce,ge[we]=W),Ce>ne[we]&&(ne[we]=Ce,ue[we]=W)}if(W=0,ne[1]-Re[1]>ne[0]-Re[0]&&(W=1),ne[2]-Re[2]>ne[W]-Re[W]&&(W=2),Re[W]>=ne[W])be[0]=0,be[1]=0,be[2]=1;else{for(ne=0,Re=ge[W],ue=ue[W],ge=[0,0,0],Re=[Re.g[0]-ue.g[0],Re.g[1]-ue.g[1],Re.g[2]-ue.g[2]],we=[0,0,0],W=he.e;W!==he;W=W.e)we[0]=W.g[0]-ue.g[0],we[1]=W.g[1]-ue.g[1],we[2]=W.g[2]-ue.g[2],ge[0]=Re[1]*we[2]-Re[2]*we[1],ge[1]=Re[2]*we[0]-Re[0]*we[2],ge[2]=Re[0]*we[1]-Re[1]*we[0],Ce=ge[0]*ge[0]+ge[1]*ge[1]+ge[2]*ge[2],Ce>ne&&(ne=Ce,be[0]=ge[0],be[1]=ge[1],be[2]=ge[2]);0>=ne&&(be[0]=be[1]=be[2]=0,be[y(Re)]=1)}he=!0}for(ge=y(be),W=this.b.c,ne=(ge+1)%3,ue=(ge+2)%3,ge=0<be[ge]?1:-1,be=W.e;be!==W;be=be.e)be.b=be.g[ne],be.a=ge*be.g[ue];if(he){for(be=0,he=this.b.a,W=he.b;W!==he;W=W.b)if(ne=W.a,!(0>=ne.f))do be+=(ne.a.b-ne.b.a.b)*(ne.a.a+ne.b.a.a),ne=ne.e;while(ne!==W.a);if(0>be)for(be=this.b.c,he=be.e;he!==be;he=he.e)he.a=-he.a}for(this.n=!1,be=this.b.b,W=be.h;W!==be;W=he)he=W.h,ne=W.e,n(W.a,W.b.a)&&W.e.e!==W&&(D(this,ne,W),f(W),W=ne,ne=W.e),ne.e===W&&(ne!==W&&((ne===he||ne===he.b)&&(he=he.h),f(ne)),(W===he||W===he.b)&&(he=he.h),f(W));for(this.e=be=new I,he=this.b.c,W=he.e;W!==he;W=W.e)W.h=ae(be,W);for(O(be),this.f=new pe(this),oe(this,-v),oe(this,v);(be=_e(this.e))!==null;){for(;;){e:if(W=this.e,W.a===0)he=Xe(W.b);else if(he=W.c[W.d[W.a-1]],W.b.a!==0&&(W=Xe(W.b),o(W,he))){he=W;break e}if(he===null||!n(he,be))break;he=_e(this.e),D(this,be.c,he.c)}J(this,be)}for(this.a=this.f.a.a.b.a.a,be=0;(he=this.f.a.a.b)!==null;)he.h||++be,P(he);for(this.f=null,be=this.e,be.b=null,be.d=null,this.e=be.c=null,be=this.b,W=be.a.b;W!==be.a;W=he)he=W.b,W=W.a,W.e.e===W&&(T(W.c,W),f(W));if(!this.n){if(be=this.b,this.m)for(W=be.b.h;W!==be.b;W=he)he=W.h,W.b.d.c!==W.d.c?W.f=W.d.c?1:-1:f(W);else for(W=be.a.b;W!==be.a;W=he)if(he=W.b,W.c){for(W=W.a;o(W.b.a,W.a);W=W.c.b);for(;o(W.a,W.b.a);W=W.e);for(ne=W.c.b,ue=void 0;W.e!==ne;)if(o(W.b.a,ne.a)){for(;ne.e!==W&&(c(ne.e)||0>=l(ne.a,ne.b.a,ne.e.b.a));)ue=x(ne.e,ne),ne=ue.b;ne=ne.c.b}else{for(;ne.e!==W&&(r(W.c.b)||0<=l(W.b.a,W.a,W.c.b.a));)ue=x(W,W.c.b),W=ue.b;W=W.e}for(;ne.e.e!==W;)ue=x(ne.e,ne),ne=ue.b}if(this.h||this.i||this.k||this.l)if(this.m){for(be=this.b,he=be.a.b;he!==be.a;he=he.b)if(he.c){this.h&&this.h(2,this.c),W=he.a;do this.k&&this.k(W.a.d,this.c),W=W.e;while(W!==he.a);this.i&&this.i(this.c)}}else{for(be=this.b,he=!!this.l,W=!1,ne=-1,ue=be.a.d;ue!==be.a;ue=ue.d)if(ue.c){W||(this.h&&this.h(4,this.c),W=!0),ge=ue.a;do he&&(Re=ge.b.d.c?0:1,ne!==Re&&(ne=Re,this.l&&this.l(!!ne,this.c))),this.k&&this.k(ge.a.d,this.c),ge=ge.e;while(ge!==ue.a)}W&&this.i&&this.i(this.c)}if(this.r){for(be=this.b,W=be.a.b;W!==be.a;W=he)if(he=W.b,!W.c){ne=W.a,ue=ne.e,ge=void 0;do ge=ue,ue=ge.e,ge.d=null,ge.b.d===null&&(ge.c===ge?u(ge.a,null):(ge.a.c=ge.c,A(ge,ee(ge))),Re=ge.b,Re.c===Re?u(Re.a,null):(Re.a.c=Re.c,A(Re,ee(Re))),C(ge));while(ge!==ne);ne=W.d,W=W.b,W.d=ne,ne.b=W}this.r(this.b),this.c=this.b=null;return}}this.b=this.c=null};function te(W,ne){if(W.d!==ne)for(;W.d!==ne;)if(W.d<ne)switch(W.d){case N:re(W,100151),W.u(null);break;case 1:re(W,100152),W.t()}else switch(W.d){case 2:re(W,100154),W.v();break;case 1:re(W,100153),W.w()}}function re(W,ne){W.p&&W.p(ne,W.c)}function se(W,ne){this.b=W||this,this.d=ne||this,this.a=null,this.c=!1}function ve(){this.h=this,this.i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function ee(W){return W.b.e}function le(){this.c=new H,this.a=new se,this.b=new ve,this.d=new ve,this.b.b=this.d,this.d.b=this.b}function H(W,ne){this.e=W||this,this.f=ne||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function I(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new Ae}function O(W){W.d=[];for(var ne=0;ne<W.a;ne++)W.d[ne]=ne;W.d.sort(function(ue){return function(he,be){return o(ue[he],ue[be])?1:-1}}(W.c)),W.e=!0,ze(W.b)}function ae(W,ne){if(W.e){var ue=W.b,he=++ue.a;2*he>ue.f&&(ue.f*=2,ue.c=Se(ue.c,ue.f+1));var be;return ue.b===0?be=he:(be=ue.b,ue.b=ue.c[ue.b]),ue.e[be]=ne,ue.c[be]=he,ue.d[he]=be,ue.h&&He(ue,he),be}return ue=W.a++,W.c[ue]=ne,-(ue+1)}function _e(W){if(W.a===0)return Ue(W.b);var ne=W.c[W.d[W.a-1]];if(W.b.a!==0&&o(Xe(W.b),ne))return Ue(W.b);do--W.a;while(0<W.a&&W.c[W.d[W.a-1]]===null);return ne}function Ae(){this.d=Se([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function Se(W,ne){for(var ue=Array(ne),he=0;he<W.length;he++)ue[he]=W[he];for(;he<ne;he++)ue[he]=0;return ue}function ze(W){for(var ne=W.a;1<=ne;--ne)Ze(W,ne);W.h=!0}function Xe(W){return W.e[W.d[1]]}function Ue(W){var ne=W.d,ue=W.e,he=W.c,be=ne[1],Re=ue[be];return 0<W.a&&(ne[1]=ne[W.a],he[ne[1]]=1,ue[be]=null,he[be]=W.b,W.b=be,0<--W.a&&Ze(W,1)),Re}function Ze(W,ne){for(var ue=W.d,he=W.e,be=W.c,Re=ne,ge=ue[Re];;){var we=Re<<1;we<W.a&&o(he[ue[we+1]],he[ue[we]])&&(we+=1);var Ce=ue[we];if(we>W.a||o(he[ge],he[Ce])){ue[Re]=ge,be[ge]=Re;break}ue[Re]=Ce,be[Ce]=Re,Re=we}}function He(W,ne){for(var ue=W.d,he=W.e,be=W.c,Re=ne,ge=ue[Re];;){var we=Re>>1,Ce=ue[we];if(we===0||o(he[Ce],he[ge])){ue[Re]=ge,be[ge]=Re;break}ue[Re]=Ce,be[Ce]=Re,Re=we}}function Je(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function nt(W){return W.e.c.b}function qe(W){return W.e.a.b}return this.libtess={GluTesselator:X,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},X.prototype.gluDeleteTess=X.prototype.x,X.prototype.gluTessProperty=X.prototype.B,X.prototype.gluGetTessProperty=X.prototype.y,X.prototype.gluTessNormal=X.prototype.A,X.prototype.gluTessCallback=X.prototype.z,X.prototype.gluTessVertex=X.prototype.C,X.prototype.gluTessBeginPolygon=X.prototype.u,X.prototype.gluTessBeginContour=X.prototype.t,X.prototype.gluTessEndContour=X.prototype.v,X.prototype.gluTessEndPolygon=X.prototype.w,typeof module<"u"&&(module.exports=this.libtess),this.libtess}).apply(new Object),TrackyMouse$1={dependenciesRoot:"./tracky-mouse"};TrackyMouse$1.loadDependencies=function(){TrackyMouse$1.dependenciesRoot=TrackyMouse$1.dependenciesRoot.replace(/\/+$/,"");const e=o=>new Promise((t,l)=>{const a=document.createElement("script");a.type="text/javascript",a.onload=t,a.onerror=l,a.src=o,document.head.append(a)}),n=[`${TrackyMouse$1.dependenciesRoot}/lib/no-eval.js`,`${TrackyMouse$1.dependenciesRoot}/lib/clmtrackr.js`,`${TrackyMouse$1.dependenciesRoot}/lib/stats.js`];return Promise.all(n.map(e))};const is_selector_valid=(e=>n=>{try{e.querySelector(n)}catch{return!1}return!0})(document.createDocumentFragment());let clean_up_dwell_clicking=()=>{};const init_dwell_clicking=e=>{if(typeof e!="object")throw new Error("configuration object required for initDwellClicking");if(e.targets===void 0)throw new Error("config.targets is required (must be a CSS selector)");if(typeof e.targets!="string")throw new Error("config.targets must be a string (a CSS selector)");if(!is_selector_valid(e.targets))throw new Error("config.targets is not a valid CSS selector");if(e.click===void 0)throw new Error("config.click is required");if(typeof e.click!="function")throw new Error("config.click must be a function");if(e.shouldDrag!==void 0&&typeof e.shouldDrag!="function")throw new Error("config.shouldDrag must be a function");if(e.noCenter!==void 0&&typeof e.noCenter!="function")throw new Error("config.noCenter must be a function");if(e.isEquivalentTarget!==void 0&&typeof e.isEquivalentTarget!="function")throw new Error("config.isEquivalentTarget must be a function");if(e.dwellClickEvenIfPaused!==void 0&&typeof e.dwellClickEvenIfPaused!="function")throw new Error("config.dwellClickEvenIfPaused must be a function");if(e.beforeDispatch!==void 0&&typeof e.beforeDispatch!="function")throw new Error("config.beforeDispatch must be a function");if(e.afterDispatch!==void 0&&typeof e.afterDispatch!="function")throw new Error("config.afterDispatch must be a function");if(e.beforePointerDownDispatch!==void 0&&typeof e.beforePointerDownDispatch!="function")throw new Error("config.beforePointerDownDispatch must be a function");if(e.isHeld!==void 0&&typeof e.isHeld!="function")throw new Error("config.isHeld must be a function");if(e.retarget!==void 0){if(!Array.isArray(e.retarget))throw new Error("config.retarget must be an array of objects");for(let Z=0;Z<e.retarget.length;Z++){const B=e.retarget[Z];if(typeof B!="object")throw new Error("config.retarget must be an array of objects");if(B.from===void 0)throw new Error(`config.retarget[${Z}].from is required`);if(B.to===void 0)throw new Error(`config.retarget[${Z}].to is required (although can be null to ignore the element)`);if(B.withinMargin!==void 0&&typeof B.withinMargin!="number")throw new Error(`config.retarget[${Z}].withinMargin must be a number`);if(typeof B.from!="string"&&typeof B.from!="function"&&!(B.from instanceof Element))throw new Error(`config.retarget[${Z}].from must be a CSS selector string, an Element, or a function`);if(typeof B.to!="string"&&typeof B.to!="function"&&!(B.to instanceof Element)&&B.to!==null)throw new Error(`config.retarget[${Z}].to must be a CSS selector string, an Element, a function, or null`);if(typeof B.from=="string"&&!is_selector_valid(B.from))throw new Error(`config.retarget[${Z}].from is not a valid CSS selector`);if(typeof B.to=="string"&&!is_selector_valid(B.to))throw new Error(`config.retarget[${Z}].to is not a valid CSS selector`)}}const n=50,o=500,t=500,l=1500,a=1e3,i=1e3,s=1e3,c=1e3;let r=[],d=performance.now(),h=!1,m,f=null;const g=Z=>{d=Math.max(d,performance.now()+Z)};g(l);const x=document.createElement("div");x.className="tracky-mouse-hover-halo",x.style.display="none",document.body.appendChild(x);const b=document.createElement("div");b.className="tracky-mouse-dwell-indicator",b.style.width=`${n}px`,b.style.height=`${n}px`,b.style.display="none",document.body.appendChild(b);const A=Z=>{r.push({x:Z.clientX,y:Z.clientY,time:performance.now()})},M=Z=>{g(a),f=null};let L=document.visibilityState==="visible",C=!0;const u=()=>{L=!0,g(c)},_=()=>{L=!1},y=()=>{C=!1},v=()=>{C=!0};window.addEventListener("pointermove",A),window.addEventListener("pointerup",M),window.addEventListener("pointercancel",M),window.addEventListener("focus",u),window.addEventListener("blur",_),document.addEventListener("mouseleave",y),document.addEventListener("mouseenter",v);const T=(Z,B)=>{var U;if(!L||!C)return null;let G=document.elementFromPoint(Z,B);if(!G)return null;let w={x:Z,y:B,time:performance.now()},D=!1;for(const{from:q,to:j,withinMargin:Y=1/0}of e.retarget??[])if(q instanceof Element?q===G:typeof q=="function"?q(G):G.matches(q)){const J=j instanceof Element||j===null?j:typeof j=="function"?j(G):G.closest(j)||G.querySelector(j);if(J===null)return null;if(J){const oe=J.getBoundingClientRect();w.x>oe.left-Y&&w.y>oe.top-Y&&w.x<oe.right+Y&&w.y<oe.bottom+Y&&(G=J,w.x=Math.min(oe.right-1,Math.max(oe.left,w.x)),w.y=Math.min(oe.bottom-1,Math.max(oe.top,w.y)),D=!0)}}if(!D&&(G=G.closest(e.targets),!G))return null;if(!((U=e.noCenter)!=null&&U.call(e,G))){const q=G.getBoundingClientRect();w.x=q.left+q.width/2,w.y=q.top+q.height/2}return w.target=G,w},k=({x:Z,y:B})=>({view:window,clientX:Z,clientY:B,pointerId:1234567890,pointerType:"mouse",isPrimary:!0,bubbles:!0,cancelable:!0}),P=Z=>{const B={x:0,y:0};for(const G of Z)B.x+=G.x,B.y+=G.y;return B.x/=Z.length,B.y/=Z.length,B},S=()=>{var B,G,w,D,U,q,j,Y,J,oe,pe,me,Ee,X,N;const Z=performance.now();if(r=r.filter(te=>Z<te.time+t),r.length){const te=r[r.length-1];r.push({x:te.x,y:te.y,time:Z});const re=P(r),se=Math.hypot(te.x-re.x,te.y-re.y);if(m&&!f){const I=T(m.x,m.y),O=ae=>{const _e=document.createElement("div"),Ae=ae.getBoundingClientRect(),Se=4;_e.style.pointerEvents="none",_e.style.zIndex=1000001,_e.style.display="block",_e.style.position="fixed",_e.style.left=`${Ae.left+Se}px`,_e.style.top=`${Ae.top+Se}px`,_e.style.width=`${Ae.width-Se*2}px`,_e.style.height=`${Ae.height-Se*2}px`,_e.style.outline=`${Se}px dashed red`,_e.style.boxShadow=`0 0 ${Se}px ${Se}px maroon`,document.body.appendChild(_e),setTimeout(()=>{_e.remove()},s*.5)};if(I)I.target!==m.target&&!((B=e.isEquivalentTarget)!=null&&B.call(e,I.target,m.target))&&(m=null,g(s),O(I.target));else{let ae=document.elementFromPoint(m.x,m.y);m=null,g(s),O(ae||document.body)}}let ve=te,ee=0,le=0;m&&(ve=m,ee=.4,le=(m.time-Z+o)/o*n,Z>m.time+o&&((G=e.isHeld)!=null&&G.call(e)||f?((w=e.beforeDispatch)==null||w.call(e),m.target.dispatchEvent(new PointerEvent("pointerup",Object.assign(k(m),{button:0,buttons:0}))),(D=e.afterDispatch)==null||D.call(e)):((U=e.beforePointerDownDispatch)==null||U.call(e),(q=e.beforeDispatch)==null||q.call(e),m.target.dispatchEvent(new PointerEvent("pointerdown",Object.assign(k(m),{button:0,buttons:1}))),(j=e.afterDispatch)==null||j.call(e),(Y=e.shouldDrag)!=null&&Y.call(e,m.target)?f=m.target:((J=e.beforeDispatch)==null||J.call(e),m.target.dispatchEvent(new PointerEvent("pointerup",Object.assign(k(m),{button:0,buttons:0}))),e.click(m),(oe=e.afterDispatch)==null||oe.call(e))),m=null,g(i))),f?b.classList.add("tracky-mouse-for-release"):b.classList.remove("tracky-mouse-for-release"),b.style.display="",b.style.opacity=ee,b.style.transform=`scale(${le/n})`,b.style.left=`${ve.x-n/2}px`,b.style.top=`${ve.y-n/2}px`;let H=f||(m||T(te.x,te.y)||{}).target;if(H&&(!h||(pe=e.dwellClickEvenIfPaused)!=null&&pe.call(e,H))){let I=H.getBoundingClientRect();const O=getComputedStyle(H);let ae=H,_e=1;for(;ae instanceof HTMLElement;){const Ae=getComputedStyle(ae);if(Ae.transform){const Se=Ae.transform.match(/(?:scale|matrix)\((\d+(?:\.\d+)?)/);Se&&(_e*=Number(Se[1]))}if(Ae.overflow!=="visible"){const Se=ae.getBoundingClientRect();I={left:Math.max(I.left,Se.left),top:Math.max(I.top,Se.top),right:Math.min(I.right,Se.right),bottom:Math.min(I.bottom,Se.bottom)},I.width=I.right-I.left,I.height=I.bottom-I.top}ae=ae.parentNode}x.style.display="block",x.style.position="fixed",x.style.left=`${I.left}px`,x.style.top=`${I.top}px`,x.style.width=`${I.width}px`,x.style.height=`${I.height}px`;for(const Ae of["borderTopRightRadius","borderTopLeftRadius","borderBottomRightRadius","borderBottomLeftRadius"])O[Ae].endsWith("px")?x.style[Ae]=`${parseFloat(O[Ae])*_e}px`:x.style[Ae]=O[Ae]}else x.style.display="none";if(Z<d)return;se<5&&(m||(m={x:re.x,y:re.y,time:performance.now(),target:f||null},f||(m=T(m.x,m.y)),m&&h&&!((me=e.dwellClickEvenIfPaused)!=null&&me.call(e,m.target))&&(m=null))),se>100&&f&&((Ee=e.beforeDispatch)==null||Ee.call(e),window.dispatchEvent(new PointerEvent("pointerup",Object.assign(k(re),{button:0,buttons:0}))),(X=e.afterDispatch)==null||X.call(e),(N=e.afterReleaseDrag)==null||N.call(e)),se>60&&(m=null)}};let F;const K=()=>{F=requestAnimationFrame(K),S()};return F=requestAnimationFrame(K),clean_up_dwell_clicking=()=>{cancelAnimationFrame(F),x.remove(),b.remove(),window.removeEventListener("pointermove",A),window.removeEventListener("pointerup",M),window.removeEventListener("pointercancel",M),window.removeEventListener("focus",u),window.removeEventListener("blur",_),document.removeEventListener("mouseleave",y),document.removeEventListener("mouseenter",v),clean_up_dwell_clicking=()=>{}},{get paused(){return h},set paused(Z){h=Z}}};TrackyMouse$1.initDwellClicking=function(e){return init_dwell_clicking(e)};TrackyMouse$1.cleanupDwellClicking=function(){clean_up_dwell_clicking()};TrackyMouse$1.init=function(e){var n=e||document.createElement("div");n.classList.add("tracky-mouse-ui"),n.innerHTML=`
		<div class="tracky-mouse-controls">
			<button class="tracky-mouse-start-stop-button" aria-pressed="false" aria-keyshortcuts="F9">Start</button>
			<br>
			<br>
			<label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Horizontal Sensitivity</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="25" class="tracky-mouse-sensitivity-x">
					<span class="tracky-mouse-min-label">Slow</span>
					<span class="tracky-mouse-max-label">Fast</span>
				</span>
			</label>
			<label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Vertical Sensitivity</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="50" class="tracky-mouse-sensitivity-y">
					<span class="tracky-mouse-min-label">Slow</span>
					<span class="tracky-mouse-max-label">Fast</span>
				</span>
			</label>
			<!-- <label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Smoothing</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="50" class="tracky-mouse-smoothing">
					<span class="tracky-mouse-min-label"></span>
					<span class="tracky-mouse-max-label"></span>
				</span>
			</label> -->
			<label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Acceleration</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="50" class="tracky-mouse-acceleration">
					<!-- TODO: "Linear" could be described as "Fast", and the other "Fast" labels are on the other side. Should it be swapped? What does other software with acceleration control look like? In Windows it's just a checkbox apparently, but it could go as far as a custom curve editor. -->
					<span class="tracky-mouse-min-label">Linear</span>
					<span class="tracky-mouse-max-label">Smooth</span>
				</span>
			</label>
			<!-- <label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Easy Stop (min distance to move)</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="50" class="tracky-mouse-min-distance">
					<span class="tracky-mouse-min-label">Jittery</span>
					<span class="tracky-mouse-max-label">Steady</span>
				</span>
			</label> -->
			<br>
			<!-- special interest: jspaint wants label not to use parent-child relationship so that os-gui's 98.css checkbox styles can work -->
			<!-- though this option might not be wanted in jspaint; might be good to hide it in the embedded case, or make it optional -->
			<!-- also TODO: add description of what this is for: on Windows, currently, when buttons are swapped at the system level, it affects serenade-driver's click() -->
			<!-- also this may be seen as a weirdly named/designed option for right-clicking -->
			<!-- btw: label is selected based on 'for' attribute -->
			<div class="tracky-mouse-control-row">
				<input type="checkbox" id="tracky-mouse-swap-mouse-buttons"/>
				<label for="tracky-mouse-swap-mouse-buttons"><span class="tracky-mouse-label-text">Swap mouse buttons</span></label>
			</div>
			<br>
			<!-- special interest: jspaint wants label not to use parent-child relationship so that os-gui's 98.css checkbox styles can work -->
			<!-- opposite, "Start paused", might be clearer, especially if I add a "pause" button -->
			<div class="tracky-mouse-control-row">
				<input type="checkbox" id="tracky-mouse-start-enabled"/>
				<label for="tracky-mouse-start-enabled"><span class="tracky-mouse-label-text">Start enabled</span></label>
			</div>
			<br>
			<!-- special interest: jspaint wants label not to use parent-child relationship so that os-gui's 98.css checkbox styles can work -->
			<div class="tracky-mouse-control-row">
				<input type="checkbox" id="tracky-mouse-run-at-login"/>
				<label for="tracky-mouse-run-at-login"><span class="tracky-mouse-label-text">Run at login</span></label>
			</div>
			<br>
			<!-- special interest: jspaint wants label not to use parent-child relationship so that os-gui's 98.css checkbox styles can work -->
			<!-- TODO: try moving this to the corner of the camera view, so it's clearer it applies only to the camera view -->
			<div class="tracky-mouse-control-row">
				<input type="checkbox" checked id="tracky-mouse-mirror"/>
				<label for="tracky-mouse-mirror"><span class="tracky-mouse-label-text">Mirror</span></label>
			</div>
			<br>
		</div>
		<div class="tracky-mouse-canvas-container-container">
			<div class="tracky-mouse-canvas-container">
				<div class="tracky-mouse-canvas-overlay">
					<button class="tracky-mouse-use-camera-button">Allow Camera Access</button>
					<!--<button class="tracky-mouse-use-camera-button">Use my camera</button>-->
					<button class="tracky-mouse-use-demo-footage-button" hidden>Use demo footage</button>
					<div class="tracky-mouse-error-message" role="alert" hidden></div>
				</div>
				<canvas class="tracky-mouse-canvas"></canvas>
			</div>
		</div>
		<p class="tracky-mouse-desktop-app-download-message">
			You can control your entire computer with the <a href="https://trackymouse.js.org/">TrackyMouse</a> desktop app.
		</p>
	`,e||document.body.appendChild(n);var o=n.querySelector(".tracky-mouse-start-stop-button"),t=n.querySelector("#tracky-mouse-mirror"),l=n.querySelector("#tracky-mouse-swap-mouse-buttons"),a=n.querySelector("#tracky-mouse-start-enabled"),i=n.querySelector("#tracky-mouse-run-at-login"),s=n.querySelector("label[for='tracky-mouse-swap-mouse-buttons']"),c=n.querySelector(".tracky-mouse-sensitivity-x"),r=n.querySelector(".tracky-mouse-sensitivity-y"),d=n.querySelector(".tracky-mouse-acceleration"),h=n.querySelector(".tracky-mouse-use-camera-button"),m=n.querySelector(".tracky-mouse-use-demo-footage-button"),f=n.querySelector(".tracky-mouse-error-message"),g=n.querySelector(".tracky-mouse-canvas-container"),x=n.querySelector(".tracky-mouse-desktop-app-download-message");window.electronAPI?(x.hidden=!0,window.electronAPI.getIsPackaged().then(Ie=>{i.disabled=!Ie})):(l.parentElement.hidden=!0,i.parentElement.hidden=!0);var b=n.querySelector(".tracky-mouse-canvas"),A=b.getContext("2d"),M=document.createElement("div");M.className="tracky-mouse-pointer",M.style.display="none",document.body.appendChild(M);var L=document.createElement("video");if(L.setAttribute("playsinline",""),typeof Stats<"u"){var C=new Stats;C.domElement.style.position="absolute",C.domElement.style.top="0px",C.domElement.style.right="0px",C.domElement.style.left="",document.body.appendChild(C.domElement)}var u=640,_=480,y=1e3,v=0,T=0,k=0,P=0,S=[],F,K,Q,Z,B=0,G=.5,w=0,D=!0,U=!0,q,j,Y,J,oe=!0,pe=oe,me=!0,Ee={maxContinuousChecks:5,detectionConfidence:.9,maxFaces:1,iouThreshold:.3,scoreThreshold:.75},X,N=!1,te=!0,re=!1,se=0,ve,ee,le=.7,H=0,I,O;let ae,_e;const Ae=()=>{_e&&_e.terminate(),re=!1,te=!0,N=!1,_e=new Worker(`${TrackyMouse$1.dependenciesRoot}/facemesh.worker.js`),_e.addEventListener("message",Ie=>{Ie.data.type==="LOADED"&&(N=!0,ee=()=>{const Oe=ae;if(Oe)return _e.postMessage({type:"ESTIMATE_FACES",imageData:Oe}),new Promise((it,at)=>{_e.addEventListener("message",ht=>{ht.data.type==="ESTIMATED_FACES"&&it(ht.data.predictions)},{once:!0})})})},{once:!0}),_e.postMessage({type:"LOAD",options:Ee})};Ae();function Se(Ie,Oe=!1){"globalSettings"in Ie&&(Ie.globalSettings.swapMouseButtons!==void 0&&(J=Ie.globalSettings.swapMouseButtons,l.checked=J),Ie.globalSettings.mirrorCameraView!==void 0&&(q=Ie.globalSettings.mirrorCameraView,t.checked=q),Ie.globalSettings.headTrackingSensitivityX!==void 0&&(F=Ie.globalSettings.headTrackingSensitivityX,c.value=F*1e3),Ie.globalSettings.headTrackingSensitivityY!==void 0&&(K=Ie.globalSettings.headTrackingSensitivityY,r.value=K*1e3),Ie.globalSettings.headTrackingAcceleration!==void 0&&(Q=Ie.globalSettings.headTrackingAcceleration,d.value=Q*100),Ie.globalSettings.startEnabled!==void 0&&(j=Ie.globalSettings.startEnabled,a.checked=j,Oe&&(D=!j)),Ie.globalSettings.runAtLogin!==void 0&&(Y=Ie.globalSettings.runAtLogin,i.checked=Y))}const ze=1,Xe="tracky-mouse-settings";function Ue(){return{formatVersion:ze,formatName:Xe,globalSettings:{startEnabled:j,runAtLogin:Y,swapMouseButtons:J,mirrorCameraView:q,headTrackingSensitivityX:F,headTrackingSensitivityY:K,headTrackingAcceleration:Q}}}const Ze=Ie=>{if(window.electronAPI)window.electronAPI.setOptions(Ie);else try{localStorage.setItem("tracky-mouse-settings",JSON.stringify(Ue(),null,"	"))}catch(Oe){console.error(Oe)}},He=async(Ie=!1)=>{if(window.electronAPI)Se(await window.electronAPI.getOptions(),Ie);else try{localStorage.getItem("tracky-mouse-settings")&&Se(JSON.parse(localStorage.getItem("tracky-mouse-settings")),Ie)}catch(Oe){console.error(Oe)}};c.onchange=Ie=>{F=c.value/1e3,Ie&&Ze({globalSettings:{headTrackingSensitivityX:F}})},r.onchange=Ie=>{K=r.value/1e3,Ie&&Ze({globalSettings:{headTrackingSensitivityY:K}})},d.onchange=Ie=>{Q=d.value/100,Ie&&Ze({globalSettings:{headTrackingAcceleration:Q}})},t.onchange=Ie=>{q=t.checked,Ie&&Ze({globalSettings:{mirrorCameraView:q}})},l.onchange=Ie=>{J=l.checked,Ie&&Ze({globalSettings:{swapMouseButtons:J}})},a.onchange=Ie=>{j=a.checked,Ie&&Ze({globalSettings:{startEnabled:j}})},i.onchange=Ie=>{Y=i.checked,Ie&&Ze({globalSettings:{runAtLogin:Y}})},t.onchange(),l.onchange(),a.onchange(),i.onchange(),c.onchange(),r.onchange(),d.onchange(),D=!j;for(const Ie of[s,l])Ie.addEventListener("contextmenu",Oe=>{Oe.preventDefault(),l.checked=!l.checked,l.onchange(Oe)});const Je=He(!0);var nt=new clm.tracker({useWebGL:!1});nt.init();var qe=!1;const W=()=>{qe=!1,S.length=0,ve&&(se=Ee.maxContinuousChecks),ve=null,oe=!0,pe=!0,w=0,B=0,o.textContent="Start",o.setAttribute("aria-pressed","false")};h.onclick=TrackyMouse$1.useCamera=()=>{navigator.mediaDevices.getUserMedia({audio:!1,video:{width:u,height:_,facingMode:"user"}}).then(Ie=>{W();try{"srcObject"in L?L.srcObject=Ie:L.src=window.URL.createObjectURL(Ie)}catch{L.src=Ie}h.hidden=!0,f.hidden=!0,D||(o.textContent="Stop",o.setAttribute("aria-pressed","true"))},Ie=>{console.log(Ie),Ie.name=="NotFoundError"||Ie.name=="DevicesNotFoundError"?f.textContent="No camera found. Please make sure you have a camera connected and enabled.":Ie.name=="NotReadableError"||Ie.name=="TrackStartError"?f.textContent="Webcam is already in use. Please make sure you have no other programs using the camera.":Ie.name=="OverconstrainedError"||Ie.name=="ConstraintNotSatisfiedError"?f.textContent="Webcam does not support the required resolution. Please change your settings.":Ie.name=="NotAllowedError"||Ie.name=="PermissionDeniedError"?f.textContent="Permission denied. Please enable access to the camera.":Ie.name=="TypeError"?f.textContent=`Something went wrong accessing the camera. (${Ie.name}: ${Ie.message})`:f.textContent=`Something went wrong accessing the camera. Please try again. (${Ie.name}: ${Ie.message})`,f.textContent=`⚠️ ${f.textContent}`,f.hidden=!1})},m.onclick=TrackyMouse$1.useDemoFootage=()=>{W(),L.srcObject=null,L.src=`${TrackyMouse$1.dependenciesRoot}/private/demo-input-footage.webm`,L.loop=!0},o.onclick=()=>{!h.hidden&&(TrackyMouse$1.useCamera(),!D)||We("toggle-tracking")},navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||console.log("getUserMedia not supported in this browser"),g.style.aspectRatio=`${u} / ${_}`,g.style.setProperty("--aspect-ratio",u/_),L.addEventListener("loadedmetadata",()=>{L.play(),L.width=L.videoWidth,L.height=L.videoHeight,b.width=L.videoWidth,b.height=L.videoHeight,ne.width=L.videoWidth,ne.height=L.videoHeight,ue.width=L.videoWidth,ue.height=L.videoHeight,g.style.aspectRatio=`${L.videoWidth} / ${L.videoHeight}`,g.style.setProperty("--aspect-ratio",L.videoWidth/L.videoHeight),I=new ge,O=new ge}),L.addEventListener("play",()=>{nt.reset(),nt.initFaceDetector(L),qe=!0}),L.addEventListener("ended",()=>{h.hidden=!1,D||We("toggle-tracking")}),L.addEventListener("error",()=>{h.hidden=!1,D||We("toggle-tracking")}),b.width=u,b.height=_,L.width=u,L.height=_;const ne=document.createElement("canvas");ne.width=b.width,ne.height=b.height,ne.getContext("2d");const ue=document.createElement("canvas");ue.width=b.width,ue.height=b.height;const he=ue.getContext("2d"),be=5,Re=be*1.5;class ge{constructor(){this.curPyramid=new jsfeat.pyramid_t(3),this.prevPyramid=new jsfeat.pyramid_t(3),this.curPyramid.allocate(L.videoWidth,L.videoHeight,jsfeat.U8C1_t),this.prevPyramid.allocate(L.videoWidth,L.videoHeight,jsfeat.U8C1_t),this.pointCount=0,this.pointStatus=new Uint8Array(y),this.prevXY=new Float32Array(y*2),this.curXY=new Float32Array(y*2)}addPoint(Oe,it){if(this.pointCount<y){var at=this.pointCount*2;this.curXY[at]=Oe,this.curXY[at+1]=it,this.prevXY[at]=Oe,this.prevXY[at+1]=it,this.pointCount++}}filterPoints(Oe){for(var it=0,at=0;at<this.pointCount;at++)if(Oe(at)){if(it<at){const ht=at*2,St=it*2;this.curXY[St]=this.curXY[ht],this.curXY[St+1]=this.curXY[ht+1],this.prevXY[St]=this.prevXY[ht],this.prevXY[St+1]=this.prevXY[ht+1]}it++}else{he.fillStyle="red";const ht=at*2;Fe(he,this.curXY[ht],this.curXY[ht+1],5),he.fillText(Oe.toString(),5+this.curXY[ht],this.curXY[ht+1]),A.strokeStyle=A.fillStyle,A.beginPath(),A.moveTo(this.prevXY[ht],this.prevXY[ht+1]),A.lineTo(this.curXY[ht],this.curXY[ht+1]),A.stroke()}this.pointCount=it}prunePoints(){this.filterPoints(at=>this.pointStatus[at]==1);const Oe={};for(let at=0;at<this.pointCount;at++){const ht=at*2;Oe[`${~~(this.curXY[ht]/be)},${~~(this.curXY[ht+1]/be)}`]=at}const it=Object.values(Oe);this.filterPoints(at=>it.includes(at))}update(Oe){[this.prevXY,this.curXY]=[this.curXY,this.prevXY],[this.prevPyramid,this.curPyramid]=[this.curPyramid,this.prevPyramid];var it=20,at=30,ht=.01,St=.001;jsfeat.imgproc.grayscale(Oe.data,Oe.width,Oe.height,this.curPyramid.data[0]),this.curPyramid.build(this.curPyramid.data[0],!0),jsfeat.optical_flow_lk.track(this.prevPyramid,this.curPyramid,this.prevXY,this.curXY,this.pointCount,it,at,this.pointStatus,ht,St),this.prunePoints()}draw(Oe){for(var it=0;it<this.pointCount;it++){var at=it*2;Fe(Oe,this.curXY[at],this.curXY[at+1],3),Oe.strokeStyle=Oe.fillStyle,Oe.beginPath(),Oe.moveTo(this.prevXY[at],this.prevXY[at+1]),Oe.lineTo(this.curXY[at],this.curXY[at+1]),Oe.stroke()}}getMovement(){for(var Oe=0,it=0,at=0,ht=0;ht<this.pointCount;ht++){var St=ht*2;Oe+=this.curXY[St]-this.prevXY[St],it+=this.curXY[St+1]-this.prevXY[St+1],at+=1}return at>0&&(Oe/=at,it/=at),[Oe,it]}}b.addEventListener("click",Ie=>{if(!I)return;const Oe=b.getBoundingClientRect();q?I.addPoint((Oe.right-Ie.clientX)/Oe.width*b.width,(Ie.clientY-Oe.top)/Oe.height*b.height):I.addPoint((Ie.clientX-Oe.left)/Oe.width*b.width,(Ie.clientY-Oe.top)/Oe.height*b.height)});function we(Ie,Oe,it){for(var at=0;at<Ie.pointCount;at++){var ht=at*2;if(Math.abs(Oe-Ie.curXY[ht])<=Re||Math.abs(it-Ie.curXY[ht+1])<=Re)return}Ie.addPoint(Oe,it)}function Ce(Ie=!0){A.resetTransform(),A.clearRect(0,0,b.width,b.height),A.save(),A.drawImage(L,0,0,b.width,b.height);const Oe=A.getImageData(0,0,b.width,b.height);if(ae=Oe,q&&(A.translate(b.width,0),A.scale(-1,1),A.drawImage(L,0,0,b.width,b.height)),!!I){if(Ie){if(qe){if(oe||pe){try{nt.track(L)}catch(bt){console.warn("Error in clmTracker.track()",bt),nt.getCurrentParameters().includes(NaN)&&console.warn("NaNs crept in.")}Z=nt.getCurrentPosition(),B=nt.getScore(),Math.pow(nt.getConvergence(),.5)}N&&!re&&(re=!0,S=[],clearTimeout(X),X=setTimeout(()=>{oe||(W(),nt.init(),nt.reset(),nt.initFaceDetector(L),qe=!0,console.warn("Falling back to clmtrackr")),X=setInterval(()=>{try{document.createElement("canvas").getContext("webgl2"),clearInterval(X),setTimeout(()=>{console.warn("Re-initializing facemesh worker"),Ae(),se=1},1e3)}catch(bt){if(bt.name!=="InvalidStateError")throw bt;console.warn("Trying to recover; can't create webgl2 canvas yet...")}},500)},te?2e4:2e3),ee().then(bt=>{if(re=!1,te=!1,se-=1,se>0||(ve=bt[0],oe=!1,pe=!1,clearTimeout(X),!ve))return;O.filterPoints(()=>!1);const{annotations:gt}=ve;O.addPoint(gt.noseLeftCorner[0][0],gt.noseLeftCorner[0][1]),O.addPoint(gt.noseRightCorner[0][0],gt.noseRightCorner[0][1]),O.addPoint(gt.midwayBetweenEyes[0][0],gt.midwayBetweenEyes[0][1]);for(var Lt=0;Lt<O.pointCount;Lt++){const Yt=Lt*2;we(I,O.curXY[Yt],O.curXY[Yt+1])}H=ve.faceInViewConfidence,I.filterPoints(Yt=>{var Gt=Yt*2,nn=Math.hypot((gt.noseTip[0][0]-I.curXY[Gt])*1.4,gt.noseTip[0][1]-I.curXY[Gt+1]),bn=Math.hypot(gt.leftCheek[0][0]-gt.rightCheek[0][0],gt.leftCheek[0][1]-gt.rightCheek[0][1]);return!(nn>bn||(nn=Math.min(Math.hypot(gt.leftEyeLower0[0][0]-I.curXY[Gt],gt.leftEyeLower0[0][1]-I.curXY[Gt+1]),Math.hypot(gt.rightEyeLower0[0][0]-I.curXY[Gt],gt.rightEyeLower0[0][1]-I.curXY[Gt+1])),nn<bn*.42))})},()=>{re=!1,te=!1}))}I.update(Oe)}if(window.electronAPI&&window.electronAPI.notifyCameraFeedDiagnostics({headNotFound:!Z&&!ve}),ve){A.fillStyle="red";const bt=ve.faceInViewConfidence<le;A.fillStyle=bt?"rgb(255,255,0)":"rgb(130,255,50)",!bt||I.pointCount<3||ve.faceInViewConfidence>H+.05?(bt&&(A.fillStyle="rgba(255,0,255)"),Ie&&me&&ve.scaledMesh.forEach(gt=>{gt[0]+=k,gt[1]+=P}),ve.scaledMesh.forEach(([gt,Lt,Yt])=>{A.fillRect(gt,Lt,1,1)})):Ie&&me&&(H-=.001)}if(Z){const bt=B<G;A.strokeStyle=bt?"rgb(255,255,0)":"rgb(130,255,50)",!bt||I.pointCount<2||B>w+.05?(bt&&(A.strokeStyle="rgba(255,0,255)"),Ie&&oe&&(w=B,we(I,Z[42][0],Z[42][1]),we(I,Z[43][0],Z[43][1]),I.filterPoints(gt=>{var Lt=gt*2,Yt=Math.hypot((Z[62][0]-I.curXY[Lt])*1.4,Z[62][1]-I.curXY[Lt+1]),Gt=Math.hypot(Z[23][0]-Z[28][0],Z[23][1]-Z[28][1]);return!(Yt>Gt)}))):Ie&&oe&&(w-=.001),pe&&nt.draw(b,void 0,void 0,!0)}if(A.fillStyle="lime",I.draw(A),he.fillStyle="green",I.draw(he),Ie){var[it,at]=I.getMovement(),ht=(bt,gt)=>bt/1*Math.abs(bt*5)**Q,St=Math.hypot(it,at),Qt=ht(it*F,St),ln=ht(at*K,St);if(!isFinite(Qt)||!isFinite(ln))return;if(!D){const bt=window.electronAPI?screen.width:innerWidth,gt=window.electronAPI?screen.height:innerHeight;v-=Qt*bt,T+=ln*gt,v=Math.min(Math.max(0,v),bt),T=Math.min(Math.max(0,T),gt),U&&(v=bt/2,T=gt/2,U=!1),window.electronAPI?(window.electronAPI.moveMouse(~~v,~~T),M.style.display="none"):(M.style.display="",M.style.left=`${v}px`,M.style.top=`${T}px`),TrackyMouse$1.onPointerMove&&TrackyMouse$1.onPointerMove(v,T)}k=it,P=at}A.restore(),C==null||C.update()}}function Fe(Ie,Oe,it,at){Ie.beginPath(),Ie.arc(Oe,it,at,0,Math.PI*2),Ie.fill()}setInterval(function(){Ce(!D||document.visibilityState==="visible")},15);let Ve=!1;try{Ve=localStorage.trackyMouseAutoDemo==="true"}catch{}Ve?TrackyMouse$1.useDemoFootage():window.electronAPI&&TrackyMouse$1.useCamera();const Ye=()=>{U=!0,D&&(M.style.display="none"),D?(o.textContent="Start",o.setAttribute("aria-pressed","false")):(o.textContent="Stop",o.setAttribute("aria-pressed","true")),window.electronAPI&&window.electronAPI.notifyToggleState(!D)},We=Ie=>{Ie==="toggle-tracking"&&(D=!D,Ye())};Je.then(Ye),window.electronAPI&&window.electronAPI.onShortcut(We),addEventListener("keydown",Ie=>{!Ie.ctrlKey&&!Ie.metaKey&&!Ie.altKey&&!Ie.shiftKey&&Ie.key==="F9"&&We("toggle-tracking")})};typeof module<"u"&&module.exports&&(module.exports=TrackyMouse$1);(e=>{const n=document.createElement.bind(document);function o(c){return c&&typeof c=="object"&&"tagName"in c?c.tagName.toLowerCase()+(c.id?"#"+c.id:"")+(c.className?"."+c.className.split(" ").join("."):"")+(c.src?`[src="${c.src}"]`:"")+(c.srcdoc?"[srcdoc]":"")+(c.href?`[href="${c.href}"]`:""):c?c.constructor.name:`${c}`}function t(c){let d=$(c).find(`
		input:enabled,
		textarea:enabled,
		select:enabled,
		button:enabled,
		a[href],
		[tabIndex='0'],
		details summary,
		iframe,
		object,
		embed,
		video[controls],
		audio[controls],
		[contenteditable]:not([contenteditable='false'])
	`).filter(":visible");const h={},m=[];for(const g of d.toArray())g.nodeName.toLowerCase()==="input"&&g.type==="radio"&&(h[g.name]?g.checked?(m.push(h[g.name]),h[g.name]=g):m.push(g):h[g.name]=g);return d.not(m)}var l=$(window);i.Z_INDEX=5;var a=[];function i(c={}){var N,te,re;var r=$(n("div")).addClass("window os-window").appendTo("body");r[0].$window=r,r.element=r[0],r[0].id=`os-window-${Math.random().toString(36).substr(2,9)}`,r.$titlebar=$(n("div")).addClass("window-titlebar").appendTo(r),r.$title_area=$(n("div")).addClass("window-title-area").appendTo(r.$titlebar),r.$title=$(n("span")).addClass("window-title").appendTo(r.$title_area),c.toolWindow&&(c.minimizeButton=!1,c.maximizeButton=!1),c.minimizeButton!==!1&&(r.$minimize=$(n("button")).addClass("window-minimize-button window-action-minimize window-button").appendTo(r.$titlebar),r.$minimize.attr("aria-label","Minimize window"),r.$minimize.append("<span class='window-button-icon'></span>")),c.maximizeButton!==!1&&(r.$maximize=$(n("button")).addClass("window-maximize-button window-action-maximize window-button").appendTo(r.$titlebar),r.$maximize.attr("aria-label","Maximize or restore window"),c.resizable||r.$maximize.prop("disabled",!0),r.$maximize.append("<span class='window-button-icon'></span>")),c.closeButton!==!1&&(r.$x=$(n("button")).addClass("window-close-button window-action-close window-button").appendTo(r.$titlebar),r.$x.attr("aria-label","Close window"),r.$x.append("<span class='window-button-icon'></span>")),r.$content=$(n("div")).addClass("window-content").appendTo(r),r.$content.attr("tabIndex","-1"),r.$content.css("outline","none"),c.toolWindow&&r.addClass("tool-window"),c.parentWindow&&(c.parentWindow.addChildWindow(r),c.toolWindow&&(r[0].dataset.semanticParent=c.parentWindow[0].id));var d=c.$component;if(typeof c.icon=="object"&&"tagName"in c.icon)c.icons={any:c.icon};else if(c.icon)if(console.warn("DEPRECATED: use options.icons instead of options.icon, e.g. new $Window({icons: {16: 'app-16x16.png', any: 'app-icon.svg'}})"),typeof $Icon<"u"&&typeof TITLEBAR_ICON_SIZE<"u")r.icon_name=c.icon,r.$icon=$Icon(c.icon,TITLEBAR_ICON_SIZE).prependTo(r.$titlebar);else throw new Error("Use {icon: img_element} or {icons: {16: url_or_img_element}} options");r.icons=c.icons||{};let h=16;r.setTitlebarIconSize=function(se){var ve;if(r.icons){(ve=r.$icon)==null||ve.remove();const ee=r.getIconAtSize(se);r.$icon=ee?$(ee):$(),r.$icon.prependTo(r.$titlebar)}h=se,r.trigger("icon-change")},r.getTitlebarIconSize=function(){return h},r.getIconAtSize=function(se){let ve;if(r.icons[se])ve=se;else if(r.icons.any)ve="any";else{const ee=Object.keys(r.icons).filter(le=>isFinite(le)&&isFinite(parseFloat(le)));ee.sort((le,H)=>Math.abs(parseFloat(le)-se)-Math.abs(parseFloat(H)-se)),ve=ee[0]}if(ve){const ee=r.icons[ve];let le;if(typeof ee=="object"&&"cloneNode"in ee)le=ee.cloneNode(!0);else{le=n("img");const H=$(le);typeof ee=="string"?H.attr("src",ee):"srcset"in ee?H.attr("srcset",ee.srcset):H.attr("src",ee.src),H.attr({width:ve,height:ve,draggable:!1}),H.css({width:se,height:se})}return le}return null},r.setTitlebarIconSize(h),r.getIconName=()=>(console.warn("DEPRECATED: use $w.icons object instead of $w.icon_name"),r.icon_name),r.setIconByID=se=>{var ee;console.warn("DEPRECATED: use $w.setIcons(icons) instead of $w.setIconByID(icon_name)");var ve=r.$icon;return r.$icon=$Icon(se,TITLEBAR_ICON_SIZE),ve.replaceWith(r.$icon),r.icon_name=se,(ee=r.task)==null||ee.updateIcon(),r.trigger("icon-change"),r},r.setIcons=se=>{var ve;r.icons=se,r.setTitlebarIconSize(h),(ve=r.task)==null||ve.updateIcon()},d&&r.addClass("component-window"),setTimeout(()=>{m()=="rtl"&&r.addClass("rtl")},0);function m(){return window.get_direction?window.get_direction():getComputedStyle(r[0]).direction}const f=$({}),g=se=>ve=>{const ee=()=>{ve()};return f.on(se,ee),()=>{f.off(se,ee)}};r.onFocus=g("focus"),r.onBlur=g("blur"),r.onClosed=g("closed"),r.setDimensions=({innerWidth:se,innerHeight:ve,outerWidth:ee,outerHeight:le})=>{let H,I;if(se&&(H=r.outerWidth()-r.$content.outerWidth()),ve){I=r.outerHeight()-r.$content.outerHeight();const O=r.$content.find(".menus");O.length&&(I+=O.outerHeight())}ee&&r.outerWidth(ee),le&&r.outerHeight(le),se&&r.outerWidth(se+H),ve&&r.outerHeight(ve+I)},r.setDimensions(c);let x=[];r.addChildWindow=se=>{x.push(se)};const b=()=>{r.hasClass("focused")||(r.addClass("focused"),f.triggerHandler("focus"))},A=()=>{r.hasClass("focused")&&(r.removeClass("focused"),f.triggerHandler("blur"))};r.focus=()=>{r.bringToFront(),B()},r.blur=()=>{A(),document.activeElement&&document.activeElement.closest(".window")==r[0]&&document.activeElement.blur()},c.toolWindow&&(c.parentWindow?(c.parentWindow.onFocus(b),c.parentWindow.onBlur(A),document.activeElement&&document.activeElement.closest(".window")==c.parentWindow[0]&&b()):($(window).on("focus",b),$(window).on("blur",A),document.hasFocus()&&b()));{let ve=function(H){if(!y.has(H)){const I=le(H,!1);y.set(H,I),setTimeout(()=>{try{const O=ae=>{H.contentDocument.readyState=="complete"?ae():setTimeout(()=>{O(ae)},100)};O(()=>{H.contentWindow.addEventListener("focusin",I),H.contentWindow.addEventListener("focusout",I),H.contentWindow.addEventListener("blur",I),H.contentWindow.addEventListener("focus",I),ee(H.contentDocument)})}catch(O){P(H,O)}},100)}},ee=function(H){new MutationObserver(O=>{for(const ae of O)for(const _e of ae.addedNodes)_e.tagName=="IFRAME"&&ve(_e)}).observe(H,{childList:!0,subtree:!0});for(const O of H.querySelectorAll("iframe"))ve(O)},le=function(H,I){return function(ae){var Ue,Ze;const _e=H.tagName=="IFRAME"?H.contentDocument:H,Ae=_e.ownerDocument??_e;let Se=ae?ae.type==="focusout"||ae.type==="blur"?ae.relatedTarget:ae.target:Ae.activeElement;(ae==null?void 0:ae.type)==="blur"&&(Se=null),Ae.activeElement&&Ae.activeElement.tagName==="IFRAME"&&((ae==null?void 0:ae.type)==="focusout"||(ae==null?void 0:ae.type)==="blur")&&!Se&&(Se=Ae.activeElement);const ze=!Se||Se.window===Se||!_e.contains(Se);if(ze&&_e!==Se&&I&&(c.toolWindow||A()),!ze&&Se.tagName!=="HTML"&&Se.tagName!=="BODY"&&Se!==_e&&!Se.matches(".window-content")&&!Se.closest(".menus")&&!Se.closest(".window-titlebar")&&(_.set(H,Se),S(Ae,_e,Se,I)),!ze&&Se.tagName==="IFRAME"){const He=Se;try{const Je=He.contentDocument.activeElement;Je&&Je.tagName!=="HTML"&&Je.tagName!=="BODY"&&!Je.closest(".menus")&&(_.set(He,Je),S(He.contentDocument,He.contentDocument,Je,I))}catch(Je){P(He,Je)}}if(I)do{const He=(Ue=Se==null?void 0:Se.closest)==null?void 0:Ue.call(Se,"[data-semantic-parent]");if(He){const Je=He.dataset.semanticParent,nt=He.ownerDocument.getElementById(Je);if(Se=nt,!nt){console.warn("semantic parent not found with id",Je);break}}else break}while(!0);if(Se&&Se.window!==Se&&_e.contains(Se)){if(c.toolWindow||b(),r.bringToFront(),!I){let He=H;for(;He;)He.dispatchEvent(new Event("focusin",{bubbles:!0,target:He,view:He.ownerDocument.defaultView})),He=(Ze=He.ownerDocument.defaultView)==null?void 0:Ze.frameElement}}else I&&(c.toolWindow||A())}};var me=ve,Ee=ee,X=le;const se=le(r[0],!0);window.addEventListener("focusin",se),window.addEventListener("focusout",se),window.addEventListener("blur",se),window.addEventListener("focus",se),ee(r.$content[0])}r.css("touch-action","none");let M=null;r.setMinimizeTarget=function(se){M=se};let L;Object.defineProperty(r,"task",{get(){return L},set(se){console.warn("DEPRECATED: use $w.setMinimizeTarget(taskbar_button_el) instead of setting $window.task object"),L=se}});let C;r.minimize=()=>{if(M=M||(L==null?void 0:L.$task[0]),J){oe.push(r.minimize);return}if(r.is(":visible"))if(M&&!r.hasClass("minimized-without-taskbar")){const se=r.$titlebar[0].getBoundingClientRect(),ve=M.getBoundingClientRect();r.animateTitlebar(se,ve,()=>{r.hide(),r.blur()})}else{if(r.hasClass("minimized-without-taskbar"))a[r._minimize_slot_index]=null;else{let Ae=0;for(;a[Ae];)Ae++;r._minimize_slot_index=Ae,a[Ae]=r}const ee=r._minimize_slot_index*160+10,le=r.$titlebar.outerHeight()??0;let H;const I=()=>{C={position:r.css("position"),left:r.css("left"),top:r.css("top"),width:r.css("width"),height:r.css("height")},r.addClass("minimized-without-taskbar"),r.hasClass("maximized")&&(r.removeClass("maximized"),r.addClass("was-maximized"),r.$maximize.removeClass("window-action-restore"),r.$maximize.addClass("window-action-maximize")),r.$minimize.removeClass("window-action-minimize"),r.$minimize.addClass("window-action-restore"),H?r.css({position:H.position,left:H.left,top:H.top,width:H.width,height:H.height}):r.css({position:"fixed",top:`calc(100% - ${le+5}px)`,left:`${ee}px`,width:"150px",height:`${le}px`})},O=()=>{H={position:r.css("position"),left:r.css("left"),top:r.css("top"),width:r.css("width"),height:r.css("height")},r.removeClass("minimized-without-taskbar"),r.hasClass("was-maximized")&&(r.removeClass("was-maximized"),r.addClass("maximized"),r.$maximize.removeClass("window-action-maximize"),r.$maximize.addClass("window-action-restore")),r.$minimize.removeClass("window-action-restore"),r.$minimize.addClass("window-action-minimize"),r.css({width:"",height:""}),C&&r.css({position:C.position,left:C.left,top:C.top,width:C.width,height:C.height})},ae=r.$titlebar[0].getBoundingClientRect();let _e;r.css("transform",""),r.hasClass("minimized-without-taskbar")?(O(),_e=r.$titlebar[0].getBoundingClientRect(),I()):(I(),_e=r.$titlebar[0].getBoundingClientRect(),O()),r.animateTitlebar(ae,_e,()=>{r.hasClass("minimized-without-taskbar")?O():(I(),r.blur())})}},r.unminimize=()=>{if(J){oe.push(r.unminimize);return}if(r.hasClass("minimized-without-taskbar")){r.minimize();return}if(r.is(":hidden")){const se=M.getBoundingClientRect();r.show();const ve=r.$titlebar[0].getBoundingClientRect();r.hide(),r.animateTitlebar(se,ve,()=>{r.show(),r.bringToFront(),r.focus()})}};let u;r.maximize=()=>{if(!c.resizable)return;if(J){oe.push(r.maximize);return}if(r.hasClass("minimized-without-taskbar")){r.minimize();return}const se=()=>{u={position:r.css("position"),left:r.css("left"),top:r.css("top"),width:r.css("width"),height:r.css("height")},r.addClass("maximized");const I=$(".taskbar"),O=window.innerWidth-$(window).width(),ae=window.innerHeight-$(window).height(),_e=I.length?I.outerHeight()+1:0;r.css({position:"fixed",top:0,left:0,width:`calc(100vw - ${O}px)`,height:`calc(100vh - ${ae}px - ${_e}px)`})},ve=()=>{r.removeClass("maximized"),r.css({width:"",height:""}),u&&r.css({position:u.position,left:u.left,top:u.top,width:u.width,height:u.height})},ee=r.$titlebar[0].getBoundingClientRect();let le;r.css("transform","");const H=r.hasClass("maximized");H?(ve(),le=r.$titlebar[0].getBoundingClientRect(),se()):(se(),le=r.$titlebar[0].getBoundingClientRect(),ve()),r.animateTitlebar(ee,le,()=>{H?(ve(),r.$maximize.removeClass("window-action-restore"),r.$maximize.addClass("window-action-maximize")):(se(),r.$maximize.removeClass("window-action-maximize"),r.$maximize.addClass("window-action-restore"))})},r.restore=()=>{r.is(".minimized-without-taskbar, .minimized")?r.unminimize():r.is(".maximized")&&r.maximize()},(N=r.$minimize)==null||N.on("click",se=>{r.minimize()}),(te=r.$maximize)==null||te.on("click",se=>{r.maximize()}),(re=r.$x)==null||re.on("click",se=>{r.close()}),r.$title_area.on("dblclick",se=>{r.maximize()}),r.css({position:"absolute",zIndex:i.Z_INDEX++}),r.bringToFront=()=>{r.css({zIndex:i.Z_INDEX++});for(const se of x)se.bringToFront()};var _=new Map,y=new Map,v=new Map,T=[],k=new WeakSet;const P=(se,ve)=>{var H;const ee=I=>[`OS-GUI.js failed to access an iframe (${o(se)}) for focus integration.
${I}
Original error:
`,ve];let le;if(se.srcdoc)le=!1;else try{le=new URL(se.src).origin!==window.location.origin}catch(I){console.error(...ee(`This may be a bug in OS-GUI. Is this a cross-origin iframe? Failed to parse URL (${I}).`));return}le?(H=c.iframes)!=null&&H.ignoreCrossOrigin&&!k.has(se)&&(console.warn(...ee(`Only same-origin iframes can work with focus integration (showing window as focused, refocusing last focused controls).
If you can re-host the content on the same origin, you can resolve this and enable focus integration.
You can also disable this warning by passing {iframes: {ignoreCrossOrigin: true}} to $Window.`)),k.add(se)):console.error(...ee("This may be a bug in OS-GUI, since it doesn't appear to be a cross-origin iframe."))},S=(se,ve,ee,le)=>{if(!i.DEBUG_FOCUS)return;let H=v.get(ve);H||(H=se.createElementNS("http://www.w3.org/2000/svg","svg"),H.style.position="fixed",H.style.top="0",H.style.left="0",H.style.width="100%",H.style.height="100%",H.style.pointerEvents="none",H.style.zIndex="100000000",H.style.direction="ltr",v.set(ve,H),T.push(H),se.body.appendChild(H)),H._container_el=ve,H._descendant_el=ee,H._is_root=le,Q()},F=se=>{var ae,_e;const ve=se._container_el,ee=se._descendant_el,le=se._is_root;for(;se.lastChild;)se.removeChild(se.lastChild);const H=((ae=ee.getBoundingClientRect)==null?void 0:ae.call(ee))??{left:0,top:0,width:innerWidth,height:innerHeight,right:innerWidth,bottom:innerHeight},I=((_e=ve.getBoundingClientRect)==null?void 0:_e.call(ve))??{left:0,top:0,width:innerWidth,height:innerHeight,right:innerWidth,bottom:innerHeight};for(const Ae of[H,I]){const Se=document.createElementNS("http://www.w3.org/2000/svg","rect");Se.setAttribute("x",Ae.left),Se.setAttribute("y",Ae.top),Se.setAttribute("width",Ae.width),Se.setAttribute("height",Ae.height),Se.setAttribute("stroke","#f44"),Se.setAttribute("stroke-width","2"),Se.setAttribute("fill","none"),le||Se.setAttribute("stroke-dasharray","5,5"),se.appendChild(Se);const ze=document.createElementNS("http://www.w3.org/2000/svg","text");ze.setAttribute("x",Ae.left),ze.setAttribute("y",Ae.top+(Ae===H?20:0)),ze.setAttribute("fill",Ae===H?"#f44":"aqua"),ze.setAttribute("font-size","20"),ze.style.textShadow="1px 1px 1px black, 0 0 10px black",ze.textContent=o(Ae===H?ee:ve),se.appendChild(ze)}const O=[[H.left,H.top,I.left,I.top],[H.right,H.top,I.right,I.top],[H.left,H.bottom,I.left,I.bottom],[H.right,H.bottom,I.right,I.bottom]];for(const Ae of O){const Se=document.createElementNS("http://www.w3.org/2000/svg","line");Se.setAttribute("x1",Ae[0]),Se.setAttribute("y1",Ae[1]),Se.setAttribute("x2",Ae[2]),Se.setAttribute("y2",Ae[3]),Se.setAttribute("stroke","green"),Se.setAttribute("stroke-width","2"),se.appendChild(Se)}};let K;const Q=()=>{if(cancelAnimationFrame(K),!i.DEBUG_FOCUS){Z();return}K=requestAnimationFrame(Q);for(const se of T)F(se)},Z=()=>{cancelAnimationFrame(K);for(const se of T)se.remove();T.length=0,v.clear()},B=(se=r.$content[0])=>{const ve=se.matches(".window-content")?r[0]:se,ee=_.get(ve);if(ee){if(ee.focus({preventScroll:!0}),ee.tagName==="IFRAME")try{B(ee)}catch(I){P(ee,I)}return}const le=t(se),H=le.filter(".default");if(H.length){H[0].focus({preventScroll:!0});return}if(le.length){if(le[0].tagName==="IFRAME"){const I=le[0];try{B(I)}catch(O){P(I,O)}}else le[0].focus({preventScroll:!0});return}if(c.toolWindow&&c.parentWindow){c.parentWindow.triggerHandler("refocus-window");return}if(se.focus({preventScroll:!0}),se.tagName==="IFRAME"){const I=se;try{B(I.contentDocument.body)}catch(O){P(I,O)}}};r.on("refocus-window",()=>{B()}),r.on("pointerdown mousedown",G),l.on("focusin",se=>{_.set(window,se.target)});function G(se){r.bringToFront(),requestAnimationFrame(()=>{var le,H;const ve=_.get(window);if(document.activeElement&&document.activeElement!==document&&document.activeElement!==document.body&&document.activeElement!==r.$content[0]&&document.activeElement!==ve||(H=(le=document.activeElement)==null?void 0:le.closest)!=null&&H.call(le,".menus, .menu-popup"))return;if(getComputedStyle(se.target).userSelect!=="none"){r.$content.focus(),r.one("pointerup pointercancel",()=>{requestAnimationFrame(()=>{var I;(I=getSelection())!=null&&I.toString().trim()||B()})});return}B()})}r.on("keydown",se=>{if(se.isDefaultPrevented()||se.ctrlKey||se.altKey||se.metaKey||se.target.closest(".menus"))return;const ve=r.$content.find("button"),ee=$(document.activeElement),le=ve.index(ee);switch(se.keyCode){case 40:case 39:ee.is("button")&&!se.shiftKey&&le<ve.length-1&&(ve[le+1].focus(),se.preventDefault());break;case 38:case 37:ee.is("button")&&!se.shiftKey&&le>0&&(ve[le-1].focus(),se.preventDefault());break;case 32:case 13:if(ee.is("button")&&!se.shiftKey){ee.addClass("pressed");const H=()=>{ee.removeClass("pressed"),ee.off("focusout",H),$(window).off("keyup",I)},I=O=>{(O.keyCode===32||O.keyCode===13)&&H()};ee.on("focusout",H),$(window).on("keyup",I)}break;case 9:{const H=t(r.$content[0]);if(H.length>0){const I=H.index(ee);se.shiftKey?I===0&&(se.preventDefault(),H[H.length-1].focus()):I===H.length-1&&(se.preventDefault(),H[0].focus())}break}case 27:r.close();break}}),r.applyBounds=()=>{const se=Math.max(document.body.scrollWidth,innerWidth),ve=Math.max(document.body.scrollHeight,innerHeight);r.css({left:Math.max(0,Math.min(se-r.width(),r.position().left)),top:Math.max(0,Math.min(ve-r.height(),r.position().top))})},r.bringTitleBarInBounds=()=>{const se=Math.max(document.body.scrollWidth,innerWidth),ve=Math.max(document.body.scrollHeight,innerHeight),ee=40;r.css({left:Math.max(ee-r.outerWidth(),Math.min(se-ee,r.position().left)),top:Math.max(0,Math.min(ve-r.$titlebar.outerHeight()-5,r.position().top))})},r.center=()=>{r.css({left:(innerWidth-r.width())/2+window.scrollX,top:(innerHeight-r.height())/2+window.scrollY}),r.applyBounds()},l.on("resize",r.bringTitleBarInBounds);var w,D,U,q,j,Y=se=>{var ee;const ve=se.pointerId??((ee=se.originalEvent)==null?void 0:ee.pointerId);(j===ve||ve===void 0||j===void 0||j===1234567890)&&(U=se.clientX??U,q=se.clientY??q),r.css({left:U+scrollX-w,top:q+scrollY-D})};r.$titlebar.css("touch-action","none"),r.$titlebar.on("selectstart",se=>{se.preventDefault()}),r.$titlebar.on("mousedown","button",se=>{B();const ve=se.currentTarget;if(!$(ve).is(":enabled"))return;ve.classList.add("pressing");const ee=I=>{I&&I.type==="blur"&&document.hasFocus()||(ve.classList.remove("pressing"),l.off("mouseup blur",ee),$(ve).off("mouseenter",le),$(ve).off("mouseleave",H))},le=()=>{ve.classList.add("pressing")},H=()=>{ve.classList.remove("pressing")};l.on("mouseup blur",ee),$(ve).on("mouseenter",le),$(ve).on("mouseleave",H)}),r.$titlebar.on("pointerdown",se=>{var ee;if($(se.target).closest("button").length||r.hasClass("maximized"))return;const ve=$.Event("window-drag-start");r.trigger(ve),!ve.isDefaultPrevented()&&(w=se.clientX+scrollX-r.position().left,D=se.clientY+scrollY-r.position().top,U=se.clientX,q=se.clientY,j=se.pointerId??((ee=se.originalEvent)==null?void 0:ee.pointerId),l.on("pointermove",Y),l.on("scroll",Y),$("body").addClass("dragging"))}),l.on("pointerup pointercancel",se=>{var ee;const ve=se.pointerId??((ee=se.originalEvent)==null?void 0:ee.pointerId);ve!==j&&ve!==void 0||(l.off("pointermove",Y),l.off("scroll",Y),$("body").removeClass("dragging"),r.bringTitleBarInBounds(),j=-1)}),r.$titlebar.on("dblclick",se=>{d&&d.dock()}),c.resizable&&[[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1],[1,0],[1,1],[0,1]].forEach(([_e,Ae])=>{const Se=$("<div>").addClass("handle").appendTo(r);let ze="";_e===-1&&(ze+="n"),_e===1&&(ze+="s"),Ae===-1&&(ze+="w"),Ae===1&&(ze+="e"),ze+="-resize";const Xe=(r.outerWidth()-r.width())/2,Ue=(r.outerWidth()-r.innerWidth())/2,Ze=r.outerHeight()-r.$content.outerHeight(),He=r.outerWidth()-r.$content.outerWidth();Se.css({position:"absolute",top:_e===-1?-Ue:_e===0?`calc(${Xe}px - ${Ue}px)`:"",bottom:_e===1?-Ue:"",left:Ae===-1?-Ue:Ae===0?`calc(${Xe}px - ${Ue}px)`:"",right:Ae===1?-Ue:"",width:Ae===0?`calc(100% - ${Xe}px * 2 + ${Ue*2}px)`:`${Xe}px`,height:_e===0?`calc(100% - ${Xe}px * 2 + ${Ue*2}px)`:`${Xe}px`,touchAction:"none",cursor:ze});let Je,nt,qe,W,ne,ue;Se.on("pointerdown",ge=>{var we;ge.preventDefault(),l.on("pointermove",he),l.on("scroll",Re),$("body").addClass("dragging"),l.on("pointerup pointercancel",be),Je={x:r.position().left,y:r.position().top,width:r.outerWidth(),height:r.outerHeight()},nt=ge.clientX+scrollX-Je.x-(Ae===1?Je.width:0),qe=ge.clientY+scrollY-Je.y-(_e===1?Je.height:0),W=ge.clientX,ne=ge.clientY,ue=ge.pointerId??((we=ge.originalEvent)==null?void 0:we.pointerId);try{Se[0].setPointerCapture(ue)}catch(Ce){console.warn("Failed to capture pointer for resize handle drag:",Ce)}});function he(ge){var Ce;const we=ge.pointerId??((Ce=ge.originalEvent)==null?void 0:Ce.pointerId);we!==ue&&we!==void 0||(W=ge.clientX,ne=ge.clientY,Re())}function be(ge){var Ce;const we=ge.pointerId??((Ce=ge.originalEvent)==null?void 0:Ce.pointerId);we!==ue&&we!==void 0||(l.off("pointermove",he),$("body").removeClass("dragging"),l.off("pointerup pointercancel",be),r.bringTitleBarInBounds())}function Re(){const ge=W+scrollX-nt,we=ne+scrollY-qe;let Ce=0,Fe=0,Ve,Ye;Ae===1?(Ce=0,Ve=~~(ge-Je.x)):Ae===-1?(Ce=~~(ge-Je.x),Ve=~~(Je.x+Je.width-ge)):Ve=~~Je.width,_e===1?(Fe=0,Ye=~~(we-Je.y)):_e===-1?(Fe=~~(we-Je.y),Ye=~~(Je.y+Je.height-we)):Ye=~~Je.height;let We={x:Je.x+Ce,y:Je.y+Fe,width:Ve,height:Ye};We.width=Math.max(1,We.width),We.height=Math.max(1,We.height),c.constrainRect&&(We=c.constrainRect(We,Ae,_e)),We.width=Math.max(We.width,c.minOuterWidth??100),We.height=Math.max(We.height,c.minOuterHeight??0),We.width=Math.max(We.width,(c.minInnerWidth??0)+He),We.height=Math.max(We.height,(c.minInnerHeight??0)+Ze),Ae===-1&&(We.x=Math.min(We.x,Je.x+Je.width-We.width)),_e===-1&&(We.y=Math.min(We.y,Je.y+Je.height-We.height)),r.css({top:We.y,left:We.x}),r.outerWidth(We.width),r.outerHeight(We.height)}}),r.$Button=(se,ve)=>{var ee=$(n("button")).appendTo(r.$content).text(se).on("click",()=>{ve&&ve(),r.close()});return ee},r.title=se=>typeof se<"u"?(r.$title.text(se),r.trigger("title-change"),r.task&&r.task.updateTitle(),r):r.$title.text(),r.getTitle=()=>r.title();let J=!1,oe=[];r.animateTitlebar=(se,ve,ee=()=>{})=>{J=!0;const le=r.$titlebar.clone(!0);le.find("button").remove(),le.appendTo("body");const H=i.OVERRIDE_TRANSITION_DURATION??200,I=`${H}ms`;le.css({transition:`left ${I} linear, top ${I} linear, width ${I} linear, height ${I} linear`,position:"fixed",zIndex:1e7,pointerEvents:"none",left:se.left,top:se.top,width:se.width,height:se.height}),setTimeout(()=>{le.css({left:ve.left,top:ve.top,width:ve.width,height:ve.height})},5);let O=!1;const ae=()=>{var _e;O||(O=!0,J=!1,le.remove(),ee(),(_e=oe.shift())==null||_e())};le.on("transitionend transitioncancel",ae),setTimeout(ae,H*1.2)},r.close=se=>{if(se&&se!==!0)throw new TypeError("force must be a boolean or undefined, not "+Object.prototype.toString.call(se));if(!se){var ve=$.Event("close");if(r.trigger(ve),ve.isDefaultPrevented())return}d&&d.detach(),r.closed=!0,a[r._minimize_slot_index]=null,f.triggerHandler("closed"),r.trigger("closed"),r.remove();var ee=$($(".window:visible").toArray().sort((le,H)=>H.style.zIndex-le.style.zIndex)[0]);ee.triggerHandler("refocus-window"),Z()},r.closed=!1;let pe;return r.setMenuBar=se=>{pe&&pe.element.remove(),se&&(r.$titlebar.after(se.element),se.setKeyboardScope(r[0]),pe=se)},c.title&&r.title(c.title),d||r.center(),r}function s(c){var r=i();return r.title(c),r.$form=$(n("form")).appendTo(r.$content),r.$main=$(n("div")).appendTo(r.$form),r.$buttons=$(n("div")).appendTo(r.$form).addClass("button-group"),r.$Button=(d,h)=>{var m=$(n("button")).appendTo(r.$buttons).text(d);return m.on("click",f=>{f.preventDefault(),h()}),m.on("pointerdown",()=>{m.focus()}),m},r}e.$Window=i,e.$FormWindow=s})(window);(e=>{function n(m,f){const g=document.createElement(m);if(f)for(const x in f)x==="class"?g.className=f[x]:g.setAttribute(x,f[x]);return g}let o=0;function t(){return(o++).toString(36)+Math.random().toString(36).slice(2)}const l={escape:function(m){return m.replace(/&/g,"&&")},unescape:function(m){return m.replace(/&&/g,"&")},indexOf:function(m){return` ${m}`.search(/[^&]&[^&\s]/)},has:function(m){return this.indexOf(m)>=0},get:function(m){const f=this.indexOf(m);return f>=0?m.charAt(f+1).toUpperCase():null},remove:function(m){const f=/\s?\(&[^&]\)/;return f.test(m)?this.unescape(m.replace(f,"")):this.toText(m)},toText:function(m){const f=this.indexOf(m);return f>=0?this.unescape(m.substring(0,f))+this.unescape(m.substring(f+1)):this.unescape(m)},toHTML:function(m){const f=this.toFragment(m),g=document.createElement("div");return g.appendChild(f),g.innerHTML},toFragment:function(m){const f=document.createDocumentFragment(),g=this.indexOf(m);if(g>=0){f.appendChild(document.createTextNode(this.unescape(m.substring(0,g))));const x=n("span",{class:"menu-hotkey"});x.appendChild(document.createTextNode(m.charAt(g+1))),f.appendChild(x),f.appendChild(document.createTextNode(this.unescape(m.substring(g+2))))}else f.appendChild(document.createTextNode(this.unescape(m)));return f}},a="MENU_DIVIDER",i=1e3;let s=null;function c(){document.activeElement&&document.activeElement.tagName!=="BODY"&&document.activeElement.tagName!=="HTML"&&!document.activeElement.closest(".menus, .menu-popup")&&(s=document.activeElement)}typeof window<"u"&&(window.addEventListener("focusin",c),window.addEventListener("focusout",c));let r=1;function d(){return typeof $Window<"u"?$Window.Z_INDEX+++i:++r+i}function h(m){if(!(this instanceof h))return new h(m);const f=n("div",{class:"menus",role:"menubar","aria-label":"Application Menu"});f.style.touchAction="none";function g(){return window.get_direction?window.get_direction():getComputedStyle(f).direction}let x=!1;const b=[];let A=-1,M;const L=new WeakMap,C=new WeakMap,u=()=>{for(const{menu_button_el:B}of b)B.getAttribute("aria-expanded")==="true"&&B.dispatchEvent(new CustomEvent("release",{}))},_=()=>{if(s&&(s.focus(),document.activeElement===s))return;const B=f.closest(".window");B&&B.dispatchEvent(new CustomEvent("refocus-window"))},y=B=>{const G=typeof B=="string"?Object.keys(m).indexOf(B):B;A!==-1&&A!==G&&b[A].menu_button_el.classList.remove("highlight"),G!==-1&&b[G].menu_button_el.classList.add("highlight"),A=G};f.addEventListener("pointerleave",()=>{A!==-1&&b[A].menu_popup_el.style.display==="none"&&y(-1)});const v=B=>typeof B.enabled=="function"?!B.enabled():typeof B.enabled=="boolean"?!B.enabled:!1;function T(B){const G=(B==null?void 0:B.description)||"";if(typeof jQuery<"u"){const w=new jQuery.Event("info",{detail:{description:G}}),D={toString(){return console.warn("jQuery extra parameter for info event is deprecated, use event.detail instead"),G}};jQuery(f).trigger(w,D)}else f.dispatchEvent(new CustomEvent("info",{detail:{description:G}}))}function k(B){if(B.defaultPrevented)return;const G=M==null?void 0:M.element,w=b[A],{menu_button_el:D,open_top_level_menu:U}=w||{},q=G||(w==null?void 0:w.menu_popup_el),j=G?C.get(G):void 0,Y=q==null?void 0:q.querySelector(".menu-item.highlight");if(Y&&!(Y instanceof HTMLElement))throw new Error("Unexpected type for highlighted item element");switch(B.key){case"ArrowLeft":case"ArrowRight":const J=B.key==="ArrowRight";if(Y!=null&&Y.matches(".has-submenu:not([aria-disabled='true'])")&&g()==="ltr"===J)Y.click(),B.preventDefault();else if(M&&M.parentMenuPopup&&g()==="ltr"!==J)M.close(!0),j.setAttribute("aria-expanded","false"),T(M.menuItems[M.itemElements.indexOf(j)]),B.preventDefault();else if(Y||!M||!M.parentMenuPopup){const N=q&&q.style.display!=="none",te=g()==="ltr"===J?1:-1;let re;A===-1?re=te===1?0:b.length-1:re=(A+te+b.length)%b.length;const se=b[re],ve=se.menu_button_el;N?se.open_top_level_menu("keydown"):(D==null||D.dispatchEvent(new CustomEvent("release",{})),ve.focus({preventScroll:!0}),y(re)),B.preventDefault()}break;case"ArrowUp":case"ArrowDown":const oe=B.key==="ArrowDown";if(M){const N=oe?1:-1,te=[...q.querySelectorAll(".menu-item")],re=te.indexOf(Y);let se=(re+N+te.length)%te.length;re===-1&&(oe?se=0:se=te.length-1);const ve=te[se];M.highlight(ve),T(M.menuItems[M.itemElements.indexOf(ve)]),B.preventDefault()}else U==null||U("keydown");B.preventDefault();break;case"Escape":if(M)j&&j!==D?(M.close(!0),j.setAttribute("aria-expanded","false"),T(M.menuItems[M.itemElements.indexOf(j)])):(u(),D.focus({preventScroll:!0})),B.preventDefault();else{const N=f.closest(".window");N&&(N.dispatchEvent(new CustomEvent("refocus-window")),B.preventDefault())}break;case"Alt":u(),_(),B.preventDefault();break;case"Space":break;case"Enter":D===document.activeElement?(U("keydown"),B.preventDefault()):(Y==null||Y.click(),B.preventDefault());break;default:if(B.ctrlKey||B.metaKey)break;const pe=B.key.toLowerCase(),me=M?[...q.querySelectorAll(".menu-item")]:b.map(N=>N.menu_button_el),Ee={};for(const N of me){const te=N.querySelector(".menu-hotkey"),re=(te?te.textContent:(N.querySelector(".menu-item-label")??N).textContent[0]).toLowerCase();Ee[re]=Ee[re]||[],Ee[re].push(N)}const X=Ee[pe]||[];if(X.length)if(X.length===1){const N=X[0],te=b.find(re=>re.menu_button_el===N);te?te.open_top_level_menu("keydown"):N.click(),B.preventDefault()}else{let N=X.indexOf(Y);N===-1?N=0:N=(N+1)%X.length;const te=X[N];M.highlight(te),B.preventDefault()}break}}f.addEventListener("keydown",k);function P(B,{parentMenuPopup:G}={}){this.parentMenuPopup=G,this.menuItems=B,this.itemElements=[];const w=n("div",{class:"menu-popup",id:`menu-popup-${t()}`,tabIndex:"-1",role:"menu"});w.style.touchAction="pan-y",w.style.outline="none";const D=n("table",{class:"menu-popup-table",role:"presentation"});w.appendChild(D),this.element=w;let U=[];w.addEventListener("keydown",k),w.addEventListener("pointerleave",()=>{for(const J of U)if(J.submenu_popup_el.style.display!=="none"){this.highlight(J.item_el);return}this.highlight(-1)}),w.addEventListener("focusin",J=>{w.focus({preventScroll:!0})});let q;this.highlight=J=>{let oe;typeof J=="number"?oe=this.itemElements[J]:oe=J,q&&q!==oe&&q.classList.remove("highlight"),oe?(oe.classList.add("highlight"),w.setAttribute("aria-activedescendant",oe.id),q=oe):(w.removeAttribute("aria-activedescendant"),q=null)},this.close=(J=!0)=>{var oe;for(const pe of U)pe.submenu_popup.close(!1);J&&((oe=this.parentMenuPopup)==null||oe.element.focus({preventScroll:!0})),w.style.display="none",this.highlight(-1),M===this&&(M=this.parentMenuPopup)};const j=(J,oe,pe)=>{var X,N;const me=n("tr",{class:"menu-row"});if(this.itemElements.push(me),J.appendChild(me),oe===a){const te=n("td",{colspan:"4"}),re=n("hr",{class:"menu-hr"});te.appendChild(re),me.appendChild(te),re.addEventListener("pointerenter",()=>{this.highlight(-1)})}else{const te=me;te.classList.add("menu-item"),te.id=`menu-item-${t()}`,te.tabIndex=-1,te.setAttribute("role",oe.checkbox?oe.checkbox.type==="radio"?"menuitemradio":"menuitemcheckbox":"menuitem"),(oe.label||oe.item)&&te.setAttribute("aria-label",l.toText(oe.label||oe.item)),te.setAttribute("aria-keyshortcuts",oe.ariaKeyShortcuts||""),oe.description&&te.setAttribute("aria-description",oe.description);const re=n("td",{class:"menu-item-checkbox-area"}),se=n("td",{class:"menu-item-label"}),ve=n("td",{class:"menu-item-shortcut"}),ee=n("td",{class:"menu-item-submenu-area"});te.appendChild(re),te.appendChild(se),te.appendChild(ve),te.appendChild(ee),oe.label?se.appendChild(l.toFragment(oe.label)):oe.item&&(se.appendChild(l.toFragment(oe.item)),console.warn("Menu item option `item` is deprecated; use `label` instead.")),oe.shortcutLabel?ve.textContent=oe.shortcutLabel:oe.shortcut&&(ve.textContent=oe.shortcut,console.warn("Menu item option `shortcut` is deprecated; use `shortcutLabel` instead (and ideally provide `ariaKeyShortcuts` as well)")),w.addEventListener("update",()=>{if(v(oe)?(te.setAttribute("disabled",""),te.setAttribute("aria-disabled","true")):(te.removeAttribute("disabled"),te.removeAttribute("aria-disabled")),oe.checkbox&&oe.checkbox.check){const ae=oe.checkbox.check();te.setAttribute("aria-checked",ae?"true":"false")}}),te.addEventListener("pointerenter",()=>{this.highlight(pe),T(oe)}),te.addEventListener("pointerleave",ae=>{w.style.display!=="none"&&ae.pointerType!=="touch"&&T()}),((X=oe.checkbox)==null?void 0:X.type)==="radio"?re.classList.add("radio"):oe.checkbox&&re.classList.add("checkbox");let le,H;if(oe.submenu){let _e=function(){for(const{submenu_popup:ze,item_el:Xe}of U)ze.close(!1),Xe.setAttribute("aria-expanded","false");w.focus({preventScroll:!0})};var Ee=_e;te.classList.add("has-submenu"),ee.classList.toggle("point-right",g()==="rtl");const ae=new P(oe.submenu,{parentMenuPopup:this});H=ae.element,(N=document.body)==null||N.appendChild(H),H.style.display="none",te.setAttribute("aria-haspopup","true"),te.setAttribute("aria-expanded","false"),te.setAttribute("aria-controls",H.id),L.set(te,ae),C.set(H,te),H.dataset.semanticParent=w.id,w.setAttribute("aria-owns",`${w.getAttribute("aria-owns")||""} ${H.id}`),H.setAttribute("aria-labelledby",te.id),le=(ze=!0)=>{if(H.style.display!=="none"||te.getAttribute("aria-disabled")==="true")return;_e(),te.setAttribute("aria-expanded","true"),H.style.display="",H.style.zIndex=`${d()}`,H.setAttribute("dir",g()),window.inheritTheme&&window.inheritTheme(H,w),H.parentElement||document.body.appendChild(H),H.dispatchEvent(new CustomEvent("update",{})),ze?(ae.highlight(0),T(ae.menuItems[0])):ae.highlight(-1);const Xe=te.getBoundingClientRect();let Ue=H.getBoundingClientRect();H.style.position="absolute",H.style.left=`${(g()==="rtl"?Xe.left-Ue.width:Xe.right)+window.scrollX}px`,H.style.top=`${Xe.top+window.scrollY}px`,Ue=H.getBoundingClientRect(),g()==="rtl"?Ue.left<0&&(H.style.left=`${Xe.right}px`,Ue=H.getBoundingClientRect(),Ue.right>innerWidth&&(H.style.left=`${innerWidth-Ue.width}px`)):Ue.right>innerWidth&&(H.style.left=`${Xe.left-Ue.width}px`,Ue=H.getBoundingClientRect(),Ue.left<0&&(H.style.left="0")),H.focus({preventScroll:!0}),M=ae},U.push({item_el:te,submenu_popup_el:H,submenu_popup:ae});let Ae,Se;H.addEventListener("pointerenter",()=>{Ae&&(clearTimeout(Ae),Ae=null),Se&&(clearTimeout(Se),Se=null)}),te.addEventListener("pointerenter",()=>{Ae&&(clearTimeout(Ae),Ae=null),Se&&(clearTimeout(Se),Se=null),Ae=setTimeout(()=>{le(!1)},501)}),te.addEventListener("pointerleave",()=>{Ae&&(clearTimeout(Ae),Ae=null)}),w.addEventListener("pointerenter",ze=>{ze.target.closest(".menu-item")!==te&&(Se||H.style.display!=="none"&&(Se=setTimeout(()=>{window.debugKeepMenusOpen||_e()},500)))}),w.addEventListener("pointerleave",()=>{Se&&(clearTimeout(Se),Se=null)}),te.addEventListener("pointerdown",()=>{le(!1)})}let I=!1;const O=()=>{I||(I=!0,setTimeout(()=>{I=!1},10),oe.checkbox?(oe.checkbox.toggle&&oe.checkbox.toggle(),w.dispatchEvent(new CustomEvent("update",{}))):oe.action&&(u(),_(),oe.action()))};te.addEventListener("pointerup",ae=>{ae.pointerType==="mouse"&&ae.button!==0||ae.pointerType!=="touch"&&te.click()}),te.addEventListener("click",ae=>{oe.submenu?le(!0):O()})}};B.length===0&&(B=[{label:"(Empty)",enabled:!1}]);let Y=0;for(const J of B)if(typeof J=="object"&&"radioItems"in J){const oe=n("tbody",{role:"group"});J.ariaLabel&&oe.setAttribute("aria-label",J.ariaLabel);for(const pe of J.radioItems)pe.checkbox={type:"radio",check:()=>pe.value===J.getValue(),toggle:()=>{J.setValue(pe.value)}},j(oe,pe,Y++);D.appendChild(oe)}else j(D,J,Y++)}const S=(B,G)=>{var J;const w=n("div",{class:"menu-button","aria-expanded":"false","aria-haspopup":"true",role:"menuitem"});f.appendChild(w);const D=new P(G),U=D.element;(J=document.body)==null||J.appendChild(U),L.set(w,D),C.set(U,w),w.id=`menu-button-${B}-${t()}`,U.dataset.semanticParent=w.id,w.setAttribute("aria-controls",U.id),U.setAttribute("aria-labelledby",w.id),f.setAttribute("aria-owns",`${f.getAttribute("aria-owns")||""} ${U.id}`);const q=()=>{const oe=w.getBoundingClientRect();let pe=U.getBoundingClientRect();U.style.position="absolute",U.style.left=`${(g()==="rtl"?oe.right-pe.width:oe.left)+window.scrollX}px`,U.style.top=`${oe.bottom+window.scrollY}px`;const me=U.getBoundingClientRect();Math.floor(me.right)>innerWidth&&(U.style.left=`${innerWidth-me.width}px`),Math.ceil(me.left)<0&&(U.style.left="0px")};window.addEventListener("resize",q),U.addEventListener("update",q);const j=B.replace("&","").replace(/ /g,"-").toLowerCase();w.classList.add(`${j}-menu-button`),U.style.display="none",w.innerHTML=`<span>${l.toHTML(B)}</span>`,w.tabIndex=-1,w.setAttribute("aria-haspopup","true"),w.setAttribute("aria-controls",U.id),w.addEventListener("focus",()=>{y(B)}),w.addEventListener("pointerdown",oe=>{w.classList.contains("active")?(w.dispatchEvent(new CustomEvent("release",{})),_(),oe.preventDefault()):Y(oe.type)}),w.addEventListener("pointermove",oe=>{y(B),oe.pointerType!=="touch"&&x&&Y(oe.type)});function Y(oe="other"){Object.keys(m).indexOf(B)===A&&w.getAttribute("aria-expanded")==="true"||(u(),w.classList.add("active"),w.setAttribute("aria-expanded","true"),U.style.display="",U.style.zIndex=`${d()}`,U.setAttribute("dir",g()),window.inheritTheme&&window.inheritTheme(U,f),U.parentElement||document.body.appendChild(U),y(B),U.dispatchEvent(new CustomEvent("update",{})),x=!0,U.focus({preventScroll:!0}),M=D,oe==="keydown"?(D.highlight(0),T(D.menuItems[0])):T())}w.addEventListener("release",()=>{x=!1,w.classList.remove("active"),window.debugKeepMenusOpen||(D.close(!0),w.setAttribute("aria-expanded","false")),f.dispatchEvent(new CustomEvent("default-info",{}))}),b.push({menu_button_el:w,menu_popup_el:U,menus_key:B,access_key:l.get(B),open_top_level_menu:Y})};for(const B in m)S(B,m[B]);window.addEventListener("keydown",B=>{(!document.activeElement||!document.activeElement.closest||!document.activeElement.closest(".menus, .menu-popup"))&&B.key==="Escape"&&M&&(u(),B.preventDefault())}),window.addEventListener("blur",B=>{B.isTrusted&&u()});function F(B){var G,w,D,U;((w=(G=B.target)==null?void 0:G.closest)==null?void 0:w.call(G,".menus"))===f||(U=(D=B.target)==null?void 0:D.closest)!=null&&U.call(D,".menu-popup")||(u(),y(-1))}window.addEventListener("pointerdown",F),window.addEventListener("pointerup",F),window.addEventListener("focusout",B=>{var G,w,D,U;((w=(G=B.relatedTarget)==null?void 0:G.closest)==null?void 0:w.call(G,".menus"))===f||(U=(D=B.relatedTarget)==null?void 0:D.closest)!=null&&U.call(D,".menu-popup")||(u(),y(b.findIndex(({menu_button_el:q})=>q.matches(":hover"))))});let K=[];function Q(...B){for(const G of K)G.removeEventListener("keydown",Z);K=B;for(const G of K)G.addEventListener("keydown",Z)}function Z(B){if((B.ctrlKey||B.metaKey)&&B.key!=="Control"&&B.key!=="Meta"){u();return}if(!B.defaultPrevented&&B.altKey&&!B.shiftKey&&!B.ctrlKey&&!B.metaKey){const G=b.find(w=>{var D;return((D=w.access_key)==null?void 0:D.toLowerCase())===B.key.toLowerCase()});G&&(B.preventDefault(),G.open_top_level_menu("keydown"))}}Q(window),this.element=f,this.closeMenus=u,this.setKeyboardScope=Q}e.MenuBar=h,e.AccessKeys=l,e.MENU_DIVIDER=a})(typeof module<"u"?module.exports:window);(function(){function e(){var n=this;this.versionnumber="1.2.5",this.imageToSVG=function(o,t,l){l=n.checkoptions(l),n.loadImage(o,function(a){t(n.imagedataToSVG(n.getImgdata(a),l))},l)},this.imagedataToSVG=function(o,t){t=n.checkoptions(t);var l=n.imagedataToTracedata(o,t);return n.getsvgstring(l,t)},this.imageToTracedata=function(o,t,l){l=n.checkoptions(l),n.loadImage(o,function(a){t(n.imagedataToTracedata(n.getImgdata(a),l))},l)},this.imagedataToTracedata=function(o,t){t=n.checkoptions(t);var l=n.colorquantization(o,t);if(t.layering===0)for(var a={layers:[],palette:l.palette,width:l.array[0].length-2,height:l.array.length-2},i=0;i<l.palette.length;i++){var s=n.batchtracepaths(n.internodes(n.pathscan(n.layeringstep(l,i),t.pathomit),t),t.ltres,t.qtres);a.layers.push(s)}else{var c=n.layering(l);t.layercontainerid&&n.drawLayers(c,n.specpalette,t.scale,t.layercontainerid);var r=n.batchpathscan(c,t.pathomit),d=n.batchinternodes(r,t),a={layers:n.batchtracelayers(d,t.ltres,t.qtres),palette:l.palette,width:o.width,height:o.height}}return a},this.optionpresets={default:{corsenabled:!1,ltres:1,qtres:1,pathomit:8,rightangleenhance:!0,colorsampling:2,numberofcolors:16,mincolorratio:0,colorquantcycles:3,layering:0,strokewidth:1,linefilter:!1,scale:1,roundcoords:1,viewbox:!1,desc:!1,lcpr:0,qcpr:0,blurradius:0,blurdelta:20},posterized1:{colorsampling:0,numberofcolors:2},posterized2:{numberofcolors:4,blurradius:5},curvy:{ltres:.01,linefilter:!0,rightangleenhance:!1},sharp:{qtres:.01,linefilter:!1},detailed:{pathomit:0,roundcoords:2,ltres:.5,qtres:.5,numberofcolors:64},smoothed:{blurradius:5,blurdelta:64},grayscale:{colorsampling:0,colorquantcycles:1,numberofcolors:7},fixedpalette:{colorsampling:0,colorquantcycles:1,numberofcolors:27},randomsampling1:{colorsampling:1,numberofcolors:8},randomsampling2:{colorsampling:1,numberofcolors:64},artistic1:{colorsampling:0,colorquantcycles:1,pathomit:0,blurradius:5,blurdelta:64,ltres:.01,linefilter:!0,numberofcolors:16,strokewidth:2},artistic2:{qtres:.01,colorsampling:0,colorquantcycles:1,numberofcolors:4,strokewidth:0},artistic3:{qtres:10,ltres:10,numberofcolors:8},artistic4:{qtres:10,ltres:10,numberofcolors:64,blurradius:5,blurdelta:256,strokewidth:2},posterized3:{ltres:1,qtres:1,pathomit:20,rightangleenhance:!0,colorsampling:0,numberofcolors:3,mincolorratio:0,colorquantcycles:3,blurradius:3,blurdelta:20,strokewidth:0,linefilter:!1,roundcoords:1,pal:[{r:0,g:0,b:100,a:255},{r:255,g:255,b:255,a:255}]}},this.checkoptions=function(o){o=o||{},typeof o=="string"&&(o=o.toLowerCase(),n.optionpresets[o]?o=n.optionpresets[o]:o={});for(var t=Object.keys(n.optionpresets.default),l=0;l<t.length;l++)o.hasOwnProperty(t[l])||(o[t[l]]=n.optionpresets.default[t[l]]);return o},this.colorquantization=function(o,t){var l=[],a=0,i,s,c,r=[],d=o.width*o.height,h,m,f,g,x;if(o.data.length<d*4){for(var b=new Uint8ClampedArray(d*4),A=0;A<d;A++)b[A*4]=o.data[A*3],b[A*4+1]=o.data[A*3+1],b[A*4+2]=o.data[A*3+2],b[A*4+3]=255;o.data=b}for(m=0;m<o.height+2;m++)for(l[m]=[],h=0;h<o.width+2;h++)l[m][h]=-1;for(t.pal?x=t.pal:t.colorsampling===0?x=n.generatepalette(t.numberofcolors):t.colorsampling===1?x=n.samplepalette(t.numberofcolors,o):x=n.samplepalette2(t.numberofcolors,o),t.blurradius>0&&(o=n.blur(o,t.blurradius,t.blurdelta)),g=0;g<t.colorquantcycles;g++){if(g>0)for(f=0;f<x.length;f++)r[f].n>0&&(x[f]={r:Math.floor(r[f].r/r[f].n),g:Math.floor(r[f].g/r[f].n),b:Math.floor(r[f].b/r[f].n),a:Math.floor(r[f].a/r[f].n)}),r[f].n/d<t.mincolorratio&&g<t.colorquantcycles-1&&(x[f]={r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255),a:Math.floor(Math.random()*255)});for(h=0;h<x.length;h++)r[h]={r:0,g:0,b:0,a:0,n:0};for(m=0;m<o.height;m++)for(h=0;h<o.width;h++){for(a=(m*o.width+h)*4,c=0,s=1024,f=0;f<x.length;f++)i=Math.abs(x[f].r-o.data[a])+Math.abs(x[f].g-o.data[a+1])+Math.abs(x[f].b-o.data[a+2])+Math.abs(x[f].a-o.data[a+3]),i<s&&(s=i,c=f);r[c].r+=o.data[a],r[c].g+=o.data[a+1],r[c].b+=o.data[a+2],r[c].a+=o.data[a+3],r[c].n++,l[m+1][h+1]=c}}return{array:l,palette:x}},this.samplepalette=function(o,t){for(var l,a=[],i=0;i<o;i++)l=Math.floor(Math.random()*t.data.length/4)*4,a.push({r:t.data[l],g:t.data[l+1],b:t.data[l+2],a:t.data[l+3]});return a},this.samplepalette2=function(o,t){for(var l,a=[],i=Math.ceil(Math.sqrt(o)),s=Math.ceil(o/i),c=t.width/(i+1),r=t.height/(s+1),d=0;d<s;d++)for(var h=0;h<i&&a.length!==o;h++)l=Math.floor((d+1)*r*t.width+(h+1)*c)*4,a.push({r:t.data[l],g:t.data[l+1],b:t.data[l+2],a:t.data[l+3]});return a},this.generatepalette=function(o){var t=[],l,a,i;if(o<8)for(var s=Math.floor(255/(o-1)),c=0;c<o;c++)t.push({r:c*s,g:c*s,b:c*s,a:255});else{var r=Math.floor(Math.pow(o,.3333333333333333)),d=Math.floor(255/(r-1)),h=o-r*r*r;for(l=0;l<r;l++)for(a=0;a<r;a++)for(i=0;i<r;i++)t.push({r:l*d,g:a*d,b:i*d,a:255});for(l=0;l<h;l++)t.push({r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255),a:Math.floor(Math.random()*255)})}return t},this.layering=function(o){var t=[],l=0,a=o.array.length,i=o.array[0].length,s,c,r,d,h,m,f,g,x,b,A;for(A=0;A<o.palette.length;A++)for(t[A]=[],b=0;b<a;b++)for(t[A][b]=[],x=0;x<i;x++)t[A][b][x]=0;for(b=1;b<a-1;b++)for(x=1;x<i-1;x++)l=o.array[b][x],s=o.array[b-1][x-1]===l?1:0,c=o.array[b-1][x]===l?1:0,r=o.array[b-1][x+1]===l?1:0,d=o.array[b][x-1]===l?1:0,h=o.array[b][x+1]===l?1:0,m=o.array[b+1][x-1]===l?1:0,f=o.array[b+1][x]===l?1:0,g=o.array[b+1][x+1]===l?1:0,t[l][b+1][x+1]=1+h*2+g*4+f*8,d||(t[l][b+1][x]=2+f*4+m*8),c||(t[l][b][x+1]=0+r*2+h*4+8),s||(t[l][b][x]=0+c*2+4+d*8);return t},this.layeringstep=function(o,t){var l=[],a=o.array.length,i=o.array[0].length,s,c;for(c=0;c<a;c++)for(l[c]=[],s=0;s<i;s++)l[c][s]=0;for(c=1;c<a;c++)for(s=1;s<i;s++)l[c][s]=(o.array[c-1][s-1]===t?1:0)+(o.array[c-1][s]===t?2:0)+(o.array[c][s-1]===t?8:0)+(o.array[c][s]===t?4:0);return l},this.pathscan_combined_lookup=[[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[13,3,0,1],[13,2,-1,0],[7,1,0,-1],[7,0,1,0]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[11,1,0,-1],[14,0,1,0],[14,3,0,1],[11,2,-1,0]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]],this.pathscan=function(o,t){for(var l=[],a=0,i=0,s=0,c=0,r=o[0].length,d=o.length,h=0,m=!0,f=!1,g,x=0;x<d;x++)for(var b=0;b<r;b++)if(o[x][b]==4||o[x][b]==11)for(s=b,c=x,l[a]={},l[a].points=[],l[a].boundingbox=[s,c,s,c],l[a].holechildren=[],m=!1,i=0,f=o[x][b]==11,h=1;!m;){if(l[a].points[i]={},l[a].points[i].x=s-1,l[a].points[i].y=c-1,l[a].points[i].t=o[c][s],s-1<l[a].boundingbox[0]&&(l[a].boundingbox[0]=s-1),s-1>l[a].boundingbox[2]&&(l[a].boundingbox[2]=s-1),c-1<l[a].boundingbox[1]&&(l[a].boundingbox[1]=c-1),c-1>l[a].boundingbox[3]&&(l[a].boundingbox[3]=c-1),g=n.pathscan_combined_lookup[o[c][s]][h],o[c][s]=g[0],h=g[1],s+=g[2],c+=g[3],s-1===l[a].points[0].x&&c-1===l[a].points[0].y)if(m=!0,l[a].points.length<t)l.pop();else{if(l[a].isholepath=!!f,f){for(var A=0,M=[-1,-1,r+1,d+1],L=0;L<a;L++)!l[L].isholepath&&n.boundingboxincludes(l[L].boundingbox,l[a].boundingbox)&&n.boundingboxincludes(M,l[L].boundingbox)&&(A=L,M=l[L].boundingbox);l[A].holechildren.push(a)}a++}i++}return l},this.boundingboxincludes=function(o,t){return o[0]<t[0]&&o[1]<t[1]&&o[2]>t[2]&&o[3]>t[3]},this.batchpathscan=function(o,t){var l=[];for(var a in o)o.hasOwnProperty(a)&&(l[a]=n.pathscan(o[a],t));return l},this.internodes=function(o,t){var l=[],a=0,i=0,s=0,c=0,r=0,d,h;for(d=0;d<o.length;d++)for(l[d]={},l[d].points=[],l[d].boundingbox=o[d].boundingbox,l[d].holechildren=o[d].holechildren,l[d].isholepath=o[d].isholepath,a=o[d].points.length,h=0;h<a;h++)i=(h+1)%a,s=(h+2)%a,c=(h-1+a)%a,r=(h-2+a)%a,t.rightangleenhance&&n.testrightangle(o[d],r,c,h,i,s)&&(l[d].points.length>0&&(l[d].points[l[d].points.length-1].linesegment=n.getdirection(l[d].points[l[d].points.length-1].x,l[d].points[l[d].points.length-1].y,o[d].points[h].x,o[d].points[h].y)),l[d].points.push({x:o[d].points[h].x,y:o[d].points[h].y,linesegment:n.getdirection(o[d].points[h].x,o[d].points[h].y,(o[d].points[h].x+o[d].points[i].x)/2,(o[d].points[h].y+o[d].points[i].y)/2)})),l[d].points.push({x:(o[d].points[h].x+o[d].points[i].x)/2,y:(o[d].points[h].y+o[d].points[i].y)/2,linesegment:n.getdirection((o[d].points[h].x+o[d].points[i].x)/2,(o[d].points[h].y+o[d].points[i].y)/2,(o[d].points[i].x+o[d].points[s].x)/2,(o[d].points[i].y+o[d].points[s].y)/2)});return l},this.testrightangle=function(o,t,l,a,i,s){return o.points[a].x===o.points[t].x&&o.points[a].x===o.points[l].x&&o.points[a].y===o.points[i].y&&o.points[a].y===o.points[s].y||o.points[a].y===o.points[t].y&&o.points[a].y===o.points[l].y&&o.points[a].x===o.points[i].x&&o.points[a].x===o.points[s].x},this.getdirection=function(o,t,l,a){var i=8;return o<l?t<a?i=1:t>a?i=7:i=0:o>l?t<a?i=3:t>a?i=5:i=4:t<a?i=2:t>a?i=6:i=8,i},this.batchinternodes=function(o,t){var l=[];for(var a in o)o.hasOwnProperty(a)&&(l[a]=n.internodes(o[a],t));return l},this.tracepath=function(o,t,l){var a=0,i,s,c,r={};for(r.segments=[],r.boundingbox=o.boundingbox,r.holechildren=o.holechildren,r.isholepath=o.isholepath;a<o.points.length;){for(i=o.points[a].linesegment,s=-1,c=a+1;(o.points[c].linesegment===i||o.points[c].linesegment===s||s===-1)&&c<o.points.length-1;)o.points[c].linesegment!==i&&s===-1&&(s=o.points[c].linesegment),c++;c===o.points.length-1&&(c=0),r.segments=r.segments.concat(n.fitseq(o,t,l,a,c)),c>0?a=c:a=o.points.length}return r},this.fitseq=function(o,t,l,a,i){if(i>o.points.length||i<0)return[];var s=a,c=0,r=!0,d,h,m,f=i-a;f<0&&(f+=o.points.length);for(var g=(o.points[i].x-o.points[a].x)/f,x=(o.points[i].y-o.points[a].y)/f,b=(a+1)%o.points.length,A;b!=i;)A=b-a,A<0&&(A+=o.points.length),d=o.points[a].x+g*A,h=o.points[a].y+x*A,m=(o.points[b].x-d)*(o.points[b].x-d)+(o.points[b].y-h)*(o.points[b].y-h),m>t&&(r=!1),m>c&&(s=b,c=m),b=(b+1)%o.points.length;if(r)return[{type:"L",x1:o.points[a].x,y1:o.points[a].y,x2:o.points[i].x,y2:o.points[i].y}];var M=s;r=!0,c=0;var L=(M-a)/f,C=(1-L)*(1-L),u=2*(1-L)*L,_=L*L,y=(C*o.points[a].x+_*o.points[i].x-o.points[M].x)/-u,v=(C*o.points[a].y+_*o.points[i].y-o.points[M].y)/-u;for(b=a+1;b!=i;)L=(b-a)/f,C=(1-L)*(1-L),u=2*(1-L)*L,_=L*L,d=C*o.points[a].x+u*y+_*o.points[i].x,h=C*o.points[a].y+u*v+_*o.points[i].y,m=(o.points[b].x-d)*(o.points[b].x-d)+(o.points[b].y-h)*(o.points[b].y-h),m>l&&(r=!1),m>c&&(s=b,c=m),b=(b+1)%o.points.length;if(r)return[{type:"Q",x1:o.points[a].x,y1:o.points[a].y,x2:y,y2:v,x3:o.points[i].x,y3:o.points[i].y}];var T=M;return n.fitseq(o,t,l,a,T).concat(n.fitseq(o,t,l,T,i))},this.batchtracepaths=function(o,t,l){var a=[];for(var i in o)o.hasOwnProperty(i)&&a.push(n.tracepath(o[i],t,l));return a},this.batchtracelayers=function(o,t,l){var a=[];for(var i in o)o.hasOwnProperty(i)&&(a[i]=n.batchtracepaths(o[i],t,l));return a},this.roundtodec=function(o,t){return+o.toFixed(t)},this.svgpathstring=function(o,t,l,a){var i=o.layers[t],s=i[l],c="",r;if(a.linefilter&&s.segments.length<3)return c;if(c="<path "+(a.desc?'desc="l '+t+" p "+l+'" ':"")+n.tosvgcolorstr(o.palette[t],a)+'d="',a.roundcoords===-1){for(c+="M "+s.segments[0].x1*a.scale+" "+s.segments[0].y1*a.scale+" ",r=0;r<s.segments.length;r++)c+=s.segments[r].type+" "+s.segments[r].x2*a.scale+" "+s.segments[r].y2*a.scale+" ",s.segments[r].hasOwnProperty("x3")&&(c+=s.segments[r].x3*a.scale+" "+s.segments[r].y3*a.scale+" ");c+="Z "}else{for(c+="M "+n.roundtodec(s.segments[0].x1*a.scale,a.roundcoords)+" "+n.roundtodec(s.segments[0].y1*a.scale,a.roundcoords)+" ",r=0;r<s.segments.length;r++)c+=s.segments[r].type+" "+n.roundtodec(s.segments[r].x2*a.scale,a.roundcoords)+" "+n.roundtodec(s.segments[r].y2*a.scale,a.roundcoords)+" ",s.segments[r].hasOwnProperty("x3")&&(c+=n.roundtodec(s.segments[r].x3*a.scale,a.roundcoords)+" "+n.roundtodec(s.segments[r].y3*a.scale,a.roundcoords)+" ");c+="Z "}for(var d=0;d<s.holechildren.length;d++){var h=i[s.holechildren[d]];if(a.roundcoords===-1)for(h.segments[h.segments.length-1].hasOwnProperty("x3")?c+="M "+h.segments[h.segments.length-1].x3*a.scale+" "+h.segments[h.segments.length-1].y3*a.scale+" ":c+="M "+h.segments[h.segments.length-1].x2*a.scale+" "+h.segments[h.segments.length-1].y2*a.scale+" ",r=h.segments.length-1;r>=0;r--)c+=h.segments[r].type+" ",h.segments[r].hasOwnProperty("x3")&&(c+=h.segments[r].x2*a.scale+" "+h.segments[r].y2*a.scale+" "),c+=h.segments[r].x1*a.scale+" "+h.segments[r].y1*a.scale+" ";else for(h.segments[h.segments.length-1].hasOwnProperty("x3")?c+="M "+n.roundtodec(h.segments[h.segments.length-1].x3*a.scale)+" "+n.roundtodec(h.segments[h.segments.length-1].y3*a.scale)+" ":c+="M "+n.roundtodec(h.segments[h.segments.length-1].x2*a.scale)+" "+n.roundtodec(h.segments[h.segments.length-1].y2*a.scale)+" ",r=h.segments.length-1;r>=0;r--)c+=h.segments[r].type+" ",h.segments[r].hasOwnProperty("x3")&&(c+=n.roundtodec(h.segments[r].x2*a.scale)+" "+n.roundtodec(h.segments[r].y2*a.scale)+" "),c+=n.roundtodec(h.segments[r].x1*a.scale)+" "+n.roundtodec(h.segments[r].y1*a.scale)+" ";c+="Z "}if(c+='" />',a.lcpr||a.qcpr){for(r=0;r<s.segments.length;r++)s.segments[r].hasOwnProperty("x3")&&a.qcpr&&(c+='<circle cx="'+s.segments[r].x2*a.scale+'" cy="'+s.segments[r].y2*a.scale+'" r="'+a.qcpr+'" fill="cyan" stroke-width="'+a.qcpr*.2+'" stroke="black" />',c+='<circle cx="'+s.segments[r].x3*a.scale+'" cy="'+s.segments[r].y3*a.scale+'" r="'+a.qcpr+'" fill="white" stroke-width="'+a.qcpr*.2+'" stroke="black" />',c+='<line x1="'+s.segments[r].x1*a.scale+'" y1="'+s.segments[r].y1*a.scale+'" x2="'+s.segments[r].x2*a.scale+'" y2="'+s.segments[r].y2*a.scale+'" stroke-width="'+a.qcpr*.2+'" stroke="cyan" />',c+='<line x1="'+s.segments[r].x2*a.scale+'" y1="'+s.segments[r].y2*a.scale+'" x2="'+s.segments[r].x3*a.scale+'" y2="'+s.segments[r].y3*a.scale+'" stroke-width="'+a.qcpr*.2+'" stroke="cyan" />'),!s.segments[r].hasOwnProperty("x3")&&a.lcpr&&(c+='<circle cx="'+s.segments[r].x2*a.scale+'" cy="'+s.segments[r].y2*a.scale+'" r="'+a.lcpr+'" fill="white" stroke-width="'+a.lcpr*.2+'" stroke="black" />');for(var d=0;d<s.holechildren.length;d++){var h=i[s.holechildren[d]];for(r=0;r<h.segments.length;r++)h.segments[r].hasOwnProperty("x3")&&a.qcpr&&(c+='<circle cx="'+h.segments[r].x2*a.scale+'" cy="'+h.segments[r].y2*a.scale+'" r="'+a.qcpr+'" fill="cyan" stroke-width="'+a.qcpr*.2+'" stroke="black" />',c+='<circle cx="'+h.segments[r].x3*a.scale+'" cy="'+h.segments[r].y3*a.scale+'" r="'+a.qcpr+'" fill="white" stroke-width="'+a.qcpr*.2+'" stroke="black" />',c+='<line x1="'+h.segments[r].x1*a.scale+'" y1="'+h.segments[r].y1*a.scale+'" x2="'+h.segments[r].x2*a.scale+'" y2="'+h.segments[r].y2*a.scale+'" stroke-width="'+a.qcpr*.2+'" stroke="cyan" />',c+='<line x1="'+h.segments[r].x2*a.scale+'" y1="'+h.segments[r].y2*a.scale+'" x2="'+h.segments[r].x3*a.scale+'" y2="'+h.segments[r].y3*a.scale+'" stroke-width="'+a.qcpr*.2+'" stroke="cyan" />'),!h.segments[r].hasOwnProperty("x3")&&a.lcpr&&(c+='<circle cx="'+h.segments[r].x2*a.scale+'" cy="'+h.segments[r].y2*a.scale+'" r="'+a.lcpr+'" fill="white" stroke-width="'+a.lcpr*.2+'" stroke="black" />')}}return c},this.getsvgstring=function(o,t){t=n.checkoptions(t);for(var l=o.width*t.scale,a=o.height*t.scale,i="<svg "+(t.viewbox?'viewBox="0 0 '+l+" "+a+'" ':'width="'+l+'" height="'+a+'" ')+'version="1.1" xmlns="http://www.w3.org/2000/svg" desc="Created with imagetracer.js version '+n.versionnumber+'" >',s=0;s<o.layers.length;s++)for(var c=0;c<o.layers[s].length;c++)o.layers[s][c].isholepath||(i+=n.svgpathstring(o,s,c,t));return i+="</svg>",i},this.compareNumbers=function(o,t){return o-t},this.torgbastr=function(o){return"rgba("+o.r+","+o.g+","+o.b+","+o.a+")"},this.tosvgcolorstr=function(o,t){return'fill="rgb('+o.r+","+o.g+","+o.b+')" stroke="rgb('+o.r+","+o.g+","+o.b+')" stroke-width="'+t.strokewidth+'" opacity="'+o.a/255+'" '},this.appendSVGString=function(o,t){var l;t?(l=document.getElementById(t),l||(l=document.createElement("div"),l.id=t,document.body.appendChild(l))):(l=document.createElement("div"),document.body.appendChild(l)),l.innerHTML+=o},this.gks=[[.27901,.44198,.27901],[.135336,.228569,.272192,.228569,.135336],[.086776,.136394,.178908,.195843,.178908,.136394,.086776],[.063327,.093095,.122589,.144599,.152781,.144599,.122589,.093095,.063327],[.049692,.069304,.089767,.107988,.120651,.125194,.120651,.107988,.089767,.069304,.049692]],this.blur=function(o,t,l){var a,i,s,c,r,d,h,m,f,g,x={width:o.width,height:o.height,data:[]};if(t=Math.floor(t),t<1)return o;t>5&&(t=5),l=Math.abs(l),l>1024&&(l=1024);var b=n.gks[t-1];for(i=0;i<o.height;i++)for(a=0;a<o.width;a++){for(d=0,h=0,m=0,f=0,g=0,s=-t;s<t+1;s++)a+s>0&&a+s<o.width&&(r=(i*o.width+a+s)*4,d+=o.data[r]*b[s+t],h+=o.data[r+1]*b[s+t],m+=o.data[r+2]*b[s+t],f+=o.data[r+3]*b[s+t],g+=b[s+t]);r=(i*o.width+a)*4,x.data[r]=Math.floor(d/g),x.data[r+1]=Math.floor(h/g),x.data[r+2]=Math.floor(m/g),x.data[r+3]=Math.floor(f/g)}var A=new Uint8ClampedArray(x.data);for(i=0;i<o.height;i++)for(a=0;a<o.width;a++){for(d=0,h=0,m=0,f=0,g=0,s=-t;s<t+1;s++)i+s>0&&i+s<o.height&&(r=((i+s)*o.width+a)*4,d+=A[r]*b[s+t],h+=A[r+1]*b[s+t],m+=A[r+2]*b[s+t],f+=A[r+3]*b[s+t],g+=b[s+t]);r=(i*o.width+a)*4,x.data[r]=Math.floor(d/g),x.data[r+1]=Math.floor(h/g),x.data[r+2]=Math.floor(m/g),x.data[r+3]=Math.floor(f/g)}for(i=0;i<o.height;i++)for(a=0;a<o.width;a++)r=(i*o.width+a)*4,c=Math.abs(x.data[r]-o.data[r])+Math.abs(x.data[r+1]-o.data[r+1])+Math.abs(x.data[r+2]-o.data[r+2])+Math.abs(x.data[r+3]-o.data[r+3]),c>l&&(x.data[r]=o.data[r],x.data[r+1]=o.data[r+1],x.data[r+2]=o.data[r+2],x.data[r+3]=o.data[r+3]);return x},this.loadImage=function(o,t,l){var a=new Image;l&&l.corsenabled&&(a.crossOrigin="Anonymous"),a.onload=function(){var i=document.createElement("canvas");i.width=a.width,i.height=a.height;var s=i.getContext("2d");s.drawImage(a,0,0),t(i)},a.src=o},this.getImgdata=function(o){var t=o.getContext("2d");return t.getImageData(0,0,o.width,o.height)},this.specpalette=[{r:0,g:0,b:0,a:255},{r:128,g:128,b:128,a:255},{r:0,g:0,b:128,a:255},{r:64,g:64,b:128,a:255},{r:192,g:192,b:192,a:255},{r:255,g:255,b:255,a:255},{r:128,g:128,b:192,a:255},{r:0,g:0,b:192,a:255},{r:128,g:0,b:0,a:255},{r:128,g:64,b:64,a:255},{r:128,g:0,b:128,a:255},{r:168,g:168,b:168,a:255},{r:192,g:128,b:128,a:255},{r:192,g:0,b:0,a:255},{r:255,g:255,b:255,a:255},{r:0,g:128,b:0,a:255}],this.drawLayers=function(o,t,l,a){l=l||1;var i,s,c,r,d,h;a?(h=document.getElementById(a),h||(h=document.createElement("div"),h.id=a,document.body.appendChild(h))):(h=document.createElement("div"),document.body.appendChild(h));for(d in o)if(o.hasOwnProperty(d)){i=o[d][0].length,s=o[d].length;var m=document.createElement("canvas");m.width=i*l,m.height=s*l;var f=m.getContext("2d");for(r=0;r<s;r++)for(c=0;c<i;c++)f.fillStyle=n.torgbastr(t[o[d][r][c]%t.length]),f.fillRect(c*l,r*l,l,l);h.appendChild(m)}}}typeof define=="function"&&define.amd?define(function(){return new e}):typeof module<"u"?module.exports=new e:typeof self<"u"?self.ImageTracer=new e:window.ImageTracer=new e})();/*! jQuery UI - v1.14.1 - 2024-11-08
* https://jqueryui.com
* Includes: widget.js, keycode.js, widgets/mouse.js, widgets/slider.js
* Copyright OpenJS Foundation and other contributors; Licensed MIT */(e=>{typeof define=="function"&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){e.ui=e.ui||{},e.ui.version="1.14.1";var n,o=0,t=Array.prototype.hasOwnProperty,l=Array.prototype.slice,a=(e.cleanData=(n=e.cleanData,function(i){for(var s,c,r=0;(c=i[r])!=null;r++)(s=e._data(c,"events"))&&s.remove&&e(c).triggerHandler("remove");n(i)}),e.widget=function(i,s,c){var r,d,h,m,f={},g=i.split(".")[0];return(i=i.split(".")[1])==="__proto__"||i==="constructor"?e.error("Invalid widget name: "+i):(m=g+"-"+i,c||(c=s,s=e.Widget),Array.isArray(c)&&(c=e.extend.apply(null,[{}].concat(c))),e.expr.pseudos[m.toLowerCase()]=function(x){return!!e.data(x,m)},e[g]=e[g]||{},r=e[g][i],d=e[g][i]=function(x,b){if(!this||!this._createWidget)return new d(x,b);arguments.length&&this._createWidget(x,b)},e.extend(d,r,{version:c.version,_proto:e.extend({},c),_childConstructors:[]}),(h=new s).options=e.widget.extend({},h.options),e.each(c,function(x,b){function A(){return s.prototype[x].apply(this,arguments)}function M(L){return s.prototype[x].apply(this,L)}f[x]=typeof b!="function"?b:function(){var L,C=this._super,u=this._superApply;return this._super=A,this._superApply=M,L=b.apply(this,arguments),this._super=C,this._superApply=u,L}}),d.prototype=e.widget.extend(h,{widgetEventPrefix:r&&h.widgetEventPrefix||i},f,{constructor:d,namespace:g,widgetName:i,widgetFullName:m}),r?(e.each(r._childConstructors,function(x,b){var A=b.prototype;e.widget(A.namespace+"."+A.widgetName,d,b._proto)}),delete r._childConstructors):s._childConstructors.push(d),e.widget.bridge(i,d),d)},e.widget.extend=function(i){for(var s,c,r=l.call(arguments,1),d=0,h=r.length;d<h;d++)for(s in r[d])c=r[d][s],t.call(r[d],s)&&c!==void 0&&(e.isPlainObject(c)?i[s]=e.isPlainObject(i[s])?e.widget.extend({},i[s],c):e.widget.extend({},c):i[s]=c);return i},e.widget.bridge=function(i,s){var c=s.prototype.widgetFullName||i;e.fn[i]=function(r){var d=typeof r=="string",h=l.call(arguments,1),m=this;return d?this.length||r!=="instance"?this.each(function(){var f,g=e.data(this,c);return r==="instance"?(m=g,!1):g?typeof g[r]!="function"||r.charAt(0)==="_"?e.error("no such method '"+r+"' for "+i+" widget instance"):(f=g[r].apply(g,h))!==g&&f!==void 0?(m=f&&f.jquery?m.pushStack(f.get()):f,!1):void 0:e.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+r+"'")}):m=void 0:(h.length&&(r=e.widget.extend.apply(null,[r].concat(h))),this.each(function(){var f=e.data(this,c);f?(f.option(r||{}),f._init&&f._init()):e.data(this,c,new s(r,this))})),m}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(i,s){s=e(s||this.defaultElement||this)[0],this.element=e(s),this.uuid=o++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),this.classesElementLookup={},s!==this&&(e.data(s,this.widgetFullName,this),this._on(!0,this.element,{remove:function(c){c.target===s&&this.destroy()}}),this.document=e(s.style?s.ownerDocument:s.document||s),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),i),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){var i=this;this._destroy(),e.each(this.classesElementLookup,function(s,c){i._removeClass(c,s)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:e.noop,widget:function(){return this.element},option:function(i,s){var c,r,d,h=i;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof i=="string")if(h={},i=(c=i.split(".")).shift(),c.length){for(r=h[i]=e.widget.extend({},this.options[i]),d=0;d<c.length-1;d++)r[c[d]]=r[c[d]]||{},r=r[c[d]];if(i=c.pop(),arguments.length===1)return r[i]===void 0?null:r[i];r[i]=s}else{if(arguments.length===1)return this.options[i]===void 0?null:this.options[i];h[i]=s}return this._setOptions(h),this},_setOptions:function(i){for(var s in i)this._setOption(s,i[s]);return this},_setOption:function(i,s){return i==="classes"&&this._setOptionClasses(s),this.options[i]=s,i==="disabled"&&this._setOptionDisabled(s),this},_setOptionClasses:function(i){var s,c,r;for(s in i)r=this.classesElementLookup[s],i[s]!==this.options.classes[s]&&r&&r.length&&(c=e(r.get()),this._removeClass(r,s),c.addClass(this._classes({element:c,keys:s,classes:i,add:!0})))},_setOptionDisabled:function(i){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!i),i&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(i){var s=[],c=this;function r(d,h){for(var m,f=0;f<d.length;f++)m=c.classesElementLookup[d[f]]||e(),m=i.add?((()=>{var g=[];i.element.each(function(x,b){e.map(c.classesElementLookup,function(A){return A}).some(function(A){return A.is(b)})||g.push(b)}),c._on(e(g),{remove:"_untrackClassesElement"})})(),e(e.uniqueSort(m.get().concat(i.element.get())))):e(m.not(i.element).get()),c.classesElementLookup[d[f]]=m,s.push(d[f]),h&&i.classes[d[f]]&&s.push(i.classes[d[f]])}return(i=e.extend({element:this.element,classes:this.options.classes||{}},i)).keys&&r(i.keys.match(/\S+/g)||[],!0),i.extra&&r(i.extra.match(/\S+/g)||[]),s.join(" ")},_untrackClassesElement:function(i){var s=this;e.each(s.classesElementLookup,function(c,r){e.inArray(i.target,r)!==-1&&(s.classesElementLookup[c]=e(r.not(i.target).get()))}),this._off(e(i.target))},_removeClass:function(i,s,c){return this._toggleClass(i,s,c,!1)},_addClass:function(i,s,c){return this._toggleClass(i,s,c,!0)},_toggleClass:function(i,h,c,r){var d=typeof i=="string"||i===null,h={extra:d?h:c,keys:d?i:h,element:d?this.element:i,add:r=typeof r=="boolean"?r:c};return h.element.toggleClass(this._classes(h),r),this},_on:function(i,s,c){var r,d=this;typeof i!="boolean"&&(c=s,s=i,i=!1),c?(s=r=e(s),this.bindings=this.bindings.add(s)):(c=s,s=this.element,r=this.widget()),e.each(c,function(x,m){function f(){if(i||d.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled"))return(typeof m=="string"?d[m]:m).apply(d,arguments)}typeof m!="string"&&(f.guid=m.guid=m.guid||f.guid||e.guid++);var x=x.match(/^([\w:-]*)\s*(.*)$/),g=x[1]+d.eventNamespace,x=x[2];x?r.on(g,x,f):s.on(g,f)})},_off:function(i,s){s=(s||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,i.off(s),this.bindings=e(this.bindings.not(i).get()),this.focusable=e(this.focusable.not(i).get()),this.hoverable=e(this.hoverable.not(i).get())},_delay:function(i,s){var c=this;return setTimeout(function(){return(typeof i=="string"?c[i]:i).apply(c,arguments)},s||0)},_hoverable:function(i){this.hoverable=this.hoverable.add(i),this._on(i,{mouseenter:function(s){this._addClass(e(s.currentTarget),null,"ui-state-hover")},mouseleave:function(s){this._removeClass(e(s.currentTarget),null,"ui-state-hover")}})},_focusable:function(i){this.focusable=this.focusable.add(i),this._on(i,{focusin:function(s){this._addClass(e(s.currentTarget),null,"ui-state-focus")},focusout:function(s){this._removeClass(e(s.currentTarget),null,"ui-state-focus")}})},_trigger:function(i,s,c){var r,d,h=this.options[i];if(c=c||{},(s=e.Event(s)).type=(i===this.widgetEventPrefix?i:this.widgetEventPrefix+i).toLowerCase(),s.target=this.element[0],d=s.originalEvent)for(r in d)r in s||(s[r]=d[r]);return this.element.trigger(s,c),!(typeof h=="function"&&h.apply(this.element[0],[s].concat(c))===!1||s.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(i,s){e.Widget.prototype["_"+i]=function(c,r,d){var h,m=(r=typeof r=="string"?{effect:r}:r)?r!==!0&&typeof r!="number"&&r.effect||s:i;typeof(r=r||{})=="number"?r={duration:r}:r===!0&&(r={}),h=!e.isEmptyObject(r),r.complete=d,r.delay&&c.delay(r.delay),h&&e.effects&&e.effects.effect[m]?c[i](r):m!==i&&c[m]?c[m](r.duration,r.easing,d):c.queue(function(f){e(this)[i](),d&&d.call(c[0]),f()})}}),e.widget,e.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},!1);e(document).on("mouseup",function(){a=!1}),e.widget("ui.mouse",{version:"1.14.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var i=this;this.element.on("mousedown."+this.widgetName,function(s){return i._mouseDown(s)}).on("click."+this.widgetName,function(s){if(e.data(s.target,i.widgetName+".preventClickEvent")===!0)return e.removeData(s.target,i.widgetName+".preventClickEvent"),s.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){var s,c,r;if(!a)return this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(i),c=(this._mouseDownEvent=i).which===1,r=typeof(s=this).options.cancel=="string"&&e(i.target).closest(this.options.cancel).length,c&&!r&&this._mouseCapture(i)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){s.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?i.preventDefault():(e.data(i.target,this.widgetName+".preventClickEvent")===!0&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(d){return s._mouseMove(d)},this._mouseUpDelegate=function(d){return s._mouseUp(d)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),a=!0)),!0},_mouseMove:function(i){if(this._mouseMoved&&!i.which){if(i.originalEvent.altKey||i.originalEvent.ctrlKey||i.originalEvent.metaKey||i.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(i)}return(i.which||i.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(i),i.preventDefault()):(this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,i)!==!1,this._mouseStarted?this._mouseDrag(i):this._mouseUp(i)),!this._mouseStarted)},_mouseUp:function(i){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,i.target===this._mouseDownEvent.target&&e.data(i.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(i)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,a=!1,i.preventDefault()},_mouseDistanceMet:function(i){return Math.max(Math.abs(this._mouseDownEvent.pageX-i.pageX),Math.abs(this._mouseDownEvent.pageY-i.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),e.widget("ui.slider",e.ui.mouse,{version:"1.14.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var i,s=this.options,c=this.element.find(".ui-slider-handle"),r=[],d=s.values&&s.values.length||1;for(c.length>d&&(c.slice(d).remove(),c=c.slice(0,d)),i=c.length;i<d;i++)r.push("<span tabindex='0'></span>");this.handles=c.add(e(r.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(h){e(this).data("ui-slider-handle-index",h).attr("tabIndex",0)})},_createRange:function(){var i=this.options;i.range?(i.range===!0&&(i.values?i.values.length&&i.values.length!==2?i.values=[i.values[0],i.values[0]]:Array.isArray(i.values)&&(i.values=i.values.slice(0)):i.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=e("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),i.range!=="min"&&i.range!=="max"||this._addClass(this.range,"ui-slider-range-"+i.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(i){var s,c,r,d,h,m,f=this,g=this.options;return!g.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),h={x:i.pageX,y:i.pageY},s=this._normValueFromMouse(h),c=this._valueMax()-this._valueMin()+1,this.handles.each(function(x){var b=Math.abs(s-f.values(x));(b<c||c===b&&(x===f._lastChangedValue||f.values(x)===g.min))&&(c=b,r=e(this),d=x)}),this._start(i,d)!==!1)&&(this._mouseSliding=!0,this._handleIndex=d,this._addClass(r,null,"ui-state-active"),r.trigger("focus"),h=r.offset(),m=!e(i.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=m?{left:0,top:0}:{left:i.pageX-h.left-r.width()/2,top:i.pageY-h.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(i,d,s),this._animateOff=!0)},_mouseStart:function(){return!0},_mouseDrag:function(i){var s={x:i.pageX,y:i.pageY},s=this._normValueFromMouse(s);return this._slide(i,this._handleIndex,s),!1},_mouseStop:function(i){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(i,this._handleIndex),this._change(i,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(c){var s,c=this.orientation==="horizontal"?(s=this.elementSize.width,c.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(s=this.elementSize.height,c.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),c=c/s;return(c=1<c?1:c)<0&&(c=0),this.orientation==="vertical"&&(c=1-c),s=this._valueMax()-this._valueMin(),c=this._valueMin()+c*s,this._trimAlignValue(c)},_uiHash:function(i,s,c){var r={handle:this.handles[i],handleIndex:i,value:s!==void 0?s:this.value()};return this._hasMultipleValues()&&(r.value=s!==void 0?s:this.values(i),r.values=c||this.values()),r},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(i,s){return this._trigger("start",i,this._uiHash(s))},_slide:function(i,s,c){var r,d=this.value(),h=this.values();this._hasMultipleValues()&&(r=this.values(s?0:1),d=this.values(s),this.options.values.length===2&&this.options.range===!0&&(c=s===0?Math.min(r,c):Math.max(r,c)),h[s]=c),c!==d&&this._trigger("slide",i,this._uiHash(s,c,h))!==!1&&(this._hasMultipleValues()?this.values(s,c):this.value(c))},_stop:function(i,s){this._trigger("stop",i,this._uiHash(s))},_change:function(i,s){this._keySliding||this._mouseSliding||(this._lastChangedValue=s,this._trigger("change",i,this._uiHash(s)))},value:function(i){if(!arguments.length)return this._value();this.options.value=this._trimAlignValue(i),this._refreshValue(),this._change(null,0)},values:function(i,s){var c,r,d;if(1<arguments.length)this.options.values[i]=this._trimAlignValue(s),this._refreshValue(),this._change(null,i);else{if(!arguments.length)return this._values();if(!Array.isArray(i))return this._hasMultipleValues()?this._values(i):this.value();for(c=this.options.values,r=i,d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(r[d]),this._change(null,d);this._refreshValue()}},_setOption:function(i,s){var c,r=0;switch(i==="range"&&this.options.range===!0&&(s==="min"?(this.options.value=this._values(0),this.options.values=null):s==="max"&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),Array.isArray(this.options.values)&&(r=this.options.values.length),this._super(i,s),i){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(s),this.handles.css(s==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),c=r-1;0<=c;c--)this._change(null,c);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(i){this._super(i),this._toggleClass(null,"ui-state-disabled",!!i)},_value:function(){var i=this.options.value;return this._trimAlignValue(i)},_values:function(i){var s,c;if(arguments.length)return i=this.options.values[i],this._trimAlignValue(i);if(this._hasMultipleValues()){for(s=this.options.values.slice(),c=0;c<s.length;c+=1)s[c]=this._trimAlignValue(s[c]);return s}return[]},_trimAlignValue:function(i){var s,c;return i<=this._valueMin()?this._valueMin():i>=this._valueMax()?this._valueMax():(s=0<this.options.step?this.options.step:1,c=i-(i=(i-this._valueMin())%s),2*Math.abs(i)>=s&&(c+=0<i?s:-s),parseFloat(c.toFixed(5)))},_calculateNewMax:function(){var i=this.options.max,s=this._valueMin(),c=this.options.step;(i=Math.round((i-s)/c)*c+s)>this.options.max&&(i-=c),this.max=parseFloat(i.toFixed(this._precision()))},_precision:function(){var i=this._precisionOf(this.options.step);return i=this.options.min!==null?Math.max(i,this._precisionOf(this.options.min)):i},_precisionOf:function(s){var s=s.toString(),c=s.indexOf(".");return c===-1?0:s.length-c-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(i){i==="vertical"&&this.range.css({width:"",left:""}),i==="horizontal"&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var i,s,c,r,d,h=this.options.range,m=this.options,f=this,g=!this._animateOff&&m.animate,x={};this._hasMultipleValues()?this.handles.each(function(b){s=(f.values(b)-f._valueMin())/(f._valueMax()-f._valueMin())*100,x[f.orientation==="horizontal"?"left":"bottom"]=s+"%",e(this).stop(1,1)[g?"animate":"css"](x,m.animate),f.options.range===!0&&(f.orientation==="horizontal"?(b===0&&f.range.stop(1,1)[g?"animate":"css"]({left:s+"%"},m.animate),b===1&&f.range[g?"animate":"css"]({width:s-i+"%"},{queue:!1,duration:m.animate})):(b===0&&f.range.stop(1,1)[g?"animate":"css"]({bottom:s+"%"},m.animate),b===1&&f.range[g?"animate":"css"]({height:s-i+"%"},{queue:!1,duration:m.animate}))),i=s}):(c=this.value(),r=this._valueMin(),d=this._valueMax(),s=d!==r?(c-r)/(d-r)*100:0,x[this.orientation==="horizontal"?"left":"bottom"]=s+"%",this.handle.stop(1,1)[g?"animate":"css"](x,m.animate),h==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[g?"animate":"css"]({width:s+"%"},m.animate),h==="max"&&this.orientation==="horizontal"&&this.range.stop(1,1)[g?"animate":"css"]({width:100-s+"%"},m.animate),h==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[g?"animate":"css"]({height:s+"%"},m.animate),h==="max"&&this.orientation==="vertical"&&this.range.stop(1,1)[g?"animate":"css"]({height:100-s+"%"},m.animate))},_handleEvents:{keydown:function(i){var s,c,r,d=e(i.target).data("ui-slider-handle-index");switch(i.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i.preventDefault(),this._keySliding||(this._keySliding=!0,this._addClass(e(i.target),null,"ui-state-active"),this._start(i,d)!==!1))break;return}switch(r=this.options.step,s=c=this._hasMultipleValues()?this.values(d):this.value(),i.keyCode){case e.ui.keyCode.HOME:c=this._valueMin();break;case e.ui.keyCode.END:c=this._valueMax();break;case e.ui.keyCode.PAGE_UP:c=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:c=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(s===this._valueMax())return;c=this._trimAlignValue(s+r);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s===this._valueMin())return;c=this._trimAlignValue(s-r)}this._slide(i,d,c)},keyup:function(i){var s=e(i.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(i,s),this._change(i,s),this._removeClass(e(i.target),null,"ui-state-active"))}}})});console.log("JS 실행:","app-localization.js");(e=>{let n={};function o(A,...M){function L(u){if(AccessKeys.has(u)){const _=AccessKeys.remove(u);if(n[_]){const y=AccessKeys.get(u);return n[_].toUpperCase().indexOf(y.toUpperCase())>-1?n[_]:AccessKeys.has(n[_])?`${AccessKeys.remove(n[_])} (${y})`:`${n[_]} (${y})`}}return n[u]?n[u]:u}function C(u,_){for(let y=0;y<_.length;y++)u=u.replace(`%${y+1}`,_[y]);return u}return C(L(A),M)}const t="jspaint language",l=Array.from(navigator.languages||[navigator.language||navigator.userLanguage]);try{localStorage[t]&&l.unshift(localStorage[t])}catch{}var a={aa:"ET",ab:"GE",abr:"GH",ace:"ID",ach:"UG",ada:"GH",ady:"RU",ae:"IR",aeb:"TN",af:"ZA",agq:"CM",aho:"IN",ak:"GH",akk:"IQ",aln:"XK",alt:"RU",am:"ET",amo:"NG",aoz:"ID",apd:"TG",ar:"EG",arc:"IR","arc-Nbat":"JO","arc-Palm":"SY",arn:"CL",aro:"BO",arq:"DZ",ary:"MA",arz:"EG",as:"IN",asa:"TZ",ase:"US",ast:"ES",atj:"CA",av:"RU",awa:"IN",ay:"BO",az:"AZ","az-Arab":"IR",ba:"RU",bal:"PK",ban:"ID",bap:"NP",bar:"AT",bas:"CM",bax:"CM",bbc:"ID",bbj:"CM",bci:"CI",be:"BY",bej:"SD",bem:"ZM",bew:"ID",bez:"TZ",bfd:"CM",bfq:"IN",bft:"PK",bfy:"IN",bg:"BG",bgc:"IN",bgn:"PK",bgx:"TR",bhb:"IN",bhi:"IN",bhk:"PH",bho:"IN",bi:"VU",bik:"PH",bin:"NG",bjj:"IN",bjn:"ID",bjt:"SN",bkm:"CM",bku:"PH",blt:"VN",bm:"ML",bmq:"ML",bn:"BD",bo:"CN",bpy:"IN",bqi:"IR",bqv:"CI",br:"FR",bra:"IN",brh:"PK",brx:"IN",bs:"BA",bsq:"LR",bss:"CM",bto:"PH",btv:"PK",bua:"RU",buc:"YT",bug:"ID",bum:"CM",bvb:"GQ",byn:"ER",byv:"CM",bze:"ML",ca:"ES",cch:"NG",ccp:"BD",ce:"RU",ceb:"PH",cgg:"UG",ch:"GU",chk:"FM",chm:"RU",cho:"US",chp:"CA",chr:"US",cja:"KH",cjm:"VN",ckb:"IQ",co:"FR",cop:"EG",cps:"PH",cr:"CA",crh:"UA",crj:"CA",crk:"CA",crl:"CA",crm:"CA",crs:"SC",cs:"CZ",csb:"PL",csw:"CA",ctd:"MM",cu:"RU","cu-Glag":"BG",cv:"RU",cy:"GB",da:"DK",dak:"US",dar:"RU",dav:"KE",dcc:"IN",de:"DE",den:"CA",dgr:"CA",dje:"NE",dnj:"CI",doi:"IN",dsb:"DE",dtm:"ML",dtp:"MY",dty:"NP",dua:"CM",dv:"MV",dyo:"SN",dyu:"BF",dz:"BT",ebu:"KE",ee:"GH",efi:"NG",egl:"IT",egy:"EG",eky:"MM",el:"GR",en:"US","en-Shaw":"GB",es:"ES",esu:"US",et:"EE",ett:"IT",eu:"ES",ewo:"CM",ext:"ES",fa:"IR",fan:"GQ",ff:"SN","ff-Adlm":"GN",ffm:"ML",fi:"FI",fia:"SD",fil:"PH",fit:"SE",fj:"FJ",fo:"FO",fon:"BJ",fr:"FR",frc:"US",frp:"FR",frr:"DE",frs:"DE",fub:"CM",fud:"WF",fuf:"GN",fuq:"NE",fur:"IT",fuv:"NG",fvr:"SD",fy:"NL",ga:"IE",gaa:"GH",gag:"MD",gan:"CN",gay:"ID",gbm:"IN",gbz:"IR",gcr:"GF",gd:"GB",gez:"ET",ggn:"NP",gil:"KI",gjk:"PK",gju:"PK",gl:"ES",glk:"IR",gn:"PY",gom:"IN",gon:"IN",gor:"ID",gos:"NL",got:"UA",grc:"CY","grc-Linb":"GR",grt:"IN",gsw:"CH",gu:"IN",gub:"BR",guc:"CO",gur:"GH",guz:"KE",gv:"IM",gvr:"NP",gwi:"CA",ha:"NG",hak:"CN",haw:"US",haz:"AF",he:"IL",hi:"IN",hif:"FJ",hil:"PH",hlu:"TR",hmd:"CN",hnd:"PK",hne:"IN",hnj:"LA",hnn:"PH",hno:"PK",ho:"PG",hoc:"IN",hoj:"IN",hr:"HR",hsb:"DE",hsn:"CN",ht:"HT",hu:"HU",hy:"AM",hz:"NA",ia:"FR",iba:"MY",ibb:"NG",id:"ID",ife:"TG",ig:"NG",ii:"CN",ik:"US",ikt:"CA",ilo:"PH",in:"ID",inh:"RU",is:"IS",it:"IT",iu:"CA",iw:"IL",izh:"RU",ja:"JP",jam:"JM",jgo:"CM",ji:"UA",jmc:"TZ",jml:"NP",jut:"DK",jv:"ID",jw:"ID",ka:"GE",kaa:"UZ",kab:"DZ",kac:"MM",kaj:"NG",kam:"KE",kao:"ML",kbd:"RU",kby:"NE",kcg:"NG",kck:"ZW",kde:"TZ",kdh:"TG",kdt:"TH",kea:"CV",ken:"CM",kfo:"CI",kfr:"IN",kfy:"IN",kg:"CD",kge:"ID",kgp:"BR",kha:"IN",khb:"CN",khn:"IN",khq:"ML",kht:"IN",khw:"PK",ki:"KE",kiu:"TR",kj:"NA",kjg:"LA",kk:"KZ","kk-Arab":"CN",kkj:"CM",kl:"GL",kln:"KE",km:"KH",kmb:"AO",kn:"IN",knf:"SN",ko:"KR",koi:"RU",kok:"IN",kos:"FM",kpe:"LR",krc:"RU",kri:"SL",krj:"PH",krl:"RU",kru:"IN",ks:"IN",ksb:"TZ",ksf:"CM",ksh:"DE",ku:"TR","ku-Arab":"IQ",kum:"RU",kv:"RU",kvr:"ID",kvx:"PK",kw:"GB",kxm:"TH",kxp:"PK",ky:"KG","ky-Arab":"CN","ky-Latn":"TR",la:"VA",lab:"GR",lad:"IL",lag:"TZ",lah:"PK",laj:"UG",lb:"LU",lbe:"RU",lbw:"ID",lcp:"CN",lep:"IN",lez:"RU",lg:"UG",li:"NL",lif:"NP","lif-Limb":"IN",lij:"IT",lis:"CN",ljp:"ID",lki:"IR",lkt:"US",lmn:"IN",lmo:"IT",ln:"CD",lo:"LA",lol:"CD",loz:"ZM",lrc:"IR",lt:"LT",ltg:"LV",lu:"CD",lua:"CD",luo:"KE",luy:"KE",luz:"IR",lv:"LV",lwl:"TH",lzh:"CN",lzz:"TR",mad:"ID",maf:"CM",mag:"IN",mai:"IN",mak:"ID",man:"GM","man-Nkoo":"GN",mas:"KE",maz:"MX",mdf:"RU",mdh:"PH",mdr:"ID",men:"SL",mer:"KE",mfa:"TH",mfe:"MU",mg:"MG",mgh:"MZ",mgo:"CM",mgp:"NP",mgy:"TZ",mh:"MH",mi:"NZ",min:"ID",mis:"IQ",mk:"MK",ml:"IN",mls:"SD",mn:"MN","mn-Mong":"CN",mni:"IN",mnw:"MM",moe:"CA",moh:"CA",mos:"BF",mr:"IN",mrd:"NP",mrj:"RU",mro:"BD",ms:"MY",mt:"MT",mtr:"IN",mua:"CM",mus:"US",mvy:"PK",mwk:"ML",mwr:"IN",mwv:"ID",mxc:"ZW",my:"MM",myv:"RU",myx:"UG",myz:"IR",mzn:"IR",na:"NR",nan:"CN",nap:"IT",naq:"NA",nb:"NO",nch:"MX",nd:"ZW",ndc:"MZ",nds:"DE",ne:"NP",new:"NP",ng:"NA",ngl:"MZ",nhe:"MX",nhw:"MX",nij:"ID",niu:"NU",njo:"IN",nl:"NL",nmg:"CM",nn:"NO",nnh:"CM",no:"NO",nod:"TH",noe:"IN",non:"SE",nqo:"GN",nr:"ZA",nsk:"CA",nso:"ZA",nus:"SS",nv:"US",nxq:"CN",ny:"MW",nym:"TZ",nyn:"UG",nzi:"GH",oc:"FR",om:"ET",or:"IN",os:"GE",osa:"US",otk:"MN",pa:"IN","pa-Arab":"PK",pag:"PH",pal:"IR","pal-Phlp":"CN",pam:"PH",pap:"AW",pau:"PW",pcd:"FR",pcm:"NG",pdc:"US",pdt:"CA",peo:"IR",pfl:"DE",phn:"LB",pka:"IN",pko:"KE",pl:"PL",pms:"IT",pnt:"GR",pon:"FM",pra:"PK",prd:"IR",ps:"AF",pt:"PT",puu:"GA",qu:"PE",quc:"GT",qug:"EC",raj:"IN",rcf:"RE",rej:"ID",rgn:"IT",ria:"IN",rif:"MA",rjs:"NP",rkt:"BD",rm:"CH",rmf:"FI",rmo:"CH",rmt:"IR",rmu:"SE",rn:"BI",rng:"MZ",ro:"RO",rob:"ID",rof:"TZ",rtm:"FJ",ru:"RU",rue:"UA",rug:"SB",rw:"RW",rwk:"TZ",ryu:"JP",sa:"IN",saf:"GH",sah:"RU",saq:"KE",sas:"ID",sat:"IN",sav:"SN",saz:"IN",sbp:"TZ",sc:"IT",sck:"IN",scn:"IT",sco:"GB",scs:"CA",sd:"PK","sd-Deva":"IN","sd-Khoj":"IN","sd-Sind":"IN",sdc:"IT",sdh:"IR",se:"NO",sef:"CI",seh:"MZ",sei:"MX",ses:"ML",sg:"CF",sga:"IE",sgs:"LT",shi:"MA",shn:"MM",si:"LK",sid:"ET",sk:"SK",skr:"PK",sl:"SI",sli:"PL",sly:"ID",sm:"WS",sma:"SE",smj:"SE",smn:"FI",smp:"IL",sms:"FI",sn:"ZW",snk:"ML",so:"SO",sou:"TH",sq:"AL",sr:"RS",srb:"IN",srn:"SR",srr:"SN",srx:"IN",ss:"ZA",ssy:"ER",st:"ZA",stq:"DE",su:"ID",suk:"TZ",sus:"GN",sv:"SE",sw:"TZ",swb:"YT",swc:"CD",swg:"DE",swv:"IN",sxn:"ID",syl:"BD",syr:"IQ",szl:"PL",ta:"IN",taj:"NP",tbw:"PH",tcy:"IN",tdd:"CN",tdg:"NP",tdh:"NP",te:"IN",tem:"SL",teo:"UG",tet:"TL",tg:"TJ","tg-Arab":"PK",th:"TH",thl:"NP",thq:"NP",thr:"NP",ti:"ET",tig:"ER",tiv:"NG",tk:"TM",tkl:"TK",tkr:"AZ",tkt:"NP",tl:"PH",tly:"AZ",tmh:"NE",tn:"ZA",to:"TO",tog:"MW",tpi:"PG",tr:"TR",tru:"TR",trv:"TW",ts:"ZA",tsd:"GR",tsf:"NP",tsg:"PH",tsj:"BT",tt:"RU",ttj:"UG",tts:"TH",ttt:"AZ",tum:"MW",tvl:"TV",twq:"NE",txg:"CN",ty:"PF",tyv:"RU",tzm:"MA",udm:"RU",ug:"CN","ug-Cyrl":"KZ",uga:"SY",uk:"UA",uli:"FM",umb:"AO",und:"US",unr:"IN","unr-Deva":"NP",unx:"IN",ur:"PK",uz:"UZ","uz-Arab":"AF",vai:"LR",ve:"ZA",vec:"IT",vep:"RU",vi:"VN",vic:"SX",vls:"BE",vmf:"DE",vmw:"MZ",vot:"RU",vro:"EE",vun:"TZ",wa:"BE",wae:"CH",wal:"ET",war:"PH",wbp:"AU",wbq:"IN",wbr:"IN",wls:"WF",wni:"KM",wo:"SN",wtm:"IN",wuu:"CN",xav:"BR",xcr:"TR",xh:"ZA",xlc:"TR",xld:"TR",xmf:"GE",xmn:"CN",xmr:"SD",xna:"SA",xnr:"IN",xog:"UG",xpr:"IR",xsa:"YE",xsr:"NP",yao:"MZ",yap:"FM",yav:"CM",ybb:"CM",yo:"NG",yrl:"BR",yua:"MX",yue:"HK","yue-Hans":"CN",za:"CN",zag:"SD",zdj:"KM",zea:"NL",zgh:"MA",zh:"CN","zh-Bopo":"TW","zh-Hanb":"TW","zh-Hant":"TW",zlm:"TG",zmi:"MY",zu:"ZA",zza:"TR"};function i(A){var M=A.toUpperCase().split(/-|_/),L=M.shift(),C=M.pop();if(/^[A-Z]{2}$/.test(C)||(C=a[L.toLowerCase()]),!C)return"";const u=String.fromCodePoint(C.codePointAt(0)-65+127462),_=String.fromCodePoint(C.codePointAt(1)-65+127462);return u+_}const s="en",c=["ar","cs","da","de","el","en","es","fi","fr","he","hu","it","ja","ko","nl","no","pl","pt","pt-br","ru","sk","sl","sv","tr","zh","zh-simplified"],r={ab:[["Abkhazian"],["Аҧсуа Бызшәа","Аҧсшәа"]],aa:[["Afar"],["Afaraf"]],af:[["Afrikaans"],["Afrikaans"]],ak:[["Akan"],["Akan"]],sq:[["Albanian"],["Shqip"]],am:[["Amharic"],["አማርኛ"]],ar:[["Arabic"],["العربية"]],an:[["Aragonese"],["Aragonés"]],hy:[["Armenian"],["Հայերեն"]],as:[["Assamese"],["অসমীয়া"]],av:[["Avaric"],["Авар МацӀ","МагӀарул МацӀ"]],ae:[["Avestan"],["Avesta"]],ay:[["Aymara"],["Aymar Aru"]],az:[["Azerbaijani"],["Azərbaycan Dili"]],bm:[["Bambara"],["Bamanankan"]],ba:[["Bashkir"],["Башҡорт Теле"]],eu:[["Basque"],["Euskara","Euskera"]],be:[["Belarusian"],["Беларуская Мова"]],bn:[["Bengali"],["বাংলা"]],bh:[["Bihari Languages"],["भोजपुरी"]],bi:[["Bislama"],["Bislama"]],bs:[["Bosnian"],["Bosanski Jezik"]],br:[["Breton"],["Brezhoneg"]],bg:[["Bulgarian"],["Български Език"]],my:[["Burmese"],["ဗမာစာ"]],ca:[["Catalan","Valencian"],["Català","Valencià"]],ch:[["Chamorro"],["Chamoru"]],ce:[["Chechen"],["Нохчийн Мотт"]],ny:[["Chichewa","Chewa","Nyanja"],["ChiCheŵa","Chinyanja"]],zh:[["Traditional Chinese"],["繁體中文","傳統中文","正體中文","繁体中文"]],"zh-traditional":[["Traditional Chinese"],["繁體中文","傳統中文","正體中文","繁体中文"]],"zh-simplified":[["Simple Chinese"],["简体中文"]],cv:[["Chuvash"],["Чӑваш Чӗлхи"]],kw:[["Cornish"],["Kernewek"]],co:[["Corsican"],["Corsu","Lingua Corsa"]],cr:[["Cree"],["ᓀᐦᐃᔭᐍᐏᐣ"]],hr:[["Croatian"],["Hrvatski Jezik"]],cs:[["Czech"],["Čeština","Český Jazyk"]],da:[["Danish"],["Dansk"]],dv:[["Divehi","Dhivehi","Maldivian"],["ދިވެހި"]],nl:[["Dutch","Flemish"],["Nederlands","Vlaams"]],dz:[["Dzongkha"],["རྫོང་ཁ"]],en:[["English"],["English"]],eo:[["Esperanto"],["Esperanto"]],et:[["Estonian"],["Eesti","Eesti Keel"]],ee:[["Ewe"],["Eʋegbe"]],fo:[["Faroese"],["Føroyskt"]],fj:[["Fijian"],["Vosa Vakaviti"]],fi:[["Finnish"],["Suomi","Suomen Kieli"]],fr:[["French"],["Français","Langue Française"]],ff:[["Fulah"],["Fulfulde","Pulaar","Pular"]],gl:[["Galician"],["Galego"]],ka:[["Georgian"],["ქართული"]],de:[["German"],["Deutsch"]],el:[["Greek"],["Ελληνικά"]],gn:[["Guarani"],["Avañe'ẽ"]],gu:[["Gujarati"],["ગુજરાતી"]],ht:[["Haitian","Haitian Creole"],["Kreyòl Ayisyen"]],ha:[["Hausa"],["هَوُسَ"]],he:[["Hebrew"],["עברית"]],hz:[["Herero"],["Otjiherero"]],hi:[["Hindi"],["हिन्दी","हिंदी"]],ho:[["Hiri Motu"],["Hiri Motu"]],hu:[["Hungarian"],["Magyar"]],ia:[["Interlingua"],["Interlingua"]],id:[["Indonesian"],["Bahasa Indonesia"]],ie:[["Interlingue","Occidental"],["Interlingue","Occidental"]],ga:[["Irish"],["Gaeilge"]],ig:[["Igbo"],["Asụsụ Igbo"]],ik:[["Inupiaq"],["Iñupiaq","Iñupiatun"]],io:[["Ido"],["Ido"]],is:[["Icelandic"],["Íslenska"]],it:[["Italian"],["Italiano"]],iu:[["Inuktitut"],["ᐃᓄᒃᑎᑐᑦ"]],ja:[["Japanese"],["日本語","にほんご"]],jv:[["Javanese"],["ꦧꦱꦗꦮ","Basa Jawa"]],kl:[["Kalaallisut","Greenlandic"],["Kalaallisut","Kalaallit Oqaasii"]],kn:[["Kannada"],["ಕನ್ನಡ"]],kr:[["Kanuri"],["Kanuri"]],ks:[["Kashmiri"],["कश्मीरी","كشميري‎"]],kk:[["Kazakh"],["Қазақ Тілі"]],km:[["Central Khmer"],["ខ្មែរ","ខេមរភាសា","ភាសាខ្មែរ"]],ki:[["Kikuyu","Gikuyu"],["Gĩkũyũ"]],rw:[["Kinyarwanda"],["Ikinyarwanda"]],ky:[["Kirghiz","Kyrgyz"],["Кыргызча","Кыргыз Тили"]],kv:[["Komi"],["Коми Кыв"]],kg:[["Kongo"],["Kikongo"]],ko:[["Korean"],["한국어"]],ku:[["Kurdish"],["Kurdî","کوردی‎"]],kj:[["Kuanyama","Kwanyama"],["Kuanyama"]],la:[["Latin"],["Latine","Lingua Latina"]],lb:[["Luxembourgish","Letzeburgesch"],["Lëtzebuergesch"]],lg:[["Ganda"],["Luganda"]],li:[["Limburgan","Limburger","Limburgish"],["Limburgs"]],ln:[["Lingala"],["Lingála"]],lo:[["Lao"],["ພາສາລາວ"]],lt:[["Lithuanian"],["Lietuvių Kalba"]],lu:[["Luba-Katanga"],["Kiluba"]],lv:[["Latvian"],["Latviešu Valoda"]],gv:[["Manx"],["Gaelg","Gailck"]],mk:[["Macedonian"],["Македонски Јазик"]],mg:[["Malagasy"],["Fiteny Malagasy"]],ms:[["Malay"],["Bahasa Melayu","بهاس ملايو‎"]],ml:[["Malayalam"],["മലയാളം"]],mt:[["Maltese"],["Malti"]],mi:[["Maori"],["Te Reo Māori"]],mr:[["Marathi"],["मराठी"]],mh:[["Marshallese"],["Kajin M̧ajeļ"]],mn:[["Mongolian"],["Монгол Хэл"]],na:[["Nauru"],["Dorerin Naoero"]],nv:[["Navajo","Navaho"],["Diné Bizaad"]],nd:[["North Ndebele"],["IsiNdebele"]],ne:[["Nepali"],["नेपाली"]],ng:[["Ndonga"],["Owambo"]],nb:[["Norwegian Bokmål"],["Norsk Bokmål"]],nn:[["Norwegian Nynorsk"],["Norsk Nynorsk"]],no:[["Norwegian"],["Norsk"]],ii:[["Sichuan Yi","Nuosu"],["ꆈꌠ꒿","Nuosuhxop"]],nr:[["South Ndebele"],["IsiNdebele"]],oc:[["Occitan"],["Occitan","Lenga d'Òc"]],oj:[["Ojibwa"],["ᐊᓂᔑᓈᐯᒧᐎᓐ"]],cu:[["Church Slavic","Old Slavonic","Church Slavonic","Old Bulgarian","Old Church Slavonic"],["Ѩзыкъ Словѣньскъ"]],om:[["Oromo"],["Afaan Oromoo"]],or:[["Oriya"],["ଓଡ଼ିଆ"]],os:[["Ossetian","Ossetic"],["Ирон Æвзаг"]],pa:[["Punjabi","Panjabi"],["ਪੰਜਾਬੀ","پنجابی‎"]],pi:[["Pali"],["पालि","पाळि"]],fa:[["Persian"],["فارسی"]],pl:[["Polish"],["Język Polski","Polszczyzna"]],ps:[["Pashto","Pushto"],["پښتو"]],pt:[["Portuguese"],["Português"]],"pt-br":[["Brazilian Portuguese"],["Português Brasileiro"]],"pt-pt":[["Portuguese (Portugal)"],["Português De Portugal"]],qu:[["Quechua"],["Runa Simi","Kichwa"]],rm:[["Romansh"],["Rumantsch Grischun"]],rn:[["Rundi"],["Ikirundi"]],ro:[["Romanian","Moldavian","Moldovan"],["Română"]],ru:[["Russian"],["Русский"]],sa:[["Sanskrit"],["संस्कृतम्"]],sc:[["Sardinian"],["Sardu"]],sd:[["Sindhi"],["सिन्धी","سنڌي، سندھی‎"]],se:[["Northern Sami"],["Davvisámegiella"]],sm:[["Samoan"],["Gagana Fa'a Samoa"]],sg:[["Sango"],["Yângâ Tî Sängö"]],sr:[["Serbian"],["Српски Језик"]],gd:[["Gaelic","Scottish Gaelic"],["Gàidhlig"]],sn:[["Shona"],["ChiShona"]],si:[["Sinhala","Sinhalese"],["සිංහල"]],sk:[["Slovak"],["Slovenčina","Slovenský Jazyk"]],sl:[["Slovenian"],["Slovenski Jezik","Slovenščina"]],so:[["Somali"],["Soomaaliga","Af Soomaali"]],st:[["Southern Sotho"],["Sesotho"]],es:[["Spanish","Castilian"],["Español"]],su:[["Sundanese"],["Basa Sunda"]],sw:[["Swahili"],["Kiswahili"]],ss:[["Swati"],["SiSwati"]],sv:[["Swedish"],["Svenska"]],ta:[["Tamil"],["தமிழ்"]],te:[["Telugu"],["తెలుగు"]],tg:[["Tajik"],["Тоҷикӣ","Toçikī","تاجیکی‎"]],th:[["Thai"],["ไทย"]],ti:[["Tigrinya"],["ትግርኛ"]],bo:[["Tibetan"],["བོད་ཡིག"]],tk:[["Turkmen"],["Türkmen","Түркмен"]],tl:[["Tagalog"],["Wikang Tagalog"]],tn:[["Tswana"],["Setswana"]],to:[["Tonga"],["Faka Tonga"]],tr:[["Turkish"],["Türkçe"]],ts:[["Tsonga"],["Xitsonga"]],tt:[["Tatar"],["Татар Теле","Tatar Tele"]],tw:[["Twi"],["Twi"]],ty:[["Tahitian"],["Reo Tahiti"]],ug:[["Uighur","Uyghur"],["ئۇيغۇرچە‎","Uyghurche"]],uk:[["Ukrainian"],["Українська"]],ur:[["Urdu"],["اردو"]],uz:[["Uzbek"],["Oʻzbek","Ўзбек","أۇزبېك‎"]],ve:[["Venda"],["Tshivenḓa"]],vi:[["Vietnamese"],["Tiếng Việt"]],vo:[["Volapük"],["Volapük"]],wa:[["Walloon"],["Walon"]],cy:[["Welsh"],["Cymraeg"]],wo:[["Wolof"],["Wollof"]],fy:[["Western Frisian"],["Frysk"]],xh:[["Xhosa"],["IsiXhosa"]],yi:[["Yiddish"],["ייִדיש"]],yo:[["Yoruba"],["Yorùbá"]],za:[["Zhuang","Chuang"],["Saɯ Cueŋƅ","Saw Cuengh"]],zu:[["Zulu"],["IsiZulu"]]};function d(A){return r[A][0][0]}function h(A){return r[A][1][0]}let m=s;for(const A of l)if(c.indexOf(A)!==-1){m=A;break}function f(){return m}function g(A=m){return A.match(/^(ar|dv|fa|ha|he|ks|ku|ms|pa|ps|sd|ug|yi)\b/i)?"rtl":"ltr"}function x(A){const M=[...document.querySelectorAll(".flippable-layout-stylesheet")];for(const C of M){let u=C.getAttribute("href");g(A)==="rtl"?u.indexOf(".rtl.css")===-1&&(u=u.replace(/\.css$/i,".rtl.css")):u.indexOf(".rtl.css")>-1&&(u=u.replace(/\.rtl\.css$/i,".css")),C.setAttribute("href",u);const _=document.createElement("img");_.onerror=()=>{$(()=>{$G.triggerHandler("theme-load")})},_.src=u}if(A===s){n={},m=s;return}(async C=>{const u=`../localization/${C}/localizations.js`;try{return(await import(u)).default}catch(_){console.error(`Failed to load localization for language ${C}`,_)}})(A).then(C=>{})}window.loaded_localizations=function(M,L){n=L,m=M};function b(A){showMessageBox({title:"Reload Required",message:"The application needs to reload to change the language.",buttons:[{label:o("OK"),value:"reload",default:!0},{label:o("Cancel"),value:"cancel"}],windowOptions:{innerWidth:450}}).then(M=>{M==="reload"&&are_you_sure(()=>{try{localStorage[t]=A,exit_fullscreen_if_ios(),location.reload()}catch(L){show_error_message("Failed to store language preference. Make sure cookies / local storage is enabled in your browser settings.",L)}})})}x(m),e.localize=o,e.set_language=b,e.get_language=f,e.get_iso_language_name=d,e.get_language_endonym=h,e.get_language_emoji=i,e.get_direction=g,e.available_languages=c})(window);console.log("JS 실행:","helpers.js");const TAU=- - - - - - - -Math.PI+Math.PI-0,is_pride_month=new Date().getMonth()===5,$G$1=$(window);function render_access_key(e){return`<span style="white-space: pre">${AccessKeys.toHTML(e)}</span>`}function make_css_cursor(e,n,o){return`url(images/cursors/${e}.png) ${n.join(" ")}, ${o}`}const E=function(n){return document.createElement(n)};function debounce(e,n,o){let t;const l=function(){const a=this,i=arguments,s=()=>{t=null,e.apply(a,i)};clearTimeout(t),t=setTimeout(s,n)};return l.cancel=()=>{clearTimeout(t)},l}function memoize_synchronous_function(e,n=5e4){const o={},t=[],l=(...a)=>{if(a.some(s=>s instanceof CanvasPattern))return e.apply(null,a);const i=JSON.stringify(a);if(o[i])return o[i];{const s=e.apply(null,a);if(o[i]=s,t.push(i),t.length>n){const c=t.shift();delete o[c]}return s}};return l.clear_memo_cache=()=>{for(const a of t)delete o[a];t.length=0},l}const get_rgba_from_color_implementation=e=>{const n=make_canvas(1,1);n.ctx.fillStyle=e,n.ctx.fillRect(0,0,1,1);const o=n.ctx.getImageData(0,0,1,1);return Array.from(o.data)},get_rgba_from_color=memoize_synchronous_function(get_rgba_from_color_implementation);function image_data_match(e,n,o){const t=e.data,l=n.data;if(t.length!==l.length)return!1;for(let a=t.length,i=0;i<a;i++)if(t[i]!==l[i]&&Math.abs(t[i]-l[i])>o)return!1;return!0}function make_canvas(e,n){const o=e,t=E("canvas"),l=t.getContext("2d");return t.ctx=l,l.disable_image_smoothing=()=>{l.imageSmoothingEnabled=!1,l.imageSmoothingEnabled!==!1&&(l.mozImageSmoothingEnabled=!1,l.webkitImageSmoothingEnabled=!1,l.msImageSmoothingEnabled=!1)},l.enable_image_smoothing=()=>{l.imageSmoothingEnabled=!0,l.imageSmoothingEnabled!==!0&&(l.mozImageSmoothingEnabled=!0,l.webkitImageSmoothingEnabled=!0,l.msImageSmoothingEnabled=!0)},l.copy=a=>{t.width=a.naturalWidth||a.width,t.height=a.naturalHeight||a.height,l.disable_image_smoothing(),a instanceof ImageData?l.putImageData(a,0,0):l.drawImage(a,0,0)},e&&n?(t.width=e,t.height=n,l.disable_image_smoothing()):o&&l.copy(o),t}function get_help_folder_icon(e){const n=new Image;return n.src=`help/${e}`,n}function get_icon_for_tool(e){return get_help_folder_icon(e.help_icon)}function load_image_simple(e){return new Promise((n,o)=>{const t=new Image;t.onload=()=>{n(t)},t.onerror=()=>{o(new Error(`failed to load image from ${e}`))},t.src=e})}function get_icon_for_tools(e){if(e.length===1)return get_icon_for_tool(e[0]);const n=make_canvas(16,16);return Promise.all(e.map(o=>load_image_simple(`help/${o.help_icon}`))).then(o=>{o.forEach((t,l)=>{const a=n.width/o.length,i=l*a,s=n.height,c=0;n.ctx.drawImage(t,i,c,a,s,i,c,a,s)})}),n}function get_file_extension(e){var n;return((n=e.match(/\.([^./]+)$/))==null?void 0:n[1])||""}function get_format_from_extension(e,n){const o=n.match(/\.([^.]+)$/),t=o?o[1].toLowerCase():n;for(const l of e)if(l.extensions.includes(t))return l}function rgb_to_hsl(e,n,o){e/=255,n/=255,o/=255;var t=Math.max(e,n,o),l=Math.min(e,n,o),a,i,s=(t+l)/2;if(t==l)a=i=0;else{var c=t-l;switch(i=s>.5?c/(2-t-l):c/(t+l),t){case e:a=(n-o)/c+(n<o?6:0);break;case n:a=(o-e)/c+2;break;case o:a=(e-n)/c+4;break}a/=6}return[a,i,s]}function to_canvas_coords({clientX:e,clientY:n}){if(e===void 0||n===void 0)throw new TypeError("clientX and clientY must be defined (not {x, y} or x, y or [x, y])");const o=window.canvas_bounding_client_rect;return{x:~~((e-o.left)/o.width*main_canvas.width),y:~~((n-o.top)/o.height*main_canvas.height)}}function from_canvas_coords({x:e,y:n}){const o=window.canvas_bounding_client_rect;return{clientX:~~(e/main_canvas.width*o.width+o.left),clientY:~~(n/main_canvas.height*o.height+o.top)}}window.$G=$G$1;window.make_canvas=make_canvas;window.get_format_from_extension=get_format_from_extension;console.log("JS 실행:","$ToolWindow.js");function make_window_supporting_scale(e){const n=$Window(e),o=()=>{if(!n.is(".edit-colors-window, .storage-manager, .attributes-window, .flip-and-rotate, .stretch-and-skew"))return;const t=n.$content[0],l=n.$titlebar[0];let a=1;n.$content.css({transform:`scale(${a})`,transformOrigin:"0 0",marginRight:"",marginBottom:""}),document.body.classList.contains("eye-gaze-mode")&&(a=Math.min(innerWidth/t.offsetWidth,(innerHeight-l.offsetHeight)/t.offsetHeight),n.$content.css({transform:`scale(${a})`,transformOrigin:"0 0",marginRight:t.scrollWidth*(a-1)}),n.$content.css({marginBottom:t.scrollHeight*(a-1)}),n.center())};if(!e.$component){n.center();const t=()=>{requestAnimationFrame(o)},l=()=>{n.off("close",l),$G$1.off("eye-gaze-mode-toggled resize",t)};n.on("close",l),$G$1.on("eye-gaze-mode-toggled resize",t),t()}return e.$component&&n.$content.css({contain:"none"}),n}function $ToolWindow(e){return make_window_supporting_scale({$component:e,toolWindow:!0})}function $DialogWindow(e){const n=make_window_supporting_scale({title:e,resizable:!1,maximizeButton:!1,minimizeButton:!1});n.addClass("dialog-window"),n.$form=$(E("form")).appendTo(n.$content),n.$main=$(E("div")).appendTo(n.$form),n.$buttons=$(E("div")).appendTo(n.$form).addClass("button-group"),n.$Button=(t,l,a={type:"button"})=>{const i=$(E("button")).appendTo(n.$buttons);return i[0].append(t),i.on("click",()=>{l()}),i.on("pointerdown",()=>{i.focus()}),i.attr({type:a.type}),i},n.$form.on("submit",t=>{t.preventDefault()});function o(){n.find("button, input").removeClass("default");let t=$(document.activeElement).closest("button, input[type='submit'], input[type='button'], textarea, select");t.length===0&&(t=n.$form.find('button[type="submit"], input[type="submit"], button:not([type])').first()),t.is("button, input[type='submit'], input[type='button']")&&t.addClass("default")}return n.on("focusin",o),n.on("focusout",()=>{n.find("button, input").removeClass("default")}),setTimeout(()=>{o()},0),n}console.log("JS 실행:","msgbox.js");const exports$1={};function showMessageBox_implementation({title:e=window.defaultMessageBoxTitle??"Alert",message:n,messageHTML:o,buttons:t=[{label:"OK",value:"ok",default:!0}],iconID:l="warning",windowOptions:a={}}){let i,s;const c=new Promise(r=>{i=make_window_supporting_scale(Object.assign({title:e,resizable:!1,innerWidth:400,maximizeButton:!1,minimizeButton:!1},a)),s=$("<div>").css({textAlign:"left",fontFamily:"MS Sans Serif, Arial, sans-serif",fontSize:"14px",marginTop:"22px",flex:1,minWidth:0,whiteSpace:"normal"}),o?s.html(o):n&&s.text(n).css({whiteSpace:"pre-wrap",wordWrap:"break-word"}),$("<div>").append($("<img width='32' height='32'>").attr("src",`images/${l}-32x32-8bpp.png`).css({margin:"16px",display:"block"}),s).css({display:"flex",flexDirection:"row"}).appendTo(i.$content),i.$content.css({textAlign:"center"});for(const d of t){const h=i.$Button(d.label,()=>{var m;(m=d.action)==null||m.call(d),r(d.value),i.close()});d.default&&(h.addClass("default"),h.focus(),setTimeout(()=>h.focus(),0)),h.css({minWidth:75,height:23,margin:"16px 2px"})}i.on("focusin","button",d=>{$(d.currentTarget).addClass("default")}),i.on("focusout","button",d=>{$(d.currentTarget).removeClass("default")}),i.on("closed",()=>{r("closed")}),i.center()});return c.$window=i,c.$message=s,c.promise=c,c}exports$1.showMessageBox=window.showMessageBox||showMessageBox_implementation;window.defaultMessageBoxTitle=localize("Paint");const{showMessageBox:showMessageBox$1}=exports$1;window.showMessageBox=showMessageBox$1;let pdfjs;const pdfjs$1=pdfjs;(function(n,o){typeof exports=="object"&&typeof module=="object"?module.exports=o():typeof define=="function"&&define.amd?define("pdfjs-dist/build/pdf",[],o):typeof exports=="object"?exports["pdfjs-dist/build/pdf"]=o():(window["pdfjs-dist/build/pdf"]=window.pdfjsLib=o(),pdfjs=o())})(void 0,function(){return(()=>{var __webpack_modules__=[,(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.addLinkAttributes=g,n.deprecated=y,n.getFilenameFromUrl=A,n.getPdfFilenameFromUrl=M,n.isDataScheme=x,n.isFetchSupported=C,n.isPdfFile=b,n.isValidFetchUrl=u,n.loadScript=_,n.StatTimer=n.RenderingCancelledException=n.PDFDateString=n.PageViewport=n.LinkTarget=n.DOMSVGFactory=n.DOMCMapReaderFactory=n.DOMCanvasFactory=n.DEFAULT_LINK_REL=n.BaseCMapReaderFactory=n.BaseCanvasFactory=void 0;var t=o(2);const l="noopener noreferrer nofollow";n.DEFAULT_LINK_REL=l;const a="http://www.w3.org/2000/svg";class i{constructor(){this.constructor===i&&(0,t.unreachable)("Cannot initialize BaseCanvasFactory.")}create(P,S){(0,t.unreachable)("Abstract method `create` called.")}reset(P,S,F){if(!P.canvas)throw new Error("Canvas is not specified");if(S<=0||F<=0)throw new Error("Invalid canvas size");P.canvas.width=S,P.canvas.height=F}destroy(P){if(!P.canvas)throw new Error("Canvas is not specified");P.canvas.width=0,P.canvas.height=0,P.canvas=null,P.context=null}}n.BaseCanvasFactory=i;class s extends i{constructor({ownerDocument:P=globalThis.document}={}){super(),this._document=P}create(P,S){if(P<=0||S<=0)throw new Error("Invalid canvas size");const F=this._document.createElement("canvas"),K=F.getContext("2d");return F.width=P,F.height=S,{canvas:F,context:K}}}n.DOMCanvasFactory=s;class c{constructor({baseUrl:P=null,isCompressed:S=!1}){this.constructor===c&&(0,t.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=P,this.isCompressed=S}async fetch({name:P}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!P)throw new Error("CMap name must be specified.");const S=this.baseUrl+P+(this.isCompressed?".bcmap":""),F=this.isCompressed?t.CMapCompressionType.BINARY:t.CMapCompressionType.NONE;return this._fetchData(S,F).catch(K=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${S}`)})}_fetchData(P,S){(0,t.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=c;class r extends c{_fetchData(P,S){return C()&&u(P,document.baseURI)?fetch(P).then(async F=>{if(!F.ok)throw new Error(F.statusText);let K;return this.isCompressed?K=new Uint8Array(await F.arrayBuffer()):K=(0,t.stringToBytes)(await F.text()),{cMapData:K,compressionType:S}}):new Promise((F,K)=>{const Q=new XMLHttpRequest;Q.open("GET",P,!0),this.isCompressed&&(Q.responseType="arraybuffer"),Q.onreadystatechange=()=>{if(Q.readyState===XMLHttpRequest.DONE){if(Q.status===200||Q.status===0){let Z;if(this.isCompressed&&Q.response?Z=new Uint8Array(Q.response):!this.isCompressed&&Q.responseText&&(Z=(0,t.stringToBytes)(Q.responseText)),Z){F({cMapData:Z,compressionType:S});return}}K(new Error(Q.statusText))}},Q.send(null)})}}n.DOMCMapReaderFactory=r;class d{create(P,S){(0,t.assert)(P>0&&S>0,"Invalid SVG dimensions");const F=document.createElementNS(a,"svg:svg");return F.setAttribute("version","1.1"),F.setAttribute("width",P+"px"),F.setAttribute("height",S+"px"),F.setAttribute("preserveAspectRatio","none"),F.setAttribute("viewBox","0 0 "+P+" "+S),F}createElement(P){return(0,t.assert)(typeof P=="string","Invalid SVG element type"),document.createElementNS(a,P)}}n.DOMSVGFactory=d;class h{constructor({viewBox:P,scale:S,rotation:F,offsetX:K=0,offsetY:Q=0,dontFlip:Z=!1}){this.viewBox=P,this.scale=S,this.rotation=F,this.offsetX=K,this.offsetY=Q;const B=(P[2]+P[0])/2,G=(P[3]+P[1])/2;let w,D,U,q;switch(F%=360,F<0&&(F+=360),F){case 180:w=-1,D=0,U=0,q=1;break;case 90:w=0,D=1,U=1,q=0;break;case 270:w=0,D=-1,U=-1,q=0;break;case 0:w=1,D=0,U=0,q=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Z&&(U=-U,q=-q);let j,Y,J,oe;w===0?(j=Math.abs(G-P[1])*S+K,Y=Math.abs(B-P[0])*S+Q,J=Math.abs(P[3]-P[1])*S,oe=Math.abs(P[2]-P[0])*S):(j=Math.abs(B-P[0])*S+K,Y=Math.abs(G-P[1])*S+Q,J=Math.abs(P[2]-P[0])*S,oe=Math.abs(P[3]-P[1])*S),this.transform=[w*S,D*S,U*S,q*S,j-w*S*B-U*S*G,Y-D*S*B-q*S*G],this.width=J,this.height=oe}clone({scale:P=this.scale,rotation:S=this.rotation,offsetX:F=this.offsetX,offsetY:K=this.offsetY,dontFlip:Q=!1}={}){return new h({viewBox:this.viewBox.slice(),scale:P,rotation:S,offsetX:F,offsetY:K,dontFlip:Q})}convertToViewportPoint(P,S){return t.Util.applyTransform([P,S],this.transform)}convertToViewportRectangle(P){const S=t.Util.applyTransform([P[0],P[1]],this.transform),F=t.Util.applyTransform([P[2],P[3]],this.transform);return[S[0],S[1],F[0],F[1]]}convertToPdfPoint(P,S){return t.Util.applyInverseTransform([P,S],this.transform)}}n.PageViewport=h;class m extends t.BaseException{constructor(P,S){super(P),this.type=S}}n.RenderingCancelledException=m;const f={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};n.LinkTarget=f;function g(k,{url:P,target:S,rel:F,enabled:K=!0}={}){(0,t.assert)(P&&typeof P=="string",'addLinkAttributes: A valid "url" parameter must provided.');const Q=(0,t.removeNullCharacters)(P);K?k.href=k.title=Q:(k.href="",k.title=`Disabled: ${Q}`,k.onclick=()=>!1);let Z="";switch(S){case f.NONE:break;case f.SELF:Z="_self";break;case f.BLANK:Z="_blank";break;case f.PARENT:Z="_parent";break;case f.TOP:Z="_top";break}k.target=Z,k.rel=typeof F=="string"?F:l}function x(k){const P=k.length;let S=0;for(;S<P&&k[S].trim()==="";)S++;return k.substring(S,S+5).toLowerCase()==="data:"}function b(k){return typeof k=="string"&&/\.pdf$/i.test(k)}function A(k){const P=k.indexOf("#"),S=k.indexOf("?"),F=Math.min(P>0?P:k.length,S>0?S:k.length);return k.substring(k.lastIndexOf("/",F)+1,F)}function M(k,P="document.pdf"){if(typeof k!="string")return P;if(x(k))return(0,t.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),P;const S=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,F=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,K=S.exec(k);let Q=F.exec(K[1])||F.exec(K[2])||F.exec(K[3]);if(Q&&(Q=Q[0],Q.includes("%")))try{Q=F.exec(decodeURIComponent(Q))[0]}catch{}return Q||P}class L{constructor(){this.started=Object.create(null),this.times=[]}time(P){P in this.started&&(0,t.warn)(`Timer is already running for ${P}`),this.started[P]=Date.now()}timeEnd(P){P in this.started||(0,t.warn)(`Timer has not been started for ${P}`),this.times.push({name:P,start:this.started[P],end:Date.now()}),delete this.started[P]}toString(){const P=[];let S=0;for(const F of this.times){const K=F.name;K.length>S&&(S=K.length)}for(const F of this.times){const K=F.end-F.start;P.push(`${F.name.padEnd(S)} ${K}ms
`)}return P.join("")}}n.StatTimer=L;function C(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&typeof ReadableStream<"u"}function u(k,P){try{const{protocol:S}=P?new URL(k,P):new URL(k);return S==="http:"||S==="https:"}catch{return!1}}function _(k,P=!1){return new Promise((S,F)=>{const K=document.createElement("script");K.src=k,K.onload=function(Q){P&&K.remove(),S(Q)},K.onerror=function(){F(new Error(`Cannot load script at: ${K.src}`))},(document.head||document.documentElement).appendChild(K)})}function y(k){console.log("Deprecated API usage: "+k)}let v;class T{static toDateObject(P){if(!P||!(0,t.isString)(P))return null;v||(v=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const S=v.exec(P);if(!S)return null;const F=parseInt(S[1],10);let K=parseInt(S[2],10);K=K>=1&&K<=12?K-1:0;let Q=parseInt(S[3],10);Q=Q>=1&&Q<=31?Q:1;let Z=parseInt(S[4],10);Z=Z>=0&&Z<=23?Z:0;let B=parseInt(S[5],10);B=B>=0&&B<=59?B:0;let G=parseInt(S[6],10);G=G>=0&&G<=59?G:0;const w=S[7]||"Z";let D=parseInt(S[8],10);D=D>=0&&D<=23?D:0;let U=parseInt(S[9],10)||0;return U=U>=0&&U<=59?U:0,w==="-"?(Z+=D,B+=U):w==="+"&&(Z-=D,B-=U),new Date(Date.UTC(F,K,Q,Z,B,G))}}n.PDFDateString=T},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.arrayByteLength=re,n.arraysToBytes=se,n.assert=Z,n.bytesToString=N,n.createObjectURL=Re,n.createPromiseCapability=be,n.createValidAbsoluteUrl=w,n.escapeString=Xe,n.getModificationDate=he,n.getVerbosityLevel=S,n.info=F,n.isArrayBuffer=ne,n.isArrayEqual=ue,n.isAscii=Ue,n.isBool=nt,n.isNum=qe,n.isSameOrigin=B,n.isString=W,n.objectFromMap=le,n.objectSize=ee,n.removeNullCharacters=X,n.setVerbosityLevel=P,n.shadow=D,n.string32=ve,n.stringToBytes=te,n.stringToPDFString=ze,n.stringToUTF16BEString=Ze,n.stringToUTF8String=He,n.unreachable=Q,n.utf8StringToString=Je,n.warn=K,n.VerbosityLevel=n.Util=n.UNSUPPORTED_FEATURES=n.UnknownErrorException=n.UnexpectedResponseException=n.TextRenderingMode=n.StreamType=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.IsLittleEndianCached=n.IsEvalSupportedCached=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FontType=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.AnnotationType=n.AnnotationStateModelType=n.AnnotationReviewState=n.AnnotationReplyType=n.AnnotationMarkedState=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,o(3);const t=[1,0,0,1,0,0];n.IDENTITY_MATRIX=t;const l=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=l;const a={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=a;const i={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=i;const s={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=s;const c={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=c;const r={MARKED:"Marked",REVIEW:"Review"};n.AnnotationStateModelType=r;const d={MARKED:"Marked",UNMARKED:"Unmarked"};n.AnnotationMarkedState=d;const h={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};n.AnnotationReviewState=h;const m={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=m;const f={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=f;const g={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=g;const x={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=x;const b={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=b;const A={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=A;const M={O:"PageOpen",C:"PageClose"};n.PageActionEventType=M;const L={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};n.StreamType=L;const C={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};n.FontType=C;const u={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=u;const _={NONE:0,BINARY:1,STREAM:2};n.CMapCompressionType=_;const y={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=y;const v={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent"};n.UNSUPPORTED_FEATURES=v;const T={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=T;let k=u.WARNINGS;function P(ge){Number.isInteger(ge)&&(k=ge)}function S(){return k}function F(ge){k>=u.INFOS&&console.log(`Info: ${ge}`)}function K(ge){k>=u.WARNINGS&&console.log(`Warning: ${ge}`)}function Q(ge){throw new Error(ge)}function Z(ge,we){ge||Q(we)}function B(ge,we){let Ce;try{if(Ce=new URL(ge),!Ce.origin||Ce.origin==="null")return!1}catch{return!1}const Fe=new URL(we,Ce);return Ce.origin===Fe.origin}function G(ge){if(!ge)return!1;switch(ge.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function w(ge,we){if(!ge)return null;try{const Ce=we?new URL(ge,we):new URL(ge);if(G(Ce))return Ce}catch{}return null}function D(ge,we,Ce){return Object.defineProperty(ge,we,{value:Ce,enumerable:!0,configurable:!0,writable:!1}),Ce}const U=function(){function we(Ce){this.constructor===we&&Q("Cannot initialize BaseException."),this.message=Ce,this.name=this.constructor.name}return we.prototype=new Error,we.constructor=we,we}();n.BaseException=U;class q extends U{constructor(we,Ce){super(we),this.code=Ce}}n.PasswordException=q;class j extends U{constructor(we,Ce){super(we),this.details=Ce}}n.UnknownErrorException=j;class Y extends U{}n.InvalidPDFException=Y;class J extends U{}n.MissingPDFException=J;class oe extends U{constructor(we,Ce){super(we),this.status=Ce}}n.UnexpectedResponseException=oe;class pe extends U{}n.FormatError=pe;class me extends U{}n.AbortException=me;const Ee=/\x00/g;function X(ge){return typeof ge!="string"?(K("The argument for removeNullCharacters must be a string."),ge):ge.replace(Ee,"")}function N(ge){Z(ge!==null&&typeof ge=="object"&&ge.length!==void 0,"Invalid argument for bytesToString");const we=ge.length,Ce=8192;if(we<Ce)return String.fromCharCode.apply(null,ge);const Fe=[];for(let Ve=0;Ve<we;Ve+=Ce){const Ye=Math.min(Ve+Ce,we),We=ge.subarray(Ve,Ye);Fe.push(String.fromCharCode.apply(null,We))}return Fe.join("")}function te(ge){Z(typeof ge=="string","Invalid argument for stringToBytes");const we=ge.length,Ce=new Uint8Array(we);for(let Fe=0;Fe<we;++Fe)Ce[Fe]=ge.charCodeAt(Fe)&255;return Ce}function re(ge){return ge.length!==void 0?ge.length:(Z(ge.byteLength!==void 0,"arrayByteLength - invalid argument."),ge.byteLength)}function se(ge){const we=ge.length;if(we===1&&ge[0]instanceof Uint8Array)return ge[0];let Ce=0;for(let Ye=0;Ye<we;Ye++)Ce+=re(ge[Ye]);let Fe=0;const Ve=new Uint8Array(Ce);for(let Ye=0;Ye<we;Ye++){let We=ge[Ye];We instanceof Uint8Array||(typeof We=="string"?We=te(We):We=new Uint8Array(We));const Ie=We.byteLength;Ve.set(We,Fe),Fe+=Ie}return Ve}function ve(ge){return String.fromCharCode(ge>>24&255,ge>>16&255,ge>>8&255,ge&255)}function ee(ge){return Object.keys(ge).length}function le(ge){const we=Object.create(null);for(const[Ce,Fe]of ge)we[Ce]=Fe;return we}function H(){const ge=new Uint8Array(4);return ge[0]=1,new Uint32Array(ge.buffer,0,1)[0]===1}const I={get value(){return D(this,"value",H())}};n.IsLittleEndianCached=I;function O(){try{return new Function(""),!0}catch{return!1}}const ae={get value(){return D(this,"value",O())}};n.IsEvalSupportedCached=ae;const _e=[...Array(256).keys()].map(ge=>ge.toString(16).padStart(2,"0"));class Ae{static makeHexColor(we,Ce,Fe){return`#${_e[we]}${_e[Ce]}${_e[Fe]}`}static transform(we,Ce){return[we[0]*Ce[0]+we[2]*Ce[1],we[1]*Ce[0]+we[3]*Ce[1],we[0]*Ce[2]+we[2]*Ce[3],we[1]*Ce[2]+we[3]*Ce[3],we[0]*Ce[4]+we[2]*Ce[5]+we[4],we[1]*Ce[4]+we[3]*Ce[5]+we[5]]}static applyTransform(we,Ce){const Fe=we[0]*Ce[0]+we[1]*Ce[2]+Ce[4],Ve=we[0]*Ce[1]+we[1]*Ce[3]+Ce[5];return[Fe,Ve]}static applyInverseTransform(we,Ce){const Fe=Ce[0]*Ce[3]-Ce[1]*Ce[2],Ve=(we[0]*Ce[3]-we[1]*Ce[2]+Ce[2]*Ce[5]-Ce[4]*Ce[3])/Fe,Ye=(-we[0]*Ce[1]+we[1]*Ce[0]+Ce[4]*Ce[1]-Ce[5]*Ce[0])/Fe;return[Ve,Ye]}static getAxialAlignedBoundingBox(we,Ce){const Fe=Ae.applyTransform(we,Ce),Ve=Ae.applyTransform(we.slice(2,4),Ce),Ye=Ae.applyTransform([we[0],we[3]],Ce),We=Ae.applyTransform([we[2],we[1]],Ce);return[Math.min(Fe[0],Ve[0],Ye[0],We[0]),Math.min(Fe[1],Ve[1],Ye[1],We[1]),Math.max(Fe[0],Ve[0],Ye[0],We[0]),Math.max(Fe[1],Ve[1],Ye[1],We[1])]}static inverseTransform(we){const Ce=we[0]*we[3]-we[1]*we[2];return[we[3]/Ce,-we[1]/Ce,-we[2]/Ce,we[0]/Ce,(we[2]*we[5]-we[4]*we[3])/Ce,(we[4]*we[1]-we[5]*we[0])/Ce]}static apply3dTransform(we,Ce){return[we[0]*Ce[0]+we[1]*Ce[1]+we[2]*Ce[2],we[3]*Ce[0]+we[4]*Ce[1]+we[5]*Ce[2],we[6]*Ce[0]+we[7]*Ce[1]+we[8]*Ce[2]]}static singularValueDecompose2dScale(we){const Ce=[we[0],we[2],we[1],we[3]],Fe=we[0]*Ce[0]+we[1]*Ce[2],Ve=we[0]*Ce[1]+we[1]*Ce[3],Ye=we[2]*Ce[0]+we[3]*Ce[2],We=we[2]*Ce[1]+we[3]*Ce[3],Ie=(Fe+We)/2,Oe=Math.sqrt((Fe+We)**2-4*(Fe*We-Ye*Ve))/2,it=Ie+Oe||1,at=Ie-Oe||1;return[Math.sqrt(it),Math.sqrt(at)]}static normalizeRect(we){const Ce=we.slice(0);return we[0]>we[2]&&(Ce[0]=we[2],Ce[2]=we[0]),we[1]>we[3]&&(Ce[1]=we[3],Ce[3]=we[1]),Ce}static intersect(we,Ce){function Fe(Ie,Oe){return Ie-Oe}const Ve=[we[0],we[2],Ce[0],Ce[2]].sort(Fe),Ye=[we[1],we[3],Ce[1],Ce[3]].sort(Fe),We=[];if(we=Ae.normalizeRect(we),Ce=Ae.normalizeRect(Ce),Ve[0]===we[0]&&Ve[1]===Ce[0]||Ve[0]===Ce[0]&&Ve[1]===we[0])We[0]=Ve[1],We[2]=Ve[2];else return null;if(Ye[0]===we[1]&&Ye[1]===Ce[1]||Ye[0]===Ce[1]&&Ye[1]===we[1])We[1]=Ye[1],We[3]=Ye[2];else return null;return We}}n.Util=Ae;const Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function ze(ge){const we=ge.length,Ce=[];if(ge[0]==="þ"&&ge[1]==="ÿ")for(let Fe=2;Fe<we;Fe+=2)Ce.push(String.fromCharCode(ge.charCodeAt(Fe)<<8|ge.charCodeAt(Fe+1)));else if(ge[0]==="ÿ"&&ge[1]==="þ")for(let Fe=2;Fe<we;Fe+=2)Ce.push(String.fromCharCode(ge.charCodeAt(Fe+1)<<8|ge.charCodeAt(Fe)));else for(let Fe=0;Fe<we;++Fe){const Ve=Se[ge.charCodeAt(Fe)];Ce.push(Ve?String.fromCharCode(Ve):ge.charAt(Fe))}return Ce.join("")}function Xe(ge){return ge.replace(/([()\\\n\r])/g,we=>we===`
`?"\\n":we==="\r"?"\\r":`\\${we}`)}function Ue(ge){return/^[\x00-\x7F]*$/.test(ge)}function Ze(ge){const we=["þÿ"];for(let Ce=0,Fe=ge.length;Ce<Fe;Ce++){const Ve=ge.charCodeAt(Ce);we.push(String.fromCharCode(Ve>>8&255)),we.push(String.fromCharCode(Ve&255))}return we.join("")}function He(ge){return decodeURIComponent(escape(ge))}function Je(ge){return unescape(encodeURIComponent(ge))}function nt(ge){return typeof ge=="boolean"}function qe(ge){return typeof ge=="number"}function W(ge){return typeof ge=="string"}function ne(ge){return typeof ge=="object"&&ge!==null&&ge.byteLength!==void 0}function ue(ge,we){if(ge.length!==we.length)return!1;for(let Ce=0,Fe=ge.length;Ce<Fe;Ce++)if(ge[Ce]!==we[Ce])return!1;return!0}function he(ge=new Date){return[ge.getUTCFullYear().toString(),(ge.getUTCMonth()+1).toString().padStart(2,"0"),ge.getUTCDate().toString().padStart(2,"0"),ge.getUTCHours().toString().padStart(2,"0"),ge.getUTCMinutes().toString().padStart(2,"0"),ge.getUTCSeconds().toString().padStart(2,"0")].join("")}function be(){const ge=Object.create(null);let we=!1;return Object.defineProperty(ge,"settled",{get(){return we}}),ge.promise=new Promise(function(Ce,Fe){ge.resolve=function(Ve){we=!0,Ce(Ve)},ge.reject=function(Ve){we=!0,Fe(Ve)}}),ge}function Re(ge,we="",Ce=!1){if(URL.createObjectURL&&!Ce)return URL.createObjectURL(new Blob([ge],{type:we}));const Fe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let Ve=`data:${we};base64,`;for(let Ye=0,We=ge.length;Ye<We;Ye+=3){const Ie=ge[Ye]&255,Oe=ge[Ye+1]&255,it=ge[Ye+2]&255,at=Ie>>2,ht=(Ie&3)<<4|Oe>>4,St=Ye+1<We?(Oe&15)<<2|it>>6:64,Qt=Ye+2<We?it&63:64;Ve+=Fe[at]+Fe[ht]+Fe[St]+Fe[Qt]}return Ve}},(e,n,o)=>{o(4)},(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isNodeJS=void 0;const o=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=o},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultCMapReaderFactory=exports.DefaultCanvasFactory=exports.build=void 0;var _util=__w_pdfjs_require__(2),_display_utils=__w_pdfjs_require__(1),_font_loader=__w_pdfjs_require__(6),_node_utils=__w_pdfjs_require__(7),_annotation_storage=__w_pdfjs_require__(8),_api_compatibility=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(12),_is_node=__w_pdfjs_require__(4),_message_handler=__w_pdfjs_require__(13),_metadata=__w_pdfjs_require__(14),_optional_content_config=__w_pdfjs_require__(15),_transport_stream=__w_pdfjs_require__(16),_webgl=__w_pdfjs_require__(17);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DefaultCanvasFactory=_is_node.isNodeJS?_node_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_is_node.isNodeJS?_node_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let createPDFNetworkStream;function setPDFNetworkStreamFactory(e){createPDFNetworkStream=e}function getDocument(e){const n=new PDFDocumentLoadingTask;let o;if(typeof e=="string"||e instanceof URL)o={url:e};else if((0,_util.isArrayBuffer)(e))o={data:e};else if(e instanceof PDFDataRangeTransport)o={range:e};else{if(typeof e!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");o=e}const t=Object.create(null);let l=null,a=null;for(const s in o){const c=o[s];switch(s){case"url":if(typeof window<"u")try{t[s]=new URL(c,window.location).href;continue}catch(r){(0,_util.warn)(`Cannot create valid URL: "${r}".`)}else if(typeof c=="string"||c instanceof URL){t[s]=c.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":l=c;continue;case"worker":a=c;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&c instanceof Buffer)t[s]=new Uint8Array(c);else{if(c instanceof Uint8Array)break;if(typeof c=="string")t[s]=(0,_util.stringToBytes)(c);else if(typeof c=="object"&&c!==null&&!isNaN(c.length))t[s]=new Uint8Array(c);else if((0,_util.isArrayBuffer)(c))t[s]=new Uint8Array(c);else throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.")}continue}t[s]=c}if(t.rangeChunkSize=t.rangeChunkSize||DEFAULT_RANGE_CHUNK_SIZE,t.CMapReaderFactory=t.CMapReaderFactory||DefaultCMapReaderFactory,t.ignoreErrors=t.stopAtErrors!==!0,t.fontExtraProperties=t.fontExtraProperties===!0,t.pdfBug=t.pdfBug===!0,t.enableXfa=t.enableXfa===!0,(typeof t.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(t.docBaseUrl))&&(t.docBaseUrl=null),Number.isInteger(t.maxImageSize)||(t.maxImageSize=-1),typeof t.isEvalSupported!="boolean"&&(t.isEvalSupported=!0),typeof t.disableFontFace!="boolean"&&(t.disableFontFace=_api_compatibility.apiCompatibilityParams.disableFontFace||!1),typeof t.ownerDocument>"u"&&(t.ownerDocument=globalThis.document),typeof t.disableRange!="boolean"&&(t.disableRange=!1),typeof t.disableStream!="boolean"&&(t.disableStream=!1),typeof t.disableAutoFetch!="boolean"&&(t.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(t.verbosity),!a){const s={verbosity:t.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};a=s.port?PDFWorker.fromPort(s):new PDFWorker(s),n._worker=a}const i=n.docId;return a.promise.then(function(){if(n.destroyed)throw new Error("Loading aborted");const s=_fetchDocument(a,t,l,i),c=new Promise(function(r){let d;l?d=new _transport_stream.PDFDataTransportStream({length:t.length,initialData:t.initialData,progressiveDone:t.progressiveDone,contentDispositionFilename:t.contentDispositionFilename,disableRange:t.disableRange,disableStream:t.disableStream},l):t.data||(d=createPDFNetworkStream({url:t.url,length:t.length,httpHeaders:t.httpHeaders,withCredentials:t.withCredentials,rangeChunkSize:t.rangeChunkSize,disableRange:t.disableRange,disableStream:t.disableStream})),r(d)});return Promise.all([s,c]).then(function([r,d]){if(n.destroyed)throw new Error("Loading aborted");const h=new _message_handler.MessageHandler(i,r,a.port);h.postMessageTransfers=a.postMessageTransfers;const m=new WorkerTransport(h,n,d,t);n._transport=m,h.send("Ready",null)})}).catch(n._capability.reject),n}function _fetchDocument(e,n,o,t){return e.destroyed?Promise.reject(new Error("Worker was destroyed")):(o&&(n.length=o.length,n.initialData=o.initialData,n.progressiveDone=o.progressiveDone,n.contentDispositionFilename=o.contentDispositionFilename),e.messageHandler.sendWithPromise("GetDocRequest",{docId:t,apiVersion:"2.8.335",source:{data:n.data,url:n.url,password:n.password,disableAutoFetch:n.disableAutoFetch,rangeChunkSize:n.rangeChunkSize,length:n.length},maxImageSize:n.maxImageSize,disableFontFace:n.disableFontFace,postMessageTransfers:e.postMessageTransfers,docBaseUrl:n.docBaseUrl,ignoreErrors:n.ignoreErrors,isEvalSupported:n.isEvalSupported,fontExtraProperties:n.fontExtraProperties,enableXfa:n.enableXfa}).then(function(l){if(e.destroyed)throw new Error("Worker was destroyed");return l}))}const PDFDocumentLoadingTask=function(){let n=0;class o{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+n++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}destroy(){return this.destroyed=!0,(this._transport?this._transport.destroy():Promise.resolve()).then(()=>{this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}}return o}();class PDFDataRangeTransport{constructor(n,o,t=!1,l=null){this.length=n,this.initialData=o,this.progressiveDone=t,this.contentDispositionFilename=l,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(n){this._rangeListeners.push(n)}addProgressListener(n){this._progressListeners.push(n)}addProgressiveReadListener(n){this._progressiveReadListeners.push(n)}addProgressiveDoneListener(n){this._progressiveDoneListeners.push(n)}onDataRange(n,o){for(const t of this._rangeListeners)t(n,o)}onDataProgress(n,o){this._readyCapability.promise.then(()=>{for(const t of this._progressListeners)t(n,o)})}onDataProgressiveRead(n){this._readyCapability.promise.then(()=>{for(const o of this._progressiveReadListeners)o(n)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const n of this._progressiveDoneListeners)n()})}transportReady(){this._readyCapability.resolve()}requestDataRange(n,o){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(n,o){this._pdfInfo=n,this._transport=o}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get numPages(){return this._pdfInfo.numPages}get fingerprint(){return this._pdfInfo.fingerprint}get isPureXfa(){return this._pdfInfo.isPureXfa}getPage(n){return this._transport.getPage(n)}getPageIndex(n){return this._transport.getPageIndex(n)}getDestinations(){return this._transport.getDestinations()}getDestination(n){return this._transport.getDestination(n)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}getStats(){return this._transport.getStats()}cleanup(n=!1){return this._transport.startCleanup(n||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(n){return this._transport.saveDocument(n)}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(n,o,t,l,a=!1){this._pageIndex=n,this._pageInfo=o,this._ownerDocument=l,this._transport=t,this._stats=a?new _display_utils.StatTimer:null,this._pdfBug=a,this.commonObjs=t.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:n,rotation:o=this.rotate,offsetX:t=0,offsetY:l=0,dontFlip:a=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:n,rotation:o,offsetX:t,offsetY:l,dontFlip:a})}getAnnotations({intent:n=null}={}){return(!this._annotationsPromise||this._annotationsIntent!==n)&&(this._annotationsPromise=this._transport.getAnnotations(this._pageIndex,n),this._annotationsIntent=n),this._annotationsPromise}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}getXfa(){return this._xfaPromise||(this._xfaPromise=this._transport.getPageXfa(this._pageIndex))}render({canvasContext:n,viewport:o,intent:t="display",enableWebGL:l=!1,renderInteractiveForms:a=!1,transform:i=null,imageLayer:s=null,canvasFactory:c=null,background:r=null,annotationStorage:d=null,optionalContentConfigPromise:h=null}){var m;this._stats&&this._stats.time("Overall");const f=t==="print"?"print":"display";this.pendingCleanup=!1,h||(h=this._transport.getOptionalContentConfig());let g=this._intentStates.get(f);g||(g=Object.create(null),this._intentStates.set(f,g)),g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null);const x=c||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),b=new _webgl.WebGLContext({enable:l});g.displayReadyCapability||(g.displayReadyCapability=(0,_util.createPromiseCapability)(),g.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:f,renderInteractiveForms:a===!0,annotationStorage:(d==null?void 0:d.serializable)||null}));const A=C=>{g.renderTasks.delete(M),(this.cleanupAfterRender||f==="print")&&(this.pendingCleanup=!0),this._tryCleanup(),C?(M.capability.reject(C),this._abortOperatorList({intentState:g,reason:C})):M.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},M=new InternalRenderTask({callback:A,params:{canvasContext:n,viewport:o,transform:i,imageLayer:s,background:r},objs:this.objs,commonObjs:this.commonObjs,operatorList:g.operatorList,pageIndex:this._pageIndex,canvasFactory:x,webGLContext:b,useRequestAnimationFrame:f!=="print",pdfBug:this._pdfBug});((m=g).renderTasks||(m.renderTasks=new Set)).add(M);const L=M.task;return Promise.all([g.displayReadyCapability.promise,h]).then(([C,u])=>{if(this.pendingCleanup){A();return}this._stats&&this._stats.time("Rendering"),M.initializeGraphics({transparency:C,optionalContentConfig:u}),M.operatorListChanged()}).catch(A),L}getOperatorList(){function n(){t.operatorList.lastChunk&&(t.opListReadCapability.resolve(t.operatorList),t.renderTasks.delete(l))}const o="oplist";let t=this._intentStates.get(o);t||(t=Object.create(null),this._intentStates.set(o,t));let l;if(!t.opListReadCapability){var a;l=Object.create(null),l.operatorListChanged=n,t.opListReadCapability=(0,_util.createPromiseCapability)(),((a=t).renderTasks||(a.renderTasks=new Set)).add(l),t.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:o})}return t.opListReadCapability.promise}streamTextContent({normalizeWhitespace:n=!1,disableCombineTextItems:o=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,normalizeWhitespace:n===!0,combineTextItems:o!==!0},{highWaterMark:100,size(l){return l.items.length}})}getTextContent(n={}){const o=this.streamTextContent(n);return new Promise(function(t,l){function a(){i.read().then(function({value:c,done:r}){if(r){t(s);return}Object.assign(s.styles,c.styles),s.items.push(...c.items),a()},l)}const i=o.getReader(),s={items:[],styles:Object.create(null)};a()})}_destroy(){this.destroyed=!0,this._transport.pageCache[this._pageIndex]=null;const n=[];for(const[o,t]of this._intentStates)if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),o!=="oplist")for(const l of t.renderTasks)n.push(l.completed),l.cancel();return this.objs.clear(),this._annotationsPromise=null,this._jsActionsPromise=null,this._xfaPromise=null,this.pendingCleanup=!1,Promise.all(n)}cleanup(n=!1){return this.pendingCleanup=!0,this._tryCleanup(n)}_tryCleanup(n=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:o,operatorList:t}of this._intentStates.values())if(o.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this._annotationsPromise=null,this._jsActionsPromise=null,this._xfaPromise=null,n&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,!0}_startRenderPage(n,o){const t=this._intentStates.get(o);t&&(this._stats&&this._stats.timeEnd("Page Request"),t.displayReadyCapability&&t.displayReadyCapability.resolve(n))}_renderPageChunk(n,o){for(let t=0,l=n.length;t<l;t++)o.operatorList.fnArray.push(n.fnArray[t]),o.operatorList.argsArray.push(n.argsArray[t]);o.operatorList.lastChunk=n.lastChunk;for(const t of o.renderTasks)t.operatorListChanged();n.lastChunk&&this._tryCleanup()}_pumpOperatorList(n){(0,_util.assert)(n.intent,'PDFPageProxy._pumpOperatorList: Expected "intent" argument.');const t=this._transport.messageHandler.sendWithStream("GetOperatorList",n).getReader(),l=this._intentStates.get(n.intent);l.streamReader=t;const a=()=>{t.read().then(({value:i,done:s})=>{if(s){l.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(i,l),a())},i=>{if(l.streamReader=null,!this._transport.destroyed){if(l.operatorList){l.operatorList.lastChunk=!0;for(const s of l.renderTasks)s.operatorListChanged();this._tryCleanup()}if(l.displayReadyCapability)l.displayReadyCapability.reject(i);else if(l.opListReadCapability)l.opListReadCapability.reject(i);else throw i}})};a()}_abortOperatorList({intentState:n,reason:o,force:t=!1}){if((0,_util.assert)(o instanceof Error||typeof o=="object"&&o!==null,'PDFPageProxy._abortOperatorList: Expected "reason" argument.'),!!n.streamReader){if(!t){if(n.renderTasks.size>0)return;if(o instanceof _display_utils.RenderingCancelledException){n.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:n,reason:o,force:!0}),n.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(n.streamReader.cancel(new _util.AbortException(o==null?void 0:o.message)),n.streamReader=null,!this._transport.destroyed){for(const[l,a]of this._intentStates)if(a===n){this._intentStates.delete(l);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve(void 0)}postMessage(n,o){function t(i){var r;if(typeof i!="object"||i===null)return i;if(l.has(i))return l.get(i);let s,c;if((s=i.buffer)&&(0,_util.isArrayBuffer)(s))return o!=null&&o.includes(s)?c=new i.constructor(s,i.byteOffset,i.byteLength):c=new i.constructor(i),l.set(i,c),c;if(i instanceof Map){c=new Map,l.set(i,c);for(const[d,h]of i)c.set(d,t(h));return c}if(i instanceof Set){c=new Set,l.set(i,c);for(const d of i)c.add(t(d));return c}c=Array.isArray(i)?[]:{},l.set(i,c);for(const d in i){let h,m=i;for(;!(h=Object.getOwnPropertyDescriptor(m,d));)m=Object.getPrototypeOf(m);if(!(typeof h.value>"u")){if(typeof h.value=="function"){if((r=i.hasOwnProperty)!=null&&r.call(i,d))throw new Error(`LoopbackPort.postMessage - cannot clone: ${i[d]}`);continue}c[d]=t(h.value)}}return c}const l=new WeakMap,a={data:t(n)};this._deferred.then(()=>{for(const i of this._listeners)i.call(this,a)})}addEventListener(n,o){this._listeners.push(o)}removeEventListener(n,o){const t=this._listeners.indexOf(o);this._listeners.splice(t,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorker=function PDFWorkerClosure(){var e;const pdfWorkerPorts=new WeakMap;let isWorkerDisabled=!1,fallbackWorkerSrc,nextFakeWorkerId=0,fakeWorkerCapability;if(_is_node.isNodeJS&&typeof require=="function")isWorkerDisabled=!0,fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"&&"currentScript"in document){const n=(e=document.currentScript)==null?void 0:e.src;n&&(fallbackWorkerSrc=n.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}function getWorkerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(typeof fallbackWorkerSrc<"u")return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}function getMainThreadWorkerMessageHandler(){var o;let n;try{n=(o=globalThis.pdfjsWorker)==null?void 0:o.WorkerMessageHandler}catch{}return n||null}function setupFakeWorkerGlobal(){if(fakeWorkerCapability)return fakeWorkerCapability.promise;fakeWorkerCapability=(0,_util.createPromiseCapability)();const loader=async function(){const mainWorkerMessageHandler=getMainThreadWorkerMessageHandler();if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof require=="function"){const worker=eval("require")(getWorkerSrc());return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(getWorkerSrc()),window.pdfjsWorker.WorkerMessageHandler};return loader().then(fakeWorkerCapability.resolve,fakeWorkerCapability.reject),fakeWorkerCapability.promise}function createCDNWrapper(n){const o="importScripts('"+n+"');";return URL.createObjectURL(new Blob([o]))}class PDFWorker{constructor({name:o=null,port:t=null,verbosity:l=(0,_util.getVerbosityLevel)()}={}){if(t&&pdfWorkerPorts.has(t))throw new Error("Cannot use more than one PDFWorker per port");if(this.name=o,this.destroyed=!1,this.postMessageTransfers=!0,this.verbosity=l,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,t){pdfWorkerPorts.set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(o){this._port=o,this._messageHandler=new _message_handler.MessageHandler("main","worker",o),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(typeof Worker<"u"&&!isWorkerDisabled&&!getMainThreadWorkerMessageHandler()){let o=getWorkerSrc();try{(0,_util.isSameOrigin)(window.location.href,o)||(o=createCDNWrapper(new URL(o,window.location).href));const t=new Worker(o),l=new _message_handler.MessageHandler("main","worker",t),a=()=>{t.removeEventListener("error",i),l.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=()=>{this._webWorker||a()};t.addEventListener("error",i),l.on("test",c=>{if(t.removeEventListener("error",i),this.destroyed){a();return}c?(this._messageHandler=l,this._port=t,this._webWorker=t,c.supportTransfers||(this.postMessageTransfers=!1),this._readyCapability.resolve(),l.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),l.destroy(),t.terminate())}),l.on("ready",c=>{if(t.removeEventListener("error",i),this.destroyed){a();return}try{s()}catch{this._setupFakeWorker()}});const s=()=>{const c=new Uint8Array([this.postMessageTransfers?255:0]);try{l.send("test",c,[c.buffer])}catch{(0,_util.warn)("Cannot use postMessage transfers."),c[0]=0,l.send("test",c)}};s();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),isWorkerDisabled=!0),setupFakeWorkerGlobal().then(o=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this._port=t;const l="fake"+nextFakeWorkerId++,a=new _message_handler.MessageHandler(l+"_worker",l,t);o.setup(a,t);const i=new _message_handler.MessageHandler(l,l+"_worker",t);this._messageHandler=i,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})}).catch(o=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${o.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),pdfWorkerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(o){if(!o||!o.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return pdfWorkerPorts.has(o.port)?pdfWorkerPorts.get(o.port):new PDFWorker(o)}static getWorkerSrc(){return getWorkerSrc()}}return PDFWorker}();exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(n,o,t,l){this.messageHandler=n,this.loadingTask=o,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:o.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:l.ownerDocument}),this._params=l,this.CMapReaderFactory=new l.CMapReaderFactory({baseUrl:l.cMapUrl,isCompressed:l.cMapPacked}),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=t,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get loadingTaskSettled(){return this.loadingTask._capability.settled}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const n=[];this.pageCache.forEach(function(t){t&&n.push(t._destroy())}),this.pageCache.length=0,this.pagePromises.length=0;const o=this.messageHandler.sendWithPromise("Terminate",null);if(n.push(o),this.loadingTaskSettled){const t=this.loadingTask.promise.then(l=>{l.hasOwnProperty("annotationStorage")&&l.annotationStorage.resetModified()}).catch(()=>{});n.push(t)}return Promise.all(n).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:n,loadingTask:o}=this;n.on("GetReader",(t,l)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},l.onPull=()=>{this._fullReader.read().then(function({value:a,done:i}){if(i){l.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(a),"GetReader - expected an ArrayBuffer."),l.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{l.error(a)})},l.onCancel=a=>{this._fullReader.cancel(a),l.ready.catch(i=>{if(!this.destroyed)throw i})}}),n.on("ReaderHeadersReady",t=>{const l=(0,_util.createPromiseCapability)(),a=this._fullReader;return a.headersReady.then(()=>{(!a.isStreamingSupported||!a.isRangeSupported)&&(this._lastProgress&&o.onProgress&&o.onProgress(this._lastProgress),a.onProgress=i=>{o.onProgress&&o.onProgress({loaded:i.loaded,total:i.total})}),l.resolve({isStreamingSupported:a.isStreamingSupported,isRangeSupported:a.isRangeSupported,contentLength:a.contentLength})},l.reject),l.promise}),n.on("GetRangeReader",(t,l)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(t.begin,t.end);if(!a){l.close();return}l.onPull=()=>{a.read().then(function({value:i,done:s}){if(s){l.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(i),"GetRangeReader - expected an ArrayBuffer."),l.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{l.error(i)})},l.onCancel=i=>{a.cancel(i),l.ready.catch(s=>{if(!this.destroyed)throw s})}}),n.on("GetDoc",({pdfInfo:t})=>{this._numPages=t.numPages,o._capability.resolve(new PDFDocumentProxy(t,this))}),n.on("DocException",function(t){let l;switch(t.name){case"PasswordException":l=new _util.PasswordException(t.message,t.code);break;case"InvalidPDFException":l=new _util.InvalidPDFException(t.message);break;case"MissingPDFException":l=new _util.MissingPDFException(t.message);break;case"UnexpectedResponseException":l=new _util.UnexpectedResponseException(t.message,t.status);break;case"UnknownErrorException":l=new _util.UnknownErrorException(t.message,t.details);break}l instanceof Error||(0,_util.warn)("DocException - expected a valid Error."),o._capability.reject(l)}),n.on("PasswordRequest",t=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),o.onPassword){const l=a=>{this._passwordCapability.resolve({password:a})};try{o.onPassword(l,t.code)}catch(a){this._passwordCapability.reject(a)}}else this._passwordCapability.reject(new _util.PasswordException(t.message,t.code));return this._passwordCapability.promise}),n.on("DataLoaded",t=>{o.onProgress&&o.onProgress({loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)}),n.on("StartRenderPage",t=>{if(this.destroyed)return;this.pageCache[t.pageIndex]._startRenderPage(t.transparency,t.intent)}),n.on("commonobj",t=>{var s;if(this.destroyed)return;const[l,a,i]=t;if(!this.commonObjs.has(l))switch(a){case"Font":const c=this._params;if("error"in i){const h=i.error;(0,_util.warn)(`Error during font loading: ${h}`),this.commonObjs.resolve(l,h);break}let r=null;c.pdfBug&&((s=globalThis.FontInspector)!=null&&s.enabled)&&(r={registerFont(h,m){globalThis.FontInspector.fontAdded(h,m)}});const d=new _font_loader.FontFaceObject(i,{isEvalSupported:c.isEvalSupported,disableFontFace:c.disableFontFace,ignoreErrors:c.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:r});this.fontLoader.bind(d).catch(h=>n.sendWithPromise("FontFallback",{id:l})).finally(()=>{!c.fontExtraProperties&&d.data&&(d.data=null),this.commonObjs.resolve(l,d)});break;case"FontPath":case"Image":this.commonObjs.resolve(l,i);break;default:throw new Error(`Got unknown common object type ${a}`)}}),n.on("obj",t=>{var r;if(this.destroyed)return;const[l,a,i,s]=t,c=this.pageCache[a];if(!c.objs.has(l))switch(i){case"Image":c.objs.resolve(l,s),((r=s==null?void 0:s.data)==null?void 0:r.length)>8e6&&(c.cleanupAfterRender=!0);break;default:throw new Error(`Got unknown object type ${i}`)}}),n.on("DocProgress",t=>{this.destroyed||o.onProgress&&o.onProgress({loaded:t.loaded,total:t.total})}),n.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),n.on("FetchBuiltInCMap",(t,l)=>{if(this.destroyed){l.error(new Error("Worker was destroyed"));return}let a=!1;l.onPull=()=>{if(a){l.close();return}a=!0,this.CMapReaderFactory.fetch(t).then(function(i){l.enqueue(i,1,[i.cMapData.buffer])}).catch(function(i){l.error(i)})}})}_onUnsupportedFeature({featureId:n}){this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(n)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(n){if(!Number.isInteger(n)||n<=0||n>this._numPages)return Promise.reject(new Error("Invalid page request"));const o=n-1;if(o in this.pagePromises)return this.pagePromises[o];const t=this.messageHandler.sendWithPromise("GetPage",{pageIndex:o}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");const a=new PDFPageProxy(o,l,this,this._params.ownerDocument,this._params.pdfBug);return this.pageCache[o]=a,a});return this.pagePromises[o]=t,t}getPageIndex(n){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:n}).catch(function(o){return Promise.reject(new Error(o))})}getAnnotations(n,o){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:n,intent:o})}saveDocument(n){var o;return this.messageHandler.sendWithPromise("SaveDocument",{numPages:this._numPages,annotationStorage:(n==null?void 0:n.serializable)||null,filename:((o=this._fullReader)==null?void 0:o.filename)??null}).finally(()=>{n&&n.resetModified()})}getFieldObjects(){return this.messageHandler.sendWithPromise("GetFieldObjects",null)}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(n){return typeof n!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:n})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(n){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:n})}getPageXfa(n){return this.messageHandler.sendWithPromise("GetPageXfa",{pageIndex:n})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(n=>new _optional_content_config.OptionalContentConfig(n))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.messageHandler.sendWithPromise("GetMetadata",null).then(n=>{var o,t;return{info:n[0],metadata:n[1]?new _metadata.Metadata(n[1]):null,contentDispositionFilename:((o=this._fullReader)==null?void 0:o.filename)??null,contentLength:((t=this._fullReader)==null?void 0:t.contentLength)??null}})}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}getStats(){return this.messageHandler.sendWithPromise("GetStats",null)}async startCleanup(n=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(let o=0,t=this.pageCache.length;o<t;o++){const l=this.pageCache[o];if(!l)continue;if(!l.cleanup())throw new Error(`startCleanup: Page ${o+1} is currently rendering.`)}this.commonObjs.clear(),n||this.fontLoader.clear(),this._hasJSActionsPromise=null}}get loadingParams(){const n=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:n.disableAutoFetch,disableFontFace:n.disableFontFace})}}class PDFObjects{constructor(){this._objs=Object.create(null)}_ensureObj(n){return this._objs[n]?this._objs[n]:this._objs[n]={capability:(0,_util.createPromiseCapability)(),data:null,resolved:!1}}get(n,o=null){if(o)return this._ensureObj(n).capability.promise.then(o),null;const t=this._objs[n];if(!t||!t.resolved)throw new Error(`Requesting object that isn't resolved yet ${n}.`);return t.data}has(n){const o=this._objs[n];return(o==null?void 0:o.resolved)||!1}resolve(n,o){const t=this._ensureObj(n);t.resolved=!0,t.data=o,t.capability.resolve(o)}clear(){this._objs=Object.create(null)}}class RenderTask{constructor(n){this._internalRenderTask=n,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}const InternalRenderTask=function e(){const n=new WeakSet;class o{constructor({callback:l,params:a,objs:i,commonObjs:s,operatorList:c,pageIndex:r,canvasFactory:d,webGLContext:h,useRequestAnimationFrame:m=!1,pdfBug:f=!1}){this.callback=l,this.params=a,this.objs=i,this.commonObjs=s,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=r,this.canvasFactory=d,this.webGLContext=h,this._pdfBug=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=a.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:a}){var h;if(this.cancelled)return;if(this._canvas){if(n.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");n.add(this._canvas)}this._pdfBug&&((h=globalThis.StepperManager)!=null&&h.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:c,imageLayer:r,background:d}=this.params;this.gfx=new _canvas.CanvasGraphics(i,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext,r,a),this.gfx.beginDrawing({transform:c,viewport:s,transparency:l,background:d}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(l=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&n.delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&n.delete(this._canvas),this.callback())))}}return o}(),version="2.8.335";exports.version=version;const build="228adbf67";exports.build=build},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var t=o(2);class l{constructor({docId:c,onUnsupportedFeature:r,ownerDocument:d=globalThis.document}){this.constructor===l&&(0,t.unreachable)("Cannot initialize BaseFontLoader."),this.docId=c,this._onUnsupportedFeature=r,this._document=d,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(c){this.nativeFontFaces.push(c),this._document.fonts.add(c)}insertRule(c){let r=this.styleElement;r||(r=this.styleElement=this._document.createElement("style"),r.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].appendChild(r));const d=r.sheet;d.insertRule(c,d.cssRules.length)}clear(){this.nativeFontFaces.forEach(c=>{this._document.fonts.delete(c)}),this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(c){if(c.attached||c.missingFile)return;if(c.attached=!0,this.isFontLoadingAPISupported){const d=c.createNativeFontFace();if(d){this.addNativeFontFace(d);try{await d.loaded}catch(h){throw this._onUnsupportedFeature({featureId:t.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,t.warn)(`Failed to load font '${d.family}': '${h}'.`),c.disableFontFace=!0,h}}return}const r=c.createFontFaceRule();if(r){if(this.insertRule(r),this.isSyncFontLoadingSupported)return;await new Promise(d=>{const h=this._queueLoadingCallback(d);this._prepareFontLoadEvent([r],[c],h)})}}_queueLoadingCallback(c){(0,t.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var c;return(0,t.shadow)(this,"isFontLoadingAPISupported",!!((c=this._document)!=null&&c.fonts))}get isSyncFontLoadingSupported(){(0,t.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,t.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(c,r,d){(0,t.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let a;n.FontLoader=a,n.FontLoader=a=class extends l{constructor(c){super(c),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let c=!1;if(typeof navigator>"u")c=!0;else{const r=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(r==null?void 0:r[1])>=14&&(c=!0)}return(0,t.shadow)(this,"isSyncFontLoadingSupported",c)}_queueLoadingCallback(c){function r(){for((0,t.assert)(!h.done,"completeRequest() cannot be called twice."),h.done=!0;d.requests.length>0&&d.requests[0].done;){const m=d.requests.shift();setTimeout(m.callback,0)}}const d=this.loadingContext,h={id:`pdfjs-font-loading-${d.nextRequestId++}`,done:!1,complete:r,callback:c};return d.requests.push(h),h}get _loadTestFont(){const c=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,t.shadow)(this,"_loadTestFont",c())}_prepareFontLoadEvent(c,r,d){function h(F,K){return F.charCodeAt(K)<<24|F.charCodeAt(K+1)<<16|F.charCodeAt(K+2)<<8|F.charCodeAt(K+3)&255}function m(F,K,Q,Z){const B=F.substring(0,K),G=F.substring(K+Q);return B+Z+G}let f,g;const x=this._document.createElement("canvas");x.width=1,x.height=1;const b=x.getContext("2d");let A=0;function M(F,K){if(A++,A>30){(0,t.warn)("Load test font never loaded."),K();return}if(b.font="30px "+F,b.fillText(".",0,20),b.getImageData(0,0,1,1).data[3]>0){K();return}setTimeout(M.bind(null,F,K))}const L=`lt${Date.now()}${this.loadTestFontId++}`;let C=this._loadTestFont;C=m(C,976,L.length,L);const _=16,y=1482184792;let v=h(C,_);for(f=0,g=L.length-3;f<g;f+=4)v=v-y+h(L,f)|0;f<L.length&&(v=v-y+h(L+"XXX",f)|0),C=m(C,_,4,(0,t.string32)(v));const T=`url(data:font/opentype;base64,${btoa(C)});`,k=`@font-face {font-family:"${L}";src:${T}}`;this.insertRule(k);const P=[];for(f=0,g=r.length;f<g;f++)P.push(r[f].loadedName);P.push(L);const S=this._document.createElement("div");for(S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px",f=0,g=P.length;f<g;++f){const F=this._document.createElement("span");F.textContent="Hi",F.style.fontFamily=P[f],S.appendChild(F)}this._document.body.appendChild(S),M(L,()=>{this._document.body.removeChild(S),d.complete()})}};class i{constructor(c,{isEvalSupported:r=!0,disableFontFace:d=!1,ignoreErrors:h=!1,onUnsupportedFeature:m,fontRegistry:f=null}){this.compiledGlyphs=Object.create(null);for(const g in c)this[g]=c[g];this.isEvalSupported=r!==!1,this.disableFontFace=d===!0,this.ignoreErrors=h===!0,this._onUnsupportedFeature=m,this.fontRegistry=f}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;const c=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),c}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const c=(0,t.bytesToString)(new Uint8Array(this.data)),r=`url(data:${this.mimetype};base64,${btoa(c)});`,d=`@font-face {font-family:"${this.loadedName}";src:${r}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,r),d}getPathGenerator(c,r){if(this.compiledGlyphs[r]!==void 0)return this.compiledGlyphs[r];let d,h;try{d=c.get(this.loadedName+"_path_"+r)}catch(m){if(!this.ignoreErrors)throw m;return this._onUnsupportedFeature({featureId:t.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,t.warn)(`getPathGenerator - ignoring character: "${m}".`),this.compiledGlyphs[r]=function(f,g){}}if(this.isEvalSupported&&t.IsEvalSupportedCached.value){let m,f="";for(let g=0,x=d.length;g<x;g++)h=d[g],h.args!==void 0?m=h.args.join(","):m="",f+="c."+h.cmd+"("+m+`);
`;return this.compiledGlyphs[r]=new Function("c","size",f)}return this.compiledGlyphs[r]=function(m,f){for(let g=0,x=d.length;g<x;g++)h=d[g],h.cmd==="scale"&&(h.args=[f,-f]),m[h.cmd].apply(m,h.args)}}}n.FontFaceObject=i},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeCMapReaderFactory=n.NodeCanvasFactory=void 0;var t=o(1),l=o(4),a=o(2);let i=class{constructor(){(0,a.unreachable)("Not implemented: NodeCanvasFactory")}};n.NodeCanvasFactory=i;let s=class{constructor(){(0,a.unreachable)("Not implemented: NodeCMapReaderFactory")}};n.NodeCMapReaderFactory=s,l.isNodeJS&&(n.NodeCanvasFactory=i=class extends t.BaseCanvasFactory{create(c,r){if(c<=0||r<=0)throw new Error("Invalid canvas size");const h=require("canvas").createCanvas(c,r);return{canvas:h,context:h.getContext("2d")}}},n.NodeCMapReaderFactory=s=class extends t.BaseCMapReaderFactory{_fetchData(c,r){return new Promise((d,h)=>{require("fs").readFile(c,(f,g)=>{if(f||!g){h(new Error(f));return}d({cMapData:new Uint8Array(g),compressionType:r})})})}})},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationStorage=void 0;var t=o(1),l=o(2);class a{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(s,c){const r=this._storage.get(s);return r!==void 0?r:c}getOrCreateValue(s,c){return(0,t.deprecated)("Use getValue instead."),this._storage.has(s)?this._storage.get(s):(this._storage.set(s,c),c)}setValue(s,c){const r=this._storage.get(s);let d=!1;if(r!==void 0)for(const[h,m]of Object.entries(c))r[h]!==m&&(d=!0,r[h]=m);else this._storage.set(s,c),d=!0;d&&this._setModified()}getAll(){return this._storage.size>0?(0,l.objectFromMap)(this._storage):null}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get serializable(){return this._storage.size>0?this._storage:null}}n.AnnotationStorage=a},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.apiCompatibilityParams=void 0;var t=o(4);const l=Object.create(null);(function(){t.isNodeJS&&(l.disableFontFace=!0)})();const a=Object.freeze(l);n.apiCompatibilityParams=a},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var t=o(2),l=o(11);const a=16,i=100,s=4096,c=1e3,r=16,d=1.000001;function h(b){if(!b.mozCurrentTransform){b._originalSave=b.save,b._originalRestore=b.restore,b._originalRotate=b.rotate,b._originalScale=b.scale,b._originalTranslate=b.translate,b._originalTransform=b.transform,b._originalSetTransform=b.setTransform,b._originalResetTransform=b.resetTransform,b._transformMatrix=b._transformMatrix||[1,0,0,1,0,0],b._transformStack=[];try{const A=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(b),"lineWidth");b._setLineWidth=A.set,b._getLineWidth=A.get,Object.defineProperty(b,"lineWidth",{set:function(L){this._setLineWidth(L*d)},get:function(){return this._getLineWidth()}})}catch{}Object.defineProperty(b,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(b,"mozCurrentTransformInverse",{get:function(){const M=this._transformMatrix,L=M[0],C=M[1],u=M[2],_=M[3],y=M[4],v=M[5],T=L*_-C*u,k=C*u-L*_;return[_/T,C/k,u/k,L/T,(_*y-u*v)/k,(C*y-L*v)/T]}}),b.save=function(){const M=this._transformMatrix;this._transformStack.push(M),this._transformMatrix=M.slice(0,6),this._originalSave()},b.restore=function(){const M=this._transformStack.pop();M&&(this._transformMatrix=M,this._originalRestore())},b.translate=function(M,L){const C=this._transformMatrix;C[4]=C[0]*M+C[2]*L+C[4],C[5]=C[1]*M+C[3]*L+C[5],this._originalTranslate(M,L)},b.scale=function(M,L){const C=this._transformMatrix;C[0]=C[0]*M,C[1]=C[1]*M,C[2]=C[2]*L,C[3]=C[3]*L,this._originalScale(M,L)},b.transform=function(M,L,C,u,_,y){const v=this._transformMatrix;this._transformMatrix=[v[0]*M+v[2]*L,v[1]*M+v[3]*L,v[0]*C+v[2]*u,v[1]*C+v[3]*u,v[0]*_+v[2]*y+v[4],v[1]*_+v[3]*y+v[5]],b._originalTransform(M,L,C,u,_,y)},b.setTransform=function(M,L,C,u,_,y){this._transformMatrix=[M,L,C,u,_,y],b._originalSetTransform(M,L,C,u,_,y)},b.resetTransform=function(){this._transformMatrix=[1,0,0,1,0,0],b._originalResetTransform()},b.rotate=function(M){const L=Math.cos(M),C=Math.sin(M),u=this._transformMatrix;this._transformMatrix=[u[0]*L+u[2]*C,u[1]*L+u[3]*C,u[0]*-C+u[2]*L,u[1]*-C+u[3]*L,u[4],u[5]],this._originalRotate(M)}}}const m=function(){function A(M){this.canvasFactory=M,this.cache=Object.create(null)}return A.prototype={getCanvas:function(L,C,u,_){let y;return this.cache[L]!==void 0?(y=this.cache[L],this.canvasFactory.reset(y,C,u),y.context.setTransform(1,0,0,1,0,0)):(y=this.canvasFactory.create(C,u),this.cache[L]=y),_&&h(y.context),y},clear(){for(const M in this.cache){const L=this.cache[M];this.canvasFactory.destroy(L),delete this.cache[M]}}},A}();function f(b){const M=b.width,L=b.height,C=M+1;let u,_,y,v;const T=new Uint8Array(C*(L+1)),k=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),P=M+7&-8,S=b.data,F=new Uint8Array(P*L);let K=0;for(u=0,_=S.length;u<_;u++){const w=S[u];let D=128;for(;D>0;)F[K++]=w&D?0:255,D>>=1}let Q=0;for(K=0,F[K]!==0&&(T[0]=1,++Q),y=1;y<M;y++)F[K]!==F[K+1]&&(T[y]=F[K]?2:1,++Q),K++;for(F[K]!==0&&(T[y]=2,++Q),u=1;u<L;u++){K=u*P,v=u*C,F[K-P]!==F[K]&&(T[v]=F[K]?1:8,++Q);let w=(F[K]?4:0)+(F[K-P]?8:0);for(y=1;y<M;y++)w=(w>>2)+(F[K+1]?4:0)+(F[K-P+1]?8:0),k[w]&&(T[v+y]=k[w],++Q),K++;if(F[K-P]!==F[K]&&(T[v+y]=F[K]?2:4,++Q),Q>1e3)return null}for(K=P*(L-1),v=u*C,F[K]!==0&&(T[v]=8,++Q),y=1;y<M;y++)F[K]!==F[K+1]&&(T[v+y]=F[K]?4:8,++Q),K++;if(F[K]!==0&&(T[v+y]=4,++Q),Q>1e3)return null;const Z=new Int32Array([0,C,-1,0,-C,0,0,0,1]),B=[];for(u=0;Q&&u<=L;u++){let w=u*C;const D=w+M;for(;w<D&&!T[w];)w++;if(w===D)continue;const U=[w%C,u],q=w;let j=T[w];do{const Y=Z[j];do w+=Y;while(!T[w]);const J=T[w];J!==5&&J!==10?(j=J,T[w]=0):(j=J&51*j>>4,T[w]&=j>>2|j<<2),U.push(w%C),U.push(w/C|0),T[w]||--Q}while(q!==w);B.push(U),--u}return function(w){w.save(),w.scale(1/M,-1/L),w.translate(0,-L),w.beginPath();for(let D=0,U=B.length;D<U;D++){const q=B[D];w.moveTo(q[0],q[1]);for(let j=2,Y=q.length;j<Y;j+=2)w.lineTo(q[j],q[j+1])}w.fill(),w.beginPath(),w.restore()}}const g=function(){function A(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=t.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=t.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=t.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null,this.transferMaps=null}return A.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(L,C){this.x=L,this.y=C}},A}(),x=function(){function L(B,G,w,D,U,q,j){this.ctx=B,this.current=new g,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=G,this.objs=w,this.canvasFactory=D,this.webGLContext=U,this.imageLayer=q,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=j,this.cachedCanvases=new m(this.canvasFactory),B&&h(B),this._cachedGetSinglePixelWidth=null}function C(B,G,w=null){if(typeof ImageData<"u"&&G instanceof ImageData){B.putImageData(G,0,0);return}const D=G.height,U=G.width,q=D%r,j=(D-q)/r,Y=q===0?j:j+1,J=B.createImageData(U,r);let oe=0,pe;const me=G.data,Ee=J.data;let X,N,te,re,se,ve,ee,le;if(w)switch(w.length){case 1:se=w[0],ve=w[0],ee=w[0],le=w[0];break;case 4:se=w[0],ve=w[1],ee=w[2],le=w[3];break}if(G.kind===t.ImageKind.GRAYSCALE_1BPP){const H=me.byteLength,I=new Uint32Array(Ee.buffer,0,Ee.byteLength>>2),O=I.length,ae=U+7>>3;let _e=4294967295,Ae=t.IsLittleEndianCached.value?4278190080:255;for(le&&le[0]===255&&le[255]===0&&([_e,Ae]=[Ae,_e]),X=0;X<Y;X++){for(te=X<j?r:q,pe=0,N=0;N<te;N++){const Se=H-oe;let ze=0;const Xe=Se>ae?U:Se*8-7,Ue=Xe&-8;let Ze=0,He=0;for(;ze<Ue;ze+=8)He=me[oe++],I[pe++]=He&128?_e:Ae,I[pe++]=He&64?_e:Ae,I[pe++]=He&32?_e:Ae,I[pe++]=He&16?_e:Ae,I[pe++]=He&8?_e:Ae,I[pe++]=He&4?_e:Ae,I[pe++]=He&2?_e:Ae,I[pe++]=He&1?_e:Ae;for(;ze<Xe;ze++)Ze===0&&(He=me[oe++],Ze=128),I[pe++]=He&Ze?_e:Ae,Ze>>=1}for(;pe<O;)I[pe++]=0;B.putImageData(J,0,X*r)}}else if(G.kind===t.ImageKind.RGBA_32BPP){const H=!!(se||ve||ee);for(N=0,re=U*r*4,X=0;X<j;X++){if(Ee.set(me.subarray(oe,oe+re)),oe+=re,H)for(let I=0;I<re;I+=4)se&&(Ee[I+0]=se[Ee[I+0]]),ve&&(Ee[I+1]=ve[Ee[I+1]]),ee&&(Ee[I+2]=ee[Ee[I+2]]);B.putImageData(J,0,N),N+=r}if(X<Y){if(re=U*q*4,Ee.set(me.subarray(oe,oe+re)),H)for(let I=0;I<re;I+=4)se&&(Ee[I+0]=se[Ee[I+0]]),ve&&(Ee[I+1]=ve[Ee[I+1]]),ee&&(Ee[I+2]=ee[Ee[I+2]]);B.putImageData(J,0,N)}}else if(G.kind===t.ImageKind.RGB_24BPP){const H=!!(se||ve||ee);for(te=r,re=U*te,X=0;X<Y;X++){for(X>=j&&(te=q,re=U*te),pe=0,N=re;N--;)Ee[pe++]=me[oe++],Ee[pe++]=me[oe++],Ee[pe++]=me[oe++],Ee[pe++]=255;if(H)for(let I=0;I<pe;I+=4)se&&(Ee[I+0]=se[Ee[I+0]]),ve&&(Ee[I+1]=ve[Ee[I+1]]),ee&&(Ee[I+2]=ee[Ee[I+2]]);B.putImageData(J,0,X*r)}}else throw new Error(`bad image kind: ${G.kind}`)}function u(B,G){const w=G.height,D=G.width,U=w%r,q=(w-U)/r,j=U===0?q:q+1,Y=B.createImageData(D,r);let J=0;const oe=G.data,pe=Y.data;for(let me=0;me<j;me++){const Ee=me<q?r:U;let X=3;for(let N=0;N<Ee;N++){let te,re=0;for(let se=0;se<D;se++)re||(te=oe[J++],re=128),pe[X]=te&re?0:255,X+=4,re>>=1}B.putImageData(Y,0,me*r)}}function _(B,G){const w=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let D=0,U=w.length;D<U;D++){const q=w[D];B[q]!==void 0&&(G[q]=B[q])}B.setLineDash!==void 0&&(G.setLineDash(B.getLineDash()),G.lineDashOffset=B.lineDashOffset)}function y(B){B.strokeStyle="#000000",B.fillStyle="#000000",B.fillRule="nonzero",B.globalAlpha=1,B.lineWidth=1,B.lineCap="butt",B.lineJoin="miter",B.miterLimit=10,B.globalCompositeOperation="source-over",B.font="10px sans-serif",B.setLineDash!==void 0&&(B.setLineDash([]),B.lineDashOffset=0)}function v(B,G,w,D){const U=B.length;for(let q=3;q<U;q+=4){const j=B[q];if(j===0)B[q-3]=G,B[q-2]=w,B[q-1]=D;else if(j<255){const Y=255-j;B[q-3]=B[q-3]*j+G*Y>>8,B[q-2]=B[q-2]*j+w*Y>>8,B[q-1]=B[q-1]*j+D*Y>>8}}}function T(B,G,w){const D=B.length,U=1/255;for(let q=3;q<D;q+=4){const j=w?w[B[q]]:B[q];G[q]=G[q]*j*U|0}}function k(B,G,w){const D=B.length;for(let U=3;U<D;U+=4){const q=B[U-3]*77+B[U-2]*152+B[U-1]*28;G[U]=w?G[U]*w[q>>8]>>8:G[U]*q>>16}}function P(B,G,w,D,U,q,j){const Y=!!q,J=Y?q[0]:0,oe=Y?q[1]:0,pe=Y?q[2]:0;let me;U==="Luminosity"?me=k:me=T;const X=Math.min(D,Math.ceil(1048576/w));for(let N=0;N<D;N+=X){const te=Math.min(X,D-N),re=B.getImageData(0,N,w,te),se=G.getImageData(0,N,w,te);Y&&v(re.data,J,oe,pe),me(re.data,se.data,j),B.putImageData(se,0,N)}}function S(B,G,w,D){const U=G.canvas,q=G.context;B.setTransform(G.scaleX,0,0,G.scaleY,G.offsetX,G.offsetY);const j=G.backdrop||null;if(!G.transferMap&&D.isEnabled){const Y=D.composeSMask({layer:w.canvas,mask:U,properties:{subtype:G.subtype,backdrop:j}});B.setTransform(1,0,0,1,0,0),B.drawImage(Y,G.offsetX,G.offsetY);return}P(q,w,U.width,U.height,G.subtype,j,G.transferMap),B.drawImage(U,0,0)}const F=["butt","round","square"],K=["miter","round","bevel"],Q={},Z={};L.prototype={beginDrawing({transform:B,viewport:G,transparency:w=!1,background:D=null}){const U=this.ctx.canvas.width,q=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=D||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,U,q),this.ctx.restore(),w){const j=this.cachedCanvases.getCanvas("transparent",U,q,!0);this.compositeCtx=this.ctx,this.transparentCanvas=j.canvas,this.ctx=j.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),y(this.ctx),B&&this.ctx.transform.apply(this.ctx,B),this.ctx.transform.apply(this.ctx,G.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this._combinedScaleFactor=Math.hypot(this.baseTransform[0],this.baseTransform[2]),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(G,w,D,U){const q=G.argsArray,j=G.fnArray;let Y=w||0;const J=q.length;if(J===Y)return Y;const oe=J-Y>10&&typeof D=="function",pe=oe?Date.now()+15:0;let me=0;const Ee=this.commonObjs,X=this.objs;let N;for(;;){if(U!==void 0&&Y===U.nextBreakPoint)return U.breakIt(Y,D),Y;if(N=j[Y],N!==t.OPS.dependency)this[N].apply(this,q[Y]);else for(const te of q[Y]){const re=te.startsWith("g_")?Ee:X;if(!re.has(te))return re.get(te,D),Y}if(Y++,Y===J)return Y;if(oe&&++me>10){if(Date.now()>pe)return D(),Y;me=0}}},endDrawing:function(){for(;this.stateStack.length||this.current.activeSMask!==null;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.webGLContext.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(G){this.current.lineWidth=G,this.ctx.lineWidth=G},setLineCap:function(G){this.ctx.lineCap=F[G]},setLineJoin:function(G){this.ctx.lineJoin=K[G]},setMiterLimit:function(G){this.ctx.miterLimit=G},setDash:function(G,w){const D=this.ctx;D.setLineDash!==void 0&&(D.setLineDash(G),D.lineDashOffset=w)},setRenderingIntent(B){},setFlatness(B){},setGState:function(G){for(let w=0,D=G.length;w<D;w++){const U=G[w],q=U[0],j=U[1];switch(q){case"LW":this.setLineWidth(j);break;case"LC":this.setLineCap(j);break;case"LJ":this.setLineJoin(j);break;case"ML":this.setMiterLimit(j);break;case"D":this.setDash(j[0],j[1]);break;case"RI":this.setRenderingIntent(j);break;case"FL":this.setFlatness(j);break;case"Font":this.setFont(j[0],j[1]);break;case"CA":this.current.strokeAlpha=U[1];break;case"ca":this.current.fillAlpha=U[1],this.ctx.globalAlpha=U[1];break;case"BM":this.ctx.globalCompositeOperation=j;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=j?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null;break;case"TR":this.current.transferMaps=j}}},beginSMaskGroup:function(){const G=this.current.activeSMask,w=G.canvas.width,D=G.canvas.height,U="smaskGroupAt"+this.groupLevel,q=this.cachedCanvases.getCanvas(U,w,D,!0),j=this.ctx,Y=j.mozCurrentTransform;this.ctx.save();const J=q.context;J.scale(1/G.scaleX,1/G.scaleY),J.translate(-G.offsetX,-G.offsetY),J.transform.apply(J,Y),G.startTransformInverse=J.mozCurrentTransformInverse,_(j,J),this.ctx=J,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(j),this.groupLevel++},suspendSMaskGroup:function(){const G=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),S(this.ctx,this.current.activeSMask,G,this.webGLContext),this.ctx.restore(),this.ctx.save(),_(G,this.ctx),this.current.resumeSMaskCtx=G;const w=t.Util.transform(this.current.activeSMask.startTransformInverse,G.mozCurrentTransform);this.ctx.transform.apply(this.ctx,w),G.save(),G.setTransform(1,0,0,1,0,0),G.clearRect(0,0,G.canvas.width,G.canvas.height),G.restore()},resumeSMaskGroup:function(){const G=this.current.resumeSMaskCtx,w=this.ctx;this.ctx=G,this.groupStack.push(w),this.groupLevel++},endSMaskGroup:function(){const G=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),S(this.ctx,this.current.activeSMask,G,this.webGLContext),this.ctx.restore(),_(G,this.ctx);const w=t.Util.transform(this.current.activeSMask.startTransformInverse,G.mozCurrentTransform);this.ctx.transform.apply(this.ctx,w)},save:function(){this.ctx.save();const G=this.current;this.stateStack.push(G),this.current=G.clone(),this.current.resumeSMaskCtx=null},restore:function(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),this.current.activeSMask!==null&&(this.stateStack.length===0||this.stateStack[this.stateStack.length-1].activeSMask!==this.current.activeSMask)&&this.endSMaskGroup(),this.stateStack.length!==0?(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null):this.current.activeSMask=null},transform:function(G,w,D,U,q,j){this.ctx.transform(G,w,D,U,q,j),this._cachedGetSinglePixelWidth=null},constructPath:function(G,w){const D=this.ctx,U=this.current;let q=U.x,j=U.y;for(let Y=0,J=0,oe=G.length;Y<oe;Y++)switch(G[Y]|0){case t.OPS.rectangle:q=w[J++],j=w[J++];const pe=w[J++],me=w[J++],Ee=q+pe,X=j+me;D.moveTo(q,j),pe===0||me===0?D.lineTo(Ee,X):(D.lineTo(Ee,j),D.lineTo(Ee,X),D.lineTo(q,X)),D.closePath();break;case t.OPS.moveTo:q=w[J++],j=w[J++],D.moveTo(q,j);break;case t.OPS.lineTo:q=w[J++],j=w[J++],D.lineTo(q,j);break;case t.OPS.curveTo:q=w[J+4],j=w[J+5],D.bezierCurveTo(w[J],w[J+1],w[J+2],w[J+3],q,j),J+=6;break;case t.OPS.curveTo2:D.bezierCurveTo(q,j,w[J],w[J+1],w[J+2],w[J+3]),q=w[J+2],j=w[J+3],J+=4;break;case t.OPS.curveTo3:q=w[J+2],j=w[J+3],D.bezierCurveTo(w[J],w[J+1],q,j,q,j),J+=4;break;case t.OPS.closePath:D.closePath();break}U.setCurrentPoint(q,j)},closePath:function(){this.ctx.closePath()},stroke:function(G){G=typeof G<"u"?G:!0;const w=this.ctx,D=this.current.strokeColor;if(w.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof D=="object"&&(D!=null&&D.getPattern)){w.save();const U=w.mozCurrentTransform,q=t.Util.singularValueDecompose2dScale(U)[0];w.strokeStyle=D.getPattern(w,this);const j=this.getSinglePixelWidth(),Y=this.current.lineWidth*q;j<0&&-j>=Y?(w.resetTransform(),w.lineWidth=Math.round(this._combinedScaleFactor)):w.lineWidth=Math.max(j,Y),w.stroke(),w.restore()}else{const U=this.getSinglePixelWidth();U<0&&-U>=this.current.lineWidth?(w.save(),w.resetTransform(),w.lineWidth=Math.round(this._combinedScaleFactor),w.stroke(),w.restore()):(w.lineWidth=Math.max(U,this.current.lineWidth),w.stroke())}G&&this.consumePath(),w.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(G){G=typeof G<"u"?G:!0;const w=this.ctx,D=this.current.fillColor,U=this.current.patternFill;let q=!1;U&&(w.save(),this.baseTransform&&w.setTransform.apply(w,this.baseTransform),w.fillStyle=D.getPattern(w,this),q=!0),this.contentVisible&&(this.pendingEOFill?(w.fill("evenodd"),this.pendingEOFill=!1):w.fill()),q&&w.restore(),G&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=Q},eoClip:function(){this.pendingClip=Z},beginText:function(){this.current.textMatrix=t.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){const G=this.pendingTextPaths,w=this.ctx;if(G===void 0){w.beginPath();return}w.save(),w.beginPath();for(let D=0;D<G.length;D++){const U=G[D];w.setTransform.apply(w,U.transform),w.translate(U.x,U.y),U.addToPath(w,U.fontSize)}w.restore(),w.clip(),w.beginPath(),delete this.pendingTextPaths},setCharSpacing:function(G){this.current.charSpacing=G},setWordSpacing:function(G){this.current.wordSpacing=G},setHScale:function(G){this.current.textHScale=G/100},setLeading:function(G){this.current.leading=-G},setFont:function(G,w){const D=this.commonObjs.get(G),U=this.current;if(!D)throw new Error(`Can't find font for ${G}`);if(U.fontMatrix=D.fontMatrix||t.FONT_IDENTITY_MATRIX,(U.fontMatrix[0]===0||U.fontMatrix[3]===0)&&(0,t.warn)("Invalid font matrix for font "+G),w<0?(w=-w,U.fontDirection=-1):U.fontDirection=1,this.current.font=D,this.current.fontSize=w,D.isType3Font)return;const q=D.loadedName||"sans-serif";let j="normal";D.black?j="900":D.bold&&(j="bold");const Y=D.italic?"italic":"normal",J=`"${q}", ${D.fallbackName}`;let oe=w;w<a?oe=a:w>i&&(oe=i),this.current.fontSizeScale=w/oe,this.ctx.font=`${Y} ${j} ${oe}px ${J}`},setTextRenderingMode:function(G){this.current.textRenderingMode=G},setTextRise:function(G){this.current.textRise=G},moveText:function(G,w){this.current.x=this.current.lineX+=G,this.current.y=this.current.lineY+=w},setLeadingMoveText:function(G,w){this.setLeading(-w),this.moveText(G,w)},setTextMatrix:function(G,w,D,U,q,j){this.current.textMatrix=[G,w,D,U,q,j],this.current.textMatrixScale=Math.hypot(G,w),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar(B,G,w,D,U){const q=this.ctx,j=this.current,Y=j.font,J=j.textRenderingMode,oe=j.fontSize/j.fontSizeScale,pe=J&t.TextRenderingMode.FILL_STROKE_MASK,me=!!(J&t.TextRenderingMode.ADD_TO_PATH_FLAG),Ee=j.patternFill&&!Y.missingFile;let X;(Y.disableFontFace||me||Ee)&&(X=Y.getPathGenerator(this.commonObjs,B)),Y.disableFontFace||Ee?(q.save(),q.translate(G,w),q.beginPath(),X(q,oe),D&&q.setTransform.apply(q,D),(pe===t.TextRenderingMode.FILL||pe===t.TextRenderingMode.FILL_STROKE)&&q.fill(),(pe===t.TextRenderingMode.STROKE||pe===t.TextRenderingMode.FILL_STROKE)&&(U&&(q.resetTransform(),q.lineWidth=Math.round(this._combinedScaleFactor)),q.stroke()),q.restore()):((pe===t.TextRenderingMode.FILL||pe===t.TextRenderingMode.FILL_STROKE)&&q.fillText(B,G,w),(pe===t.TextRenderingMode.STROKE||pe===t.TextRenderingMode.FILL_STROKE)&&(U?(q.save(),q.moveTo(G,w),q.resetTransform(),q.lineWidth=Math.round(this._combinedScaleFactor),q.strokeText(B,0,0),q.restore()):q.strokeText(B,G,w))),me&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:q.mozCurrentTransform,x:G,y:w,fontSize:oe,addToPath:X})},get isFontSubpixelAAEnabled(){const{context:B}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);B.scale(1.5,1),B.fillText("I",0,10);const G=B.getImageData(0,0,10,10).data;let w=!1;for(let D=3;D<G.length;D+=4)if(G[D]>0&&G[D]<255){w=!0;break}return(0,t.shadow)(this,"isFontSubpixelAAEnabled",w)},showText:function(G){const w=this.current,D=w.font;if(D.isType3Font)return this.showType3Text(G);const U=w.fontSize;if(U===0)return;const q=this.ctx,j=w.fontSizeScale,Y=w.charSpacing,J=w.wordSpacing,oe=w.fontDirection,pe=w.textHScale*oe,me=G.length,Ee=D.vertical,X=Ee?1:-1,N=D.defaultVMetrics,te=U*w.fontMatrix[0],re=w.textRenderingMode===t.TextRenderingMode.FILL&&!D.disableFontFace&&!w.patternFill;q.save();let se;if(w.patternFill){q.save();const O=w.fillColor.getPattern(q,this);se=q.mozCurrentTransform,q.restore(),q.fillStyle=O}q.transform.apply(q,w.textMatrix),q.translate(w.x,w.y+w.textRise),oe>0?q.scale(pe,-1):q.scale(pe,1);let ve=w.lineWidth,ee=!1;const le=w.textMatrixScale;if(le===0||ve===0){const O=w.textRenderingMode&t.TextRenderingMode.FILL_STROKE_MASK;(O===t.TextRenderingMode.STROKE||O===t.TextRenderingMode.FILL_STROKE)&&(this._cachedGetSinglePixelWidth=null,ve=this.getSinglePixelWidth(),ee=ve<0)}else ve/=le;j!==1&&(q.scale(j,j),ve/=j),q.lineWidth=ve;let H=0,I;for(I=0;I<me;++I){const O=G[I];if((0,t.isNum)(O)){H+=X*O*U/1e3;continue}let ae=!1;const _e=(O.isSpace?J:0)+Y,Ae=O.fontChar,Se=O.accent;let ze,Xe,Ue=O.width;if(Ee){const He=O.vmetric||N,Je=-(O.vmetric?He[1]:Ue*.5)*te,nt=He[2]*te;Ue=He?-He[0]:Ue,ze=Je/j,Xe=(H+nt)/j}else ze=H/j,Xe=0;if(D.remeasure&&Ue>0){const He=q.measureText(Ae).width*1e3/U*j;if(Ue<He&&this.isFontSubpixelAAEnabled){const Je=Ue/He;ae=!0,q.save(),q.scale(Je,1),ze/=Je}else Ue!==He&&(ze+=(Ue-He)/2e3*U/j)}if(this.contentVisible&&(O.isInFont||D.missingFile)){if(re&&!Se)q.fillText(Ae,ze,Xe);else if(this.paintChar(Ae,ze,Xe,se,ee),Se){const He=ze+U*Se.offset.x/j,Je=Xe-U*Se.offset.y/j;this.paintChar(Se.fontChar,He,Je,se,ee)}}let Ze;Ee?Ze=Ue*te-_e*oe:Ze=Ue*te+_e*oe,H+=Ze,ae&&q.restore()}Ee?w.y-=H:w.x+=H*pe,q.restore()},showType3Text:function(G){const w=this.ctx,D=this.current,U=D.font,q=D.fontSize,j=D.fontDirection,Y=U.vertical?1:-1,J=D.charSpacing,oe=D.wordSpacing,pe=D.textHScale*j,me=D.fontMatrix||t.FONT_IDENTITY_MATRIX,Ee=G.length,X=D.textRenderingMode===t.TextRenderingMode.INVISIBLE;let N,te,re,se;if(!(X||q===0)){for(this._cachedGetSinglePixelWidth=null,w.save(),w.transform.apply(w,D.textMatrix),w.translate(D.x,D.y),w.scale(pe,j),N=0;N<Ee;++N){if(te=G[N],(0,t.isNum)(te)){se=Y*te*q/1e3,this.ctx.translate(se,0),D.x+=se*pe;continue}const ve=(te.isSpace?oe:0)+J,ee=U.charProcOperatorList[te.operatorListId];if(!ee){(0,t.warn)(`Type3 character "${te.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=te,this.save(),w.scale(q,q),w.transform.apply(w,me),this.executeOperatorList(ee),this.restore()),re=t.Util.applyTransform([te.width,0],me)[0]*q+ve,w.translate(re,0),D.x+=re*pe}w.restore(),this.processingType3=null}},setCharWidth:function(G,w){},setCharWidthAndBounds:function(G,w,D,U,q,j){this.ctx.rect(D,U,q-D,j-U),this.clip(),this.endPath()},getColorN_Pattern:function(G){let w;if(G[0]==="TilingPattern"){const D=G[1],U=this.baseTransform||this.ctx.mozCurrentTransform.slice(),q={createCanvasGraphics:j=>new L(j,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext)};w=new l.TilingPattern(G,D,this.ctx,q,U)}else w=(0,l.getShadingPatternFromIR)(G);return w},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(G,w,D){const U=t.Util.makeHexColor(G,w,D);this.ctx.strokeStyle=U,this.current.strokeColor=U},setFillRGBColor:function(G,w,D){const U=t.Util.makeHexColor(G,w,D);this.ctx.fillStyle=U,this.current.fillColor=U,this.current.patternFill=!1},shadingFill:function(G){if(!this.contentVisible)return;const w=this.ctx;this.save();const D=(0,l.getShadingPatternFromIR)(G);w.fillStyle=D.getPattern(w,this,!0);const U=w.mozCurrentTransformInverse;if(U){const q=w.canvas,j=q.width,Y=q.height,J=t.Util.applyTransform([0,0],U),oe=t.Util.applyTransform([0,Y],U),pe=t.Util.applyTransform([j,0],U),me=t.Util.applyTransform([j,Y],U),Ee=Math.min(J[0],oe[0],pe[0],me[0]),X=Math.min(J[1],oe[1],pe[1],me[1]),N=Math.max(J[0],oe[0],pe[0],me[0]),te=Math.max(J[1],oe[1],pe[1],me[1]);this.ctx.fillRect(Ee,X,N-Ee,te-X)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()},beginInlineImage:function(){(0,t.unreachable)("Should not call beginInlineImage")},beginImageData:function(){(0,t.unreachable)("Should not call beginImageData")},paintFormXObjectBegin:function(G,w){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(G)&&G.length===6&&this.transform.apply(this,G),this.baseTransform=this.ctx.mozCurrentTransform,w)){const D=w[2]-w[0],U=w[3]-w[1];this.ctx.rect(w[0],w[1],D,U),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())},beginGroup:function(G){if(!this.contentVisible)return;this.save();const w=this.ctx;G.isolated||(0,t.info)("TODO: Support non-isolated groups."),G.knockout&&(0,t.warn)("Knockout groups not supported.");const D=w.mozCurrentTransform;if(G.matrix&&w.transform.apply(w,G.matrix),!G.bbox)throw new Error("Bounding box is required.");let U=t.Util.getAxialAlignedBoundingBox(G.bbox,w.mozCurrentTransform);const q=[0,0,w.canvas.width,w.canvas.height];U=t.Util.intersect(U,q)||[0,0,0,0];const j=Math.floor(U[0]),Y=Math.floor(U[1]);let J=Math.max(Math.ceil(U[2])-j,1),oe=Math.max(Math.ceil(U[3])-Y,1),pe=1,me=1;J>s&&(pe=J/s,J=s),oe>s&&(me=oe/s,oe=s);let Ee="groupAt"+this.groupLevel;G.smask&&(Ee+="_smask_"+this.smaskCounter++%2);const X=this.cachedCanvases.getCanvas(Ee,J,oe,!0),N=X.context;N.scale(1/pe,1/me),N.translate(-j,-Y),N.transform.apply(N,D),G.smask?this.smaskStack.push({canvas:X.canvas,context:N,offsetX:j,offsetY:Y,scaleX:pe,scaleY:me,subtype:G.smask.subtype,backdrop:G.smask.backdrop,transferMap:G.smask.transferMap||null,startTransformInverse:null}):(w.setTransform(1,0,0,1,0,0),w.translate(j,Y),w.scale(pe,me)),_(w,N),this.ctx=N,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(w),this.groupLevel++,this.current.activeSMask=null},endGroup:function(G){if(!this.contentVisible)return;this.groupLevel--;const w=this.ctx;this.ctx=this.groupStack.pop(),this.ctx.imageSmoothingEnabled!==void 0?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,G.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(w.canvas,0,0),this.restore()},beginAnnotations:function(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(G,w,D){if(this.save(),y(this.ctx),this.current=new g,Array.isArray(G)&&G.length===4){const U=G[2]-G[0],q=G[3]-G[1];this.ctx.rect(G[0],G[1],U,q),this.clip(),this.endPath()}this.transform.apply(this,w),this.transform.apply(this,D)},endAnnotation:function(){this.restore()},paintImageMaskXObject:function(G){if(!this.contentVisible)return;const w=this.ctx,D=G.width,U=G.height,q=this.current.fillColor,j=this.current.patternFill,Y=this.processingType3;if(Y&&Y.compiled===void 0&&(D<=c&&U<=c?Y.compiled=f({data:G.data,width:D,height:U}):Y.compiled=null),Y!=null&&Y.compiled){Y.compiled(w);return}const J=this.cachedCanvases.getCanvas("maskCanvas",D,U),oe=J.context;oe.save(),u(oe,G),oe.globalCompositeOperation="source-in",oe.fillStyle=j?q.getPattern(oe,this):q,oe.fillRect(0,0,D,U),oe.restore(),this.paintInlineImageXObject(J.canvas)},paintImageMaskXObjectRepeat(B,G,w=0,D=0,U,q){if(!this.contentVisible)return;const j=B.width,Y=B.height,J=this.current.fillColor,oe=this.current.patternFill,pe=this.cachedCanvases.getCanvas("maskCanvas",j,Y),me=pe.context;me.save(),u(me,B),me.globalCompositeOperation="source-in",me.fillStyle=oe?J.getPattern(me,this):J,me.fillRect(0,0,j,Y),me.restore();const Ee=this.ctx;for(let X=0,N=q.length;X<N;X+=2)Ee.save(),Ee.transform(G,w,D,U,q[X],q[X+1]),Ee.scale(1,-1),Ee.drawImage(pe.canvas,0,0,j,Y,0,-1,1,1),Ee.restore()},paintImageMaskXObjectGroup:function(G){if(!this.contentVisible)return;const w=this.ctx,D=this.current.fillColor,U=this.current.patternFill;for(let q=0,j=G.length;q<j;q++){const Y=G[q],J=Y.width,oe=Y.height,pe=this.cachedCanvases.getCanvas("maskCanvas",J,oe),me=pe.context;me.save(),u(me,Y),me.globalCompositeOperation="source-in",me.fillStyle=U?D.getPattern(me,this):D,me.fillRect(0,0,J,oe),me.restore(),w.save(),w.transform.apply(w,Y.transform),w.scale(1,-1),w.drawImage(pe.canvas,0,0,J,oe,0,-1,1,1),w.restore()}},paintImageXObject:function(G){if(!this.contentVisible)return;const w=G.startsWith("g_")?this.commonObjs.get(G):this.objs.get(G);if(!w){(0,t.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(w)},paintImageXObjectRepeat:function(G,w,D,U){if(!this.contentVisible)return;const q=G.startsWith("g_")?this.commonObjs.get(G):this.objs.get(G);if(!q){(0,t.warn)("Dependent image isn't ready yet");return}const j=q.width,Y=q.height,J=[];for(let oe=0,pe=U.length;oe<pe;oe+=2)J.push({transform:[w,0,0,D,U[oe],U[oe+1]],x:0,y:0,w:j,h:Y});this.paintInlineImageXObjectGroup(q,J)},paintInlineImageXObject:function(G){if(!this.contentVisible)return;const w=G.width,D=G.height,U=this.ctx;this.save(),U.scale(1/w,-1/D);const q=U.mozCurrentTransformInverse;let j=Math.max(Math.hypot(q[0],q[1]),1),Y=Math.max(Math.hypot(q[2],q[3]),1),J,oe,pe;typeof HTMLElement=="function"&&G instanceof HTMLElement||!G.data?J=G:(oe=this.cachedCanvases.getCanvas("inlineImage",w,D),pe=oe.context,C(pe,G,this.current.transferMaps),J=oe.canvas);let me=w,Ee=D,X="prescale1";for(;j>2&&me>1||Y>2&&Ee>1;){let N=me,te=Ee;j>2&&me>1&&(N=Math.ceil(me/2),j/=me/N),Y>2&&Ee>1&&(te=Math.ceil(Ee/2),Y/=Ee/te),oe=this.cachedCanvases.getCanvas(X,N,te),pe=oe.context,pe.clearRect(0,0,N,te),pe.drawImage(J,0,0,me,Ee,0,0,N,te),J=oe.canvas,me=N,Ee=te,X=X==="prescale1"?"prescale2":"prescale1"}if(U.drawImage(J,0,0,me,Ee,0,-D,w,D),this.imageLayer){const N=this.getCanvasPosition(0,-D);this.imageLayer.appendImage({imgData:G,left:N[0],top:N[1],width:w/q[0],height:D/q[3]})}this.restore()},paintInlineImageXObjectGroup:function(G,w){if(!this.contentVisible)return;const D=this.ctx,U=G.width,q=G.height,j=this.cachedCanvases.getCanvas("inlineImage",U,q),Y=j.context;C(Y,G,this.current.transferMaps);for(let J=0,oe=w.length;J<oe;J++){const pe=w[J];if(D.save(),D.transform.apply(D,pe.transform),D.scale(1,-1),D.drawImage(j.canvas,pe.x,pe.y,pe.w,pe.h,0,-1,1,1),this.imageLayer){const me=this.getCanvasPosition(pe.x,pe.y);this.imageLayer.appendImage({imgData:G,left:me[0],top:me[1],width:U,height:q})}D.restore()}},paintSolidColorImageMask:function(){this.contentVisible&&this.ctx.fillRect(0,0,1,1)},markPoint:function(G){},markPointProps:function(G,w){},beginMarkedContent:function(G){this.markedContentStack.push({visible:!0})},beginMarkedContentProps:function(G,w){G==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(w)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()},endMarkedContent:function(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()},beginCompat:function(){},endCompat:function(){},consumePath:function(){const G=this.ctx;this.pendingClip&&(this.pendingClip===Z?G.clip("evenodd"):G.clip(),this.pendingClip=null),G.beginPath()},getSinglePixelWidth(){if(this._cachedGetSinglePixelWidth===null){const B=this.ctx.mozCurrentTransform,G=Math.abs(B[0]*B[3]-B[2]*B[1]),w=B[0]**2+B[2]**2,D=B[1]**2+B[3]**2,U=Math.sqrt(Math.max(w,D))/G;w!==D&&this._combinedScaleFactor*U>1?this._cachedGetSinglePixelWidth=-(this._combinedScaleFactor*U):G>Number.EPSILON?this._cachedGetSinglePixelWidth=U:this._cachedGetSinglePixelWidth=1}return this._cachedGetSinglePixelWidth},getCanvasPosition:function(G,w){const D=this.ctx.mozCurrentTransform;return[D[0]*G+D[2]*w+D[4],D[1]*G+D[3]*w+D[5]]},isContentVisible:function(){for(let G=this.markedContentStack.length-1;G>=0;G--)if(!this.markedContentStack[G].visible)return!1;return!0}};for(const B in t.OPS)L.prototype[t.OPS[B]]=L.prototype[B];return L}();n.CanvasGraphics=x},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getShadingPatternFromIR=s,n.TilingPattern=void 0;var t=o(2);const l={};function a(r,d){if(!d||typeof Path2D>"u")return;const h=d[2]-d[0],m=d[3]-d[1],f=new Path2D;f.rect(d[0],d[1],h,m),r.clip(f)}l.RadialAxial={fromIR:function(d){const h=d[1],m=d[2],f=d[3],g=d[4],x=d[5],b=d[6],A=d[7];return{getPattern:function(L){a(L,m);let C;h==="axial"?C=L.createLinearGradient(g[0],g[1],x[0],x[1]):h==="radial"&&(C=L.createRadialGradient(g[0],g[1],b,x[0],x[1],A));for(let u=0,_=f.length;u<_;++u){const y=f[u];C.addColorStop(y[0],y[1])}return C}}}};const i=function(){function d(f,g,x,b,A,M,L,C){const u=g.coords,_=g.colors,y=f.data,v=f.width*4;let T;u[x+1]>u[b+1]&&(T=x,x=b,b=T,T=M,M=L,L=T),u[b+1]>u[A+1]&&(T=b,b=A,A=T,T=L,L=C,C=T),u[x+1]>u[b+1]&&(T=x,x=b,b=T,T=M,M=L,L=T);const k=(u[x]+g.offsetX)*g.scaleX,P=(u[x+1]+g.offsetY)*g.scaleY,S=(u[b]+g.offsetX)*g.scaleX,F=(u[b+1]+g.offsetY)*g.scaleY,K=(u[A]+g.offsetX)*g.scaleX,Q=(u[A+1]+g.offsetY)*g.scaleY;if(P>=Q)return;const Z=_[M],B=_[M+1],G=_[M+2],w=_[L],D=_[L+1],U=_[L+2],q=_[C],j=_[C+1],Y=_[C+2],J=Math.round(P),oe=Math.round(Q);let pe,me,Ee,X,N,te,re,se;for(let ve=J;ve<=oe;ve++){if(ve<F){let O;ve<P?O=0:P===F?O=1:O=(P-ve)/(P-F),pe=k-(k-S)*O,me=Z-(Z-w)*O,Ee=B-(B-D)*O,X=G-(G-U)*O}else{let O;ve>Q?O=1:F===Q?O=0:O=(F-ve)/(F-Q),pe=S-(S-K)*O,me=w-(w-q)*O,Ee=D-(D-j)*O,X=U-(U-Y)*O}let ee;ve<P?ee=0:ve>Q?ee=1:ee=(P-ve)/(P-Q),N=k-(k-K)*ee,te=Z-(Z-q)*ee,re=B-(B-j)*ee,se=G-(G-Y)*ee;const le=Math.round(Math.min(pe,N)),H=Math.round(Math.max(pe,N));let I=v*ve+le*4;for(let O=le;O<=H;O++)ee=(pe-O)/(pe-N),ee<0?ee=0:ee>1&&(ee=1),y[I++]=me-(me-te)*ee|0,y[I++]=Ee-(Ee-re)*ee|0,y[I++]=X-(X-se)*ee|0,y[I++]=255}}function h(f,g,x){const b=g.coords,A=g.colors;let M,L;switch(g.type){case"lattice":const C=g.verticesPerRow,u=Math.floor(b.length/C)-1,_=C-1;for(M=0;M<u;M++){let y=M*C;for(let v=0;v<_;v++,y++)d(f,x,b[y],b[y+1],b[y+C],A[y],A[y+1],A[y+C]),d(f,x,b[y+C+1],b[y+1],b[y+C],A[y+C+1],A[y+1],A[y+C])}break;case"triangles":for(M=0,L=b.length;M<L;M+=3)d(f,x,b[M],b[M+1],b[M+2],A[M],A[M+1],A[M+2]);break;default:throw new Error("illegal figure")}}function m(f,g,x,b,A,M,L,C){const v=Math.floor(f[0]),T=Math.floor(f[1]),k=Math.ceil(f[2])-v,P=Math.ceil(f[3])-T,S=Math.min(Math.ceil(Math.abs(k*g[0]*1.1)),3e3),F=Math.min(Math.ceil(Math.abs(P*g[1]*1.1)),3e3),K=k/S,Q=P/F,Z={coords:x,colors:b,offsetX:-v,offsetY:-T,scaleX:1/K,scaleY:1/Q},B=S+2*2,G=F+2*2;let w,D,U,q;if(C.isEnabled)w=C.drawFigures({width:S,height:F,backgroundColor:M,figures:A,context:Z}),D=L.getCanvas("mesh",B,G,!1),D.context.drawImage(w,2,2),w=D.canvas;else{D=L.getCanvas("mesh",B,G,!1);const j=D.context,Y=j.createImageData(S,F);if(M){const J=Y.data;for(U=0,q=J.length;U<q;U+=4)J[U]=M[0],J[U+1]=M[1],J[U+2]=M[2],J[U+3]=255}for(U=0;U<A.length;U++)h(Y,A[U],Z);j.putImageData(Y,2,2),w=D.canvas}return{canvas:w,offsetX:v-2*K,offsetY:T-2*Q,scaleX:K,scaleY:Q}}return m}();l.Mesh={fromIR:function(d){const h=d[2],m=d[3],f=d[4],g=d[5],x=d[6],b=d[7],A=d[8];return{getPattern:function(L,C,u){a(L,b);let _;if(u)_=t.Util.singularValueDecompose2dScale(L.mozCurrentTransform);else if(_=t.Util.singularValueDecompose2dScale(C.baseTransform),x){const v=t.Util.singularValueDecompose2dScale(x);_=[_[0]*v[0],_[1]*v[1]]}const y=i(g,_,h,m,f,u?null:A,C.cachedCanvases,C.webGLContext);return u||(L.setTransform.apply(L,C.baseTransform),x&&L.transform.apply(L,x)),L.translate(y.offsetX,y.offsetY),L.scale(y.scaleX,y.scaleY),L.createPattern(y.canvas,"no-repeat")}}}},l.Dummy={fromIR:function(){return{getPattern:function(){return"hotpink"}}}};function s(r){const d=l[r[0]];if(!d)throw new Error(`Unknown IR type: ${r[0]}`);return d.fromIR(r)}const c=function(){const d={COLORED:1,UNCOLORED:2},h=3e3;function m(f,g,x,b,A){this.operatorList=f[2],this.matrix=f[3]||[1,0,0,1,0,0],this.bbox=f[4],this.xstep=f[5],this.ystep=f[6],this.paintType=f[7],this.tilingType=f[8],this.color=g,this.canvasGraphicsFactory=b,this.baseTransform=A,this.ctx=x}return m.prototype={createPatternCanvas:function(g){const x=this.operatorList,b=this.bbox,A=this.xstep,M=this.ystep,L=this.paintType,C=this.tilingType,u=this.color,_=this.canvasGraphicsFactory;(0,t.info)("TilingType: "+C);const y=b[0],v=b[1],T=b[2],k=b[3],P=t.Util.singularValueDecompose2dScale(this.matrix),S=t.Util.singularValueDecompose2dScale(this.baseTransform),F=[P[0]*S[0],P[1]*S[1]],K=this.getSizeAndScale(A,this.ctx.canvas.width,F[0]),Q=this.getSizeAndScale(M,this.ctx.canvas.height,F[1]),Z=g.cachedCanvases.getCanvas("pattern",K.size,Q.size,!0),B=Z.context,G=_.createCanvasGraphics(B);return G.groupLevel=g.groupLevel,this.setFillAndStrokeStyleToContext(G,L,u),G.transform(K.scale,0,0,Q.scale,0,0),G.transform(1,0,0,1,-y,-v),this.clipBbox(G,b,y,v,T,k),G.executeOperatorList(x),this.ctx.transform(1,0,0,1,y,v),this.ctx.scale(1/K.scale,1/Q.scale),Z.canvas},getSizeAndScale:function(g,x,b){g=Math.abs(g);const A=Math.max(h,x);let M=Math.ceil(g*b);return M>=A?M=A:b=M/g,{scale:b,size:M}},clipBbox:function(g,x,b,A,M,L){if(Array.isArray(x)&&x.length===4){const C=M-b,u=L-A;g.ctx.rect(b,A,C,u),g.clip(),g.endPath()}},setFillAndStrokeStyleToContext:function(g,x,b){const A=g.ctx,M=g.current;switch(x){case d.COLORED:const L=this.ctx;A.fillStyle=L.fillStyle,A.strokeStyle=L.strokeStyle,M.fillColor=L.fillStyle,M.strokeColor=L.strokeStyle;break;case d.UNCOLORED:const C=t.Util.makeHexColor(b[0],b[1],b[2]);A.fillStyle=C,A.strokeStyle=C,M.fillColor=C,M.strokeColor=C;break;default:throw new t.FormatError(`Unsupported paint type: ${x}`)}},getPattern:function(g,x){g=this.ctx,g.setTransform.apply(g,this.baseTransform),g.transform.apply(g,this.matrix);const b=this.createPatternCanvas(x);return g.createPattern(b,"repeat")}},m}();n.TilingPattern=c},(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const o=Object.create(null);n.GlobalWorkerOptions=o,o.workerPort=o.workerPort===void 0?null:o.workerPort,o.workerSrc=o.workerSrc===void 0?"":o.workerSrc},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var t=o(2);const l={UNKNOWN:0,DATA:1,ERROR:2},a={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function i(c){if(typeof c!="object"||c===null)return c;switch(c.name){case"AbortException":return new t.AbortException(c.message);case"MissingPDFException":return new t.MissingPDFException(c.message);case"UnexpectedResponseException":return new t.UnexpectedResponseException(c.message,c.status);case"UnknownErrorException":return new t.UnknownErrorException(c.message,c.details);default:return new t.UnknownErrorException(c.message,c.toString())}}class s{constructor(r,d,h){this.sourceName=r,this.targetName=d,this.comObj=h,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=m=>{const f=m.data;if(f.targetName!==this.sourceName)return;if(f.stream){this._processStreamMessage(f);return}if(f.callback){const x=f.callbackId,b=this.callbackCapabilities[x];if(!b)throw new Error(`Cannot resolve callback ${x}`);if(delete this.callbackCapabilities[x],f.callback===l.DATA)b.resolve(f.data);else if(f.callback===l.ERROR)b.reject(i(f.reason));else throw new Error("Unexpected callback case");return}const g=this.actionHandler[f.action];if(!g)throw new Error(`Unknown action from worker: ${f.action}`);if(f.callbackId){const x=this.sourceName,b=f.sourceName;new Promise(function(A){A(g(f.data))}).then(function(A){h.postMessage({sourceName:x,targetName:b,callback:l.DATA,callbackId:f.callbackId,data:A})},function(A){h.postMessage({sourceName:x,targetName:b,callback:l.ERROR,callbackId:f.callbackId,reason:i(A)})});return}if(f.streamId){this._createStreamSink(f);return}g(f.data)},h.addEventListener("message",this._onComObjOnMessage)}on(r,d){const h=this.actionHandler;if(h[r])throw new Error(`There is already an actionName called "${r}"`);h[r]=d}send(r,d,h){this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:r,data:d},h)}sendWithPromise(r,d,h){const m=this.callbackId++,f=(0,t.createPromiseCapability)();this.callbackCapabilities[m]=f;try{this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:r,callbackId:m,data:d},h)}catch(g){f.reject(g)}return f.promise}sendWithStream(r,d,h,m){const f=this.streamId++,g=this.sourceName,x=this.targetName,b=this.comObj;return new ReadableStream({start:A=>{const M=(0,t.createPromiseCapability)();return this.streamControllers[f]={controller:A,startCall:M,pullCall:null,cancelCall:null,isClosed:!1},this._postMessage({sourceName:g,targetName:x,action:r,streamId:f,data:d,desiredSize:A.desiredSize},m),M.promise},pull:A=>{const M=(0,t.createPromiseCapability)();return this.streamControllers[f].pullCall=M,b.postMessage({sourceName:g,targetName:x,stream:a.PULL,streamId:f,desiredSize:A.desiredSize}),M.promise},cancel:A=>{(0,t.assert)(A instanceof Error,"cancel must have a valid reason");const M=(0,t.createPromiseCapability)();return this.streamControllers[f].cancelCall=M,this.streamControllers[f].isClosed=!0,b.postMessage({sourceName:g,targetName:x,stream:a.CANCEL,streamId:f,reason:i(A)}),M.promise}},h)}_createStreamSink(r){const d=this,h=this.actionHandler[r.action],m=r.streamId,f=this.sourceName,g=r.sourceName,x=this.comObj,b={enqueue(A,M=1,L){if(this.isCancelled)return;const C=this.desiredSize;this.desiredSize-=M,C>0&&this.desiredSize<=0&&(this.sinkCapability=(0,t.createPromiseCapability)(),this.ready=this.sinkCapability.promise),d._postMessage({sourceName:f,targetName:g,stream:a.ENQUEUE,streamId:m,chunk:A},L)},close(){this.isCancelled||(this.isCancelled=!0,x.postMessage({sourceName:f,targetName:g,stream:a.CLOSE,streamId:m}),delete d.streamSinks[m])},error(A){(0,t.assert)(A instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,x.postMessage({sourceName:f,targetName:g,stream:a.ERROR,streamId:m,reason:i(A)}))},sinkCapability:(0,t.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:r.desiredSize,ready:null};b.sinkCapability.resolve(),b.ready=b.sinkCapability.promise,this.streamSinks[m]=b,new Promise(function(A){A(h(r.data,b))}).then(function(){x.postMessage({sourceName:f,targetName:g,stream:a.START_COMPLETE,streamId:m,success:!0})},function(A){x.postMessage({sourceName:f,targetName:g,stream:a.START_COMPLETE,streamId:m,reason:i(A)})})}_processStreamMessage(r){const d=r.streamId,h=this.sourceName,m=r.sourceName,f=this.comObj;switch(r.stream){case a.START_COMPLETE:r.success?this.streamControllers[d].startCall.resolve():this.streamControllers[d].startCall.reject(i(r.reason));break;case a.PULL_COMPLETE:r.success?this.streamControllers[d].pullCall.resolve():this.streamControllers[d].pullCall.reject(i(r.reason));break;case a.PULL:if(!this.streamSinks[d]){f.postMessage({sourceName:h,targetName:m,stream:a.PULL_COMPLETE,streamId:d,success:!0});break}this.streamSinks[d].desiredSize<=0&&r.desiredSize>0&&this.streamSinks[d].sinkCapability.resolve(),this.streamSinks[d].desiredSize=r.desiredSize;const{onPull:g}=this.streamSinks[r.streamId];new Promise(function(b){b(g&&g())}).then(function(){f.postMessage({sourceName:h,targetName:m,stream:a.PULL_COMPLETE,streamId:d,success:!0})},function(b){f.postMessage({sourceName:h,targetName:m,stream:a.PULL_COMPLETE,streamId:d,reason:i(b)})});break;case a.ENQUEUE:if((0,t.assert)(this.streamControllers[d],"enqueue should have stream controller"),this.streamControllers[d].isClosed)break;this.streamControllers[d].controller.enqueue(r.chunk);break;case a.CLOSE:if((0,t.assert)(this.streamControllers[d],"close should have stream controller"),this.streamControllers[d].isClosed)break;this.streamControllers[d].isClosed=!0,this.streamControllers[d].controller.close(),this._deleteStreamController(d);break;case a.ERROR:(0,t.assert)(this.streamControllers[d],"error should have stream controller"),this.streamControllers[d].controller.error(i(r.reason)),this._deleteStreamController(d);break;case a.CANCEL_COMPLETE:r.success?this.streamControllers[d].cancelCall.resolve():this.streamControllers[d].cancelCall.reject(i(r.reason)),this._deleteStreamController(d);break;case a.CANCEL:if(!this.streamSinks[d])break;const{onCancel:x}=this.streamSinks[r.streamId];new Promise(function(b){b(x&&x(i(r.reason)))}).then(function(){f.postMessage({sourceName:h,targetName:m,stream:a.CANCEL_COMPLETE,streamId:d,success:!0})},function(b){f.postMessage({sourceName:h,targetName:m,stream:a.CANCEL_COMPLETE,streamId:d,reason:i(b)})}),this.streamSinks[d].sinkCapability.reject(i(r.reason)),this.streamSinks[d].isCancelled=!0,delete this.streamSinks[d];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(r){await Promise.allSettled([this.streamControllers[r].startCall,this.streamControllers[r].pullCall,this.streamControllers[r].cancelCall].map(function(d){return d&&d.promise})),delete this.streamControllers[r]}_postMessage(r,d){d&&this.postMessageTransfers?this.comObj.postMessage(r,d):this.comObj.postMessage(r)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}n.MessageHandler=s},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var t=o(2);class l{constructor({parsedData:i,rawData:s}){this._metadataMap=i,this._data=s}getRaw(){return this._data}get(i){return this._metadataMap.get(i)??null}getAll(){return(0,t.objectFromMap)(this._metadataMap)}has(i){return this._metadataMap.has(i)}}n.Metadata=l},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var t=o(2);class l{constructor(s,c){this.visible=!0,this.name=s,this.intent=c}}class a{constructor(s){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,s!==null){this.name=s.name,this.creator=s.creator,this._order=s.order;for(const c of s.groups)this._groups.set(c.id,new l(c.name,c.intent));if(s.baseState==="OFF")for(const c of this._groups)c.visible=!1;for(const c of s.on)this._groups.get(c).visible=!0;for(const c of s.off)this._groups.get(c).visible=!1}}isVisible(s){if(s.type==="OCG")return this._groups.has(s.id)?this._groups.get(s.id).visible:((0,t.warn)(`Optional content group not found: ${s.id}`),!0);if(s.type==="OCMD"){if(s.expression&&(0,t.warn)("Visibility expression not supported yet."),!s.policy||s.policy==="AnyOn"){for(const c of s.ids){if(!this._groups.has(c))return(0,t.warn)(`Optional content group not found: ${c}`),!0;if(this._groups.get(c).visible)return!0}return!1}else if(s.policy==="AllOn"){for(const c of s.ids){if(!this._groups.has(c))return(0,t.warn)(`Optional content group not found: ${c}`),!0;if(!this._groups.get(c).visible)return!1}return!0}else if(s.policy==="AnyOff"){for(const c of s.ids){if(!this._groups.has(c))return(0,t.warn)(`Optional content group not found: ${c}`),!0;if(!this._groups.get(c).visible)return!0}return!1}else if(s.policy==="AllOff"){for(const c of s.ids){if(!this._groups.has(c))return(0,t.warn)(`Optional content group not found: ${c}`),!0;if(this._groups.get(c).visible)return!1}return!0}return(0,t.warn)(`Unknown optional content policy ${s.policy}.`),!0}return(0,t.warn)(`Unknown group type ${s.type}.`),!0}setVisibility(s,c=!0){if(!this._groups.has(s)){(0,t.warn)(`Optional content group not found: ${s}`);return}this._groups.get(s).visible=!!c}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size>0?(0,t.objectFromMap)(this._groups):null}getGroup(s){return this._groups.get(s)||null}}n.OptionalContentConfig=a},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var t=o(2),l=o(1);class a{constructor(r,d){(0,t.assert)(d,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=r.progressiveDone||!1,this._contentDispositionFilename=r.contentDispositionFilename||null;const h=r.initialData;if((h==null?void 0:h.length)>0){const m=new Uint8Array(h).buffer;this._queuedChunks.push(m)}this._pdfDataRangeTransport=d,this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._contentLength=r.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((m,f)=>{this._onReceiveData({begin:m,chunk:f})}),this._pdfDataRangeTransport.addProgressListener((m,f)=>{this._onProgress({loaded:m,total:f})}),this._pdfDataRangeTransport.addProgressiveReadListener(m=>{this._onReceiveData({chunk:m})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(r){const d=new Uint8Array(r.chunk).buffer;if(r.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(d):this._queuedChunks.push(d);else{const h=this._rangeReaders.some(function(m){return m._begin!==r.begin?!1:(m._enqueue(d),!0)});(0,t.assert)(h,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var r;return((r=this._fullRequestReader)==null?void 0:r._loaded)??0}_onProgress(r){if(r.total===void 0){const d=this._rangeReaders[0];d!=null&&d.onProgress&&d.onProgress({loaded:r.loaded})}else{const d=this._fullRequestReader;d!=null&&d.onProgress&&d.onProgress({loaded:r.loaded,total:r.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(r){const d=this._rangeReaders.indexOf(r);d>=0&&this._rangeReaders.splice(d,1)}getFullReader(){(0,t.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const r=this._queuedChunks;return this._queuedChunks=null,new i(this,r,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(r,d){if(d<=this._progressiveDataLength)return null;const h=new s(this,r,d);return this._pdfDataRangeTransport.requestDataRange(r,d),this._rangeReaders.push(h),h}cancelAllRequests(r){this._fullRequestReader&&this._fullRequestReader.cancel(r),this._rangeReaders.slice(0).forEach(function(h){h.cancel(r)}),this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=a;class i{constructor(r,d,h=!1,m=null){this._stream=r,this._done=h||!1,this._filename=(0,l.isPdfFile)(m)?m:null,this._queuedChunks=d||[],this._loaded=0;for(const f of this._queuedChunks)this._loaded+=f.byteLength;this._requests=[],this._headersReady=Promise.resolve(),r._fullRequestReader=this,this.onProgress=null}_enqueue(r){this._done||(this._requests.length>0?this._requests.shift().resolve({value:r,done:!1}):this._queuedChunks.push(r),this._loaded+=r.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const r=(0,t.createPromiseCapability)();return this._requests.push(r),r.promise}cancel(r){this._done=!0,this._requests.forEach(function(d){d.resolve({value:void 0,done:!0})}),this._requests=[]}progressiveDone(){this._done||(this._done=!0)}}class s{constructor(r,d,h){this._stream=r,this._begin=d,this._end=h,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(r){this._done||(this._requests.length===0?this._queuedChunk=r:(this._requests.shift().resolve({value:r,done:!1}),this._requests.forEach(function(h){h.resolve({value:void 0,done:!0})}),this._requests=[]),this._done=!0,this._stream._removeRangeReader(this))}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const d=this._queuedChunk;return this._queuedChunk=null,{value:d,done:!1}}if(this._done)return{value:void 0,done:!0};const r=(0,t.createPromiseCapability)();return this._requests.push(r),r.promise}cancel(r){this._done=!0,this._requests.forEach(function(d){d.resolve({value:void 0,done:!0})}),this._requests=[],this._stream._removeRangeReader(this)}}},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WebGLContext=void 0;var t=o(2);class l{constructor({enable:s=!1}){this._enabled=s===!0}get isEnabled(){let s=this._enabled;return s&&(s=a.tryInitGL()),(0,t.shadow)(this,"isEnabled",s)}composeSMask({layer:s,mask:c,properties:r}){return a.composeSMask(s,c,r)}drawFigures({width:s,height:c,backgroundColor:r,figures:d,context:h}){return a.drawFigures(s,c,r,d,h)}clear(){a.cleanup()}}n.WebGLContext=l;const a=function(){function s(T,k,P){const S=T.createShader(P);if(T.shaderSource(S,k),T.compileShader(S),!T.getShaderParameter(S,T.COMPILE_STATUS)){const K=T.getShaderInfoLog(S);throw new Error("Error during shader compilation: "+K)}return S}function c(T,k){return s(T,k,T.VERTEX_SHADER)}function r(T,k){return s(T,k,T.FRAGMENT_SHADER)}function d(T,k){const P=T.createProgram();for(let F=0,K=k.length;F<K;++F)T.attachShader(P,k[F]);if(T.linkProgram(P),!T.getProgramParameter(P,T.LINK_STATUS)){const F=T.getProgramInfoLog(P);throw new Error("Error during program linking: "+F)}return P}function h(T,k,P){T.activeTexture(P);const S=T.createTexture();return T.bindTexture(T.TEXTURE_2D,S),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.NEAREST),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.NEAREST),T.texImage2D(T.TEXTURE_2D,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,k),S}let m,f;function g(){m||(f=document.createElement("canvas"),m=f.getContext("webgl",{premultipliedalpha:!1}))}const x="  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             ",b="  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ";let A=null;function M(){g();const T=f;f=null;const k=m;m=null;const P=c(k,x),S=r(k,b),F=d(k,[P,S]);k.useProgram(F);const K={};K.gl=k,K.canvas=T,K.resolutionLocation=k.getUniformLocation(F,"u_resolution"),K.positionLocation=k.getAttribLocation(F,"a_position"),K.backdropLocation=k.getUniformLocation(F,"u_backdrop"),K.subtypeLocation=k.getUniformLocation(F,"u_subtype");const Q=k.getAttribLocation(F,"a_texCoord"),Z=k.getUniformLocation(F,"u_image"),B=k.getUniformLocation(F,"u_mask"),G=k.createBuffer();k.bindBuffer(k.ARRAY_BUFFER,G),k.bufferData(k.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),k.STATIC_DRAW),k.enableVertexAttribArray(Q),k.vertexAttribPointer(Q,2,k.FLOAT,!1,0,0),k.uniform1i(Z,0),k.uniform1i(B,1),A=K}function L(T,k,P){const S=T.width,F=T.height;A||M();const K=A,Q=K.canvas,Z=K.gl;Q.width=S,Q.height=F,Z.viewport(0,0,Z.drawingBufferWidth,Z.drawingBufferHeight),Z.uniform2f(K.resolutionLocation,S,F),P.backdrop?Z.uniform4f(K.resolutionLocation,P.backdrop[0],P.backdrop[1],P.backdrop[2],1):Z.uniform4f(K.resolutionLocation,0,0,0,0),Z.uniform1i(K.subtypeLocation,P.subtype==="Luminosity"?1:0);const B=h(Z,T,Z.TEXTURE0),G=h(Z,k,Z.TEXTURE1),w=Z.createBuffer();return Z.bindBuffer(Z.ARRAY_BUFFER,w),Z.bufferData(Z.ARRAY_BUFFER,new Float32Array([0,0,S,0,0,F,0,F,S,0,S,F]),Z.STATIC_DRAW),Z.enableVertexAttribArray(K.positionLocation),Z.vertexAttribPointer(K.positionLocation,2,Z.FLOAT,!1,0,0),Z.clearColor(0,0,0,0),Z.enable(Z.BLEND),Z.blendFunc(Z.ONE,Z.ONE_MINUS_SRC_ALPHA),Z.clear(Z.COLOR_BUFFER_BIT),Z.drawArrays(Z.TRIANGLES,0,6),Z.flush(),Z.deleteTexture(B),Z.deleteTexture(G),Z.deleteBuffer(w),Q}const C="  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             ",u="  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ";let _=null;function y(){g();const T=f;f=null;const k=m;m=null;const P=c(k,C),S=r(k,u),F=d(k,[P,S]);k.useProgram(F);const K={};K.gl=k,K.canvas=T,K.resolutionLocation=k.getUniformLocation(F,"u_resolution"),K.scaleLocation=k.getUniformLocation(F,"u_scale"),K.offsetLocation=k.getUniformLocation(F,"u_offset"),K.positionLocation=k.getAttribLocation(F,"a_position"),K.colorLocation=k.getAttribLocation(F,"a_color"),_=K}function v(T,k,P,S,F){_||y();const K=_,Q=K.canvas,Z=K.gl;Q.width=T,Q.height=k,Z.viewport(0,0,Z.drawingBufferWidth,Z.drawingBufferHeight),Z.uniform2f(K.resolutionLocation,T,k);let B=0;for(let oe=0,pe=S.length;oe<pe;oe++)switch(S[oe].type){case"lattice":const me=S[oe].coords.length/S[oe].verticesPerRow|0;B+=(me-1)*(S[oe].verticesPerRow-1)*6;break;case"triangles":B+=S[oe].coords.length;break}const G=new Float32Array(B*2),w=new Uint8Array(B*3),D=F.coords,U=F.colors;let q=0,j=0;for(let oe=0,pe=S.length;oe<pe;oe++){const me=S[oe],Ee=me.coords,X=me.colors;switch(me.type){case"lattice":const N=me.verticesPerRow,te=Ee.length/N|0;for(let re=1;re<te;re++){let se=re*N+1;for(let ve=1;ve<N;ve++,se++)G[q]=D[Ee[se-N-1]],G[q+1]=D[Ee[se-N-1]+1],G[q+2]=D[Ee[se-N]],G[q+3]=D[Ee[se-N]+1],G[q+4]=D[Ee[se-1]],G[q+5]=D[Ee[se-1]+1],w[j]=U[X[se-N-1]],w[j+1]=U[X[se-N-1]+1],w[j+2]=U[X[se-N-1]+2],w[j+3]=U[X[se-N]],w[j+4]=U[X[se-N]+1],w[j+5]=U[X[se-N]+2],w[j+6]=U[X[se-1]],w[j+7]=U[X[se-1]+1],w[j+8]=U[X[se-1]+2],G[q+6]=G[q+2],G[q+7]=G[q+3],G[q+8]=G[q+4],G[q+9]=G[q+5],G[q+10]=D[Ee[se]],G[q+11]=D[Ee[se]+1],w[j+9]=w[j+3],w[j+10]=w[j+4],w[j+11]=w[j+5],w[j+12]=w[j+6],w[j+13]=w[j+7],w[j+14]=w[j+8],w[j+15]=U[X[se]],w[j+16]=U[X[se]+1],w[j+17]=U[X[se]+2],q+=12,j+=18}break;case"triangles":for(let re=0,se=Ee.length;re<se;re++)G[q]=D[Ee[re]],G[q+1]=D[Ee[re]+1],w[j]=U[X[re]],w[j+1]=U[X[re]+1],w[j+2]=U[X[re]+2],q+=2,j+=3;break}}P?Z.clearColor(P[0]/255,P[1]/255,P[2]/255,1):Z.clearColor(0,0,0,0),Z.clear(Z.COLOR_BUFFER_BIT);const Y=Z.createBuffer();Z.bindBuffer(Z.ARRAY_BUFFER,Y),Z.bufferData(Z.ARRAY_BUFFER,G,Z.STATIC_DRAW),Z.enableVertexAttribArray(K.positionLocation),Z.vertexAttribPointer(K.positionLocation,2,Z.FLOAT,!1,0,0);const J=Z.createBuffer();return Z.bindBuffer(Z.ARRAY_BUFFER,J),Z.bufferData(Z.ARRAY_BUFFER,w,Z.STATIC_DRAW),Z.enableVertexAttribArray(K.colorLocation),Z.vertexAttribPointer(K.colorLocation,3,Z.UNSIGNED_BYTE,!1,0,0),Z.uniform2f(K.scaleLocation,F.scaleX,F.scaleY),Z.uniform2f(K.offsetLocation,F.offsetX,F.offsetY),Z.drawArrays(Z.TRIANGLES,0,B),Z.flush(),Z.deleteBuffer(Y),Z.deleteBuffer(J),Q}return{tryInitGL(){try{return g(),!!m}catch{}return!1},composeSMask:L,drawFigures:v,cleanup(){A!=null&&A.canvas&&(A.canvas.width=0,A.canvas.height=0),_!=null&&_.canvas&&(_.canvas.width=0,_.canvas.height=0),A=null,_=null}}}()},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationLayer=void 0;var t=o(1),l=o(2),a=o(8),i=o(19);class s{static create(w){switch(w.data.annotationType){case l.AnnotationType.LINK:return new r(w);case l.AnnotationType.TEXT:return new d(w);case l.AnnotationType.WIDGET:switch(w.data.fieldType){case"Tx":return new m(w);case"Btn":return w.data.radioButton?new g(w):w.data.checkBox?new f(w):new x(w);case"Ch":return new b(w)}return new h(w);case l.AnnotationType.POPUP:return new A(w);case l.AnnotationType.FREETEXT:return new L(w);case l.AnnotationType.LINE:return new C(w);case l.AnnotationType.SQUARE:return new u(w);case l.AnnotationType.CIRCLE:return new _(w);case l.AnnotationType.POLYLINE:return new y(w);case l.AnnotationType.CARET:return new T(w);case l.AnnotationType.INK:return new k(w);case l.AnnotationType.POLYGON:return new v(w);case l.AnnotationType.HIGHLIGHT:return new P(w);case l.AnnotationType.UNDERLINE:return new S(w);case l.AnnotationType.SQUIGGLY:return new F(w);case l.AnnotationType.STRIKEOUT:return new K(w);case l.AnnotationType.STAMP:return new Q(w);case l.AnnotationType.FILEATTACHMENT:return new Z(w);default:return new c(w)}}}class c{constructor(w,{isRenderable:D=!1,ignoreBorder:U=!1,createQuadrilaterals:q=!1}={}){this.isRenderable=D,this.data=w.data,this.layer=w.layer,this.page=w.page,this.viewport=w.viewport,this.linkService=w.linkService,this.downloadManager=w.downloadManager,this.imageResourcesPath=w.imageResourcesPath,this.renderInteractiveForms=w.renderInteractiveForms,this.svgFactory=w.svgFactory,this.annotationStorage=w.annotationStorage,this.enableScripting=w.enableScripting,this.hasJSActions=w.hasJSActions,this._mouseState=w.mouseState,D&&(this.container=this._createContainer(U)),q&&(this.quadrilaterals=this._createQuadrilaterals(U))}_createContainer(w=!1){const D=this.data,U=this.page,q=this.viewport,j=document.createElement("section");let Y=D.rect[2]-D.rect[0],J=D.rect[3]-D.rect[1];j.setAttribute("data-annotation-id",D.id);const oe=l.Util.normalizeRect([D.rect[0],U.view[3]-D.rect[1]+U.view[1],D.rect[2],U.view[3]-D.rect[3]+U.view[1]]);if(j.style.transform=`matrix(${q.transform.join(",")})`,j.style.transformOrigin=`${-oe[0]}px ${-oe[1]}px`,!w&&D.borderStyle.width>0){j.style.borderWidth=`${D.borderStyle.width}px`,D.borderStyle.style!==l.AnnotationBorderStyleType.UNDERLINE&&(Y=Y-2*D.borderStyle.width,J=J-2*D.borderStyle.width);const pe=D.borderStyle.horizontalCornerRadius,me=D.borderStyle.verticalCornerRadius;if(pe>0||me>0){const Ee=`${pe}px / ${me}px`;j.style.borderRadius=Ee}switch(D.borderStyle.style){case l.AnnotationBorderStyleType.SOLID:j.style.borderStyle="solid";break;case l.AnnotationBorderStyleType.DASHED:j.style.borderStyle="dashed";break;case l.AnnotationBorderStyleType.BEVELED:(0,l.warn)("Unimplemented border style: beveled");break;case l.AnnotationBorderStyleType.INSET:(0,l.warn)("Unimplemented border style: inset");break;case l.AnnotationBorderStyleType.UNDERLINE:j.style.borderBottomStyle="solid";break}D.color?j.style.borderColor=l.Util.makeHexColor(D.color[0]|0,D.color[1]|0,D.color[2]|0):j.style.borderWidth=0}return j.style.left=`${oe[0]}px`,j.style.top=`${oe[1]}px`,j.style.width=`${Y}px`,j.style.height=`${J}px`,j}_createQuadrilaterals(w=!1){if(!this.data.quadPoints)return null;const D=[],U=this.data.rect;for(const q of this.data.quadPoints)this.data.rect=[q[2].x,q[2].y,q[1].x,q[1].y],D.push(this._createContainer(w));return this.data.rect=U,D}_createPopup(w,D){let U=this.container;this.quadrilaterals&&(w=w||this.quadrilaterals,U=this.quadrilaterals[0]),w||(w=document.createElement("div"),w.style.height=U.style.height,w.style.width=U.style.width,U.appendChild(w));const j=new M({container:U,trigger:w,color:D.color,title:D.title,modificationDate:D.modificationDate,contents:D.contents,hideWrapper:!0}).render();j.style.left=U.style.width,U.appendChild(j)}_renderQuadrilaterals(w){return this.quadrilaterals.forEach(D=>{D.className=w}),this.quadrilaterals}render(){(0,l.unreachable)("Abstract method `AnnotationElement.render` called")}}class r extends c{constructor(w){const D=!!(w.data.url||w.data.dest||w.data.action||w.data.isTooltipOnly||w.data.actions&&(w.data.actions.Action||w.data.actions["Mouse Up"]||w.data.actions["Mouse Down"]));super(w,{isRenderable:D,createQuadrilaterals:!0})}render(){const{data:w,linkService:D}=this,U=document.createElement("a");return w.url?(0,t.addLinkAttributes)(U,{url:w.url,target:w.newWindow?t.LinkTarget.BLANK:D.externalLinkTarget,rel:D.externalLinkRel,enabled:D.externalLinkEnabled}):w.action?this._bindNamedAction(U,w.action):w.dest?this._bindLink(U,w.dest):w.actions&&(w.actions.Action||w.actions["Mouse Up"]||w.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions?this._bindJSAction(U,w):this._bindLink(U,""),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((q,j)=>{const Y=j===0?U:U.cloneNode();return q.appendChild(Y),q}):(this.container.className="linkAnnotation",this.container.appendChild(U),this.container)}_bindLink(w,D){w.href=this.linkService.getDestinationHash(D),w.onclick=()=>(D&&this.linkService.goToDestination(D),!1),(D||D==="")&&(w.className="internalLink")}_bindNamedAction(w,D){w.href=this.linkService.getAnchorUrl(""),w.onclick=()=>(this.linkService.executeNamedAction(D),!1),w.className="internalLink"}_bindJSAction(w,D){w.href=this.linkService.getAnchorUrl("");const U=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const q of Object.keys(D.actions)){const j=U.get(q);j&&(w[j]=()=>{var Y;return(Y=this.linkService.eventBus)==null||Y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:D.id,name:q}}),!1})}w.className="internalLink"}}class d extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D})}render(){this.container.className="textAnnotation";const w=document.createElement("img");return w.style.height=this.container.style.height,w.style.width=this.container.style.width,w.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",w.alt="[{{type}} Annotation]",w.dataset.l10nId="text_annotation_type",w.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(w,this.data),this.container.appendChild(w),this.container}}class h extends c{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(w){return navigator.platform.includes("Win")&&w.ctrlKey||navigator.platform.includes("Mac")&&w.metaKey}_setEventListener(w,D,U,q){D.includes("mouse")?w.addEventListener(D,j=>{var Y;(Y=this.linkService.eventBus)==null||Y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:U,value:q(j),shift:j.shiftKey,modifier:this._getKeyModifier(j)}})}):w.addEventListener(D,j=>{var Y;(Y=this.linkService.eventBus)==null||Y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:U,value:j.target.checked}})})}_setEventListeners(w,D,U){var q;for(const[j,Y]of D)(Y==="Action"||(q=this.data.actions)!=null&&q[Y])&&this._setEventListener(w,j,Y,U)}_setColor(w){const{detail:D,target:U}=w,{style:q}=U;for(const j of["bgColor","fillColor","fgColor","textColor","borderColor","strokeColor"]){let Y=D[j];if(Y)switch(Y=i.ColorConverters[`${Y[0]}_HTML`](Y.slice(1)),j){case"bgColor":case"fillColor":q.backgroundColor=Y;break;case"fgColor":case"textColor":q.color=Y;break;case"borderColor":case"strokeColor":q.borderColor=Y;break}}}}class m extends h{constructor(w){const D=w.renderInteractiveForms||!w.data.hasAppearance&&!!w.data.fieldValue;super(w,{isRenderable:D})}render(){var q;const w=this.annotationStorage,D=this.data.id;this.container.className="textWidgetAnnotation";let U=null;if(this.renderInteractiveForms){const j=w.getValue(D,{value:this.data.fieldValue,valueAsString:this.data.fieldValue}),Y=j.valueAsString||j.value||"",J={userValue:null,formattedValue:null,beforeInputSelectionRange:null,beforeInputValue:null};this.data.multiLine?(U=document.createElement("textarea"),U.textContent=Y):(U=document.createElement("input"),U.type="text",U.setAttribute("value",Y)),J.userValue=Y,U.setAttribute("id",D),U.addEventListener("input",function(pe){w.setValue(D,{value:pe.target.value})});let oe=pe=>{J.formattedValue&&(pe.target.value=J.formattedValue),pe.target.setSelectionRange(0,0),J.beforeInputSelectionRange=null};if(this.enableScripting&&this.hasJSActions){U.addEventListener("focus",me=>{J.userValue&&(me.target.value=J.userValue)}),U.addEventListener("updatefromsandbox",me=>{const{detail:Ee}=me,X={value(){J.userValue=Ee.value||"",w.setValue(D,{value:J.userValue.toString()}),J.formattedValue||(me.target.value=J.userValue)},valueAsString(){J.formattedValue=Ee.valueAsString||"",me.target!==document.activeElement&&(me.target.value=J.formattedValue),w.setValue(D,{formattedValue:J.formattedValue})},focus(){setTimeout(()=>me.target.focus({preventScroll:!1}),0)},userName(){me.target.title=Ee.userName},hidden(){me.target.style.visibility=Ee.hidden?"hidden":"visible",w.setValue(D,{hidden:Ee.hidden})},editable(){me.target.disabled=!Ee.editable},selRange(){const[N,te]=Ee.selRange;N>=0&&te<me.target.value.length&&me.target.setSelectionRange(N,te)}};Object.keys(Ee).filter(N=>N in X).forEach(N=>X[N]()),this._setColor(me)}),U.addEventListener("keydown",me=>{var X;J.beforeInputValue=me.target.value;let Ee=-1;me.key==="Escape"?Ee=0:me.key==="Enter"?Ee=2:me.key==="Tab"&&(Ee=3),Ee!==-1&&(J.userValue=me.target.value,(X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:D,name:"Keystroke",value:me.target.value,willCommit:!0,commitKey:Ee,selStart:me.target.selectionStart,selEnd:me.target.selectionEnd}}))});const pe=oe;oe=null,U.addEventListener("blur",me=>{var Ee;this._mouseState.isDown&&(J.userValue=me.target.value,(Ee=this.linkService.eventBus)==null||Ee.dispatch("dispatcheventinsandbox",{source:this,detail:{id:D,name:"Keystroke",value:me.target.value,willCommit:!0,commitKey:1,selStart:me.target.selectionStart,selEnd:me.target.selectionEnd}})),pe(me)}),U.addEventListener("mousedown",me=>{J.beforeInputValue=me.target.value,J.beforeInputSelectionRange=null}),U.addEventListener("keyup",me=>{me.target.selectionStart===me.target.selectionEnd&&(J.beforeInputSelectionRange=null)}),U.addEventListener("select",me=>{J.beforeInputSelectionRange=[me.target.selectionStart,me.target.selectionEnd]}),(q=this.data.actions)!=null&&q.Keystroke&&U.addEventListener("input",me=>{var N;let Ee=-1,X=-1;J.beforeInputSelectionRange&&([Ee,X]=J.beforeInputSelectionRange),(N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:D,name:"Keystroke",value:J.beforeInputValue,change:me.data,willCommit:!1,selStart:Ee,selEnd:X}})}),this._setEventListeners(U,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],me=>me.target.value)}if(oe&&U.addEventListener("blur",oe),U.disabled=this.data.readOnly,U.name=this.data.fieldName,this.data.maxLen!==null&&(U.maxLength=this.data.maxLen),this.data.comb){const me=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;U.classList.add("comb"),U.style.letterSpacing=`calc(${me}px - 1ch)`}}else U=document.createElement("div"),U.textContent=this.data.fieldValue,U.style.verticalAlign="middle",U.style.display="table-cell";return this._setTextStyle(U),this.container.appendChild(U),this.container}_setTextStyle(w){const D=["left","center","right"],{fontSize:U,fontColor:q}=this.data.defaultAppearanceData,j=w.style;U&&(j.fontSize=`${U}px`),j.color=l.Util.makeHexColor(q[0],q[1],q[2]),this.data.textAlignment!==null&&(j.textAlign=D[this.data.textAlignment])}}class f extends h{constructor(w){super(w,{isRenderable:w.renderInteractiveForms})}render(){const w=this.annotationStorage,D=this.data,U=D.id,q=w.getValue(U,{value:D.fieldValue&&(D.exportValue&&D.exportValue===D.fieldValue||!D.exportValue&&D.fieldValue!=="Off")}).value;this.container.className="buttonWidgetAnnotation checkBox";const j=document.createElement("input");return j.disabled=D.readOnly,j.type="checkbox",j.name=this.data.fieldName,q&&j.setAttribute("checked",!0),j.setAttribute("id",U),j.addEventListener("change",function(Y){const J=Y.target.name;for(const oe of document.getElementsByName(J))oe!==Y.target&&(oe.checked=!1,w.setValue(oe.parentNode.getAttribute("data-annotation-id"),{value:!1}));w.setValue(U,{value:Y.target.checked})}),this.enableScripting&&this.hasJSActions&&(j.addEventListener("updatefromsandbox",Y=>{const{detail:J}=Y,oe={value(){Y.target.checked=J.value!=="Off",w.setValue(U,{value:Y.target.checked})},focus(){setTimeout(()=>Y.target.focus({preventScroll:!1}),0)},hidden(){Y.target.style.visibility=J.hidden?"hidden":"visible",w.setValue(U,{hidden:J.hidden})},editable(){Y.target.disabled=!J.editable}};Object.keys(J).filter(pe=>pe in oe).forEach(pe=>oe[pe]()),this._setColor(Y)}),this._setEventListeners(j,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Y=>Y.target.checked)),this.container.appendChild(j),this.container}}class g extends h{constructor(w){super(w,{isRenderable:w.renderInteractiveForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const w=this.annotationStorage,D=this.data,U=D.id,q=w.getValue(U,{value:D.fieldValue===D.buttonValue}).value,j=document.createElement("input");if(j.disabled=D.readOnly,j.type="radio",j.name=D.fieldName,q&&j.setAttribute("checked",!0),j.setAttribute("id",U),j.addEventListener("change",function(Y){const{target:J}=Y;for(const oe of document.getElementsByName(J.name))oe!==J&&w.setValue(oe.getAttribute("id"),{value:!1});w.setValue(U,{value:J.checked})}),this.enableScripting&&this.hasJSActions){const Y=D.buttonValue;j.addEventListener("updatefromsandbox",J=>{const{detail:oe}=J,pe={value(){const me=Y===oe.value;for(const Ee of document.getElementsByName(J.target.name)){const X=Ee.getAttribute("id");Ee.checked=X===U&&me,w.setValue(X,{value:Ee.checked})}},focus(){setTimeout(()=>J.target.focus({preventScroll:!1}),0)},hidden(){J.target.style.visibility=oe.hidden?"hidden":"visible",w.setValue(U,{hidden:oe.hidden})},editable(){J.target.disabled=!oe.editable}};Object.keys(oe).filter(me=>me in pe).forEach(me=>pe[me]()),this._setColor(J)}),this._setEventListeners(j,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],J=>J.target.checked)}return this.container.appendChild(j),this.container}}class x extends r{render(){const w=super.render();return w.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(w.title=this.data.alternativeText),w}}class b extends h{constructor(w){super(w,{isRenderable:w.renderInteractiveForms})}render(){this.container.className="choiceWidgetAnnotation";const w=this.annotationStorage,D=this.data.id;w.getValue(D,{value:this.data.fieldValue.length>0?this.data.fieldValue[0]:void 0});const U=document.createElement("select");U.disabled=this.data.readOnly,U.name=this.data.fieldName,U.setAttribute("id",D),this.data.combo||(U.size=this.data.options.length,this.data.multiSelect&&(U.multiple=!0));for(const Y of this.data.options){const J=document.createElement("option");J.textContent=Y.displayValue,J.value=Y.exportValue,this.data.fieldValue.includes(Y.exportValue)&&J.setAttribute("selected",!0),U.appendChild(J)}const q=(Y,J)=>{const oe=J?"value":"textContent",pe=Y.target.options;return Y.target.multiple?Array.prototype.filter.call(pe,me=>me.selected).map(me=>me[oe]):pe.selectedIndex===-1?null:pe[pe.selectedIndex][oe]},j=Y=>{const J=Y.target.options;return Array.prototype.map.call(J,oe=>({displayValue:oe.textContent,exportValue:oe.value}))};return this.enableScripting&&this.hasJSActions?(U.addEventListener("updatefromsandbox",Y=>{const{detail:J}=Y,oe={value(){const pe=U.options,me=J.value,Ee=new Set(Array.isArray(me)?me:[me]);Array.prototype.forEach.call(pe,X=>{X.selected=Ee.has(X.value)}),w.setValue(D,{value:q(Y,!0)})},multipleSelection(){U.multiple=!0},remove(){const pe=U.options,me=J.remove;pe[me].selected=!1,U.remove(me),pe.length>0&&Array.prototype.findIndex.call(pe,X=>X.selected)===-1&&(pe[0].selected=!0),w.setValue(D,{value:q(Y,!0),items:j(Y)})},clear(){for(;U.length!==0;)U.remove(0);w.setValue(D,{value:null,items:[]})},insert(){const{index:pe,displayValue:me,exportValue:Ee}=J.insert,X=document.createElement("option");X.textContent=me,X.value=Ee,U.insertBefore(X,U.children[pe]),w.setValue(D,{value:q(Y,!0),items:j(Y)})},items(){const{items:pe}=J;for(;U.length!==0;)U.remove(0);for(const me of pe){const{displayValue:Ee,exportValue:X}=me,N=document.createElement("option");N.textContent=Ee,N.value=X,U.appendChild(N)}U.options.length>0&&(U.options[0].selected=!0),w.setValue(D,{value:q(Y,!0),items:j(Y)})},indices(){const pe=new Set(J.indices),me=Y.target.options;Array.prototype.forEach.call(me,(Ee,X)=>{Ee.selected=pe.has(X)}),w.setValue(D,{value:q(Y,!0)})},focus(){setTimeout(()=>Y.target.focus({preventScroll:!1}),0)},hidden(){Y.target.style.visibility=J.hidden?"hidden":"visible",w.setValue(D,{hidden:J.hidden})},editable(){Y.target.disabled=!J.editable}};Object.keys(J).filter(pe=>pe in oe).forEach(pe=>oe[pe]()),this._setColor(Y)}),U.addEventListener("input",Y=>{var pe;const J=q(Y,!0),oe=q(Y,!1);w.setValue(D,{value:J}),(pe=this.linkService.eventBus)==null||pe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:D,name:"Keystroke",value:oe,changeEx:J,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(U,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],Y=>Y.target.checked)):U.addEventListener("input",function(Y){w.setValue(D,{value:q(Y)})}),this.container.appendChild(U),this.container}}class A extends c{constructor(w){const D=!!(w.data.title||w.data.contents);super(w,{isRenderable:D})}render(){const w=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",w.includes(this.data.parentType))return this.container;const D=`[data-annotation-id="${this.data.parentId}"]`,U=this.layer.querySelectorAll(D);if(U.length===0)return this.container;const q=new M({container:this.container,trigger:Array.from(U),color:this.data.color,title:this.data.title,modificationDate:this.data.modificationDate,contents:this.data.contents}),j=this.page,Y=l.Util.normalizeRect([this.data.parentRect[0],j.view[3]-this.data.parentRect[1]+j.view[1],this.data.parentRect[2],j.view[3]-this.data.parentRect[3]+j.view[1]]),J=Y[0]+this.data.parentRect[2]-this.data.parentRect[0],oe=Y[1];return this.container.style.transformOrigin=`${-J}px ${-oe}px`,this.container.style.left=`${J}px`,this.container.style.top=`${oe}px`,this.container.appendChild(q.render()),this.container}}class M{constructor(w){this.container=w.container,this.trigger=w.trigger,this.color=w.color,this.title=w.title,this.modificationDate=w.modificationDate,this.contents=w.contents,this.hideWrapper=w.hideWrapper||!1,this.pinned=!1}render(){const D=document.createElement("div");D.className="popupWrapper",this.hideElement=this.hideWrapper?D:this.container,this.hideElement.hidden=!0;const U=document.createElement("div");U.className="popup";const q=this.color;if(q){const oe=.7*(255-q[0])+q[0],pe=.7*(255-q[1])+q[1],me=.7*(255-q[2])+q[2];U.style.backgroundColor=l.Util.makeHexColor(oe|0,pe|0,me|0)}const j=document.createElement("h1");j.textContent=this.title,U.appendChild(j);const Y=t.PDFDateString.toDateObject(this.modificationDate);if(Y){const oe=document.createElement("span");oe.textContent="{{date}}, {{time}}",oe.dataset.l10nId="annotation_date_string",oe.dataset.l10nArgs=JSON.stringify({date:Y.toLocaleDateString(),time:Y.toLocaleTimeString()}),U.appendChild(oe)}const J=this._formatContents(this.contents);return U.appendChild(J),Array.isArray(this.trigger)||(this.trigger=[this.trigger]),this.trigger.forEach(oe=>{oe.addEventListener("click",this._toggle.bind(this)),oe.addEventListener("mouseover",this._show.bind(this,!1)),oe.addEventListener("mouseout",this._hide.bind(this,!1))}),U.addEventListener("click",this._hide.bind(this,!0)),D.appendChild(U),D}_formatContents(w){const D=document.createElement("p"),U=w.split(/(?:\r\n?|\n)/);for(let q=0,j=U.length;q<j;++q){const Y=U[q];D.appendChild(document.createTextNode(Y)),q<j-1&&D.appendChild(document.createElement("br"))}return D}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(w=!1){w&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(w=!0){w&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class L extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D,ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class C extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const w=this.data,D=w.rect[2]-w.rect[0],U=w.rect[3]-w.rect[1],q=this.svgFactory.create(D,U),j=this.svgFactory.createElement("svg:line");return j.setAttribute("x1",w.rect[2]-w.lineCoordinates[0]),j.setAttribute("y1",w.rect[3]-w.lineCoordinates[1]),j.setAttribute("x2",w.rect[2]-w.lineCoordinates[2]),j.setAttribute("y2",w.rect[3]-w.lineCoordinates[3]),j.setAttribute("stroke-width",w.borderStyle.width||1),j.setAttribute("stroke","transparent"),q.appendChild(j),this.container.append(q),this._createPopup(j,w),this.container}}class u extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const w=this.data,D=w.rect[2]-w.rect[0],U=w.rect[3]-w.rect[1],q=this.svgFactory.create(D,U),j=w.borderStyle.width,Y=this.svgFactory.createElement("svg:rect");return Y.setAttribute("x",j/2),Y.setAttribute("y",j/2),Y.setAttribute("width",D-j),Y.setAttribute("height",U-j),Y.setAttribute("stroke-width",j||1),Y.setAttribute("stroke","transparent"),Y.setAttribute("fill","none"),q.appendChild(Y),this.container.append(q),this._createPopup(Y,w),this.container}}class _ extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const w=this.data,D=w.rect[2]-w.rect[0],U=w.rect[3]-w.rect[1],q=this.svgFactory.create(D,U),j=w.borderStyle.width,Y=this.svgFactory.createElement("svg:ellipse");return Y.setAttribute("cx",D/2),Y.setAttribute("cy",U/2),Y.setAttribute("rx",D/2-j/2),Y.setAttribute("ry",U/2-j/2),Y.setAttribute("stroke-width",j||1),Y.setAttribute("stroke","transparent"),Y.setAttribute("fill","none"),q.appendChild(Y),this.container.append(q),this._createPopup(Y,w),this.container}}class y extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const w=this.data,D=w.rect[2]-w.rect[0],U=w.rect[3]-w.rect[1],q=this.svgFactory.create(D,U);let j=[];for(const J of w.vertices){const oe=J.x-w.rect[0],pe=w.rect[3]-J.y;j.push(oe+","+pe)}j=j.join(" ");const Y=this.svgFactory.createElement(this.svgElementName);return Y.setAttribute("points",j),Y.setAttribute("stroke-width",w.borderStyle.width||1),Y.setAttribute("stroke","transparent"),Y.setAttribute("fill","none"),q.appendChild(Y),this.container.append(q),this._createPopup(Y,w),this.container}}class v extends y{constructor(w){super(w),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class T extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class k extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const w=this.data,D=w.rect[2]-w.rect[0],U=w.rect[3]-w.rect[1],q=this.svgFactory.create(D,U);for(const j of w.inkLists){let Y=[];for(const oe of j){const pe=oe.x-w.rect[0],me=w.rect[3]-oe.y;Y.push(`${pe},${me}`)}Y=Y.join(" ");const J=this.svgFactory.createElement(this.svgElementName);J.setAttribute("points",Y),J.setAttribute("stroke-width",w.borderStyle.width||1),J.setAttribute("stroke","transparent"),J.setAttribute("fill","none"),this._createPopup(J,w),q.appendChild(J)}return this.container.append(q),this.container}}class P extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class S extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class F extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class K extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class Q extends c{constructor(w){const D=!!(w.data.hasPopup||w.data.title||w.data.contents);super(w,{isRenderable:D,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Z extends c{constructor(w){var q;super(w,{isRenderable:!0});const{filename:D,content:U}=this.data.file;this.filename=(0,t.getFilenameFromUrl)(D),this.content=U,(q=this.linkService.eventBus)==null||q.dispatch("fileattachmentannotation",{source:this,id:(0,l.stringToPDFString)(D),filename:D,content:U})}render(){this.container.className="fileAttachmentAnnotation";const w=document.createElement("div");return w.style.height=this.container.style.height,w.style.width=this.container.style.width,w.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.title||this.data.contents)&&this._createPopup(w,this.data),this.container.appendChild(w),this.container}_download(){var w;(w=this.downloadManager)==null||w.openOrDownloadData(this.container,this.content,this.filename)}}class B{static render(w){const D=[],U=[];for(const q of w.annotations)if(q){if(q.annotationType===l.AnnotationType.POPUP){U.push(q);continue}D.push(q)}U.length&&D.push(...U);for(const q of D){const j=s.create({data:q,layer:w.div,page:w.page,viewport:w.viewport,linkService:w.linkService,downloadManager:w.downloadManager,imageResourcesPath:w.imageResourcesPath||"",renderInteractiveForms:w.renderInteractiveForms!==!1,svgFactory:new t.DOMSVGFactory,annotationStorage:w.annotationStorage||new a.AnnotationStorage,enableScripting:w.enableScripting,hasJSActions:w.hasJSActions,mouseState:w.mouseState||{isDown:!1}});if(j.isRenderable){const Y=j.render();if(q.hidden&&(Y.style.visibility="hidden"),Array.isArray(Y))for(const J of Y)w.div.appendChild(J);else j instanceof A?w.div.prepend(Y):w.div.appendChild(Y)}}}static update(w){const D=`matrix(${w.viewport.transform.join(",")})`;for(const U of w.annotations){const q=w.div.querySelectorAll(`[data-annotation-id="${U.id}"]`);q&&q.forEach(j=>{j.style.transform=D})}w.div.hidden=!1}}n.AnnotationLayer=B},(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function o(l){return Math.floor(Math.max(0,Math.min(1,l))*255).toString(16).padStart(2,"0")}class t{static CMYK_G([a,i,s,c]){return["G",1-Math.min(1,.3*a+.59*s+.11*i+c)]}static G_CMYK([a]){return["CMYK",0,0,0,1-a]}static G_RGB([a]){return["RGB",a,a,a]}static G_HTML([a]){const i=o(a);return`#${i}${i}${i}`}static RGB_G([a,i,s]){return["G",.3*a+.59*i+.11*s]}static RGB_HTML([a,i,s]){const c=o(a),r=o(i),d=o(s);return`#${c}${r}${d}`}static T_HTML(){return"#00000000"}static CMYK_RGB([a,i,s,c]){return["RGB",1-Math.min(1,a+c),1-Math.min(1,s+c),1-Math.min(1,i+c)]}static CMYK_HTML(a){return this.RGB_HTML(this.CMYK_RGB(a))}static RGB_CMYK([a,i,s]){const c=1-a,r=1-i,d=1-s,h=Math.min(c,r,d);return["CMYK",c,r,d,h]}}n.ColorConverters=t},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.renderTextLayer=void 0;var t=o(2);const l=function(){const r=new Map,d=/\S/;function h(u){return!d.test(u)}function m(u,_){const y=r.get(u);if(y)return y;_.save(),_.font=`30px ${u}`;const v=_.measureText("");let T=v.fontBoundingBoxAscent,k=Math.abs(v.fontBoundingBoxDescent);if(T){_.restore();const S=T/(T+k);return r.set(u,S),S}_.strokeStyle="red",_.clearRect(0,0,30,30),_.strokeText("g",0,0);let P=_.getImageData(0,0,30,30).data;k=0;for(let S=P.length-1-3;S>=0;S-=4)if(P[S]>0){k=Math.ceil(S/4/30);break}_.clearRect(0,0,30,30),_.strokeText("A",0,30),P=_.getImageData(0,0,30,30).data,T=0;for(let S=0,F=P.length;S<F;S+=4)if(P[S]>0){T=30-Math.floor(S/4/30);break}if(_.restore(),T){const S=T/(T+k);return r.set(u,S),S}return r.set(u,.8),.8}function f(u,_,y,v){const T=document.createElement("span"),k={angle:0,canvasWidth:0,isWhitespace:!1,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};if(u._textDivs.push(T),h(_.str)){k.isWhitespace=!0,u._textDivProperties.set(T,k);return}const P=t.Util.transform(u._viewport.transform,_.transform);let S=Math.atan2(P[1],P[0]);const F=y[_.fontName];F.vertical&&(S+=Math.PI/2);const K=Math.hypot(P[2],P[3]),Q=K*m(F.fontFamily,v);let Z,B;S===0?(Z=P[4],B=P[5]-Q):(Z=P[4]+Q*Math.sin(S),B=P[5]-Q*Math.cos(S)),T.style.left=`${Z}px`,T.style.top=`${B}px`,T.style.fontSize=`${K}px`,T.style.fontFamily=F.fontFamily,T.textContent=_.str,T.dir=_.dir,u._fontInspectorEnabled&&(T.dataset.fontName=_.fontName),S!==0&&(k.angle=S*(180/Math.PI));let G=!1;if(_.str.length>1)G=!0;else if(_.transform[0]!==_.transform[3]){const w=Math.abs(_.transform[0]),D=Math.abs(_.transform[3]);w!==D&&Math.max(w,D)/Math.min(w,D)>1.5&&(G=!0)}if(G&&(F.vertical?k.canvasWidth=_.height*u._viewport.scale:k.canvasWidth=_.width*u._viewport.scale),u._textDivProperties.set(T,k),u._textContentStream&&u._layoutText(T),u._enhanceTextSelection){let w=1,D=0;S!==0&&(w=Math.cos(S),D=Math.sin(S));const U=(F.vertical?_.height:_.width)*u._viewport.scale,q=K;let j,Y;S!==0?(j=[w,D,-D,w,Z,B],Y=t.Util.getAxialAlignedBoundingBox([0,0,U,q],j)):Y=[Z,B,Z+U,B+q],u._bounds.push({left:Y[0],top:Y[1],right:Y[2],bottom:Y[3],div:T,size:[U,q],m:j})}}function g(u){if(u._canceled)return;const _=u._textDivs,y=u._capability,v=_.length;if(v>1e5){u._renderingDone=!0,y.resolve();return}if(!u._textContentStream)for(let T=0;T<v;T++)u._layoutText(_[T]);u._renderingDone=!0,y.resolve()}function x(u,_,y){let v=0;for(let T=0;T<y;T++){const k=u[_++];k>0&&(v=v?Math.min(k,v):k)}return v}function b(u){const _=u._bounds,y=u._viewport,v=A(y.width,y.height,_);for(let T=0;T<v.length;T++){const k=_[T].div,P=u._textDivProperties.get(k);if(P.angle===0){P.paddingLeft=_[T].left-v[T].left,P.paddingTop=_[T].top-v[T].top,P.paddingRight=v[T].right-_[T].right,P.paddingBottom=v[T].bottom-_[T].bottom,u._textDivProperties.set(k,P);continue}const S=v[T],F=_[T],K=F.m,Q=K[0],Z=K[1],B=[[0,0],[0,F.size[1]],[F.size[0],0],F.size],G=new Float64Array(64);B.forEach(function(D,U){const q=t.Util.applyTransform(D,K);G[U+0]=Q&&(S.left-q[0])/Q,G[U+4]=Z&&(S.top-q[1])/Z,G[U+8]=Q&&(S.right-q[0])/Q,G[U+12]=Z&&(S.bottom-q[1])/Z,G[U+16]=Z&&(S.left-q[0])/-Z,G[U+20]=Q&&(S.top-q[1])/Q,G[U+24]=Z&&(S.right-q[0])/-Z,G[U+28]=Q&&(S.bottom-q[1])/Q,G[U+32]=Q&&(S.left-q[0])/-Q,G[U+36]=Z&&(S.top-q[1])/-Z,G[U+40]=Q&&(S.right-q[0])/-Q,G[U+44]=Z&&(S.bottom-q[1])/-Z,G[U+48]=Z&&(S.left-q[0])/Z,G[U+52]=Q&&(S.top-q[1])/-Q,G[U+56]=Z&&(S.right-q[0])/Z,G[U+60]=Q&&(S.bottom-q[1])/-Q});const w=1+Math.min(Math.abs(Q),Math.abs(Z));P.paddingLeft=x(G,32,16)/w,P.paddingTop=x(G,48,16)/w,P.paddingRight=x(G,0,16)/w,P.paddingBottom=x(G,16,16)/w,u._textDivProperties.set(k,P)}}function A(u,_,y){const v=y.map(function(k,P){return{x1:k.left,y1:k.top,x2:k.right,y2:k.bottom,index:P,x1New:void 0,x2New:void 0}});M(u,v);const T=new Array(y.length);return v.forEach(function(k){const P=k.index;T[P]={left:k.x1New,top:0,right:k.x2New,bottom:0}}),y.map(function(k,P){const S=T[P],F=v[P];F.x1=k.top,F.y1=u-S.right,F.x2=k.bottom,F.y2=u-S.left,F.index=P,F.x1New=void 0,F.x2New=void 0}),M(_,v),v.forEach(function(k){const P=k.index;T[P].top=k.x1New,T[P].bottom=k.x2New}),T}function M(u,_){_.sort(function(T,k){return T.x1-k.x1||T.index-k.index});const v=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];_.forEach(function(T){let k=0;for(;k<v.length&&v[k].end<=T.y1;)k++;let P=v.length-1;for(;P>=0&&v[P].start>=T.y2;)P--;let S,F,K,Q,Z=-1/0;for(K=k;K<=P;K++){S=v[K],F=S.boundary;let w;F.x2>T.x1?w=F.index>T.index?F.x1New:T.x1:F.x2New===void 0?w=(F.x2+T.x1)/2:w=F.x2New,w>Z&&(Z=w)}for(T.x1New=Z,K=k;K<=P;K++)S=v[K],F=S.boundary,F.x2New===void 0?F.x2>T.x1?F.index>T.index&&(F.x2New=F.x2):F.x2New=Z:F.x2New>Z&&(F.x2New=Math.max(Z,F.x2));const B=[];let G=null;for(K=k;K<=P;K++){S=v[K],F=S.boundary;const w=F.x2>T.x2?F:T;G===w?B[B.length-1].end=S.end:(B.push({start:S.start,end:S.end,boundary:w}),G=w)}for(v[k].start<T.y1&&(B[0].start=T.y1,B.unshift({start:v[k].start,end:T.y1,boundary:v[k].boundary})),T.y2<v[P].end&&(B[B.length-1].end=T.y2,B.push({start:T.y2,end:v[P].end,boundary:v[P].boundary})),K=k;K<=P;K++){if(S=v[K],F=S.boundary,F.x2New!==void 0)continue;let w=!1;for(Q=k-1;!w&&Q>=0&&v[Q].start>=F.y1;Q--)w=v[Q].boundary===F;for(Q=P+1;!w&&Q<v.length&&v[Q].end<=F.y2;Q++)w=v[Q].boundary===F;for(Q=0;!w&&Q<B.length;Q++)w=B[Q].boundary===F;w||(F.x2New=Z)}Array.prototype.splice.apply(v,[k,P-k+1].concat(B))}),v.forEach(function(T){const k=T.boundary;k.x2New===void 0&&(k.x2New=Math.max(u,k.x2))})}function L({textContent:u,textContentStream:_,container:y,viewport:v,textDivs:T,textContentItemsStr:k,enhanceTextSelection:P}){var S;this._textContent=u,this._textContentStream=_,this._container=y,this._document=y.ownerDocument,this._viewport=v,this._textDivs=T||[],this._textContentItemsStr=k||[],this._enhanceTextSelection=!!P,this._fontInspectorEnabled=!!((S=globalThis.FontInspector)!=null&&S.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,t.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally(()=>{this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}L.prototype={get promise(){return this._capability.promise},cancel:function(){this._canceled=!0,this._reader&&(this._reader.cancel(new t.AbortException("TextLayer task cancelled.")),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))},_processItems(u,_){for(let y=0,v=u.length;y<v;y++)this._textContentItemsStr.push(u[y].str),f(this,u[y],_,this._layoutTextCtx)},_layoutText(u){const _=this._textDivProperties.get(u);if(_.isWhitespace)return;let y="";if(_.canvasWidth!==0){const{fontSize:v,fontFamily:T}=u.style;(v!==this._layoutTextLastFontSize||T!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${v} ${T}`,this._layoutTextLastFontSize=v,this._layoutTextLastFontFamily=T);const{width:k}=this._layoutTextCtx.measureText(u.textContent);k>0&&(_.scale=_.canvasWidth/k,y=`scaleX(${_.scale})`)}_.angle!==0&&(y=`rotate(${_.angle}deg) ${y}`),y.length>0&&(this._enhanceTextSelection&&(_.originalTransform=y),u.style.transform=y),this._textDivProperties.set(u,_),this._container.appendChild(u)},_render:function(_){const y=(0,t.createPromiseCapability)();let v=Object.create(null);const T=this._document.createElement("canvas");if(T.height=T.width=30,T.mozOpaque=!0,this._layoutTextCtx=T.getContext("2d",{alpha:!1}),this._textContent){const k=this._textContent.items,P=this._textContent.styles;this._processItems(k,P),y.resolve()}else if(this._textContentStream){const k=()=>{this._reader.read().then(({value:P,done:S})=>{if(S){y.resolve();return}Object.assign(v,P.styles),this._processItems(P.items,v),k()},y.reject)};this._reader=this._textContentStream.getReader(),k()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');y.promise.then(()=>{v=null,_?this._renderTimer=setTimeout(()=>{g(this),this._renderTimer=null},_):g(this)},this._capability.reject)},expandTextDivs:function(_){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(b(this),this._bounds=null);const y=[],v=[];for(let T=0,k=this._textDivs.length;T<k;T++){const P=this._textDivs[T],S=this._textDivProperties.get(P);S.isWhitespace||(_?(y.length=0,v.length=0,S.originalTransform&&y.push(S.originalTransform),S.paddingTop>0?(v.push(`${S.paddingTop}px`),y.push(`translateY(${-S.paddingTop}px)`)):v.push(0),S.paddingRight>0?v.push(`${S.paddingRight/S.scale}px`):v.push(0),S.paddingBottom>0?v.push(`${S.paddingBottom}px`):v.push(0),S.paddingLeft>0?(v.push(`${S.paddingLeft/S.scale}px`),y.push(`translateX(${-S.paddingLeft/S.scale}px)`)):v.push(0),P.style.padding=v.join(" "),y.length&&(P.style.transform=y.join(" "))):(P.style.padding=null,P.style.transform=S.originalTransform))}}};function C(u){const _=new L({textContent:u.textContent,textContentStream:u.textContentStream,container:u.container,viewport:u.viewport,textDivs:u.textDivs,textContentItemsStr:u.textContentItemsStr,enhanceTextSelection:u.enhanceTextSelection});return _._render(u.timeout),_}return C}();n.renderTextLayer=l},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var t=o(2),l=o(1),a=o(4);let i=function(){throw new Error("Not implemented: SVGGraphics")};n.SVGGraphics=i;{let A=function(y){let v=[];const T=[];for(const k of y){if(k.fn==="save"){v.push({fnId:92,fn:"group",items:[]}),T.push(v),v=v[v.length-1].items;continue}k.fn==="restore"?v=T.pop():v.push(k)}return v},M=function(y){if(Number.isInteger(y))return y.toString();const v=y.toFixed(10);let T=v.length-1;if(v[T]!=="0")return v;do T--;while(v[T]==="0");return v.substring(0,v[T]==="."?T:T+1)},L=function(y){if(y[4]===0&&y[5]===0){if(y[1]===0&&y[2]===0)return y[0]===1&&y[3]===1?"":`scale(${M(y[0])} ${M(y[3])})`;if(y[0]===y[3]&&y[1]===-y[2]){const v=Math.acos(y[0])*180/Math.PI;return`rotate(${M(v)})`}}else if(y[0]===1&&y[1]===0&&y[2]===0&&y[3]===1)return`translate(${M(y[4])} ${M(y[5])})`;return`matrix(${M(y[0])} ${M(y[1])} ${M(y[2])} ${M(y[3])} ${M(y[4])} ${M(y[5])})`};var s=A,c=M,r=L;const d={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},h="http://www.w3.org/XML/1998/namespace",m="http://www.w3.org/1999/xlink",f=["butt","round","square"],g=["miter","round","bevel"],x=function(){const y=new Uint8Array([137,80,78,71,13,10,26,10]),v=12,T=new Int32Array(256);for(let Z=0;Z<256;Z++){let B=Z;for(let G=0;G<8;G++)B&1?B=3988292384^B>>1&2147483647:B=B>>1&2147483647;T[Z]=B}function k(Z,B,G){let w=-1;for(let D=B;D<G;D++){const U=(w^Z[D])&255,q=T[U];w=w>>>8^q}return w^-1}function P(Z,B,G,w){let D=w;const U=B.length;G[D]=U>>24&255,G[D+1]=U>>16&255,G[D+2]=U>>8&255,G[D+3]=U&255,D+=4,G[D]=Z.charCodeAt(0)&255,G[D+1]=Z.charCodeAt(1)&255,G[D+2]=Z.charCodeAt(2)&255,G[D+3]=Z.charCodeAt(3)&255,D+=4,G.set(B,D),D+=B.length;const q=k(G,w+4,D);G[D]=q>>24&255,G[D+1]=q>>16&255,G[D+2]=q>>8&255,G[D+3]=q&255}function S(Z,B,G){let w=1,D=0;for(let U=B;U<G;++U)w=(w+(Z[U]&255))%65521,D=(D+w)%65521;return D<<16|w}function F(Z){if(!a.isNodeJS)return K(Z);try{let B;parseInt(process.versions.node)>=8?B=Z:B=Buffer.from(Z);const G=require("zlib").deflateSync(B,{level:9});return G instanceof Uint8Array?G:new Uint8Array(G)}catch(B){(0,t.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+B)}return K(Z)}function K(Z){let B=Z.length;const G=65535,w=Math.ceil(B/G),D=new Uint8Array(2+B+w*5+4);let U=0;D[U++]=120,D[U++]=156;let q=0;for(;B>G;)D[U++]=0,D[U++]=255,D[U++]=255,D[U++]=0,D[U++]=0,D.set(Z.subarray(q,q+G),U),U+=G,q+=G,B-=G;D[U++]=1,D[U++]=B&255,D[U++]=B>>8&255,D[U++]=~B&65535&255,D[U++]=(~B&65535)>>8&255,D.set(Z.subarray(q),U),U+=Z.length-q;const j=S(Z,0,Z.length);return D[U++]=j>>24&255,D[U++]=j>>16&255,D[U++]=j>>8&255,D[U++]=j&255,D}function Q(Z,B,G,w){const D=Z.width,U=Z.height;let q,j,Y;const J=Z.data;switch(B){case t.ImageKind.GRAYSCALE_1BPP:j=0,q=1,Y=D+7>>3;break;case t.ImageKind.RGB_24BPP:j=2,q=8,Y=D*3;break;case t.ImageKind.RGBA_32BPP:j=6,q=8,Y=D*4;break;default:throw new Error("invalid format")}const oe=new Uint8Array((1+Y)*U);let pe=0,me=0;for(let se=0;se<U;++se)oe[pe++]=0,oe.set(J.subarray(me,me+Y),pe),me+=Y,pe+=Y;if(B===t.ImageKind.GRAYSCALE_1BPP&&w){pe=0;for(let se=0;se<U;se++){pe++;for(let ve=0;ve<Y;ve++)oe[pe++]^=255}}const Ee=new Uint8Array([D>>24&255,D>>16&255,D>>8&255,D&255,U>>24&255,U>>16&255,U>>8&255,U&255,q,j,0,0,0]),X=F(oe),N=y.length+v*3+Ee.length+X.length,te=new Uint8Array(N);let re=0;return te.set(y,re),re+=y.length,P("IHDR",Ee,te,re),re+=v+Ee.length,P("IDATA",X,te,re),re+=v+X.length,P("IEND",new Uint8Array(0),te,re),(0,t.createObjectURL)(te,"image/png",G)}return function(B,G,w){const D=B.kind===void 0?t.ImageKind.GRAYSCALE_1BPP:B.kind;return Q(B,D,G,w)}}();class b{constructor(){this.fontSizeScale=1,this.fontWeight=d.fontWeight,this.fontSize=0,this.textMatrix=t.IDENTITY_MATRIX,this.fontMatrix=t.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=t.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=d.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(v,T){this.x=v,this.y=T}}let C=0,u=0,_=0;n.SVGGraphics=i=class{constructor(v,T,k=!1){this.svgFactory=new l.DOMSVGFactory,this.current=new b,this.transformMatrix=t.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=v,this.objs=T,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!k,this._operatorIdMapping=[];for(const P in t.OPS)this._operatorIdMapping[t.OPS[P]]=P}save(){this.transformStack.push(this.transformMatrix);const v=this.current;this.extraStack.push(v),this.current=v.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(v){this.save(),this.executeOpTree(v),this.restore()}loadDependencies(v){const T=v.fnArray,k=v.argsArray;for(let P=0,S=T.length;P<S;P++)if(T[P]===t.OPS.dependency)for(const F of k[P]){const K=F.startsWith("g_")?this.commonObjs:this.objs,Q=new Promise(Z=>{K.get(F,Z)});this.current.dependencies.push(Q)}return Promise.all(this.current.dependencies)}transform(v,T,k,P,S,F){const K=[v,T,k,P,S,F];this.transformMatrix=t.Util.transform(this.transformMatrix,K),this.tgrp=null}getSVG(v,T){this.viewport=T;const k=this._initialize(T);return this.loadDependencies(v).then(()=>(this.transformMatrix=t.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(v)),k))}convertOpList(v){const T=this._operatorIdMapping,k=v.argsArray,P=v.fnArray,S=[];for(let F=0,K=P.length;F<K;F++){const Q=P[F];S.push({fnId:Q,fn:T[Q],args:k[F]})}return A(S)}executeOpTree(v){for(const T of v){const k=T.fn,P=T.fnId,S=T.args;switch(P|0){case t.OPS.beginText:this.beginText();break;case t.OPS.dependency:break;case t.OPS.setLeading:this.setLeading(S);break;case t.OPS.setLeadingMoveText:this.setLeadingMoveText(S[0],S[1]);break;case t.OPS.setFont:this.setFont(S);break;case t.OPS.showText:this.showText(S[0]);break;case t.OPS.showSpacedText:this.showText(S[0]);break;case t.OPS.endText:this.endText();break;case t.OPS.moveText:this.moveText(S[0],S[1]);break;case t.OPS.setCharSpacing:this.setCharSpacing(S[0]);break;case t.OPS.setWordSpacing:this.setWordSpacing(S[0]);break;case t.OPS.setHScale:this.setHScale(S[0]);break;case t.OPS.setTextMatrix:this.setTextMatrix(S[0],S[1],S[2],S[3],S[4],S[5]);break;case t.OPS.setTextRise:this.setTextRise(S[0]);break;case t.OPS.setTextRenderingMode:this.setTextRenderingMode(S[0]);break;case t.OPS.setLineWidth:this.setLineWidth(S[0]);break;case t.OPS.setLineJoin:this.setLineJoin(S[0]);break;case t.OPS.setLineCap:this.setLineCap(S[0]);break;case t.OPS.setMiterLimit:this.setMiterLimit(S[0]);break;case t.OPS.setFillRGBColor:this.setFillRGBColor(S[0],S[1],S[2]);break;case t.OPS.setStrokeRGBColor:this.setStrokeRGBColor(S[0],S[1],S[2]);break;case t.OPS.setStrokeColorN:this.setStrokeColorN(S);break;case t.OPS.setFillColorN:this.setFillColorN(S);break;case t.OPS.shadingFill:this.shadingFill(S[0]);break;case t.OPS.setDash:this.setDash(S[0],S[1]);break;case t.OPS.setRenderingIntent:this.setRenderingIntent(S[0]);break;case t.OPS.setFlatness:this.setFlatness(S[0]);break;case t.OPS.setGState:this.setGState(S[0]);break;case t.OPS.fill:this.fill();break;case t.OPS.eoFill:this.eoFill();break;case t.OPS.stroke:this.stroke();break;case t.OPS.fillStroke:this.fillStroke();break;case t.OPS.eoFillStroke:this.eoFillStroke();break;case t.OPS.clip:this.clip("nonzero");break;case t.OPS.eoClip:this.clip("evenodd");break;case t.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case t.OPS.paintImageXObject:this.paintImageXObject(S[0]);break;case t.OPS.paintInlineImageXObject:this.paintInlineImageXObject(S[0]);break;case t.OPS.paintImageMaskXObject:this.paintImageMaskXObject(S[0]);break;case t.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(S[0],S[1]);break;case t.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case t.OPS.closePath:this.closePath();break;case t.OPS.closeStroke:this.closeStroke();break;case t.OPS.closeFillStroke:this.closeFillStroke();break;case t.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case t.OPS.nextLine:this.nextLine();break;case t.OPS.transform:this.transform(S[0],S[1],S[2],S[3],S[4],S[5]);break;case t.OPS.constructPath:this.constructPath(S[0],S[1]);break;case t.OPS.endPath:this.endPath();break;case 92:this.group(T.items);break;default:(0,t.warn)(`Unimplemented operator ${k}`);break}}}setWordSpacing(v){this.current.wordSpacing=v}setCharSpacing(v){this.current.charSpacing=v}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(v,T,k,P,S,F){const K=this.current;K.textMatrix=K.lineMatrix=[v,T,k,P,S,F],K.textMatrixScale=Math.hypot(v,T),K.x=K.lineX=0,K.y=K.lineY=0,K.xcoords=[],K.ycoords=[],K.tspan=this.svgFactory.createElement("svg:tspan"),K.tspan.setAttributeNS(null,"font-family",K.fontFamily),K.tspan.setAttributeNS(null,"font-size",`${M(K.fontSize)}px`),K.tspan.setAttributeNS(null,"y",M(-K.y)),K.txtElement=this.svgFactory.createElement("svg:text"),K.txtElement.appendChild(K.tspan)}beginText(){const v=this.current;v.x=v.lineX=0,v.y=v.lineY=0,v.textMatrix=t.IDENTITY_MATRIX,v.lineMatrix=t.IDENTITY_MATRIX,v.textMatrixScale=1,v.tspan=this.svgFactory.createElement("svg:tspan"),v.txtElement=this.svgFactory.createElement("svg:text"),v.txtgrp=this.svgFactory.createElement("svg:g"),v.xcoords=[],v.ycoords=[]}moveText(v,T){const k=this.current;k.x=k.lineX+=v,k.y=k.lineY+=T,k.xcoords=[],k.ycoords=[],k.tspan=this.svgFactory.createElement("svg:tspan"),k.tspan.setAttributeNS(null,"font-family",k.fontFamily),k.tspan.setAttributeNS(null,"font-size",`${M(k.fontSize)}px`),k.tspan.setAttributeNS(null,"y",M(-k.y))}showText(v){const T=this.current,k=T.font,P=T.fontSize;if(P===0)return;const S=T.fontSizeScale,F=T.charSpacing,K=T.wordSpacing,Q=T.fontDirection,Z=T.textHScale*Q,B=k.vertical,G=B?1:-1,w=k.defaultVMetrics,D=P*T.fontMatrix[0];let U=0;for(const Y of v){if(Y===null){U+=Q*K;continue}else if((0,t.isNum)(Y)){U+=G*Y*P/1e3;continue}const J=(Y.isSpace?K:0)+F,oe=Y.fontChar;let pe,me,Ee=Y.width;if(B){let N;const te=Y.vmetric||w;N=Y.vmetric?te[1]:Ee*.5,N=-N*D;const re=te[2]*D;Ee=te?-te[0]:Ee,pe=N/S,me=(U+re)/S}else pe=U/S,me=0;(Y.isInFont||k.missingFile)&&(T.xcoords.push(T.x+pe),B&&T.ycoords.push(-T.y+me),T.tspan.textContent+=oe);let X;B?X=Ee*D-J*Q:X=Ee*D+J*Q,U+=X}T.tspan.setAttributeNS(null,"x",T.xcoords.map(M).join(" ")),B?T.tspan.setAttributeNS(null,"y",T.ycoords.map(M).join(" ")):T.tspan.setAttributeNS(null,"y",M(-T.y)),B?T.y-=U:T.x+=U*Z,T.tspan.setAttributeNS(null,"font-family",T.fontFamily),T.tspan.setAttributeNS(null,"font-size",`${M(T.fontSize)}px`),T.fontStyle!==d.fontStyle&&T.tspan.setAttributeNS(null,"font-style",T.fontStyle),T.fontWeight!==d.fontWeight&&T.tspan.setAttributeNS(null,"font-weight",T.fontWeight);const q=T.textRenderingMode&t.TextRenderingMode.FILL_STROKE_MASK;if(q===t.TextRenderingMode.FILL||q===t.TextRenderingMode.FILL_STROKE?(T.fillColor!==d.fillColor&&T.tspan.setAttributeNS(null,"fill",T.fillColor),T.fillAlpha<1&&T.tspan.setAttributeNS(null,"fill-opacity",T.fillAlpha)):T.textRenderingMode===t.TextRenderingMode.ADD_TO_PATH?T.tspan.setAttributeNS(null,"fill","transparent"):T.tspan.setAttributeNS(null,"fill","none"),q===t.TextRenderingMode.STROKE||q===t.TextRenderingMode.FILL_STROKE){const Y=1/(T.textMatrixScale||1);this._setStrokeAttributes(T.tspan,Y)}let j=T.textMatrix;T.textRise!==0&&(j=j.slice(),j[5]+=T.textRise),T.txtElement.setAttributeNS(null,"transform",`${L(j)} scale(${M(Z)}, -1)`),T.txtElement.setAttributeNS(h,"xml:space","preserve"),T.txtElement.appendChild(T.tspan),T.txtgrp.appendChild(T.txtElement),this._ensureTransformGroup().appendChild(T.txtElement)}setLeadingMoveText(v,T){this.setLeading(-T),this.moveText(v,T)}addFontStyle(v){if(!v.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const T=(0,t.createObjectURL)(v.data,v.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${v.loadedName}"; src: url(${T}); }
`}setFont(v){const T=this.current,k=this.commonObjs.get(v[0]);let P=v[1];T.font=k,this.embedFonts&&!k.missingFile&&!this.embeddedFonts[k.loadedName]&&(this.addFontStyle(k),this.embeddedFonts[k.loadedName]=k),T.fontMatrix=k.fontMatrix||t.FONT_IDENTITY_MATRIX;let S="normal";k.black?S="900":k.bold&&(S="bold");const F=k.italic?"italic":"normal";P<0?(P=-P,T.fontDirection=-1):T.fontDirection=1,T.fontSize=P,T.fontFamily=k.loadedName,T.fontWeight=S,T.fontStyle=F,T.tspan=this.svgFactory.createElement("svg:tspan"),T.tspan.setAttributeNS(null,"y",M(-T.y)),T.xcoords=[],T.ycoords=[]}endText(){var T;const v=this.current;v.textRenderingMode&t.TextRenderingMode.ADD_TO_PATH_FLAG&&((T=v.txtElement)!=null&&T.hasChildNodes())&&(v.element=v.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(v){v>0&&(this.current.lineWidth=v)}setLineCap(v){this.current.lineCap=f[v]}setLineJoin(v){this.current.lineJoin=g[v]}setMiterLimit(v){this.current.miterLimit=v}setStrokeAlpha(v){this.current.strokeAlpha=v}setStrokeRGBColor(v,T,k){this.current.strokeColor=t.Util.makeHexColor(v,T,k)}setFillAlpha(v){this.current.fillAlpha=v}setFillRGBColor(v,T,k){this.current.fillColor=t.Util.makeHexColor(v,T,k),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(v){this.current.strokeColor=this._makeColorN_Pattern(v)}setFillColorN(v){this.current.fillColor=this._makeColorN_Pattern(v)}shadingFill(v){const T=this.viewport.width,k=this.viewport.height,P=t.Util.inverseTransform(this.transformMatrix),S=t.Util.applyTransform([0,0],P),F=t.Util.applyTransform([0,k],P),K=t.Util.applyTransform([T,0],P),Q=t.Util.applyTransform([T,k],P),Z=Math.min(S[0],F[0],K[0],Q[0]),B=Math.min(S[1],F[1],K[1],Q[1]),G=Math.max(S[0],F[0],K[0],Q[0]),w=Math.max(S[1],F[1],K[1],Q[1]),D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x",Z),D.setAttributeNS(null,"y",B),D.setAttributeNS(null,"width",G-Z),D.setAttributeNS(null,"height",w-B),D.setAttributeNS(null,"fill",this._makeShadingPattern(v)),this.current.fillAlpha<1&&D.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(D)}_makeColorN_Pattern(v){return v[0]==="TilingPattern"?this._makeTilingPattern(v):this._makeShadingPattern(v)}_makeTilingPattern(v){const T=v[1],k=v[2],P=v[3]||t.IDENTITY_MATRIX,[S,F,K,Q]=v[4],Z=v[5],B=v[6],G=v[7],w=`shading${_++}`,[D,U]=t.Util.applyTransform([S,F],P),[q,j]=t.Util.applyTransform([K,Q],P),[Y,J]=t.Util.singularValueDecompose2dScale(P),oe=Z*Y,pe=B*J,me=this.svgFactory.createElement("svg:pattern");me.setAttributeNS(null,"id",w),me.setAttributeNS(null,"patternUnits","userSpaceOnUse"),me.setAttributeNS(null,"width",oe),me.setAttributeNS(null,"height",pe),me.setAttributeNS(null,"x",`${D}`),me.setAttributeNS(null,"y",`${U}`);const Ee=this.svg,X=this.transformMatrix,N=this.current.fillColor,te=this.current.strokeColor,re=this.svgFactory.create(q-D,j-U);if(this.svg=re,this.transformMatrix=P,G===2){const se=t.Util.makeHexColor(...T);this.current.fillColor=se,this.current.strokeColor=se}return this.executeOpTree(this.convertOpList(k)),this.svg=Ee,this.transformMatrix=X,this.current.fillColor=N,this.current.strokeColor=te,me.appendChild(re.childNodes[0]),this.defs.appendChild(me),`url(#${w})`}_makeShadingPattern(v){switch(v[0]){case"RadialAxial":const T=`shading${_++}`,k=v[3];let P;switch(v[1]){case"axial":const S=v[4],F=v[5];P=this.svgFactory.createElement("svg:linearGradient"),P.setAttributeNS(null,"id",T),P.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),P.setAttributeNS(null,"x1",S[0]),P.setAttributeNS(null,"y1",S[1]),P.setAttributeNS(null,"x2",F[0]),P.setAttributeNS(null,"y2",F[1]);break;case"radial":const K=v[4],Q=v[5],Z=v[6],B=v[7];P=this.svgFactory.createElement("svg:radialGradient"),P.setAttributeNS(null,"id",T),P.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),P.setAttributeNS(null,"cx",Q[0]),P.setAttributeNS(null,"cy",Q[1]),P.setAttributeNS(null,"r",B),P.setAttributeNS(null,"fx",K[0]),P.setAttributeNS(null,"fy",K[1]),P.setAttributeNS(null,"fr",Z);break;default:throw new Error(`Unknown RadialAxial type: ${v[1]}`)}for(const S of k){const F=this.svgFactory.createElement("svg:stop");F.setAttributeNS(null,"offset",S[0]),F.setAttributeNS(null,"stop-color",S[1]),P.appendChild(F)}return this.defs.appendChild(P),`url(#${T})`;case"Mesh":return(0,t.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${v[0]}`)}}setDash(v,T){this.current.dashArray=v,this.current.dashPhase=T}constructPath(v,T){const k=this.current;let P=k.x,S=k.y,F=[],K=0;for(const Q of v)switch(Q|0){case t.OPS.rectangle:P=T[K++],S=T[K++];const Z=T[K++],B=T[K++],G=P+Z,w=S+B;F.push("M",M(P),M(S),"L",M(G),M(S),"L",M(G),M(w),"L",M(P),M(w),"Z");break;case t.OPS.moveTo:P=T[K++],S=T[K++],F.push("M",M(P),M(S));break;case t.OPS.lineTo:P=T[K++],S=T[K++],F.push("L",M(P),M(S));break;case t.OPS.curveTo:P=T[K+4],S=T[K+5],F.push("C",M(T[K]),M(T[K+1]),M(T[K+2]),M(T[K+3]),M(P),M(S)),K+=6;break;case t.OPS.curveTo2:F.push("C",M(P),M(S),M(T[K]),M(T[K+1]),M(T[K+2]),M(T[K+3])),P=T[K+2],S=T[K+3],K+=4;break;case t.OPS.curveTo3:P=T[K+2],S=T[K+3],F.push("C",M(T[K]),M(T[K+1]),M(P),M(S),M(P),M(S)),K+=4;break;case t.OPS.closePath:F.push("Z");break}F=F.join(" "),k.path&&v.length>0&&v[0]!==t.OPS.rectangle&&v[0]!==t.OPS.moveTo?F=k.path.getAttributeNS(null,"d")+F:(k.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(k.path)),k.path.setAttributeNS(null,"d",F),k.path.setAttributeNS(null,"fill","none"),k.element=k.path,k.setCurrentPoint(P,S)}endPath(){const v=this.current;if(v.path=null,!this.pendingClip)return;if(!v.element){this.pendingClip=null;return}const T=`clippath${C++}`,k=this.svgFactory.createElement("svg:clipPath");k.setAttributeNS(null,"id",T),k.setAttributeNS(null,"transform",L(this.transformMatrix));const P=v.element.cloneNode(!0);this.pendingClip==="evenodd"?P.setAttributeNS(null,"clip-rule","evenodd"):P.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,k.appendChild(P),this.defs.appendChild(k),v.activeClipUrl&&(v.clipGroup=null,this.extraStack.forEach(function(S){S.clipGroup=null}),k.setAttributeNS(null,"clip-path",v.activeClipUrl)),v.activeClipUrl=`url(#${T})`,this.tgrp=null}clip(v){this.pendingClip=v}closePath(){const v=this.current;if(v.path){const T=`${v.path.getAttributeNS(null,"d")}Z`;v.path.setAttributeNS(null,"d",T)}}setLeading(v){this.current.leading=-v}setTextRise(v){this.current.textRise=v}setTextRenderingMode(v){this.current.textRenderingMode=v}setHScale(v){this.current.textHScale=v/100}setRenderingIntent(v){}setFlatness(v){}setGState(v){for(const[T,k]of v)switch(T){case"LW":this.setLineWidth(k);break;case"LC":this.setLineCap(k);break;case"LJ":this.setLineJoin(k);break;case"ML":this.setMiterLimit(k);break;case"D":this.setDash(k[0],k[1]);break;case"RI":this.setRenderingIntent(k);break;case"FL":this.setFlatness(k);break;case"Font":this.setFont(k);break;case"CA":this.setStrokeAlpha(k);break;case"ca":this.setFillAlpha(k);break;default:(0,t.warn)(`Unimplemented graphic state operator ${T}`);break}}fill(){const v=this.current;v.element&&(v.element.setAttributeNS(null,"fill",v.fillColor),v.element.setAttributeNS(null,"fill-opacity",v.fillAlpha),this.endPath())}stroke(){const v=this.current;v.element&&(this._setStrokeAttributes(v.element),v.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(v,T=1){const k=this.current;let P=k.dashArray;T!==1&&P.length>0&&(P=P.map(function(S){return T*S})),v.setAttributeNS(null,"stroke",k.strokeColor),v.setAttributeNS(null,"stroke-opacity",k.strokeAlpha),v.setAttributeNS(null,"stroke-miterlimit",M(k.miterLimit)),v.setAttributeNS(null,"stroke-linecap",k.lineCap),v.setAttributeNS(null,"stroke-linejoin",k.lineJoin),v.setAttributeNS(null,"stroke-width",M(T*k.lineWidth)+"px"),v.setAttributeNS(null,"stroke-dasharray",P.map(M).join(" ")),v.setAttributeNS(null,"stroke-dashoffset",M(T*k.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const v=this.svgFactory.createElement("svg:rect");v.setAttributeNS(null,"x","0"),v.setAttributeNS(null,"y","0"),v.setAttributeNS(null,"width","1px"),v.setAttributeNS(null,"height","1px"),v.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(v)}paintImageXObject(v){const T=v.startsWith("g_")?this.commonObjs.get(v):this.objs.get(v);if(!T){(0,t.warn)(`Dependent image with object ID ${v} is not ready yet`);return}this.paintInlineImageXObject(T)}paintInlineImageXObject(v,T){const k=v.width,P=v.height,S=x(v,this.forceDataSchema,!!T),F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",M(k)),F.setAttributeNS(null,"height",M(P)),this.current.element=F,this.clip("nonzero");const K=this.svgFactory.createElement("svg:image");K.setAttributeNS(m,"xlink:href",S),K.setAttributeNS(null,"x","0"),K.setAttributeNS(null,"y",M(-P)),K.setAttributeNS(null,"width",M(k)+"px"),K.setAttributeNS(null,"height",M(P)+"px"),K.setAttributeNS(null,"transform",`scale(${M(1/k)} ${M(-1/P)})`),T?T.appendChild(K):this._ensureTransformGroup().appendChild(K)}paintImageMaskXObject(v){const T=this.current,k=v.width,P=v.height,S=T.fillColor;T.maskId=`mask${u++}`;const F=this.svgFactory.createElement("svg:mask");F.setAttributeNS(null,"id",T.maskId);const K=this.svgFactory.createElement("svg:rect");K.setAttributeNS(null,"x","0"),K.setAttributeNS(null,"y","0"),K.setAttributeNS(null,"width",M(k)),K.setAttributeNS(null,"height",M(P)),K.setAttributeNS(null,"fill",S),K.setAttributeNS(null,"mask",`url(#${T.maskId})`),this.defs.appendChild(F),this._ensureTransformGroup().appendChild(K),this.paintInlineImageXObject(v,F)}paintFormXObjectBegin(v,T){if(Array.isArray(v)&&v.length===6&&this.transform(v[0],v[1],v[2],v[3],v[4],v[5]),T){const k=T[2]-T[0],P=T[3]-T[1],S=this.svgFactory.createElement("svg:rect");S.setAttributeNS(null,"x",T[0]),S.setAttributeNS(null,"y",T[1]),S.setAttributeNS(null,"width",M(k)),S.setAttributeNS(null,"height",M(P)),this.current.element=S,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(v){const T=this.svgFactory.create(v.width,v.height),k=this.svgFactory.createElement("svg:defs");T.appendChild(k),this.defs=k;const P=this.svgFactory.createElement("svg:g");return P.setAttributeNS(null,"transform",L(v.transform)),T.appendChild(P),this.svg=P,T}_ensureClipGroup(){if(!this.current.clipGroup){const v=this.svgFactory.createElement("svg:g");v.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(v),this.current.clipGroup=v}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",L(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;class o{static setAttributes(l,a){for(const[i,s]of Object.entries(a))s!=null&&(i!=="style"?l.setAttribute(i,s):Object.assign(l.style,s))}static render(l){const a=l.xfa,i=document.createElement(a.name);a.attributes&&o.setAttributes(i,a.attributes);const s=[[a,-1,i]],c=l.div;c.appendChild(i);const r=l.viewport.transform.join(",");for(c.style.transform=`matrix(${r})`,c.setAttribute("class","xfaLayer xfaFont");s.length>0;){const[d,h,m]=s[s.length-1];if(h+1===d.children.length){s.pop();continue}const f=d.children[++s[s.length-1][1]];if(f===null)continue;const{name:g}=f;if(g==="#text"){m.appendChild(document.createTextNode(f.value));continue}const x=document.createElement(g);m.appendChild(x),f.attributes&&o.setAttributes(x,f.attributes),f.children&&f.children.length>0?s.push([f,-1,x]):f.value&&x.appendChild(document.createTextNode(f.value))}}static update(l){const a=`matrix(${l.viewport.transform.join(",")})`;l.div.style.transform=a,l.div.hidden=!1}}n.XfaLayer=o},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var t=o(2),l=o(24);const a=require("fs"),i=require("http"),s=require("https"),c=require("url"),r=/^file:\/\/\/[a-zA-Z]:\//;function d(L){const C=c.parse(L);return C.protocol==="file:"||C.host?C:/^[a-z]:[/\\]/i.test(L)?c.parse(`file:///${L}`):(C.host||(C.protocol="file:"),C)}class h{constructor(C){this.source=C,this.url=d(C.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&C.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var C;return((C=this._fullRequestReader)==null?void 0:C._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new A(this):new x(this),this._fullRequestReader}getRangeReader(C,u){if(u<=this._progressiveDataLength)return null;const _=this.isFsUrl?new M(this,C,u):new b(this,C,u);return this._rangeRequestReaders.push(_),_}cancelAllRequests(C){this._fullRequestReader&&this._fullRequestReader.cancel(C),this._rangeRequestReaders.slice(0).forEach(function(_){_.cancel(C)})}}n.PDFNodeStream=h;class m{constructor(C){this._url=C.url,this._done=!1,this._storedError=null,this.onProgress=null;const u=C.source;this._contentLength=u.length,this._loaded=0,this._filename=null,this._disableRange=u.disableRange||!1,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._readableStream=null,this._readCapability=(0,t.createPromiseCapability)(),this._headersCapability=(0,t.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const C=this._readableStream.read();return C===null?(this._readCapability=(0,t.createPromiseCapability)(),this.read()):(this._loaded+=C.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(C).buffer,done:!1})}cancel(C){if(!this._readableStream){this._error(C);return}this._readableStream.destroy(C)}_error(C){this._storedError=C,this._readCapability.resolve()}_setReadableStream(C){this._readableStream=C,C.on("readable",()=>{this._readCapability.resolve()}),C.on("end",()=>{C.destroy(),this._done=!0,this._readCapability.resolve()}),C.on("error",u=>{this._error(u)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new t.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class f{constructor(C){this._url=C.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,t.createPromiseCapability)();const u=C.source;this._isStreamingSupported=!u.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const C=this._readableStream.read();return C===null?(this._readCapability=(0,t.createPromiseCapability)(),this.read()):(this._loaded+=C.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(C).buffer,done:!1})}cancel(C){if(!this._readableStream){this._error(C);return}this._readableStream.destroy(C)}_error(C){this._storedError=C,this._readCapability.resolve()}_setReadableStream(C){this._readableStream=C,C.on("readable",()=>{this._readCapability.resolve()}),C.on("end",()=>{C.destroy(),this._done=!0,this._readCapability.resolve()}),C.on("error",u=>{this._error(u)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function g(L,C){return{protocol:L.protocol,auth:L.auth,host:L.hostname,port:L.port,path:L.path,method:"GET",headers:C}}class x extends m{constructor(C){super(C);const u=_=>{if(_.statusCode===404){const k=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=k,this._headersCapability.reject(k);return}this._headersCapability.resolve(),this._setReadableStream(_);const y=k=>this._readableStream.headers[k.toLowerCase()],{allowRangeRequests:v,suggestedLength:T}=(0,l.validateRangeRequestCapabilities)({getResponseHeader:y,isHttp:C.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=v,this._contentLength=T||this._contentLength,this._filename=(0,l.extractFilenameFromHeader)(y)};this._request=null,this._url.protocol==="http:"?this._request=i.request(g(this._url,C.httpHeaders),u):this._request=s.request(g(this._url,C.httpHeaders),u),this._request.on("error",_=>{this._storedError=_,this._headersCapability.reject(_)}),this._request.end()}}class b extends f{constructor(C,u,_){super(C),this._httpHeaders={};for(const v in C.httpHeaders){const T=C.httpHeaders[v];typeof T>"u"||(this._httpHeaders[v]=T)}this._httpHeaders.Range=`bytes=${u}-${_-1}`;const y=v=>{if(v.statusCode===404){const T=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=T;return}this._setReadableStream(v)};this._request=null,this._url.protocol==="http:"?this._request=i.request(g(this._url,this._httpHeaders),y):this._request=s.request(g(this._url,this._httpHeaders),y),this._request.on("error",v=>{this._storedError=v}),this._request.end()}}class A extends m{constructor(C){super(C);let u=decodeURIComponent(this._url.path);r.test(this._url.href)&&(u=u.replace(/^\//,"")),a.lstat(u,(_,y)=>{if(_){_.code==="ENOENT"&&(_=new t.MissingPDFException(`Missing PDF "${u}".`)),this._storedError=_,this._headersCapability.reject(_);return}this._contentLength=y.size,this._setReadableStream(a.createReadStream(u)),this._headersCapability.resolve()})}}class M extends f{constructor(C,u,_){super(C);let y=decodeURIComponent(this._url.path);r.test(this._url.href)&&(y=y.replace(/^\//,"")),this._setReadableStream(a.createReadStream(y,{start:u,end:_-1}))}}},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=c,n.extractFilenameFromHeader=s,n.validateRangeRequestCapabilities=i,n.validateResponseStatus=r;var t=o(2),l=o(25),a=o(1);function i({getResponseHeader:d,isHttp:h,rangeChunkSize:m,disableRange:f}){(0,t.assert)(m>0,"Range chunk size must be larger than zero");const g={allowRangeRequests:!1,suggestedLength:void 0},x=parseInt(d("Content-Length"),10);return!Number.isInteger(x)||(g.suggestedLength=x,x<=2*m)||f||!h||d("Accept-Ranges")!=="bytes"||(d("Content-Encoding")||"identity")!=="identity"||(g.allowRangeRequests=!0),g}function s(d){const h=d("Content-Disposition");if(h){let m=(0,l.getFilenameFromContentDispositionHeader)(h);if(m.includes("%"))try{m=decodeURIComponent(m)}catch{}if((0,a.isPdfFile)(m))return m}return null}function c(d,h){return d===404||d===0&&h.startsWith("file:")?new t.MissingPDFException('Missing PDF "'+h+'".'):new t.UnexpectedResponseException(`Unexpected server response (${d}) while retrieving PDF "${h}".`,d)}function r(d){return d===200||d===206}},(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=o;function o(t){let l=!0,a=i("filename\\*","i").exec(t);if(a){a=a[1];let f=d(a);return f=unescape(f),f=h(f),f=m(f),c(f)}if(a=r(t),a){const f=m(a);return c(f)}if(a=i("filename","i").exec(t),a){a=a[1];let f=d(a);return f=m(f),c(f)}function i(f,g){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function s(f,g){if(f){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const x=new TextDecoder(f,{fatal:!0}),b=Array.from(g,function(A){return A.charCodeAt(0)&255});g=x.decode(new Uint8Array(b)),l=!1}catch{if(/^utf-?8$/i.test(f))try{g=decodeURIComponent(escape(g)),l=!1}catch{}}}return g}function c(f){return l&&/[\x80-\xff]/.test(f)&&(f=s("utf-8",f),l&&(f=s("iso-8859-1",f))),f}function r(f){const g=[];let x;const b=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(x=b.exec(f))!==null;){let[,M,L,C]=x;if(M=parseInt(M,10),M in g){if(M===0)break;continue}g[M]=[L,C]}const A=[];for(let M=0;M<g.length&&M in g;++M){let[L,C]=g[M];C=d(C),L&&(C=unescape(C),M===0&&(C=h(C))),A.push(C)}return A.join("")}function d(f){if(f.startsWith('"')){const g=f.slice(1).split('\\"');for(let x=0;x<g.length;++x){const b=g[x].indexOf('"');b!==-1&&(g[x]=g[x].slice(0,b),g.length=x+1),g[x]=g[x].replace(/\\(.)/g,"$1")}f=g.join('"')}return f}function h(f){const g=f.indexOf("'");if(g===-1)return f;const x=f.slice(0,g),A=f.slice(g+1).replace(/^[^']*'/,"");return s(x,A)}function m(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,x,b,A){if(b==="q"||b==="Q")return A=A.replace(/_/g," "),A=A.replace(/=([0-9a-fA-F]{2})/g,function(M,L){return String.fromCharCode(parseInt(L,16))}),s(x,A);try{A=atob(A)}catch{}return s(x,A)})}return""}},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var t=o(2),l=o(24);const a=200,i=206;function s(m){const f=m.response;return typeof f!="string"?f:(0,t.stringToBytes)(f).buffer}class c{constructor(f,g){this.url=f,g=g||{},this.isHttp=/^https?:/i.test(f),this.httpHeaders=this.isHttp&&g.httpHeaders||{},this.withCredentials=g.withCredentials||!1,this.getXhr=g.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(f,g,x){const b={begin:f,end:g};for(const A in x)b[A]=x[A];return this.request(b)}requestFull(f){return this.request(f)}request(f){const g=this.getXhr(),x=this.currXhrId++,b=this.pendingRequests[x]={xhr:g};g.open("GET",this.url),g.withCredentials=this.withCredentials;for(const A in this.httpHeaders){const M=this.httpHeaders[A];typeof M>"u"||g.setRequestHeader(A,M)}return this.isHttp&&"begin"in f&&"end"in f?(g.setRequestHeader("Range",`bytes=${f.begin}-${f.end-1}`),b.expectedStatus=i):b.expectedStatus=a,g.responseType="arraybuffer",f.onError&&(g.onerror=function(A){f.onError(g.status)}),g.onreadystatechange=this.onStateChange.bind(this,x),g.onprogress=this.onProgress.bind(this,x),b.onHeadersReceived=f.onHeadersReceived,b.onDone=f.onDone,b.onError=f.onError,b.onProgress=f.onProgress,g.send(null),x}onProgress(f,g){const x=this.pendingRequests[f];x&&x.onProgress&&x.onProgress(g)}onStateChange(f,g){const x=this.pendingRequests[f];if(!x)return;const b=x.xhr;if(b.readyState>=2&&x.onHeadersReceived&&(x.onHeadersReceived(),delete x.onHeadersReceived),b.readyState!==4||!(f in this.pendingRequests))return;if(delete this.pendingRequests[f],b.status===0&&this.isHttp){x.onError&&x.onError(b.status);return}const A=b.status||a;if(!(A===a&&x.expectedStatus===i)&&A!==x.expectedStatus){x.onError&&x.onError(b.status);return}const L=s(b);if(A===i){const C=b.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(C);x.onDone({begin:parseInt(u[1],10),chunk:L})}else L?x.onDone({begin:0,chunk:L}):x.onError&&x.onError(b.status)}getRequestXhr(f){return this.pendingRequests[f].xhr}isPendingRequest(f){return f in this.pendingRequests}abortRequest(f){const g=this.pendingRequests[f].xhr;delete this.pendingRequests[f],g.abort()}}class r{constructor(f){this._source=f,this._manager=new c(f.url,{httpHeaders:f.httpHeaders,withCredentials:f.withCredentials}),this._rangeChunkSize=f.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(f){const g=this._rangeRequestReaders.indexOf(f);g>=0&&this._rangeRequestReaders.splice(g,1)}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new d(this._manager,this._source),this._fullRequestReader}getRangeReader(f,g){const x=new h(this._manager,f,g);return x.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(x),x}cancelAllRequests(f){this._fullRequestReader&&this._fullRequestReader.cancel(f),this._rangeRequestReaders.slice(0).forEach(function(x){x.cancel(f)})}}n.PDFNetworkStream=r;class d{constructor(f,g){this._manager=f;const x={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._fullRequestId=f.requestFull(x),this._headersReceivedCapability=(0,t.createPromiseCapability)(),this._disableRange=g.disableRange||!1,this._contentLength=g.length,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const f=this._fullRequestId,g=this._manager.getRequestXhr(f),x=M=>g.getResponseHeader(M),{allowRangeRequests:b,suggestedLength:A}=(0,l.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});b&&(this._isRangeSupported=!0),this._contentLength=A||this._contentLength,this._filename=(0,l.extractFilenameFromHeader)(x),this._isRangeSupported&&this._manager.abortRequest(f),this._headersReceivedCapability.resolve()}_onDone(f){f&&(this._requests.length>0?this._requests.shift().resolve({value:f.chunk,done:!1}):this._cachedChunks.push(f.chunk)),this._done=!0,!(this._cachedChunks.length>0)&&(this._requests.forEach(function(g){g.resolve({value:void 0,done:!0})}),this._requests=[])}_onError(f){const g=this._url,x=(0,l.createResponseStatusError)(f,g);this._storedError=x,this._headersReceivedCapability.reject(x),this._requests.forEach(function(b){b.reject(x)}),this._requests=[],this._cachedChunks=[]}_onProgress(f){this.onProgress&&this.onProgress({loaded:f.loaded,total:f.lengthComputable?f.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=(0,t.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0,this._headersReceivedCapability.reject(f),this._requests.forEach(function(g){g.resolve({value:void 0,done:!0})}),this._requests=[],this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class h{constructor(f,g,x){this._manager=f;const b={onDone:this._onDone.bind(this),onProgress:this._onProgress.bind(this)};this._requestId=f.requestRange(g,x,b),this._requests=[],this._queuedChunk=null,this._done=!1,this.onProgress=null,this.onClosed=null}_close(){this.onClosed&&this.onClosed(this)}_onDone(f){const g=f.chunk;this._requests.length>0?this._requests.shift().resolve({value:g,done:!1}):this._queuedChunk=g,this._done=!0,this._requests.forEach(function(x){x.resolve({value:void 0,done:!0})}),this._requests=[],this._close()}_onProgress(f){!this.isStreamingSupported&&this.onProgress&&this.onProgress({loaded:f.loaded})}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk!==null){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const f=(0,t.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0,this._requests.forEach(function(g){g.resolve({value:void 0,done:!0})}),this._requests=[],this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var t=o(2),l=o(24);function a(d,h,m){return{method:"GET",headers:d,signal:m==null?void 0:m.signal,mode:"cors",credentials:h?"include":"same-origin",redirect:"follow"}}function i(d){const h=new Headers;for(const m in d){const f=d[m];typeof f>"u"||h.append(m,f)}return h}class s{constructor(h){this.source=h,this.isHttp=/^https?:/i.test(h.url),this.httpHeaders=this.isHttp&&h.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var h;return((h=this._fullRequestReader)==null?void 0:h._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new c(this),this._fullRequestReader}getRangeReader(h,m){if(m<=this._progressiveDataLength)return null;const f=new r(this,h,m);return this._rangeRequestReaders.push(f),f}cancelAllRequests(h){this._fullRequestReader&&this._fullRequestReader.cancel(h),this._rangeRequestReaders.slice(0).forEach(function(f){f.cancel(h)})}}n.PDFFetchStream=s;class c{constructor(h){this._stream=h,this._reader=null,this._loaded=0,this._filename=null;const m=h.source;this._withCredentials=m.withCredentials||!1,this._contentLength=m.length,this._headersCapability=(0,t.createPromiseCapability)(),this._disableRange=m.disableRange||!1,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),typeof AbortController<"u"&&(this._abortController=new AbortController),this._isStreamingSupported=!m.disableStream,this._isRangeSupported=!m.disableRange,this._headers=i(this._stream.httpHeaders);const f=m.url;fetch(f,a(this._headers,this._withCredentials,this._abortController)).then(g=>{if(!(0,l.validateResponseStatus)(g.status))throw(0,l.createResponseStatusError)(g.status,f);this._reader=g.body.getReader(),this._headersCapability.resolve();const x=M=>g.headers.get(M),{allowRangeRequests:b,suggestedLength:A}=(0,l.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=b,this._contentLength=A||this._contentLength,this._filename=(0,l.extractFilenameFromHeader)(x),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new t.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:h,done:m}=await this._reader.read();return m?{value:h,done:m}:(this._loaded+=h.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){this._reader&&this._reader.cancel(h),this._abortController&&this._abortController.abort()}}class r{constructor(h,m,f){this._stream=h,this._reader=null,this._loaded=0;const g=h.source;this._withCredentials=g.withCredentials||!1,this._readCapability=(0,t.createPromiseCapability)(),this._isStreamingSupported=!g.disableStream,typeof AbortController<"u"&&(this._abortController=new AbortController),this._headers=i(this._stream.httpHeaders),this._headers.append("Range",`bytes=${m}-${f-1}`);const x=g.url;fetch(x,a(this._headers,this._withCredentials,this._abortController)).then(b=>{if(!(0,l.validateResponseStatus)(b.status))throw(0,l.createResponseStatusError)(b.status,x);this._readCapability.resolve(),this._reader=b.body.getReader()}).catch(b=>{if((b==null?void 0:b.name)!=="AbortError")throw b}),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:h,done:m}=await this._reader.read();return m?{value:h,done:m}:(this._loaded+=h.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){this._reader&&this._reader.cancel(h),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var n=__webpack_module_cache__[e];if(n!==void 0)return n.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](o,o.exports,__w_pdfjs_require__),o.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"addLinkAttributes",{enumerable:!0,get:function(){return n.addLinkAttributes}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(e,"LinkTarget",{enumerable:!0,get:function(){return n.LinkTarget}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return o.build}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return o.getDocument}}),Object.defineProperty(e,"LoopbackPort",{enumerable:!0,get:function(){return o.LoopbackPort}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return o.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return o.PDFWorker}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return o.version}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(e,"createObjectURL",{enumerable:!0,get:function(){return t.createObjectURL}}),Object.defineProperty(e,"createPromiseCapability",{enumerable:!0,get:function(){return t.createPromiseCapability}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(e,"removeNullCharacters",{enumerable:!0,get:function(){return t.removeNullCharacters}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(e,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return t.UNSUPPORTED_FEATURES}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return l.AnnotationLayer}}),Object.defineProperty(e,"apiCompatibilityParams",{enumerable:!0,get:function(){return a.apiCompatibilityParams}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return i.GlobalWorkerOptions}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return s.renderTextLayer}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return c.SVGGraphics}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return r.XfaLayer}});var n=__w_pdfjs_require__(1),o=__w_pdfjs_require__(5),t=__w_pdfjs_require__(2),l=__w_pdfjs_require__(18),a=__w_pdfjs_require__(9),i=__w_pdfjs_require__(12),s=__w_pdfjs_require__(20),c=__w_pdfjs_require__(21),r=__w_pdfjs_require__(22);{const{isNodeJS:d}=__w_pdfjs_require__(4);if(d){const h=__w_pdfjs_require__(23).PDFNodeStream;(0,o.setPDFNetworkStreamFactory)(m=>new h(m))}else{const h=__w_pdfjs_require__(26).PDFNetworkStream;let m;(0,n.isFetchSupported)()&&(m=__w_pdfjs_require__(27).PDFFetchStream),(0,o.setPDFNetworkStreamFactory)(f=>m&&(0,n.isValidFetchUrl)(f.url)?new m(f):new h(f))}}})(),__webpack_exports__})()});console.log("JS 실행:","OnCanvasObject.js");class OnCanvasObject{constructor(n,o,t,l,a){this.x=n,this.y=o,this.width=t,this.height=l,this.hideMainCanvasHandles=a,this.$el=$(E("div")).addClass("on-canvas-object").appendTo($canvas_area),this.hideMainCanvasHandles&&canvas_handles.hide(),$G$1.on("resize theme-load",this._global_resize_handler=()=>{this.position()})}position(n){const o=parseFloat($canvas_area.css("padding-left")),t=parseFloat($canvas_area.css("padding-top"));this.$el.css({position:"absolute",left:magnification*this.x+o,top:magnification*this.y+t,width:magnification*this.width,height:magnification*this.height}),n&&($status_position.text(`${this.x}, ${this.y}px`),$status_size.text(`${this.width} x ${this.height}px`))}destroy(){this.$el.remove(),this.hideMainCanvasHandles&&canvas_handles.show(),$G$1.off("resize theme-load",this._global_resize_handler)}}console.log("JS 실행:","OnCanvasHelpLayer.js");class OnCanvasHelperLayer extends OnCanvasObject{constructor(n,o,t,l,a,i=1){super(n,o,t,l,a),this.$el.addClass("helper-layer"),this.$el.css({pointerEvents:"none"}),this.position(),this.canvas=make_canvas(this.width*i,this.height*i),this.$el.append(this.canvas)}}console.log("JS 실행:","Hendles.js");function Handles(e){const{$handles_container:n,$object_container:o}=e,t=e.outset||0,l=e.get_handles_offset_left||(()=>0),a=e.get_handles_offset_top||(()=>0),i=e.get_ghost_offset_left||(()=>0),s=e.get_ghost_offset_top||(()=>0),c=e.size_only||!1,r=0,d=-1,h=1,m=d,f=h,g=d,x=h,b=$(E("div")).addClass("resize-ghost");e.thick&&b.addClass("thick");const A=[];[[g,f],[g,r],[g,m],[r,m],[x,m],[x,r],[x,f],[r,f]].forEach(([M,L])=>{const C=$(E("div")).addClass("handle");C.appendTo(n);const u=$(E("div")).addClass("grab-region").appendTo(n);(M===r||L===r)&&u.addClass("is-middle"),C.css("touch-action","none");let _,y=!1;const v=M!==r,T=L!==r;if(c&&(M===g||L===m))C.addClass("useless-handle"),u.remove();else{let P;L===m&&M===g||L===f&&M===x?P="nwse-resize":L===f&&M===g||L===m&&M===x?P="nesw-resize":T?P="ew-resize":v&&(P="ns-resize");let S="";M===g&&(S+="n"),M===x&&(S+="s"),L===m&&(S+="w"),L===f&&(S+="e"),S+="-resize";const F=make_css_cursor(P,[16,16],S);C.add(u).css({cursor:F});const K=Q=>{b.appendTo(o),y=!0,_=e.get_rect();const Z=to_canvas_coords(Q);let B=0,G=0,w,D;L===f?(B=0,w=~~(Z.x-_.x)):L===m?(B=~~(Z.x-_.x),w=~~(_.x+_.width-Z.x)):w=~~_.width,M===x?(G=0,D=~~(Z.y-_.y)):M===g?(G=~~(Z.y-_.y),D=~~(_.y+_.height-Z.y)):D=~~_.height;let U={x:_.x+B,y:_.y+G,width:w,height:D};U.width=Math.max(1,U.width),U.height=Math.max(1,U.height),e.constrain_rect?U=e.constrain_rect(U,L,M):(U.x=Math.min(U.x,_.x+_.width),U.y=Math.min(U.y,_.y+_.height)),b.css({position:"absolute",left:magnification*U.x+i(),top:magnification*U.y+s(),width:magnification*U.width-2,height:magnification*U.height-2}),_=U};C.add(u).on("pointerdown",Q=>{y=!1,Q.button===0&&($G$1.on("pointermove",K),$("body").css({cursor:F}).addClass("cursor-bully")),$G$1.one("pointerup",()=>{$G$1.off("pointermove",K),$("body").css({cursor:""}).removeClass("cursor-bully"),b.remove(),y&&e.set_rect(_),n.trigger("update")})}),C.on("mousedown selectstart",Q=>{Q.preventDefault()})}const k=()=>{const P=e.get_rect(),S=C.width(),F=l(),K=a(),Q=32;for(const{len_key:Z,pos_key:B,region:G,offset:w}of[{len_key:"width",pos_key:"left",region:L,offset:F},{len_key:"height",pos_key:"top",region:M,offset:K}]){let D=Math.max(P[Z]*magnification/2-Q/2,Math.min(Q/2,P[Z]*magnification/3)),U=P[Z]*magnification-D;U-D<magnification&&(D=0,U=magnification);const q=-Q/2,j=Math.min(Q/2,D),Y=P[Z]*magnification-j,J=P[Z]*magnification-q;c&&(D=Math.max(-w,Math.min(D,U-Q))),G===d?(C.css({[B]:w-t}),u.css({[B]:w+q,[Z]:j-q})):G===r?(C.css({[B]:w+(P[Z]*magnification-S)/2}),u.css({[B]:w+D,[Z]:U-D})):G===h&&(C.css({[B]:w+(P[Z]*magnification-S/2)}),u.css({[B]:w+Y,[Z]:J-Y}))}};n.on("update resize scroll",k),$G$1.on("resize theme-load",k),setTimeout(k,50),A.push(C[0],u[0])}),this.handles=A,this.hide=()=>{$(A).css({opacity:0,pointerEvents:"none"})},this.show=()=>{$(A).css({opacity:"",pointerEvents:""})}}console.log("JS 실행:","image-manipulation.js");const fill_threshold=1;function get_brush_canvas_size(e,n){return Math.ceil(e*(n==="circle"?2.1:1)/2)*2}function render_brush(e,n,o){n.match(/diagonal/)&&(o-=.4);const t=Math.round(e.canvas.width/2),l=Math.round(t-o/2),a=Math.round(t+o/2),i=Math.round(e.canvas.height/2),s=Math.round(i-o/2),c=Math.round(i+o/2);n==="circle"?draw_ellipse(e,l,s,o,o,!1,!0):n==="square"?e.fillRect(l,s,~~o,~~o):n==="diagonal"?draw_line_without_pattern_support(e,l,s,a,c):n==="reverse_diagonal"?draw_line_without_pattern_support(e,l,c,a,s):n==="horizontal"?draw_line_without_pattern_support(e,l,i,o,i):n==="vertical"&&draw_line_without_pattern_support(e,t,s,t,o)}function draw_ellipse(e,n,o,t,l,a,i){const s=n+t/2,c=o+l/2;if(aliasing){const r=[];for(let h=0;h<TAU;h+=.05)r.push({x:s+Math.cos(h)*t/2,y:c+Math.sin(h)*l/2});draw_polygon(e,r,a,i)}else e.beginPath(),e.ellipse(s,c,Math.abs(t/2),Math.abs(l/2),0,0,TAU,!1),e.stroke(),e.fill()}function draw_rounded_rectangle(e,n,o,t,l,a,i,s,c){if(aliasing){const r=[],d=(g,x)=>{r.push({x:g,y:x})},h=(g,x,b,A,M,L)=>{for(let u=M;u<L;u+=.05)r.push({x:g+Math.cos(u)*b,y:x+Math.sin(u)*A});r.push({x:g+Math.cos(L)*b,y:x+Math.sin(L)*A})},m=n+t,f=o+l;h(m-a,o+i,a,i,TAU*3/4,TAU),d(m,f-i),h(m-a,f-i,a,i,0,TAU*1/4),d(n+a,f),h(n+a,f-i,a,i,TAU*1/4,TAU*1/2),d(n,o+i),h(n+a,o+i,a,i,TAU/2,TAU*3/4),draw_polygon(e,r,s,c)}else e.beginPath(),e.moveTo(n+a,o),e.lineTo(n+t-a,o),e.quadraticCurveTo(n+t,o,n+t,o+i),e.lineTo(n+t,o+l-i),e.quadraticCurveTo(n+t,o+l,n+t-a,o+l),e.lineTo(n+a,o+l),e.quadraticCurveTo(n,o+l,n,o+l-i),e.lineTo(n,o+i),e.quadraticCurveTo(n,o,n+a,o),e.closePath(),s&&e.stroke(),c&&e.fill()}const get_brush_canvas_implementation=(e,n)=>{const o=get_brush_canvas_size(n,e),t=make_canvas(o,o);return render_brush(t.ctx,e,n),t},get_brush_canvas=memoize_synchronous_function(get_brush_canvas_implementation,20);$G$1.on("invalidate-brush-canvases",()=>{get_brush_canvas.clear_memo_cache()});const stamp_brush_canvas=(e,n,o,t,l)=>{const a=get_brush_canvas(t,l),i=-Math.ceil(a.width/2),s=-Math.ceil(a.height/2);e.drawImage(a,n+i,o+s)},get_circumference_points_for_brush_implementation=(e,n)=>{const o=get_brush_canvas(e,n),t=o.ctx.getImageData(0,0,o.width,o.height),l=(c,r)=>c>=0&&r>=0&&c<t.width&&r<t.height&&t.data[(r*t.width+c)*4+3]>127,a=-Math.ceil(o.width/2),i=-Math.ceil(o.height/2),s=[];for(let c=0;c<t.width;c+=1)for(let r=0;r<t.height;r+=1)l(c,r)&&(!l(c,r-1)||!l(c,r+1)||!l(c-1,r)||!l(c+1,r))&&s.push({x:c+a,y:r+i});return s},get_circumference_points_for_brush=memoize_synchronous_function(get_circumference_points_for_brush_implementation);$G$1.on("invalidate-brush-canvases",()=>{get_circumference_points_for_brush.clear_memo_cache()});let line_brush_canvas;function update_brush_for_drawing_lines(e){aliasing&&e>1&&(line_brush_canvas=get_brush_canvas("circle",e))}function draw_line_without_pattern_support(e,n,o,t,l,a=1){aliasing?a>1?bresenham_line(n,o,t,l,(i,s)=>{e.drawImage(line_brush_canvas,~~(i-line_brush_canvas.width/2),~~(s-line_brush_canvas.height/2))}):bresenham_line(n,o,t,l,(i,s)=>{e.fillRect(i,s,1,1)}):(e.beginPath(),e.moveTo(n,o),e.lineTo(t,l),e.lineWidth=a,e.lineCap="round",e.stroke(),e.lineCap="butt")}function bresenham_line(e,n,o,t,l){e=~~e,o=~~o,n=~~n,t=~~t;const a=Math.abs(o-e),i=Math.abs(t-n),s=e<o?1:-1,c=n<t?1:-1;let r=a-i;for(;l(e,n),!(e===o&&n===t);){const d=r*2;d>-i&&(r-=i,e+=s),d<a&&(r+=a,n+=c)}}function bresenham_dense_line(e,n,o,t,l){e=~~e,o=~~o,n=~~n,t=~~t;const a=Math.abs(o-e),i=Math.abs(t-n),s=e<o?1:-1,c=n<t?1:-1;let r=a-i;for(;l(e,n),!(e===o&&n===t);){const d=r*2;d>-i&&(r-=i,e+=s),l(e,n),d<a&&(r+=a,n+=c)}}function draw_fill_without_pattern_support(e,n,o,t,l,a,i){const s=main_canvas.width,c=main_canvas.height;n=Math.max(0,Math.min(Math.floor(n),s)),o=Math.max(0,Math.min(Math.floor(o),c));const r=[[n,o]],d=e.getImageData(0,0,s,c);let h=(o*s+n)*4;const m=d.data[h+0],f=d.data[h+1],g=d.data[h+2],x=d.data[h+3];if(Math.abs(t-m)<=fill_threshold&&Math.abs(l-f)<=fill_threshold&&Math.abs(a-g)<=fill_threshold&&Math.abs(i-x)<=fill_threshold)return;for(;r.length;){let M,L,C,u,_;for(M=r.pop(),L=M[0],C=M[1],h=(C*s+L)*4;b(h);)C--,h=(C*s+L)*4;for(u=!1,_=!1;C++,h=(C*s+L)*4,!!(C<c&&b(h));)A(h),L>0&&(b(h-4)?u||(r.push([L-1,C]),u=!0):u&&(u=!1)),L<s-1&&(b(h+4)?_||(r.push([L+1,C]),_=!0):_&&(_=!1)),h+=s*4}e.putImageData(d,0,0);function b(M){return Math.abs(d.data[M+0]-m)<=fill_threshold&&Math.abs(d.data[M+1]-f)<=fill_threshold&&Math.abs(d.data[M+2]-g)<=fill_threshold&&Math.abs(d.data[M+3]-x)<=fill_threshold}function A(M){d.data[M+0]=t,d.data[M+1]=l,d.data[M+2]=a,d.data[M+3]=i}}function draw_fill(e,n,o,t){if(typeof t=="string"){const l=get_rgba_from_color(t);draw_fill_without_pattern_support(e,n,o,l[0],l[1],l[2],l[3])}else{const l=e.canvas,a=make_canvas(l.width,l.height);draw_fill_separately(e,a.ctx,n,o,255,255,255,255),replace_colors_with_swatch(a.ctx,t,0,0),e.drawImage(a,0,0)}}function draw_fill_separately(e,n,o,t,l,a,i,s){const c=main_canvas.width,r=main_canvas.height;o=Math.max(0,Math.min(Math.floor(o),c)),t=Math.max(0,Math.min(Math.floor(t),r));const d=[[o,t]],h=e.getImageData(0,0,c,r),m=n.getImageData(0,0,c,r);let f=(t*c+o)*4;const g=h.data[f+0],x=h.data[f+1],b=h.data[f+2],A=h.data[f+3];for(;d.length;){let C,u,_,y,v;for(C=d.pop(),u=C[0],_=C[1],f=(_*c+u)*4;M(f);)_--,f=(_*c+u)*4;for(y=!1,v=!1;_++,f=(_*c+u)*4,!!(_<r&&M(f));)L(f),u>0&&(M(f-4)?y||(d.push([u-1,_]),y=!0):y&&(y=!1)),u<c-1&&(M(f+4)?v||(d.push([u+1,_]),v=!0):v&&(v=!1)),f+=c*4}n.putImageData(m,0,0);function M(C){return m.data[C+3]===0&&Math.abs(h.data[C+0]-g)<=fill_threshold&&Math.abs(h.data[C+1]-x)<=fill_threshold&&Math.abs(h.data[C+2]-b)<=fill_threshold&&Math.abs(h.data[C+3]-A)<=fill_threshold}function L(C){m.data[C+0]=l,m.data[C+1]=a,m.data[C+2]=i,m.data[C+3]=s}}function replace_color_globally(e,n,o,t,l,a,i,s,c){if(n===a&&o===i&&t===s&&l===c)return;const{data:r}=e;for(let d=0;d<r.length;d+=4)Math.abs(r[d+0]-n)<=fill_threshold&&Math.abs(r[d+1]-o)<=fill_threshold&&Math.abs(r[d+2]-t)<=fill_threshold&&Math.abs(r[d+3]-l)<=fill_threshold&&(r[d+0]=a,r[d+1]=i,r[d+2]=s,r[d+3]=c)}function find_color_globally(e,n,o,t,l,a){const i=e.data,s=n.data;for(let c=0;c<i.length;c+=4)Math.abs(i[c+0]-o)<=fill_threshold&&Math.abs(i[c+1]-t)<=fill_threshold&&Math.abs(i[c+2]-l)<=fill_threshold&&Math.abs(i[c+3]-a)<=fill_threshold&&(s[c+0]=255,s[c+1]=255,s[c+2]=255,s[c+3]=255)}function draw_noncontiguous_fill_without_pattern_support(e,n,o,t,l,a,i){n=Math.max(0,Math.min(Math.floor(n),e.canvas.width)),o=Math.max(0,Math.min(Math.floor(o),e.canvas.height));const s=e.getImageData(0,0,e.canvas.width,e.canvas.height),c=(o*s.width+n)*4,r=s.data[c+0],d=s.data[c+1],h=s.data[c+2],m=s.data[c+3];replace_color_globally(s,r,d,h,m,t,l,a,i),e.putImageData(s,0,0)}function draw_noncontiguous_fill(e,n,o,t){if(typeof t=="string"){const l=get_rgba_from_color(t);draw_noncontiguous_fill_without_pattern_support(e,n,o,l[0],l[1],l[2],l[3])}else{const l=e.canvas,a=make_canvas(l.width,l.height);draw_noncontiguous_fill_separately(e,a.ctx,n,o),replace_colors_with_swatch(a.ctx,t,0,0),e.drawImage(a,0,0)}}function draw_noncontiguous_fill_separately(e,n,o,t){o=Math.max(0,Math.min(Math.floor(o),e.canvas.width)),t=Math.max(0,Math.min(Math.floor(t),e.canvas.height));const l=e.getImageData(0,0,e.canvas.width,e.canvas.height),a=n.getImageData(0,0,n.canvas.width,n.canvas.height),i=(t*l.width+o)*4,s=l.data[i+0],c=l.data[i+1],r=l.data[i+2],d=l.data[i+3];find_color_globally(l,a,s,c,r,d),n.putImageData(a,0,0)}function apply_image_transformation(e,n){const o=selection?selection.source_canvas:main_canvas,t=make_canvas(o.width,o.height),l=o.ctx,a=t.ctx;n(o,l,t,a),selection?undoable({name:`${e.name} (${localize("Selection")})`,icon:e.icon,soft:!0},()=>{selection.replace_source_canvas(t)}):(deselect(),cancel(),undoable({name:e.name,icon:e.icon},()=>{saved=!1,update_title(),main_ctx.copy(t),$canvas_area.trigger("resize")}))}function flip_horizontal(){apply_image_transformation({name:localize("Flip horizontal"),icon:get_help_folder_icon("p_fliph.png")},(e,n,o,t)=>{t.translate(o.width,0),t.scale(-1,1),t.drawImage(e,0,0)})}function flip_vertical(){apply_image_transformation({name:localize("Flip vertical"),icon:get_help_folder_icon("p_flipv.png")},(e,n,o,t)=>{t.translate(0,o.height),t.scale(1,-1),t.drawImage(e,0,0)})}function rotate(e){apply_image_transformation({name:`${localize("Rotate by angle")} ${e/TAU*360} ${localize("Degrees")}`,icon:get_help_folder_icon(`p_rotate_${e>=0?"cw":"ccw"}.png`)},(n,o,t,l)=>{switch(l.save(),e){case TAU/4:case TAU*-3/4:t.width=n.height,t.height=n.width,l.disable_image_smoothing(),l.translate(t.width,0),l.rotate(TAU/4);break;case TAU/2:case TAU/-2:l.translate(t.width,t.height),l.rotate(TAU/2);break;case TAU*3/4:case TAU/-4:t.width=n.height,t.height=n.width,l.disable_image_smoothing(),l.translate(0,t.height),l.rotate(TAU/-4);break;default:{const a=n.width,i=n.height;let s=1/0,c=-1/0,r=1/0,d=-1/0;const h=(b,A)=>{const M=Math.sin(-e)*i*b+Math.cos(+e)*a*A,L=Math.sin(+e)*a*A+Math.cos(-e)*i*b;s=Math.min(s,M),c=Math.max(c,M),r=Math.min(r,L),d=Math.max(d,L)};h(0,0),h(0,1),h(1,0),h(1,1);const m=s,f=r,g=c-s,x=d-r;t.width=g,t.height=x,l.disable_image_smoothing(),transparency||(l.fillStyle=selected_colors.background,l.fillRect(0,0,t.width,t.height)),l.translate(-m,-f),l.rotate(e),l.drawImage(n,0,0,a,i);break}}l.drawImage(n,0,0),l.restore()})}function stretch_and_skew(e,n,o,t){apply_image_transformation({name:o!==0||t!==0?e!==1||n!==1?localize("Stretch and Skew"):localize("Skew"):localize("Stretch"),icon:get_help_folder_icon(o!==0?"p_skew_h.png":t!==0?"p_skew_v.png":n!==1?e!==1?"p_stretch_both.png":"p_stretch_v.png":"p_stretch_h.png")},(l,a,i,s)=>{const c=l.width*e,r=l.height*n;let d=1/0,h=-1/0,m=1/0,f=-1/0;const g=(L,C)=>{const u=Math.tan(o)*r*L+c*C,_=Math.tan(t)*c*C+r*L;d=Math.min(d,u),h=Math.max(h,u),m=Math.min(m,_),f=Math.max(f,_)};g(0,0),g(0,1),g(1,0),g(1,1);const x=d,b=m,A=h-d,M=f-m;i.width=Math.max(1,A),i.height=Math.max(1,M),s.disable_image_smoothing(),transparency||(s.fillStyle=selected_colors.background,s.fillRect(0,0,i.width,i.height)),s.save(),s.transform(1,Math.tan(t),Math.tan(o),1,-x,-b),s.drawImage(l,0,0,c,r),s.restore()})}function invert_rgb(e,n=e){const o=e.getImageData(0,0,e.canvas.width,e.canvas.height);for(let t=0;t<o.data.length;t+=4)o.data[t+0]=255-o.data[t+0],o.data[t+1]=255-o.data[t+1],o.data[t+2]=255-o.data[t+2];n.putImageData(o,0,0)}function invert_monochrome(e,n=e,o=detect_monochrome(e)){const t=e.getImageData(0,0,e.canvas.width,e.canvas.height),l=new Uint32Array(t.data.buffer);if(o.presentNonTransparentUint32s.length===0)return;if(o.presentNonTransparentUint32s.length===1){const s=palette[0],c=palette[14]||palette[1],r=get_rgba_from_color(s),d=o.presentNonTransparentRGBAs[0];d[0]===r[0]&&d[1]===r[1]&&d[2]===r[2]&&d[3]===r[3]?n.fillStyle=c:n.fillStyle=s,o.monochromeWithTransparency&&(n.putImageData(t,0,0),n.globalCompositeOperation="source-in"),n.fillRect(0,0,e.canvas.width,e.canvas.height);return}const[a,i]=o.presentNonTransparentUint32s;for(let s=0,c=l.length;s<c;s+=1)l[s]===a?l[s]=i:l[s]===i&&(l[s]=a);n.putImageData(t,0,0)}function threshold_black_and_white(e,n){const o=e.getImageData(0,0,e.canvas.width,e.canvas.height);for(let t=0;t<o.data.length;t+=4){const l=(o.data[t+0]+o.data[t+1]+o.data[t+2])/3/255>n;o.data[t+0]=l?255:0,o.data[t+1]=l?255:0,o.data[t+2]=l?255:0,o.data[t+3]=255}e.putImageData(o,0,0)}function replace_colors_with_swatch(e,n,o=0,t=0){e.globalCompositeOperation="source-in",e.fillStyle=n,e.beginPath(),e.rect(0,0,e.canvas.width,e.canvas.height),e.save(),e.translate(-o,-t),e.fill(),e.restore()}function compute_bezier(e,n,o,t,l,a,i,s,c){const r=1-e,d=r*r,h=e*e;let m,f,g,x=0;return m=d*r,f=d*e*3,g=r*h*3,x=e*h,{x:m*n+f*t+g*a+x*s,y:m*o+f*l+g*i+x*c}}function draw_bezier_curve_without_pattern_support(e,n,o,t,l,a,i,s,c,r){let h={x:n,y:o};for(let m=0;m<1;m+=1/100){const f=compute_bezier(m,n,o,t,l,a,i,s,c);draw_line_without_pattern_support(e,h.x,h.y,f.x,f.y,r),h=f}}function draw_quadratic_curve(e,n,o,t,l,a,i,s){draw_bezier_curve(e,n,o,t,l,t,l,a,i,s)}function draw_bezier_curve(e,n,o,t,l,a,i,s,c,r){const d=Math.min(n,t,a,s),h=Math.min(o,l,i,c),m=Math.max(n,t,a,s),f=Math.max(o,l,i,c);draw_with_swatch(e,d,h,m,f,stroke_color,g=>{draw_bezier_curve_without_pattern_support(g,n,o,t,l,a,i,s,c,r)})}function draw_line(e,n,o,t,l,a){const i=Math.min(n,t),s=Math.min(o,l),c=Math.max(n,t),r=Math.max(o,l);draw_with_swatch(e,i,s,c,r,stroke_color,d=>{draw_line_without_pattern_support(d,n,o,t,l,a)})}let grid_pattern,grid_pattern_size=-1;function draw_grid(e,n){const o=Math.floor(n);if(!grid_pattern||grid_pattern_size!==o){grid_pattern_size=o;const t=make_canvas(o,o),l="#808080",a="#c0c0c0";t.ctx.fillStyle=l,t.ctx.fillRect(0,0,1,o),t.ctx.fillStyle=l,t.ctx.fillRect(0,0,o,1),t.ctx.fillStyle=a;for(let i=1;i<o;i+=2)t.ctx.fillRect(i,0,1,1),t.ctx.fillRect(0,i,1,1);grid_pattern=e.createPattern(t,"repeat")}e.save(),e.rect(0,0,e.canvas.width,e.canvas.height),n!==o&&e.translate(-.5,-.75),e.scale(n/o,n/o),e.enable_image_smoothing(),e.fillStyle=grid_pattern,e.fill(),e.restore()}const svg_for_creating_matrices=document.createElementNS("http://www.w3.org/2000/svg","svg"),horizontal_pattern_canvas=make_canvas(8,4),vertical_pattern_canvas=make_canvas(4,8);let horizontal_pattern,vertical_pattern;function draw_dashes(e,n,o,t,l,a,i,s){vertical_pattern||(horizontal_pattern_canvas.ctx.fillStyle="white",horizontal_pattern_canvas.ctx.fillRect(4,0,4,4),vertical_pattern_canvas.ctx.fillStyle="white",vertical_pattern_canvas.ctx.fillRect(0,4,4,4),horizontal_pattern=e.createPattern(horizontal_pattern_canvas,"repeat"),vertical_pattern=e.createPattern(vertical_pattern_canvas,"repeat"));const c=1,r=1/a;if(e.save(),e.scale(a,a),e.translate(i,s),e.translate(n,o),e.globalCompositeOperation="difference",t>0){const d=svg_for_creating_matrices.createSVGMatrix();horizontal_pattern.setTransform&&horizontal_pattern.setTransform(d.translate(-n,-o).translate(r,0).scale(1/a)),e.fillStyle=horizontal_pattern,e.fillRect(0,0,t,c)}else if(l>0){const d=svg_for_creating_matrices.createSVGMatrix();vertical_pattern.setTransform&&vertical_pattern.setTransform(d.translate(-n,-o).translate(0,r).scale(1/a)),e.fillStyle=vertical_pattern,e.fillRect(0,0,c,l)}e.restore()}function draw_selection_box(e,n,o,t,l,a,i,s){draw_dashes(e,n,o,t-1,0,a,i,s),l===1?draw_dashes(e,n,o,0,1,a,i,s):draw_dashes(e,n,o+1,0,l-2,a,i,s),draw_dashes(e,n+t-1,o,0,l,a,i,s),draw_dashes(e,n,o+l-1,t-1,0,a,i,s),draw_dashes(e,n,o+1,0,1,a,i,s)}let tessy,gl,positionLoc,op_canvas_webgl,op_canvas_2d,op_ctx_2d;function initTesselator(){function e(i,s){s[s.length]=i[0],s[s.length]=i[1]}function n(i){var s;i!==libtess.primitiveType.GL_TRIANGLES&&((s=window.console)==null||s.log(`Expected TRIANGLES but got type: ${i}`))}function o(i){var s,c;(s=window.console)==null||s.log("error callback"),(c=window.console)==null||c.log(`error number: ${i}`)}function t(i,s,c){return[i[0],i[1],i[2]]}function l(i){}const a=new libtess.GluTesselator;return a.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA,e),a.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN,n),a.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR,o),a.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE,t),a.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG,l),a}function triangulate(e){tessy.gluTessNormal(0,0,1);const n=[];tessy.gluTessBeginPolygon(n);for(let o=0;o<e.length;o++){tessy.gluTessBeginContour();const t=e[o];for(let l=0;l<t.length;l+=2){const a=[t[l],t[l+1],0];tessy.gluTessVertex(a,a)}tessy.gluTessEndContour()}return tessy.gluTessEndPolygon(),n}function initWebGL(e){try{gl=e.getContext("webgl",{antialias:!1})}catch(o){show_error_message$1("Failed to get WebGL context. You may need to refresh the web page, or restart your computer.",o);return}if(!gl){show_error_message$1("Failed to get WebGL context. You may need to refresh the web page, or restart your computer.");return}window.WEBGL_lose_context=gl.getExtension("WEBGL_lose_context");const n=createShaderProgram();positionLoc=gl.getAttribLocation(n,"position"),gl.enableVertexAttribArray(positionLoc)}function initArrayBuffer(e){const n=new Float32Array(e),o=gl.createBuffer();return gl.bindBuffer(gl.ARRAY_BUFFER,o),gl.bufferData(gl.ARRAY_BUFFER,n,gl.STATIC_DRAW),gl.vertexAttribPointer(positionLoc,2,gl.FLOAT,!1,0,0),e.length/2}function createShaderProgram(){var a,i;const e=["attribute vec4 position;","void main() {","	/* already in normalized coordinates, so just pass through */","	gl_Position = position;","}"].join(""),n=gl.createShader(gl.VERTEX_SHADER);gl.shaderSource(n,e),gl.compileShader(n),gl.getShaderParameter(n,gl.COMPILE_STATUS)||(a=window.console)==null||a.log(`Vertex shader failed to compile. Log: ${gl.getShaderInfoLog(n)}`);const o=["precision mediump float;","void main() {","	gl_FragColor = vec4(0, 0, 0, 1);","}"].join(""),t=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(t,o),gl.compileShader(t),gl.getShaderParameter(t,gl.COMPILE_STATUS)||(i=window.console)==null||i.log(`Fragment shader failed to compile. Log: ${gl.getShaderInfoLog(t)}`);const l=gl.createProgram();return gl.attachShader(l,n),gl.attachShader(l,t),gl.linkProgram(l),gl.useProgram(l),l}function init_webgl_stuff(){tessy=initTesselator(),op_canvas_webgl=document.createElement("canvas"),op_canvas_2d=document.createElement("canvas"),op_ctx_2d=op_canvas_2d.getContext("2d"),initWebGL(op_canvas_webgl);let e;op_canvas_webgl.addEventListener("webglcontextlost",n=>{var o;n.preventDefault(),(o=window.console)==null||o.warn("WebGL context lost"),clamp_brush_sizes(),e=setTimeout(()=>{show_error_message$1("The WebGL context was lost. You may need to refresh the web page, or restart your computer.")},3e3)},!1),op_canvas_webgl.addEventListener("webglcontextrestored",()=>{var n;initWebGL(op_canvas_webgl),(n=window.console)==null||n.warn("WebGL context restored"),clearTimeout(e),clamp_brush_sizes(),$G$1.triggerHandler("invalidate-brush-canvases"),$G$1.triggerHandler("redraw-tool-options-because-webglcontextrestored")},!1)}function clamp_brush_sizes(){brush_size>100&&(brush_size=100,show_error_message$1("Brush size clamped to 100")),pencil_size>100&&(pencil_size=100,show_error_message$1("Pencil size clamped to 100")),stroke_size>100&&(stroke_size=100,show_error_message$1("Stroke size clamped to 100"))}function draw_line_strip(e,n){draw_polygon_or_line_strip(e,n,!0,!1,!1)}function draw_polygon(e,n,o,t){draw_polygon_or_line_strip(e,n,o,t,!0)}function draw_polygon_or_line_strip(e,n,o,t,l){if(!gl){show_error_message$1("Failed to get WebGL context. You may need to refresh the web page, or restart your computer.");return}o&&stroke_size>1&&update_brush_for_drawing_lines(stroke_size);const a=e.strokeStyle,i=e.fillStyle,s=n.length,c=s*2;if(s===0)return;let r=1/0,d=-1/0,h=1/0,m=-1/0;for(const{x:g,y:x}of n)r=Math.min(g,r),d=Math.max(g,d),h=Math.min(x,h),m=Math.max(x,m);d+=1,m+=1,r-=1,h-=1,op_canvas_webgl.width=d-r,op_canvas_webgl.height=m-h,gl.viewport(0,0,op_canvas_webgl.width,op_canvas_webgl.height);const f=new Float32Array(c);for(let g=0;g<s;g++)f[g*2+0]=(n[g].x-r)/op_canvas_webgl.width*2-1,f[g*2+1]=1-(n[g].y-h)/op_canvas_webgl.height*2;if(t){const x=triangulate([f]);let b=initArrayBuffer(x);gl.clear(gl.COLOR_BUFFER_BIT),gl.drawArrays(gl.TRIANGLES,0,b),op_canvas_2d.width=op_canvas_webgl.width,op_canvas_2d.height=op_canvas_webgl.height,op_ctx_2d.drawImage(op_canvas_webgl,0,0),replace_colors_with_swatch(op_ctx_2d,i,r,h),e.drawImage(op_canvas_2d,r,h)}if(o)if(stroke_size>1){const g=~~(stroke_size*1.1),x=r-g,b=h-g;op_canvas_2d.width=d-r+g*2,op_canvas_2d.height=m-h+g*2;for(let A=0;A<s-(l?0:1);A++){const M=n[A],L=n[(A+1)%s];draw_line_without_pattern_support(op_ctx_2d,M.x-x,M.y-b,L.x-x,L.y-b,stroke_size)}replace_colors_with_swatch(op_ctx_2d,a,x,b),e.drawImage(op_canvas_2d,x,b)}else{let g=initArrayBuffer(f);gl.clear(gl.COLOR_BUFFER_BIT),gl.drawArrays(l?gl.LINE_LOOP:gl.LINE_STRIP,0,g),op_canvas_2d.width=op_canvas_webgl.width,op_canvas_2d.height=op_canvas_webgl.height,op_ctx_2d.drawImage(op_canvas_webgl,0,0),replace_colors_with_swatch(op_ctx_2d,a,r,h),e.drawImage(op_canvas_2d,r,h)}}function copy_contents_within_polygon(e,n,o,t,l,a){l=Math.max(l,o+1),a=Math.max(a,t+1);const i=l-o,s=a-t,c=make_canvas(e);c.ctx.save(),c.ctx.globalCompositeOperation="destination-in",draw_polygon(c.ctx,n,!1,!0),c.ctx.restore();const r=make_canvas(i,s);return r.ctx.drawImage(c,o,t,i,s,0,0,i,s),r}function draw_with_swatch(e,n,o,t,l,a,i){const s=~~(stroke_size*1.1);t=Math.max(t,n+1),l=Math.max(l,o+1),op_canvas_2d.width=t-n+s*2,op_canvas_2d.height=l-o+s*2;const c=n-s,r=o-s;op_ctx_2d.save(),op_ctx_2d.translate(-c,-r),i(op_ctx_2d),op_ctx_2d.restore(),replace_colors_with_swatch(op_ctx_2d,a,c,r),e.drawImage(op_canvas_2d,c,r)}console.log("JS 실행:","$FontBox.js");const eachFont=async(e,n)=>{function o(){FontDetective.each(e),FontDetective.all(n)}if(window.queryLocalFonts){let t;try{t=await window.queryLocalFonts()}catch(a){console.log("queryLocalFonts failed:",a,`
Falling back to FontDetective.`),o();return}if(t.length===0){console.log("queryLocalFonts returned no fonts; falling back to FontDetective."),o();return}const l=new Set;for(const a of t)l.has(a.family)||(l.add(a.family),e({name:a.family,toString(){return'"'+this.name.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}}));n()}else console.log("queryLocalFonts unavailable; falling back to FontDetective."),o()};function $FontBox(){const e=$(E("div")).addClass("font-box"),n=$(E("select")).addClass("inset-deep").attr({"aria-label":"Font Family","aria-description":localize("Selects the font used by the text.")}),o=$(E("input")).addClass("inset-deep").attr({type:"number",min:8,max:72,value:text_tool_font.size,"aria-label":"Font Size","aria-description":localize("Selects the point size of the text.")}).css({maxWidth:50}),t=$(E("span")).addClass("text-toolbar-button-group"),l=h(0,"bold","Bold",localize("Sets or clears the text bold attribute.")),a=h(1,"italic","Italic",localize("Sets or clears the text italic attribute.")),i=h(2,"underline","Underline",localize("Sets or clears the text underline attribute.")),s=h(3,"vertical","Vertical Writing Mode",localize("Only a Far East font can be used for vertical editing."));s.prop("disabled",!0),t.append(l,a,i,s),e.append(n,o,t);const c=()=>{text_tool_font.size=Number(o.val()),text_tool_font.family=n.val(),$G$1.trigger("option-changed")},r=text_tool_font.family;eachFont(m=>{const f=$(E("option"));f.val(m).text(m.name);const g=n.children("option");let x=0;for(;x<g.length&&!(g.eq(x).text().localeCompare(m.name)>0);x++);g.eq(x).length?g.eq(x).before(f):n.append(f),text_tool_font.family||c()},()=>{n.val(r),n.val()||n.val('"Liberation Sans"'),n.val()||n.val(n.children("option").eq(0).val()),c()}),text_tool_font.family&&n.val(text_tool_font.family),n.on("change",c),o.on("change",c);const d=$ToolWindow();return d.title(localize("Fonts")),d.$content.append(e),d.center(),d;function h(m,f,g,x){const b=$(E("button")).addClass("toggle").attr({"aria-pressed":!1,"aria-label":g,"aria-description":x}),A=$(E("span")).addClass("icon").appendTo(b);return b.css({width:23,height:22,padding:0,display:"inline-flex",alignContent:"center",alignItems:"center",justifyContent:"center"}),A.css({flex:"0 0 auto",display:"block",width:16,height:16,"--icon-index":m}),b.on("click",()=>{b.toggleClass("selected"),text_tool_font[f]=b.hasClass("selected"),b.attr("aria-pressed",b.hasClass("selected")?"true":"false"),c()}),text_tool_font[f]&&b.addClass("selected").attr("aria-pressed","true"),b}}console.log("JS 실행:","OnCanvasTextBox.js");class OnCanvasTextBox extends OnCanvasObject{constructor(n,o,t,l,a=""){super(n,o,t,l,!0),this.$el.addClass("textbox");var i=E("textarea");this.$editor=$(i).addClass("textbox-editor");var s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("version","1.1");var c=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("x","0"),c.setAttribute("y","0"),s.append(c),this.$editor.css({position:"absolute",left:"0",top:"0",right:"0",bottom:"0",padding:"0",margin:"0",border:"0",resize:"none",overflow:"hidden",minWidth:"3em"});var r=i.cloneNode(!1);c.append(r),i.value=a,this.canvas=make_canvas(t,l),this.canvas.style.pointerEvents="none",this.$el.append(this.canvas);const d=()=>{this.position(),this.$el.triggerHandler("update"),this.$editor.add(r).css({width:this.width,height:this.height})},h=()=>{i.style.height="",i.style.minHeight="0px",i.style.bottom="",i.setAttribute("rows","1"),this.height=Math.max(i.scrollHeight,this.height),i.removeAttribute("rows"),this.width=i.scrollWidth,i.style.bottom="0",d()},m=()=>{requestAnimationFrame(()=>{i.scrollTop=0});const M=text_tool_font,L=y=>`rgba(${get_rgba_from_color(y).join(", ")}`;for(M.color=L(selected_colors.foreground),M.background=tool_transparent_mode?"transparent":L(selected_colors.background),this.$editor.add(this.canvas).css({transform:`scale(${magnification})`,transformOrigin:"left top"}),this.$editor.add(r).css({width:this.width,height:this.height,fontFamily:M.family,fontSize:`${M.size}pt`,fontWeight:M.bold?"bold":"normal",fontStyle:M.italic?"italic":"normal",textDecoration:M.underline?"underline":"none",writingMode:M.vertical?"vertical-lr":"",MsWritingMode:M.vertical?"vertical-lr":"",WebkitWritingMode:M.vertical?"vertical-lr":"",lineHeight:`${M.size*M.line_scale}px`,color:M.color,background:M.background}),h();r.firstChild;)r.removeChild(r.firstChild);r.appendChild(document.createTextNode(i.value)),s.setAttribute("width",this.width.toString()),s.setAttribute("height",this.height.toString()),c.setAttribute("width",this.width.toString()),c.setAttribute("height",this.height.toString());var C=new XMLSerializer().serializeToString(s),u=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(C)}`,_=new Image;_.onload=()=>{this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.ctx.drawImage(_,0,0),update_helper_layer()},_.onerror=y=>{var v;(v=window.console)==null||v.log("Failed to load image",y)},_.src=u};$G$1.on("option-changed",this._on_option_changed=m),this.$editor.on("input",this._on_input=m),this.$editor.on("scroll",this._on_scroll=()=>{requestAnimationFrame(()=>{i.scrollTop=0})}),this.$el.css({cursor:make_css_cursor("move",[8,8],"move"),touchAction:"none"}),this.position(),this.$el.append(this.$editor),this.$editor[0].focus(),this.handles=new Handles({$handles_container:this.$el,$object_container:$canvas_area,outset:2,thick:!0,get_rect:()=>({x:this.x,y:this.y,width:this.width,height:this.height}),set_rect:({x:M,y:L,width:C,height:u})=>{this.x=M,this.y=L,this.width=C,this.height=u,this.position(),m(),this.canvas.width=C,this.canvas.height=u},constrain_rect:({x:M,y:L,width:C,height:u},_,y)=>{const v=this.x,T=this.y,k=this.width,P=this.height;return this.x=M,this.y=L,this.width=C,this.height=u,d(),h(),_===-1&&(M=Math.min(this.x,v+k-this.width)),y===-1&&(L=Math.min(this.y,T+P-this.height)),C=this.width,u=this.height,this.x=v,this.y=T,this.width=k,this.height=P,d(),{x:M,y:L,width:C,height:u}},get_ghost_offset_left:()=>parseFloat($canvas_area.css("padding-left"))+1,get_ghost_offset_top:()=>parseFloat($canvas_area.css("padding-top"))+1});let f,g;const x=M=>{const L=to_canvas_coords(M);this.x=Math.max(Math.min(L.x-f,main_canvas.width),-this.width),this.y=Math.max(Math.min(L.y-g,main_canvas.height),-this.height),this.position(),M.shiftKey};this.$el.on("pointerdown",M=>{if(M.target instanceof HTMLInputElement||M.target instanceof HTMLTextAreaElement||M.target.classList.contains("handle")||M.target.classList.contains("grab-region"))return;M.preventDefault();const L=this.$el[0].getBoundingClientRect(),C=M.clientX-L.left,u=M.clientY-L.top;f=~~(C/L.width*this.canvas.width),g=~~(u/L.height*this.canvas.height),this.dragging=!0,update_helper_layer(),$G$1.on("pointermove",x),$G$1.one("pointerup",()=>{$G$1.off("pointermove",x),this.dragging=!1,update_helper_layer()})}),$status_position.text(""),$status_size.text(""),$canvas_area.trigger("resize"),OnCanvasTextBox.$fontbox&&OnCanvasTextBox.$fontbox.closed&&(OnCanvasTextBox.$fontbox=null);const b=OnCanvasTextBox.$fontbox=OnCanvasTextBox.$fontbox||$FontBox(),A=()=>{const M=b[0].getBoundingClientRect(),L=this.$el[0].getBoundingClientRect();M.left<=L.right&&L.left<=M.right&&M.top<=L.bottom&&L.top<=M.bottom&&b.css({top:this.$el.position().top-b.height()}),b.applyBounds()};m(),A(),$(window).on("resize",this._on_window_resize=()=>{this.$editor[0].scrollIntoView({block:"nearest",inline:"nearest"}),A()})}position(){super.position(!0),update_helper_layer()}destroy(){super.destroy(),OnCanvasTextBox.$fontbox&&!OnCanvasTextBox.$fontbox.closed&&OnCanvasTextBox.$fontbox.close(),OnCanvasTextBox.$fontbox=null,$G$1.off("option-changed",this._on_option_changed),this.$editor.off("input",this._on_input),this.$editor.off("scroll",this._on_scroll),$(window).off("resize",this._on_window_resize),update_helper_layer()}}OnCanvasTextBox.$fontbox=null;console.log("JS 실행:","tool-options.js");const ChooserCanvas=(e,n,o,t,l,a,i,s,c,r,d,h,m)=>{const f=m(o,t);let g=ChooserCanvas.cache[e];g||(g=ChooserCanvas.cache[e]=E("img"),g.onerror=()=>{delete ChooserCanvas.cache[e]},g.src=e);const x=()=>{try{f.ctx.drawImage(g,l,a,i,s,c,r,d,h)}catch{}f.style.filter=n?"invert()":""};return $(g).on("load",x),x(),f};ChooserCanvas.cache={};const ChooserDiv=(e,n,o,t,l,a,i,s,c,r,d,h,m,f)=>{const g=m(o,t);g.classList.add(e),g.style.width=i+"px",g.style.height=s+"px";const x=()=>{const b=get_theme()==="modern.css"||get_theme()==="modern-dark.css"||get_theme()==="bubblegum.css",A=b?window.devicePixelRatio!==1:window.devicePixelRatio>=3||window.devicePixelRatio%1!==0;g.classList.toggle("use-svg",A),g.style.backgroundPosition=`${-l}px ${-a-(b&&f?1:0)}px`};return g._on_zoom_etc&&$G$1.off("theme-load resize",g._on_zoom_etc),$G$1.on("theme-load resize",x),g._on_zoom_etc=x,x(),g.style.borderColor="transparent",g.style.borderStyle="solid",g.style.borderLeftWidth=c+"px",g.style.borderTopWidth=r+"px",g.style.borderRightWidth=o-c-d+"px",g.style.borderBottomWidth=t-r-h+"px",g.style.backgroundClip="content-box",g.style.filter=n?"invert()":"",g},$Choose=(e,n,o,t,l)=>{const a=$(E("div")).addClass("chooser").css("touch-action","none"),i=s=>{t(s)||(o(s),$G$1.trigger("option-changed"))};return a.on("update",()=>{if(!a.is(":visible"))return;a.empty();for(let r=0;r<e.length;r++)(d=>{const h=$(E("div")).addClass("chooser-option").appendTo(a);h.data("thing",d);const m=(x,b)=>{let A=h.find("canvas")[0];return A?(A.width!==x&&(A.width=x),A.height!==b&&(A.height=b)):(A=make_canvas(x,b),h.append(A)),A},f=(x,b)=>{let A=h.find("div")[0];return A?(A.style.width!==x+"px"&&(A.style.width=x+"px"),A.style.height!==b+"px"&&(A.style.height=b+"px")):(A=E("div"),A.style.width=x+"px",A.style.height=b+"px",h.append(A)),A},g=()=>{const x=getComputedStyle(a[0]).getPropertyValue("--Hilight"),b=l?"rgb(192, 192, 192)":"";h.css({backgroundColor:t(d)?x:b}),n(d,t(d),m,f)};g(),$G$1.on("option-changed theme-load redraw-tool-options-because-webglcontextrestored",g)})(e[r]);const s=r=>{const d=r.target.closest(".chooser-option");d&&i($(d).data("thing"))},c=r=>{const d=r.originalEvent.changedTouches[0],m=document.elementFromPoint(d.clientX,d.clientY).closest(".chooser-option");m&&i($(m).data("thing")),r.preventDefault()};a.on("pointerdown click",r=>{const d=r.target.closest(".chooser-option");d&&i($(d).data("thing")),r.type==="pointerdown"&&(a.on("pointerover",s),a.on("touchmove",c))}),$G$1.on("pointerup pointercancel",()=>{a.off("pointerover",s),a.off("touchmove",c)})}),a},$ChooseShapeStyle=()=>{const e=$Choose([{stroke:!0,fill:!1},{stroke:!0,fill:!0},{stroke:!1,fill:!0}],({stroke:n,fill:o},t,l)=>{const a=l(39,21),i=a.ctx;let s=5;const c=getComputedStyle(a);return i.fillStyle=t?c.getPropertyValue("--HilightText"):c.getPropertyValue("--WindowText"),n&&i.fillRect(s,s,a.width-s*2,a.height-s*2),s+=1,i.fillStyle=c.getPropertyValue("--ButtonShadow"),o?i.fillRect(s,s,a.width-s*2,a.height-s*2):i.clearRect(s,s,a.width-s*2,a.height-s*2),a},({stroke:n,fill:o})=>{e.stroke=n,e.fill=o},({stroke:n,fill:o})=>e.stroke===n&&e.fill===o).addClass("choose-shape-style");return e.fill=!1,e.stroke=!0,e},$choose_brush=$Choose((()=>{const e=["circle","square","reverse_diagonal","diagonal"],n=[7,4,1],o=[8,5,2],t=[];return e.forEach(l=>{(l==="circle"?n:o).forEach(i=>{t.push({shape:l,size:i})})}),t})(),(e,n,o)=>{const t=o(10,10),l=getComputedStyle(t),a=e.shape,i=e.size,s=n?l.getPropertyValue("--HilightText"):l.getPropertyValue("--WindowText");return stamp_brush_canvas(t.ctx,5,5,a,i),replace_colors_with_swatch(t.ctx,s),t},({shape:e,size:n})=>{brush_shape=e,brush_size=n},({shape:e,size:n})=>brush_shape===e&&brush_size===n).addClass("choose-brush"),$choose_eraser_size=$Choose([4,6,8,10],(e,n,o)=>{const t=o(39,16),l=getComputedStyle(t);return t.ctx.fillStyle=n?l.getPropertyValue("--HilightText"):l.getPropertyValue("--WindowText"),render_brush(t.ctx,"square",e),t},e=>{eraser_size=e},e=>eraser_size===e).addClass("choose-eraser"),$choose_stroke_size=$Choose([1,2,3,4,5],(e,n,o)=>{const i=o(39,12),s=(12-e)/2,c=getComputedStyle(i);return i.ctx.fillStyle=n?c.getPropertyValue("--HilightText"):c.getPropertyValue("--WindowText"),i.ctx.fillRect(5,~~s,39-5*2,e),i},e=>{stroke_size=e},e=>stroke_size===e).addClass("choose-stroke-size"),magnifications=[1,2,6,8,10],$choose_magnification=$Choose(magnifications,(e,n,o,t)=>{const l=magnifications.indexOf(e),a=e===10,i=ChooserDiv("magnification-option",n,39,a?2:13,l*23,0,23,9,8,2,23,9,t);return a&&$(i).addClass("secret-option"),i},e=>{set_magnification(e)},e=>e===magnification,!0).addClass("choose-magnification").css({position:"relative"});$choose_magnification.on("update",()=>{$choose_magnification.find(".secret-option").parent().css({position:"absolute",bottom:"-2px",left:0,opacity:0,height:2,overflow:"hidden"})});const airbrush_sizes=[9,16,24],$choose_airbrush_size=$Choose(airbrush_sizes,(e,n,o)=>{const l=airbrush_sizes.indexOf(e),a=airbrush_sizes.length,s=l===2?0:4,c=72/a-s*2,r=23,d=72/a*l+s;return ChooserCanvas("images/options-airbrush-size.png",n,c,r,d,0,c,r,0,0,c,r,o)},e=>{airbrush_size=e},e=>e===airbrush_size,!0).addClass("choose-airbrush-size"),$choose_transparent_mode=$Choose([!1,!0],(e,n,o,t)=>ChooserDiv("transparent-mode-option",!1,39,27,0,e?22:0,35,23,2,2,35,23,t,e),e=>{tool_transparent_mode=e},e=>e===tool_transparent_mode,!0).addClass("choose-transparent-mode");console.log("JS 실행:","tools.js");const TOOL_FREE_FORM_SELECT="TOOL_FREE_FORM_SELECT",TOOL_SELECT="TOOL_SELECT",TOOL_ERASER="TOOL_ERASER",TOOL_FILL="TOOL_FILL",TOOL_PICK_COLOR="TOOL_PICK_COLOR",TOOL_MAGNIFIER="TOOL_MAGNIFIER",TOOL_PENCIL="TOOL_PENCIL",TOOL_BRUSH="TOOL_BRUSH",TOOL_AIRBRUSH="TOOL_AIRBRUSH",TOOL_TEXT="TOOL_TEXT",TOOL_LINE="TOOL_LINE",TOOL_CURVE="TOOL_CURVE",TOOL_RECTANGLE="TOOL_RECTANGLE",TOOL_POLYGON="TOOL_POLYGON",TOOL_ELLIPSE="TOOL_ELLIPSE",TOOL_ROUNDED_RECTANGLE="TOOL_ROUNDED_RECTANGLE",tools=[{id:TOOL_FREE_FORM_SELECT,name:localize("Free-Form Select"),speech_recognition:["lasso","select with lasso","select by lassoing","lassoing","lasso select","freeform select","free-form select","free form select","polygonal select","polygon select","shape select","outline select","select by outline","select by outlining","star select","shape select","select by shape","select by drawing a shape","select by drawing shape","lasso selection","freeform selection","free-form selection","free form selection","polygonal selection","polygon selection","shape selection","outline selection","selection by outline","selection by outlining","star selection","shape selection","selection by shape","selection by drawing a shape","selection by drawing shape","lasso selecting","freeform selecting","free-form selecting","free form selecting","polygonal selecting","polygon selecting","shape selecting","outline selecting","selecting by outline","selecting by outlining","star selecting","shape selecting","selecting by shape","selecting by drawing a shape","selecting by drawing shape","lasso selector","freeform selector","free-form selector","free form selector","polygonal selector","polygon selector","shape selector","outline selector","by outline selector","outlining selector","star selector","shape selector","by shape selector","by drawing a shape selector","by drawing shape selector"],help_icon:"p_free.gif",description:localize("Selects a free-form part of the picture to move, copy, or edit."),cursor:["precise",[16,16],"crosshair"],preview_canvas:null,points:[],x_min:1/0,x_max:-1/0,y_min:1/0,y_max:-1/0,pointerdown(){this.x_min=pointer.x,this.x_max=pointer.x+1,this.y_min=pointer.y,this.y_max=pointer.y+1,this.points=[],this.preview_canvas=make_canvas(main_canvas.width,main_canvas.height),deselect()},paint(e,n,o){pointer.x=Math.min(main_canvas.width,pointer.x),pointer.x=Math.max(0,pointer.x),pointer.y=Math.min(main_canvas.height,pointer.y),pointer.y=Math.max(0,pointer.y),this.points.push(pointer),this.x_min=Math.min(pointer.x,this.x_min),this.x_max=Math.max(pointer.x,this.x_max),this.y_min=Math.min(pointer.y,this.y_min),this.y_max=Math.max(pointer.y,this.y_max),bresenham_line(pointer_previous.x,pointer_previous.y,pointer.x,pointer.y,(t,l)=>{this.ffs_paint_iteration(t,l)}),$status_size.text(`${this.x_max-this.x_min}x${this.y_max-this.y_min}`)},ffs_paint_iteration(e,n){e=Math.min(main_canvas.width,e),e=Math.max(0,e),n=Math.min(main_canvas.height,n),n=Math.max(0,n);const o=2,t=~~(e-o/2),l=~~(n-o/2),a=o,i=o,s=this.preview_canvas.ctx,c=main_ctx.getImageData(t,l,a,i),r=s.getImageData(t,l,a,i);for(let d=0,h=r.data.length;d<h;d+=4)r.data[d+0]=255-c.data[d+0],r.data[d+1]=255-c.data[d+1],r.data[d+2]=255-c.data[d+2],r.data[d+3]=255;s.putImageData(r,t,l)},pointerup(){this.preview_canvas.width=1,this.preview_canvas.height=1;const e=copy_contents_within_polygon(main_canvas,this.points,this.x_min,this.y_min,this.x_max,this.y_max);selection&&(show_error_message$1("This isn't supposed to happen: Free-Form Select after Select in the tool chain?"),meld_selection_into_canvas()),undoable({name:localize("Free-Form Select"),icon:get_icon_for_tool(get_tool_by_id(TOOL_FREE_FORM_SELECT)),soft:!0},()=>{selection=new OnCanvasSelection(this.x_min,this.y_min,this.x_max-this.x_min,this.y_max-this.y_min,e),selection.cut_out_background()})},cancel(){this.preview_canvas&&(this.preview_canvas.width=1,this.preview_canvas.height=1)},drawPreviewUnderGrid(e,n,o,t,l,a,i){!pointer_active&&!pointer_over_canvas||this.preview_canvas&&(e.scale(l,l),e.translate(a,i),e.drawImage(this.preview_canvas,0,0))},$options:$choose_transparent_mode},{id:TOOL_SELECT,name:localize("Select"),speech_recognition:[],help_icon:"p_sel.gif",description:localize("Selects a rectangular part of the picture to move, copy, or edit."),cursor:["precise",[16,16],"crosshair"],selectBox(e,n,o,t){if(o>1&&t>1){var l=selection;if(selection&&meld_selection_into_canvas(),ctrl)undoable({name:"Crop"},()=>{var h=make_canvas(o,t);h.ctx.drawImage(main_canvas,-e,-n),main_ctx.copy(h),canvas_handles.show(),$canvas_area.trigger("resize")});else if(l){var a=Math.min(l.x,e),i=Math.min(l.y,n),s=Math.max(l.x+l.width,e+o),c=Math.max(l.y+l.height,n+t),r=make_canvas(s-a,c-i),d=make_canvas(s-a,c-i);d.ctx.drawImage(main_canvas,e,n,o,t,e-a,n-i,o,t),r.ctx.drawImage(l.canvas,l.x-a,l.y-i),r.ctx.globalCompositeOperation="xor",r.ctx.drawImage(d,0,0),undoable({name:`${localize("Free-Form Select")}⊕${localize("Select")}`,icon:get_icon_for_tools([get_tool_by_id(TOOL_FREE_FORM_SELECT),get_tool_by_id(TOOL_SELECT)]),soft:!0},()=>{selection=new OnCanvasSelection(a,i,s-a,c-i,r),selection.cut_out_background()})}else undoable({name:localize("Select"),icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{selection=new OnCanvasSelection(e,n,o,t)})}},$options:$choose_transparent_mode},{id:TOOL_ERASER,name:localize("Eraser/Color Eraser"),speech_recognition:[],help_icon:"p_erase.gif",description:localize("Erases a portion of the picture, using the selected eraser shape."),cursor:["precise",[16,16],"crosshair"],mask_canvas:null,get_rect(e,n){const o=Math.ceil(e-eraser_size/2),t=Math.ceil(n-eraser_size/2),l=eraser_size,a=eraser_size;return{rect_x:o,rect_y:t,rect_w:l,rect_h:a}},drawPreviewUnderGrid(e,n,o,t,l,a,i){if(!pointer_active&&!pointer_over_canvas)return;const{rect_x:s,rect_y:c,rect_w:r,rect_h:d}=this.get_rect(n,o);e.scale(l,l),e.translate(a,i),this.mask_canvas&&this.render_from_mask(e,!0),e.fillStyle=selected_colors.background,e.fillRect(s,c,r,d)},drawPreviewAboveGrid(e,n,o,t,l,a,i){if(!pointer_active&&!pointer_over_canvas)return;const{rect_x:s,rect_y:c,rect_w:r,rect_h:d}=this.get_rect(n,o);e.scale(l,l),e.translate(a,i);const h=1/l;e.strokeStyle="black",e.lineWidth=h,t?e.strokeRect(s+e.lineWidth/2,c+e.lineWidth/2,r,d):e.strokeRect(s+e.lineWidth/2,c+e.lineWidth/2,r-e.lineWidth,d-e.lineWidth)},pointerdown(){this.mask_canvas=make_canvas(main_canvas.width,main_canvas.height)},render_from_mask(e,n){e.save(),e.globalCompositeOperation="destination-out",e.drawImage(this.mask_canvas,0,0),e.restore();let o=selected_colors.background;get_rgba_from_color(o)[3]<1&&(o=n?"rgba(255, 0, 0, 0.3)":selected_colors.background);const l=make_canvas(this.mask_canvas);replace_colors_with_swatch(l.ctx,o,0,0),e.drawImage(l,0,0)},pointerup(){this.mask_canvas&&undoable({name:get_language().match(/^en\b/)?this.color_eraser_mode?"Color Eraser":"Eraser":localize("Eraser/Color Eraser"),icon:get_icon_for_tool(this)},()=>{this.render_from_mask(main_ctx),this.mask_canvas=null})},cancel(){this.mask_canvas=null},paint(e,n,o){bresenham_line(pointer_previous.x,pointer_previous.y,pointer.x,pointer.y,(t,l)=>{this.eraser_paint_iteration(e,t,l)})},eraser_paint_iteration(e,n,o){const{rect_x:t,rect_y:l,rect_w:a,rect_h:i}=this.get_rect(n,o);if(this.color_eraser_mode=button!==0,!this.color_eraser_mode)this.mask_canvas.ctx.fillStyle="white",this.mask_canvas.ctx.fillRect(t,l,a,i);else{const s=get_rgba_from_color(selected_colors.foreground),c=e.getImageData(t,l,a,i),r=this.mask_canvas.ctx.getImageData(t,l,a,i),d=1;for(let h=0,m=c.data.length;h<m;h+=4)Math.abs(c.data[h+0]-s[0])<=d&&Math.abs(c.data[h+1]-s[1])<=d&&Math.abs(c.data[h+2]-s[2])<=d&&Math.abs(c.data[h+3]-s[3])<=d&&(r.data[h+0]=255,r.data[h+1]=255,r.data[h+2]=255,r.data[h+3]=255);this.mask_canvas.ctx.putImageData(r,t,l)}},$options:$choose_eraser_size},{id:TOOL_FILL,name:localize("Fill With Color"),speech_recognition:[],help_icon:"p_paint.gif",description:"Fills an area with the selected drawing color.",cursor:["fill-bucket",[8,22],"crosshair"],pointerdown(e,n,o){shift?undoable({name:"Replace Color",icon:get_icon_for_tool(this)},()=>{draw_noncontiguous_fill(e,n,o,fill_color)}):undoable({name:localize("Fill With Color"),icon:get_icon_for_tool(this)},()=>{draw_fill(e,n,o,fill_color)})}},{id:TOOL_PICK_COLOR,name:localize("Pick Color"),speech_recognition:[],help_icon:"p_eye.gif",description:localize("Picks up a color from the picture for drawing."),cursor:["eye-dropper",[9,22],"crosshair"],deselect:!0,current_color:"",display_current_color(){this.$options.css({background:this.current_color})},pointerdown(){$G$1.one("pointerup",()=>{this.$options.css({background:""})})},paint(e,n,o){if(n>=0&&o>=0&&n<main_canvas.width&&o<main_canvas.height){const t=e.getImageData(~~n,~~o,1,1),[l,a,i,s]=t.data;this.current_color=`rgba(${l},${a},${i},${s/255})`}else this.current_color="white";this.display_current_color()},pointerup(){selected_colors[pick_color_slot]=this.current_color,$G$1.trigger("option-changed")},$options:$(E("div"))},{id:TOOL_MAGNIFIER,name:localize("Magnifier"),speech_recognition:[],help_icon:"p_zoom.gif",description:localize("Changes the magnification."),cursor:["magnifier",[16,16],"zoom-in"],deselect:!1,getProspectiveMagnification:(e=1)=>{const n={.125:.25,.25:.5,.5:1,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:8},o={8:7,7:6,6:5,5:4,4:3,3:2,2:1,1:.5,.5:.125,.125:.125};return e==2?o[magnification]:n[magnification]},drawPreviewAboveGrid(e,n,o,t,l,a,i){if(!pointer_active&&!pointer_over_canvas||pointer_active)return;const s=this.getProspectiveMagnification();if(s<magnification?$canvas.css({cursor:make_css_cursor("magnifier",[16,16],"zoom-out")}):$canvas.css({cursor:make_css_cursor("magnifier",[16,16],"zoom-in")}),s<magnification)return;const c=$canvas_area.width()/s,r=$canvas_area.height()/s;let d=~~(n-c/2),h=~~(o-r/2);d=Math.max(0,d),h=Math.max(0,h),d=Math.min(main_canvas.width-c,d),h=Math.min(main_canvas.height-r,h);let m=d+c,f=h+r;d=Math.max(0,d),h=Math.max(0,h),m=Math.min(main_canvas.width,m),f=Math.min(main_canvas.height,f);const g=m-d,x=f-h,b=d,A=h,M=main_canvas.ctx.getImageData(b,A,g+1,x+1),L=e.getImageData((b+a)*l,(A+i)*l,g*l+1,x*l+1);function C(u,_){const y=~~(u/l),v=~~(_/l),T=(y+v*M.width)*4,k=(u+_*L.width)*4;L.data[k+0]=255-M.data[T+0],L.data[k+1]=255-M.data[T+1],L.data[k+2]=255-M.data[T+2],L.data[k+3]=255}for(let u=0,_=L.width;u<_;u+=1)C(u,0),C(u,L.height-1);for(let u=1,_=L.height-1;u<_;u+=1)C(0,u),C(L.width-1,u);e.putImageData(L,(b+a)*l,(A+i)*l)},pointerdown(e,n,o){const t=magnification,l=this.getProspectiveMagnification(button);if(set_magnification(l),magnification>t){const a=$canvas_area.width()/magnification,i=$canvas_area.height()/magnification;$canvas_area.scrollLeft((n-a/2)*magnification),$canvas_area.scrollTop((o-i/2)*magnification),$canvas_area.trigger("scroll")}},$options:$choose_magnification},{id:TOOL_PENCIL,name:localize("Pencil"),speech_recognition:[],help_icon:"p_pencil.gif",description:localize("Draws a free-form line one pixel wide."),cursor:["pencil",[13,23],"crosshair"],stroke_only:!0,get_brush(){return{size:pencil_size,shape:"circle"}}},{id:TOOL_BRUSH,name:localize("Brush"),speech_recognition:[],help_icon:"p_brush.gif",description:localize("Draws using a brush with the selected shape and size."),cursor:["precise-dotted",[16,16],"crosshair"],dynamic_preview_cursor:!0,get_brush(){return{size:brush_size,shape:brush_shape}},$options:$choose_brush},{id:TOOL_AIRBRUSH,name:localize("Airbrush"),speech_recognition:[],help_icon:"p_airb.gif",description:localize("Draws using an airbrush of the selected size."),cursor:["airbrush",[7,22],"crosshair"],paint_on_time_interval:5,paint_mask(e,n,o){const t=airbrush_size/2;for(let l=0;l<6+t/5;l++){const a=(Math.random()*2-1)*t,i=(Math.random()*2-1)*t;a*a+i*i<=t*t&&e.fillRect(n+~~a,o+~~i,1,1)}update_helper_layer()},$options:$choose_airbrush_size},{id:TOOL_TEXT,name:localize("Text"),speech_recognition:["text","type","typography","write","writing","words","text box","text-box","textbox","word","lettering","font","fonts","texts"],help_icon:"p_txt.gif",description:localize("Inserts text into the picture."),cursor:["precise",[16,16],"crosshair"],preload(){setTimeout(FontDetective.preload,10)},selectBox(e,n,o,t){o>1&&t>1&&(textbox=new OnCanvasTextBox(e,n,o,t))},$options:$choose_transparent_mode},{id:TOOL_LINE,name:localize("Line"),speech_recognition:["line","line segment","straight line","lines","line segments","straight lines"],help_icon:"p_line.gif",description:localize("Draws a straight line with the selected line width."),cursor:["precise",[16,16],"crosshair"],stroke_only:!0,shape(e,n,o,t,l){update_brush_for_drawing_lines(stroke_size),draw_line(e,n,o,n+t,o+l,stroke_size)},$options:$choose_stroke_size},{id:TOOL_CURVE,name:localize("Curve"),speech_recognition:["curve","curved line","curvy","curvy line","Bezier","Bezier curve","spline","curves","splines","curved","curving","wave","wavy line","rounded line","round line","oscilloscope","sine wave","cosine","cosine wave"],help_icon:"p_curve.gif",description:localize("Draws a curved line with the selected line width."),cursor:["precise",[16,16],"crosshair"],stroke_only:!0,points:[],preview_canvas:null,pointerup(e,n,o){this.points.length>=4&&(undoable({name:localize("Curve"),icon:get_icon_for_tool(this)},()=>{e.drawImage(this.preview_canvas,0,0)}),this.points=[],$status_size.text(""))},pointerdown(e,n,o){this.points.length<1?(this.preview_canvas=make_canvas(main_canvas.width,main_canvas.height),this.points.push({x:n,y:o}),$("body").hasClass("eye-gaze-mode")||this.points.push({x:n,y:o})):this.points.push({x:n,y:o})},paint(e,n,o){if(this.points.length<1)return;update_brush_for_drawing_lines(stroke_size);const t=this.points.length-1;this.points[t].x=n,this.points[t].y=o,this.preview_canvas.ctx.clearRect(0,0,this.preview_canvas.width,this.preview_canvas.height),this.preview_canvas.ctx.strokeStyle=stroke_color,this.points.length===4?draw_bezier_curve(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[2].x,this.points[2].y,this.points[3].x,this.points[3].y,this.points[1].x,this.points[1].y,stroke_size):this.points.length===3?draw_quadratic_curve(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[2].x,this.points[2].y,this.points[1].x,this.points[1].y,stroke_size):this.points.length===2?draw_line(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[1].x,this.points[1].y,stroke_size):draw_line(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[0].x,this.points[0].y,stroke_size);const l=n-this.points[0].x||1,a=o-this.points[0].y||1;$status_size.text(`${l} x ${a}px`)},drawPreviewUnderGrid(e,n,o,t,l,a,i){this.preview_canvas&&(e.scale(l,l),e.translate(a,i),this.points.length>=1&&e.drawImage(this.preview_canvas,0,0))},cancel(){this.points=[],$status_size.text("")},end(){this.points=[],update_helper_layer(),$status_size.text("")},$options:$choose_stroke_size},{id:TOOL_RECTANGLE,name:localize("Rectangle"),speech_recognition:["rectangle","square","box","rect","sharp rectangle","sharp square","sharp box","sharp rect","sharp corners rectangle","sharp corners square","sharp corners box","sharp corners rect","sharp cornered rectangle","sharp cornered square","sharp cornered box","sharp cornered rect","rectangle with sharp corners","square with sharp corners","box with sharp corners","rect with sharp corners","rectangles","squares","boxes","rects","sharp rectangles","sharp squares","sharp boxes","sharp rects","sharp corners rectangles","sharp corners squares","sharp corners boxes","sharp corners rects","sharp cornered rectangles","sharp cornered squares","sharp cornered boxes","sharp cornered rects","rectangles with sharp corners","squares with sharp corners","boxes with sharp corners","rects with sharp corners"],help_icon:"p_rect.gif",description:localize("Draws a rectangle with the selected fill style."),cursor:["precise",[16,16],"crosshair"],shape(e,n,o,t,l){t<0&&(n+=t,t=-t),l<0&&(o+=l,l=-l),this.$options.fill&&e.fillRect(n,o,t,l),this.$options.stroke&&(t<stroke_size*2||l<stroke_size*2?(e.save(),e.fillStyle=e.strokeStyle,e.fillRect(n,o,t,l),e.restore()):(e.save(),e.fillStyle=e.strokeStyle,e.fillRect(n,o,stroke_size,l),e.fillRect(n+t-stroke_size,o,stroke_size,l),e.fillRect(n,o,t,stroke_size),e.fillRect(n,o+l-stroke_size,t,stroke_size),e.restore()))},$options:$ChooseShapeStyle()},{id:TOOL_POLYGON,name:localize("Polygon"),speech_recognition:["polygon","poly","shape","n-gon","free-form polygon","freeform polygon","free form polygon","triangle","quadrangle","pentagon","hexagon","heptagon","octagon","nonagon","decagon","undecagon","dodecagon","polygons","polys","shapes","n-gons","free-form polygons","freeform polygons","free form polygons","triangles","quadrangles","pentagons","hexagons","heptagons","octagons","nonagons","decagons","undecagons","dodecagons"],help_icon:"p_poly.gif",description:localize("Draws a polygon with the selected fill style."),cursor:["precise",[16,16],"crosshair"],last_click_pointerdown:{x:-1/0,y:-1/0,time:-1/0},last_click_pointerup:{x:-1/0,y:-1/0,time:-1/0},points:[],preview_canvas:null,pointerup(e,n,o){if(this.points.length<1)return;const t=this.points.length-1;this.points[t].x=n,this.points[t].y=o;const l=this.points[t].x-this.points[0].x,a=this.points[t].y-this.points[0].y,i=Math.sqrt(l*l+a*a);$("body").hasClass("eye-gaze-mode")?this.points.length>=3&&i<stroke_size*10+20&&this.complete(e):i<stroke_size*5.1010101&&this.complete(e),this.last_click_pointerup={x:n,y:o,time:+new Date},this.updateStatus()},pointerdown(e,n,o){if(this.points.length<1)this.preview_canvas=make_canvas(main_canvas.width,main_canvas.height),this.points.push({x:n,y:o}),$("body").hasClass("eye-gaze-mode")||this.points.push({x:n,y:o});else{const t=this.last_click_pointerdown.x,l=this.last_click_pointerdown.y,a=this.last_click_pointerdown.time,i=n-t,s=o-l,c=+new Date-a;Math.sqrt(i*i+s*s)<4.1010101&&c<250?this.complete(e):this.points.push({x:n,y:o})}this.last_click_pointerdown={x:n,y:o,time:+new Date}},paint(e,n,o){if(this.points.length<1)return;const t=this.points.length-1;if(this.points[t].x=n,this.points[t].y=o,this.preview_canvas.ctx.clearRect(0,0,this.preview_canvas.width,this.preview_canvas.height),this.$options.fill&&!this.$options.stroke){this.preview_canvas.ctx.drawImage(main_canvas,0,0),this.preview_canvas.ctx.strokeStyle="white",this.preview_canvas.ctx.globalCompositeOperation="difference";var l=stroke_size;stroke_size=2,draw_line_strip(this.preview_canvas.ctx,this.points),stroke_size=l}else this.points.length>1?(this.preview_canvas.ctx.strokeStyle=stroke_color,draw_line_strip(this.preview_canvas.ctx,this.points)):draw_line(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[0].x,this.points[0].y,stroke_size);this.updateStatus()},drawPreviewUnderGrid(e,n,o,t,l,a,i){this.preview_canvas&&(e.scale(l,l),e.translate(a,i),e.drawImage(this.preview_canvas,0,0))},complete(e){this.points.length>=3&&undoable({name:localize("Polygon"),icon:get_icon_for_tool(this)},()=>{e.fillStyle=fill_color,e.strokeStyle=stroke_color;var n=stroke_size;this.$options.fill&&!this.$options.stroke&&(stroke_size=2,e.strokeStyle=fill_color),draw_polygon(e,this.points,this.$options.stroke||this.$options.fill&&!this.$options.stroke,this.$options.fill),stroke_size=n}),this.reset()},cancel(){this.reset()},end(e){this.complete(e),update_helper_layer()},updateStatus(){let e=1/0,n=-1/0,o=1/0,t=-1/0;for(const i of this.points)e=Math.min(i.x,e),n=Math.max(i.x,n),o=Math.min(i.y,o),t=Math.max(i.y,t);const l=n-e||1,a=t-o||1;$status_size.text(`${l} x ${a}px`)},reset(){$status_size.text(""),this.points=[],this.last_click_pointerdown={x:-1/0,y:-1/0,time:-1/0},this.last_click_pointerup={x:-1/0,y:-1/0,time:-1/0},this.preview_canvas&&(this.preview_canvas.width=1,this.preview_canvas.height=1)},shape_colors:!0,$options:$ChooseShapeStyle()},{id:TOOL_ELLIPSE,name:localize("Ellipse"),speech_recognition:["ellipse","circle","oval","ovoid","ovaloid","oviform","elliptical","oblong circle","stretched circle","ball","sphere","round tool","rounded tool","ellipses","circles","ovals","ovoids","ovaloids","oviforms","ellipticals","oblong circles","stretched circles","balls","spheres"],help_icon:"p_oval.gif",description:localize("Draws an ellipse with the selected fill style."),cursor:["precise",[16,16],"crosshair"],shape(e,n,o,t,l){t<0&&(n+=t,t=-t),l<0&&(o+=l,l=-l),t<stroke_size||l<stroke_size?(e.fillStyle=e.strokeStyle,draw_ellipse(e,n,o,t,l,!1,!0)):draw_ellipse(e,n+~~(stroke_size/2),o+~~(stroke_size/2),t-stroke_size,l-stroke_size,this.$options.stroke,this.$options.fill)},$options:$ChooseShapeStyle()},{id:TOOL_ROUNDED_RECTANGLE,name:localize("Rounded Rectangle"),speech_recognition:["rounded rectangle","rounded square","rounded box","round rectangle","round square","round box","rounded corners rectangle","rounded corners square","rounded corners box","round cornered rectangle","round cornered square","round cornered box","rounded cornered rectangle","rounded cornered square","rounded cornered box","rounded corner rectangle","rounded corner square","rounded corner box","rectangle with round corners","square with round corners","box with round corners","rectangle with rounded corners","square with rounded corners","box with rounded corners","soft rectangle","soft square","soft box","soft corners rectangle","soft corners square","soft corners box","soft cornered rectangle","soft cornered square","soft cornered box","soft corner rectangle","soft corner square","soft corner box","rectangle with soft corners","square with soft corners","box with soft corners","round rect","roundrect","rounded rectangles","rounded squares","rounded boxes","round rectangles","round squares","round boxes","rounded corners rectangles","rounded corners squares","rounded corners boxes","round cornered rectangles","round cornered squares","round cornered boxes","rounded cornered rectangles","rounded cornered squares","rounded cornered boxes","rounded corner rectangles","rounded corner squares","rounded corner boxes","rectangles with round corners","squares with round corners","boxes with round corners","rectangles with rounded corners","squares with rounded corners","boxes with rounded corners","soft rectangles","soft squares","soft boxes","soft corners rectangles","soft corners squares","soft corners boxes","soft cornered rectangles","soft cornered squares","soft cornered boxes","soft corner rectangles","soft corner squares","soft corner boxes","rectangles with soft corners","squares with soft corners","boxes with soft corners","round rects","roundrects"],help_icon:"p_rrect.gif",description:localize("Draws a rounded rectangle with the selected fill style."),cursor:["precise",[16,16],"crosshair"],shape(e,n,o,t,l){if(t<0&&(n+=t,t=-t),l<0&&(o+=l,l=-l),t<stroke_size||l<stroke_size){e.fillStyle=e.strokeStyle;const a=Math.min(8,t/2,l/2);draw_rounded_rectangle(e,n,o,t,l,a,a,!1,!0)}else{const a=Math.min(8,(t-stroke_size)/2,(l-stroke_size)/2);draw_rounded_rectangle(e,n+~~(stroke_size/2),o+~~(stroke_size/2),t-stroke_size,l-stroke_size,a,a,this.$options.stroke,this.$options.fill)}},$options:$ChooseShapeStyle()}];tools.forEach(e=>{if(e.selectBox){let n=0,o=0,t=!1,l=0,a=0,i=0,s=0;e.pointerdown=()=>{n=pointer.x,o=pointer.y,t=!1,$G$1.one("pointermove",()=>{t=!0}),selection&&meld_selection_into_canvas(),textbox&&meld_textbox_into_canvas(),canvas_handles.hide()},e.paint=()=>{l=~~Math.max(0,Math.min(n,pointer.x)),a=~~Math.max(0,Math.min(o,pointer.y)),i=~~Math.min(main_canvas.width,Math.max(n,pointer.x)+1)-l,s=~~Math.min(main_canvas.height,Math.max(o,pointer.y+1))-a,$status_size.text(`${i} x ${s}px`)},e.pointerup=()=>{canvas_handles.show(),e.selectBox(l,a,i,s)},e.cancel=()=>{canvas_handles.show()},e.drawPreviewUnderGrid=(c,r,d,h,m,f,g)=>{pointer_active&&t&&(c.scale(m,m),c.translate(f,g),c.drawImage(main_canvas,0,0))},e.drawPreviewAboveGrid=(c,r,d,h,m,f,g)=>{pointer_active&&t&&draw_selection_box(c,l,a,i,s,m,f,g)}}e.shape&&(e.shape_canvas=null,e.pointerdown=()=>{e.shape_canvas=make_canvas(main_canvas.width,main_canvas.height)},e.paint=()=>{e.shape_canvas.ctx.clearRect(0,0,e.shape_canvas.width,e.shape_canvas.height),e.shape_canvas.ctx.fillStyle=main_ctx.fillStyle,e.shape_canvas.ctx.strokeStyle=main_ctx.strokeStyle,e.shape_canvas.ctx.lineWidth=main_ctx.lineWidth,e.shape(e.shape_canvas.ctx,pointer_start.x,pointer_start.y,pointer.x-pointer_start.x,pointer.y-pointer_start.y);const n=pointer.x-pointer_start.x||1,o=pointer.y-pointer_start.y||1;$status_size.text(`${n} x ${o}px`)},e.pointerup=()=>{e.shape_canvas&&undoable({name:e.name,icon:get_icon_for_tool(e)},()=>{main_ctx.drawImage(e.shape_canvas,0,0),e.shape_canvas=null})},e.drawPreviewUnderGrid=(n,o,t,l,a,i,s)=>{pointer_active&&e.shape_canvas&&(n.scale(a,a),n.translate(i,s),n.drawImage(e.shape_canvas,0,0))}),e.paint_mask&&(e.mask_canvas=null,e.pointerdown=(n,o,t)=>{e.mask_canvas||(e.mask_canvas=make_canvas(main_canvas.width,main_canvas.height)),e.mask_canvas.width!==main_canvas.width&&(e.mask_canvas.width=main_canvas.width),e.mask_canvas.height!==main_canvas.height&&(e.mask_canvas.height=main_canvas.height),e.mask_canvas.ctx.disable_image_smoothing()},e.pointerup=()=>{e.mask_canvas&&undoable({name:e.name,icon:get_icon_for_tool(e)},()=>{e.render_from_mask(main_ctx),e.mask_canvas.width=1,e.mask_canvas.height=1})},e.paint=(n,o,t)=>{e.paint_mask(e.mask_canvas.ctx,o,t)},e.cancel=()=>{e.mask_canvas&&(e.mask_canvas.width=1,e.mask_canvas.height=1)},e.render_from_mask=(n,o)=>{n.save(),n.globalCompositeOperation="destination-out",n.drawImage(e.mask_canvas,0,0),n.restore();let t=stroke_color;const l=make_canvas(e.mask_canvas);return replace_colors_with_swatch(l.ctx,t,0,0),n.drawImage(l,0,0),!0},e.drawPreviewUnderGrid=(n,o,t,l,a,i,s)=>{!pointer_active&&!pointer_over_canvas||(n.scale(a,a),n.translate(i,s),e.mask_canvas&&e.render_from_mask(n,!0)&&requestAnimationFrame(()=>{update_helper_layer()}))}),e.get_brush&&(e.mask_canvas=null,e.init_mask_canvas=(n,o,t)=>{e.mask_canvas||(e.mask_canvas=make_canvas(main_canvas.width,main_canvas.height)),e.mask_canvas.width!==main_canvas.width&&(e.mask_canvas.width=main_canvas.width),e.mask_canvas.height!==main_canvas.height&&(e.mask_canvas.height=main_canvas.height),e.mask_canvas.ctx.disable_image_smoothing()},e.pointerdown=(n,o,t)=>{e.init_mask_canvas()},e.pointerup=()=>{undoable({name:e.name,icon:get_icon_for_tool(e)},()=>{e.render_from_mask(main_ctx),e.mask_canvas.width=1,e.mask_canvas.height=1})},e.paint=()=>{const n=e.get_brush(),o=get_circumference_points_for_brush(n.shape,n.size);e.mask_canvas.ctx.fillStyle=stroke_color,(n.size>1?bresenham_dense_line:bresenham_line)(pointer_previous.x,pointer_previous.y,pointer.x,pointer.y,(l,a)=>{for(const i of o)e.mask_canvas.ctx.fillStyle="white",e.mask_canvas.ctx.fillRect(l+i.x,a+i.y,1,1)})},e.cancel=()=>{e.mask_canvas&&(e.mask_canvas.width=1,e.mask_canvas.height=1)},e.render_from_mask=(n,o)=>{let t=stroke_color;const l=make_canvas(e.mask_canvas);if(o&&e.dynamic_preview_cursor){const a=e.get_brush();stamp_brush_canvas(l.ctx,pointer.x,pointer.y,a.shape,a.size)}return replace_colors_with_swatch(l.ctx,t,0,0),n.drawImage(l,0,0),!0},e.drawPreviewUnderGrid=(n,o,t,l,a,i,s)=>{if(!pointer_active&&!pointer_over_canvas)return;n.scale(a,a),n.translate(i,s),e.init_mask_canvas(),e.render_from_mask(n,!0)&&requestAnimationFrame(()=>{update_helper_layer()})})});window.TOOL_PENCIL=TOOL_PENCIL;console.log("JS 실행:","OnCanvasSelection.js");class OnCanvasSelection extends OnCanvasObject{constructor(n,o,t,l,a){super(n,o,t,l,!0),this.$el.addClass("selection");let i=tool_transparent_mode,s=selected_colors.background;this._on_option_changed=()=>{this.source_canvas&&(i!==tool_transparent_mode||s!==selected_colors.background)&&(i=tool_transparent_mode,s=selected_colors.background,this.update_tool_transparent_mode())},$G$1.on("option-changed",this._on_option_changed),this.instantiate(a)}position(){super.position(!0),update_helper_layer()}instantiate(n){this.$el.css({cursor:make_css_cursor("move",[8,8],"move"),touchAction:"none"}),this.position(),(()=>{n?(this.source_canvas=make_canvas(n),this.source_canvas.width!==this.width&&(this.source_canvas.width=this.width),this.source_canvas.height!==this.height&&(this.source_canvas.height=this.height),this.canvas=make_canvas(this.source_canvas)):(this.source_canvas=make_canvas(this.width,this.height),this.source_canvas.ctx.drawImage(main_canvas,this.x,this.y,this.width,this.height,0,0,this.width,this.height),this.canvas=make_canvas(this.source_canvas),this.cut_out_background()),this.$el.append(this.canvas),this.handles=new Handles({$handles_container:this.$el,$object_container:$canvas_area,outset:2,get_rect:()=>({x:this.x,y:this.y,width:this.width,height:this.height}),set_rect:({x:i,y:s,width:c,height:r})=>{undoable({name:"Resize Selection",icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{this.x=i,this.y=s,this.width=c,this.height=r,this.position(),this.resize()})},get_ghost_offset_left:()=>parseFloat($canvas_area.css("padding-left"))+1,get_ghost_offset_top:()=>parseFloat($canvas_area.css("padding-top"))+1});let t,l;const a=i=>{make_or_update_undoable({match:s=>i.shiftKey&&/^(Smear|Stamp|Move) Selection$/.test(s.name)||!i.shiftKey&&/^Move Selection$/.test(s.name),name:i.shiftKey?"Smear Selection":"Move Selection",update_name:!0,icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{const s=to_canvas_coords(i);this.x=Math.max(Math.min(s.x-t,main_canvas.width),-this.width),this.y=Math.max(Math.min(s.y-l,main_canvas.height),-this.height),this.position(),i.shiftKey&&this.draw()})};this.canvas_pointerdown=i=>{i.preventDefault();const s=this.canvas.getBoundingClientRect(),c=i.clientX-s.left,r=i.clientY-s.top;t=~~(c/s.width*this.canvas.width),l=~~(r/s.height*this.canvas.height),$G$1.on("pointermove",a),this.dragging=!0,update_helper_layer(),$G$1.one("pointerup",()=>{$G$1.off("pointermove",a),this.dragging=!1,update_helper_layer()}),i.shiftKey?undoable({name:"Stamp Selection",icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{this.draw()}):i.ctrlKey&&undoable({name:"Stamp Selection",icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{this.draw()})},$(this.canvas).on("pointerdown",this.canvas_pointerdown),$canvas_area.trigger("resize"),$status_position.text(""),$status_size.text("")})()}cut_out_background(){const n=this.canvas,o=main_ctx.getImageData(this.x,this.y,this.width,this.height),t=n.ctx.getImageData(0,0,this.width,this.height),l=make_canvas(n);replace_colors_with_swatch(l.ctx,selected_colors.background,this.x,this.y);for(let a=0;a<t.data.length;a+=4)t.data[a+3]>0?(t.data[a+0]=o.data[a+0],t.data[a+1]=o.data[a+1],t.data[a+2]=o.data[a+2],t.data[a+3]=o.data[a+3],o.data[a+0]=0,o.data[a+1]=0,o.data[a+2]=0,o.data[a+3]=0):(t.data[a+0]=0,t.data[a+1]=0,t.data[a+2]=0,t.data[a+3]=0);main_ctx.putImageData(o,this.x,this.y),n.ctx.putImageData(t,0,0),this.update_tool_transparent_mode(),(!transparency||tool_transparent_mode)&&main_ctx.drawImage(l,this.x,this.y),$G$1.triggerHandler("session-update"),update_helper_layer()}update_tool_transparent_mode(){const n=this.source_canvas.ctx.getImageData(0,0,this.width,this.height),o=this.canvas.ctx.createImageData(this.width,this.height),t=get_rgba_from_color(selected_colors.background),l=1;for(let a=0;a<o.data.length;a+=4){let i=n.data[a+3]>1;tool_transparent_mode&&Math.abs(n.data[a+0]-t[0])<=l&&Math.abs(n.data[a+1]-t[1])<=l&&Math.abs(n.data[a+2]-t[2])<=l&&Math.abs(n.data[a+3]-t[3])<=l&&(i=!1),i&&(o.data[a+0]=n.data[a+0],o.data[a+1]=n.data[a+1],o.data[a+2]=n.data[a+2],o.data[a+3]=n.data[a+3])}this.canvas.ctx.putImageData(o,0,0),update_helper_layer()}replace_source_canvas(n){this.source_canvas=n;const o=make_canvas(n);$(this.canvas).replaceWith(o),this.canvas=o;const t=this.x+this.width/2,l=this.y+this.height/2,a=o.width,i=o.height;this.x=~~(t-a/2),this.y=~~(l-i/2),this.width=a,this.height=i,this.position(),$(this.canvas).on("pointerdown",this.canvas_pointerdown),this.$el.triggerHandler("resize"),this.update_tool_transparent_mode()}resize(){const n=make_canvas(this.width,this.height);n.ctx.drawImage(this.source_canvas,0,0,this.width,this.height),this.replace_source_canvas(n)}scale(n){const o=Math.max(1,this.width*n),t=Math.max(1,this.height*n),l=make_canvas(o,t);l.ctx.drawImage(this.source_canvas,0,0,l.width,l.height),this.replace_source_canvas(l)}draw(){try{main_ctx.drawImage(this.canvas,this.x,this.y)}catch{}}destroy(){super.destroy(),$G$1.off("option-changed",this._on_option_changed),update_helper_layer()}}console.log("JS 실행:","color-data.js");const default_palette=["rgb(0,0,0)","rgb(128,128,128)","rgb(128,0,0)","rgb(128,128,0)","rgb(0,128,0)","rgb(0,128,128)","rgb(0,0,128)","rgb(128,0,128)","rgb(128,128,64)","rgb(0,64,64)","rgb(0,128,255)","rgb(0,64,128)","rgb(64,0,255)","rgb(128,64,0)","rgb(128,64,0,0.1)","rgb(128,64,0,0.2)","rgb(255,255,255)","rgb(192,192,192)","rgb(255,0,0)","rgb(255,255,0)","rgb(0,255,0)","rgb(0,255,255)","rgb(0,0,255)","rgb(255,0,255)","rgb(255,255,128)","rgb(0,255,128)","rgb(128,255,255)","rgb(128,128,255)","rgb(255,0,128)","rgb(255,128,64)","rgb(128,64,0,0.3)","rgb(128,64,0,0)"],basic_colors=["#FF8080","#FFFF80","#80FF80","#00FF80","#80FFFF","#0080FF","#FF80C0","#FF80FF","#FF0000","#FFFF00","#80FF00","#00FF40","#00FFFF","#0080C0","#8080C0","#FF00FF","#804040","#FF8040","#00FF00","#008080","#004080","#8080FF","#800040","#FF0080","#800000","#FF8000","#008000","#008040","#0000FF","#0000A0","#800080","#8000FF","#400000","#804000","#004000","#004040","#000080","#000040","#400040","#400080","#000000","#808000","#808040","#808080","#408080","#C0C0C0","#400040","#FFFFFF"],custom_colors=["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"],lerp=(e,n,o)=>e+(n-e)*o,color_ramp=(e,n,o)=>Array(e).fill().map((t,l,a)=>{const i=lerp(n[0],o[0],l/a.length),s=lerp(n[1],o[1],l/a.length),c=lerp(n[2],o[2],l/a.length),r=lerp(n[3],o[3],l/a.length);return`hsla(${i}deg, ${s}%, ${c}%, ${r})`}),get_winter_palette=()=>{const e=n=>[make_stripe_pattern(n,["hsl(166, 93%, 38%)","white"]),make_stripe_pattern(n,["white","hsl(355, 78%, 46%)"]),make_stripe_pattern(n,["hsl(355, 78%, 46%)","white","white","hsl(355, 78%, 46%)","hsl(355, 78%, 46%)","hsl(355, 78%, 46%)","white","white","hsl(355, 78%, 46%)","white"],2),make_stripe_pattern(n,["hsl(166, 93%, 38%)","white","white","hsl(166, 93%, 38%)","hsl(166, 93%, 38%)","hsl(166, 93%, 38%)","white","white","hsl(166, 93%, 38%)","white"],2),make_stripe_pattern(n,["hsl(166, 93%, 38%)","white","hsl(355, 78%, 46%)","white"],2)];return["black","hsl(91, 55%, 81%)","hsl(142, 57%, 64%)","hsl(166, 93%, 38%)","#04ce1f","hsl(159, 93%, 16%)","hsl(2, 77%, 27%)","hsl(350, 100%, 50%)","hsl(356, 97%, 64%)","#ad4632","#5b3b1d",...e(!1),...color_ramp(6,[200,100,100,100],[200,100,10,100]),"#fcbaf8","hsl(0, 0%, 90%)","hsl(22, 5%, 71%)","hsl(48, 82%, 54%)","hsl(49, 82%, 72%)",...e(!0)]};window.default_palette=default_palette;console.log("JS 실행:","file-format-data.js");let image_formats=[];const add_image_format=(e,n,o=image_formats)=>{const t={formatID:e,mimeType:e,name:localize(n).replace(/\s+\([^(]+$/,""),nameWithExtensions:localize(n),extensions:[]},l=/\*\.([^);,]+)/g;if(get_direction()==="rtl"){const i="‏",s="‎";t.nameWithExtensions=t.nameWithExtensions.replace(l,`${i}*.${s}$1${i}`)}let a;for(;a=l.exec(n);){const i=a[1];t.extensions.push(i)}o.push(t)};add_image_format("image/png","PNG (*.png)");add_image_format("image/webp","WebP (*.webp)");add_image_format("image/gif","GIF (*.gif)");add_image_format("image/tiff","TIFF (*.tif;*.tiff)");add_image_format("image/jpeg","JPEG (*.jpg;*.jpeg;*.jpe;*.jfif)");add_image_format("image/x-bmp-1bpp","Monochrome Bitmap (*.bmp;*.dib)");add_image_format("image/x-bmp-4bpp","16 Color Bitmap (*.bmp;*.dib)");add_image_format("image/x-bmp-8bpp","256 Color Bitmap (*.bmp;*.dib)");add_image_format("image/bmp","24-bit Bitmap (*.bmp;*.dib)");const formats_unique_per_file_extension=e=>(e=e.filter(n=>n.extensions.includes("bmp")?n.mimeType==="image/bmp":!0),e.filter((n,o)=>!n.extensions.some(t=>e.some((l,a)=>a<o&&l.extensions.includes(t))))),palette_formats=[];for(const[e,n]of Object.entries(AnyPalette$1.formats))if(n.write){const o=n.fileExtensions.map(t=>`*.${t}`).join(";");palette_formats.push({formatID:e,name:n.name,nameWithExtensions:`${n.name} (${o})`,extensions:n.fileExtensions})}palette_formats.sort((e,n)=>+(n.formatID==="RIFF_PALETTE")-+(e.formatID==="RIFF_PALETTE")||+(n.formatID==="GIMP_PALETTE")-+(e.formatID==="GIMP_PALETTE")||0);window.formats_unique_per_file_extension=formats_unique_per_file_extension;console.log("JS 실행:","imgur.js");let $imgur_window;function show_imgur_uploader(e){$imgur_window&&$imgur_window.close(),$imgur_window=$DialogWindow(),$imgur_window.title("Upload To Imgur").addClass("horizontal-buttons");const n=$(E("div")).appendTo($imgur_window.$main).addClass("inset-deep"),o=$(E("div")).appendTo($imgur_window.$main),t=$(E("div")).appendTo($imgur_window.$main),l=$(E("img")).appendTo(n).css({display:"block"}),a=URL.createObjectURL(e);l.attr({src:a}),n.css({maxWidth:"90vw",maxHeight:"70vh",overflow:"auto",marginBottom:"0.5em"}),l.on("load",()=>{$imgur_window.css({width:"auto"}),$imgur_window.center()}),$imgur_window.on("close",()=>{URL.revokeObjectURL(a)});const i=$imgur_window.$Button("Upload",()=>{URL.revokeObjectURL(a),n.remove(),i.remove(),s.remove(),$imgur_window.$content.width(300),$imgur_window.center();const c=$(E("progress")).appendTo($imgur_window.$main).addClass("inset-deep"),r=$(E("span")).appendTo($imgur_window.$main).css({width:"2.3em",display:"inline-block",textAlign:"center"}),d=f=>{try{return JSON.parse(f)}catch(g){t.text("Received an invalid JSON response from Imgur: "),$(E("pre")).appendTo(t).text(f).css({background:"white",color:"#333",fontFamily:"monospace",width:"500px",overflow:"auto"}),$(E("pre")).appendTo(t).text(g.toString()).css({background:"white",color:"#333",fontFamily:"monospace",width:"500px",overflow:"auto"}),$imgur_window.css({width:"auto"}),$imgur_window.center()}},h=new XMLHttpRequest;h.upload&&h.upload.addEventListener("progress",f=>{if(f.lengthComputable){const g=f.loaded/f.total,x=`${Math.floor(g*100)}%`;c.val(g),r.text(x)}},!1),h.addEventListener("readystatechange",()=>{if(h.readyState==4&&h.status==200){c.add(r).remove();const f=d(h.responseText);if(!f)return;if(!f.success){$imgur_window.close(),show_error_message$1("Failed to upload image.",h.responseText);return}const g=f.data.link;t.text("");const x=$(E("a")).attr({id:"imgur-url",target:"_blank"});x.text(g),x.attr("href",g),o.append("<label>URL: </label>").append(x);let b;const A=$imgur_window.$Button("Delete",()=>{const M=new XMLHttpRequest;A[0].disabled=!0,M.addEventListener("readystatechange",()=>{if(M.readyState==4&&M.status==200){A.remove(),b.focus();const L=d(M.responseText);if(!L)return;L.success?(o.remove(),t.text("Deleted successfully")):t.text("Failed to delete image :(")}else M.readyState==4&&(t.text("Error deleting image :("),A[0].disabled=!1,A.focus())}),M.open("DELETE",`https://api.imgur.com/3/image/${f.data.deletehash}`,!0),M.setRequestHeader("Authorization","Client-ID 203da2f300125a1"),M.setRequestHeader("Accept","application/json"),M.send(null),t.text("Deleting...")});b=$imgur_window.$Button(localize("OK"),()=>{$imgur_window.close()}).focus()}else if(h.readyState==4){$imgur_window.close();let f;try{f=JSON.parse(h.responseText)}catch{}f&&f.data&&f.data.error?show_error_message$1(`Failed to upload image.

${f.data.error}`,h.responseText):show_error_message$1(`Failed to upload image. HTTP ${h.status}`,h.responseText)}}),h.open("POST","https://api.imgur.com/3/image",!0);const m=new FormData;m.append("image",e),h.setRequestHeader("Authorization","Client-ID 203da2f300125a1"),h.setRequestHeader("Accept","application/json"),h.send(m),t.text("Uploading...")},{type:"submit"}).focus(),s=$imgur_window.$Button(localize("Cancel"),()=>{$imgur_window.close()});$imgur_window.$content.css({width:"min(1000px, 80vw)"}),$imgur_window.center()}console.log("JS 실행:","storage.js");const localStore={get(e,n){let o;try{if(typeof e=="string"){const t=e,l=localStorage.getItem(t);l&&(o=JSON.parse(l))}else if(o={},Array.isArray(e)){const t=e;for(let l=0,a=t.length;l<a;l++){const i=t[l],s=localStorage.getItem(i);s&&(o[i]=JSON.parse(s))}}else{const t=e;for(const l in t){let a=t[l];const i=localStorage.getItem(l);i?o[l]=JSON.parse(i):o[l]=a}}}catch(t){n(t);return}n(null,o)},set(e,n,o){let t={};if(typeof e=="string")t={[e]:n};else{if(Array.isArray(e))throw new TypeError("Cannot set an array of keys (to what?)");t=e,o=n}for(const l in t){const a=t[l];try{localStorage.setItem(l,JSON.stringify(a))}catch(i){i.quotaExceeded=i.code===22||i.name==="NS_ERROR_DOM_QUOTA_REACHED"||i.number===-2147024882,o(i);return}}return o(null)}};console.log("JS 실행:","functions.js");const param_types={"eye-gaze-mode":"bool","vertical-color-box-mode":"bool","speech-recognition-mode":"bool",local:"string",session:"string",load:"string"},exclusive_params=["local","session","load"];function get_all_url_params(){const e={};location.hash.replace(/^#/,"").split(/,/).forEach(n=>{const o=n.indexOf(":");if(o===-1){const t=n;e[t]=!0}else{const t=n.slice(0,o),l=n.slice(o+1);e[t]=decodeURIComponent(l)}});for(const[n,o]of Object.entries(param_types))o==="bool"&&!e[n]&&(e[n]=!1);return e}function change_url_param(e,n,{replace_history_state:o=!1}={}){change_some_url_params({[e]:n},{replace_history_state:o})}function change_some_url_params(e,{replace_history_state:n=!1}={}){for(const o of exclusive_params)e[o]&&exclusive_params.forEach(t=>{t!==o&&(e[t]=null)});set_all_url_params(Object.assign({},get_all_url_params(),e),{replace_history_state:n})}function set_all_url_params(e,{replace_history_state:n=!1}={}){let o="";for(const[a,i]of Object.entries(param_types))e[a]&&(o.length&&(o+=","),o+=encodeURIComponent(a),i!=="bool"&&(o+=":"+encodeURIComponent(e[a])));let t=location.search;t.includes("frame_id")||(t="");const l=`${location.origin}${location.pathname}${t}#${o}`;try{n?history.replaceState(null,document.title,l):history.pushState(null,document.title,l)}catch{location.hash=o}$G$1.triggerHandler("change-url-params")}function update_magnified_canvas_size(){$canvas.css("width",main_canvas.width*magnification),$canvas.css("height",main_canvas.height*magnification),update_canvas_rect()}function update_canvas_rect(){window.canvas_bounding_client_rect=main_canvas.getBoundingClientRect(),update_helper_layer()}let helper_layer_update_queued=!1,info_for_updating_pointer;function update_helper_layer(e){e&&isFinite(e.clientX)&&(info_for_updating_pointer={clientX:e.clientX,clientY:e.clientY,devicePixelRatio}),!helper_layer_update_queued&&(helper_layer_update_queued=!0,requestAnimationFrame(()=>{helper_layer_update_queued=!1,update_helper_layer_immediately()}))}function update_helper_layer_immediately(){if(info_for_updating_pointer){const d=info_for_updating_pointer.devicePixelRatio/devicePixelRatio;info_for_updating_pointer.clientX*=d,info_for_updating_pointer.clientY*=d,info_for_updating_pointer.devicePixelRatio=devicePixelRatio,pointer=to_canvas_coords(info_for_updating_pointer)}const e=magnification*window.devicePixelRatio;helper_layer||(helper_layer=new OnCanvasHelperLayer(0,0,main_canvas.width,main_canvas.height,!1,e));const n=15,o=Math.floor(Math.max($canvas_area.scrollLeft()/magnification-n,0)),t=Math.floor(Math.max($canvas_area.scrollTop()/magnification-n,0)),l=Math.floor(Math.min(o+$canvas_area.width()/magnification+n*2,main_canvas.width)),a=Math.floor(Math.min(t+$canvas_area.height()/magnification+n*2,main_canvas.height)),i=l-o,s=a-t,c=i*e,r=s*e;if((helper_layer.canvas.width!==c||helper_layer.canvas.height!==r)&&(helper_layer.canvas.width=c,helper_layer.canvas.height=r,helper_layer.canvas.ctx.disable_image_smoothing(),helper_layer.width=i,helper_layer.height=s),helper_layer.x=o,helper_layer.y=t,helper_layer.position(),render_canvas_view(helper_layer.canvas,e,o,t,!0),thumbnail_canvas&&$thumbnail_window.is(":visible")){const d=parseFloat($canvas_area.css("padding-left")),h=parseFloat($canvas_area.css("padding-top")),m=main_canvas.clientWidth+d-$canvas_area[0].clientWidth,f=main_canvas.clientHeight+h-$canvas_area[0].clientHeight;let g=$canvas_area[0].scrollLeft/Math.max(1,m),x=$canvas_area[0].scrollTop/Math.max(1,f);g=Math.min(g,1),x=Math.min(x,1);let b=Math.floor(Math.max(g*(main_canvas.width-thumbnail_canvas.width),0)),A=Math.floor(Math.max(x*(main_canvas.height-thumbnail_canvas.height),0));render_canvas_view(thumbnail_canvas,1,b,A,!1)}}function render_canvas_view(e,n,o,t,l){update_fill_and_stroke_colors_and_lineWidth(selected_tool);const a=show_grid&&magnification>=4&&window.devicePixelRatio*magnification>=4&&l,i=e.ctx;i.clearRect(0,0,e.width,e.height),l||i.drawImage(main_canvas,o,t,e.width,e.height,0,0,e.width,e.height);var s=[...selected_tools];$("body").hasClass("dragging")&&!pointer_active&&(s=s.filter(r=>r.id===TOOL_CURVE||r.id===TOOL_POLYGON)),s.sort((r,d)=>r.selectBox&&!d.selectBox?-1:!r.selectBox&&d.selectBox?1:0);var c=s.findIndex(r=>r.selectBox);c>=0&&(s=s.filter((r,d)=>!r.selectBox||d==c)),s.forEach(r=>{r.drawPreviewUnderGrid&&pointer&&pointers.length<2&&(i.save(),r.drawPreviewUnderGrid(i,pointer.x,pointer.y,a,n,-o,-t),i.restore())}),selection&&(i.save(),i.scale(n,n),i.translate(-o,-t),i.drawImage(selection.canvas,selection.x,selection.y),i.restore(),!l&&!selection.dragging&&draw_selection_box(i,selection.x,selection.y,selection.width,selection.height,n,-o,-t)),textbox&&(i.save(),i.scale(n,n),i.translate(-o,-t),i.drawImage(textbox.canvas,textbox.x,textbox.y),i.restore(),!l&&!textbox.dragging&&draw_selection_box(i,textbox.x,textbox.y,textbox.width,textbox.height,n,-o,-t)),a&&draw_grid(i,n),s.forEach(r=>{r.drawPreviewAboveGrid&&pointer&&pointers.length<2&&(i.save(),r.drawPreviewAboveGrid(i,pointer.x,pointer.y,a,n,-o,-t),i.restore())})}function update_disable_aa(){const e=window.devicePixelRatio*magnification,n=Math.floor(e)===e;$canvas_area.toggleClass("disable-aa-for-things-at-main-canvas-scale",e>=3||n)}function set_magnification(e,n){window.$zoomText.text(e==.125?"12.50%":`${e*100}%`),n=n??{x:$canvas_area.scrollLeft()/magnification,y:$canvas_area.scrollTop()/magnification};const o=from_canvas_coords(n);magnification=e,e!==1&&(return_to_magnification=e),update_magnified_canvas_size();const t=from_canvas_coords(n);$canvas_area[0].scrollBy({left:t.clientX-o.clientX,top:t.clientY-o.clientY,behavior:"instant"}),$G$1.triggerHandler("resize"),$G$1.trigger("option-changed"),$G$1.trigger("magnification-changed")}function toggle_grid(){show_grid=!show_grid,update_helper_layer()}function toggle_thumbnail(){show_thumbnail=!show_thumbnail,show_thumbnail?(thumbnail_canvas||(thumbnail_canvas=make_canvas(108,92),thumbnail_canvas.style.width="100%",thumbnail_canvas.style.height="100%"),$thumbnail_window||($thumbnail_window=$Window({title:localize("Thumbnail"),toolWindow:!0,resizable:!0,innerWidth:thumbnail_canvas.width+4,innerHeight:thumbnail_canvas.height+4,minInnerWidth:56,minInnerHeight:40,minOuterWidth:0,minOuterHeight:0}),$thumbnail_window.addClass("thumbnail-window"),$thumbnail_window.$content.append(thumbnail_canvas),$thumbnail_window.$content.addClass("inset-deep"),$thumbnail_window.$content.css({marginTop:"1px"}),$thumbnail_window.maximize=()=>{},new ResizeObserver(e=>{const n=e[0];let o,t;"devicePixelContentBoxSize"in n?(o=n.devicePixelContentBoxSize[0].inlineSize,t=n.devicePixelContentBoxSize[0].blockSize):"contentBoxSize"in n?(o=Math.round(n.contentBoxSize[0].inlineSize*devicePixelRatio),t=Math.round(n.contentBoxSize[0].blockSize*devicePixelRatio)):(o=Math.round(n.contentRect.width*devicePixelRatio),t=Math.round(n.contentRect.height*devicePixelRatio)),o&&t&&(thumbnail_canvas.width=o,thumbnail_canvas.height=t),update_helper_layer_immediately()}).observe(thumbnail_canvas,{box:"device-pixel-content-box"})),$thumbnail_window.show(),$thumbnail_window.on("close",e=>{e.preventDefault(),$thumbnail_window.hide(),show_thumbnail=!1})):$thumbnail_window.hide(),update_helper_layer()}function reset_selected_colors(){selected_colors={foreground:"#000000",background:"#ffffff",ternary:""},$G$1.trigger("option-changed")}function reset_file(){system_file_handle=null,file_name=localize("untitled"),file_format="image/png",saved=!0,update_title()}function reset_canvas_and_history(){undos.length=0,redos.length=0,current_history_node=root_history_node=make_history_node({name:localize("New"),icon:get_help_folder_icon("p_blank.png")}),history_node_to_cancel_to=null,main_canvas.width=Math.max(1,my_canvas_width),main_canvas.height=Math.max(1,my_canvas_height),main_ctx.disable_image_smoothing(),main_ctx.fillStyle=selected_colors.background,main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height),current_history_node.image_data=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height),$canvas_area.trigger("resize"),$G$1.triggerHandler("history-update")}function make_history_node({parent:e=null,futures:n=[],timestamp:o=Date.now(),soft:t=!1,image_data:l=null,selection_image_data:a=null,selection_x:i,selection_y:s,textbox_text:c,textbox_x:r,textbox_y:d,textbox_width:h,textbox_height:m,text_tool_font:f=null,tool_transparent_mode:g=!1,foreground_color:x,background_color:b,ternary_color:A,name:M,icon:L=null}){return{parent:e,futures:n,timestamp:o,soft:t,image_data:l,selection_image_data:a,selection_x:i,selection_y:s,textbox_text:c,textbox_x:r,textbox_y:d,textbox_width:h,textbox_height:m,text_tool_font:f,tool_transparent_mode:g,foreground_color:x,background_color:b,ternary_color:A,name:M,icon:L}}function update_title(){document.title=`${file_name} - ${is_pride_month?"June Solidarity ":""}${localize("Paint")}`,is_pride_month&&$("link[rel~='icon']").attr("href","./images/icons/gay-es-paint-16x16-light-outline.png"),window.setRepresentedFilename&&window.setRepresentedFilename(system_file_handle??""),window.setDocumentEdited&&window.setDocumentEdited(!saved)}function get_uris(e){const n=e.split(/[\n\r]+/).filter(t=>t[0]!=="#"&&t);if(n.length>15)return[];const o=[];for(let t=0;t<n.length;t++)try{const l=new URL(n[t]);o.push(l.href)}catch{}return o}async function load_image_from_uri(e){const n=e.match(/^blob:/i),o=!e.match(/^(blob|data|file):/i),t=e.match(/^(http|https):\/\/((127\.0\.0\.1|localhost)|.*(\.(local|localdomain|domain|lan|home|host|corp|invalid)))\b/i);if(n&&e.indexOf(`blob:${location.origin}`)===-1){const s=new Error("can't load blob: URI from another domain");throw s.code="cross-origin-blob-uri",s}const l=o&&!t?[e,`https://cors.bridged.cc/${e}`,`https://jspaint-cors-proxy.herokuapp.com/${e}`,`https://web.archive.org/${e}`]:[e],a=[];for(let s=0;s<l.length;s+=1){const c=l[s];try{const r=({loaded:g,total:x})=>{};o&&console.log(`Try loading image from URI (${s+1}/${l.length}): "${c}"`);const d=await fetch(c);let h=d;if(!d.ok){a.push({status:d.status,statusText:d.statusText,url:c});continue}if(!d.body)o&&console.log("ReadableStream not yet supported in this browser. Progress won't be shown for image requests.");else{const g=d.headers.get("content-encoding"),x=d.headers.get(g?"x-file-size":"content-length");if(x===null)o&&console.log("Response size header unavailable. Progress won't be shown for this image request.");else{const b=parseInt(x,10);let A=0;h=new Response(new ReadableStream({start(M){const L=d.body.getReader();C();function C(){L.read().then(({done:u,value:_})=>{if(u){M.close();return}A+=_.byteLength,r({loaded:A,total:b}),M.enqueue(_),C()}).catch(u=>{console.error(u),M.error(u)})}}}))}}const m=await h.blob();return o&&console.log("Download complete."),await new Promise((g,x)=>{read_image_file(m,(b,A)=>{b?x(b):g(A)})})}catch(r){a.push({url:c,error:r})}}const i=new Error(`failed to fetch image from any of ${l.length} URI(s):
  ${a.map(s=>(s.statusText?`${s.status} ${s.statusText} `:"")+s.url+(s.error?`
    ${s.error}`:"")).join(`
  `)}`);throw i.code="access-failure",i.fails=a,i}function open_from_image_info(e,n,o,t,l){are_you_sure$1(({canvas_modified_while_loading:a}={})=>{deselect(),cancel(),t||($G$1.triggerHandler("session-update"),new_local_session()),reset_file(),reset_selected_colors(),reset_canvas_and_history(),set_magnification(default_magnification),main_ctx.copy(e.image||e.image_data),apply_file_format_and_palette_info(e),transparency=has_any_transparency(main_ctx),$canvas_area.trigger("resize"),current_history_node.name=localize("Open"),current_history_node.image_data=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height),current_history_node.icon=get_help_folder_icon("p_open.png"),(a||!l)&&$G$1.triggerHandler("session-update"),$G$1.triggerHandler("history-update"),e.source_blob instanceof File&&(file_name=e.source_blob.name,system_file_handle=e.source_blob.path),e.source_file_handle&&(system_file_handle=e.source_file_handle),saved=!0,update_title(),n==null||n()},o,l)}function open_from_file(e,n){if(e instanceof File&&e.name.match(/\.theme(pack)?$/i)){e.text().then(load_theme_from_text,o=>{show_error_message$1(localize("Paint cannot open this file."),o)});return}read_image_file(e,(o,t)=>{if(o){AnyPalette.loadPalette(e,(l,a)=>{var i;if(l){show_file_format_errors({as_image_error:o,as_palette_error:l});return}palette=a.map(s=>s.toString()),$colorbox.rebuild_palette(),(i=window.console)==null||i.log(`Loaded palette: ${palette.map(()=>"%c█").join("")}`,...palette.map(s=>`color: ${s};`))});return}t.source_file_handle=n,open_from_image_info(t)})}function apply_file_format_and_palette_info(e){var n;file_format=e.file_format,enable_palette_loading_from_indexed_images&&(e.palette?((n=window.console)==null||n.log(`Loaded palette from image file: ${e.palette.map(()=>"%c█").join("")}`,...e.palette.map(o=>`color: ${o};`)),palette=e.palette,selected_colors.foreground=palette[0],selected_colors.background=palette.length===14*2?palette[14]:palette[1],$G$1.trigger("option-changed")):monochrome&&!e.monochrome&&(palette=default_palette,reset_selected_colors()),$colorbox.rebuild_palette(),monochrome=e.monochrome)}function load_theme_from_text(e){var n=parseThemeFileString(e);if(!n){show_error_message$1(localize("Paint cannot open this file."));return}applyCSSProperties(n,{recurseIntoIframes:!0}),window.themeCSSProperties=n,$G$1.triggerHandler("theme-load")}function file_new(){are_you_sure$1(()=>{deselect(),cancel(),$G$1.triggerHandler("session-update"),new_local_session(),reset_file(),reset_selected_colors(),reset_canvas_and_history(),set_magnification(default_magnification),$G$1.triggerHandler("session-update")})}async function file_open(){const{file:e,fileHandle:n}=await systemHooks.showOpenFileDialog({formats:image_formats});open_from_file(e,n)}let $file_load_from_url_window;function file_load_from_url(){$file_load_from_url_window&&$file_load_from_url_window.close();const e=$DialogWindow().addClass("horizontal-buttons");$file_load_from_url_window=e,e.title("Load from URL"),e.$main.html(`
		<div style="padding: 10px;">
			<label style="display: block; margin-bottom: 5px;" for="url-input">Paste or type the web address of an image:</label>
			<input type="url" required value="" id="url-input" class="inset-deep" style="width: 300px;"/></label>
		</div>
	`);const n=e.$main.find("#url-input");e.$Button(localize("Open"),()=>{const o=get_uris(String(n.val()));o.length>0?(e.close(),change_url_param("load",o[0])):show_error_message$1("Invalid URL. It must include a protocol (https:// or http://)")},{type:"submit"}),e.$Button(localize("Cancel"),()=>{e.close()}),e.center(),n[0].focus()}let acknowledged_overwrite_capability=!1;const confirmed_overwrite_key="jspaint confirmed overwrite capable";try{acknowledged_overwrite_capability=localStorage[confirmed_overwrite_key]==="true"}catch(e){acknowledged_overwrite_capability=Date.now()>=2e12}async function confirm_overwrite_capability(){if(acknowledged_overwrite_capability)return!0;const{$window:e,promise:n}=showMessageBox$1({messageHTML:`
			<p>JS Paint can now save over existing files.</p>
			<p>Do you want to overwrite the file?</p>
			<p>
				<input type="checkbox" id="do-not-ask-me-again-checkbox"/>
				<label for="do-not-ask-me-again-checkbox">Don't ask me again</label>
			</p>
		`,buttons:[{label:localize("Yes"),value:"overwrite",default:!0},{label:localize("Cancel"),value:"cancel"}]});if(await n==="overwrite"){acknowledged_overwrite_capability=e.$content.find("#do-not-ask-me-again-checkbox").prop("checked");try{localStorage[confirmed_overwrite_key]=acknowledged_overwrite_capability}catch{}return!0}return!1}function file_save(e=()=>{},n=!0){deselect();const o=system_file_handle;if(!o||file_name.match(/\.(svg|pdf)$/i))return file_save_as(e,n);write_image_file(main_canvas,file_format,async t=>{const l=await systemHooks.writeBlobToHandle(o,t);l===!0&&(saved=!0,update_title()),l!==!1&&(n&&update_from_saved_file(t),e())})}function file_save_as(e=()=>{},n=!0){deselect(),systemHooks.showSaveFileDialog({dialogTitle:localize("Save As"),formats:image_formats,defaultFileName:file_name,defaultPath:typeof system_file_handle=="string"?system_file_handle:null,defaultFileFormatID:file_format,getBlob:o=>new Promise(t=>{write_image_file(main_canvas,o,l=>{t(l)})}),savedCallbackUnreliable:({newFileName:o,newFileFormatID:t,newFileHandle:l,newBlob:a})=>{saved=!0,system_file_handle=l,file_name=o,file_format=t,update_title(),e(),n&&update_from_saved_file(a)}})}function file_print(){print()}function are_you_sure$1(e,n,o){saved?e():o?showMessageBox$1({message:localize(`You've modified the document while an existing document was loading.
Save the new document?`,file_name),buttons:[{label:localize("Yes"),value:"save",default:!0},{label:localize("No"),value:"discard"}]}).then(t=>{t==="save"?file_save(()=>{e()},!1):t==="discard"?e({canvas_modified_while_loading:!0}):e()}):showMessageBox$1({message:localize("Save changes to %1?",file_name),buttons:[{label:localize("Yes"),value:"save",default:!0},{label:localize("No"),value:"discard"},{label:localize("Cancel"),value:"cancel"}]}).then(t=>{t==="save"?file_save(()=>{e()},!1):t==="discard"?e():n==null||n()})}function please_enter_a_number(){showMessageBox$1({message:localize("Please enter a number.")})}function show_error_message$1(e,n){var t,l,a,i;const{$message:o}=showMessageBox$1({iconID:"error",message:e});if(n){const s=$("<details><summary><span>Details</span></summary></details>").appendTo(o),c=n;let r=c.stack;if(r)c.message&&r.indexOf(c.message)===-1?r=`${n.toString()}

${r}`:c.name&&r.indexOf(c.name)===-1&&(r=`${c.name}

${r}`);else if(r=n.toString(),r==="[object Object]")try{r=JSON.stringify(n,null,2)}catch(d){r="Error details could not be stringified: "+d}$(E("pre")).text(r).appendTo(s).css({background:"white",color:"#333",fontFamily:"monospace",width:"500px",maxWidth:"100%",overflow:"auto"})}n?(l=(t=window.console)==null?void 0:t.error)==null||l.call(t,e,n):(i=(a=window.console)==null?void 0:a.error)==null||i.call(a,e)}function show_resource_load_error_message(e){const{$window:n,$message:o}=showMessageBox$1({}),t=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;e.code==="cross-origin-blob-uri"?o.html(`
			<p>Can't load image from address starting with "blob:".</p>
			${t?'<p>Try "Copy Image" instead of "Copy Image Location".</p>':'<p>Try "Copy image" instead of "Copy image address".</p>'}
		`):e.code==="html-not-image"?o.html(`
			<p>Address points to a web page, not an image file.</p>
			<p>Try copying and pasting an image instead of a URL.</p>
		`):e.code==="decoding-failure"?o.html(`
			<p>Address doesn't point to an image file of a supported format.</p>
			<p>Try copying and pasting an image instead of a URL.</p>
		`):e.code==="access-failure"?navigator.onLine?(o.html(`
				<p>Failed to download image.</p>
				<p>Try copying and pasting an image instead of a URL.</p>
			`),e.fails&&$("<ul>").append(e.fails.map(({status:l,statusText:a,url:i})=>$("<li>").text(i).prepend($("<b>").text(`${l||""} ${a||"Failed"} `)))).appendTo(o)):o.html(`
				<p>Failed to download image.</p>
				<p>You're offline. Connect to the internet and try again.</p>
				<p>Or copy and paste an image instead of a URL, if possible.</p>
			`):o.html(`
			<p>Failed to load image from URL.</p>
			<p>Check your browser's devtools for details.</p>
		`),o.css({maxWidth:"500px"}),n.center()}function show_file_format_errors({as_image_error:e,as_palette_error:n}){let o=`
		<p>${localize("Paint cannot open this file.")}</p>
	`;e&&(o+=`
			<details>
				<summary>${localize("Bitmap Image")}</summary>
				<p>${localize("This is not a valid bitmap file, or its format is not currently supported.")}</p>
			</details>
		`);var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};const l=s=>String(s).replace(/[&<>"'`=/]/g,c=>t[c]),a=s=>s.charAt(0).toUpperCase()+s.slice(1),i=n&&!e;if(n){let s="";"errors"in n?s=`<ul dir="ltr">${n.errors.map(c=>{const r=c.__PATCHED_LIB_TO_ADD_THIS__format;return r&&c.error?`<li><b>${l(`${r.name}`)}</b>: ${l(a(c.error.message))}</li>`:`<li>${l(c.message||c)}</li>`}).join(`
`)}</ul>`:s=`<p>${l(n.message||n)}</p>`,o+=`
			<details>
				<summary>${i?"Details":localize("Palette|*.pal|").split("|")[0]}</summary>
				<p>${localize("Unexpected file format.")}</p>
				${s}
			</details>
		`}showMessageBox$1({messageHTML:o})}let $about_paint_window;const $about_paint_content=$("#about-paint");let $news_window;const $this_version_news=$("#news");let $latest_news=$this_version_news;location.origin!=="https://jspaint.app"&&$this_version_news.prepend($("<p>For the latest news, visit <a href='https://jspaint.app'>jspaint.app</a></p>").css({padding:"8px 15px"}));function show_about_paint(){$about_paint_window&&$about_paint_window.close(),$about_paint_window=$Window({title:localize("About Paint"),resizable:!1,maximizeButton:!1,minimizeButton:!1}),$about_paint_window.addClass("about-paint squish"),is_pride_month&&$("#about-paint-icon").attr("src","./images/icons/gay-es-paint-128x128.png"),$about_paint_window.$content.append($about_paint_content.show()).css({padding:"15px"}),$("#jspaint-update-status-area").removeAttr("hidden"),$("#failed-to-check-if-outdated").attr("hidden","hidden"),$("#outdated").attr("hidden","hidden"),$about_paint_window.$Button(localize("OK"),()=>{$about_paint_window.close()}).attr("id","close-about-paint").focus().css({float:"right",marginBottom:"10px"}),$("#refresh-to-update").on("click",n=>{n.preventDefault(),are_you_sure$1(()=>{exit_fullscreen_if_ios$1(),location.reload()})}),$("#view-project-news").on("click",()=>{show_news()}),$about_paint_window.css({left:-innerWidth,top:-innerHeight}),$about_paint_window.center(),$("#checking-for-updates").removeAttr("hidden");const e="https://jspaint.app/?news";fetch(e).then(n=>n.text()).then(n=>{const t=new DOMParser().parseFromString(n,"text/html");$latest_news=$(t).find("#news");const l=$latest_news.find(".news-entry"),a=$this_version_news.find(".news-entry");if(!l.length)throw $latest_news=$this_version_news,new Error(`No news found at fetched site (${e})`);function i(r,d){return r.get().some(h=>d===h.id)}const s=l.get().filter(r=>!i(a,r.id)),c=a.get().filter(r=>!i(l,r.id));s.length>0?$("#outdated").removeAttr("hidden"):c.length>0&&($latest_news=$this_version_news),$("#checking-for-updates").attr("hidden","hidden"),update_css_classes_for_conditional_messages()}).catch(n=>{var o;$("#failed-to-check-if-outdated").removeAttr("hidden"),$("#checking-for-updates").attr("hidden","hidden"),update_css_classes_for_conditional_messages(),(o=window.console)==null||o.log("Couldn't check for updates.",n)})}function exit_fullscreen_if_ios$1(){if($("body").hasClass("ios"))try{document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}catch{}}function update_css_classes_for_conditional_messages(){$(".on-dev-host, .on-third-party-host, .on-official-host").hide(),location.hostname.match(/localhost|127.0.0.1/)?$(".on-dev-host").show():location.hostname.match(/jspaint.app/)?$(".on-official-host").show():$(".on-third-party-host").show(),$(".navigator-online, .navigator-offline").hide(),navigator.onLine?$(".navigator-online").show():$(".navigator-offline").show()}function show_news(){$news_window&&$news_window.close(),$news_window=$Window({title:"Project News",maximizeButton:!1,minimizeButton:!1,resizable:!1}),$news_window.addClass("news-window squish");const e=$latest_news.find("style");$this_version_news.find("style").remove(),$latest_news.append(e),$news_window.$content.append($latest_news.removeAttr("hidden")),$news_window.center(),$news_window.center(),$latest_news.attr("tabIndex","-1").focus()}function paste_image_from_file(e){read_image_file(e,(n,o)=>{if(n){show_file_format_errors({as_image_error:n});return}paste(o.image||make_canvas(o.image_data))})}async function choose_file_to_paste(){const{file:e}=await systemHooks.showOpenFileDialog({formats:image_formats});if(e.type.match(/^image|application\/pdf/)){paste_image_from_file(e);return}show_error_message$1(localize("This is not a valid bitmap file, or its format is not currently supported."))}function paste(e){if(e.width>main_canvas.width||e.height>main_canvas.height){const o=localize("The image in the clipboard is larger than the bitmap.")+`
`+localize("Would you like the bitmap enlarged?");showMessageBox$1({message:o,iconID:"question",windowOptions:{icons:{16:"images/windows-16x16.png",32:"images/windows-32x32.png"}},buttons:[{label:localize("Yes"),value:"enlarge",default:!0},{label:localize("No"),value:"crop"},{label:localize("Cancel"),value:"cancel"}]}).then(t=>{t==="enlarge"?(resize_canvas_and_save_dimensions(Math.max(main_canvas.width,e.width),Math.max(main_canvas.height,e.height),{name:"Enlarge Canvas For Paste",icon:get_help_folder_icon("p_stretch_both.png")}),n(),$canvas_area.trigger("resize")):t==="crop"&&n()})}else n();function n(){deselect(),select_tool(get_tool_by_id(TOOL_SELECT));const o=Math.max(0,Math.ceil($canvas_area.scrollLeft()/magnification)),t=Math.max(0,Math.ceil($canvas_area.scrollTop()/magnification));undoable({name:localize("Paste"),icon:get_help_folder_icon("p_paste.png"),soft:!0},()=>{selection=new OnCanvasSelection(o,t,e.width,e.height,e)})}}function render_history_as_gif(){const e=$DialogWindow();e.title("Rendering GIF");const n=e.$main,o=$(E("progress")).appendTo(n).addClass("inset-deep"),t=$(E("span")).appendTo(n).css({width:"2.3em",display:"inline-block",textAlign:"center"});e.$main.css({padding:5});const l=e.$Button("Cancel",()=>{e.close()}).focus();e.center();try{const a=main_canvas.width,i=main_canvas.height,s=new GIF({workerScript:"lib/gif.js/gif.worker.js",width:a,height:i});e.on("close",()=>{s.abort()}),s.on("progress",d=>{o.val(d),t.text(`${~~(d*100)}%`)}),s.on("finished",d=>{e.title("Rendered GIF");const h=URL.createObjectURL(d);n.empty().append($(E("div")).addClass("inset-deep").append($(E("img")).attr({src:h,width:a,height:i}).css({display:"block"})).css({overflow:"auto",maxHeight:"70vh",maxWidth:"70vw"})),e.on("close",()=>{URL.revokeObjectURL(h)}),e.$Button("Upload to Imgur",()=>{e.close(),sanity_check_blob(d,()=>{show_imgur_uploader(d)})}).focus(),e.$Button(localize("Save"),()=>{e.close(),sanity_check_blob(d,()=>{const m=`${file_name.replace(/\.(bmp|dib|a?png|gif|jpe?g|jpe|jfif|tiff?|webp|raw)$/i,"")} history.gif`;systemHooks.showSaveFileDialog({dialogTitle:localize("Save As"),getBlob:()=>d,defaultFileName:m,defaultPath:typeof system_file_handle=="string"?`${system_file_handle.replace(/[/\\][^/\\]*/,"")}/${m}`:null,defaultFileFormatID:"image/gif",formats:[{formatID:"image/gif",mimeType:"image/gif",name:localize("Animated GIF (*.gif)").replace(/\s+\([^(]+$/,""),nameWithExtensions:localize("Animated GIF (*.gif)"),extensions:["gif"]}]})})}),l.appendTo(e.$buttons),e.center()});const c=make_canvas(a,i),r=[...undos,current_history_node];for(const d of r){if(c.ctx.clearRect(0,0,c.width,c.height),c.ctx.putImageData(d.image_data,0,0),d.selection_image_data){const h=make_canvas(d.selection_image_data);c.ctx.drawImage(h,d.selection_x,d.selection_y)}s.addFrame(c,{delay:200,copy:!0})}s.render()}catch(a){e.close(),show_error_message$1("Failed to render GIF.",a)}}function go_to_history_node(e,n){var i;const o=current_history_node;if(!e.image_data){n||(show_error_message$1("History entry has no image data."),(i=window.console)==null||i.log("Target history entry has no image data:",e));return}if(current_history_node=e,deselect(!0),n||cancel(!0),saved=!1,update_title(),main_ctx.copy(e.image_data),e.selection_image_data&&(selection&&selection.destroy(),e.name===localize("Free-Form Select")?select_tool(get_tool_by_id(TOOL_FREE_FORM_SELECT)):select_tool(get_tool_by_id(TOOL_SELECT)),selection=new OnCanvasSelection(e.selection_x,e.selection_y,e.selection_image_data.width,e.selection_image_data.height,e.selection_image_data)),e.textbox_text!=null){textbox&&textbox.destroy();for(const[s,c]of Object.entries(e.text_tool_font))text_tool_font[s]=c;selected_colors.foreground=e.foreground_color,selected_colors.background=e.background_color,tool_transparent_mode=e.tool_transparent_mode,$G$1.trigger("option-changed"),select_tool(get_tool_by_id(TOOL_TEXT)),textbox=new OnCanvasTextBox(e.textbox_x,e.textbox_y,e.textbox_width,e.textbox_height,e.textbox_text)}const t=get_history_ancestors(e);undos=[...t],undos.reverse();const l=redos.length>0?[redos[0],...get_history_ancestors(redos[0])]:[o,...get_history_ancestors(o)];redos.length=0;let a=e;for(;a.futures.length>0;){const s=[...a.futures];s.sort((c,r)=>l.indexOf(c)>-1?-1:l.indexOf(r)>-1?1:0),a=s[0],redos.unshift(a)}$canvas_area.trigger("resize"),$G$1.triggerHandler("session-update"),$G$1.triggerHandler("history-update")}function undoable({name:e,icon:n,use_loose_canvas_changes:o,soft:t,assume_saved:l},a){var r;l||(saved=!1,update_title());const i=current_history_node;a==null||a(),current_history_node!==i&&(show_error_message$1(`History node switched during undoable callback for ${e}. This shouldn't happen.`),(r=window.console)==null||r.log(`History node switched during undoable callback for ${e}, from`,i,"to",current_history_node));const s=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height);redos.length=0,undos.push(current_history_node);const c=make_history_node({image_data:s,selection_image_data:selection&&selection.canvas.ctx.getImageData(0,0,selection.canvas.width,selection.canvas.height),selection_x:selection&&selection.x,selection_y:selection&&selection.y,textbox_text:textbox&&textbox.$editor.val(),textbox_x:textbox&&textbox.x,textbox_y:textbox&&textbox.y,textbox_width:textbox&&textbox.width,textbox_height:textbox&&textbox.height,text_tool_font:JSON.parse(JSON.stringify(text_tool_font)),tool_transparent_mode,foreground_color:selected_colors.foreground,background_color:selected_colors.background,ternary_color:selected_colors.ternary,parent:current_history_node,name:e,icon:n,soft:t});current_history_node.futures.push(c),current_history_node=c,$G$1.triggerHandler("history-update"),$G$1.triggerHandler("session-update")}function make_or_update_undoable(e,n){current_history_node.futures.length===0&&e.match(current_history_node)?(n(),current_history_node.image_data=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height),current_history_node.selection_image_data=selection&&selection.canvas.ctx.getImageData(0,0,selection.canvas.width,selection.canvas.height),current_history_node.selection_x=selection&&selection.x,current_history_node.selection_y=selection&&selection.y,e.update_name&&(current_history_node.name=e.name),$G$1.triggerHandler("history-update")):undoable(e,n)}function undo(){if(undos.length<1)return!1;redos.push(current_history_node);let e=undos.pop();for(;e.soft&&undos.length;)redos.push(e),e=undos.pop();return go_to_history_node(e),!0}let $document_history_prompt_window;function redo(){if(redos.length<1)return $document_history_prompt_window&&$document_history_prompt_window.close(),(!$document_history_window||$document_history_window.closed)&&($document_history_prompt_window=showMessageBox$1({title:"Redo",messageHTML:"To view all branches of the history tree, click <b>Edit > History</b>.",iconID:"info"}).$window),!1;undos.push(current_history_node);let e=redos.pop();for(;e.soft&&redos.length;)undos.push(e),e=redos.pop();return go_to_history_node(e),!0}function get_history_ancestors(e){const n=[];for(e=e.parent;e;e=e.parent)n.push(e);return n}let $document_history_window;function show_document_history(){$document_history_prompt_window&&$document_history_prompt_window.close(),$document_history_window&&$document_history_window.close();const e=$document_history_window=$Window({title:"Document History",resizable:!1,maximizeButton:!1,minimizeButton:!1});e.addClass("history-window squish"),e.$content.html(`
		<label>
			<select id="history-view-mode" class="inset-deep">
				<option value="linear">Linear timeline</option>
				<option value="tree">Tree</option>
			</select>
		</label>
		<div class="history-view" tabIndex="0"></div>
	`);const n=e.$content.find(".history-view");n.focus();let o=0,t=[],l,a=e.$content.find("#history-view-mode");a.css({margin:"10px"});let i=a.val();a.on("change",()=>{i=a.val(),c()});function s(d){const h=$(`
			<div class="history-entry">
				<div class="history-entry-icon-area"></div>
				<div class="history-entry-name"></div>
			</div>
		`);if(h.find(".history-entry-name").text((d.name||"Unknown")+(d===root_history_node?" (Start of History)":"")),h.find(".history-entry-icon-area").append(d.icon),i==="tree"){let m=0;for(let f=d.parent;f;f=f.parent)m++;h.css({marginInlineStart:`${m*8}px`})}d===current_history_node?(h.addClass("current"),l=h,requestAnimationFrame(()=>{n[0].scrollTop=Math.min(h[0].offsetTop,Math.max(o,h[0].offsetTop-n[0].clientHeight+h.outerHeight()))})):get_history_ancestors(current_history_node).indexOf(d)>-1&&h.addClass("ancestor-of-current");for(const m of d.futures)s(m);h.on("click",()=>{go_to_history_node(d)}),h.history_node=d,t.push(h)}const c=()=>{o=n.scrollTop(),n.empty(),t=[],s(root_history_node),i==="linear"?t.sort((d,h)=>d.history_node.timestamp<h.history_node.timestamp?-1:h.history_node.timestamp<d.history_node.timestamp?1:0):t.reverse(),t.forEach(d=>{n.append(d)})};c();const r=d=>{const m=t.indexOf(l)+d;t[m]&&t[m].click()};n.on("keydown",d=>{!d.ctrlKey&&!d.altKey&&!d.shiftKey&&!d.metaKey&&(d.key==="ArrowDown"||d.key==="Down"?(r(1),d.preventDefault()):(d.key==="ArrowUp"||d.key==="Up")&&(r(-1),d.preventDefault()))}),$G$1.on("history-update",c),e.on("close",()=>{$G$1.off("history-update",c)}),e.center()}function cancel(e,n){var t;if(!history_node_to_cancel_to)return;const o=n&&current_history_node.parent&&current_history_node!==history_node_to_cancel_to&&current_history_node.futures.length===0?current_history_node:null;$G$1.triggerHandler("pointerup",["canceling",n]);for(const l of selected_tools)(t=l.cancel)==null||t.call(l);if(!e&&(go_to_history_node(history_node_to_cancel_to,!0),o)){const l=o.parent.futures.indexOf(o);l===-1?(show_error_message$1("History node not found. Please report this bug."),console.log("history_node_to_discard",o),console.log("current_history_node",current_history_node),console.log("history_node_to_discard.parent",o.parent)):(o.parent.futures.splice(l,1),$G$1.triggerHandler("history-update"))}history_node_to_cancel_to=null,update_helper_layer()}function meld_selection_into_canvas(e){selection.draw(),selection.destroy(),selection=null,e||undoable({name:"Deselect",icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),use_loose_canvas_changes:!0},()=>{})}function meld_textbox_into_canvas(e){textbox.$editor.val()&&!e?(undoable({name:localize("Text"),icon:get_icon_for_tool(get_tool_by_id(TOOL_TEXT)),soft:!0},()=>{}),undoable({name:"Finish Text",icon:get_icon_for_tool(get_tool_by_id(TOOL_TEXT))},()=>{main_ctx.drawImage(textbox.canvas,textbox.x,textbox.y),textbox.destroy(),textbox=null})):(textbox.destroy(),textbox=null)}function deselect(e){var n;selection&&meld_selection_into_canvas(e),textbox&&meld_textbox_into_canvas(e);for(const o of selected_tools)(n=o.end)==null||n.call(o,main_ctx)}function delete_selection(e={}){selection&&undoable({name:e.name||localize("Clear Selection"),icon:e.icon||get_help_folder_icon("p_delete.png")},()=>{selection.destroy(),selection=null})}function select_all(){deselect(),select_tool(get_tool_by_id(TOOL_SELECT)),undoable({name:localize("Select All"),icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{selection=new OnCanvasSelection(0,0,main_canvas.width,main_canvas.height)})}const ctrlOrCmd=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)?"⌘":"Ctrl",recommendationForClipboardAccess=`Please use the keyboard: ${ctrlOrCmd}+C to copy, ${ctrlOrCmd}+X to cut, ${ctrlOrCmd}+V to paste. If keyboard is not an option, try using Chrome version 76 or higher.`;function try_exec_command(e){if(document.queryCommandEnabled(e)){if(document.execCommand(e),!navigator.userAgent.includes("Firefox")||e==="paste")return show_error_message$1(`That ${e} probably didn't work. ${recommendationForClipboardAccess}`)}else return show_error_message$1(`Cannot perform ${e}. ${recommendationForClipboardAccess}`)}function getSelectionText(){const e=document.activeElement,n=e?e.tagName.toLowerCase():null;if(n=="textarea"||n=="input"&&/^(?:text|search|password|tel|url)$/i.test(e.type)){const o=e;if(typeof o.selectionStart=="number")return o.value.slice(o.selectionStart,o.selectionEnd)}return window.getSelection?window.getSelection().toString():""}function edit_copy(e){const n=getSelectionText();if(n.length>0){if(!navigator.clipboard||!navigator.clipboard.writeText){if(e)return try_exec_command("copy");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}navigator.clipboard.writeText(n)}else if(selection&&selection.canvas){if(!navigator.clipboard||!navigator.clipboard.write){if(e)return try_exec_command("copy");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}selection.canvas.toBlob(o=>{sanity_check_blob(o,()=>{navigator.clipboard.write([new ClipboardItem(Object.defineProperty({},o.type,{value:o,enumerable:!0}))]).then(()=>{var t;(t=window.console)==null||t.log("Copied image to the clipboard.")},t=>{show_error_message$1("Failed to copy to the Clipboard.",t)})})})}}function edit_cut(e){if(!navigator.clipboard||!navigator.clipboard.write){if(e)return try_exec_command("cut");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}edit_copy(),delete_selection({name:localize("Cut"),icon:get_help_folder_icon("p_cut.png")})}async function edit_paste(e){if(document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement){if(!navigator.clipboard||!navigator.clipboard.readText){if(e)return try_exec_command("paste");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}const n=await navigator.clipboard.readText();document.execCommand("InsertText",!1,n);return}if(!navigator.clipboard||!navigator.clipboard.read){if(e)return try_exec_command("paste");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}try{const o=await(await navigator.clipboard.read())[0].getType("image/png");paste_image_from_file(o)}catch(n){if(n.name==="NotFoundError")try{const o=await navigator.clipboard.readText();if(o){const t=get_uris(o);t.length>0?load_image_from_uri(t[0]).then(l=>{paste(l.image||make_canvas(l.image_data))},l=>{show_resource_load_error_message(l)}):show_error_message$1("The information on the Clipboard can't be inserted into Paint.")}else show_error_message$1("The information on the Clipboard can't be inserted into Paint.")}catch(o){show_error_message$1(localize("Error getting the Clipboard Data!"),o)}else show_error_message$1(localize("Error getting the Clipboard Data!"),n)}}function image_invert_colors(){apply_image_transformation({name:localize("Invert Colors"),icon:get_help_folder_icon("p_invert.png")},(e,n,o,t)=>{const l=monochrome&&detect_monochrome(n);monochrome&&l.isMonochrome?invert_monochrome(n,t,l):invert_rgb(n,t)})}function clear(){deselect(),cancel(),undoable({name:localize("Clear Image"),icon:get_help_folder_icon("p_blank.png")},()=>{saved=!1,update_title(),transparency?main_ctx.clearRect(0,0,main_canvas.width,main_canvas.height):(main_ctx.fillStyle=selected_colors.background,main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height))})}let cleanup_bitmap_view=()=>{};function view_bitmap(){cleanup_bitmap_view();const e=document.createElement("div");e.classList.add("bitmap-view","inset-deep"),document.body.appendChild(e),$(e).css({display:"flex",alignItems:"center",justifyContent:"center",position:"fixed",top:"0",left:"0",width:"100%",height:"100%",zIndex:"9999",background:"var(--Background)"}),e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen();let n,o=!1,t=setInterval(()=>{document.fullscreenElement===e||document.webkitFullscreenElement===e?o=!0:o&&cleanup_bitmap_view()},100);cleanup_bitmap_view=()=>{document.removeEventListener("fullscreenchange",l),document.removeEventListener("webkitfullscreenchange",l),document.removeEventListener("keydown",i),document.removeEventListener("mousedown",s),setTimeout(()=>{document.removeEventListener("contextmenu",c)},100),URL.revokeObjectURL(n),clearInterval(t),(document.fullscreenElement===e||document.webkitFullscreenElement===e)&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()),e.remove(),cleanup_bitmap_view=()=>{}},document.addEventListener("fullscreenchange",l,{once:!0}),document.addEventListener("webkitfullscreenchange",l,{once:!0}),document.addEventListener("keydown",i),document.addEventListener("mousedown",s),document.addEventListener("contextmenu",c);function l(){document.fullscreenElement!==e&&document.webkitFullscreenElement!==e&&cleanup_bitmap_view()}let a=!1;function i(r){if(a=a||r.repeat&&(r.key==="f"||r.key==="F"),!r.repeat){if(a&&(r.key==="f"||r.key==="F")){a=!1;return}r.preventDefault(),cleanup_bitmap_view()}}function s(r){cleanup_bitmap_view()}function c(r){r.preventDefault(),cleanup_bitmap_view()}main_canvas.toBlob(r=>{n=URL.createObjectURL(r);const d=document.createElement("img");d.src=n,e.appendChild(d)},"image/png")}function get_tool_by_id(e){for(let n=0;n<tools.length;n++)if(tools[n].id==e)return tools[n]}function select_tools(e){for(let n=0;n<e.length;n++)select_tool(e[n],n>0);update_helper_layer()}function select_tool(e,n){if(deselect(),selected_tools.length===1&&selected_tool.deselect||(return_to_tools=[...selected_tools]),n){const o=selected_tools.indexOf(e);o===-1?(selected_tools.push(e),selected_tools.sort((t,l)=>tools.indexOf(t)<tools.indexOf(l)?-1:tools.indexOf(t)>tools.indexOf(l)?1:0)):selected_tools.splice(o,1),selected_tools.length>0?selected_tool=selected_tools[selected_tools.length-1]:(selected_tool=default_tool,selected_tools=[selected_tool])}else selected_tool=e,selected_tools=[e];e.preload&&e.preload(),$toolbox.update_selected_tool()}function has_any_transparency(e){const n=e.getImageData(0,0,main_canvas.width,main_canvas.height);for(let o=0,t=n.data.length;o<t;o+=4)if(n.data[o+3]<253)return!0;return!1}function detect_monochrome(e){const n=e.getImageData(0,0,e.canvas.width,e.canvas.height),o=new Uint32Array(n.data.buffer),t=[],l=[];let a=!1;for(let i=0,s=o.length;i<s;i+=1)if(n.data[i*4+3]>1){if(!t.includes(o[i]))if(t.length<2)t.push(o[i]),l.push(n.data.slice(i*4,(i+1)*4));else return{isMonochrome:!1}}else a=!0;return{isMonochrome:!0,presentNonTransparentRGBAs:l,presentNonTransparentUint32s:t,monochromeWithTransparency:a}}function make_monochrome_pattern(e,n=[0,0,0,255],o=[255,255,255,255]){const t=Array.from({length:64},(s,c)=>{const r=c^c>>3;return((c&4)>>2|(r&4)>>1|(c&2)<<1|(r&2)<<2|(c&1)<<4|(r&1)<<5)/64}),l=document.createElement("canvas"),a=l.getContext("2d");l.width=8,l.height=8;const i=main_ctx.createImageData(l.width,l.height);for(let s=0;s<l.width;s+=1)for(let c=0;c<l.height;c+=1){const r=t[(s&7)+((c&7)<<3)],d=e>r,h=(c*i.width+s)*4;i.data[h+0]=d?o[0]:n[0],i.data[h+1]=d?o[1]:n[1],i.data[h+2]=d?o[2]:n[2],i.data[h+3]=(d?o[3]:n[3])??255}return a.putImageData(i,0,0),main_ctx.createPattern(l,"repeat")}function make_monochrome_palette(e=[0,0,0,255],n=[255,255,255,255]){const o=[];for(let a=0;a<14;a++){let i=a/28;o.push(make_monochrome_pattern(i,e,n))}for(let a=0;a<14;a++){let i=1-a/28;o.push(make_monochrome_pattern(i,e,n))}return o}function make_stripe_pattern(e,n,o=4){const t=n.map(get_rgba_from_color),l=document.createElement("canvas"),a=l.getContext("2d");l.width=n.length*o,l.height=n.length*o;const i=main_ctx.createImageData(l.width,l.height);for(let s=0;s<l.width;s+=1)for(let c=0;c<l.height;c+=1){const r=(c*i.width+s)*4,d=e?s-c:s+c,h=Math.floor((d+1e3)/o)%n.length,m=t[h];i.data[r+0]=m[0],i.data[r+1]=m[1],i.data[r+2]=m[2],i.data[r+3]=m[3]}return a.putImageData(i,0,0),main_ctx.createPattern(l,"repeat")}function make_opaque(){undoable({name:"Make Opaque",icon:get_help_folder_icon("p_make_opaque.png")},()=>{main_ctx.save(),main_ctx.globalCompositeOperation="destination-atop",main_ctx.fillStyle="white",main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height),main_ctx.restore()})}function resize_canvas_without_saving_dimensions(e,n,o={}){const t=Math.max(1,e),l=Math.max(1,n);(main_canvas.width!==t||main_canvas.height!==l)&&undoable({name:o.name||"Resize Canvas",icon:o.icon||get_help_folder_icon("p_stretch_both.png")},()=>{try{const a=main_ctx.getImageData(0,0,t,l);main_canvas.width=t,main_canvas.height=l,main_ctx.disable_image_smoothing(),transparency||(main_ctx.fillStyle=selected_colors.background,main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height));const i=make_canvas(a);main_ctx.drawImage(i,0,0)}catch(a){a.name==="NS_ERROR_FAILURE"?show_error_message$1(localize("Insufficient memory to perform operation."),a):show_error_message$1(localize("An unknown error has occurred."),a);return}$canvas_area.trigger("resize")})}function resize_canvas_and_save_dimensions(e,n,o={}){resize_canvas_without_saving_dimensions(e,n,o),localStore.set({width:main_canvas.width.toString(),height:main_canvas.height.toString()},t=>{})}function image_attributes(){image_attributes.$window&&image_attributes.$window.close();const e=image_attributes.$window=$DialogWindow(localize("Attributes"));e.addClass("attributes-window");const n=e.$main,o={[localize("File last saved:")]:localize("Not Available"),[localize("Size on disk:")]:localize("Not Available"),[localize("Resolution:")]:"72 x 72 dots per inch"},t=$(E("table")).appendTo(n);for(const x in o){const b=$(E("tr")).appendTo(t);$(E("td")).appendTo(b).text(x);const A=$(E("td")).appendTo(b).text(o[x]);o[x].indexOf("72")!==-1&&A.css("direction","ltr")}const l={px:1,in:72,cm:28.3465};let a=image_attributes.unit=image_attributes.unit||"px",i=main_canvas.width,s=main_canvas.height;const c=$(E("label")).appendTo(n).html(render_access_key(localize("&Width:"))),r=$(E("label")).appendTo(n).html(render_access_key(localize("&Height:"))),d=$(E("input")).attr({type:"number",min:1,"aria-keyshortcuts":"Alt+W W W"}).addClass("no-spinner inset-deep").appendTo(c),h=$(E("input")).attr({type:"number",min:1,"aria-keyshortcuts":"Alt+H H H"}).addClass("no-spinner inset-deep").appendTo(r);n.find("input").css({width:"40px"}).on("change keyup keydown keypress pointerdown pointermove paste drop",()=>{i=Number(d.val())*l[a],s=Number(h.val())*l[a]});const m=$(E("fieldset")).appendTo(n).append(`
		<legend>${localize("Units")}</legend>
		<div class="fieldset-body">
			<div class="radio-field"><input type="radio" name="units" id="unit-in" value="in" aria-keyshortcuts="Alt+I I"><label for="unit-in">${render_access_key(localize("&Inches"))}</label></div>
			<div class="radio-field"><input type="radio" name="units" id="unit-cm" value="cm" aria-keyshortcuts="Alt+M M"><label for="unit-cm">${render_access_key(localize("C&m"))}</label></div>
			<div class="radio-field"><input type="radio" name="units" id="unit-px" value="px" aria-keyshortcuts="Alt+P P"><label for="unit-px">${render_access_key(localize("&Pixels"))}</label></div>
		</div>
	`);m.find(`[value=${a}]`).attr({checked:!0}),m.on("change",()=>{const x=String(m.find(":checked").val());d.val(i/l[x]),h.val(s/l[x]),a=x}).triggerHandler("change");const f=$(E("fieldset")).appendTo(n).append(`
		<legend>${localize("Colors")}</legend>
		<div class="fieldset-body">
			<div class="radio-field"><input type="radio" name="colors" id="attribute-monochrome" value="monochrome" aria-keyshortcuts="Alt+B B"><label for="attribute-monochrome">${render_access_key(localize("&Black and white"))}</label></div>
			<div class="radio-field"><input type="radio" name="colors" id="attribute-polychrome" value="polychrome" aria-keyshortcuts="Alt+L L"><label for="attribute-polychrome">${render_access_key(localize("Co&lors"))}</label></div>
		</div>
	`);f.find(`[value=${monochrome?"monochrome":"polychrome"}]`).attr({checked:!0});const g=$(E("fieldset")).appendTo(n).append(`
		<legend>${localize("Transparency")}</legend>
		<div class="fieldset-body">
			<div class="radio-field"><input type="radio" name="transparency" id="attribute-transparent" value="transparent"><label for="attribute-transparent">${localize("Transparent")}</label></div>
			<div class="radio-field"><input type="radio" name="transparency" id="attribute-opaque" value="opaque"><label for="attribute-opaque">${localize("Opaque")}</label></div>
		</div>
	`);g.find(`[value=${transparency?"transparent":"opaque"}]`).attr({checked:!0}),e.$Button(localize("OK"),()=>{const x=g.find(":checked").val(),b=f.find(":checked").val(),A=String(m.find(":checked").val()),M=monochrome;let L;image_attributes.unit=A,transparency=x=="transparent",monochrome=b=="monochrome",x=="transparent"&&(selected_colors.background="transparent"),monochrome!=M&&(selection&&meld_selection_into_canvas(),L=detect_monochrome(main_ctx),monochrome?L.isMonochrome&&L.presentNonTransparentRGBAs.length===2?palette=make_monochrome_palette(...L.presentNonTransparentRGBAs):palette=monochrome_palette:palette=polychrome_palette,selected_colors.foreground=palette[0],selected_colors.background=palette[14],selected_colors.ternary="",$colorbox.rebuild_palette(),$G$1.trigger("option-changed"));const C=l[A],u=Number(d.val())*C,_=Number(h.val())*C;resize_canvas_and_save_dimensions(~~u,~~_),!transparency&&has_any_transparency(main_ctx)&&make_opaque(),monochrome!=M&&monochrome&&!L.isMonochrome&&show_convert_to_black_and_white(),image_attributes.$window.close()},{type:"submit"}),e.$Button(localize("Cancel"),()=>{image_attributes.$window.close()}),e.$Button($.parseHTML(render_access_key(localize("&Default")))[0],()=>{i=default_canvas_width,s=default_canvas_height,d.val(i/l[a]),h.val(s/l[a])}).attr("aria-keyshortcuts","Alt+D D"),handle_keyshortcuts(e),d.select(),image_attributes.$window.center()}image_attributes.$window=null;image_attributes.unit="px";function show_convert_to_black_and_white(){const e=$DialogWindow("Convert to Black and White");e.addClass("convert-to-black-and-white"),e.$main.append("<fieldset><legend>Threshold:</legend><input type='range' min='0' max='1' step='0.01' value='0.5'></fieldset>");const n=e.$main.find("input[type='range']"),o=make_canvas(main_canvas);let t;const l=()=>{make_or_update_undoable({name:"Make Monochrome",match:i=>i.name==="Make Monochrome",icon:get_help_folder_icon("p_monochrome.png")},()=>{t=Number(n.val()),main_ctx.copy(o),threshold_black_and_white(main_ctx,t)})};l();const a=debounce(l,100);n.on("input",a),e.$Button(localize("OK"),()=>{e.close()},{type:"submit"}).focus(),e.$Button(localize("Cancel"),()=>{current_history_node.name==="Make Monochrome"?undo():undoable({name:"Cancel Make Monochrome",icon:get_help_folder_icon("p_color.png")},()=>{main_ctx.copy(o)}),e.close()}),e.center()}function image_flip_and_rotate(){const e=$DialogWindow(localize("Flip and Rotate"));e.addClass("flip-and-rotate");const n=$(E("fieldset")).appendTo(e.$main);n.append(`
		<legend>${localize("Flip or rotate")}</legend>
		<div class="radio-wrapper">
			<input
				type="radio"
				name="flip-or-rotate"
				id="flip-horizontal"
				value="flip-horizontal"
				aria-keyshortcuts="Alt+F"
				checked
			/><label for="flip-horizontal">${render_access_key(localize("&Flip horizontal"))}</label>
		</div>
		<div class="radio-wrapper">
			<input
				type="radio"
				name="flip-or-rotate"
				id="flip-vertical"
				value="flip-vertical"
				aria-keyshortcuts="Alt+V"
			/><label for="flip-vertical">${render_access_key(localize("Flip &vertical"))}</label>
		</div>
		<div class="radio-wrapper">
			<input
				type="radio"
				name="flip-or-rotate"
				id="rotate-by-angle"
				value="rotate-by-angle"
				aria-keyshortcuts="Alt+R"
			/><label for="rotate-by-angle">${render_access_key(localize("&Rotate by angle"))}</label>
		</div>
	`);const o=$(E("div")).appendTo(n);o.addClass("sub-options");for(const t of["&90°","&180°","&270°"]){const l=parseInt(AccessKeys.toText(t),10);o.append(`
			<div class="radio-wrapper">
				<input
					type="radio"
					name="rotate-by-angle"
					value="${l}"
					id="rotate-${l}"
					aria-keyshortcuts="Alt+${AccessKeys.get(t).toUpperCase()}"
				/><label
					for="rotate-${l}"
				>${render_access_key(t)}</label>
			</div>
		`)}o.append(`
		<div class="radio-wrapper">
			<input
				type="radio"
				name="rotate-by-angle"
				value="arbitrary"
			/><input
				type="number"
				min="-360"
				max="360"
				name="rotate-by-arbitrary-angle"
				id="custom-degrees"
				value=""
				class="no-spinner inset-deep"
				style="width: 50px"
			/>
			<label for="custom-degrees">${localize("Degrees")}</label>
		</div>
	`),o.find("#rotate-90").attr({checked:!0}),o.find("input").attr({disabled:!0}),n.find("input").on("change",()=>{const t=n.find("input[name='flip-or-rotate']:checked").val();o.find("input").attr({disabled:t!=="rotate-by-angle"})}),o.find(".radio-wrapper").on("click",t=>{n.find("input[value='rotate-by-angle']").prop("checked",!0),n.find("input").triggerHandler("change");const l=$(t.target).closest(".radio-wrapper"),a=l.find("input[type='number']")[0];a&&a.focus(),l.find("input[type='radio']").prop("checked",!0)}),n.find("input[name='rotate-by-arbitrary-angle']").on("input",()=>{n.find("input[value='rotate-by-angle']").prop("checked",!0),n.find("input[value='arbitrary']").prop("checked",!0)}),e.$Button(localize("OK"),()=>{switch(n.find("input[name='flip-or-rotate']:checked").val()){case"flip-horizontal":flip_horizontal();break;case"flip-vertical":flip_vertical();break;case"rotate-by-angle":{let l=n.find("input[name='rotate-by-angle']:checked").val();l==="arbitrary"&&(l=n.find("input[name='rotate-by-arbitrary-angle']").val());const i=Number(l)/360*TAU;if(isNaN(i)){please_enter_a_number();return}rotate(i);break}}e.close()},{type:"submit"}),e.$Button(localize("Cancel"),()=>{e.close()}),n.find("input[type='radio']").first().focus(),e.center(),handle_keyshortcuts(e)}function image_stretch_and_skew(){const e=$DialogWindow(localize("Stretch and Skew"));e.addClass("stretch-and-skew");const n=$(E("fieldset")).appendTo(e.$main);n.append(`<legend>${localize("Stretch")}</legend><table></table>`);const o=$(E("fieldset")).appendTo(e.$main);o.append(`<legend>${localize("Skew")}</legend><table></table>`);const t=(c,r,d,h,m,f,g)=>{const x=$(E("tr")).appendTo(c),b=$(E("img")).attr({src:`images/transforms/${r}.png`,width:32,height:32}).css({marginRight:"20px"}),A=("input"+Math.random()+Math.random()).replace(/\./,""),M=$(E("input")).attr({type:"number",min:f,max:g,value:h,id:A,"aria-keyshortcuts":`Alt+${AccessKeys.get(d).toUpperCase()}`}).css({width:"40px"}).addClass("no-spinner inset-deep");return $(E("td")).appendTo(x).append(b),$(E("td")).appendTo(x).append($(E("label")).html(render_access_key(d)).attr("for",A)),$(E("td")).appendTo(x).append(M),$(E("td")).appendTo(x).text(m),M},l=t(n.find("table"),"stretch-x",localize("&Horizontal:"),100,"%",1,5e3),a=t(n.find("table"),"stretch-y",localize("&Vertical:"),100,"%",1,5e3),i=t(o.find("table"),"skew-x",localize("H&orizontal:"),0,localize("Degrees"),-90,90),s=t(o.find("table"),"skew-y",localize("V&ertical:"),0,localize("Degrees"),-90,90);e.$Button(localize("OK"),()=>{const c=parseFloat(l.val())/100,r=parseFloat(a.val())/100,d=parseFloat(i.val())/360*TAU,h=parseFloat(s.val())/360*TAU;if(isNaN(c)||isNaN(r)||isNaN(d)||isNaN(h)){please_enter_a_number();return}try{stretch_and_skew(c,r,d,h)}catch(m){m.name==="NS_ERROR_FAILURE"?show_error_message$1(localize("Insufficient memory to perform operation."),m):show_error_message$1(localize("An unknown error has occurred."),m);return}e.close()},{type:"submit"}),e.$Button(localize("Cancel"),()=>{e.close()}),e.$main.find("input").first().focus().select(),e.center(),handle_keyshortcuts(e)}function handle_keyshortcuts(e){e.on("keydown",n=>{const o=e.find("[aria-keyshortcuts]");for(let t of o){const l=$(t).attr("aria-keyshortcuts").split(" ");for(const a of l)if(!!a.match(/Alt\+/i)===n.altKey&&!!a.match(/Ctrl\+/i)===n.ctrlKey&&!!a.match(/Meta\+/i)===n.metaKey&&!!a.match(/Shift\+/i)===n.shiftKey&&a.split("+").pop().toUpperCase()===n.key.toUpperCase()){n.preventDefault(),n.stopPropagation(),t.disabled&&(t=t.closest(".radio-wrapper")),t.click(),t.focus();return}}}),e.on("focusin focusout",n=>{if($(n.target).is('textarea, input:not([type="checkbox"]):not([type="radio"]):not([type="button"]):not([type="submit"]):not([type="reset"]):not([type="image"]):not([type="file"]):not([type="color"]):not([type="range"])'))for(const o of e.find("[aria-keyshortcuts]"))o._original_aria_keyshortcuts=o._original_aria_keyshortcuts??o.getAttribute("aria-keyshortcuts"),o.setAttribute("aria-keyshortcuts",o.getAttribute("aria-keyshortcuts").split(" ").filter(t=>t.match(/(Alt|Ctrl|Meta)\+/i)).join(" "));else for(const o of e.find("[aria-keyshortcuts]"))o._original_aria_keyshortcuts&&o.setAttribute("aria-keyshortcuts",o._original_aria_keyshortcuts)})}function save_as_prompt({dialogTitle:e=localize("Save As"),defaultFileName:n="",defaultFileFormatID:o,formats:t,promptForName:l=!0}){return new Promise(a=>{const i=$DialogWindow(e);i.addClass("save-as"),i.$content.attr("tabIndex",null),l&&i.$main.append(`
				<label>
					File name:
					<input type="text" class="file-name inset-deep"/>
				</label>
			`),i.$main.append(`
			<label>
				Save as type:
				<select class="file-type-select inset-deep"></select>
			</label>
		`);const s=i.$main.find(".file-type-select"),c=i.$main.find(".file-name");for(const f of t)s.append($("<option>").val(f.formatID).text(f.nameWithExtensions));l&&c.val(n);const r=()=>{const f=s.val();for(const g of t)if(g.formatID===f)return g},d=()=>{const f=(l?String(c.val()):n).match(/\.([\w\d]+)$/);if(f){const g=r(),x=f[1].toLowerCase();if(g&&g.extensions.includes(x))return;for(const b of t)b.extensions.includes(x)&&s.val(b.formatID)}};l&&c.on("input",d),o&&t.some(f=>f.formatID===o)?s.val(o):d();const h=f=>{if(!l)return;let g=c.val();const x=r();if(!x)return;const b=x.extensions,A=b[0],M=g.replace(/\.(\w{1,3}|apng|jpeg|jfif|tiff|webp|psppalette|sketchpalette|gimp|colors|scss|sass|less|styl|html|theme|themepack)$/i,""),L=M!==g,C=g.slice(M.length+1).toLowerCase();(f||L)&&b.indexOf(C)===-1&&(g=`${M}.${A}`,c.val(g))};s.on("change",()=>{h(!1)}),h(!1);const m=i.$Button(localize("Save"),()=>{i.close(),h(!0),a({newFileName:l?String(c.val()):n,newFileFormatID:String(s.val())})},{type:"submit"});i.$Button(localize("Cancel"),()=>{i.close()}),i.center(),(window.innerWidth<500||window.innerHeight<700)&&i.css({top:20}),l?c.focus().select():m.focus()})}function write_image_file(e,n,o){const t=e.getContext("2d"),l=n.match(/^image\/(?:x-)?bmp\s*(?:-(\d+)bpp)?/);if(l){const a=encodeBMP(t.getImageData(0,0,e.width,e.height),parseInt(l[1]||"24",10)),i=new Blob([a]);sanity_check_blob(i,()=>{o(i)})}else if(n==="image/png"){const a=t.getImageData(0,0,e.width,e.height),i=UPNG.encode([a.data.buffer],a.width,a.height),s=new Blob([i]);sanity_check_blob(s,()=>{o(s)})}else if(n==="image/tiff"){const a=t.getImageData(0,0,e.width,e.height),i={t305:["jspaint (UTIF.js)"]},s=UTIF.encodeImage(a.data.buffer,a.width,a.height,i),c=new Blob([s]);sanity_check_blob(c,()=>{o(c)})}else e.toBlob(a=>{sanity_check_blob(a,()=>{o(a)},[137,80,78,71,13,10,26,10],n==="image/png")},n)}function read_image_file(e,n){let o,t,l=!1;e.arrayBuffer().then(a=>{var M,L;const i={png:[137,80,78,71,13,10,26,10],bmp:[66,77],jpeg:[255,216,255],gif:[71,73,70,56],webp:[87,69,66,80],tiff_be:[77,77,0,42],tiff_le:[73,73,42,0],ico:[0,0,1,0],cur:[0,0,2,0],icns:[105,99,110,115]},s=new Uint8Array(a);let c;for(const[C,u]of Object.entries(i))u.every((y,v)=>y===s[v])&&(c=C);if(c||String.fromCharCode(...s.slice(0,1024)).includes("%PDF")&&(c="pdf"),c==="bmp"){const{colorTable:C,bitsPerPixel:u,imageData:_}=decodeBMP(a);o=u===24?"image/bmp":`image/bmp;bpp=${u}`,C.length>=2&&(C.length===2?(t=make_monochrome_palette(...C.map(y=>[y.r,y.g,y.b,255])),l=!0):(t=C.map(y=>`rgb(${y.r}, ${y.g}, ${y.b})`),l=!1)),n(null,{file_format:o,monochrome:l,palette:t,image_data:_,source_blob:e})}else if(c==="png"){const C=UPNG.decode(a),u=UPNG.toRGBA8(C)[0],{width:_,height:y,tabs:v,ctype:T}=C;if(v.PLTE&&v.PLTE.length>=3*2&&T===3)if(v.PLTE.length===3*2)t=make_monochrome_palette([...v.PLTE.slice(0,3),((M=v.tRNS)==null?void 0:M[0])??255],[...v.PLTE.slice(3,6),((L=v.tRNS)==null?void 0:L[1])??255]),l=!0;else{t=new Array(v.PLTE.length/3);for(let P=0;P<t.length;P++)v.tRNS&&v.tRNS.length>=P+1?t[P]=`rgba(${v.PLTE[P*3+0]}, ${v.PLTE[P*3+1]}, ${v.PLTE[P*3+2]}, ${v.tRNS[P]/255})`:t[P]=`rgb(${v.PLTE[P*3+0]}, ${v.PLTE[P*3+1]}, ${v.PLTE[P*3+2]})`;l=!1}o="image/png";const k=new ImageData(new Uint8ClampedArray(u),_,y);n(null,{file_format:o,monochrome:l,palette:t,image_data:k,source_blob:e})}else if(c==="tiff_be"||c==="tiff_le"){var r=UTIF.decode(a),d=r,h=0,m=d[0];r[0].subIFD&&(d=d.concat(r[0].subIFD));for(var f=0;f<d.length;f++){var g=d[f];if(!(g.t258==null||g.t258.length<3)){var x=g.t256*g.t257;x>h&&(h=x,m=g)}}UTIF.decodeImage(a,m,r);var b=UTIF.toRGBA8(m),A=new ImageData(new Uint8ClampedArray(b.buffer),m.width,m.height);o="image/tiff",n(null,{file_format:o,monochrome:l,palette:t,image_data:A,source_blob:e})}else if(c==="pdf"){o="application/pdf",pdfjs$1.GlobalWorkerOptions.workerSrc="lib/pdf.js/build/pdf.worker.js";const C=new Uint8Array(a);pdfjs$1.getDocument({data:C,cMapUrl:"lib/pdf.js/web/cmaps/",cMapPacked:!0}).promise.then(_=>{console.log("PDF loaded");var y=1;_.getPage(y).then(v=>{console.log("Page loaded");var T=1.5,k=v.getViewport({scale:T}),P=make_canvas(k.width,k.height),S={canvasContext:P.ctx,viewport:k},F=v.render(S);F.promise.then(()=>{console.log("Page rendered");const K=P.ctx.getImageData(0,0,P.width,P.height);n(null,{file_format:o,monochrome:l,palette:t,image_data:K,source_blob:e})})})},_=>{n(new Error(`Failed to load PDF. ${_}`))})}else{l=!1,o={png:"image/png",webp:"image/webp",jpeg:"image/jpeg",gif:"image/gif",tiff_be:"image/tiff",tiff_le:"image/tiff",ico:"image/x-icon",cur:"image/x-win-bitmap",icns:"image/icns"}[c]||e.type;const C=URL.createObjectURL(e),u=new Image,_=()=>{URL.revokeObjectURL(C),e.text().then(y=>{const v=new Error("failed to decode blob as an image");v.code=y.match(/^\s*<!doctype\s+html/i)?"html-not-image":"decoding-failure",n(v)},y=>{const v=new Error("failed to decode blob as image or text");v.code="decoding-failure",n(v)})};u.onload=()=>{if(URL.revokeObjectURL(C),!u.complete||typeof u.naturalWidth>"u"||u.naturalWidth===0){_();return}n(null,{file_format:o,monochrome:l,palette:t,image:u,source_blob:e})},u.onerror=_,u.src=C}},a=>{n(a)})}function update_from_saved_file(e){read_image_file(e,(n,o)=>{if(n){show_error_message$1("The file has been saved, however... "+localize("Paint cannot read this file."),n);return}apply_file_format_and_palette_info(o);const t=image_formats.find(({mimeType:l})=>l===o.file_format);undoable({name:`${localize("Save As")} ${t?t.name:o.file_format}`,icon:get_help_folder_icon("p_save.png"),assume_saved:!0},()=>{main_ctx.copy(o.image||o.image_data)})})}function save_selection_to_file(){selection&&selection.canvas&&systemHooks.showSaveFileDialog({dialogTitle:localize("Save As"),defaultFileName:"selection.png",defaultFileFormatID:"image/png",formats:image_formats,getBlob:e=>new Promise(n=>{write_image_file(selection.canvas,e,o=>{n(o)})})})}function sanity_check_blob(e,n,o,t=!0){e.size>0?o?e.arrayBuffer().then(l=>{const a=new Uint8Array(l);o.every((s,c)=>s===a[c])===t?n():showMessageBox$1({message:window.is_electron_app?"Writing images in this file format is not supported.":"Your browser does not support writing images in this file format.",iconID:"error"})},l=>{show_error_message$1(localize("An unknown error has occurred."),l)}):n():show_error_message$1(localize("Failed to save document."))}window.make_history_node=make_history_node;window.open_from_file=open_from_file;window.are_you_sure=are_you_sure$1;window.show_error_message=show_error_message$1;window.show_about_paint=show_about_paint;window.exit_fullscreen_if_ios=exit_fullscreen_if_ios$1;window.get_tool_by_id=get_tool_by_id;window.make_monochrome_palette=make_monochrome_palette;window.sanity_check_blob=sanity_check_blob;console.log("JS 실행:","$Component.js");function get_segments(e,n,o){return $(e).find(".component").not(o).toArray().map(l=>{const a={element:l};return n==="top"?(a.pos=l.offsetTop,a.length=l.clientHeight):n==="left"?(a.pos=l.offsetLeft,a.length=l.clientWidth):n==="right"&&(a.pos=e.scrollWidth-l.offsetLeft,a.length=l.clientWidth),a})}function adjust_segments(e,n){e.sort((o,t)=>o.pos-t.pos);for(const o of e)o.pos=Math.max(o.pos,0),o.pos=Math.min(o.pos,n-o.length);for(let o=1;o<e.length;o++){const t=e[o],l=e[o-1],a=l.pos+l.length-t.pos;a>0&&(t.pos+=a)}for(const o of e)o.pos=Math.max(o.pos,0),o.pos=Math.min(o.pos,n-o.length);for(let o=e.length-2;o>=0;o--){const t=e[o],l=e[o+1],a=t.pos+t.length-l.pos;a>0&&(t.pos-=a)}}function apply_segments(e,n,o){let t=0;for(const l of o)l.margin_before=l.pos-t,t=l.length+l.pos;for(const l of o)e.appendChild(l.element),$(l.element).css(`margin-${n}`,l.margin_before)}function $Component(e,n,o,t){const l=$(E("div")).addClass("component");l.addClass(n),l.addClass(o),l.append(t),l.css("touch-action","none");const a=$ToolWindow(l);a.title(e),a.hide(),a.$content.addClass({tall:"vertical",wide:"horizontal"}[o]),n==="colors-component"&&o==="wide"&&(l.css("position","relative"),l.css(`margin-${get_direction()==="rtl"?"right":"left"}`,"3px"));let i;$("body").hasClass("eye-gaze-mode")&&(i=setInterval(()=>{l.css({transform:"scale(3)",transformOrigin:"0 0",marginRight:l[0].scrollWidth*2,marginBottom:l[0].scrollHeight*2})},200));let s,c,r,d,h,m,f=0,g,x,b,A,M;o==="tall"?g="top":get_direction()==="rtl"?g="right":g="left";const L=k=>{a.hide();const P=get_segments(k[0],g,l[0]);k.append(l),P.push({element:l[0],pos:f,length:l[0][g==="top"?"clientHeight":"clientWidth"]});const S=g==="top"?k.height():k.width();adjust_segments(P,S),apply_segments(k[0],g,P),b=k,x=f},C=(k,P)=>{const S=l.closest(".component-area")[0],F=get_segments(S,g,l[0]);l.css("position","relative"),l.css(`margin-${g}`,""),a.$content.append(l),a.show(),a.css({left:k,top:P});const K=g==="top"?$(S).height():$(S).width();adjust_segments(F,K),apply_segments(S,g,F)};a.on("window-drag-start",k=>{k.preventDefault()});const u=()=>{const k=a.is(":visible");a.show();let P,{offsetLeft:S,offsetTop:F}=l[0];if(l.closest(".tool-window").length==0){const Z=getComputedStyle(l[0]);P=$(E("div")).addClass("component").css({width:Z.width,height:Z.height}),a.append(P),{offsetLeft:S,offsetTop:F}=P[0]}const K=a[0].getBoundingClientRect();P&&P.remove(),k||a.hide();const Q=getComputedStyle(a[0]);return S+=parseFloat(Q.borderLeftWidth),F+=parseFloat(Q.borderTopWidth),{rect:K,offsetLeft:S,offsetTop:F}},_=(k=g==="top"?$left:$bottom)=>{if(l.closest(".tool-window").length==0)return{rect:l[0].getBoundingClientRect()};const P=getComputedStyle(l[0]),S=$(E("div")).addClass("component").css({width:P.width,height:P.height,flex:"0 0 auto"});k.prepend(S);const F=S[0].getBoundingClientRect();return S&&S.remove(),{rect:F}},y=k=>{const{rect:P}=A?_(A):u();h=~~(P.width/2)*2+1,m=~~(P.height/2)*2+1,M||(M=$(E("div")).addClass("component-ghost dock"),M.appendTo("body"));const S=A?0:3;M.css({position:"absolute",display:"block",width:h-S*2,height:m-S*2,left:k.clientX+(A?s:r)+S,top:k.clientY+(A?c:d)+S}),A?M.addClass("dock"):M.removeClass("dock")};l.add(a.$titlebar).on("pointerdown",k=>{if(k.button!==0||!(l.is(k.target)||$(k.target).closest(a.$titlebar).length>0&&$(k.target).closest("button").length===0)||$("body").hasClass("eye-gaze-mode"))return;const S=_(),F=l[0].getBoundingClientRect();s=F.left-k.clientX,c=F.top-k.clientY,s=-Math.min(Math.max(-s,0),S.rect.width),c=-Math.min(Math.max(-c,0),S.rect.height);const{offsetLeft:K,offsetTop:Q}=u();r=F.left-K-k.clientX,d=F.top-Q-k.clientY,$("body").addClass("dragging"),$("body").css({cursor:"default"}).addClass("cursor-bully"),$G$1.on("pointermove",v),$G$1.one("pointerup",Z=>{$G$1.off("pointermove",v),T(Z),$("body").removeClass("dragging"),$("body").css({cursor:""}).removeClass("cursor-bully"),$canvas.trigger("pointerleave")}),y(k),v(k),k.preventDefault()});const v=k=>{M.css({left:k.clientX+s,top:k.clientY+c}),A=null;const{width:P,height:S}=_().rect,F=k.clientX+s,K=k.clientY+c,Q=F+P,Z=K+S,B=5;if(o==="tall"?(g="top",F-B<$left[0].getBoundingClientRect().right&&(A=$left),Q+B>$right[0].getBoundingClientRect().left&&(A=$right)):(g=get_direction()==="rtl"?"right":"left",K-B<$top[0].getBoundingClientRect().bottom&&(A=$top),Z+B>$bottom[0].getBoundingClientRect().top&&(A=$bottom)),A){const G=A[0].getBoundingClientRect();f=(g==="top"?K:g==="right"?Q:F)-G[g],g==="right"&&(f*=-1)}y(k),k.preventDefault()},T=k=>{a.hide(),l.parent().is(".component-area")&&(b=l.parent(),A&&(x=f)),A?L(A):C(k.clientX+r,k.clientY+d),M==null||M.remove(),M=null,$G$1.trigger("resize")};return l.dock=k=>{f=x??0,L(k??b)},l.undock_to=C,l.show=()=>($(l[0]).show(),$.contains(a[0],l[0])&&a.show(),l),l.hide=()=>(l.add(a).hide(),l),l.toggle=()=>(l.is(":visible")?l.hide():l.show(),l),l.destroy=()=>{a.close(),l.remove(),clearInterval(i)},a.on("close",k=>{k.preventDefault(),a.hide()}),l}console.log("JS 실행:","error-handling-enhanced.js");var old_onerror=window.onerror;window.onerror=function(e,n,o,t,l){try{var a="";l?"stack"in l&&l.stack.indexOf(n)===-1?a=`${e}

URL: ${n}
Line: ${o}
Column: ${t}`:a=l:a=e,show_error_message$1(localize("Internal application error."),a)}catch(i){old_onerror(e,n,o,t,l),console.warn("Error in error handler:",i)}};var old_onunhandledrejection=window.onunhandledrejection,restore_new_onunhandledrejection_tid,new_onunhandledrejection=function(e){window.onunhandledrejection=old_onunhandledrejection,clearTimeout(restore_new_onunhandledrejection_tid),restore_new_onunhandledrejection_tid=setTimeout(function(){window.onunhandledrejection=new_onunhandledrejection},0);try{show_error_message$1(localize("Internal application error.")+`
Unhandled Rejection.`,e.reason)}catch(n){old_onunhandledrejection.call(window,e),console.warn("Error in unhandledrejection handler:",n)}};window.onunhandledrejection=new_onunhandledrejection;console.log("JS 실행:","$ToolBox.js");let theme_dev_blob_url;function $ToolBox(e,n){const o=$(E("div")).addClass("tools"),t=$(E("div")).addClass("tool-options");let l=!1;o.on("pointerleave",()=>{l=!1});const a=$($.map(e,(s,c)=>{const r=$(E("div")).addClass("tool");r.appendTo(o),s.$button=r,r.attr("title",s.name);const d=$(E("span")).addClass("tool-icon");d.appendTo(r);const h=()=>{const m=!theme_dev_blob_url&&((get_theme()==="modern.css"||get_theme()==="modern-dark.css"?window.devicePixelRatio!==1:window.devicePixelRatio>=3||window.devicePixelRatio%1!==0)||$("body").hasClass("eye-gaze-mode"));d.css({display:"block",position:"absolute",left:4,top:4,width:16,height:16,backgroundImage:theme_dev_blob_url?`url(${theme_dev_blob_url})`:"","--icon-index":c.toString()}),d.toggleClass("use-svg",m)};return h(),$G$1.on("theme-load resize",h),r.on("click",m=>{selected_tool===s&&s.deselect?select_tools(return_to_tools):select_tool(s)}),r.on("pointerenter",()=>{const m=()=>{l=!0};if(l)m();else{const f=setTimeout(m,300);r.on("pointerleave",()=>{clearTimeout(f)})}}),r[0]})),i=$Component(localize("Tools"),"tools-component","tall",o.add(t));return i.appendTo(get_direction()==="rtl"?$right:$left),i.update_selected_tool=()=>{a.removeClass("selected"),selected_tools.forEach(s=>{s.$button.addClass("selected")}),t.children().detach(),t.append(selected_tool.$options),t.children().trigger("update"),$canvas.css({cursor:make_css_cursor(...selected_tool.cursor)})},i.update_selected_tool(),i}let dev_theme_tool_icons=!1;try{dev_theme_tool_icons=localStorage.dev_theme_tool_icons==="true"}catch(e){}if(dev_theme_tool_icons){let e=0;$G$1.on("session-update",()=>{e+=1;const n=e;main_canvas.toBlob(o=>{n===e&&(URL.revokeObjectURL(theme_dev_blob_url),theme_dev_blob_url=URL.createObjectURL(o),$G$1.triggerHandler("theme-load"))})})}console.log("JS 실행:","edit-colors.js");let $edit_colors_window,dev_edit_colors=!1;try{dev_edit_colors=localStorage.dev_edit_colors==="true"}catch(e){}dev_edit_colors&&$(()=>{show_edit_colors_window(),$(".define-custom-colors-button").click(),$edit_colors_window.css({left:80,top:50,opacity:.5})});function show_edit_colors_window(e,n){e=e||$colorbox.data("$last_fg_color_button"),n=n||"foreground";const o=e.closest(".palette, .color-box"),t=o.find(".swatch").toArray().indexOf(e[0]),l=selected_colors[n];choose_color(l,a=>{var i;if(e=$(o.find(".swatch")[t]),!e.length){show_error_message$1("Swatch no longer exists.");return}if(monochrome&&(t===0||t===14)){let s=get_rgba_from_color(palette[t]);const c=get_rgba_from_color(a),r=get_rgba_from_color(palette[14-t]),d=detect_monochrome(main_ctx),h=selection&&selection.canvas?detect_monochrome(selection.canvas.ctx):d,m=h.isMonochrome&&h.presentNonTransparentRGBAs.every(f=>d.presentNonTransparentRGBAs.map(g=>g.toString()).includes(f.toString()));if(d.isMonochrome&&h.isMonochrome&&m){const f=(g,x)=>{if(x.length===2&&x.every(A=>`${A}`!=`${s}`)){const A=x.map(M=>Math.abs(M[0]-s[0])+Math.abs(M[1]-s[1])+Math.abs(M[2]-s[2])+Math.abs(M[3]-s[3]));A[0]<A[1]?s=x[0]:s=x[1]}const b=g.getImageData(0,0,g.canvas.width,g.canvas.height);replace_color_globally(b,s[0],s[1],s[2],s[3],c[0],c[1],c[2],c[3]),g.putImageData(b,0,0)};undoable({name:"Recolor",icon:get_help_folder_icon("p_color.png")},()=>{f(main_ctx,d.presentNonTransparentRGBAs),selection&&selection.canvas&&(f(selection.canvas.ctx,h.presentNonTransparentRGBAs),selection.replace_source_canvas(selection.canvas))})}t?palette=make_monochrome_palette(r,c):palette=make_monochrome_palette(c,r),$colorbox.rebuild_palette(),selected_colors.foreground=palette[0],selected_colors.background=palette[14],selected_colors.ternary="",$G$1.triggerHandler("option-changed")}else palette[t]=a,update_$swatch(e,a),selected_colors[n]=a,$G$1.triggerHandler("option-changed"),(i=window.console)==null||i.log(`Updated palette: ${palette.map(()=>"%c█").join("")}`,...palette.map(s=>`color: ${s};`))})}function choose_color(e,n){$edit_colors_window&&$edit_colors_window.close();const o=$DialogWindow(localize("Edit Colors"));o.addClass("edit-colors-window"),$edit_colors_window=o;let t=0,l=50,a=50,i=0;const s=()=>`hsl(${t}deg, ${l}%, ${a}%)`,c=(w,D,U)=>{const[q,j,Y]=rgb_to_hsl(w,D,U);t=q*360,l=j*100,a=Y*100},r=w=>{const[D,U,q]=get_rgba_from_color(w);c(D,U,q)},d=w=>{o.$content.find(".swatch").removeClass("selected"),w.addClass("selected"),r(w[0].dataset.color),w.closest("#custom-colors")&&(i=Math.max(0,L.indexOf(A.find(".swatch.selected")[0]))),B("hslrgb")},h=(w,D)=>{const U=$('<div class="color-grid" tabindex="0">').attr({id:D});for(const J of w){const oe=$Swatch(J);oe.appendTo(U).addClass("inset-deep"),oe.attr("tabindex",-1)}let q=U.find(".swatch:first-child");const j=8,Y=J=>{const oe=U.find(".swatch:focus");if(!oe.length)return;const pe=U.find(".swatch"),me=pe.toArray().indexOf(oe[0]);if(J===-1&&me%j===0||J===1&&me%j===j-1)return;const Ee=me+J,X=$(pe.toArray()[Ee]);X.length&&X.focus()};return U.on("keydown",J=>{J.code==="ArrowRight"&&Y(1),J.code==="ArrowLeft"&&Y(-1),J.code==="ArrowDown"&&Y(+j),J.code==="ArrowUp"&&Y(-j),J.code==="Home"&&U.find(".swatch:first-child").focus(),J.code==="End"&&U.find(".swatch:last-child").focus(),(J.code==="Space"||J.code==="Enter")&&(d(U.find(".swatch:focus")),F())}),U.on("pointerdown",J=>{const oe=$(J.target).closest(".swatch");oe.length&&(d(oe),F())}),U.on("dragstart",J=>{J.preventDefault()}),U.on("focusin",J=>{J.target.closest(".swatch")?q=$(J.target.closest(".swatch")):q.is(":focus")||q.focus(),U.attr("tabindex",-1)}),U.on("focusout",()=>{U.attr("tabindex",0)}),U},m=$('<div class="left-right-split">').appendTo(o.$main),f=$('<div class="left-side">').appendTo(m),g=$('<div class="right-side">').appendTo(m).hide();f.append(`<label for="basic-colors">${render_access_key("&Basic colors:")}</label>`);const x=h(basic_colors,"basic-colors").appendTo(f);f.append(`<label for="custom-colors">${render_access_key("&Custom colors:")}</label>`);const b=[];for(let w=0;w<custom_colors.length;w++){const D=w%2,U=Math.floor(w/2),q=D*8+U;b[q]=custom_colors[w]}const A=h(b,"custom-colors").appendTo(f),M=A.find(".swatch").toArray(),L=[];for(let w=0;w<M.length;w++){const D=Math.floor(w/8),q=w%8*2+D;L[q]=M[w]}const C=$('<button class="define-custom-colors-button" type="button">').html(render_access_key("&Define Custom Colors >>")).appendTo(f).on("click",w=>{w.preventDefault(),g.show(),o.addClass("defining-custom-colors"),C.attr("disabled","disabled"),o.width()>=300&&Z.h.focus(),u()}),u=()=>{(o.width()<300||document.body.classList.contains("eye-gaze-mode"))&&C.removeAttr("disabled")};$(window).on("resize",u);const _=$(`<label for="color-solid-canvas">${render_access_key("Color|S&olid")}</label>`);_.css({position:"absolute",left:10,top:244});const y=make_canvas(175,187),v=make_canvas(10,187),T=make_canvas(58,40),k=make_canvas(5,9);$(T).css({position:"absolute",left:10,top:198});let P=!1,S=!1;const F=()=>{if(!P||S){for(let w=0;w<y.height;w+=6)for(let D=-1;D<y.width;D+=3)y.ctx.fillStyle=`hsl(${D/y.width*360}deg, ${(1-w/y.height)*100}%, 50%)`,y.ctx.fillRect(D,w,3,6);if(!P){const w=~~(t/360*y.width),D=~~((1-l/100)*y.height);y.ctx.fillStyle="black",y.ctx.fillRect(w-1,D-9,3,5),y.ctx.fillRect(w-1,D+5,3,5),y.ctx.fillRect(w-9,D-1,5,3),y.ctx.fillRect(w+5,D-1,5,3)}S=!P}for(let w=-2;w<v.height;w+=6)v.ctx.fillStyle=`hsl(${t}deg, ${l}%, ${(1-w/v.height)*100}%)`,v.ctx.fillRect(0,w,v.width,6);k.ctx.fillStyle=getComputedStyle(o.$content[0]).getPropertyValue("--ButtonText");for(let w=0;w<k.width;w++)k.ctx.fillRect(w,k.width-w-1,1,1+w*2);k.style.position="absolute",k.style.left="215px",k.style.top=`${3+~~((1-a/100)*v.height)}px`,T.ctx.fillStyle=s(),T.ctx.fillRect(0,0,T.width,T.height)};F(),$(y).addClass("rainbow-canvas inset-shallow"),$(v).addClass("luminosity-canvas inset-shallow"),$(T).addClass("result-color-canvas inset-shallow").attr("id","color-solid-canvas");const K=w=>{t=Math.min(1,Math.max(0,w.offsetX/y.width))*360,l=Math.min(1,Math.max(0,1-w.offsetY/y.height))*100,B("hsrgb"),F(),w.preventDefault()};$(y).on("pointerdown",w=>{P=!0,K(w),$(y).on("pointermove",K),w.pointerId!==1234567890&&y.setPointerCapture(w.pointerId)}),$G$1.on("pointerup pointercancel",()=>{$(y).off("pointermove",K),P=!1,F()});const Q=w=>{a=Math.min(1,Math.max(0,1-w.offsetY/v.height))*100,B("lrgb"),F(),w.preventDefault()};$(v).on("pointerdown",w=>{Q(w),$(v).on("pointermove",Q),w.pointerId!==1234567890&&v.setPointerCapture(w.pointerId)}),$G$1.on("pointerup pointercancel",()=>{$(v).off("pointermove",Q)});const Z={};["hsl","rgb"].forEach((w,D)=>{[...w].forEach((U,q)=>{const j={h:"Hu&e:",s:"&Sat:",l:"&Lum:",r:"&Red:",g:"&Green:",b:"Bl&ue:"}[U],Y=document.createElement("input");Y.type="text",Y.classList.add("inset-deep"),Y.dataset.componentLetter=U,Y.dataset.min="0",Y.dataset.max={h:360,s:100,l:100,r:255,g:255,b:255}[U];const J=document.createElement("label");J.innerHTML=render_access_key(j);const oe=22;$(J).css({position:"absolute",left:63+D*80,top:202+q*oe,textAlign:"right",display:"inline-block",width:40,height:20,lineHeight:"20px"}),$(Y).css({position:"absolute",left:106+D*80,top:202+q*oe+(q>1?1:0),width:21,height:14}),g.append(J,Y),Z[U]=Y})}),g.on("input","input",w=>{const D=w.target,U=D.dataset.componentLetter;if(U)if(D.value.match(/^\d+$/)){let q=Number(D.value);if(q<D.dataset.min?(q=D.dataset.min,D.value=q):q>D.dataset.max&&(q=D.dataset.max,D.value=q),"hsl".indexOf(U)>-1){switch(U){case"h":t=q;break;case"s":l=q;break;case"l":a=q;break}B("rgb")}else{let[j,Y,J]=get_rgba_from_color(s());const oe={r:j,g:Y,b:J};oe[U]=q,c(oe.r,oe.g,oe.b),B("hsl")}F()}else D.value.length&&(B(U),D.select())}),g.on("focusout","input",w=>{const D=w.target,U=D.dataset.componentLetter;U&&(D.value.match(/^\d+$/)||(B(U),D.select()))}),o.on("keydown",w=>{if(w.code==="Enter"&&!w.altKey&&!w.ctrlKey&&!w.metaKey&&!w.shiftKey&&!w.target.closest("button")){n(s()),o.close(),w.preventDefault(),w.stopPropagation();return}if(w.altKey&&!w.ctrlKey&&!w.metaKey&&!w.shiftKey)switch(w.key){case"o":r(s()),B("hslrgb"),F();break;case"b":x.find(".swatch.selected, .swatch").focus();break;case"c":x.find(".swatch.selected, .swatch").focus();break;case"e":Z.h.focus();break;case"s":Z.s.focus();break;case"l":Z.l.focus();break;case"r":Z.r.focus();break;case"g":Z.g.focus();break;case"u":Z.b.focus();break;case"a":G.is(":visible")&&G.click();break;case"d":C.click();break;default:return}else return;w.preventDefault(),w.stopPropagation()});const B=w=>{for(const D of w){const U=Z[D],[q,j,Y]=get_rgba_from_color(s());U.value=Math.floor({h:t,s:l,l:a,r:q,g:j,b:Y}[D])}};g.append(y,v,T,_,k);const G=$('<button class="add-to-custom-colors-button" type="button">').html(render_access_key("&Add To Custom Colors")).appendTo(g).on("click",w=>{w.preventDefault();const D=s();custom_colors[i]=D,update_$swatch($(L[i]),D),i=(i+1)%custom_colors.length,o.removeClass("defining-custom-colors")});o.$Button(localize("OK"),()=>{n(s()),o.close()},{type:"submit"}),o.$Button(localize("Cancel"),()=>{o.close()}),f.append(o.$buttons);for(const w of f.find(".swatch").toArray())if(get_rgba_from_color(w.dataset.color).join(",")===get_rgba_from_color(e).join(",")){d($(w)),w.focus();break}i=Math.max(0,L.indexOf(A.find(".swatch.selected")[0])),o.find(".swatch:focus").length===0&&o.find(".swatch").first().focus(),r(e),B("hslrgb"),o.center()}console.log("JS 실행:","$ColorBox.js");function $Swatch(e){const n=$(E("div")).addClass("swatch"),o=make_canvas();return $(o).css({pointerEvents:"none"}).appendTo(n),$G$1.on("theme-load",()=>{update_$swatch(n)}),n.data("swatch",e),update_$swatch(n,e),n}function update_$swatch(e,n){if(n instanceof CanvasPattern)e.addClass("pattern"),e[0].dataset.color="";else if(typeof n=="string")e.removeClass("pattern"),e[0].dataset.color=n;else if(n!==void 0)throw new TypeError(`argument to update_$swatch must be CanvasPattern or string (or undefined); got type ${typeof n}`);n=n||e.data("swatch"),e.data("swatch",n);const o=e.find("canvas")[0];requestAnimationFrame(()=>{o.width=e.innerWidth(),o.height=e.innerHeight(),n&&(o.ctx.fillStyle=n,o.ctx.fillRect(0,0,o.width,o.height))})}function $ColorBox(e){const n=$(E("div")).addClass("color-box"),o=$Swatch(selected_colors.ternary).addClass("current-colors"),t=$(E("div")).addClass("palette");n.append(o,t);const l=$Swatch(selected_colors.foreground).addClass("color-selection foreground-color"),a=$Swatch(selected_colors.background).addClass("color-selection background-color");o.append(a,l),$G$1.on("option-changed",()=>{update_$swatch(l,selected_colors.foreground),update_$swatch(a,selected_colors.background),update_$swatch(o,selected_colors.ternary)}),o.on("pointerdown",()=>{const r=selected_colors.foreground;selected_colors.foreground=selected_colors.background,selected_colors.background=r,$G$1.triggerHandler("option-changed")});const i=r=>{const d=$Swatch(r).addClass("color-button");d.appendTo(t);const h=400;let m=!1,f=null,g;d.on("pointerdown",x=>{button===0&&c.data("$last_fg_color_button",d);const b=x.ctrlKey?"ternary":x.button===0?"foreground":x.button===2?"background":null;b&&(m&&x.button===f?show_edit_colors_window(d,b):(selected_colors[b]=d.data("swatch"),$G$1.trigger("option-changed")),clearTimeout(g),g=setTimeout(()=>{m=!1,f=null},h),m=!0,f=x.button)})},s=()=>{t.empty(),palette.forEach(i);const r=t.find(".color-button");if(e){const d=r.outerHeight()+parseFloat(getComputedStyle(r[0]).getPropertyValue("margin-top"))+parseFloat(getComputedStyle(r[0]).getPropertyValue("margin-bottom"));t.height(Math.ceil(palette.length/2)*d)}else{const d=r.outerWidth()+parseFloat(getComputedStyle(r[0]).getPropertyValue("margin-left"))+parseFloat(getComputedStyle(r[0]).getPropertyValue("margin-right"));t.width(Math.ceil(palette.length/2)*d)}c.data("$last_fg_color_button",t.find(".color-button:first-child"))};let c;return e?(c=$Component(localize("Colors"),"colors-component","tall",n),c.appendTo(get_direction()==="rtl"?$left:$right)):(c=$Component(localize("Colors"),"colors-component","wide",n),c.appendTo($bottom)),s(),$(window).on("theme-change",s),c=c,c.rebuild_palette=s,c}console.log("JS 실행:","menus.js");const looksLikeChrome=!!(window.chrome&&(window.chrome.loadTimes||window.chrome.csi)),menus={[localize("&File")]:[{label:localize("&New"),...shortcut(window.is_electron_app?"Ctrl+N":"Ctrl+Alt+N"),speech_recognition:["new","new file","new document","create new document","create a new document","start new document","start a new document"],action:()=>{file_new()},description:localize("Creates a new document.")},{label:localize("&Open"),...shortcut("Ctrl+O"),speech_recognition:["open","open document","open file","open an image file","open a document","open a file","load document","load a document","load an image file","load an image","show file picker","show file chooser","show file browser","show finder","browser for file","browse for a file","browse for an image","browse for an image file"],action:()=>{file_open()},description:localize("Opens an existing document.")},{label:localize("&Save"),...shortcut("Ctrl+S"),speech_recognition:["save","save document","save file","save image","save picture","save image file","save the document","save the file","save the image","save the image file","download","download document","download file","download image","download picture","download image file","download the document","download the file","download the image","download the image file"],action:()=>{file_save()},description:localize("Saves the active document.")},{label:localize("Save &As"),...shortcut("Ctrl+Shift+S"),speech_recognition:["save as","save as a new file","save as a new picture","save as a new image","save a new file","save new file","save a new document","save a new image file","save a new image","save a new picture","save as a copy","save a copy","save as copy","save under a new name","save with a new name","save document as a copy","save document copy","save document as copy","save document under a new name","save document with a new name","save image as a copy","save image copy","save image as copy","save image under a new name","save image with a new name","save file as a copy","save file copy","save file as copy","save file under a new name","save file with a new name","save image file as a copy","save image file copy","save image file as copy","save image file under a new name","save image file with a new name"],action:()=>{file_save_as()},description:localize("Saves the active document with a new name.")},MENU_DIVIDER,{label:localize("&Load From URL"),speech_recognition:["load from url","load from a url","load from address","load from an address","load from a web address","load an image from a URL","load an image from an address","load an image from a web address","load image from a URL","load image from an address","load image from a web address","load an image from URL","load an image from address","load an image from web address","load image from URL","load image from address","load image from web address","load an picture from a URL","load an picture from an address","load an picture from a web address","load picture from a URL","load picture from an address","load picture from a web address","load an picture from URL","load an picture from address","load an picture from web address","load picture from URL","load picture from address","load picture from web address"],action:()=>{file_load_from_url()},description:localize("Opens an image from the web.")},{label:localize("&Upload To Imgur"),speech_recognition:["upload to imgur","upload image to imgur","upload picture to imgur"],action:()=>{deselect(),main_canvas.toBlob(e=>{sanity_check_blob(e,()=>{show_imgur_uploader(e)})})},description:localize("Uploads the active document to Imgur")},MENU_DIVIDER,{label:localize("Print Pre&view"),speech_recognition:["preview print","print preview","show print preview","show preview of print"],action:()=>{file_print()},description:localize("Prints the active document and sets printing options.")},{label:localize("Page Se&tup"),speech_recognition:["setup page for print","setup page for printing","set-up page for print","set-up page for printing","set up page for print","set up page for printing","page setup","printing setup","page set-up","printing set-up","page set up","printing set up"],action:()=>{file_print()},description:localize("Prints the active document and sets printing options.")},{label:localize("&Print"),...shortcut("Ctrl+P"),speech_recognition:["print","send to printer","show print dialog","print page","print image","print picture","print drawing","print out page","print out image","print out picture","print out drawing","print out the page","print out the image","print out the picture","print out the drawing","send page to printer","send image to printer","send picture to printer","send drawing to printer","send page to the printer","send image to the printer","send picture to the printer","send drawing to the printer","send the page to the printer","send the image to the printer","send the picture to the printer","send the drawing to the printer","send the page to printer","send the image to printer","send the picture to printer","send the drawing to printer"],action:()=>{file_print()},description:localize("Prints the active document and sets printing options.")},MENU_DIVIDER,{emoji_icon:"🌍",label:localize("&Language"),submenu:available_languages.map(e=>({emoji_icon:get_language_emoji(e),label:get_language_endonym(e),action:()=>{set_language(e)},enabled:()=>get_language()!=e,description:localize("Changes the language to %1.",get_iso_language_name(e))}))},{label:localize("&About Paint"),speech_recognition:["about paint","about js paint","about jspaint","show about window","open about window","about window","app info","about the app","app information","information about the app","application info","about the application","application information","information about the application","who made this","who did this","who did this xd"],action:()=>{show_about_paint()},description:localize("Displays information about this application.")},MENU_DIVIDER,{label:localize("Recent File"),enabled:!1,description:localize("")},MENU_DIVIDER,{label:localize("E&xit"),...shortcut(window.is_electron_app?"Alt+F4":""),speech_recognition:["exit application","exit paint","close paint window"],action:()=>{are_you_sure$1(()=>{try{if(frameElement&&window.close&&!/\{\s*\[native code\]\s*\}/.test(window.close.toString())||window.is_electron_app){window.close();return}}catch{}window.location="https://98.js.org/"})},description:localize("Quits Paint.")}],[localize("&Edit")]:[{label:localize("&Undo"),...shortcut("Ctrl+Z"),speech_recognition:["undo","undo that"],enabled:()=>undos.length>=1,action:()=>{undo()},description:localize("Undoes the last action.")},{label:localize("&Repeat"),...shortcut("F4"),speech_recognition:["repeat","redo"],enabled:()=>redos.length>=1,action:()=>{redo()},description:localize("Redoes the previously undone action.")},MENU_DIVIDER,{label:localize("Cu&t"),...shortcut("Ctrl+X"),speech_recognition:["cut","cut selection","cut selection to clipboard","cut the selection","cut the selection to clipboard","cut the selection to the clipboard"],enabled:()=>!!selection,action:()=>{edit_cut(!0)},description:localize("Cuts the selection and puts it on the Clipboard.")},{label:localize("&Copy"),...shortcut("Ctrl+C"),speech_recognition:["copy","copy selection","copy selection to clipboard","copy the selection","copy the selection to clipboard","copy the selection to the clipboard"],enabled:()=>!!selection,action:()=>{edit_copy(!0)},description:localize("Copies the selection and puts it on the Clipboard.")},{label:localize("&Paste"),...shortcut("Ctrl+V"),speech_recognition:["paste","paste from clipboard","paste from the clipboard","insert clipboard","insert clipboard contents","insert the contents of the clipboard","paste what's on the clipboard"],enabled:()=>!0,action:()=>{edit_paste(!0)},description:localize("Inserts the contents of the Clipboard.")},{label:localize("C&lear Selection"),...shortcut("Del"),speech_recognition:["delete","clear selection","delete selection","delete selected","delete selected area","clear selected area","erase selected","erase selected area"],enabled:()=>!!selection,action:()=>{delete_selection()},description:localize("Deletes the selection.")},{label:localize("Select &All"),...shortcut("Ctrl+A"),speech_recognition:["select all","select everything","select the whole image","select the whole picture","select the whole drawing","select the whole canvas","select the whole document","select the entire image","select the entire picture","select the entire drawing","select the entire canvas","select the entire document"],action:()=>{select_all()},description:localize("Selects everything.")},MENU_DIVIDER,{label:`${localize("C&opy To")}...`,speech_recognition:["copy to file","copy selection to file","copy selection to a file","save selection","save selection as file","save selection as image","save selection as picture","save selection as image file","save selection as document","save selection as a file","save selection as a image","save selection as a picture","save selection as a image file","save selection as a document","save selection to file","save selection to image","save selection to picture","save selection to image file","save selection to document","save selection to a file","save selection to a image","save selection to a picture","save selection to a image file","save selection to a document"],enabled:()=>!!selection,action:()=>{save_selection_to_file()},description:localize("Copies the selection to a file.")},{label:`${localize("Paste &From")}...`,speech_recognition:["paste a file","paste from a file","insert a file","insert an image file"],action:()=>{choose_file_to_paste()},description:localize("Pastes a file into the selection.")}],[localize("&View")]:[{label:localize("&Tool Box"),...shortcut(window.is_electron_app?"Ctrl+T":""),speech_recognition:["toggle tool box","toggle tools box","toggle toolbox","toggle tool palette","toggle tools palette"],checkbox:{toggle:()=>{$toolbox.toggle()},check:()=>$toolbox.is(":visible")},description:localize("Shows or hides the tool box.")},{label:localize("&Color Box"),...shortcut("Ctrl+L"),speech_recognition:["toggle color box","toggle colors box","toggle palette","toggle color palette","toggle colors palette"],checkbox:{toggle:()=>{$colorbox.toggle()},check:()=>$colorbox.is(":visible")},description:localize("Shows or hides the color box.")},{label:localize("&Status Bar"),speech_recognition:["toggle status bar","toggle status text","toggle status area","toggle status indicator"],checkbox:{toggle:()=>{$status_area.toggle()},check:()=>$status_area.is(":visible")},description:localize("Shows or hides the status bar.")},{label:localize("T&ext Toolbar"),speech_recognition:["toggle text toolbar","toggle font toolbar","toggle text tool bar","toggle font tool bar","toggle font box","toggle fonts box","toggle text options box","toggle text tool options box","toggle font options box","toggle font window","toggle fonts window","toggle text options window","toggle text tool options window","toggle font options window"],enabled:!1,checkbox:{toggle:()=>{},check:()=>!1},description:localize("Shows or hides the text toolbar.")},MENU_DIVIDER,{label:localize("&Zoom"),submenu:[{label:localize("&Normal Size"),...shortcut(window.is_electron_app?"Ctrl+PgUp":""),speech_recognition:["reset zoom","zoom to normal size","zoom to 100%","set zoom to 100%","set zoom 100%","zoom to 1x","set zoom to 1x","set zoom 1x","zoom level to 100%","set zoom level to 100%","set zoom level 100%","zoom level to 1x","set zoom level to 1x","set zoom level 1x"],description:localize("Zooms the picture to 100%."),enabled:()=>magnification!==1,action:()=>{set_magnification(1)}},{label:localize("&Large Size"),...shortcut(window.is_electron_app?"Ctrl+PgDn":""),speech_recognition:["zoom to large size","zoom to 400%","set zoom to 400%","set zoom 400%","zoom to 4x","set zoom to 4x","set zoom 4x","zoom level to 400%","set zoom level to 400%","set zoom level 400%","zoom level to 4x","set zoom level to 4x","set zoom level 4x"],description:localize("Zooms the picture to 400%."),enabled:()=>magnification!==4,action:()=>{set_magnification(4)}},{label:localize("Zoom To &Window"),speech_recognition:["zoom to window","zoom to view","zoom to fit","zoom to fit within window","zoom to fit within view","zoom to fit within the window","zoom to fit within the view","zoom to fit in window","zoom to fit in view","zoom to fit in the window","zoom to fit in the view","auto zoom","fit zoom","zoom to max","zoom to maximum","zoom to max size","zoom to maximum size","zoom so canvas fits","zoom so picture fits","zoom so image fits","zoom so document fits","zoom so whole canvas is visible","zoom so whole picture is visible","zoom so whole image is visible","zoom so whole document is visible","zoom so the whole canvas is visible","zoom so the whole picture is visible","zoom so the whole image is visible","zoom so the whole document is visible","fit to window","fit to view","fit in window","fit in view","fit within window","fit within view","fit picture to window","fit picture to view","fit picture in window","fit picture in view","fit picture within window","fit picture within view","fit image to window","fit image to view","fit image in window","fit image in view","fit image within window","fit image within view","fit canvas to window","fit canvas to view","fit canvas in window","fit canvas in view","fit canvas within window","fit canvas within view","fit document to window","fit document to view","fit document in window","fit document in view","fit document within window","fit document within view"],description:localize("Zooms the picture to fit within the view."),action:()=>{const e=$canvas_area[0].getBoundingClientRect(),n=30;let o=Math.min((e.width-n)/main_canvas.width,(e.height-n)/main_canvas.height);o=Math.floor(100*o)/100,set_magnification(o)}},MENU_DIVIDER,{label:localize("Show &Grid"),...shortcut("Ctrl+G"),speech_recognition:["toggle show grid","toggle grid","toggle gridlines","toggle grid lines","toggle grid cells"],enabled:()=>magnification>=4,checkbox:{toggle:()=>{toggle_grid()},check:()=>show_grid},description:localize("Shows or hides the grid.")},{label:localize("Show T&humbnail"),speech_recognition:["toggle show thumbnail","toggle thumbnail","toggle thumbnail view","toggle thumbnail box","toggle thumbnail window","toggle preview","toggle image preview","toggle picture preview","toggle picture in picture","toggle picture in picture view","toggle picture in picture box","toggle picture in picture window"],checkbox:{toggle:()=>{toggle_thumbnail()},check:()=>show_thumbnail},description:localize("Shows or hides the thumbnail view of the picture.")}]},{label:localize("&View Bitmap"),...shortcut("Ctrl+F"),speech_recognition:["view bitmap","show bitmap","fullscreen","full-screen","full screen","show picture fullscreen","show picture full-screen","show picture full screen","show image fullscreen","show image full-screen","show image full screen"],action:()=>{view_bitmap()},description:localize("Displays the entire picture.")}],[localize("&Image")]:[{label:localize("&Flip/Rotate"),...shortcut(window.is_electron_app&&!window.electron_is_dev?"Ctrl+R":"Ctrl+Alt+R"),speech_recognition:["flip","rotate","flip/rotate","flip slash rotate","flip and rotate","flip or rotate","flip rotate"],action:()=>{image_flip_and_rotate()},description:localize("Flips or rotates the picture or a selection.")},{label:localize("&Invert Colors"),...shortcut("Ctrl+I"),speech_recognition:["invert","invert colors","invert image","invert picture","invert drawing","invert image colors","invert picture colors","invert drawing colors","invert colors of image","invert colors of picture","invert colors of drawing"],action:()=>{image_invert_colors()},description:localize("Inverts the colors of the picture or a selection.")},{label:`${localize("&Attributes")}...`,...shortcut("Ctrl+E"),speech_recognition:["attributes","image attributes","picture attributes","image options","picture options","dimensions","image dimensions","picture dimensions","resize canvas","resize document","resize page","set image size","set picture size","set canvas size","set document size","set page size","image size","picture size","canvas size","document size","page size","configure image size","configure picture size","configure canvas size","configure document size","configure page size"],action:()=>{image_attributes()},description:localize("Changes the attributes of the picture.")},{label:localize("&Clear Image"),...shortcut(window.is_electron_app||!looksLikeChrome?"Ctrl+Shift+N":""),speech_recognition:["clear image","clear canvas","clear picture","clear page","clear drawing"],action:()=>{selection||clear()},enabled:()=>!selection,description:localize("Clears the picture.")},{label:localize("&Draw Opaque"),speech_recognition:["toggle draw opaque","toggle transparent selection","toggle transparent selections","toggle transparent selection mode","toggle transparent selections mode","toggle opaque selection","toggle opaque selections","toggle opaque selection mode","toggle opaque selections mode"],checkbox:{toggle:()=>{tool_transparent_mode=!tool_transparent_mode,$G$1.trigger("option-changed")},check:()=>!tool_transparent_mode},description:localize("Makes the current selection either opaque or transparent.")}]};for(const[e,n]of Object.entries(menus)){const o=e.replace(/&/,""),t=(l,a)=>{for(const i of l)if(i!==MENU_DIVIDER){const s=i.label.replace(/&|\.\.\.|\(|\)/g,"");let c=[s];/\//.test(s)&&(c=[s,s.replace(/\//," "),s.replace(/\//," and "),s.replace(/\//," or "),s.replace(/\//," slash ")]),c=c.map(r=>`${a} ${r}`),i.speech_recognition=(i.speech_recognition||[]).concat(c),i.submenu&&t(i.submenu,`${a} ${s}`)}};t(n,o)}function shortcut(e){if(!e)return{};const n=e.replace(/Ctrl/g,"Control").replace(/\bDel\b/,"Delete");return validateAriaKeyshortcuts(n)||console.error(`Invalid ARIA key shortcuts: ${JSON.stringify(n)} (from shortcut label: ${JSON.stringify(e)}) (or validator is incomplete)`),{shortcutLabel:e,ariaKeyShortcuts:n}}function validateAriaKeyshortcuts(e){const n=["Alt","Control","Shift","Meta","AltGraph"],o=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","1","2","3","4","5","6","7","8","9","0","Delete","Enter","Tab","ArrowRight","ArrowLeft","ArrowUp","ArrowDown","PageUp","PageDown","End","Home","Escape","Space","Plus","Minus","Comma","Period","Slash","Backslash","Quote","Semicolon","BracketLeft","BracketRight","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"],t=e.split(" ");function l(a){const i=a.split("+");if(i.length===0)return!1;let s=!1;for(let c=0;c<i.length;c++){const r=i[c];if(n.includes(r)){if(s)return!1}else if(o.includes(r)){if(s)return!1;s=!0}else return!1}return s}for(let a=0;a<t.length;a++)if(!l(t[a]))return!1;return!0}const ariaKeyShortcutsTestCases=[["Control+A Shift+Alt+B",!0],["Control+Shift+1",!0],["Shift+Alt+T Control+5",!0],["T",!0],["ArrowLeft",!0],["Shift+T Alt+Control",!1],["T+Shift",!1],["Alt",!1],["IncredibleKey",!1],["Ctrl+Shift+A",!1]];for(const[e,n]of ariaKeyShortcutsTestCases){const o=validateAriaKeyshortcuts(e);o!==n&&console.error(`validateAriaKeyshortcuts("${e}") returned ${o} but expected ${n}`)}console.log("JS 실행:","eye-gaze-mode.js");let clean_up_eye_gaze_mode=()=>{};$G$1.on("eye-gaze-mode-toggled",()=>{$("body").hasClass("eye-gaze-mode")?init_eye_gaze_mode():clean_up_eye_gaze_mode()});$("body").hasClass("eye-gaze-mode")&&init_eye_gaze_mode();const dwell_clicker_config={targets:`
		button:not([disabled]),
		input,
		textarea,
		label,
		a,
		.flip-and-rotate .sub-options .radio-wrapper,
		.current-colors,
		.color-button,
		.edit-colors-window .swatch,
		.edit-colors-window .rainbow-canvas,
		.edit-colors-window .luminosity-canvas,
		.tool:not(.selected),
		.chooser-option,
		.menu-button:not(.active),
		.menu-item,
		.main-canvas,
		.selection canvas,
		.handle,
		.grab-region,
		.window:not(.maximized) .window-titlebar,
		.history-entry
	`,noCenter:e=>e.matches(`
			.main-canvas,
			.selection canvas,
			.window-titlebar,
			.rainbow-canvas,
			.luminosity-canvas,
			input[type="range"]
		`),retarget:[{from:".canvas-area",to:".main-canvas",withinMargin:50},{from:e=>(e.closest(".menu-button")||e.matches(".menu-container"))&&document.querySelector(".menu-button.active")!=null,to:null}],isEquivalentTarget:(e,n)=>e.closest("label")===n||e.closest(".radio-wrapper")===n,dwellClickEvenIfPaused:e=>e.matches(".toggle-dwell-clicking"),shouldDrag:e=>e.matches(".window-titlebar, .window-titlebar *:not(button)")||e.matches(".selection, .selection *, .handle, .grab-region")||e===main_canvas&&selected_tool.id!==TOOL_PICK_COLOR&&selected_tool.id!==TOOL_FILL&&selected_tool.id!==TOOL_MAGNIFIER&&selected_tool.id!==TOOL_POLYGON&&selected_tool.id!==TOOL_CURVE,isHeld:()=>pointer_active,click:({target:e,x:n,y:o})=>{if(e.matches("button:not(.toggle)"))e.style.borderImage="var(--inset-deep-border-image)",setTimeout(()=>{e.style.borderImage="",window.untrusted_gesture=!0,e.click(),window.untrusted_gesture=!1},100);else if(e.matches("input[type='range']")){const l=e.getBoundingClientRect(),a=e.getAttribute("orient")==="vertical"||t(e)!==0||l.height>l.width,i=Number(e.min),s=Number(e.max),c=(a?(o-l.top)/l.height:(n-l.left)/l.width)*(s-i)+i;e.value=c,window.untrusted_gesture=!0,e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})),window.untrusted_gesture=!1}else window.untrusted_gesture=!0,e.click(),e.matches("input, textarea")&&e.focus(),window.untrusted_gesture=!1;function t(l){const a=window.getComputedStyle(l,null),i=a.getPropertyValue("-webkit-transform")||a.getPropertyValue("-moz-transform")||a.getPropertyValue("-ms-transform")||a.getPropertyValue("-o-transform")||a.getPropertyValue("transform")||"none";if(i!=="none"){const[s,c]=i.split("(")[1].split(")")[0].split(",").map(Number);return Math.round(Math.atan2(s,c)*(180/Math.PI))}return 0}},beforeDispatch:()=>{window.untrusted_gesture=!0},afterDispatch:()=>{window.untrusted_gesture=!1},beforePointerDownDispatch(){pointers=[]},afterReleaseDrag(){pointers=[]}};async function init_eye_gaze_mode(){await new Promise(a=>$(a));const e=TrackyMouse.initDwellClicking(dwell_clicker_config),n=$("<div class='eye-gaze-mode-floating-buttons'/>").appendTo("body");$("<button title='Undo' class='eye-gaze-mode-undo-button'/>").on("click",undo).appendTo(n).append($("<div class='button-icon'>"));const o="Pause Dwell Clicking",t="Resume Dwell Clicking",l=$('<button class="toggle-dwell-clicking"/>').attr("title",o).on("click",()=>{e.paused=!e.paused,$("body").toggleClass("eye-gaze-mode-paused",e.paused),l.attr("title",e.paused?t:o)}).appendTo(n).append($("<div class='button-icon'>"));clean_up_eye_gaze_mode=()=>{console.log("Cleaning up / disabling eye gaze mode"),n.remove(),TrackyMouse.cleanupDwellClicking(),clean_up_eye_gaze_mode=()=>{}}}console.log("JS 실행:","app.js");window.update_fill_and_stroke_colors_and_lineWidth=update_fill_and_stroke_colors_and_lineWidth$1;window.tool_go=tool_go;const prependDot=e=>`.${e}`,getMimeType=e=>"mimeType"in e?e.mimeType:`application/x-${e.formatID}`;window.systemHooks=window.systemHooks||{};window.systemHookDefaults={showSaveFileDialog:async({formats:e,defaultFileName:n,defaultPath:o,defaultFileFormatID:t,getBlob:l,savedCallbackUnreliable:a,dialogTitle:i})=>{if(window.showSaveFilePicker&&!window.untrusted_gesture&&enable_fs_access_api){const{newFileFormatID:s}=await save_as_prompt({dialogTitle:i,defaultFileName:n,defaultFileFormatID:t,formats:e,promptForName:!1}),c=e.find(m=>m.formatID===s),r=await l(c&&c.formatID);e=[c];let d,h;try{d=await showSaveFilePicker({types:e.map(x=>({description:x.name,accept:{[getMimeType(x)]:x.extensions.map(prependDot)}}))}),h=d.name;const m=get_file_extension(h),f=async x=>{const b=await showMessageBox$1({message:`${x}

Try adding .${c.extensions[0]} to the name. Sorry about this.`,iconID:"error",buttons:[{label:localize("Save As"),value:"show-save-as-dialog-again",default:!0},{label:localize("Save"),value:"save-without-extension"},{label:localize("Cancel"),value:"cancel"}]});if(b==="show-save-as-dialog-again")return window.systemHookDefaults.showSaveFileDialog({formats:e,defaultFileName:n,defaultPath:o,defaultFileFormatID:t,getBlob:l,savedCallbackUnreliable:a,dialogTitle:i});if(b==="save-without-extension"){const A=await d.createWritable();await A.write(r),await A.close(),a==null||a({newFileName:h,newFileFormatID:c&&c.formatID,newFileHandle:d,newBlob:r})}};if(!m)return await f(`'${h}' doesn't have an extension.`);if(!c.extensions.includes(m))return await f(`File extension '.${m}' does not match the selected file type ${c.name}.`);const g=await d.createWritable();await g.write(r),await g.close()}catch(m){if(m.name==="AbortError")return;if(m.message.match(/gesture|activation/)){show_error_message$1("Sorry, due to browser security measures, you must use the keyboard or mouse directly to save.");return}show_error_message$1(localize("Failed to save document."),m);return}a==null||a({newFileName:h,newFileFormatID:c&&c.formatID,newFileHandle:d,newBlob:r})}else{const{newFileName:s,newFileFormatID:c}=await save_as_prompt({dialogTitle:i,defaultFileName:n,defaultFileFormatID:t,formats:e}),r=await l(c);saveAs(r,s),a==null||a({newFileName:s,newFileFormatID:c,newFileHandle:null,newBlob:r})}},showOpenFileDialog:async({formats:e})=>{if(window.untrusted_gesture)throw show_error_message$1("Sorry, a file picker cannot be shown when using Speech Recognition or Eye Gaze Mode. You must click File > Open directly with the mouse, or press Ctrl+O on the keyboard."),new Error("can't show file picker reliably");if(window.showOpenFilePicker&&enable_fs_access_api){const[n]=await window.showOpenFilePicker({types:e.map(t=>({description:t.name,accept:{[getMimeType(t)]:t.extensions.map(prependDot)}}))});return{file:await n.getFile(),fileHandle:n}}else return new Promise(n=>{const o=$("<input type='file'>").on("change",()=>{n({file:o[0].files[0]}),o.remove()}).appendTo($app$1).hide().trigger("click")})},writeBlobToHandle:async(e,n)=>{if(e&&e.createWritable&&enable_fs_access_api){if(!await confirm_overwrite_capability())return!1;try{const t=await e.createWritable();return await t.write(n),await t.close(),!0}catch(t){if(t.name==="AbortError")return!1;if(t.name==="NotAllowedError")return show_error_message$1(localize("Save was interrupted, so your file has not been saved."),t),!1;if(t.name==="SecurityError"){saveAs(n,file_name);return}}}else{saveAs(n,file_name);return}},readBlobFromHandle:async e=>{if(e&&e.getFile)return await e.getFile();throw new Error(`Unknown file handle (${e})`)},setWallpaperTiled:e=>{const n=make_canvas(screen.width,screen.height),o=n.ctx.createPattern(e,"repeat");n.ctx.fillStyle=o,n.ctx.fillRect(0,0,n.width,n.height),systemHooks.setWallpaperCentered(n)},setWallpaperCentered:e=>{systemHooks.showSaveFileDialog({dialogTitle:localize("Save As"),defaultFileName:`${file_name.replace(/\.(bmp|dib|a?png|gif|jpe?g|jpe|jfif|tiff?|webp|raw)$/i,"")} wallpaper.png`,defaultFileFormatID:"image/png",formats:image_formats,getBlob:n=>new Promise(o=>{write_image_file(e,n,t=>{o(t)})})})}};for(const[e,n]of Object.entries(window.systemHookDefaults))window.systemHooks[e]=window.systemHooks[e]||n;const update_from_url_params=()=>{location.hash.match(/eye-gaze-mode/i)?$("body").hasClass("eye-gaze-mode")||($("body").addClass("eye-gaze-mode"),$G$1.triggerHandler("eye-gaze-mode-toggled"),$G$1.triggerHandler("theme-load")):$("body").hasClass("eye-gaze-mode")&&($("body").removeClass("eye-gaze-mode"),$G$1.triggerHandler("eye-gaze-mode-toggled"),$G$1.triggerHandler("theme-load")),location.hash.match(/vertical-color-box-mode|eye-gaze-mode/i)?$("body").hasClass("vertical-color-box-mode")||($("body").addClass("vertical-color-box-mode"),$G$1.triggerHandler("vertical-color-box-mode-toggled"),$G$1.triggerHandler("theme-load")):$("body").hasClass("vertical-color-box-mode")&&($("body").removeClass("vertical-color-box-mode"),$G$1.triggerHandler("vertical-color-box-mode-toggled"),$G$1.triggerHandler("theme-load")),$("body").toggleClass("compare-reference",!!location.hash.match(/compare-reference/i)),$("body").toggleClass("compare-reference-tool-windows",!!location.hash.match(/compare-reference-tool-windows/i)),setTimeout(()=>{if(location.hash.match(/compare-reference/i)){select_tool(get_tool_by_id(TOOL_SELECT));const e=576,n=432;(main_canvas.width!==e||main_canvas.height!==n)&&resize_canvas_without_saving_dimensions(e,n),location.hash.match(/compare-reference-tool-windows/i)||($toolbox$1.dock($left$1),$colorbox$1.dock($bottom$1),window.debugKeepMenusOpen=!1)}location.hash.match(/compare-reference-tool-windows/i)&&($toolbox$1.undock_to(84,35),$colorbox$1.undock_to(239,195),window.debugKeepMenusOpen=!0,$(".help-menu-button")[0].dispatchEvent(new Event("pointerdown")),$(".help-menu-button")[0].dispatchEvent(new Event("pointerup")),$("[aria-label='About Paint']")[0].dispatchEvent(new Event("pointerenter")))},500)};update_from_url_params();$G$1.on("hashchange popstate change-url-params",update_from_url_params);location.search.match(/eye-gaze-mode/)&&(change_url_param("eye-gaze-mode",!0,{replace_history_state:!0}),update_from_url_params());location.search.match(/vertical-colors?-box/)&&(change_url_param("vertical-color-box",!0,{replace_history_state:!0}),update_from_url_params());const $app$1=$(E("div")).addClass("jspaint").appendTo("body");window.$app=$app$1;const $V=$(E("div")).addClass("vertical").appendTo($app$1),$H=$(E("div")).addClass("horizontal").appendTo($V),$canvas_area$1=$(E("div")).addClass("canvas-area inset-deep").appendTo($H);window.$canvas_area=$canvas_area$1;const $canvas$1=$(main_canvas).appendTo($canvas_area$1);window.$canvas=$canvas$1;$canvas$1.css("touch-action","none");window.canvas_bounding_client_rect=main_canvas.getBoundingClientRect();const canvas_handles$1=new Handles({$handles_container:$canvas_area$1,$object_container:$canvas_area$1,get_rect:()=>({x:0,y:0,width:main_canvas.width,height:main_canvas.height}),set_rect:({width:e,height:n})=>resize_canvas_and_save_dimensions(e,n),outset:4,get_handles_offset_left:()=>parseFloat($canvas_area$1.css("padding-left"))+1,get_handles_offset_top:()=>parseFloat($canvas_area$1.css("padding-top"))+1,get_ghost_offset_left:()=>parseFloat($canvas_area$1.css("padding-left"))+1,get_ghost_offset_top:()=>parseFloat($canvas_area$1.css("padding-top"))+1,size_only:!0});window.canvas_handles=canvas_handles$1;const $top$1=$(E("div")).addClass("component-area top").prependTo($V);window.$top=$top$1;const $bottom$1=$(E("div")).addClass("component-area bottom").appendTo($V);window.$bottom=$bottom$1;const $left$1=$(E("div")).addClass("component-area left").prependTo($H);window.$left=$left$1;const $right$1=$(E("div")).addClass("component-area right").appendTo($H);window.$right=$right$1;get_direction()==="rtl"&&($left$1.appendTo($H),$right$1.prependTo($H));const $status_area$1=$(E("div")).addClass("status-area").appendTo($V);window.$status_area=$status_area$1;$(E("div")).addClass("cursor-position").appendTo($status_area$1);const $status_position$1=$(E("div")).addClass("status-coordinates status-field inset-shallow").appendTo($status_area$1);window.$status_position=$status_position$1;$(E("div")).addClass("status-divider start").appendTo($status_area$1);$(E("div")).addClass("shape-size").appendTo($status_area$1);const $status_size$1=$(E("div")).addClass("status-coordinates status-field inset-shallow").appendTo($status_area$1);window.$status_size=$status_size$1;$(E("div")).addClass("status-divider").appendTo($status_area$1);$(E("div")).addClass("screen-size").appendTo($status_area$1);const $window_Status=$(E("div")).addClass("status-coordinates status-field inset-shallow").appendTo($status_area$1);window.$window_Status=$window_Status;$(E("div")).addClass("status-divider").appendTo($status_area$1);$(E("div")).addClass("save-icon").appendTo($status_area$1);const $file_status=$(E("div")).addClass("status-coordinates status-field inset-shallow").appendTo($status_area$1);window.$file_status=$file_status;$(E("div")).addClass("status-divider").appendTo($status_area$1);$(E("div")).addClass("status-spacer").appendTo($status_area$1);$(E("div")).addClass("status-divider end").appendTo($status_area$1);const $zoomBox=$(E("div")).addClass("zoom-box").appendTo($status_area$1),$zoomText=$(E("div")).addClass("zoom-text status-field").text("100%").appendTo($zoomBox);window.$zoomText=$zoomText;const $decreaseButton=$(E("div")).addClass("zoom-button zoom-out").appendTo($zoomBox),$leftSlider=$(E("div")).addClass("added-slider left").appendTo($zoomBox);$(E("div")).addClass("added-slider-content left").appendTo($leftSlider);const sliderArea=$(E("div")).addClass("slider-area").appendTo($zoomBox),$zoomSlider=$(E("div")).appendTo(sliderArea),$rightSlider=$(E("div")).addClass("added-slider right").appendTo($zoomBox);$(E("div")).addClass("added-slider-content right").appendTo($rightSlider);const $increaseButton=$(E("div")).addClass("zoom-button zoom-in").appendTo($zoomBox);$(E("div")).addClass("status-divider end").appendTo($status_area$1);const values=[0,2,4,8,10,11,12,13,14,15,16],valuesToScale={0:.125,2:.25,4:.5,8:1,10:2,11:3,12:4,13:5,14:6,15:7,16:8};$decreaseButton.on("click",function(){const e=$zoomSlider.slider("value"),n=values.indexOf(e);let o=valuesToScale[e];n>0&&($zoomSlider.slider("value",values[n-1]),o=valuesToScale[values[n-1]]),set_magnification(o)});$increaseButton.on("click",function(){const e=$zoomSlider.slider("value"),n=values.indexOf(e);let o=valuesToScale[e];n<values.length-1&&($zoomSlider.slider("value",values[n+1]),o=valuesToScale[values[n+1]]),set_magnification(o)});$zoomSlider.slider({min:0,max:16,value:8,step:1,create:function(){$(this).find(".ui-slider-handle").html(`
			<svg width="10" height="17" viewBox="0 0 10 17">
				<polygon points="0,0 10,0 10,13 5,17 0,13" fill="#0078D7"></polygon>
			</svg>
		`).addClass("custom-handle")},slide:function(e,n){let o=n.value;if(values.includes(o)){const t=valuesToScale[o];return set_magnification(t),!0}else return!1}});let menu_bar_outside_frame=!1;if(frameElement)try{parent.MenuBar&&(MenuBar=parent.MenuBar,menu_bar_outside_frame=!0)}catch{}const menu_bar=MenuBar(menus);window.menu_bar=menu_bar;menu_bar_outside_frame?$(menu_bar.element).insertBefore(frameElement):$(menu_bar.element).prependTo($V);$(menu_bar.element).on("info",e=>{});$(menu_bar.element).on("default-info",()=>{});let $toolbox$1=$ToolBox(tools);window.$toolbox=$toolbox$1;let $colorbox$1=$ColorBox($("body").hasClass("vertical-color-box-mode"));window.$colorbox=$colorbox$1;$G$1.on("vertical-color-box-mode-toggled",()=>{$colorbox$1.destroy(),$colorbox$1=$ColorBox($("body").hasClass("vertical-color-box-mode")),window.$colorbox=$colorbox$1,prevent_selection($colorbox$1)});$G$1.on("eye-gaze-mode-toggled",()=>{$colorbox$1.destroy(),$colorbox$1=$ColorBox($("body").hasClass("vertical-color-box-mode")),window.$colorbox=$colorbox$1,prevent_selection($colorbox$1),$toolbox$1.destroy(),$toolbox$1=$ToolBox(tools),window.$toolbox=$toolbox$1,prevent_selection($toolbox$1)});$G$1.on("resize",()=>{update_canvas_rect(),update_disable_aa()});$canvas_area$1.on("scroll",()=>{update_canvas_rect()});$canvas_area$1.on("resize",()=>{update_magnified_canvas_size()});$G$1.on("scroll focusin",()=>{window.scrollTo(0,0)});$("body").on("dragover dragenter",e=>{const n=e.originalEvent.dataTransfer;n&&Array.from(n.types).includes("Files")&&e.preventDefault()}).on("drop",async e=>{if(e.isDefaultPrevented())return;const n=e.originalEvent.dataTransfer;if(n&&Array.from(n.types).includes("Files")){if(e.preventDefault(),window.FileSystemHandle&&!window.is_electron_app){for(const t of n.items)if(t.kind==="file"){let l;try{"getAsFileSystemHandle"in t&&(l=await t.getAsFileSystemHandle())}catch(a){show_error_message$1(localize("File not found."),a);return}if(!l||l.kind==="file"){let a;try{l&&l instanceof FileSystemFileHandle?a=await l.getFile():a=t.getAsFile()}catch(i){show_error_message$1(localize("File not found."),i);return}if(open_from_file(a,l),window._open_images_serially)await new Promise(i=>setTimeout(i,500));else return}}}else if(n.files&&n.files.length)if(window._open_images_serially){let t=0;const l=setInterval(()=>{console.log("opening",n.files[t].name),open_from_file(n.files[t]),t++,t>=n.files.length&&clearInterval(l)},1500)}else open_from_file(n.files[0])}});$G$1.on("keydown",e=>{var o;const n=e.target;if(!e.isDefaultPrevented()){if(e.key==="Escape"&&textbox&&textbox.$editor.is(n)&&deselect(),(e.ctrlKey||e.metaKey)&&e.shiftKey&&!e.altKey&&e.key.toUpperCase()==="Y"){show_document_history(),e.preventDefault();return}if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)){if(selection){const t=(l,a)=>{selection.x+=l,selection.y+=a,selection.position()};switch(e.key){case"ArrowLeft":t(-1,0),e.preventDefault();break;case"ArrowRight":t(1,0),e.preventDefault();break;case"ArrowDown":t(0,1),e.preventDefault();break;case"ArrowUp":t(0,-1),e.preventDefault();break}}if(e.key==="Escape")selection?deselect():cancel();else if(e.key==="Enter")selection&&deselect();else if(e.key==="F4")redo();else if(e.key==="Delete"||e.key==="Backspace")e.key==="Delete"&&e.shiftKey?edit_cut():e.key==="Backspace"&&e.altKey?undo():delete_selection(),e.preventDefault();else if(e.key==="Insert")e.ctrlKey?(edit_copy(),e.preventDefault()):e.shiftKey&&(edit_paste(),e.preventDefault());else if(e.code==="NumpadAdd"||e.code==="NumpadSubtract"||e.key==="+"||e.key==="-"||e.key==="="){const t=e.code==="NumpadAdd"||e.key==="+"||e.key==="=",l=e.code==="NumpadSubtract"||e.key==="-",a=Number(t)-Number(l);selection?selection.scale(2**a):(selected_tool.id===TOOL_BRUSH?brush_size=Math.max(1,Math.min(brush_size+a,500)):selected_tool.id===TOOL_ERASER?eraser_size=Math.max(1,Math.min(eraser_size+a,500)):selected_tool.id===TOOL_AIRBRUSH?airbrush_size=Math.max(1,Math.min(airbrush_size+a,500)):selected_tool.id===TOOL_PENCIL?pencil_size=Math.max(1,Math.min(pencil_size+a,50)):(selected_tool.id===TOOL_LINE||selected_tool.id===TOOL_CURVE||selected_tool.id===TOOL_RECTANGLE||selected_tool.id===TOOL_ROUNDED_RECTANGLE||selected_tool.id===TOOL_ELLIPSE||selected_tool.id===TOOL_POLYGON)&&(stroke_size=Math.max(1,Math.min(stroke_size+a,500))),$G$1.trigger("option-changed"),button!==void 0&&pointer&&selected_tools.forEach(i=>{tool_go(i)}),update_helper_layer()),e.preventDefault();return}else if(e.ctrlKey||e.metaKey){if(textbox)switch(e.key.toUpperCase()){case"A":case"Z":case"Y":case"I":case"B":case"U":return}if(e.key==="PageDown"){set_magnification(4),e.preventDefault();return}else if(e.key==="PageUp"){set_magnification(1),e.preventDefault();return}switch(e.key.toUpperCase()){case",":case"<":case"[":case"{":rotate(-TAU/4);break;case".":case">":case"]":case"}":rotate(+TAU/4);break;case"Z":e.shiftKey?redo():undo();break;case"Y":redo();break;case"G":e.shiftKey?render_history_as_gif():toggle_grid();break;case"F":!e.repeat&&!((o=e.originalEvent)!=null&&o.repeat)&&view_bitmap();break;case"O":file_open();break;case"S":e.shiftKey?file_save_as():file_save();break;case"A":select_all();break;case"I":image_invert_colors();break;case"E":image_attributes();break;case"N":e.shiftKey?clear():file_new();break;case"T":$toolbox$1.toggle();break;case"L":$colorbox$1.toggle();break;case"R":image_flip_and_rotate();break;case"W":image_stretch_and_skew();break;default:return}e.preventDefault()}}}});let alt_zooming=!1;addEventListener("keyup",e=>{e.key==="Alt"&&alt_zooming&&e.preventDefault(),e.altKey||(alt_zooming=!1)});addEventListener("wheel",e=>{if(e.altKey){e.preventDefault();let n=magnification;e.deltaY<0?n*=1.5:n/=1.5,n=Math.max(.5,Math.min(n,80)),set_magnification(n,to_canvas_coords(e)),alt_zooming=!0;return}if(!(e.ctrlKey||e.metaKey)&&location.hash.match(/compare-reference/i)){const n=Math.sign(e.deltaY)*-.2;let o=parseFloat($("body").attr("data-reference-opacity"));isFinite(o)||(o=.5);const t=Math.max(0,Math.min(1,o+n));$("body").attr("data-reference-opacity",t)}},{passive:!1});$G$1.on("cut copy paste",e=>{if(e.isDefaultPrevented()||document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement||!window.getSelection().isCollapsed)return;e.preventDefault();const n=e.originalEvent.clipboardData||window.clipboardData;if(n){if(e.type==="copy"||e.type==="cut"){if(selection&&selection.canvas){const o=()=>{const t=selection.canvas.toDataURL();n.setData("text/x-data-uri; type=image/png",t),n.setData("text/uri-list",t),n.setData("URL",t),e.type==="cut"&&delete_selection({name:localize("Cut"),icon:get_help_folder_icon("p_cut.png")})};if(!navigator.clipboard||!navigator.clipboard.write)return o();try{e.type==="cut"?edit_cut():edit_copy()}catch{o()}}}else if(e.type==="paste"){for(const o of n.items)if(o.type.match(/^text\/(?:x-data-uri|uri-list|plain)|URL$/)){o.getAsString(t=>{const l=get_uris(t);l.length>0?load_image_from_uri(l[0]).then(a=>{paste(a.image||make_canvas(a.image_data))},a=>{show_resource_load_error_message(a)}):show_error_message$1("The information on the Clipboard can't be inserted into Paint.")});break}else if(o.type.match(/^image\//)){paste_image_from_file(o.getAsFile());break}}}});reset_file();reset_selected_colors();reset_canvas_and_history();set_magnification(default_magnification);localStore.get({width:default_canvas_width,height:default_canvas_height},(e,n)=>{e||(my_canvas_width=Number(n.width),my_canvas_height=Number(n.height),make_or_update_undoable({match:o=>o.name===localize("New"),name:"Resize Canvas For New Document",icon:get_help_folder_icon("p_stretch_both.png")},()=>{main_canvas.width=Math.max(1,my_canvas_width),main_canvas.height=Math.max(1,my_canvas_height),main_ctx.disable_image_smoothing(),transparency||(main_ctx.fillStyle=selected_colors.background,main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height)),$canvas_area$1.trigger("resize")}))});window.initial_system_file_handle&&systemHooks.readBlobFromHandle(window.initial_system_file_handle).then(e=>{e&&open_from_file(e,window.initial_system_file_handle)},e=>{show_error_message$1(`Failed to open file ${window.initial_system_file_handle}`,e)});const update_palette_from_theme=()=>{get_theme()==="winter.css"?(palette=get_winter_palette(),$colorbox$1.rebuild_palette()):(palette=default_palette,$colorbox$1.rebuild_palette())};$G$1.on("theme-load",update_palette_from_theme);update_palette_from_theme();function update_fill_and_stroke_colors_and_lineWidth$1(e){main_ctx.lineWidth=stroke_size;const n=!!(e.$options&&e.$options.fill&&!e.$options.stroke),o=ctrl&&selected_colors.ternary&&pointer_active?"ternary":reverse!==n?"background":"foreground";main_ctx.fillStyle=fill_color=main_ctx.strokeStyle=stroke_color=selected_colors[o];let t=ctrl?"ternary":reverse!==n?"background":"foreground",l=t;(e.shape||e.shape_colors)&&(e.stroke_only||(reverse!==n?(t="foreground",l="background"):(t="background",l="foreground")),main_ctx.fillStyle=fill_color=selected_colors[t],main_ctx.strokeStyle=stroke_color=selected_colors[l]),pick_color_slot=t}function tool_go(e,n){update_fill_and_stroke_colors_and_lineWidth$1(e),e[n]&&e[n](main_ctx,pointer.x,pointer.y),e.paint&&e.paint(main_ctx,pointer.x,pointer.y)}function canvas_pointer_move(e){if(ctrl=e.ctrlKey,shift=e.shiftKey,pointer=to_canvas_coords(e),pointers.length&&e.button!=-1&&(e.pointerType!=pointer_type||(e.buttons|4)!=(pointer_buttons|4))){cancel(),pointer_active=!1;return}if(e.shiftKey){if(selected_tool.id===TOOL_LINE||selected_tool.id===TOOL_CURVE){const n=Math.sqrt((pointer.y-pointer_start.y)*(pointer.y-pointer_start.y)+(pointer.x-pointer_start.x)*(pointer.x-pointer_start.x)),o=TAU/8,t=Math.atan2(pointer.y-pointer_start.y,pointer.x-pointer_start.x)/o,l=Math.round(t)*o;pointer.x=Math.round(pointer_start.x+Math.cos(l)*n),pointer.y=Math.round(pointer_start.y+Math.sin(l)*n)}else if(selected_tool.shape){const n=Math.abs(pointer.x-pointer_start.x),o=Math.abs(pointer.y-pointer_start.y);n<o?pointer.y>pointer_start.y?pointer.y=pointer_start.y+n:pointer.y=pointer_start.y-n:pointer.x>pointer_start.x?pointer.x=pointer_start.x+o:pointer.x=pointer_start.x-o}}selected_tools.forEach(n=>{tool_go(n)}),pointer_previous=pointer}$canvas$1.on("pointermove",e=>{pointer=to_canvas_coords(e),$status_position$1.text(`${pointer.x}, ${pointer.y} px`)});$canvas$1.on("pointerenter",e=>{pointer_over_canvas=!0,update_helper_layer(e),update_helper_layer_on_pointermove_active||($G$1.on("pointermove",update_helper_layer),update_helper_layer_on_pointermove_active=!0)});$canvas$1.on("pointerleave",e=>{pointer_over_canvas=!1,$status_position$1.text(""),update_helper_layer(e),!pointer_active&&update_helper_layer_on_pointermove_active&&($G$1.off("pointermove",update_helper_layer),update_helper_layer_on_pointermove_active=!1)});let last_zoom_pointer_distance,pan_last_pos,first_pointer_time;const discard_quick_undo_period=500;function average_points(e){const n={x:0,y:0};for(const o of e)n.x+=o.x,n.y+=o.y;return n.x/=e.length,n.y/=e.length,n}$canvas_area$1.on("pointerdown",e=>{if(document.activeElement instanceof HTMLElement&&document.activeElement!==document.body&&document.activeElement!==document.documentElement&&document.activeElement.blur(),pointers.every(n=>n.pointerId!==1234567890&&!(n.isPrimary&&(n.pointerType==="mouse"||n.pointerType==="pen")))&&pointers.push({pointerId:e.pointerId,pointerType:e.pointerType,isPrimary:e.originalEvent&&e.originalEvent.isPrimary||e.isPrimary,x:e.clientX,y:e.clientY}),pointers.length===1&&(first_pointer_time=performance.now()),pointers.length==2&&(last_zoom_pointer_distance=Math.hypot(pointers[0].x-pointers[1].x,pointers[0].y-pointers[1].y),pan_last_pos=average_points(pointers)),pointers.length>=2){const n=first_pointer_time&&performance.now()-first_pointer_time<discard_quick_undo_period;cancel(!1,n),pointer_active=!1;return}});$G$1.on("pointerup pointercancel",e=>{pointers=pointers.filter(n=>n.pointerId!==e.pointerId)});$G$1.on("pointermove",e=>{for(const n of pointers)n.pointerId===e.pointerId&&(n.x=e.clientX,n.y=e.clientY);if(pointers.length>=2){const n=average_points(pointers),o=Math.hypot(pointers[0].x-pointers[1].x,pointers[0].y-pointers[1].y),t=o-last_zoom_pointer_distance;let l=magnification;Math.abs(t)>60&&(last_zoom_pointer_distance=o,t>0?l*=1.5:l/=1.5),l=Math.max(.5,Math.min(l,40)),l!=magnification&&set_magnification(l,to_canvas_coords({clientX:n.x,clientY:n.y}));const a=n.x-pan_last_pos.x,i=n.y-pan_last_pos.y;$canvas_area$1.scrollLeft($canvas_area$1.scrollLeft()-a),$canvas_area$1.scrollTop($canvas_area$1.scrollTop()-i),pan_last_pos=n}});$canvas$1.on("pointerdown",e=>{if($status_size$1.text(""),update_canvas_rect(),pointers.length>=1){const o=first_pointer_time&&performance.now()-first_pointer_time<discard_quick_undo_period;cancel(!1,o),pointer_active=!1,pointers=pointers.filter(t=>t.pointerId!==1234567890);return}if(history_node_to_cancel_to=current_history_node,pointer_active=!!(e.buttons&3),pointer_type=e.pointerType,pointer_buttons=e.buttons,$G$1.one("pointerup",o=>{pointer_active=!1,update_helper_layer(o),!pointer_over_canvas&&update_helper_layer_on_pointermove_active&&($G$1.off("pointermove",update_helper_layer),update_helper_layer_on_pointermove_active=!1)}),e.button===0)reverse=!1;else if(e.button===2)reverse=!0;else return;button=e.button,ctrl=e.ctrlKey,shift=e.shiftKey,pointer_start=pointer_previous=pointer=to_canvas_coords(e),(()=>{let o=[];selected_tools.forEach(t=>{(t.paint||t.pointerdown)&&tool_go(t,"pointerdown"),t.paint_on_time_interval!=null&&o.push(setInterval(()=>{tool_go(t)},t.paint_on_time_interval))}),$G$1.on("pointermove",canvas_pointer_move),$G$1.one("pointerup",(t,l,a)=>{button=void 0,reverse=!1,t.clientX!==void 0&&(pointer=to_canvas_coords(t)),a||selected_tools.forEach(i=>{var s;(s=i.pointerup)==null||s.call(i,main_ctx,pointer.x,pointer.y)}),selected_tools.length===1&&selected_tool.deselect&&select_tools(return_to_tools),$G$1.off("pointermove",canvas_pointer_move);for(const i of o)clearInterval(i);l||(history_node_to_cancel_to=null)})})(),update_helper_layer(e)});$canvas_area$1.on("pointerdown",e=>{e.button===0&&$canvas_area$1.is(e.target)&&selection&&deselect()});function prevent_selection(e){e.on("mousedown selectstart contextmenu",n=>{n.isDefaultPrevented()||n.target instanceof HTMLSelectElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLLabelElement&&n.type!=="contextmenu"||n.target instanceof HTMLInputElement&&n.target.type!=="color"||n.button!==1&&(n.preventDefault(),window.getSelection().removeAllRanges())})}prevent_selection($app$1);prevent_selection($toolbox$1);prevent_selection($colorbox$1);$G$1.on("blur",()=>{$G$1.triggerHandler("pointerup")});function iOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}$("html").toggleClass("ios",iOS());$G$1.on("fullscreenchange webkitfullscreenchange",()=>{const e=!!(document.fullscreenElement||document.webkitFullscreenElement);$("html").toggleClass("fullscreen",e)});window.api_for_cypress_tests={reset_for_next_test(){selected_colors.foreground="#000",selected_colors.background="#fff",brush_shape=default_brush_shape,brush_size=default_brush_size,eraser_size=default_eraser_size,airbrush_size=default_airbrush_size,pencil_size=default_pencil_size,stroke_size=default_stroke_size,clear()},selected_colors,set_theme,$};init_webgl_stuff();console.log("JS 실행:","session.js");const log=(...e)=>{var n;(n=window.console)==null||n.log(...e)};let localStorageAvailable=!1;try{localStorage._available=!0,localStorageAvailable=localStorage._available,delete localStorage._available}catch(e){}const match_threshold=1,canvas_has_any_apparent_image_data=()=>main_canvas.ctx.getImageData(0,0,main_canvas.width,main_canvas.height).data.some(e=>e>match_threshold);let $recovery_window;function show_recovery_window(e){$recovery_window==null||$recovery_window.close();const n=$recovery_window=$DialogWindow();n.on("close",()=>{$recovery_window=null}),n.title("Recover Document");let o=!1;try{window.localStorage.getItem("bogus test key")}catch{o=!0}n.$main.append($(`
		<p>Woah! The canvas became empty.</p>
		<p>If this was on purpose, please ignore this message.</p>
		<p>
			If the canvas was cleared due to memory usage,<br>
			click Undo to recover the document.
		</p>
		<!--<p>Remember to save with <b>File > Save</b>!</p>-->
		${o?"<p><b>Note:</b> No automatic backup is possible unless you enable Cookies in your browser.</p>":e?`<hr>
					<p style="opacity: 0.8; font-size: 0.9em;">
						Auto-save is paused while this dialog is open.
					</p>
					<p style="opacity: 0.8; font-size: 0.9em;">
						(See <b>File &gt; Manage Storage</b> to view backups.)
					</p>`:""}
	`));const t=n.$Button("Undo",()=>{undo()}),l=n.$Button("Redo",()=>{redo()}),a=()=>{t.prop("disabled",undos.length<1),l.prop("disabled",redos.length<1)};$G$1.on("session-update.session-hook",a),a(),n.$Button(localize("Close"),()=>{n.close()}),n.center(),n.find("button:enabled").focus()}let last_undos_length=undos.length;function handle_data_loss(){const e=$recovery_window&&!$recovery_window.closed;let n=!1;return canvas_has_any_apparent_image_data()?e&&(undos.length>last_undos_length&&show_recovery_window(!0),n=!0):(e||show_recovery_window(),n=!0),last_undos_length=undos.length,n}class LocalSession{constructor(n){this.id=n;const o=`image#${n}`;log(`Local storage key: ${o}`),this.save_image_to_storage_immediately=()=>{handle_data_loss()||(log(`Saving image to storage: ${o}`),localStore.set(o,main_canvas.toDataURL("image/png"),l=>{}))},this.save_image_to_storage_soon=debounce(this.save_image_to_storage_immediately,100),localStore.get(o,(t,l)=>{t?localStorageAvailable?show_error_message$1("Failed to retrieve image from local storage.",t):showMessageBox$1({message:"Please enable local storage in your browser's settings for local backup. It may be called Cookies, Storage, or Site Data."}):l?load_image_from_uri(l).then(a=>{open_from_image_info(a,null,null,!0,!0)},a=>{show_error_message$1("Failed to open image from local storage.",a)}):this.save_image_to_storage_soon()}),$G$1.on("session-update.session-hook",()=>{this.save_image_to_storage_soon()})}end(){this.save_image_to_storage_soon.cancel(),this.save_image_to_storage_immediately(),$G$1.off(".session-hook")}}let user_id;const user={cursor:{x:0,y:0,away:!0},tool:localize("Pencil"),hue:~~(Math.random()*360),saturation:~~(Math.random()*50)+50,lightness:~~(Math.random()*40)+50};user.color=`hsla(${user.hue}, ${user.saturation}%, ${user.lightness}%, 1)`;user.color_transparent=`hsla(${user.hue}, ${user.saturation}%, ${user.lightness}%, 0.5)`;user.color_desaturated=`hsla(${user.hue}, ${~~(user.saturation*.4)}%, ${user.lightness}%, 0.8)`;const cursor_image=new Image;cursor_image.src="images/cursors/default.png";class FirebaseSession{constructor(n){this.id=n,this._fb_listeners=[],file_name=`[Loading ${this.id}]`,update_title();const o=()=>{file_name=`[${this.id}]`,update_title(),this.start()};if(FirebaseSession.fb_root)o();else{var t=document.createElement("script");t.addEventListener("load",()=>{const l={apiKey:"AIzaSyBgau8Vu9ZE8u_j0rp-Lc044gYTX5O3X9k",authDomain:"jspaint.firebaseapp.com",databaseURL:"https://jspaint.firebaseio.com",projectId:"firebase-jspaint",storageBucket:"",messagingSenderId:"63395010995"};firebase.initializeApp(l),FirebaseSession.fb_root=firebase.database().ref("/"),o()}),t.addEventListener("error",()=>{show_error_message$1("Failed to load Firebase; the document will not load, and changes will not be saved."),file_name=`[Failed to load ${this.id}]`,update_title()}),t.src="lib/firebase.js",document.head.appendChild(t)}}start(){showMessageBox$1({messageHTML:`
				<p>The document may not load. Changes may not save.</p>
				<p>Multiuser sessions are public. There is no security.</p>
			`});const n=(l,a,i,s)=>{this._fb_listeners.push({fb:l,event_type:a,callback:i,error_callback:s}),l.on(a,i,s)};this.fb=FirebaseSession.fb_root.child(this.id),this.fb_data=this.fb.child("data"),this.fb_users=this.fb.child("users"),user_id?this.fb_user=this.fb_users.child(user_id):(this.fb_user=this.fb_users.push(),user_id=this.fb_user.key),this.fb_user.onDisconnect().remove(),this.fb_user.set(user),n(this.fb_users,"child_added",l=>{if(l.key===user_id)return;const a=l.ref;let i=l.val();const s=make_canvas(32,32),c=$(s).addClass("user-cursor").appendTo($app);c.css({display:"none",position:"absolute",left:0,top:0,opacity:0,zIndex:5,pointerEvents:"none",transition:"opacity 0.5s"}),n(a,"value",r=>{if(i=r.val(),i==null)c.remove();else{const d=()=>{s.width=cursor_image.width,s.height=cursor_image.height;const m=s.ctx;m.fillStyle=i.color,m.fillRect(0,0,s.width,s.height),m.globalCompositeOperation="multiply",m.drawImage(cursor_image,0,0),m.globalCompositeOperation="destination-atop",m.drawImage(cursor_image,0,0)};cursor_image.complete?d():$(cursor_image).one("load",d);const h=window.canvas_bounding_client_rect;c.css({display:"block",position:"absolute",left:h.left+magnification*i.cursor.x,top:h.top+magnification*i.cursor.y,opacity:1-i.cursor.away})}})});let o;this.write_canvas_to_database_immediately=()=>{if(handle_data_loss())return;const a=main_canvas.toDataURL();o!==a?(log("Write canvas data to Firebase"),this.fb_data.set(a),o=a):log("(Don't write canvas data to Firebase; it hasn't changed)")},this.write_canvas_to_database_soon=debounce(this.write_canvas_to_database_immediately,100);let t=!1;$G$1.on("session-update.session-hook",()=>{if(t){log("(Ignore session-update from Sync Session undoable)");return}this.write_canvas_to_database_soon()}),n(this.fb_data,"value",l=>{log("Firebase data update");const a=l.val();if(a==null)this.write_canvas_to_database_soon();else{o=a;const i=new Image;i.onload=()=>{const s=make_canvas(i),c=s.ctx.getImageData(0,0,s.width,s.height),r=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height);image_data_match(c,r,5)||(t=!0,undoable({name:"Sync Session",icon:get_help_folder_icon("p_database.png")},()=>{main_ctx.copy(i),$canvas_area.trigger("resize")}),t=!1)},i.src=a}},l=>{show_error_message$1("Failed to retrieve data from Firebase. The document will not load, and changes will not be saved.",l),file_name=`[Failed to load ${this.id}]`,update_title()}),$G$1.on("pointermove.session-hook",l=>{const a=to_canvas_coords(l);this.fb_user.child("cursor").update({x:a.x,y:a.y,away:!1})}),$G$1.on("blur.session-hook",()=>{this.fb_user.child("cursor").update({away:!0})})}end(){this.write_canvas_to_database_soon.cancel(),this.write_canvas_to_database_immediately(),$G$1.off(".session-hook"),this._fb_listeners.forEach(({fb:n,event_type:o,callback:t,_error_callback:l})=>{log(`Remove listener for ${n.path.toString()} .on ${o}`),n.off(o,t)}),this._fb_listeners.length=0,this.fb_user.remove(),$app.find(".user-cursor").remove(),reset_file()}}FirebaseSession.fb_root=null;class RESTSession{constructor(n){this.id=n,file_name=`[Loading ${this.id}]`,update_title(),this.start(),this._previous_uri="",this._ignore_session_update=!1,this._poll_tid=-1,this._poll_fetch_start_time=-1,this._last_write_time=-1}async _write_canvas_to_server_immediately(){if(handle_data_loss())return;const o=main_canvas.toDataURL();this._previous_uri!==o?(log("Write canvas data to server"),this._previous_uri=o,this._last_write_time=performance.now(),await fetch(`/api/rooms/${this.id}/data`,{method:"PUT",body:o}),this._last_write_time=performance.now()):log("(Don't write canvas data to server; it hasn't changed)")}start(){this._write_canvas_to_server_soon=debounce(this._write_canvas_to_server_immediately,100),$G$1.on("session-update.session-hook",()=>{if(this._ignore_session_update){log("(Ignore session-update from Sync Session undoable)");return}this._write_canvas_to_server_soon(),this._last_write_time=performance.now()});const n=async()=>{let o;try{this._poll_fetch_start_time=performance.now();const t=await fetch(`/api/rooms/${this.id}/data`);t.status===404?o=null:o=await t.text()}catch(t){show_error_message$1("Failed to load image document from the server.",t),file_name=`[Failed to load ${this.id}]`,update_title();return}file_name=`[${this.id}]`,update_title(),this.handle_data_snapshot(o,this._poll_fetch_start_time),this._poll_tid=setTimeout(n,1e3)};n()}handle_data_snapshot(n,o){if(!n)this._write_canvas_to_server_soon(),this._last_write_time=performance.now();else{this._previous_uri=n;const t=new Image;t.onload=()=>{if(this._last_write_time>o){log("(Ignore stale image data)");return}const l=make_canvas(t),a=l.ctx.getImageData(0,0,l.width,l.height),i=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height);image_data_match(a,i,5)||(this._ignore_session_update=!0,undoable({name:"Sync Session",icon:get_help_folder_icon("p_database.png")},()=>{main_ctx.copy(t),$canvas_area.trigger("resize")}),this._ignore_session_update=!1)},t.onerror=()=>{show_error_message$1("Failed to load image document from the server. Invalid image data.",n)},t.src=n}}end(){clearTimeout(this._poll_tid),this._write_canvas_to_server_soon.cancel(),this._write_canvas_to_server_immediately(),$G$1.off(".session-hook"),$app.find(".user-cursor").remove(),reset_file()}}let current_session;const end_current_session=()=>{current_session&&(log("Ending current session"),current_session.end(),current_session=null)},generate_session_id=()=>(Math.random()*2**32).toString(16).replace(".",""),update_session_from_location_hash=()=>{const e=location.hash.match(/^#?(?:.*,)?(session|local):(.*)$/i),n=location.hash.match(/^#?(?:.*,)?(load):(.*)$/i);if(e){const o=e[1].toLowerCase()==="local",t=e[2];if(t==="")log("Invalid session ID; session ID cannot be empty"),end_current_session();else if(!o&&t.match(/[./[\]#$]/))log("Session ID is not a valid Firebase location; it cannot contain any of ./[]#$"),end_current_session();else if(!t.match(/[-0-9A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02af\u1d00-\u1d25\u1d62-\u1d65\u1d6b-\u1d77\u1d79-\u1d9a\u1e00-\u1eff\u2090-\u2094\u2184-\u2184\u2488-\u2490\u271d-\u271d\u2c60-\u2c7c\u2c7e-\u2c7f\ua722-\ua76f\ua771-\ua787\ua78b-\ua78c\ua7fb-\ua7ff\ufb00-\ufb06]+/))log("Invalid session ID; it must consist of 'alphanumeric-esque' characters"),end_current_session();else if(current_session&&current_session.id===t&&o===current_session instanceof LocalSession)log("Hash changed but the session ID and session type are the same");else{end_current_session();let l="FirebaseSession";try{l=localStorage.online_session_implementation||l}catch{}o?(log(`Starting a new LocalSession, ID: ${t}`),current_session=new LocalSession(t)):l==="RESTSession"?(log(`Starting a new RESTSession, ID: ${t}`),current_session=new RESTSession(t)):l==="FirebaseSession"?(log(`Starting a new FirebaseSession, ID: ${t}`),current_session=new FirebaseSession(t)):(show_error_message$1(`Invalid online session implementation '${l}'`),current_session=new LocalSession(t))}}else if(n){const o=decodeURIComponent(n[2]);if(get_uris(o).length===0){show_error_message$1("Invalid URL to load (after #load: in the address bar). It must include a protocol (https:// or http://)");return}log("Switching to new session from #load: URL (to #local: URL with session ID)"),end_current_session(),change_url_param("local",generate_session_id()),load_image_from_uri(o).then(l=>{open_from_image_info(l,null,null,!0,!0)},show_resource_load_error_message)}else{log("No session ID in hash");const o=location.hash;end_current_session(),change_url_param("local",generate_session_id(),{replace_history_state:!0}),log("After replaceState:",location.hash),o===location.hash?show_error_message$1("Autosave is disabled. Failed to update URL to start session."):update_session_from_location_hash()}};$G$1.on("hashchange popstate change-url-params",e=>{log(e.type,location.hash),update_session_from_location_hash()});const new_local_session$1=()=>{end_current_session(),log("Changing URL to start new session..."),change_url_param("local",generate_session_id())};log("Initializing with location hash:",location.hash);update_session_from_location_hash();window.new_local_session=new_local_session$1});export default er();
