var Qi=(e,i)=>()=>(i||e((i={exports:{}}).exports,i),i.exports);var er=Qi((exports,module)=>{(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))t(c);new MutationObserver(c=>{for(const a of c)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&t(n)}).observe(document,{childList:!0,subtree:!0});function s(c){const a={};return c.integrity&&(a.integrity=c.integrity),c.referrerPolicy&&(a.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?a.credentials="include":c.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(c){if(c.ep)return;c.ep=!0;const a=s(c);fetch(c.href,a)}})();console.log("JS 실행:","error-handling-basic.js");var isIE=/MSIE \d|Trident.*rv:/.test(navigator.userAgent);window.onerror=function(e,i,s,t,c){if(isIE)return!1;var a=e.toLowerCase(),n="script error";return a.indexOf(n)>-1?alert("Script Error: See Browser Console for Detail"):console.error("Internal application error: "+e+`

URL: `+i+`
Line: `+s+`
Column: `+t),!1};window.onunhandledrejection=function(e){if(isIE)return!1;alert("Unhandled Rejection: "+e.reason)};if(isIE)var html='<style>	body { text-align: center; font-family: sans-serif; }	hr { width: 180px; }	.logo { position: relative; top: 3px; }</style><div className="not-supported">	<h1><img src="images/icons/32x32.png" class="logo"> JS Paint</h1>	<h2>Internet Explorer is not supported!</h2>	<p className="not-supported-details">		Try 		<a href="https://www.mozilla.org/firefox/">Firefox</a>, 		<a href="https://www.google.com/chrome/">Chrome</a>, 		or 		<a href="https://www.microsoft.com/edge/">Edge</a>.	</p>	<hr>	<p>		<a href="about.html">More about JS Paint</a>	</p></div>',interval=setInterval(function(){document.body&&(clearInterval(interval),document.body.innerHTML=html)},100);console.log("JS 실행:","theme.js");const default_theme="modern.css",theme_storage_key="jspaint theme",disable_seasonal_theme_key="jspaint disable seasonal theme",href_for=e=>`styles/themes/${e}`;let iid;function wait_for_theme_loaded(e,i){clearInterval(iid),iid=setInterval(()=>{getComputedStyle(document.documentElement).getPropertyValue("--theme-loaded").replace(/['"]+/g,"").trim()===e&&(clearInterval(iid),i())},15)}let grinch_button,current_theme;try{const e=localStorage[disable_seasonal_theme_key]==="true";new Date().getMonth()===11&&!e?(current_theme="winter.css",wait_for_theme_loaded(current_theme,()=>{make_grinch_button()})):current_theme=localStorage[theme_storage_key]||default_theme}catch(e){console.error(e),current_theme=default_theme}const theme_link=document.createElement("link");theme_link.rel="stylesheet";theme_link.type="text/css";theme_link.href=href_for(current_theme);theme_link.id="theme-link";document.head.appendChild(theme_link);update_not_for_modern_theme();const get_theme=()=>current_theme,set_theme=e=>{console.log(e),current_theme=e;try{localStorage[theme_storage_key]=e,localStorage[disable_seasonal_theme_key]="true",grinch_button==null||grinch_button.remove()}catch{}const i=()=>{$(window).triggerHandler("theme-load"),$(window).trigger("resize")};wait_for_theme_loaded(e,i),theme_link.href=href_for(e),update_not_for_modern_theme(),i()};function update_not_for_modern_theme(){const e=document.querySelectorAll("link.not-for-modern");for(const i of e)i.disabled=current_theme==="modern.css"||current_theme==="modern-dark.css"||current_theme==="bubblegum.css"}function make_grinch_button(){const e=document.createElement("button");e.ariaLabel="Disable seasonal theme",e.className="grinch-button";let i=!1,s=0,t=0,c=0,a;const n=38,o=100;e.onclick=()=>{s===c&&f(),i=!0};const l=e.onmouseleave=()=>{c=i?1:0,h(),document.removeEventListener("touchmove",d)},r=e.onmouseenter=()=>{c=1,t=Math.max(t,.02),h()};e.onpointerdown=g=>{g.pointerType==="touch"&&(l(),document.addEventListener("touchmove",d))};function d(g){var x=g.touches[0];e!==document.elementFromPoint(x.pageX,x.pageY)&&(i=!1,r())}function h(){cancelAnimationFrame(a),s+=t*.5,t*=.9,c?t+=.001:s<.4?t-=5e-4:t-=.001,s>1?(s=1,t=0,i&&f()):s<0&&(s=0,t=0),s!==c&&(a=requestAnimationFrame(h)),e.style.backgroundPosition=`${-Math.floor(s*(n-1))*o}px 0px`}function _(){e.style.transform=`scale(${Math.max(1,Math.floor(devicePixelRatio))/devicePixelRatio})`,e.style.transformOrigin="bottom right",e.style.imageRendering="pixelated"}window.addEventListener("resize",_),_();function f(){let g;try{localStorage[disable_seasonal_theme_key]="true",g=localStorage[theme_storage_key]||default_theme}catch{}g==="winter.css"&&(g=default_theme),set_theme(g),e.remove(),window.removeEventListener("resize",_),document.removeEventListener("touchmove",d)}document.body.appendChild(e),grinch_button=e}/*! jQuery v3.4.1 | (c) JS Foundation and other contributors | jquery.org/license */(function(e,i){typeof module=="object"&&typeof module.exports=="object"?module.exports=e.document?i(e,!0):function(s){if(!s.document)throw new Error("jQuery requires a window with a document");return i(s)}:i(e)})(typeof window<"u"?window:void 0,function(e,i){var s=[],t=e.document,c=Object.getPrototypeOf,a=s.slice,n=s.concat,o=s.push,l=s.indexOf,r={},d=r.toString,h=r.hasOwnProperty,_=h.toString,f=_.call(Object),g={},x=function(p){return typeof p=="function"&&typeof p.nodeType!="number"},w=function(p){return p!=null&&p===p.window},S={type:!0,src:!0,nonce:!0,noModule:!0};function M(p,P,G){var V,ie,ce=(G=G||t).createElement("script");if(ce.text=p,P)for(V in S)(ie=P[V]||P.getAttribute&&P.getAttribute(V))&&ce.setAttribute(V,ie);G.head.appendChild(ce).parentNode.removeChild(ce)}function R(p){return p==null?p+"":typeof p=="object"||typeof p=="function"?r[d.call(p)]||"object":typeof p}var C="3.4.1",u=function(p,P){return new u.fn.init(p,P)},m=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function y(p){var P=!!p&&"length"in p&&p.length,G=R(p);return!x(p)&&!w(p)&&(G==="array"||P===0||typeof P=="number"&&0<P&&P-1 in p)}u.fn=u.prototype={jquery:C,constructor:u,length:0,toArray:function(){return a.call(this)},get:function(p){return p==null?a.call(this):p<0?this[p+this.length]:this[p]},pushStack:function(p){var P=u.merge(this.constructor(),p);return P.prevObject=this,P},each:function(p){return u.each(this,p)},map:function(p){return this.pushStack(u.map(this,function(P,G){return p.call(P,G,P)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(p){var P=this.length,G=+p+(p<0?P:0);return this.pushStack(0<=G&&G<P?[this[G]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:s.sort,splice:s.splice},u.extend=u.fn.extend=function(){var p,P,G,V,ie,ce,de=arguments[0]||{},ye=1,Te=arguments.length,Me=!1;for(typeof de=="boolean"&&(Me=de,de=arguments[ye]||{},ye++),typeof de=="object"||x(de)||(de={}),ye===Te&&(de=this,ye--);ye<Te;ye++)if((p=arguments[ye])!=null)for(P in p)V=p[P],P!=="__proto__"&&de!==V&&(Me&&V&&(u.isPlainObject(V)||(ie=Array.isArray(V)))?(G=de[P],ce=ie&&!Array.isArray(G)?[]:ie||u.isPlainObject(G)?G:{},ie=!1,de[P]=u.extend(Me,ce,V)):V!==void 0&&(de[P]=V));return de},u.extend({expando:"jQuery"+(C+Math.random()).replace(/\D/g,""),isReady:!0,error:function(p){throw new Error(p)},noop:function(){},isPlainObject:function(p){var P,G;return!(!p||d.call(p)!=="[object Object]")&&(!(P=c(p))||typeof(G=h.call(P,"constructor")&&P.constructor)=="function"&&_.call(G)===f)},isEmptyObject:function(p){var P;for(P in p)return!1;return!0},globalEval:function(p,P){M(p,{nonce:P&&P.nonce})},each:function(p,P){var G,V=0;if(y(p))for(G=p.length;V<G&&P.call(p[V],V,p[V])!==!1;V++);else for(V in p)if(P.call(p[V],V,p[V])===!1)break;return p},trim:function(p){return p==null?"":(p+"").replace(m,"")},makeArray:function(p,P){var G=P||[];return p!=null&&(y(Object(p))?u.merge(G,typeof p=="string"?[p]:p):o.call(G,p)),G},inArray:function(p,P,G){return P==null?-1:l.call(P,p,G)},merge:function(p,P){for(var G=+P.length,V=0,ie=p.length;V<G;V++)p[ie++]=P[V];return p.length=ie,p},grep:function(p,P,G){for(var V=[],ie=0,ce=p.length,de=!G;ie<ce;ie++)!P(p[ie],ie)!==de&&V.push(p[ie]);return V},map:function(p,P,G){var V,ie,ce=0,de=[];if(y(p))for(V=p.length;ce<V;ce++)(ie=P(p[ce],ce,G))!=null&&de.push(ie);else for(ce in p)(ie=P(p[ce],ce,G))!=null&&de.push(ie);return n.apply([],de)},guid:1,support:g}),typeof Symbol=="function"&&(u.fn[Symbol.iterator]=s[Symbol.iterator]),u.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(p,P){r["[object "+P+"]"]=P.toLowerCase()});var v=function(p){var P,G,V,ie,ce,de,ye,Te,Me,Ne,Be,Re,Le,et,rt,tt,yt,kt,Ft,mt="sizzle"+1*new Date,lt=p.document,Nt=0,pt=0,xt=Sn(),vn=Sn(),En=Sn(),jt=Sn(),sn=function(fe,xe){return fe===xe&&(Be=!0),0},dn={}.hasOwnProperty,Dt=[],hn=Dt.pop,Ht=Dt.push,Et=Dt.push,Ot=Dt.slice,Ut=function(fe,xe){for(var ke=0,De=fe.length;ke<De;ke++)if(fe[ke]===xe)return ke;return-1},Xt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",dt="[\\x20\\t\\r\\n\\f]",_t="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",Mt="\\["+dt+"*("+_t+")(?:"+dt+"*([*^$|!~]?=)"+dt+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+_t+"))|)"+dt+"*\\]",Bt=":("+_t+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Mt+")*)|.*)\\)|)",Ct=new RegExp(dt+"+","g"),Gt=new RegExp("^"+dt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+dt+"+$","g"),fn=new RegExp("^"+dt+"*,"+dt+"*"),Bn=new RegExp("^"+dt+"*([>+~]|"+dt+")"+dt+"*"),zi=new RegExp(dt+"|>"),ji=new RegExp(Bt),Hi=new RegExp("^"+_t+"$"),An={ID:new RegExp("^#("+_t+")"),CLASS:new RegExp("^\\.("+_t+")"),TAG:new RegExp("^("+_t+"|[*])"),ATTR:new RegExp("^"+Mt),PSEUDO:new RegExp("^"+Bt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+dt+"*(even|odd|(([+-]|)(\\d*)n|)"+dt+"*(?:([+-]|)"+dt+"*(\\d+)|))"+dt+"*\\)|)","i"),bool:new RegExp("^(?:"+Xt+")$","i"),needsContext:new RegExp("^"+dt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+dt+"*((?:-\\d)?\\d*)"+dt+"*\\)|)(?=[^-]|$)","i")},Wi=/HTML$/i,qi=/^(?:input|select|textarea|button)$/i,Vi=/^h\d$/i,bn=/^[^{]+\{\s*\[native \w/,Ki=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Gn=/[+~]/,en=new RegExp("\\\\([\\da-f]{1,6}"+dt+"?|("+dt+")|.)","ig"),tn=function(fe,xe,ke){var De="0x"+xe-65536;return De!=De||ke?xe:De<0?String.fromCharCode(De+65536):String.fromCharCode(De>>10|55296,1023&De|56320)},gi=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,_i=function(fe,xe){return xe?fe==="\0"?"�":fe.slice(0,-1)+"\\"+fe.charCodeAt(fe.length-1).toString(16)+" ":"\\"+fe},mi=function(){Re()},Yi=Tn(function(fe){return fe.disabled===!0&&fe.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{Et.apply(Dt=Ot.call(lt.childNodes),lt.childNodes),Dt[lt.childNodes.length].nodeType}catch{Et={apply:Dt.length?function(xe,ke){Ht.apply(xe,Ot.call(ke))}:function(xe,ke){for(var De=xe.length,$e=0;xe[De++]=ke[$e++];);xe.length=De-1}}}function vt(fe,xe,ke,De){var $e,ze,je,Ke,Qe,ct,st,ot=xe&&xe.ownerDocument,ft=xe?xe.nodeType:9;if(ke=ke||[],typeof fe!="string"||!fe||ft!==1&&ft!==9&&ft!==11)return ke;if(!De&&((xe?xe.ownerDocument||xe:lt)!==Le&&Re(xe),xe=xe||Le,rt)){if(ft!==11&&(Qe=Ki.exec(fe)))if($e=Qe[1]){if(ft===9){if(!(je=xe.getElementById($e)))return ke;if(je.id===$e)return ke.push(je),ke}else if(ot&&(je=ot.getElementById($e))&&Ft(xe,je)&&je.id===$e)return ke.push(je),ke}else{if(Qe[2])return Et.apply(ke,xe.getElementsByTagName(fe)),ke;if(($e=Qe[3])&&G.getElementsByClassName&&xe.getElementsByClassName)return Et.apply(ke,xe.getElementsByClassName($e)),ke}if(G.qsa&&!jt[fe+" "]&&(!tt||!tt.test(fe))&&(ft!==1||xe.nodeName.toLowerCase()!=="object")){if(st=fe,ot=xe,ft===1&&zi.test(fe)){for((Ke=xe.getAttribute("id"))?Ke=Ke.replace(gi,_i):xe.setAttribute("id",Ke=mt),ze=(ct=de(fe)).length;ze--;)ct[ze]="#"+Ke+" "+Cn(ct[ze]);st=ct.join(","),ot=Gn.test(fe)&&jn(xe.parentNode)||xe}try{return Et.apply(ke,ot.querySelectorAll(st)),ke}catch{jt(fe,!0)}finally{Ke===mt&&xe.removeAttribute("id")}}}return Te(fe.replace(Gt,"$1"),xe,ke,De)}function Sn(){var fe=[];return function xe(ke,De){return fe.push(ke+" ")>V.cacheLength&&delete xe[fe.shift()],xe[ke+" "]=De}}function Vt(fe){return fe[mt]=!0,fe}function Jt(fe){var xe=Le.createElement("fieldset");try{return!!fe(xe)}catch{return!1}finally{xe.parentNode&&xe.parentNode.removeChild(xe),xe=null}}function zn(fe,xe){for(var ke=fe.split("|"),De=ke.length;De--;)V.attrHandle[ke[De]]=xe}function vi(fe,xe){var ke=xe&&fe,De=ke&&fe.nodeType===1&&xe.nodeType===1&&fe.sourceIndex-xe.sourceIndex;if(De)return De;if(ke){for(;ke=ke.nextSibling;)if(ke===xe)return-1}return fe?1:-1}function Xi(fe){return function(xe){return xe.nodeName.toLowerCase()==="input"&&xe.type===fe}}function Ji(fe){return function(xe){var ke=xe.nodeName.toLowerCase();return(ke==="input"||ke==="button")&&xe.type===fe}}function bi(fe){return function(xe){return"form"in xe?xe.parentNode&&xe.disabled===!1?"label"in xe?"label"in xe.parentNode?xe.parentNode.disabled===fe:xe.disabled===fe:xe.isDisabled===fe||xe.isDisabled!==!fe&&Yi(xe)===fe:xe.disabled===fe:"label"in xe&&xe.disabled===fe}}function on(fe){return Vt(function(xe){return xe=+xe,Vt(function(ke,De){for(var $e,ze=fe([],ke.length,xe),je=ze.length;je--;)ke[$e=ze[je]]&&(ke[$e]=!(De[$e]=ke[$e]))})})}function jn(fe){return fe&&typeof fe.getElementsByTagName<"u"&&fe}for(P in G=vt.support={},ce=vt.isXML=function(fe){var xe=fe.namespaceURI,ke=(fe.ownerDocument||fe).documentElement;return!Wi.test(xe||ke&&ke.nodeName||"HTML")},Re=vt.setDocument=function(fe){var xe,ke,De=fe?fe.ownerDocument||fe:lt;return De!==Le&&De.nodeType===9&&De.documentElement&&(et=(Le=De).documentElement,rt=!ce(Le),lt!==Le&&(ke=Le.defaultView)&&ke.top!==ke&&(ke.addEventListener?ke.addEventListener("unload",mi,!1):ke.attachEvent&&ke.attachEvent("onunload",mi)),G.attributes=Jt(function($e){return $e.className="i",!$e.getAttribute("className")}),G.getElementsByTagName=Jt(function($e){return $e.appendChild(Le.createComment("")),!$e.getElementsByTagName("*").length}),G.getElementsByClassName=bn.test(Le.getElementsByClassName),G.getById=Jt(function($e){return et.appendChild($e).id=mt,!Le.getElementsByName||!Le.getElementsByName(mt).length}),G.getById?(V.filter.ID=function($e){var ze=$e.replace(en,tn);return function(je){return je.getAttribute("id")===ze}},V.find.ID=function($e,ze){if(typeof ze.getElementById<"u"&&rt){var je=ze.getElementById($e);return je?[je]:[]}}):(V.filter.ID=function($e){var ze=$e.replace(en,tn);return function(je){var Ke=typeof je.getAttributeNode<"u"&&je.getAttributeNode("id");return Ke&&Ke.value===ze}},V.find.ID=function($e,ze){if(typeof ze.getElementById<"u"&&rt){var je,Ke,Qe,ct=ze.getElementById($e);if(ct){if((je=ct.getAttributeNode("id"))&&je.value===$e)return[ct];for(Qe=ze.getElementsByName($e),Ke=0;ct=Qe[Ke++];)if((je=ct.getAttributeNode("id"))&&je.value===$e)return[ct]}return[]}}),V.find.TAG=G.getElementsByTagName?function($e,ze){return typeof ze.getElementsByTagName<"u"?ze.getElementsByTagName($e):G.qsa?ze.querySelectorAll($e):void 0}:function($e,ze){var je,Ke=[],Qe=0,ct=ze.getElementsByTagName($e);if($e==="*"){for(;je=ct[Qe++];)je.nodeType===1&&Ke.push(je);return Ke}return ct},V.find.CLASS=G.getElementsByClassName&&function($e,ze){if(typeof ze.getElementsByClassName<"u"&&rt)return ze.getElementsByClassName($e)},yt=[],tt=[],(G.qsa=bn.test(Le.querySelectorAll))&&(Jt(function($e){et.appendChild($e).innerHTML="<a id='"+mt+"'></a><select id='"+mt+"-\r\\' msallowcapture=''><option selected=''></option></select>",$e.querySelectorAll("[msallowcapture^='']").length&&tt.push("[*^$]="+dt+`*(?:''|"")`),$e.querySelectorAll("[selected]").length||tt.push("\\["+dt+"*(?:value|"+Xt+")"),$e.querySelectorAll("[id~="+mt+"-]").length||tt.push("~="),$e.querySelectorAll(":checked").length||tt.push(":checked"),$e.querySelectorAll("a#"+mt+"+*").length||tt.push(".#.+[+~]")}),Jt(function($e){$e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var ze=Le.createElement("input");ze.setAttribute("type","hidden"),$e.appendChild(ze).setAttribute("name","D"),$e.querySelectorAll("[name=d]").length&&tt.push("name"+dt+"*[*^$|!~]?="),$e.querySelectorAll(":enabled").length!==2&&tt.push(":enabled",":disabled"),et.appendChild($e).disabled=!0,$e.querySelectorAll(":disabled").length!==2&&tt.push(":enabled",":disabled"),$e.querySelectorAll("*,:x"),tt.push(",.*:")})),(G.matchesSelector=bn.test(kt=et.matches||et.webkitMatchesSelector||et.mozMatchesSelector||et.oMatchesSelector||et.msMatchesSelector))&&Jt(function($e){G.disconnectedMatch=kt.call($e,"*"),kt.call($e,"[s!='']:x"),yt.push("!=",Bt)}),tt=tt.length&&new RegExp(tt.join("|")),yt=yt.length&&new RegExp(yt.join("|")),xe=bn.test(et.compareDocumentPosition),Ft=xe||bn.test(et.contains)?function($e,ze){var je=$e.nodeType===9?$e.documentElement:$e,Ke=ze&&ze.parentNode;return $e===Ke||!(!Ke||Ke.nodeType!==1||!(je.contains?je.contains(Ke):$e.compareDocumentPosition&&16&$e.compareDocumentPosition(Ke)))}:function($e,ze){if(ze){for(;ze=ze.parentNode;)if(ze===$e)return!0}return!1},sn=xe?function($e,ze){if($e===ze)return Be=!0,0;var je=!$e.compareDocumentPosition-!ze.compareDocumentPosition;return je||(1&(je=($e.ownerDocument||$e)===(ze.ownerDocument||ze)?$e.compareDocumentPosition(ze):1)||!G.sortDetached&&ze.compareDocumentPosition($e)===je?$e===Le||$e.ownerDocument===lt&&Ft(lt,$e)?-1:ze===Le||ze.ownerDocument===lt&&Ft(lt,ze)?1:Ne?Ut(Ne,$e)-Ut(Ne,ze):0:4&je?-1:1)}:function($e,ze){if($e===ze)return Be=!0,0;var je,Ke=0,Qe=$e.parentNode,ct=ze.parentNode,st=[$e],ot=[ze];if(!Qe||!ct)return $e===Le?-1:ze===Le?1:Qe?-1:ct?1:Ne?Ut(Ne,$e)-Ut(Ne,ze):0;if(Qe===ct)return vi($e,ze);for(je=$e;je=je.parentNode;)st.unshift(je);for(je=ze;je=je.parentNode;)ot.unshift(je);for(;st[Ke]===ot[Ke];)Ke++;return Ke?vi(st[Ke],ot[Ke]):st[Ke]===lt?-1:ot[Ke]===lt?1:0}),Le},vt.matches=function(fe,xe){return vt(fe,null,null,xe)},vt.matchesSelector=function(fe,xe){if((fe.ownerDocument||fe)!==Le&&Re(fe),G.matchesSelector&&rt&&!jt[xe+" "]&&(!yt||!yt.test(xe))&&(!tt||!tt.test(xe)))try{var ke=kt.call(fe,xe);if(ke||G.disconnectedMatch||fe.document&&fe.document.nodeType!==11)return ke}catch{jt(xe,!0)}return 0<vt(xe,Le,null,[fe]).length},vt.contains=function(fe,xe){return(fe.ownerDocument||fe)!==Le&&Re(fe),Ft(fe,xe)},vt.attr=function(fe,xe){(fe.ownerDocument||fe)!==Le&&Re(fe);var ke=V.attrHandle[xe.toLowerCase()],De=ke&&dn.call(V.attrHandle,xe.toLowerCase())?ke(fe,xe,!rt):void 0;return De!==void 0?De:G.attributes||!rt?fe.getAttribute(xe):(De=fe.getAttributeNode(xe))&&De.specified?De.value:null},vt.escape=function(fe){return(fe+"").replace(gi,_i)},vt.error=function(fe){throw new Error("Syntax error, unrecognized expression: "+fe)},vt.uniqueSort=function(fe){var xe,ke=[],De=0,$e=0;if(Be=!G.detectDuplicates,Ne=!G.sortStable&&fe.slice(0),fe.sort(sn),Be){for(;xe=fe[$e++];)xe===fe[$e]&&(De=ke.push($e));for(;De--;)fe.splice(ke[De],1)}return Ne=null,fe},ie=vt.getText=function(fe){var xe,ke="",De=0,$e=fe.nodeType;if($e){if($e===1||$e===9||$e===11){if(typeof fe.textContent=="string")return fe.textContent;for(fe=fe.firstChild;fe;fe=fe.nextSibling)ke+=ie(fe)}else if($e===3||$e===4)return fe.nodeValue}else for(;xe=fe[De++];)ke+=ie(xe);return ke},(V=vt.selectors={cacheLength:50,createPseudo:Vt,match:An,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(fe){return fe[1]=fe[1].replace(en,tn),fe[3]=(fe[3]||fe[4]||fe[5]||"").replace(en,tn),fe[2]==="~="&&(fe[3]=" "+fe[3]+" "),fe.slice(0,4)},CHILD:function(fe){return fe[1]=fe[1].toLowerCase(),fe[1].slice(0,3)==="nth"?(fe[3]||vt.error(fe[0]),fe[4]=+(fe[4]?fe[5]+(fe[6]||1):2*(fe[3]==="even"||fe[3]==="odd")),fe[5]=+(fe[7]+fe[8]||fe[3]==="odd")):fe[3]&&vt.error(fe[0]),fe},PSEUDO:function(fe){var xe,ke=!fe[6]&&fe[2];return An.CHILD.test(fe[0])?null:(fe[3]?fe[2]=fe[4]||fe[5]||"":ke&&ji.test(ke)&&(xe=de(ke,!0))&&(xe=ke.indexOf(")",ke.length-xe)-ke.length)&&(fe[0]=fe[0].slice(0,xe),fe[2]=ke.slice(0,xe)),fe.slice(0,3))}},filter:{TAG:function(fe){var xe=fe.replace(en,tn).toLowerCase();return fe==="*"?function(){return!0}:function(ke){return ke.nodeName&&ke.nodeName.toLowerCase()===xe}},CLASS:function(fe){var xe=xt[fe+" "];return xe||(xe=new RegExp("(^|"+dt+")"+fe+"("+dt+"|$)"))&&xt(fe,function(ke){return xe.test(typeof ke.className=="string"&&ke.className||typeof ke.getAttribute<"u"&&ke.getAttribute("class")||"")})},ATTR:function(fe,xe,ke){return function(De){var $e=vt.attr(De,fe);return $e==null?xe==="!=":!xe||($e+="",xe==="="?$e===ke:xe==="!="?$e!==ke:xe==="^="?ke&&$e.indexOf(ke)===0:xe==="*="?ke&&-1<$e.indexOf(ke):xe==="$="?ke&&$e.slice(-ke.length)===ke:xe==="~="?-1<(" "+$e.replace(Ct," ")+" ").indexOf(ke):xe==="|="&&($e===ke||$e.slice(0,ke.length+1)===ke+"-"))}},CHILD:function(fe,xe,ke,De,$e){var ze=fe.slice(0,3)!=="nth",je=fe.slice(-4)!=="last",Ke=xe==="of-type";return De===1&&$e===0?function(Qe){return!!Qe.parentNode}:function(Qe,ct,st){var ot,ft,At,ut,$t,Pt,It=ze!==je?"nextSibling":"previousSibling",bt=Qe.parentNode,Zt=Ke&&Qe.nodeName.toLowerCase(),Rt=!st&&!Ke,Tt=!1;if(bt){if(ze){for(;It;){for(ut=Qe;ut=ut[It];)if(Ke?ut.nodeName.toLowerCase()===Zt:ut.nodeType===1)return!1;Pt=It=fe==="only"&&!Pt&&"nextSibling"}return!0}if(Pt=[je?bt.firstChild:bt.lastChild],je&&Rt){for(Tt=($t=(ot=(ft=(At=(ut=bt)[mt]||(ut[mt]={}))[ut.uniqueID]||(At[ut.uniqueID]={}))[fe]||[])[0]===Nt&&ot[1])&&ot[2],ut=$t&&bt.childNodes[$t];ut=++$t&&ut&&ut[It]||(Tt=$t=0)||Pt.pop();)if(ut.nodeType===1&&++Tt&&ut===Qe){ft[fe]=[Nt,$t,Tt];break}}else if(Rt&&(Tt=$t=(ot=(ft=(At=(ut=Qe)[mt]||(ut[mt]={}))[ut.uniqueID]||(At[ut.uniqueID]={}))[fe]||[])[0]===Nt&&ot[1]),Tt===!1)for(;(ut=++$t&&ut&&ut[It]||(Tt=$t=0)||Pt.pop())&&!((Ke?ut.nodeName.toLowerCase()===Zt:ut.nodeType===1)&&++Tt&&(Rt&&((ft=(At=ut[mt]||(ut[mt]={}))[ut.uniqueID]||(At[ut.uniqueID]={}))[fe]=[Nt,Tt]),ut===Qe)););return(Tt-=$e)===De||Tt%De==0&&0<=Tt/De}}},PSEUDO:function(fe,xe){var ke,De=V.pseudos[fe]||V.setFilters[fe.toLowerCase()]||vt.error("unsupported pseudo: "+fe);return De[mt]?De(xe):1<De.length?(ke=[fe,fe,"",xe],V.setFilters.hasOwnProperty(fe.toLowerCase())?Vt(function($e,ze){for(var je,Ke=De($e,xe),Qe=Ke.length;Qe--;)$e[je=Ut($e,Ke[Qe])]=!(ze[je]=Ke[Qe])}):function($e){return De($e,0,ke)}):De}},pseudos:{not:Vt(function(fe){var xe=[],ke=[],De=ye(fe.replace(Gt,"$1"));return De[mt]?Vt(function($e,ze,je,Ke){for(var Qe,ct=De($e,null,Ke,[]),st=$e.length;st--;)(Qe=ct[st])&&($e[st]=!(ze[st]=Qe))}):function($e,ze,je){return xe[0]=$e,De(xe,null,je,ke),xe[0]=null,!ke.pop()}}),has:Vt(function(fe){return function(xe){return 0<vt(fe,xe).length}}),contains:Vt(function(fe){return fe=fe.replace(en,tn),function(xe){return-1<(xe.textContent||ie(xe)).indexOf(fe)}}),lang:Vt(function(fe){return Hi.test(fe||"")||vt.error("unsupported lang: "+fe),fe=fe.replace(en,tn).toLowerCase(),function(xe){var ke;do if(ke=rt?xe.lang:xe.getAttribute("xml:lang")||xe.getAttribute("lang"))return(ke=ke.toLowerCase())===fe||ke.indexOf(fe+"-")===0;while((xe=xe.parentNode)&&xe.nodeType===1);return!1}}),target:function(fe){var xe=p.location&&p.location.hash;return xe&&xe.slice(1)===fe.id},root:function(fe){return fe===et},focus:function(fe){return fe===Le.activeElement&&(!Le.hasFocus||Le.hasFocus())&&!!(fe.type||fe.href||~fe.tabIndex)},enabled:bi(!1),disabled:bi(!0),checked:function(fe){var xe=fe.nodeName.toLowerCase();return xe==="input"&&!!fe.checked||xe==="option"&&!!fe.selected},selected:function(fe){return fe.parentNode&&fe.parentNode.selectedIndex,fe.selected===!0},empty:function(fe){for(fe=fe.firstChild;fe;fe=fe.nextSibling)if(fe.nodeType<6)return!1;return!0},parent:function(fe){return!V.pseudos.empty(fe)},header:function(fe){return Vi.test(fe.nodeName)},input:function(fe){return qi.test(fe.nodeName)},button:function(fe){var xe=fe.nodeName.toLowerCase();return xe==="input"&&fe.type==="button"||xe==="button"},text:function(fe){var xe;return fe.nodeName.toLowerCase()==="input"&&fe.type==="text"&&((xe=fe.getAttribute("type"))==null||xe.toLowerCase()==="text")},first:on(function(){return[0]}),last:on(function(fe,xe){return[xe-1]}),eq:on(function(fe,xe,ke){return[ke<0?ke+xe:ke]}),even:on(function(fe,xe){for(var ke=0;ke<xe;ke+=2)fe.push(ke);return fe}),odd:on(function(fe,xe){for(var ke=1;ke<xe;ke+=2)fe.push(ke);return fe}),lt:on(function(fe,xe,ke){for(var De=ke<0?ke+xe:xe<ke?xe:ke;0<=--De;)fe.push(De);return fe}),gt:on(function(fe,xe,ke){for(var De=ke<0?ke+xe:ke;++De<xe;)fe.push(De);return fe})}}).pseudos.nth=V.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})V.pseudos[P]=Xi(P);for(P in{submit:!0,reset:!0})V.pseudos[P]=Ji(P);function wi(){}function Cn(fe){for(var xe=0,ke=fe.length,De="";xe<ke;xe++)De+=fe[xe].value;return De}function Tn(fe,xe,ke){var De=xe.dir,$e=xe.next,ze=$e||De,je=ke&&ze==="parentNode",Ke=pt++;return xe.first?function(Qe,ct,st){for(;Qe=Qe[De];)if(Qe.nodeType===1||je)return fe(Qe,ct,st);return!1}:function(Qe,ct,st){var ot,ft,At,ut=[Nt,Ke];if(st){for(;Qe=Qe[De];)if((Qe.nodeType===1||je)&&fe(Qe,ct,st))return!0}else for(;Qe=Qe[De];)if(Qe.nodeType===1||je)if(ft=(At=Qe[mt]||(Qe[mt]={}))[Qe.uniqueID]||(At[Qe.uniqueID]={}),$e&&$e===Qe.nodeName.toLowerCase())Qe=Qe[De]||Qe;else{if((ot=ft[ze])&&ot[0]===Nt&&ot[1]===Ke)return ut[2]=ot[2];if((ft[ze]=ut)[2]=fe(Qe,ct,st))return!0}return!1}}function Hn(fe){return 1<fe.length?function(xe,ke,De){for(var $e=fe.length;$e--;)if(!fe[$e](xe,ke,De))return!1;return!0}:fe[0]}function kn(fe,xe,ke,De,$e){for(var ze,je=[],Ke=0,Qe=fe.length,ct=xe!=null;Ke<Qe;Ke++)(ze=fe[Ke])&&(ke&&!ke(ze,De,$e)||(je.push(ze),ct&&xe.push(Ke)));return je}function Wn(fe,xe,ke,De,$e,ze){return De&&!De[mt]&&(De=Wn(De)),$e&&!$e[mt]&&($e=Wn($e,ze)),Vt(function(je,Ke,Qe,ct){var st,ot,ft,At=[],ut=[],$t=Ke.length,Pt=je||function(Zt,Rt,Tt){for(var Kt=0,Mn=Rt.length;Kt<Mn;Kt++)vt(Zt,Rt[Kt],Tt);return Tt}(xe||"*",Qe.nodeType?[Qe]:Qe,[]),It=!fe||!je&&xe?Pt:kn(Pt,At,fe,Qe,ct),bt=ke?$e||(je?fe:$t||De)?[]:Ke:It;if(ke&&ke(It,bt,Qe,ct),De)for(st=kn(bt,ut),De(st,[],Qe,ct),ot=st.length;ot--;)(ft=st[ot])&&(bt[ut[ot]]=!(It[ut[ot]]=ft));if(je){if($e||fe){if($e){for(st=[],ot=bt.length;ot--;)(ft=bt[ot])&&st.push(It[ot]=ft);$e(null,bt=[],st,ct)}for(ot=bt.length;ot--;)(ft=bt[ot])&&-1<(st=$e?Ut(je,ft):At[ot])&&(je[st]=!(Ke[st]=ft))}}else bt=kn(bt===Ke?bt.splice($t,bt.length):bt),$e?$e(null,Ke,bt,ct):Et.apply(Ke,bt)})}function qn(fe){for(var xe,ke,De,$e=fe.length,ze=V.relative[fe[0].type],je=ze||V.relative[" "],Ke=ze?1:0,Qe=Tn(function(ot){return ot===xe},je,!0),ct=Tn(function(ot){return-1<Ut(xe,ot)},je,!0),st=[function(ot,ft,At){var ut=!ze&&(At||ft!==Me)||((xe=ft).nodeType?Qe(ot,ft,At):ct(ot,ft,At));return xe=null,ut}];Ke<$e;Ke++)if(ke=V.relative[fe[Ke].type])st=[Tn(Hn(st),ke)];else{if((ke=V.filter[fe[Ke].type].apply(null,fe[Ke].matches))[mt]){for(De=++Ke;De<$e&&!V.relative[fe[De].type];De++);return Wn(1<Ke&&Hn(st),1<Ke&&Cn(fe.slice(0,Ke-1).concat({value:fe[Ke-2].type===" "?"*":""})).replace(Gt,"$1"),ke,Ke<De&&qn(fe.slice(Ke,De)),De<$e&&qn(fe=fe.slice(De)),De<$e&&Cn(fe))}st.push(ke)}return Hn(st)}return wi.prototype=V.filters=V.pseudos,V.setFilters=new wi,de=vt.tokenize=function(fe,xe){var ke,De,$e,ze,je,Ke,Qe,ct=vn[fe+" "];if(ct)return xe?0:ct.slice(0);for(je=fe,Ke=[],Qe=V.preFilter;je;){for(ze in ke&&!(De=fn.exec(je))||(De&&(je=je.slice(De[0].length)||je),Ke.push($e=[])),ke=!1,(De=Bn.exec(je))&&(ke=De.shift(),$e.push({value:ke,type:De[0].replace(Gt," ")}),je=je.slice(ke.length)),V.filter)!(De=An[ze].exec(je))||Qe[ze]&&!(De=Qe[ze](De))||(ke=De.shift(),$e.push({value:ke,type:ze,matches:De}),je=je.slice(ke.length));if(!ke)break}return xe?je.length:je?vt.error(fe):vn(fe,Ke).slice(0)},ye=vt.compile=function(fe,xe){var ke,De,$e,ze,je,Ke,Qe=[],ct=[],st=En[fe+" "];if(!st){for(xe||(xe=de(fe)),ke=xe.length;ke--;)(st=qn(xe[ke]))[mt]?Qe.push(st):ct.push(st);(st=En(fe,(De=ct,ze=0<($e=Qe).length,je=0<De.length,Ke=function(ot,ft,At,ut,$t){var Pt,It,bt,Zt=0,Rt="0",Tt=ot&&[],Kt=[],Mn=Me,yi=ot||je&&V.find.TAG("*",$t),xi=Nt+=Mn==null?1:Math.random()||.1,Zi=yi.length;for($t&&(Me=ft===Le||ft||$t);Rt!==Zi&&(Pt=yi[Rt])!=null;Rt++){if(je&&Pt){for(It=0,ft||Pt.ownerDocument===Le||(Re(Pt),At=!rt);bt=De[It++];)if(bt(Pt,ft||Le,At)){ut.push(Pt);break}$t&&(Nt=xi)}ze&&((Pt=!bt&&Pt)&&Zt--,ot&&Tt.push(Pt))}if(Zt+=Rt,ze&&Rt!==Zt){for(It=0;bt=$e[It++];)bt(Tt,Kt,ft,At);if(ot){if(0<Zt)for(;Rt--;)Tt[Rt]||Kt[Rt]||(Kt[Rt]=hn.call(ut));Kt=kn(Kt)}Et.apply(ut,Kt),$t&&!ot&&0<Kt.length&&1<Zt+$e.length&&vt.uniqueSort(ut)}return $t&&(Nt=xi,Me=Mn),Tt},ze?Vt(Ke):Ke))).selector=fe}return st},Te=vt.select=function(fe,xe,ke,De){var $e,ze,je,Ke,Qe,ct=typeof fe=="function"&&fe,st=!De&&de(fe=ct.selector||fe);if(ke=ke||[],st.length===1){if(2<(ze=st[0]=st[0].slice(0)).length&&(je=ze[0]).type==="ID"&&xe.nodeType===9&&rt&&V.relative[ze[1].type]){if(!(xe=(V.find.ID(je.matches[0].replace(en,tn),xe)||[])[0]))return ke;ct&&(xe=xe.parentNode),fe=fe.slice(ze.shift().value.length)}for($e=An.needsContext.test(fe)?0:ze.length;$e--&&(je=ze[$e],!V.relative[Ke=je.type]);)if((Qe=V.find[Ke])&&(De=Qe(je.matches[0].replace(en,tn),Gn.test(ze[0].type)&&jn(xe.parentNode)||xe))){if(ze.splice($e,1),!(fe=De.length&&Cn(ze)))return Et.apply(ke,De),ke;break}}return(ct||ye(fe,st))(De,xe,!rt,ke,!xe||Gn.test(fe)&&jn(xe.parentNode)||xe),ke},G.sortStable=mt.split("").sort(sn).join("")===mt,G.detectDuplicates=!!Be,Re(),G.sortDetached=Jt(function(fe){return 1&fe.compareDocumentPosition(Le.createElement("fieldset"))}),Jt(function(fe){return fe.innerHTML="<a href='#'></a>",fe.firstChild.getAttribute("href")==="#"})||zn("type|href|height|width",function(fe,xe,ke){if(!ke)return fe.getAttribute(xe,xe.toLowerCase()==="type"?1:2)}),G.attributes&&Jt(function(fe){return fe.innerHTML="<input/>",fe.firstChild.setAttribute("value",""),fe.firstChild.getAttribute("value")===""})||zn("value",function(fe,xe,ke){if(!ke&&fe.nodeName.toLowerCase()==="input")return fe.defaultValue}),Jt(function(fe){return fe.getAttribute("disabled")==null})||zn(Xt,function(fe,xe,ke){var De;if(!ke)return fe[xe]===!0?xe.toLowerCase():(De=fe.getAttributeNode(xe))&&De.specified?De.value:null}),vt}(e);u.find=v,u.expr=v.selectors,u.expr[":"]=u.expr.pseudos,u.uniqueSort=u.unique=v.uniqueSort,u.text=v.getText,u.isXMLDoc=v.isXML,u.contains=v.contains,u.escapeSelector=v.escape;var T=function(p,P,G){for(var V=[],ie=G!==void 0;(p=p[P])&&p.nodeType!==9;)if(p.nodeType===1){if(ie&&u(p).is(G))break;V.push(p)}return V},k=function(p,P){for(var G=[];p;p=p.nextSibling)p.nodeType===1&&p!==P&&G.push(p);return G},L=u.expr.match.needsContext;function A(p,P){return p.nodeName&&p.nodeName.toLowerCase()===P.toLowerCase()}var F=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function K(p,P,G){return x(P)?u.grep(p,function(V,ie){return!!P.call(V,ie,V)!==G}):P.nodeType?u.grep(p,function(V){return V===P!==G}):typeof P!="string"?u.grep(p,function(V){return-1<l.call(P,V)!==G}):u.filter(P,p,G)}u.filter=function(p,P,G){var V=P[0];return G&&(p=":not("+p+")"),P.length===1&&V.nodeType===1?u.find.matchesSelector(V,p)?[V]:[]:u.find.matches(p,u.grep(P,function(ie){return ie.nodeType===1}))},u.fn.extend({find:function(p){var P,G,V=this.length,ie=this;if(typeof p!="string")return this.pushStack(u(p).filter(function(){for(P=0;P<V;P++)if(u.contains(ie[P],this))return!0}));for(G=this.pushStack([]),P=0;P<V;P++)u.find(p,ie[P],G);return 1<V?u.uniqueSort(G):G},filter:function(p){return this.pushStack(K(this,p||[],!1))},not:function(p){return this.pushStack(K(this,p||[],!0))},is:function(p){return!!K(this,typeof p=="string"&&L.test(p)?u(p):p||[],!1).length}});var Q,Z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(u.fn.init=function(p,P,G){var V,ie;if(!p)return this;if(G=G||Q,typeof p=="string"){if(!(V=p[0]==="<"&&p[p.length-1]===">"&&3<=p.length?[null,p,null]:Z.exec(p))||!V[1]&&P)return!P||P.jquery?(P||G).find(p):this.constructor(P).find(p);if(V[1]){if(P=P instanceof u?P[0]:P,u.merge(this,u.parseHTML(V[1],P&&P.nodeType?P.ownerDocument||P:t,!0)),F.test(V[1])&&u.isPlainObject(P))for(V in P)x(this[V])?this[V](P[V]):this.attr(V,P[V]);return this}return(ie=t.getElementById(V[2]))&&(this[0]=ie,this.length=1),this}return p.nodeType?(this[0]=p,this.length=1,this):x(p)?G.ready!==void 0?G.ready(p):p(u):u.makeArray(p,this)}).prototype=u.fn,Q=u(t);var B=/^(?:parents|prev(?:Until|All))/,z={children:!0,contents:!0,next:!0,prev:!0};function b(p,P){for(;(p=p[P])&&p.nodeType!==1;);return p}u.fn.extend({has:function(p){var P=u(p,this),G=P.length;return this.filter(function(){for(var V=0;V<G;V++)if(u.contains(this,P[V]))return!0})},closest:function(p,P){var G,V=0,ie=this.length,ce=[],de=typeof p!="string"&&u(p);if(!L.test(p)){for(;V<ie;V++)for(G=this[V];G&&G!==P;G=G.parentNode)if(G.nodeType<11&&(de?-1<de.index(G):G.nodeType===1&&u.find.matchesSelector(G,p))){ce.push(G);break}}return this.pushStack(1<ce.length?u.uniqueSort(ce):ce)},index:function(p){return p?typeof p=="string"?l.call(u(p),this[0]):l.call(this,p.jquery?p[0]:p):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(p,P){return this.pushStack(u.uniqueSort(u.merge(this.get(),u(p,P))))},addBack:function(p){return this.add(p==null?this.prevObject:this.prevObject.filter(p))}}),u.each({parent:function(p){var P=p.parentNode;return P&&P.nodeType!==11?P:null},parents:function(p){return T(p,"parentNode")},parentsUntil:function(p,P,G){return T(p,"parentNode",G)},next:function(p){return b(p,"nextSibling")},prev:function(p){return b(p,"previousSibling")},nextAll:function(p){return T(p,"nextSibling")},prevAll:function(p){return T(p,"previousSibling")},nextUntil:function(p,P,G){return T(p,"nextSibling",G)},prevUntil:function(p,P,G){return T(p,"previousSibling",G)},siblings:function(p){return k((p.parentNode||{}).firstChild,p)},children:function(p){return k(p.firstChild)},contents:function(p){return typeof p.contentDocument<"u"?p.contentDocument:(A(p,"template")&&(p=p.content||p),u.merge([],p.childNodes))}},function(p,P){u.fn[p]=function(G,V){var ie=u.map(this,P,G);return p.slice(-5)!=="Until"&&(V=G),V&&typeof V=="string"&&(ie=u.filter(V,ie)),1<this.length&&(z[p]||u.uniqueSort(ie),B.test(p)&&ie.reverse()),this.pushStack(ie)}});var N=/[^\x20\t\r\n\f]+/g;function U(p){return p}function q(p){throw p}function j(p,P,G,V){var ie;try{p&&x(ie=p.promise)?ie.call(p).done(P).fail(G):p&&x(ie=p.then)?ie.call(p,P,G):P.apply(void 0,[p].slice(V))}catch(ce){G.apply(void 0,[ce])}}u.Callbacks=function(p){var P,G;p=typeof p=="string"?(P=p,G={},u.each(P.match(N)||[],function(Re,Le){G[Le]=!0}),G):u.extend({},p);var V,ie,ce,de,ye=[],Te=[],Me=-1,Ne=function(){for(de=de||p.once,ce=V=!0;Te.length;Me=-1)for(ie=Te.shift();++Me<ye.length;)ye[Me].apply(ie[0],ie[1])===!1&&p.stopOnFalse&&(Me=ye.length,ie=!1);p.memory||(ie=!1),V=!1,de&&(ye=ie?[]:"")},Be={add:function(){return ye&&(ie&&!V&&(Me=ye.length-1,Te.push(ie)),function Re(Le){u.each(Le,function(et,rt){x(rt)?p.unique&&Be.has(rt)||ye.push(rt):rt&&rt.length&&R(rt)!=="string"&&Re(rt)})}(arguments),ie&&!V&&Ne()),this},remove:function(){return u.each(arguments,function(Re,Le){for(var et;-1<(et=u.inArray(Le,ye,et));)ye.splice(et,1),et<=Me&&Me--}),this},has:function(Re){return Re?-1<u.inArray(Re,ye):0<ye.length},empty:function(){return ye&&(ye=[]),this},disable:function(){return de=Te=[],ye=ie="",this},disabled:function(){return!ye},lock:function(){return de=Te=[],ie||V||(ye=ie=""),this},locked:function(){return!!de},fireWith:function(Re,Le){return de||(Le=[Re,(Le=Le||[]).slice?Le.slice():Le],Te.push(Le),V||Ne()),this},fire:function(){return Be.fireWith(this,arguments),this},fired:function(){return!!ce}};return Be},u.extend({Deferred:function(p){var P=[["notify","progress",u.Callbacks("memory"),u.Callbacks("memory"),2],["resolve","done",u.Callbacks("once memory"),u.Callbacks("once memory"),0,"resolved"],["reject","fail",u.Callbacks("once memory"),u.Callbacks("once memory"),1,"rejected"]],G="pending",V={state:function(){return G},always:function(){return ie.done(arguments).fail(arguments),this},catch:function(ce){return V.then(null,ce)},pipe:function(){var ce=arguments;return u.Deferred(function(de){u.each(P,function(ye,Te){var Me=x(ce[Te[4]])&&ce[Te[4]];ie[Te[1]](function(){var Ne=Me&&Me.apply(this,arguments);Ne&&x(Ne.promise)?Ne.promise().progress(de.notify).done(de.resolve).fail(de.reject):de[Te[0]+"With"](this,Me?[Ne]:arguments)})}),ce=null}).promise()},then:function(ce,de,ye){var Te=0;function Me(Ne,Be,Re,Le){return function(){var et=this,rt=arguments,tt=function(){var kt,Ft;if(!(Ne<Te)){if((kt=Re.apply(et,rt))===Be.promise())throw new TypeError("Thenable self-resolution");Ft=kt&&(typeof kt=="object"||typeof kt=="function")&&kt.then,x(Ft)?Le?Ft.call(kt,Me(Te,Be,U,Le),Me(Te,Be,q,Le)):(Te++,Ft.call(kt,Me(Te,Be,U,Le),Me(Te,Be,q,Le),Me(Te,Be,U,Be.notifyWith))):(Re!==U&&(et=void 0,rt=[kt]),(Le||Be.resolveWith)(et,rt))}},yt=Le?tt:function(){try{tt()}catch(kt){u.Deferred.exceptionHook&&u.Deferred.exceptionHook(kt,yt.stackTrace),Te<=Ne+1&&(Re!==q&&(et=void 0,rt=[kt]),Be.rejectWith(et,rt))}};Ne?yt():(u.Deferred.getStackHook&&(yt.stackTrace=u.Deferred.getStackHook()),e.setTimeout(yt))}}return u.Deferred(function(Ne){P[0][3].add(Me(0,Ne,x(ye)?ye:U,Ne.notifyWith)),P[1][3].add(Me(0,Ne,x(ce)?ce:U)),P[2][3].add(Me(0,Ne,x(de)?de:q))}).promise()},promise:function(ce){return ce!=null?u.extend(ce,V):V}},ie={};return u.each(P,function(ce,de){var ye=de[2],Te=de[5];V[de[1]]=ye.add,Te&&ye.add(function(){G=Te},P[3-ce][2].disable,P[3-ce][3].disable,P[0][2].lock,P[0][3].lock),ye.add(de[3].fire),ie[de[0]]=function(){return ie[de[0]+"With"](this===ie?void 0:this,arguments),this},ie[de[0]+"With"]=ye.fireWith}),V.promise(ie),p&&p.call(ie,ie),ie},when:function(p){var P=arguments.length,G=P,V=Array(G),ie=a.call(arguments),ce=u.Deferred(),de=function(ye){return function(Te){V[ye]=this,ie[ye]=1<arguments.length?a.call(arguments):Te,--P||ce.resolveWith(V,ie)}};if(P<=1&&(j(p,ce.done(de(G)).resolve,ce.reject,!P),ce.state()==="pending"||x(ie[G]&&ie[G].then)))return ce.then();for(;G--;)j(ie[G],de(G),ce.reject);return ce.promise()}});var Y=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;u.Deferred.exceptionHook=function(p,P){e.console&&e.console.warn&&p&&Y.test(p.name)&&e.console.warn("jQuery.Deferred exception: "+p.message,p.stack,P)},u.readyException=function(p){e.setTimeout(function(){throw p})};var J=u.Deferred();function se(){t.removeEventListener("DOMContentLoaded",se),e.removeEventListener("load",se),u.ready()}u.fn.ready=function(p){return J.then(p).catch(function(P){u.readyException(P)}),this},u.extend({isReady:!1,readyWait:1,ready:function(p){(p===!0?--u.readyWait:u.isReady)||(u.isReady=!0)!==p&&0<--u.readyWait||J.resolveWith(t,[u])}}),u.ready.then=J.then,t.readyState==="complete"||t.readyState!=="loading"&&!t.documentElement.doScroll?e.setTimeout(u.ready):(t.addEventListener("DOMContentLoaded",se),e.addEventListener("load",se));var pe=function(p,P,G,V,ie,ce,de){var ye=0,Te=p.length,Me=G==null;if(R(G)==="object")for(ye in ie=!0,G)pe(p,P,ye,G[ye],!0,ce,de);else if(V!==void 0&&(ie=!0,x(V)||(de=!0),Me&&(de?(P.call(p,V),P=null):(Me=P,P=function(Ne,Be,Re){return Me.call(u(Ne),Re)})),P))for(;ye<Te;ye++)P(p[ye],G,de?V:V.call(p[ye],ye,P(p[ye],G)));return ie?p:Me?P.call(p):Te?P(p[0],G):ce},_e=/^-ms-/,Ee=/-([a-z])/g;function X(p,P){return P.toUpperCase()}function D(p){return p.replace(_e,"ms-").replace(Ee,X)}var te=function(p){return p.nodeType===1||p.nodeType===9||!+p.nodeType};function re(){this.expando=u.expando+re.uid++}re.uid=1,re.prototype={cache:function(p){var P=p[this.expando];return P||(P={},te(p)&&(p.nodeType?p[this.expando]=P:Object.defineProperty(p,this.expando,{value:P,configurable:!0}))),P},set:function(p,P,G){var V,ie=this.cache(p);if(typeof P=="string")ie[D(P)]=G;else for(V in P)ie[D(V)]=P[V];return ie},get:function(p,P){return P===void 0?this.cache(p):p[this.expando]&&p[this.expando][D(P)]},access:function(p,P,G){return P===void 0||P&&typeof P=="string"&&G===void 0?this.get(p,P):(this.set(p,P,G),G!==void 0?G:P)},remove:function(p,P){var G,V=p[this.expando];if(V!==void 0){if(P!==void 0)for(G=(P=Array.isArray(P)?P.map(D):(P=D(P))in V?[P]:P.match(N)||[]).length;G--;)delete V[P[G]];(P===void 0||u.isEmptyObject(V))&&(p.nodeType?p[this.expando]=void 0:delete p[this.expando])}},hasData:function(p){var P=p[this.expando];return P!==void 0&&!u.isEmptyObject(P)}};var oe=new re,ve=new re,ee=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,le=/[A-Z]/g;function H(p,P,G){var V,ie;if(G===void 0&&p.nodeType===1)if(V="data-"+P.replace(le,"-$&").toLowerCase(),typeof(G=p.getAttribute(V))=="string"){try{G=(ie=G)==="true"||ie!=="false"&&(ie==="null"?null:ie===+ie+""?+ie:ee.test(ie)?JSON.parse(ie):ie)}catch{}ve.set(p,P,G)}else G=void 0;return G}u.extend({hasData:function(p){return ve.hasData(p)||oe.hasData(p)},data:function(p,P,G){return ve.access(p,P,G)},removeData:function(p,P){ve.remove(p,P)},_data:function(p,P,G){return oe.access(p,P,G)},_removeData:function(p,P){oe.remove(p,P)}}),u.fn.extend({data:function(p,P){var G,V,ie,ce=this[0],de=ce&&ce.attributes;if(p===void 0){if(this.length&&(ie=ve.get(ce),ce.nodeType===1&&!oe.get(ce,"hasDataAttrs"))){for(G=de.length;G--;)de[G]&&(V=de[G].name).indexOf("data-")===0&&(V=D(V.slice(5)),H(ce,V,ie[V]));oe.set(ce,"hasDataAttrs",!0)}return ie}return typeof p=="object"?this.each(function(){ve.set(this,p)}):pe(this,function(ye){var Te;if(ce&&ye===void 0)return(Te=ve.get(ce,p))!==void 0||(Te=H(ce,p))!==void 0?Te:void 0;this.each(function(){ve.set(this,p,ye)})},null,P,1<arguments.length,null,!0)},removeData:function(p){return this.each(function(){ve.remove(this,p)})}}),u.extend({queue:function(p,P,G){var V;if(p)return P=(P||"fx")+"queue",V=oe.get(p,P),G&&(!V||Array.isArray(G)?V=oe.access(p,P,u.makeArray(G)):V.push(G)),V||[]},dequeue:function(p,P){P=P||"fx";var G=u.queue(p,P),V=G.length,ie=G.shift(),ce=u._queueHooks(p,P);ie==="inprogress"&&(ie=G.shift(),V--),ie&&(P==="fx"&&G.unshift("inprogress"),delete ce.stop,ie.call(p,function(){u.dequeue(p,P)},ce)),!V&&ce&&ce.empty.fire()},_queueHooks:function(p,P){var G=P+"queueHooks";return oe.get(p,G)||oe.access(p,G,{empty:u.Callbacks("once memory").add(function(){oe.remove(p,[P+"queue",G])})})}}),u.fn.extend({queue:function(p,P){var G=2;return typeof p!="string"&&(P=p,p="fx",G--),arguments.length<G?u.queue(this[0],p):P===void 0?this:this.each(function(){var V=u.queue(this,p,P);u._queueHooks(this,p),p==="fx"&&V[0]!=="inprogress"&&u.dequeue(this,p)})},dequeue:function(p){return this.each(function(){u.dequeue(this,p)})},clearQueue:function(p){return this.queue(p||"fx",[])},promise:function(p,P){var G,V=1,ie=u.Deferred(),ce=this,de=this.length,ye=function(){--V||ie.resolveWith(ce,[ce])};for(typeof p!="string"&&(P=p,p=void 0),p=p||"fx";de--;)(G=oe.get(ce[de],p+"queueHooks"))&&G.empty&&(V++,G.empty.add(ye));return ye(),ie.promise(P)}});var I=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,O=new RegExp("^(?:([+-])=|)("+I+")([a-z%]*)$","i"),ae=["Top","Right","Bottom","Left"],me=t.documentElement,Ae=function(p){return u.contains(p.ownerDocument,p)},Se={composed:!0};me.getRootNode&&(Ae=function(p){return u.contains(p.ownerDocument,p)||p.getRootNode(Se)===p.ownerDocument});var Ge=function(p,P){return(p=P||p).style.display==="none"||p.style.display===""&&Ae(p)&&u.css(p,"display")==="none"},Xe=function(p,P,G,V){var ie,ce,de={};for(ce in P)de[ce]=p.style[ce],p.style[ce]=P[ce];for(ce in ie=G.apply(p,[]),P)p.style[ce]=de[ce];return ie};function Ue(p,P,G,V){var ie,ce,de=20,ye=V?function(){return V.cur()}:function(){return u.css(p,P,"")},Te=ye(),Me=G&&G[3]||(u.cssNumber[P]?"":"px"),Ne=p.nodeType&&(u.cssNumber[P]||Me!=="px"&&+Te)&&O.exec(u.css(p,P));if(Ne&&Ne[3]!==Me){for(Te/=2,Me=Me||Ne[3],Ne=+Te||1;de--;)u.style(p,P,Ne+Me),(1-ce)*(1-(ce=ye()/Te||.5))<=0&&(de=0),Ne/=ce;Ne*=2,u.style(p,P,Ne+Me),G=G||[]}return G&&(Ne=+Ne||+Te||0,ie=G[1]?Ne+(G[1]+1)*G[2]:+G[2],V&&(V.unit=Me,V.start=Ne,V.end=ie)),ie}var Ze={};function He(p,P){for(var G,V,ie,ce,de,ye,Te,Me=[],Ne=0,Be=p.length;Ne<Be;Ne++)(V=p[Ne]).style&&(G=V.style.display,P?(G==="none"&&(Me[Ne]=oe.get(V,"display")||null,Me[Ne]||(V.style.display="")),V.style.display===""&&Ge(V)&&(Me[Ne]=(Te=de=ce=void 0,de=(ie=V).ownerDocument,ye=ie.nodeName,(Te=Ze[ye])||(ce=de.body.appendChild(de.createElement(ye)),Te=u.css(ce,"display"),ce.parentNode.removeChild(ce),Te==="none"&&(Te="block"),Ze[ye]=Te)))):G!=="none"&&(Me[Ne]="none",oe.set(V,"display",G)));for(Ne=0;Ne<Be;Ne++)Me[Ne]!=null&&(p[Ne].style.display=Me[Ne]);return p}u.fn.extend({show:function(){return He(this,!0)},hide:function(){return He(this)},toggle:function(p){return typeof p=="boolean"?p?this.show():this.hide():this.each(function(){Ge(this)?u(this).show():u(this).hide()})}});var Je=/^(?:checkbox|radio)$/i,nt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,qe=/^$|^module$|\/(?:java|ecma)script/i,W={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ne(p,P){var G;return G=typeof p.getElementsByTagName<"u"?p.getElementsByTagName(P||"*"):typeof p.querySelectorAll<"u"?p.querySelectorAll(P||"*"):[],P===void 0||P&&A(p,P)?u.merge([p],G):G}function ue(p,P){for(var G=0,V=p.length;G<V;G++)oe.set(p[G],"globalEval",!P||oe.get(P[G],"globalEval"))}W.optgroup=W.option,W.tbody=W.tfoot=W.colgroup=W.caption=W.thead,W.th=W.td;var he,we,Pe=/<|&#?\w+;/;function ge(p,P,G,V,ie){for(var ce,de,ye,Te,Me,Ne,Be=P.createDocumentFragment(),Re=[],Le=0,et=p.length;Le<et;Le++)if((ce=p[Le])||ce===0)if(R(ce)==="object")u.merge(Re,ce.nodeType?[ce]:ce);else if(Pe.test(ce)){for(de=de||Be.appendChild(P.createElement("div")),ye=(nt.exec(ce)||["",""])[1].toLowerCase(),Te=W[ye]||W._default,de.innerHTML=Te[1]+u.htmlPrefilter(ce)+Te[2],Ne=Te[0];Ne--;)de=de.lastChild;u.merge(Re,de.childNodes),(de=Be.firstChild).textContent=""}else Re.push(P.createTextNode(ce));for(Be.textContent="",Le=0;ce=Re[Le++];)if(V&&-1<u.inArray(ce,V))ie&&ie.push(ce);else if(Me=Ae(ce),de=ne(Be.appendChild(ce),"script"),Me&&ue(de),G)for(Ne=0;ce=de[Ne++];)qe.test(ce.type||"")&&G.push(ce);return Be}he=t.createDocumentFragment().appendChild(t.createElement("div")),(we=t.createElement("input")).setAttribute("type","radio"),we.setAttribute("checked","checked"),we.setAttribute("name","t"),he.appendChild(we),g.checkClone=he.cloneNode(!0).cloneNode(!0).lastChild.checked,he.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!he.cloneNode(!0).lastChild.defaultValue;var be=/^key/,Ce=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Fe=/^([^.]*)(?:\.(.+)|)/;function Ve(){return!0}function Ye(){return!1}function We(p,P){return p===function(){try{return t.activeElement}catch{}}()==(P==="focus")}function Ie(p,P,G,V,ie,ce){var de,ye;if(typeof P=="object"){for(ye in typeof G!="string"&&(V=V||G,G=void 0),P)Ie(p,ye,G,V,P[ye],ce);return p}if(V==null&&ie==null?(ie=G,V=G=void 0):ie==null&&(typeof G=="string"?(ie=V,V=void 0):(ie=V,V=G,G=void 0)),ie===!1)ie=Ye;else if(!ie)return p;return ce===1&&(de=ie,(ie=function(Te){return u().off(Te),de.apply(this,arguments)}).guid=de.guid||(de.guid=u.guid++)),p.each(function(){u.event.add(this,P,ie,V,G)})}function Oe(p,P,G){G?(oe.set(p,P,!1),u.event.add(p,P,{namespace:!1,handler:function(V){var ie,ce,de=oe.get(this,P);if(1&V.isTrigger&&this[P]){if(de.length)(u.event.special[P]||{}).delegateType&&V.stopPropagation();else if(de=a.call(arguments),oe.set(this,P,de),ie=G(this,P),this[P](),de!==(ce=oe.get(this,P))||ie?oe.set(this,P,!1):ce={},de!==ce)return V.stopImmediatePropagation(),V.preventDefault(),ce.value}else de.length&&(oe.set(this,P,{value:u.event.trigger(u.extend(de[0],u.Event.prototype),de.slice(1),this)}),V.stopImmediatePropagation())}})):oe.get(p,P)===void 0&&u.event.add(p,P,Ve)}u.event={global:{},add:function(p,P,G,V,ie){var ce,de,ye,Te,Me,Ne,Be,Re,Le,et,rt,tt=oe.get(p);if(tt)for(G.handler&&(G=(ce=G).handler,ie=ce.selector),ie&&u.find.matchesSelector(me,ie),G.guid||(G.guid=u.guid++),(Te=tt.events)||(Te=tt.events={}),(de=tt.handle)||(de=tt.handle=function(yt){return typeof u<"u"&&u.event.triggered!==yt.type?u.event.dispatch.apply(p,arguments):void 0}),Me=(P=(P||"").match(N)||[""]).length;Me--;)Le=rt=(ye=Fe.exec(P[Me])||[])[1],et=(ye[2]||"").split(".").sort(),Le&&(Be=u.event.special[Le]||{},Le=(ie?Be.delegateType:Be.bindType)||Le,Be=u.event.special[Le]||{},Ne=u.extend({type:Le,origType:rt,data:V,handler:G,guid:G.guid,selector:ie,needsContext:ie&&u.expr.match.needsContext.test(ie),namespace:et.join(".")},ce),(Re=Te[Le])||((Re=Te[Le]=[]).delegateCount=0,Be.setup&&Be.setup.call(p,V,et,de)!==!1||p.addEventListener&&p.addEventListener(Le,de)),Be.add&&(Be.add.call(p,Ne),Ne.handler.guid||(Ne.handler.guid=G.guid)),ie?Re.splice(Re.delegateCount++,0,Ne):Re.push(Ne),u.event.global[Le]=!0)},remove:function(p,P,G,V,ie){var ce,de,ye,Te,Me,Ne,Be,Re,Le,et,rt,tt=oe.hasData(p)&&oe.get(p);if(tt&&(Te=tt.events)){for(Me=(P=(P||"").match(N)||[""]).length;Me--;)if(Le=rt=(ye=Fe.exec(P[Me])||[])[1],et=(ye[2]||"").split(".").sort(),Le){for(Be=u.event.special[Le]||{},Re=Te[Le=(V?Be.delegateType:Be.bindType)||Le]||[],ye=ye[2]&&new RegExp("(^|\\.)"+et.join("\\.(?:.*\\.|)")+"(\\.|$)"),de=ce=Re.length;ce--;)Ne=Re[ce],!ie&&rt!==Ne.origType||G&&G.guid!==Ne.guid||ye&&!ye.test(Ne.namespace)||V&&V!==Ne.selector&&(V!=="**"||!Ne.selector)||(Re.splice(ce,1),Ne.selector&&Re.delegateCount--,Be.remove&&Be.remove.call(p,Ne));de&&!Re.length&&(Be.teardown&&Be.teardown.call(p,et,tt.handle)!==!1||u.removeEvent(p,Le,tt.handle),delete Te[Le])}else for(Le in Te)u.event.remove(p,Le+P[Me],G,V,!0);u.isEmptyObject(Te)&&oe.remove(p,"handle events")}},dispatch:function(p){var P,G,V,ie,ce,de,ye=u.event.fix(p),Te=new Array(arguments.length),Me=(oe.get(this,"events")||{})[ye.type]||[],Ne=u.event.special[ye.type]||{};for(Te[0]=ye,P=1;P<arguments.length;P++)Te[P]=arguments[P];if(ye.delegateTarget=this,!Ne.preDispatch||Ne.preDispatch.call(this,ye)!==!1){for(de=u.event.handlers.call(this,ye,Me),P=0;(ie=de[P++])&&!ye.isPropagationStopped();)for(ye.currentTarget=ie.elem,G=0;(ce=ie.handlers[G++])&&!ye.isImmediatePropagationStopped();)ye.rnamespace&&ce.namespace!==!1&&!ye.rnamespace.test(ce.namespace)||(ye.handleObj=ce,ye.data=ce.data,(V=((u.event.special[ce.origType]||{}).handle||ce.handler).apply(ie.elem,Te))!==void 0&&(ye.result=V)===!1&&(ye.preventDefault(),ye.stopPropagation()));return Ne.postDispatch&&Ne.postDispatch.call(this,ye),ye.result}},handlers:function(p,P){var G,V,ie,ce,de,ye=[],Te=P.delegateCount,Me=p.target;if(Te&&Me.nodeType&&!(p.type==="click"&&1<=p.button)){for(;Me!==this;Me=Me.parentNode||this)if(Me.nodeType===1&&(p.type!=="click"||Me.disabled!==!0)){for(ce=[],de={},G=0;G<Te;G++)de[ie=(V=P[G]).selector+" "]===void 0&&(de[ie]=V.needsContext?-1<u(ie,this).index(Me):u.find(ie,this,null,[Me]).length),de[ie]&&ce.push(V);ce.length&&ye.push({elem:Me,handlers:ce})}}return Me=this,Te<P.length&&ye.push({elem:Me,handlers:P.slice(Te)}),ye},addProp:function(p,P){Object.defineProperty(u.Event.prototype,p,{enumerable:!0,configurable:!0,get:x(P)?function(){if(this.originalEvent)return P(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[p]},set:function(G){Object.defineProperty(this,p,{enumerable:!0,configurable:!0,writable:!0,value:G})}})},fix:function(p){return p[u.expando]?p:new u.Event(p)},special:{load:{noBubble:!0},click:{setup:function(p){var P=this||p;return Je.test(P.type)&&P.click&&A(P,"input")&&Oe(P,"click",Ve),!1},trigger:function(p){var P=this||p;return Je.test(P.type)&&P.click&&A(P,"input")&&Oe(P,"click"),!0},_default:function(p){var P=p.target;return Je.test(P.type)&&P.click&&A(P,"input")&&oe.get(P,"click")||A(P,"a")}},beforeunload:{postDispatch:function(p){p.result!==void 0&&p.originalEvent&&(p.originalEvent.returnValue=p.result)}}}},u.removeEvent=function(p,P,G){p.removeEventListener&&p.removeEventListener(P,G)},u.Event=function(p,P){if(!(this instanceof u.Event))return new u.Event(p,P);p&&p.type?(this.originalEvent=p,this.type=p.type,this.isDefaultPrevented=p.defaultPrevented||p.defaultPrevented===void 0&&p.returnValue===!1?Ve:Ye,this.target=p.target&&p.target.nodeType===3?p.target.parentNode:p.target,this.currentTarget=p.currentTarget,this.relatedTarget=p.relatedTarget):this.type=p,P&&u.extend(this,P),this.timeStamp=p&&p.timeStamp||Date.now(),this[u.expando]=!0},u.Event.prototype={constructor:u.Event,isDefaultPrevented:Ye,isPropagationStopped:Ye,isImmediatePropagationStopped:Ye,isSimulated:!1,preventDefault:function(){var p=this.originalEvent;this.isDefaultPrevented=Ve,p&&!this.isSimulated&&p.preventDefault()},stopPropagation:function(){var p=this.originalEvent;this.isPropagationStopped=Ve,p&&!this.isSimulated&&p.stopPropagation()},stopImmediatePropagation:function(){var p=this.originalEvent;this.isImmediatePropagationStopped=Ve,p&&!this.isSimulated&&p.stopImmediatePropagation(),this.stopPropagation()}},u.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(p){var P=p.button;return p.which==null&&be.test(p.type)?p.charCode!=null?p.charCode:p.keyCode:!p.which&&P!==void 0&&Ce.test(p.type)?1&P?1:2&P?3:4&P?2:0:p.which}},u.event.addProp),u.each({focus:"focusin",blur:"focusout"},function(p,P){u.event.special[p]={setup:function(){return Oe(this,p,We),!1},trigger:function(){return Oe(this,p),!0},delegateType:P}}),u.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(p,P){u.event.special[p]={delegateType:P,bindType:P,handle:function(G){var V,ie=G.relatedTarget,ce=G.handleObj;return ie&&(ie===this||u.contains(this,ie))||(G.type=ce.origType,V=ce.handler.apply(this,arguments),G.type=P),V}}}),u.fn.extend({on:function(p,P,G,V){return Ie(this,p,P,G,V)},one:function(p,P,G,V){return Ie(this,p,P,G,V,1)},off:function(p,P,G){var V,ie;if(p&&p.preventDefault&&p.handleObj)return V=p.handleObj,u(p.delegateTarget).off(V.namespace?V.origType+"."+V.namespace:V.origType,V.selector,V.handler),this;if(typeof p=="object"){for(ie in p)this.off(ie,P,p[ie]);return this}return P!==!1&&typeof P!="function"||(G=P,P=void 0),G===!1&&(G=Ye),this.each(function(){u.event.remove(this,p,G,P)})}});var it=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,at=/<script|<style|<link/i,ht=/checked\s*(?:[^=]|=\s*.checked.)/i,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Qt(p,P){return A(p,"table")&&A(P.nodeType!==11?P:P.firstChild,"tr")&&u(p).children("tbody")[0]||p}function ln(p){return p.type=(p.getAttribute("type")!==null)+"/"+p.type,p}function wt(p){return(p.type||"").slice(0,5)==="true/"?p.type=p.type.slice(5):p.removeAttribute("type"),p}function gt(p,P){var G,V,ie,ce,de,ye,Te,Me;if(P.nodeType===1){if(oe.hasData(p)&&(ce=oe.access(p),de=oe.set(P,ce),Me=ce.events))for(ie in delete de.handle,de.events={},Me)for(G=0,V=Me[ie].length;G<V;G++)u.event.add(P,ie,Me[ie][G]);ve.hasData(p)&&(ye=ve.access(p),Te=u.extend({},ye),ve.set(P,Te))}}function Lt(p,P,G,V){P=n.apply([],P);var ie,ce,de,ye,Te,Me,Ne=0,Be=p.length,Re=Be-1,Le=P[0],et=x(Le);if(et||1<Be&&typeof Le=="string"&&!g.checkClone&&ht.test(Le))return p.each(function(rt){var tt=p.eq(rt);et&&(P[0]=Le.call(this,rt,tt.html())),Lt(tt,P,G,V)});if(Be&&(ce=(ie=ge(P,p[0].ownerDocument,!1,p,V)).firstChild,ie.childNodes.length===1&&(ie=ce),ce||V)){for(ye=(de=u.map(ne(ie,"script"),ln)).length;Ne<Be;Ne++)Te=ie,Ne!==Re&&(Te=u.clone(Te,!0,!0),ye&&u.merge(de,ne(Te,"script"))),G.call(p[Ne],Te,Ne);if(ye)for(Me=de[de.length-1].ownerDocument,u.map(de,wt),Ne=0;Ne<ye;Ne++)Te=de[Ne],qe.test(Te.type||"")&&!oe.access(Te,"globalEval")&&u.contains(Me,Te)&&(Te.src&&(Te.type||"").toLowerCase()!=="module"?u._evalUrl&&!Te.noModule&&u._evalUrl(Te.src,{nonce:Te.nonce||Te.getAttribute("nonce")}):M(Te.textContent.replace(St,""),Te,Me))}return p}function Yt(p,P,G){for(var V,ie=P?u.filter(P,p):p,ce=0;(V=ie[ce])!=null;ce++)G||V.nodeType!==1||u.cleanData(ne(V)),V.parentNode&&(G&&Ae(V)&&ue(ne(V,"script")),V.parentNode.removeChild(V));return p}u.extend({htmlPrefilter:function(p){return p.replace(it,"<$1></$2>")},clone:function(p,P,G){var V,ie,ce,de,ye,Te,Me,Ne=p.cloneNode(!0),Be=Ae(p);if(!(g.noCloneChecked||p.nodeType!==1&&p.nodeType!==11||u.isXMLDoc(p)))for(de=ne(Ne),V=0,ie=(ce=ne(p)).length;V<ie;V++)ye=ce[V],Te=de[V],(Me=Te.nodeName.toLowerCase())==="input"&&Je.test(ye.type)?Te.checked=ye.checked:Me!=="input"&&Me!=="textarea"||(Te.defaultValue=ye.defaultValue);if(P)if(G)for(ce=ce||ne(p),de=de||ne(Ne),V=0,ie=ce.length;V<ie;V++)gt(ce[V],de[V]);else gt(p,Ne);return 0<(de=ne(Ne,"script")).length&&ue(de,!Be&&ne(p,"script")),Ne},cleanData:function(p){for(var P,G,V,ie=u.event.special,ce=0;(G=p[ce])!==void 0;ce++)if(te(G)){if(P=G[oe.expando]){if(P.events)for(V in P.events)ie[V]?u.event.remove(G,V):u.removeEvent(G,V,P.handle);G[oe.expando]=void 0}G[ve.expando]&&(G[ve.expando]=void 0)}}}),u.fn.extend({detach:function(p){return Yt(this,p,!0)},remove:function(p){return Yt(this,p)},text:function(p){return pe(this,function(P){return P===void 0?u.text(this):this.empty().each(function(){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||(this.textContent=P)})},null,p,arguments.length)},append:function(){return Lt(this,arguments,function(p){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||Qt(this,p).appendChild(p)})},prepend:function(){return Lt(this,arguments,function(p){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var P=Qt(this,p);P.insertBefore(p,P.firstChild)}})},before:function(){return Lt(this,arguments,function(p){this.parentNode&&this.parentNode.insertBefore(p,this)})},after:function(){return Lt(this,arguments,function(p){this.parentNode&&this.parentNode.insertBefore(p,this.nextSibling)})},empty:function(){for(var p,P=0;(p=this[P])!=null;P++)p.nodeType===1&&(u.cleanData(ne(p,!1)),p.textContent="");return this},clone:function(p,P){return p=p!=null&&p,P=P??p,this.map(function(){return u.clone(this,p,P)})},html:function(p){return pe(this,function(P){var G=this[0]||{},V=0,ie=this.length;if(P===void 0&&G.nodeType===1)return G.innerHTML;if(typeof P=="string"&&!at.test(P)&&!W[(nt.exec(P)||["",""])[1].toLowerCase()]){P=u.htmlPrefilter(P);try{for(;V<ie;V++)(G=this[V]||{}).nodeType===1&&(u.cleanData(ne(G,!1)),G.innerHTML=P);G=0}catch{}}G&&this.empty().append(P)},null,p,arguments.length)},replaceWith:function(){var p=[];return Lt(this,arguments,function(P){var G=this.parentNode;u.inArray(this,p)<0&&(u.cleanData(ne(this)),G&&G.replaceChild(P,this))},p)}}),u.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(p,P){u.fn[p]=function(G){for(var V,ie=[],ce=u(G),de=ce.length-1,ye=0;ye<=de;ye++)V=ye===de?this:this.clone(!0),u(ce[ye])[P](V),o.apply(ie,V.get());return this.pushStack(ie)}});var zt=new RegExp("^("+I+")(?!px)[a-z%]+$","i"),nn=function(p){var P=p.ownerDocument.defaultView;return P&&P.opener||(P=e),P.getComputedStyle(p)},wn=new RegExp(ae.join("|"),"i");function pn(p,P,G){var V,ie,ce,de,ye=p.style;return(G=G||nn(p))&&((de=G.getPropertyValue(P)||G[P])!==""||Ae(p)||(de=u.style(p,P)),!g.pixelBoxStyles()&&zt.test(de)&&wn.test(P)&&(V=ye.width,ie=ye.minWidth,ce=ye.maxWidth,ye.minWidth=ye.maxWidth=ye.width=de,de=G.width,ye.width=V,ye.minWidth=ie,ye.maxWidth=ce)),de!==void 0?de+"":de}function Vn(p,P){return{get:function(){if(!p())return(this.get=P).apply(this,arguments);delete this.get}}}(function(){function p(){if(Te){ye.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Te.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",me.appendChild(ye).appendChild(Te);var Me=e.getComputedStyle(Te);G=Me.top!=="1%",de=P(Me.marginLeft)===12,Te.style.right="60%",ce=P(Me.right)===36,V=P(Me.width)===36,Te.style.position="absolute",ie=P(Te.offsetWidth/3)===12,me.removeChild(ye),Te=null}}function P(Me){return Math.round(parseFloat(Me))}var G,V,ie,ce,de,ye=t.createElement("div"),Te=t.createElement("div");Te.style&&(Te.style.backgroundClip="content-box",Te.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle=Te.style.backgroundClip==="content-box",u.extend(g,{boxSizingReliable:function(){return p(),V},pixelBoxStyles:function(){return p(),ce},pixelPosition:function(){return p(),G},reliableMarginLeft:function(){return p(),de},scrollboxSize:function(){return p(),ie}}))})();var Kn=["Webkit","Moz","ms"],Yn=t.createElement("div").style,Xn={};function $n(p){var P=u.cssProps[p]||Xn[p];return P||(p in Yn?p:Xn[p]=function(G){for(var V=G[0].toUpperCase()+G.slice(1),ie=Kn.length;ie--;)if((G=Kn[ie]+V)in Yn)return G}(p)||p)}var Ei=/^(none|table(?!-c[ea]).+)/,Jn=/^--/,Ai={position:"absolute",visibility:"hidden",display:"block"},Zn={letterSpacing:"0",fontWeight:"400"};function Qn(p,P,G){var V=O.exec(P);return V?Math.max(0,V[2]-(G||0))+(V[3]||"px"):P}function Pn(p,P,G,V,ie,ce){var de=P==="width"?1:0,ye=0,Te=0;if(G===(V?"border":"content"))return 0;for(;de<4;de+=2)G==="margin"&&(Te+=u.css(p,G+ae[de],!0,ie)),V?(G==="content"&&(Te-=u.css(p,"padding"+ae[de],!0,ie)),G!=="margin"&&(Te-=u.css(p,"border"+ae[de]+"Width",!0,ie))):(Te+=u.css(p,"padding"+ae[de],!0,ie),G!=="padding"?Te+=u.css(p,"border"+ae[de]+"Width",!0,ie):ye+=u.css(p,"border"+ae[de]+"Width",!0,ie));return!V&&0<=ce&&(Te+=Math.max(0,Math.ceil(p["offset"+P[0].toUpperCase()+P.slice(1)]-ce-Te-ye-.5))||0),Te}function ei(p,P,G){var V=nn(p),ie=(!g.boxSizingReliable()||G)&&u.css(p,"boxSizing",!1,V)==="border-box",ce=ie,de=pn(p,P,V),ye="offset"+P[0].toUpperCase()+P.slice(1);if(zt.test(de)){if(!G)return de;de="auto"}return(!g.boxSizingReliable()&&ie||de==="auto"||!parseFloat(de)&&u.css(p,"display",!1,V)==="inline")&&p.getClientRects().length&&(ie=u.css(p,"boxSizing",!1,V)==="border-box",(ce=ye in p)&&(de=p[ye])),(de=parseFloat(de)||0)+Pn(p,P,G||(ie?"border":"content"),ce,V,de)+"px"}function Wt(p,P,G,V,ie){return new Wt.prototype.init(p,P,G,V,ie)}u.extend({cssHooks:{opacity:{get:function(p,P){if(P){var G=pn(p,"opacity");return G===""?"1":G}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(p,P,G,V){if(p&&p.nodeType!==3&&p.nodeType!==8&&p.style){var ie,ce,de,ye=D(P),Te=Jn.test(P),Me=p.style;if(Te||(P=$n(ye)),de=u.cssHooks[P]||u.cssHooks[ye],G===void 0)return de&&"get"in de&&(ie=de.get(p,!1,V))!==void 0?ie:Me[P];(ce=typeof G)=="string"&&(ie=O.exec(G))&&ie[1]&&(G=Ue(p,P,ie),ce="number"),G!=null&&G==G&&(ce!=="number"||Te||(G+=ie&&ie[3]||(u.cssNumber[ye]?"":"px")),g.clearCloneStyle||G!==""||P.indexOf("background")!==0||(Me[P]="inherit"),de&&"set"in de&&(G=de.set(p,G,V))===void 0||(Te?Me.setProperty(P,G):Me[P]=G))}},css:function(p,P,G,V){var ie,ce,de,ye=D(P);return Jn.test(P)||(P=$n(ye)),(de=u.cssHooks[P]||u.cssHooks[ye])&&"get"in de&&(ie=de.get(p,!0,G)),ie===void 0&&(ie=pn(p,P,V)),ie==="normal"&&P in Zn&&(ie=Zn[P]),G===""||G?(ce=parseFloat(ie),G===!0||isFinite(ce)?ce||0:ie):ie}}),u.each(["height","width"],function(p,P){u.cssHooks[P]={get:function(G,V,ie){if(V)return!Ei.test(u.css(G,"display"))||G.getClientRects().length&&G.getBoundingClientRect().width?ei(G,P,ie):Xe(G,Ai,function(){return ei(G,P,ie)})},set:function(G,V,ie){var ce,de=nn(G),ye=!g.scrollboxSize()&&de.position==="absolute",Te=(ye||ie)&&u.css(G,"boxSizing",!1,de)==="border-box",Me=ie?Pn(G,P,ie,Te,de):0;return Te&&ye&&(Me-=Math.ceil(G["offset"+P[0].toUpperCase()+P.slice(1)]-parseFloat(de[P])-Pn(G,P,"border",!1,de)-.5)),Me&&(ce=O.exec(V))&&(ce[3]||"px")!=="px"&&(G.style[P]=V,V=u.css(G,P)),Qn(0,V,Me)}}}),u.cssHooks.marginLeft=Vn(g.reliableMarginLeft,function(p,P){if(P)return(parseFloat(pn(p,"marginLeft"))||p.getBoundingClientRect().left-Xe(p,{marginLeft:0},function(){return p.getBoundingClientRect().left}))+"px"}),u.each({margin:"",padding:"",border:"Width"},function(p,P){u.cssHooks[p+P]={expand:function(G){for(var V=0,ie={},ce=typeof G=="string"?G.split(" "):[G];V<4;V++)ie[p+ae[V]+P]=ce[V]||ce[V-2]||ce[0];return ie}},p!=="margin"&&(u.cssHooks[p+P].set=Qn)}),u.fn.extend({css:function(p,P){return pe(this,function(G,V,ie){var ce,de,ye={},Te=0;if(Array.isArray(V)){for(ce=nn(G),de=V.length;Te<de;Te++)ye[V[Te]]=u.css(G,V[Te],!1,ce);return ye}return ie!==void 0?u.style(G,V,ie):u.css(G,V)},p,P,1<arguments.length)}}),((u.Tween=Wt).prototype={constructor:Wt,init:function(p,P,G,V,ie,ce){this.elem=p,this.prop=G,this.easing=ie||u.easing._default,this.options=P,this.start=this.now=this.cur(),this.end=V,this.unit=ce||(u.cssNumber[G]?"":"px")},cur:function(){var p=Wt.propHooks[this.prop];return p&&p.get?p.get(this):Wt.propHooks._default.get(this)},run:function(p){var P,G=Wt.propHooks[this.prop];return this.options.duration?this.pos=P=u.easing[this.easing](p,this.options.duration*p,0,1,this.options.duration):this.pos=P=p,this.now=(this.end-this.start)*P+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),G&&G.set?G.set(this):Wt.propHooks._default.set(this),this}}).init.prototype=Wt.prototype,(Wt.propHooks={_default:{get:function(p){var P;return p.elem.nodeType!==1||p.elem[p.prop]!=null&&p.elem.style[p.prop]==null?p.elem[p.prop]:(P=u.css(p.elem,p.prop,""))&&P!=="auto"?P:0},set:function(p){u.fx.step[p.prop]?u.fx.step[p.prop](p):p.elem.nodeType!==1||!u.cssHooks[p.prop]&&p.elem.style[$n(p.prop)]==null?p.elem[p.prop]=p.now:u.style(p.elem,p.prop,p.now+p.unit)}}}).scrollTop=Wt.propHooks.scrollLeft={set:function(p){p.elem.nodeType&&p.elem.parentNode&&(p.elem[p.prop]=p.now)}},u.easing={linear:function(p){return p},swing:function(p){return .5-Math.cos(p*Math.PI)/2},_default:"swing"},u.fx=Wt.prototype.init,u.fx.step={};var cn,yn,un,ti,Si=/^(?:toggle|show|hide)$/,Ci=/queueHooks$/;function Rn(){yn&&(t.hidden===!1&&e.requestAnimationFrame?e.requestAnimationFrame(Rn):e.setTimeout(Rn,u.fx.interval),u.fx.tick())}function ni(){return e.setTimeout(function(){cn=void 0}),cn=Date.now()}function xn(p,P){var G,V=0,ie={height:p};for(P=P?1:0;V<4;V+=2-P)ie["margin"+(G=ae[V])]=ie["padding"+G]=p;return P&&(ie.opacity=ie.width=p),ie}function ii(p,P,G){for(var V,ie=(qt.tweeners[P]||[]).concat(qt.tweeners["*"]),ce=0,de=ie.length;ce<de;ce++)if(V=ie[ce].call(G,P,p))return V}function qt(p,P,G){var V,ie,ce=0,de=qt.prefilters.length,ye=u.Deferred().always(function(){delete Te.elem}),Te=function(){if(ie)return!1;for(var Be=cn||ni(),Re=Math.max(0,Me.startTime+Me.duration-Be),Le=1-(Re/Me.duration||0),et=0,rt=Me.tweens.length;et<rt;et++)Me.tweens[et].run(Le);return ye.notifyWith(p,[Me,Le,Re]),Le<1&&rt?Re:(rt||ye.notifyWith(p,[Me,1,0]),ye.resolveWith(p,[Me]),!1)},Me=ye.promise({elem:p,props:u.extend({},P),opts:u.extend(!0,{specialEasing:{},easing:u.easing._default},G),originalProperties:P,originalOptions:G,startTime:cn||ni(),duration:G.duration,tweens:[],createTween:function(Be,Re){var Le=u.Tween(p,Me.opts,Be,Re,Me.opts.specialEasing[Be]||Me.opts.easing);return Me.tweens.push(Le),Le},stop:function(Be){var Re=0,Le=Be?Me.tweens.length:0;if(ie)return this;for(ie=!0;Re<Le;Re++)Me.tweens[Re].run(1);return Be?(ye.notifyWith(p,[Me,1,0]),ye.resolveWith(p,[Me,Be])):ye.rejectWith(p,[Me,Be]),this}}),Ne=Me.props;for(!function(Be,Re){var Le,et,rt,tt,yt;for(Le in Be)if(rt=Re[et=D(Le)],tt=Be[Le],Array.isArray(tt)&&(rt=tt[1],tt=Be[Le]=tt[0]),Le!==et&&(Be[et]=tt,delete Be[Le]),(yt=u.cssHooks[et])&&"expand"in yt)for(Le in tt=yt.expand(tt),delete Be[et],tt)Le in Be||(Be[Le]=tt[Le],Re[Le]=rt);else Re[et]=rt}(Ne,Me.opts.specialEasing);ce<de;ce++)if(V=qt.prefilters[ce].call(Me,p,Ne,Me.opts))return x(V.stop)&&(u._queueHooks(Me.elem,Me.opts.queue).stop=V.stop.bind(V)),V;return u.map(Ne,ii,Me),x(Me.opts.start)&&Me.opts.start.call(p,Me),Me.progress(Me.opts.progress).done(Me.opts.done,Me.opts.complete).fail(Me.opts.fail).always(Me.opts.always),u.fx.timer(u.extend(Te,{elem:p,anim:Me,queue:Me.opts.queue})),Me}u.Animation=u.extend(qt,{tweeners:{"*":[function(p,P){var G=this.createTween(p,P);return Ue(G.elem,p,O.exec(P),G),G}]},tweener:function(p,P){x(p)?(P=p,p=["*"]):p=p.match(N);for(var G,V=0,ie=p.length;V<ie;V++)G=p[V],qt.tweeners[G]=qt.tweeners[G]||[],qt.tweeners[G].unshift(P)},prefilters:[function(p,P,G){var V,ie,ce,de,ye,Te,Me,Ne,Be="width"in P||"height"in P,Re=this,Le={},et=p.style,rt=p.nodeType&&Ge(p),tt=oe.get(p,"fxshow");for(V in G.queue||((de=u._queueHooks(p,"fx")).unqueued==null&&(de.unqueued=0,ye=de.empty.fire,de.empty.fire=function(){de.unqueued||ye()}),de.unqueued++,Re.always(function(){Re.always(function(){de.unqueued--,u.queue(p,"fx").length||de.empty.fire()})})),P)if(ie=P[V],Si.test(ie)){if(delete P[V],ce=ce||ie==="toggle",ie===(rt?"hide":"show")){if(ie!=="show"||!tt||tt[V]===void 0)continue;rt=!0}Le[V]=tt&&tt[V]||u.style(p,V)}if((Te=!u.isEmptyObject(P))||!u.isEmptyObject(Le))for(V in Be&&p.nodeType===1&&(G.overflow=[et.overflow,et.overflowX,et.overflowY],(Me=tt&&tt.display)==null&&(Me=oe.get(p,"display")),(Ne=u.css(p,"display"))==="none"&&(Me?Ne=Me:(He([p],!0),Me=p.style.display||Me,Ne=u.css(p,"display"),He([p]))),(Ne==="inline"||Ne==="inline-block"&&Me!=null)&&u.css(p,"float")==="none"&&(Te||(Re.done(function(){et.display=Me}),Me==null&&(Ne=et.display,Me=Ne==="none"?"":Ne)),et.display="inline-block")),G.overflow&&(et.overflow="hidden",Re.always(function(){et.overflow=G.overflow[0],et.overflowX=G.overflow[1],et.overflowY=G.overflow[2]})),Te=!1,Le)Te||(tt?"hidden"in tt&&(rt=tt.hidden):tt=oe.access(p,"fxshow",{display:Me}),ce&&(tt.hidden=!rt),rt&&He([p],!0),Re.done(function(){for(V in rt||He([p]),oe.remove(p,"fxshow"),Le)u.style(p,V,Le[V])})),Te=ii(rt?tt[V]:0,V,Re),V in tt||(tt[V]=Te.start,rt&&(Te.end=Te.start,Te.start=0))}],prefilter:function(p,P){P?qt.prefilters.unshift(p):qt.prefilters.push(p)}}),u.speed=function(p,P,G){var V=p&&typeof p=="object"?u.extend({},p):{complete:G||!G&&P||x(p)&&p,duration:p,easing:G&&P||P&&!x(P)&&P};return u.fx.off?V.duration=0:typeof V.duration!="number"&&(V.duration in u.fx.speeds?V.duration=u.fx.speeds[V.duration]:V.duration=u.fx.speeds._default),V.queue!=null&&V.queue!==!0||(V.queue="fx"),V.old=V.complete,V.complete=function(){x(V.old)&&V.old.call(this),V.queue&&u.dequeue(this,V.queue)},V},u.fn.extend({fadeTo:function(p,P,G,V){return this.filter(Ge).css("opacity",0).show().end().animate({opacity:P},p,G,V)},animate:function(p,P,G,V){var ie=u.isEmptyObject(p),ce=u.speed(P,G,V),de=function(){var ye=qt(this,u.extend({},p),ce);(ie||oe.get(this,"finish"))&&ye.stop(!0)};return de.finish=de,ie||ce.queue===!1?this.each(de):this.queue(ce.queue,de)},stop:function(p,P,G){var V=function(ie){var ce=ie.stop;delete ie.stop,ce(G)};return typeof p!="string"&&(G=P,P=p,p=void 0),P&&p!==!1&&this.queue(p||"fx",[]),this.each(function(){var ie=!0,ce=p!=null&&p+"queueHooks",de=u.timers,ye=oe.get(this);if(ce)ye[ce]&&ye[ce].stop&&V(ye[ce]);else for(ce in ye)ye[ce]&&ye[ce].stop&&Ci.test(ce)&&V(ye[ce]);for(ce=de.length;ce--;)de[ce].elem!==this||p!=null&&de[ce].queue!==p||(de[ce].anim.stop(G),ie=!1,de.splice(ce,1));!ie&&G||u.dequeue(this,p)})},finish:function(p){return p!==!1&&(p=p||"fx"),this.each(function(){var P,G=oe.get(this),V=G[p+"queue"],ie=G[p+"queueHooks"],ce=u.timers,de=V?V.length:0;for(G.finish=!0,u.queue(this,p,[]),ie&&ie.stop&&ie.stop.call(this,!0),P=ce.length;P--;)ce[P].elem===this&&ce[P].queue===p&&(ce[P].anim.stop(!0),ce.splice(P,1));for(P=0;P<de;P++)V[P]&&V[P].finish&&V[P].finish.call(this);delete G.finish})}}),u.each(["toggle","show","hide"],function(p,P){var G=u.fn[P];u.fn[P]=function(V,ie,ce){return V==null||typeof V=="boolean"?G.apply(this,arguments):this.animate(xn(P,!0),V,ie,ce)}}),u.each({slideDown:xn("show"),slideUp:xn("hide"),slideToggle:xn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(p,P){u.fn[p]=function(G,V,ie){return this.animate(P,G,V,ie)}}),u.timers=[],u.fx.tick=function(){var p,P=0,G=u.timers;for(cn=Date.now();P<G.length;P++)(p=G[P])()||G[P]!==p||G.splice(P--,1);G.length||u.fx.stop(),cn=void 0},u.fx.timer=function(p){u.timers.push(p),u.fx.start()},u.fx.interval=13,u.fx.start=function(){yn||(yn=!0,Rn())},u.fx.stop=function(){yn=null},u.fx.speeds={slow:600,fast:200,_default:400},u.fn.delay=function(p,P){return p=u.fx&&u.fx.speeds[p]||p,P=P||"fx",this.queue(P,function(G,V){var ie=e.setTimeout(G,p);V.stop=function(){e.clearTimeout(ie)}})},un=t.createElement("input"),ti=t.createElement("select").appendChild(t.createElement("option")),un.type="checkbox",g.checkOn=un.value!=="",g.optSelected=ti.selected,(un=t.createElement("input")).value="t",un.type="radio",g.radioValue=un.value==="t";var ri,gn=u.expr.attrHandle;u.fn.extend({attr:function(p,P){return pe(this,u.attr,p,P,1<arguments.length)},removeAttr:function(p){return this.each(function(){u.removeAttr(this,p)})}}),u.extend({attr:function(p,P,G){var V,ie,ce=p.nodeType;if(ce!==3&&ce!==8&&ce!==2)return typeof p.getAttribute>"u"?u.prop(p,P,G):(ce===1&&u.isXMLDoc(p)||(ie=u.attrHooks[P.toLowerCase()]||(u.expr.match.bool.test(P)?ri:void 0)),G!==void 0?G===null?void u.removeAttr(p,P):ie&&"set"in ie&&(V=ie.set(p,G,P))!==void 0?V:(p.setAttribute(P,G+""),G):ie&&"get"in ie&&(V=ie.get(p,P))!==null?V:(V=u.find.attr(p,P))==null?void 0:V)},attrHooks:{type:{set:function(p,P){if(!g.radioValue&&P==="radio"&&A(p,"input")){var G=p.value;return p.setAttribute("type",P),G&&(p.value=G),P}}}},removeAttr:function(p,P){var G,V=0,ie=P&&P.match(N);if(ie&&p.nodeType===1)for(;G=ie[V++];)p.removeAttribute(G)}}),ri={set:function(p,P,G){return P===!1?u.removeAttr(p,G):p.setAttribute(G,G),G}},u.each(u.expr.match.bool.source.match(/\w+/g),function(p,P){var G=gn[P]||u.find.attr;gn[P]=function(V,ie,ce){var de,ye,Te=ie.toLowerCase();return ce||(ye=gn[Te],gn[Te]=de,de=G(V,ie,ce)!=null?Te:null,gn[Te]=ye),de}});var Ti=/^(?:input|select|textarea|button)$/i,ki=/^(?:a|area)$/i;function rn(p){return(p.match(N)||[]).join(" ")}function an(p){return p.getAttribute&&p.getAttribute("class")||""}function Ln(p){return Array.isArray(p)?p:typeof p=="string"&&p.match(N)||[]}u.fn.extend({prop:function(p,P){return pe(this,u.prop,p,P,1<arguments.length)},removeProp:function(p){return this.each(function(){delete this[u.propFix[p]||p]})}}),u.extend({prop:function(p,P,G){var V,ie,ce=p.nodeType;if(ce!==3&&ce!==8&&ce!==2)return ce===1&&u.isXMLDoc(p)||(P=u.propFix[P]||P,ie=u.propHooks[P]),G!==void 0?ie&&"set"in ie&&(V=ie.set(p,G,P))!==void 0?V:p[P]=G:ie&&"get"in ie&&(V=ie.get(p,P))!==null?V:p[P]},propHooks:{tabIndex:{get:function(p){var P=u.find.attr(p,"tabindex");return P?parseInt(P,10):Ti.test(p.nodeName)||ki.test(p.nodeName)&&p.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(u.propHooks.selected={get:function(p){var P=p.parentNode;return P&&P.parentNode&&P.parentNode.selectedIndex,null},set:function(p){var P=p.parentNode;P&&(P.selectedIndex,P.parentNode&&P.parentNode.selectedIndex)}}),u.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){u.propFix[this.toLowerCase()]=this}),u.fn.extend({addClass:function(p){var P,G,V,ie,ce,de,ye,Te=0;if(x(p))return this.each(function(Me){u(this).addClass(p.call(this,Me,an(this)))});if((P=Ln(p)).length){for(;G=this[Te++];)if(ie=an(G),V=G.nodeType===1&&" "+rn(ie)+" "){for(de=0;ce=P[de++];)V.indexOf(" "+ce+" ")<0&&(V+=ce+" ");ie!==(ye=rn(V))&&G.setAttribute("class",ye)}}return this},removeClass:function(p){var P,G,V,ie,ce,de,ye,Te=0;if(x(p))return this.each(function(Me){u(this).removeClass(p.call(this,Me,an(this)))});if(!arguments.length)return this.attr("class","");if((P=Ln(p)).length){for(;G=this[Te++];)if(ie=an(G),V=G.nodeType===1&&" "+rn(ie)+" "){for(de=0;ce=P[de++];)for(;-1<V.indexOf(" "+ce+" ");)V=V.replace(" "+ce+" "," ");ie!==(ye=rn(V))&&G.setAttribute("class",ye)}}return this},toggleClass:function(p,P){var G=typeof p,V=G==="string"||Array.isArray(p);return typeof P=="boolean"&&V?P?this.addClass(p):this.removeClass(p):x(p)?this.each(function(ie){u(this).toggleClass(p.call(this,ie,an(this),P),P)}):this.each(function(){var ie,ce,de,ye;if(V)for(ce=0,de=u(this),ye=Ln(p);ie=ye[ce++];)de.hasClass(ie)?de.removeClass(ie):de.addClass(ie);else p!==void 0&&G!=="boolean"||((ie=an(this))&&oe.set(this,"__className__",ie),this.setAttribute&&this.setAttribute("class",ie||p===!1?"":oe.get(this,"__className__")||""))})},hasClass:function(p){var P,G,V=0;for(P=" "+p+" ";G=this[V++];)if(G.nodeType===1&&-1<(" "+rn(an(G))+" ").indexOf(P))return!0;return!1}});var Mi=/\r/g;u.fn.extend({val:function(p){var P,G,V,ie=this[0];return arguments.length?(V=x(p),this.each(function(ce){var de;this.nodeType===1&&((de=V?p.call(this,ce,u(this).val()):p)==null?de="":typeof de=="number"?de+="":Array.isArray(de)&&(de=u.map(de,function(ye){return ye==null?"":ye+""})),(P=u.valHooks[this.type]||u.valHooks[this.nodeName.toLowerCase()])&&"set"in P&&P.set(this,de,"value")!==void 0||(this.value=de))})):ie?(P=u.valHooks[ie.type]||u.valHooks[ie.nodeName.toLowerCase()])&&"get"in P&&(G=P.get(ie,"value"))!==void 0?G:typeof(G=ie.value)=="string"?G.replace(Mi,""):G??"":void 0}}),u.extend({valHooks:{option:{get:function(p){var P=u.find.attr(p,"value");return P??rn(u.text(p))}},select:{get:function(p){var P,G,V,ie=p.options,ce=p.selectedIndex,de=p.type==="select-one",ye=de?null:[],Te=de?ce+1:ie.length;for(V=ce<0?Te:de?ce:0;V<Te;V++)if(((G=ie[V]).selected||V===ce)&&!G.disabled&&(!G.parentNode.disabled||!A(G.parentNode,"optgroup"))){if(P=u(G).val(),de)return P;ye.push(P)}return ye},set:function(p,P){for(var G,V,ie=p.options,ce=u.makeArray(P),de=ie.length;de--;)((V=ie[de]).selected=-1<u.inArray(u.valHooks.option.get(V),ce))&&(G=!0);return G||(p.selectedIndex=-1),ce}}}}),u.each(["radio","checkbox"],function(){u.valHooks[this]={set:function(p,P){if(Array.isArray(P))return p.checked=-1<u.inArray(u(p).val(),P)}},g.checkOn||(u.valHooks[this].get=function(p){return p.getAttribute("value")===null?"on":p.value})}),g.focusin="onfocusin"in e;var ai=/^(?:focusinfocus|focusoutblur)$/,si=function(p){p.stopPropagation()};u.extend(u.event,{trigger:function(p,P,G,V){var ie,ce,de,ye,Te,Me,Ne,Be,Re=[G||t],Le=h.call(p,"type")?p.type:p,et=h.call(p,"namespace")?p.namespace.split("."):[];if(ce=Be=de=G=G||t,G.nodeType!==3&&G.nodeType!==8&&!ai.test(Le+u.event.triggered)&&(-1<Le.indexOf(".")&&(Le=(et=Le.split(".")).shift(),et.sort()),Te=Le.indexOf(":")<0&&"on"+Le,(p=p[u.expando]?p:new u.Event(Le,typeof p=="object"&&p)).isTrigger=V?2:3,p.namespace=et.join("."),p.rnamespace=p.namespace?new RegExp("(^|\\.)"+et.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,p.result=void 0,p.target||(p.target=G),P=P==null?[p]:u.makeArray(P,[p]),Ne=u.event.special[Le]||{},V||!Ne.trigger||Ne.trigger.apply(G,P)!==!1)){if(!V&&!Ne.noBubble&&!w(G)){for(ye=Ne.delegateType||Le,ai.test(ye+Le)||(ce=ce.parentNode);ce;ce=ce.parentNode)Re.push(ce),de=ce;de===(G.ownerDocument||t)&&Re.push(de.defaultView||de.parentWindow||e)}for(ie=0;(ce=Re[ie++])&&!p.isPropagationStopped();)Be=ce,p.type=1<ie?ye:Ne.bindType||Le,(Me=(oe.get(ce,"events")||{})[p.type]&&oe.get(ce,"handle"))&&Me.apply(ce,P),(Me=Te&&ce[Te])&&Me.apply&&te(ce)&&(p.result=Me.apply(ce,P),p.result===!1&&p.preventDefault());return p.type=Le,V||p.isDefaultPrevented()||Ne._default&&Ne._default.apply(Re.pop(),P)!==!1||!te(G)||Te&&x(G[Le])&&!w(G)&&((de=G[Te])&&(G[Te]=null),u.event.triggered=Le,p.isPropagationStopped()&&Be.addEventListener(Le,si),G[Le](),p.isPropagationStopped()&&Be.removeEventListener(Le,si),u.event.triggered=void 0,de&&(G[Te]=de)),p.result}},simulate:function(p,P,G){var V=u.extend(new u.Event,G,{type:p,isSimulated:!0});u.event.trigger(V,null,P)}}),u.fn.extend({trigger:function(p,P){return this.each(function(){u.event.trigger(p,P,this)})},triggerHandler:function(p,P){var G=this[0];if(G)return u.event.trigger(p,P,G,!0)}}),g.focusin||u.each({focus:"focusin",blur:"focusout"},function(p,P){var G=function(V){u.event.simulate(P,V.target,u.event.fix(V))};u.event.special[P]={setup:function(){var V=this.ownerDocument||this,ie=oe.access(V,P);ie||V.addEventListener(p,G,!0),oe.access(V,P,(ie||0)+1)},teardown:function(){var V=this.ownerDocument||this,ie=oe.access(V,P)-1;ie?oe.access(V,P,ie):(V.removeEventListener(p,G,!0),oe.remove(V,P))}}});var _n=e.location,oi=Date.now(),In=/\?/;u.parseXML=function(p){var P;if(!p||typeof p!="string")return null;try{P=new e.DOMParser().parseFromString(p,"text/xml")}catch{P=void 0}return P&&!P.getElementsByTagName("parsererror").length||u.error("Invalid XML: "+p),P};var $i=/\[\]$/,li=/\r?\n/g,Pi=/^(?:submit|button|image|reset|file)$/i,Ri=/^(?:input|select|textarea|keygen)/i;function Nn(p,P,G,V){var ie;if(Array.isArray(P))u.each(P,function(ce,de){G||$i.test(p)?V(p,de):Nn(p+"["+(typeof de=="object"&&de!=null?ce:"")+"]",de,G,V)});else if(G||R(P)!=="object")V(p,P);else for(ie in P)Nn(p+"["+ie+"]",P[ie],G,V)}u.param=function(p,P){var G,V=[],ie=function(ce,de){var ye=x(de)?de():de;V[V.length]=encodeURIComponent(ce)+"="+encodeURIComponent(ye??"")};if(p==null)return"";if(Array.isArray(p)||p.jquery&&!u.isPlainObject(p))u.each(p,function(){ie(this.name,this.value)});else for(G in p)Nn(G,p[G],P,ie);return V.join("&")},u.fn.extend({serialize:function(){return u.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var p=u.prop(this,"elements");return p?u.makeArray(p):this}).filter(function(){var p=this.type;return this.name&&!u(this).is(":disabled")&&Ri.test(this.nodeName)&&!Pi.test(p)&&(this.checked||!Je.test(p))}).map(function(p,P){var G=u(this).val();return G==null?null:Array.isArray(G)?u.map(G,function(V){return{name:P.name,value:V.replace(li,`\r
`)}}):{name:P.name,value:G.replace(li,`\r
`)}}).get()}});var Li=/%20/g,Ii=/#.*$/,Ni=/([?&])_=[^&]*/,Di=/^(.*?):[ \t]*([^\r\n]*)$/gm,Fi=/^(?:GET|HEAD)$/,Oi=/^\/\//,ci={},Dn={},ui="*/".concat("*"),Fn=t.createElement("a");function di(p){return function(P,G){typeof P!="string"&&(G=P,P="*");var V,ie=0,ce=P.toLowerCase().match(N)||[];if(x(G))for(;V=ce[ie++];)V[0]==="+"?(V=V.slice(1)||"*",(p[V]=p[V]||[]).unshift(G)):(p[V]=p[V]||[]).push(G)}}function hi(p,P,G,V){var ie={},ce=p===Dn;function de(ye){var Te;return ie[ye]=!0,u.each(p[ye]||[],function(Me,Ne){var Be=Ne(P,G,V);return typeof Be!="string"||ce||ie[Be]?ce?!(Te=Be):void 0:(P.dataTypes.unshift(Be),de(Be),!1)}),Te}return de(P.dataTypes[0])||!ie["*"]&&de("*")}function On(p,P){var G,V,ie=u.ajaxSettings.flatOptions||{};for(G in P)P[G]!==void 0&&((ie[G]?p:V||(V={}))[G]=P[G]);return V&&u.extend(!0,p,V),p}Fn.href=_n.href,u.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_n.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(_n.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ui,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":u.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(p,P){return P?On(On(p,u.ajaxSettings),P):On(u.ajaxSettings,p)},ajaxPrefilter:di(ci),ajaxTransport:di(Dn),ajax:function(p,P){typeof p=="object"&&(P=p,p=void 0),P=P||{};var G,V,ie,ce,de,ye,Te,Me,Ne,Be,Re=u.ajaxSetup({},P),Le=Re.context||Re,et=Re.context&&(Le.nodeType||Le.jquery)?u(Le):u.event,rt=u.Deferred(),tt=u.Callbacks("once memory"),yt=Re.statusCode||{},kt={},Ft={},mt="canceled",lt={readyState:0,getResponseHeader:function(pt){var xt;if(Te){if(!ce)for(ce={};xt=Di.exec(ie);)ce[xt[1].toLowerCase()+" "]=(ce[xt[1].toLowerCase()+" "]||[]).concat(xt[2]);xt=ce[pt.toLowerCase()+" "]}return xt==null?null:xt.join(", ")},getAllResponseHeaders:function(){return Te?ie:null},setRequestHeader:function(pt,xt){return Te==null&&(pt=Ft[pt.toLowerCase()]=Ft[pt.toLowerCase()]||pt,kt[pt]=xt),this},overrideMimeType:function(pt){return Te==null&&(Re.mimeType=pt),this},statusCode:function(pt){var xt;if(pt)if(Te)lt.always(pt[lt.status]);else for(xt in pt)yt[xt]=[yt[xt],pt[xt]];return this},abort:function(pt){var xt=pt||mt;return G&&G.abort(xt),Nt(0,xt),this}};if(rt.promise(lt),Re.url=((p||Re.url||_n.href)+"").replace(Oi,_n.protocol+"//"),Re.type=P.method||P.type||Re.method||Re.type,Re.dataTypes=(Re.dataType||"*").toLowerCase().match(N)||[""],Re.crossDomain==null){ye=t.createElement("a");try{ye.href=Re.url,ye.href=ye.href,Re.crossDomain=Fn.protocol+"//"+Fn.host!=ye.protocol+"//"+ye.host}catch{Re.crossDomain=!0}}if(Re.data&&Re.processData&&typeof Re.data!="string"&&(Re.data=u.param(Re.data,Re.traditional)),hi(ci,Re,P,lt),Te)return lt;for(Ne in(Me=u.event&&Re.global)&&u.active++==0&&u.event.trigger("ajaxStart"),Re.type=Re.type.toUpperCase(),Re.hasContent=!Fi.test(Re.type),V=Re.url.replace(Ii,""),Re.hasContent?Re.data&&Re.processData&&(Re.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(Re.data=Re.data.replace(Li,"+")):(Be=Re.url.slice(V.length),Re.data&&(Re.processData||typeof Re.data=="string")&&(V+=(In.test(V)?"&":"?")+Re.data,delete Re.data),Re.cache===!1&&(V=V.replace(Ni,"$1"),Be=(In.test(V)?"&":"?")+"_="+oi+++Be),Re.url=V+Be),Re.ifModified&&(u.lastModified[V]&&lt.setRequestHeader("If-Modified-Since",u.lastModified[V]),u.etag[V]&&lt.setRequestHeader("If-None-Match",u.etag[V])),(Re.data&&Re.hasContent&&Re.contentType!==!1||P.contentType)&&lt.setRequestHeader("Content-Type",Re.contentType),lt.setRequestHeader("Accept",Re.dataTypes[0]&&Re.accepts[Re.dataTypes[0]]?Re.accepts[Re.dataTypes[0]]+(Re.dataTypes[0]!=="*"?", "+ui+"; q=0.01":""):Re.accepts["*"]),Re.headers)lt.setRequestHeader(Ne,Re.headers[Ne]);if(Re.beforeSend&&(Re.beforeSend.call(Le,lt,Re)===!1||Te))return lt.abort();if(mt="abort",tt.add(Re.complete),lt.done(Re.success),lt.fail(Re.error),G=hi(Dn,Re,P,lt)){if(lt.readyState=1,Me&&et.trigger("ajaxSend",[lt,Re]),Te)return lt;Re.async&&0<Re.timeout&&(de=e.setTimeout(function(){lt.abort("timeout")},Re.timeout));try{Te=!1,G.send(kt,Nt)}catch(pt){if(Te)throw pt;Nt(-1,pt)}}else Nt(-1,"No Transport");function Nt(pt,xt,vn,En){var jt,sn,dn,Dt,hn,Ht=xt;Te||(Te=!0,de&&e.clearTimeout(de),G=void 0,ie=En||"",lt.readyState=0<pt?4:0,jt=200<=pt&&pt<300||pt===304,vn&&(Dt=function(Et,Ot,Ut){for(var Xt,dt,_t,Mt,Bt=Et.contents,Ct=Et.dataTypes;Ct[0]==="*";)Ct.shift(),Xt===void 0&&(Xt=Et.mimeType||Ot.getResponseHeader("Content-Type"));if(Xt){for(dt in Bt)if(Bt[dt]&&Bt[dt].test(Xt)){Ct.unshift(dt);break}}if(Ct[0]in Ut)_t=Ct[0];else{for(dt in Ut){if(!Ct[0]||Et.converters[dt+" "+Ct[0]]){_t=dt;break}Mt||(Mt=dt)}_t=_t||Mt}if(_t)return _t!==Ct[0]&&Ct.unshift(_t),Ut[_t]}(Re,lt,vn)),Dt=function(Et,Ot,Ut,Xt){var dt,_t,Mt,Bt,Ct,Gt={},fn=Et.dataTypes.slice();if(fn[1])for(Mt in Et.converters)Gt[Mt.toLowerCase()]=Et.converters[Mt];for(_t=fn.shift();_t;)if(Et.responseFields[_t]&&(Ut[Et.responseFields[_t]]=Ot),!Ct&&Xt&&Et.dataFilter&&(Ot=Et.dataFilter(Ot,Et.dataType)),Ct=_t,_t=fn.shift()){if(_t==="*")_t=Ct;else if(Ct!=="*"&&Ct!==_t){if(!(Mt=Gt[Ct+" "+_t]||Gt["* "+_t])){for(dt in Gt)if((Bt=dt.split(" "))[1]===_t&&(Mt=Gt[Ct+" "+Bt[0]]||Gt["* "+Bt[0]])){Mt===!0?Mt=Gt[dt]:Gt[dt]!==!0&&(_t=Bt[0],fn.unshift(Bt[1]));break}}if(Mt!==!0)if(Mt&&Et.throws)Ot=Mt(Ot);else try{Ot=Mt(Ot)}catch(Bn){return{state:"parsererror",error:Mt?Bn:"No conversion from "+Ct+" to "+_t}}}}return{state:"success",data:Ot}}(Re,Dt,lt,jt),jt?(Re.ifModified&&((hn=lt.getResponseHeader("Last-Modified"))&&(u.lastModified[V]=hn),(hn=lt.getResponseHeader("etag"))&&(u.etag[V]=hn)),pt===204||Re.type==="HEAD"?Ht="nocontent":pt===304?Ht="notmodified":(Ht=Dt.state,sn=Dt.data,jt=!(dn=Dt.error))):(dn=Ht,!pt&&Ht||(Ht="error",pt<0&&(pt=0))),lt.status=pt,lt.statusText=(xt||Ht)+"",jt?rt.resolveWith(Le,[sn,Ht,lt]):rt.rejectWith(Le,[lt,Ht,dn]),lt.statusCode(yt),yt=void 0,Me&&et.trigger(jt?"ajaxSuccess":"ajaxError",[lt,Re,jt?sn:dn]),tt.fireWith(Le,[lt,Ht]),Me&&(et.trigger("ajaxComplete",[lt,Re]),--u.active||u.event.trigger("ajaxStop")))}return lt},getJSON:function(p,P,G){return u.get(p,P,G,"json")},getScript:function(p,P){return u.get(p,void 0,P,"script")}}),u.each(["get","post"],function(p,P){u[P]=function(G,V,ie,ce){return x(V)&&(ce=ce||ie,ie=V,V=void 0),u.ajax(u.extend({url:G,type:P,dataType:ce,data:V,success:ie},u.isPlainObject(G)&&G))}}),u._evalUrl=function(p,P){return u.ajax({url:p,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(G){u.globalEval(G,P)}})},u.fn.extend({wrapAll:function(p){var P;return this[0]&&(x(p)&&(p=p.call(this[0])),P=u(p,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&P.insertBefore(this[0]),P.map(function(){for(var G=this;G.firstElementChild;)G=G.firstElementChild;return G}).append(this)),this},wrapInner:function(p){return x(p)?this.each(function(P){u(this).wrapInner(p.call(this,P))}):this.each(function(){var P=u(this),G=P.contents();G.length?G.wrapAll(p):P.append(p)})},wrap:function(p){var P=x(p);return this.each(function(G){u(this).wrapAll(P?p.call(this,G):p)})},unwrap:function(p){return this.parent(p).not("body").each(function(){u(this).replaceWith(this.childNodes)}),this}}),u.expr.pseudos.hidden=function(p){return!u.expr.pseudos.visible(p)},u.expr.pseudos.visible=function(p){return!!(p.offsetWidth||p.offsetHeight||p.getClientRects().length)},u.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch{}};var Ui={0:200,1223:204},mn=u.ajaxSettings.xhr();g.cors=!!mn&&"withCredentials"in mn,g.ajax=mn=!!mn,u.ajaxTransport(function(p){var P,G;if(g.cors||mn&&!p.crossDomain)return{send:function(V,ie){var ce,de=p.xhr();if(de.open(p.type,p.url,p.async,p.username,p.password),p.xhrFields)for(ce in p.xhrFields)de[ce]=p.xhrFields[ce];for(ce in p.mimeType&&de.overrideMimeType&&de.overrideMimeType(p.mimeType),p.crossDomain||V["X-Requested-With"]||(V["X-Requested-With"]="XMLHttpRequest"),V)de.setRequestHeader(ce,V[ce]);P=function(ye){return function(){P&&(P=G=de.onload=de.onerror=de.onabort=de.ontimeout=de.onreadystatechange=null,ye==="abort"?de.abort():ye==="error"?typeof de.status!="number"?ie(0,"error"):ie(de.status,de.statusText):ie(Ui[de.status]||de.status,de.statusText,(de.responseType||"text")!=="text"||typeof de.responseText!="string"?{binary:de.response}:{text:de.responseText},de.getAllResponseHeaders()))}},de.onload=P(),G=de.onerror=de.ontimeout=P("error"),de.onabort!==void 0?de.onabort=G:de.onreadystatechange=function(){de.readyState===4&&e.setTimeout(function(){P&&G()})},P=P("abort");try{de.send(p.hasContent&&p.data||null)}catch(ye){if(P)throw ye}},abort:function(){P&&P()}}}),u.ajaxPrefilter(function(p){p.crossDomain&&(p.contents.script=!1)}),u.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(p){return u.globalEval(p),p}}}),u.ajaxPrefilter("script",function(p){p.cache===void 0&&(p.cache=!1),p.crossDomain&&(p.type="GET")}),u.ajaxTransport("script",function(p){var P,G;if(p.crossDomain||p.scriptAttrs)return{send:function(V,ie){P=u("<script>").attr(p.scriptAttrs||{}).prop({charset:p.scriptCharset,src:p.url}).on("load error",G=function(ce){P.remove(),G=null,ce&&ie(ce.type==="error"?404:200,ce.type)}),t.head.appendChild(P[0])},abort:function(){G&&G()}}});var fi,pi=[],Un=/(=)\?(?=&|$)|\?\?/;u.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var p=pi.pop()||u.expando+"_"+oi++;return this[p]=!0,p}}),u.ajaxPrefilter("json jsonp",function(p,P,G){var V,ie,ce,de=p.jsonp!==!1&&(Un.test(p.url)?"url":typeof p.data=="string"&&(p.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Un.test(p.data)&&"data");if(de||p.dataTypes[0]==="jsonp")return V=p.jsonpCallback=x(p.jsonpCallback)?p.jsonpCallback():p.jsonpCallback,de?p[de]=p[de].replace(Un,"$1"+V):p.jsonp!==!1&&(p.url+=(In.test(p.url)?"&":"?")+p.jsonp+"="+V),p.converters["script json"]=function(){return ce||u.error(V+" was not called"),ce[0]},p.dataTypes[0]="json",ie=e[V],e[V]=function(){ce=arguments},G.always(function(){ie===void 0?u(e).removeProp(V):e[V]=ie,p[V]&&(p.jsonpCallback=P.jsonpCallback,pi.push(V)),ce&&x(ie)&&ie(ce[0]),ce=ie=void 0}),"script"}),g.createHTMLDocument=((fi=t.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",fi.childNodes.length===2),u.parseHTML=function(p,P,G){return typeof p!="string"?[]:(typeof P=="boolean"&&(G=P,P=!1),P||(g.createHTMLDocument?((V=(P=t.implementation.createHTMLDocument("")).createElement("base")).href=t.location.href,P.head.appendChild(V)):P=t),ce=!G&&[],(ie=F.exec(p))?[P.createElement(ie[1])]:(ie=ge([p],P,ce),ce&&ce.length&&u(ce).remove(),u.merge([],ie.childNodes)));var V,ie,ce},u.fn.load=function(p,P,G){var V,ie,ce,de=this,ye=p.indexOf(" ");return-1<ye&&(V=rn(p.slice(ye)),p=p.slice(0,ye)),x(P)?(G=P,P=void 0):P&&typeof P=="object"&&(ie="POST"),0<de.length&&u.ajax({url:p,type:ie||"GET",dataType:"html",data:P}).done(function(Te){ce=arguments,de.html(V?u("<div>").append(u.parseHTML(Te)).find(V):Te)}).always(G&&function(Te,Me){de.each(function(){G.apply(this,ce||[Te.responseText,Me,Te])})}),this},u.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(p,P){u.fn[P]=function(G){return this.on(P,G)}}),u.expr.pseudos.animated=function(p){return u.grep(u.timers,function(P){return p===P.elem}).length},u.offset={setOffset:function(p,P,G){var V,ie,ce,de,ye,Te,Me=u.css(p,"position"),Ne=u(p),Be={};Me==="static"&&(p.style.position="relative"),ye=Ne.offset(),ce=u.css(p,"top"),Te=u.css(p,"left"),(Me==="absolute"||Me==="fixed")&&-1<(ce+Te).indexOf("auto")?(de=(V=Ne.position()).top,ie=V.left):(de=parseFloat(ce)||0,ie=parseFloat(Te)||0),x(P)&&(P=P.call(p,G,u.extend({},ye))),P.top!=null&&(Be.top=P.top-ye.top+de),P.left!=null&&(Be.left=P.left-ye.left+ie),"using"in P?P.using.call(p,Be):Ne.css(Be)}},u.fn.extend({offset:function(p){if(arguments.length)return p===void 0?this:this.each(function(ie){u.offset.setOffset(this,p,ie)});var P,G,V=this[0];return V?V.getClientRects().length?(P=V.getBoundingClientRect(),G=V.ownerDocument.defaultView,{top:P.top+G.pageYOffset,left:P.left+G.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var p,P,G,V=this[0],ie={top:0,left:0};if(u.css(V,"position")==="fixed")P=V.getBoundingClientRect();else{for(P=this.offset(),G=V.ownerDocument,p=V.offsetParent||G.documentElement;p&&(p===G.body||p===G.documentElement)&&u.css(p,"position")==="static";)p=p.parentNode;p&&p!==V&&p.nodeType===1&&((ie=u(p).offset()).top+=u.css(p,"borderTopWidth",!0),ie.left+=u.css(p,"borderLeftWidth",!0))}return{top:P.top-ie.top-u.css(V,"marginTop",!0),left:P.left-ie.left-u.css(V,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var p=this.offsetParent;p&&u.css(p,"position")==="static";)p=p.offsetParent;return p||me})}}),u.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(p,P){var G=P==="pageYOffset";u.fn[p]=function(V){return pe(this,function(ie,ce,de){var ye;if(w(ie)?ye=ie:ie.nodeType===9&&(ye=ie.defaultView),de===void 0)return ye?ye[P]:ie[ce];ye?ye.scrollTo(G?ye.pageXOffset:de,G?de:ye.pageYOffset):ie[ce]=de},p,V,arguments.length)}}),u.each(["top","left"],function(p,P){u.cssHooks[P]=Vn(g.pixelPosition,function(G,V){if(V)return V=pn(G,P),zt.test(V)?u(G).position()[P]+"px":V})}),u.each({Height:"height",Width:"width"},function(p,P){u.each({padding:"inner"+p,content:P,"":"outer"+p},function(G,V){u.fn[V]=function(ie,ce){var de=arguments.length&&(G||typeof ie!="boolean"),ye=G||(ie===!0||ce===!0?"margin":"border");return pe(this,function(Te,Me,Ne){var Be;return w(Te)?V.indexOf("outer")===0?Te["inner"+p]:Te.document.documentElement["client"+p]:Te.nodeType===9?(Be=Te.documentElement,Math.max(Te.body["scroll"+p],Be["scroll"+p],Te.body["offset"+p],Be["offset"+p],Be["client"+p])):Ne===void 0?u.css(Te,Me,ye):u.style(Te,Me,Ne,ye)},P,de?ie:void 0,de)}})}),u.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(p,P){u.fn[P]=function(G,V){return 0<arguments.length?this.on(P,null,G,V):this.trigger(P)}}),u.fn.extend({hover:function(p,P){return this.mouseenter(p).mouseleave(P||p)}}),u.fn.extend({bind:function(p,P,G){return this.on(p,null,P,G)},unbind:function(p,P){return this.off(p,null,P)},delegate:function(p,P,G,V){return this.on(P,p,G,V)},undelegate:function(p,P,G){return arguments.length===1?this.off(p,"**"):this.off(P,p||"**",G)}}),u.proxy=function(p,P){var G,V,ie;if(typeof P=="string"&&(G=p[P],P=p,p=G),x(p))return V=a.call(arguments,2),(ie=function(){return p.apply(P||this,V.concat(a.call(arguments)))}).guid=p.guid=p.guid||u.guid++,ie},u.holdReady=function(p){p?u.readyWait++:u.ready(!0)},u.isArray=Array.isArray,u.parseJSON=JSON.parse,u.nodeName=A,u.isFunction=x,u.isWindow=w,u.camelCase=D,u.type=R,u.now=Date.now,u.isNumeric=function(p){var P=u.type(p);return(P==="number"||P==="string")&&!isNaN(p-parseFloat(p))},typeof define=="function"&&define.amd&&define("jquery",[],function(){return u});var Bi=e.jQuery,Gi=e.$;return u.noConflict=function(p){return e.$===u&&(e.$=Gi),p&&e.jQuery===u&&(e.jQuery=Bi),u},i||(e.jQuery=e.$=u),u});(function(e){if(typeof exports=="object"&&typeof module<"u")module.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var i;typeof window<"u"?i=window:typeof global<"u"?i=global:typeof self<"u"?i=self:i=this,i.GIF=e()}})(function(){return function(){function e(i,s,t){function c(o,l){if(!s[o]){if(!i[o]){var r=typeof require=="function"&&require;if(!l&&r)return r(o,!0);if(a)return a(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var h=s[o]={exports:{}};i[o][0].call(h.exports,function(_){var f=i[o][1][_];return c(f||_)},h,h.exports,e,i,s,t)}return s[o].exports}for(var a=typeof require=="function"&&require,n=0;n<t.length;n++)c(t[n]);return c}return e}()({1:[function(e,i,s){function t(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}i.exports=t,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._maxListeners=void 0,t.defaultMaxListeners=10,t.prototype.setMaxListeners=function(l){if(!a(l)||l<0||isNaN(l))throw TypeError("n must be a positive number");return this._maxListeners=l,this},t.prototype.emit=function(l){var r,d,h,_,f,g;if(this._events||(this._events={}),l==="error"&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if(r=arguments[1],r instanceof Error)throw r;var x=new Error('Uncaught, unspecified "error" event. ('+r+")");throw x.context=r,x}if(d=this._events[l],o(d))return!1;if(c(d))switch(arguments.length){case 1:d.call(this);break;case 2:d.call(this,arguments[1]);break;case 3:d.call(this,arguments[1],arguments[2]);break;default:_=Array.prototype.slice.call(arguments,1),d.apply(this,_)}else if(n(d))for(_=Array.prototype.slice.call(arguments,1),g=d.slice(),h=g.length,f=0;f<h;f++)g[f].apply(this,_);return!0},t.prototype.addListener=function(l,r){var d;if(!c(r))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",l,c(r.listener)?r.listener:r),this._events[l]?n(this._events[l])?this._events[l].push(r):this._events[l]=[this._events[l],r]:this._events[l]=r,n(this._events[l])&&!this._events[l].warned&&(o(this._maxListeners)?d=t.defaultMaxListeners:d=this._maxListeners,d&&d>0&&this._events[l].length>d&&(this._events[l].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[l].length),typeof console.trace=="function"&&console.trace())),this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(l,r){if(!c(r))throw TypeError("listener must be a function");var d=!1;function h(){this.removeListener(l,h),d||(d=!0,r.apply(this,arguments))}return h.listener=r,this.on(l,h),this},t.prototype.removeListener=function(l,r){var d,h,_,f;if(!c(r))throw TypeError("listener must be a function");if(!this._events||!this._events[l])return this;if(d=this._events[l],_=d.length,h=-1,d===r||c(d.listener)&&d.listener===r)delete this._events[l],this._events.removeListener&&this.emit("removeListener",l,r);else if(n(d)){for(f=_;f-- >0;)if(d[f]===r||d[f].listener&&d[f].listener===r){h=f;break}if(h<0)return this;d.length===1?(d.length=0,delete this._events[l]):d.splice(h,1),this._events.removeListener&&this.emit("removeListener",l,r)}return this},t.prototype.removeAllListeners=function(l){var r,d;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[l]&&delete this._events[l],this;if(arguments.length===0){for(r in this._events)r!=="removeListener"&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events={},this}if(d=this._events[l],c(d))this.removeListener(l,d);else if(d)for(;d.length;)this.removeListener(l,d[d.length-1]);return delete this._events[l],this},t.prototype.listeners=function(l){var r;return!this._events||!this._events[l]?r=[]:c(this._events[l])?r=[this._events[l]]:r=this._events[l].slice(),r},t.prototype.listenerCount=function(l){if(this._events){var r=this._events[l];if(c(r))return 1;if(r)return r.length}return 0},t.listenerCount=function(l,r){return l.listenerCount(r)};function c(l){return typeof l=="function"}function a(l){return typeof l=="number"}function n(l){return typeof l=="object"&&l!==null}function o(l){return l===void 0}},{}],2:[function(e,i,s){var t,c,a,n,o;o=navigator.userAgent.toLowerCase(),n=navigator.platform.toLowerCase(),t=o.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],a=t[1]==="ie"&&document.documentMode,c={name:t[1]==="version"?t[3]:t[1],version:a||parseFloat(t[1]==="opera"&&t[4]?t[4]:t[2]),platform:{name:o.match(/ip(?:ad|od|hone)/)?"ios":(o.match(/(?:webos|android)/)||n.match(/mac|win|linux/)||["other"])[0]}},c[c.name]=!0,c[c.name+parseInt(c.version,10)]=!0,c.platform[c.platform.name]=!0,i.exports=c},{}],3:[function(e,i,s){var t,c,a,n=function(d,h){for(var _ in h)o.call(h,_)&&(d[_]=h[_]);function f(){this.constructor=d}return f.prototype=h.prototype,d.prototype=new f,d.__super__=h.prototype,d},o={}.hasOwnProperty,l=[].indexOf||function(d){for(var h=0,_=this.length;h<_;h++)if(h in this&&this[h]===d)return h;return-1},r=[].slice;t=e("events").EventEmitter,a=e("./browser.coffee"),c=function(d){var h,_;n(f,d),h={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},_={delay:500,copy:!1,dispose:-1};function f(g){var x,w,S;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(g);for(w in h)S=h[w],(x=this.options)[w]==null&&(x[w]=S)}return f.prototype.setOption=function(g,x){if(this.options[g]=x,this._canvas!=null&&(g==="width"||g==="height"))return this._canvas[g]=x},f.prototype.setOptions=function(g){var x,w,S;w=[];for(x in g)o.call(g,x)&&(S=g[x],w.push(this.setOption(x,S)));return w},f.prototype.addFrame=function(g,x){var w,S;x==null&&(x={}),w={},w.transparent=this.options.transparent;for(S in _)w[S]=x[S]||_[S];if(this.options.width==null&&this.setOption("width",g.width),this.options.height==null&&this.setOption("height",g.height),typeof ImageData<"u"&&ImageData!==null&&g instanceof ImageData)w.data=g.data;else if(typeof CanvasRenderingContext2D<"u"&&CanvasRenderingContext2D!==null&&g instanceof CanvasRenderingContext2D||typeof WebGLRenderingContext<"u"&&WebGLRenderingContext!==null&&g instanceof WebGLRenderingContext)x.copy?w.data=this.getContextData(g):w.context=g;else if(g.childNodes!=null)x.copy?w.data=this.getImageData(g):w.image=g;else throw new Error("Invalid image");return this.frames.push(w)},f.prototype.render=function(){var g,x,w;if(this.running)throw new Error("Already running");if(this.options.width==null||this.options.height==null)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=(function(){var S,M,R;for(R=[],S=0,M=this.frames.length;0<=M?S<M:S>M;0<=M?++S:--S)R.push(null);return R}).call(this),x=this.spawnWorkers(),this.options.globalPalette===!0)this.renderNextFrame();else for(g=0,w=x;0<=w?g<w:g>w;0<=w?++g:--g)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},f.prototype.abort=function(){for(var g;g=this.activeWorkers.shift(),g!=null;)this.log("killing active worker"),g.terminate();return this.running=!1,this.emit("abort")},f.prototype.spawnWorkers=function(){var g,x,w;return g=Math.min(this.options.workers,this.frames.length),(function(){w=[];for(var S=x=this.freeWorkers.length;x<=g?S<g:S>g;x<=g?S++:S--)w.push(S);return w}).apply(this).forEach(function(S){return function(M){var R;return S.log("spawning worker "+M),R=new Worker(S.options.workerScript),R.onmessage=function(C){return S.activeWorkers.splice(S.activeWorkers.indexOf(R),1),S.freeWorkers.push(R),S.frameFinished(C.data)},S.freeWorkers.push(R)}}(this)),g},f.prototype.frameFinished=function(g){var x,w;if(this.log("frame "+g.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[g.index]=g,this.options.globalPalette===!0&&(this.options.globalPalette=g.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(x=1,w=this.freeWorkers.length;1<=w?x<w:x>w;1<=w?++x:--x)this.renderNextFrame();return l.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},f.prototype.finishRendering=function(){var g,x,w,S,M,R,C,u,m,y,v,T,k,L,A,F;for(u=0,L=this.imageParts,M=0,m=L.length;M<m;M++)x=L[M],u+=(x.data.length-1)*x.pageSize+x.cursor;for(u+=x.pageSize-x.cursor,this.log("rendering finished - filesize "+Math.round(u/1e3)+"kb"),g=new Uint8Array(u),T=0,A=this.imageParts,R=0,y=A.length;R<y;R++)for(x=A[R],F=x.data,w=C=0,v=F.length;C<v;w=++C)k=F[w],g.set(k,T),w===x.data.length-1?T+=x.cursor:T+=x.pageSize;return S=new Blob([g],{type:"image/gif"}),this.emit("finished",S,g)},f.prototype.renderNextFrame=function(){var g,x,w;if(this.freeWorkers.length===0)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return g=this.frames[this.nextFrame++],w=this.freeWorkers.shift(),x=this.getTask(g),this.log("starting frame "+(x.index+1)+" of "+this.frames.length),this.activeWorkers.push(w),w.postMessage(x)},f.prototype.getContextData=function(g){return g.getImageData(0,0,this.options.width,this.options.height).data},f.prototype.getImageData=function(g){var x;return this._canvas==null&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),x=this._canvas.getContext("2d"),x.fillStyle=this.options.background,x.fillRect(0,0,this.options.width,this.options.height),x.drawImage(g,0,0),this.getContextData(x)},f.prototype.getTask=function(g){var x,w;if(x=this.frames.indexOf(g),w={index:x,last:x===this.frames.length-1,delay:g.delay,dispose:g.dispose,transparent:g.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:a.name==="chrome"},g.data!=null)w.data=g.data;else if(g.context!=null)w.data=this.getContextData(g.context);else if(g.image!=null)w.data=this.getImageData(g.image);else throw new Error("Invalid frame");return w},f.prototype.log=function(){var g;if(g=1<=arguments.length?r.call(arguments,0):[],!!this.options.debug)return console.log.apply(console,g)},f}(t),i.exports=c},{"./browser.coffee":2,events:1}]},{},[3])(3)});const UPNG={};UPNG.toRGBA8=function(e){var i=e.width,s=e.height;if(e.tabs.acTL==null)return[UPNG.toRGBA8.decodeImage(e.data,i,s,e).buffer];var t=[];e.frames[0].data==null&&(e.frames[0].data=e.data);for(var c=i*s*4,a=new Uint8Array(c),n=new Uint8Array(c),o=new Uint8Array(c),l=0;l<e.frames.length;l++){var r=e.frames[l],d=r.rect.x,h=r.rect.y,_=r.rect.width,f=r.rect.height,g=UPNG.toRGBA8.decodeImage(r.data,_,f,e);if(l!=0)for(var x=0;x<c;x++)o[x]=a[x];if(r.blend==0?UPNG._copyTile(g,_,f,a,i,s,d,h,0):r.blend==1&&UPNG._copyTile(g,_,f,a,i,s,d,h,1),t.push(a.buffer.slice(0)),r.dispose!=0){if(r.dispose==1)UPNG._copyTile(n,_,f,a,i,s,d,h,0);else if(r.dispose==2)for(var x=0;x<c;x++)a[x]=o[x]}}return t};UPNG.toRGBA8.decodeImage=function(e,i,s,t){var c=i*s,a=UPNG.decode._getBPP(t),n=Math.ceil(i*a/8),o=new Uint8Array(c*4),l=new Uint32Array(o.buffer),r=t.ctype,d=t.depth,h=UPNG._bin.readUshort;if(r==6){var _=c<<2;if(d==8)for(var f=0;f<_;f+=4)o[f]=e[f],o[f+1]=e[f+1],o[f+2]=e[f+2],o[f+3]=e[f+3];if(d==16)for(var f=0;f<_;f++)o[f]=e[f<<1]}else if(r==2){var g=t.tabs.tRNS;if(g==null){if(d==8)for(var f=0;f<c;f++){var x=f*3;l[f]=255<<24|e[x+2]<<16|e[x+1]<<8|e[x]}if(d==16)for(var f=0;f<c;f++){var x=f*6;l[f]=255<<24|e[x+4]<<16|e[x+2]<<8|e[x]}}else{var w=g[0],S=g[1],M=g[2];if(d==8)for(var f=0;f<c;f++){var R=f<<2,x=f*3;l[f]=255<<24|e[x+2]<<16|e[x+1]<<8|e[x],e[x]==w&&e[x+1]==S&&e[x+2]==M&&(o[R+3]=0)}if(d==16)for(var f=0;f<c;f++){var R=f<<2,x=f*6;l[f]=255<<24|e[x+4]<<16|e[x+2]<<8|e[x],h(e,x)==w&&h(e,x+2)==S&&h(e,x+4)==M&&(o[R+3]=0)}}}else if(r==3){var C=t.tabs.PLTE,u=t.tabs.tRNS,m=u?u.length:0;if(d==1)for(var y=0;y<s;y++)for(var v=y*n,T=y*i,f=0;f<i;f++){var R=T+f<<2,k=e[v+(f>>3)]>>7-((f&7)<<0)&1,L=3*k;o[R]=C[L],o[R+1]=C[L+1],o[R+2]=C[L+2],o[R+3]=k<m?u[k]:255}if(d==2)for(var y=0;y<s;y++)for(var v=y*n,T=y*i,f=0;f<i;f++){var R=T+f<<2,k=e[v+(f>>2)]>>6-((f&3)<<1)&3,L=3*k;o[R]=C[L],o[R+1]=C[L+1],o[R+2]=C[L+2],o[R+3]=k<m?u[k]:255}if(d==4)for(var y=0;y<s;y++)for(var v=y*n,T=y*i,f=0;f<i;f++){var R=T+f<<2,k=e[v+(f>>1)]>>4-((f&1)<<2)&15,L=3*k;o[R]=C[L],o[R+1]=C[L+1],o[R+2]=C[L+2],o[R+3]=k<m?u[k]:255}if(d==8)for(var f=0;f<c;f++){var R=f<<2,k=e[f],L=3*k;o[R]=C[L],o[R+1]=C[L+1],o[R+2]=C[L+2],o[R+3]=k<m?u[k]:255}}else if(r==4){if(d==8)for(var f=0;f<c;f++){var R=f<<2,A=f<<1,F=e[A];o[R]=F,o[R+1]=F,o[R+2]=F,o[R+3]=e[A+1]}if(d==16)for(var f=0;f<c;f++){var R=f<<2,A=f<<2,F=e[A];o[R]=F,o[R+1]=F,o[R+2]=F,o[R+3]=e[A+2]}}else if(r==0)for(var w=t.tabs.tRNS?t.tabs.tRNS:-1,y=0;y<s;y++){var K=y*n,Q=y*i;if(d==1)for(var Z=0;Z<i;Z++){var F=255*(e[K+(Z>>>3)]>>>7-(Z&7)&1),B=F==w*255?0:255;l[Q+Z]=B<<24|F<<16|F<<8|F}else if(d==2)for(var Z=0;Z<i;Z++){var F=85*(e[K+(Z>>>2)]>>>6-((Z&3)<<1)&3),B=F==w*85?0:255;l[Q+Z]=B<<24|F<<16|F<<8|F}else if(d==4)for(var Z=0;Z<i;Z++){var F=17*(e[K+(Z>>>1)]>>>4-((Z&1)<<2)&15),B=F==w*17?0:255;l[Q+Z]=B<<24|F<<16|F<<8|F}else if(d==8)for(var Z=0;Z<i;Z++){var F=e[K+Z],B=F==w?0:255;l[Q+Z]=B<<24|F<<16|F<<8|F}else if(d==16)for(var Z=0;Z<i;Z++){var F=e[K+(Z<<1)],B=h(e,K+(Z<<f))==w?0:255;l[Q+Z]=B<<24|F<<16|F<<8|F}}return o};UPNG.decode=function(e){for(var i=new Uint8Array(e),s=8,t=UPNG._bin,c=t.readUshort,a=t.readUint,n={tabs:{},frames:[]},o=new Uint8Array(i.length),l=0,r,d=0,h=[137,80,78,71,13,10,26,10],_=0;_<8;_++)if(i[_]!=h[_])throw"The input is not a PNG file!";for(;s<i.length;){var f=t.readUint(i,s);s+=4;var g=t.readASCII(i,s,4);if(s+=4,g=="IHDR")UPNG.decode._IHDR(i,s,n);else if(g=="CgBI")n.tabs[g]=i.slice(s,s+4);else if(g=="IDAT"){for(var _=0;_<f;_++)o[l+_]=i[s+_];l+=f}else if(g=="acTL")n.tabs[g]={num_frames:a(i,s),num_plays:a(i,s+4)},r=new Uint8Array(i.length);else if(g=="fcTL"){if(d!=0){var x=n.frames[n.frames.length-1];x.data=UPNG.decode._decompress(n,r.slice(0,d),x.rect.width,x.rect.height),d=0}var w={x:a(i,s+12),y:a(i,s+16),width:a(i,s+4),height:a(i,s+8)},S=c(i,s+22);S=c(i,s+20)/(S==0?100:S);var M={rect:w,delay:Math.round(S*1e3),dispose:i[s+24],blend:i[s+25]};n.frames.push(M)}else if(g=="fdAT"){for(var _=0;_<f-4;_++)r[d+_]=i[s+_+4];d+=f-4}else if(g=="pHYs")n.tabs[g]=[t.readUint(i,s),t.readUint(i,s+4),i[s+8]];else if(g=="cHRM"){n.tabs[g]=[];for(var _=0;_<8;_++)n.tabs[g].push(t.readUint(i,s+_*4))}else if(g=="tEXt"||g=="zTXt"){n.tabs[g]==null&&(n.tabs[g]={});var R=t.nextZero(i,s),C=t.readASCII(i,s,R-s),u,m=s+f-R-1;if(g=="tEXt")u=t.readASCII(i,R+1,m);else{var y=UPNG.decode._inflate(i.slice(R+2,R+2+m));u=t.readUTF8(y,0,y.length)}n.tabs[g][C]=u}else if(g=="iTXt"){n.tabs[g]==null&&(n.tabs[g]={});var R=0,v=s;R=t.nextZero(i,v);var C=t.readASCII(i,v,R-v);v=R+1;var T=i[v];i[v+1],v+=2,R=t.nextZero(i,v),t.readASCII(i,v,R-v),v=R+1,R=t.nextZero(i,v),t.readUTF8(i,v,R-v),v=R+1;var u,m=f-(v-s);if(T==0)u=t.readUTF8(i,v,m);else{var y=UPNG.decode._inflate(i.slice(v,v+m));u=t.readUTF8(y,0,y.length)}n.tabs[g][C]=u}else if(g=="PLTE")n.tabs[g]=t.readBytes(i,s,f);else if(g=="hIST"){var k=n.tabs.PLTE.length/3;n.tabs[g]=[];for(var _=0;_<k;_++)n.tabs[g].push(c(i,s+_*2))}else if(g=="tRNS")n.ctype==3?n.tabs[g]=t.readBytes(i,s,f):n.ctype==0?n.tabs[g]=c(i,s):n.ctype==2&&(n.tabs[g]=[c(i,s),c(i,s+2),c(i,s+4)]);else if(g=="gAMA")n.tabs[g]=t.readUint(i,s)/1e5;else if(g=="sRGB")n.tabs[g]=i[s];else if(g=="bKGD")n.ctype==0||n.ctype==4?n.tabs[g]=[c(i,s)]:n.ctype==2||n.ctype==6?n.tabs[g]=[c(i,s),c(i,s+2),c(i,s+4)]:n.ctype==3&&(n.tabs[g]=i[s]);else if(g=="IEND")break;s+=f,t.readUint(i,s),s+=4}if(d!=0){var x=n.frames[n.frames.length-1];x.data=UPNG.decode._decompress(n,r.slice(0,d),x.rect.width,x.rect.height),d=0}return n.data=UPNG.decode._decompress(n,o,n.width,n.height),delete n.compress,delete n.interlace,delete n.filter,n};UPNG.decode._decompress=function(e,i,s,t){var c=UPNG.decode._getBPP(e),a=Math.ceil(s*c/8),n=new Uint8Array((a+1+e.interlace)*t);return e.tabs.CgBI?i=UPNG.inflateRaw(i,n):i=UPNG.decode._inflate(i,n),e.interlace==0?i=UPNG.decode._filterZero(i,e,0,s,t):e.interlace==1&&(i=UPNG.decode._readInterlace(i,e)),i};UPNG.decode._inflate=function(e,i){var s=UPNG.inflateRaw(new Uint8Array(e.buffer,2,e.length-6),i);return s};UPNG.inflateRaw=function(){var e={};return e.H={},e.H.N=function(i,s){var t=Uint8Array,c=0,a=0,n=0,o=0,l=0,r=0,d=0,h=0,_=0,f,g;if(i[0]==3&&i[1]==0)return s||new t(0);var x=e.H,w=x.b,S=x.e,M=x.R,R=x.n,C=x.A,u=x.Z,m=x.m,y=s==null;for(y&&(s=new t(i.length>>>2<<5));c==0;){if(c=w(i,_,1),a=w(i,_+1,2),_+=3,a==0){_&7&&(_+=8-(_&7));var v=(_>>>3)+4,T=i[v-4]|i[v-3]<<8;y&&(s=e.H.W(s,h+T)),s.set(new t(i.buffer,i.byteOffset+v,T),h),_=v+T<<3,h+=T;continue}if(y&&(s=e.H.W(s,h+(1<<17))),a==1&&(f=m.J,g=m.h,r=511,d=31),a==2){n=S(i,_,5)+257,o=S(i,_+5,5)+1,l=S(i,_+10,4)+4,_+=14;for(var k=1,L=0;L<38;L+=2)m.Q[L]=0,m.Q[L+1]=0;for(var L=0;L<l;L++){var A=S(i,_+L*3,3);m.Q[(m.X[L]<<1)+1]=A,A>k&&(k=A)}_+=3*l,R(m.Q,k),C(m.Q,k,m.u),f=m.w,g=m.d,_=M(m.u,(1<<k)-1,n+o,i,_,m.v);var F=x.V(m.v,0,n,m.C);r=(1<<F)-1;var K=x.V(m.v,n,o,m.D);d=(1<<K)-1,R(m.C,F),C(m.C,F,f),R(m.D,K),C(m.D,K,g)}for(;;){var Q=f[u(i,_)&r];_+=Q&15;var Z=Q>>>4;if(!(Z>>>8))s[h++]=Z;else{if(Z==256)break;var B=h+Z-254;if(Z>264){var z=m.q[Z-257];B=h+(z>>>3)+S(i,_,z&7),_+=z&7}var b=g[u(i,_)&d];_+=b&15;var N=b>>>4,U=m.c[N],q=(U>>>4)+w(i,_,U&15);for(_+=U&15;h<B;)s[h]=s[h++-q],s[h]=s[h++-q],s[h]=s[h++-q],s[h]=s[h++-q];h=B}}}return s.length==h?s:s.slice(0,h)},e.H.W=function(i,s){var t=i.length;if(s<=t)return i;var c=new Uint8Array(t<<1);return c.set(i,0),c},e.H.R=function(i,s,t,c,a,n){for(var o=e.H.e,l=e.H.Z,r=0;r<t;){var d=i[l(c,a)&s];a+=d&15;var h=d>>>4;if(h<=15)n[r]=h,r++;else{var _=0,f=0;h==16?(f=3+o(c,a,2),a+=2,_=n[r-1]):h==17?(f=3+o(c,a,3),a+=3):h==18&&(f=11+o(c,a,7),a+=7);for(var g=r+f;r<g;)n[r]=_,r++}}return a},e.H.V=function(i,s,t,c){for(var a=0,n=0,o=c.length>>>1;n<t;){var l=i[n+s];c[n<<1]=0,c[(n<<1)+1]=l,l>a&&(a=l),n++}for(;n<o;)c[n<<1]=0,c[(n<<1)+1]=0,n++;return a},e.H.n=function(i,s){for(var t=e.H.m,c=i.length,a,n,o,l,r,d=t.j,l=0;l<=s;l++)d[l]=0;for(l=1;l<c;l+=2)d[i[l]]++;var h=t.K;for(a=0,d[0]=0,n=1;n<=s;n++)a=a+d[n-1]<<1,h[n]=a;for(o=0;o<c;o+=2)r=i[o+1],r!=0&&(i[o]=h[r],h[r]++)},e.H.A=function(i,s,t){for(var c=i.length,a=e.H.m,n=a.r,o=0;o<c;o+=2)if(i[o+1]!=0)for(var l=o>>1,r=i[o+1],d=l<<4|r,h=s-r,_=i[o]<<h,f=_+(1<<h);_!=f;){var g=n[_]>>>15-s;t[g]=d,_++}},e.H.l=function(i,s){for(var t=e.H.m.r,c=15-s,a=0;a<i.length;a+=2){var n=i[a]<<s-i[a+1];i[a]=t[n]>>>c}},e.H.M=function(i,s,t){t=t<<(s&7);var c=s>>>3;i[c]|=t,i[c+1]|=t>>>8},e.H.I=function(i,s,t){t=t<<(s&7);var c=s>>>3;i[c]|=t,i[c+1]|=t>>>8,i[c+2]|=t>>>16},e.H.e=function(i,s,t){return(i[s>>>3]|i[(s>>>3)+1]<<8)>>>(s&7)&(1<<t)-1},e.H.b=function(i,s,t){return(i[s>>>3]|i[(s>>>3)+1]<<8|i[(s>>>3)+2]<<16)>>>(s&7)&(1<<t)-1},e.H.Z=function(i,s){return(i[s>>>3]|i[(s>>>3)+1]<<8|i[(s>>>3)+2]<<16)>>>(s&7)},e.H.i=function(i,s){return(i[s>>>3]|i[(s>>>3)+1]<<8|i[(s>>>3)+2]<<16|i[(s>>>3)+3]<<24)>>>(s&7)},e.H.m=function(){var i=Uint16Array,s=Uint32Array;return{K:new i(16),j:new i(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new i(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new s(32),J:new i(512),_:[],h:new i(32),$:[],w:new i(32768),C:[],v:[],d:new i(32768),D:[],u:new i(512),Q:[],r:new i(32768),s:new s(286),Y:new s(30),a:new s(19),t:new s(15e3),k:new i(65536),g:new i(32768)}}(),function(){for(var i=e.H.m,s=32768,t=0;t<s;t++){var c=t;c=(c&2863311530)>>>1|(c&1431655765)<<1,c=(c&3435973836)>>>2|(c&858993459)<<2,c=(c&4042322160)>>>4|(c&252645135)<<4,c=(c&4278255360)>>>8|(c&16711935)<<8,i.r[t]=(c>>>16|c<<16)>>>17}function a(n,o,l){for(;o--!=0;)n.push(0,l)}for(var t=0;t<32;t++)i.q[t]=i.S[t]<<3|i.T[t],i.c[t]=i.p[t]<<4|i.z[t];a(i._,144,8),a(i._,112,9),a(i._,24,7),a(i._,8,8),e.H.n(i._,9),e.H.A(i._,9,i.J),e.H.l(i._,9),a(i.$,32,5),e.H.n(i.$,5),e.H.A(i.$,5,i.h),e.H.l(i.$,5),a(i.Q,19,0),a(i.C,286,0),a(i.D,30,0),a(i.v,320,0)}(),e.H.N}();UPNG.decode._readInterlace=function(e,i){for(var s=i.width,t=i.height,c=UPNG.decode._getBPP(i),a=c>>3,n=Math.ceil(s*c/8),o=new Uint8Array(t*n),l=0,r=[0,0,4,0,2,0,1],d=[0,4,0,2,0,1,0],h=[8,8,8,4,4,2,2],_=[8,8,4,4,2,2,1],f=0;f<7;){for(var g=h[f],x=_[f],w=0,S=0,M=r[f];M<t;)M+=g,S++;for(var R=d[f];R<s;)R+=x,w++;var C=Math.ceil(w*c/8);UPNG.decode._filterZero(e,i,l,w,S);for(var u=0,m=r[f];m<t;){for(var y=d[f],v=l+u*C<<3;y<s;){if(c==1){var T=e[v>>3];T=T>>7-(v&7)&1,o[m*n+(y>>3)]|=T<<7-((y&7)<<0)}if(c==2){var T=e[v>>3];T=T>>6-(v&7)&3,o[m*n+(y>>2)]|=T<<6-((y&3)<<1)}if(c==4){var T=e[v>>3];T=T>>4-(v&7)&15,o[m*n+(y>>1)]|=T<<4-((y&1)<<2)}if(c>=8)for(var k=m*n+y*a,L=0;L<a;L++)o[k+L]=e[(v>>3)+L];v+=c,y+=x}u++,m+=g}w*S!=0&&(l+=S*(1+C)),f=f+1}return o};UPNG.decode._getBPP=function(e){var i=[1,null,3,1,2,null,4][e.ctype];return i*e.depth};UPNG.decode._filterZero=function(e,i,s,t,c){var a=UPNG.decode._getBPP(i),n=Math.ceil(t*a/8),o=UPNG.decode._paeth;a=Math.ceil(a/8);var l=0,r=1,d=e[s],h=0;if(d>1&&(e[s]=[0,0,1][d-2]),d==3)for(h=a;h<n;h++)e[h+1]=e[h+1]+(e[h+1-a]>>>1)&255;for(var _=0;_<c;_++)if(l=s+_*n,r=l+_+1,d=e[r-1],h=0,d==0)for(;h<n;h++)e[l+h]=e[r+h];else if(d==1){for(;h<a;h++)e[l+h]=e[r+h];for(;h<n;h++)e[l+h]=e[r+h]+e[l+h-a]}else if(d==2)for(;h<n;h++)e[l+h]=e[r+h]+e[l+h-n];else if(d==3){for(;h<a;h++)e[l+h]=e[r+h]+(e[l+h-n]>>>1);for(;h<n;h++)e[l+h]=e[r+h]+(e[l+h-n]+e[l+h-a]>>>1)}else{for(;h<a;h++)e[l+h]=e[r+h]+o(0,e[l+h-n],0);for(;h<n;h++)e[l+h]=e[r+h]+o(e[l+h-a],e[l+h-n],e[l+h-a-n])}return e};UPNG.decode._paeth=function(e,i,s){var t=e+i-s,c=t-e,a=t-i,n=t-s;return c*c<=a*a&&c*c<=n*n?e:a*a<=n*n?i:s};UPNG.decode._IHDR=function(e,i,s){var t=UPNG._bin;s.width=t.readUint(e,i),i+=4,s.height=t.readUint(e,i),i+=4,s.depth=e[i],i++,s.ctype=e[i],i++,s.compress=e[i],i++,s.filter=e[i],i++,s.interlace=e[i],i++};UPNG._bin={nextZero:function(e,i){for(;e[i]!=0;)i++;return i},readUshort:function(e,i){return e[i]<<8|e[i+1]},writeUshort:function(e,i,s){e[i]=s>>8&255,e[i+1]=s&255},readUint:function(e,i){return e[i]*(256*256*256)+(e[i+1]<<16|e[i+2]<<8|e[i+3])},writeUint:function(e,i,s){e[i]=s>>24&255,e[i+1]=s>>16&255,e[i+2]=s>>8&255,e[i+3]=s&255},readASCII:function(e,i,s){for(var t="",c=0;c<s;c++)t+=String.fromCharCode(e[i+c]);return t},writeASCII:function(e,i,s){for(var t=0;t<s.length;t++)e[i+t]=s.charCodeAt(t)},readBytes:function(e,i,s){for(var t=[],c=0;c<s;c++)t.push(e[i+c]);return t},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,i,s){for(var t="",c,a=0;a<s;a++)t+="%"+UPNG._bin.pad(e[i+a].toString(16));try{c=decodeURIComponent(t)}catch{return UPNG._bin.readASCII(e,i,s)}return c}};UPNG._copyTile=function(e,i,s,t,c,a,n,o,l){for(var r=Math.min(i,c),d=Math.min(s,a),h=0,_=0,f=0;f<d;f++)for(var g=0;g<r;g++)if(n>=0&&o>=0?(h=f*i+g<<2,_=(o+f)*c+n+g<<2):(h=(-o+f)*i-n+g<<2,_=f*c+g<<2),l==0)t[_]=e[h],t[_+1]=e[h+1],t[_+2]=e[h+2],t[_+3]=e[h+3];else if(l==1){var x=e[h+3]*.00392156862745098,w=e[h]*x,S=e[h+1]*x,M=e[h+2]*x,R=t[_+3]*(1/255),C=t[_]*R,u=t[_+1]*R,m=t[_+2]*R,y=1-x,v=x+R*y,T=v==0?0:1/v;t[_+3]=255*v,t[_+0]=(w+C*y)*T,t[_+1]=(S+u*y)*T,t[_+2]=(M+m*y)*T}else if(l==2){var x=e[h+3],w=e[h],S=e[h+1],M=e[h+2],R=t[_+3],C=t[_],u=t[_+1],m=t[_+2];x==R&&w==C&&S==u&&M==m?(t[_]=0,t[_+1]=0,t[_+2]=0,t[_+3]=0):(t[_]=w,t[_+1]=S,t[_+2]=M,t[_+3]=x)}else if(l==3){var x=e[h+3],w=e[h],S=e[h+1],M=e[h+2],R=t[_+3],C=t[_],u=t[_+1],m=t[_+2];if(x==R&&w==C&&S==u&&M==m)continue;if(x<220&&R>20)return!1}return!0};UPNG.encode=function(e,i,s,t,c,a,n){t==null&&(t=0),n==null&&(n=!1);var o=UPNG.encode.compress(e,i,s,t,[!1,!1,!1,0,n]);return UPNG.encode.compressPNG(o,-1),UPNG.encode._main(o,i,s,c,a)};UPNG.encodeLL=function(e,i,s,t,c,a,n,o){for(var l={ctype:0+(t==1?0:2)+(c==0?0:4),depth:a,frames:[]},r=(t+c)*a,d=r*i,h=0;h<e.length;h++)l.frames.push({rect:{x:0,y:0,width:i,height:s},img:new Uint8Array(e[h]),blend:0,dispose:1,bpp:Math.ceil(r/8),bpl:Math.ceil(d/8)});UPNG.encode.compressPNG(l,0,!0);var _=UPNG.encode._main(l,i,s,n,o);return _};UPNG.encode._main=function(e,i,s,t,c){c==null&&(c={});var a=UPNG.crc.crc,n=UPNG._bin.writeUint,o=UPNG._bin.writeUshort,l=UPNG._bin.writeASCII,r=8,d=e.frames.length>1,h=!1,_=33+(d?20:0);if(c.sRGB!=null&&(_+=13),c.pHYs!=null&&(_+=21),e.ctype==3){for(var f=e.plte.length,g=0;g<f;g++)e.plte[g]>>>24!=255&&(h=!0);_+=8+f*3+4+(h?8+f*1+4:0)}for(var x=0;x<e.frames.length;x++){var w=e.frames[x];d&&(_+=38),_+=w.cimg.length+12,x!=0&&(_+=4)}_+=12;for(var S=new Uint8Array(_),M=[137,80,78,71,13,10,26,10],g=0;g<8;g++)S[g]=M[g];if(n(S,r,13),r+=4,l(S,r,"IHDR"),r+=4,n(S,r,i),r+=4,n(S,r,s),r+=4,S[r]=e.depth,r++,S[r]=e.ctype,r++,S[r]=0,r++,S[r]=0,r++,S[r]=0,r++,n(S,r,a(S,r-17,17)),r+=4,c.sRGB!=null&&(n(S,r,1),r+=4,l(S,r,"sRGB"),r+=4,S[r]=c.sRGB,r++,n(S,r,a(S,r-5,5)),r+=4),c.pHYs!=null&&(n(S,r,9),r+=4,l(S,r,"pHYs"),r+=4,n(S,r,c.pHYs[0]),r+=4,n(S,r,c.pHYs[1]),r+=4,S[r]=c.pHYs[2],r++,n(S,r,a(S,r-13,13)),r+=4),d&&(n(S,r,8),r+=4,l(S,r,"acTL"),r+=4,n(S,r,e.frames.length),r+=4,n(S,r,c.loop!=null?c.loop:0),r+=4,n(S,r,a(S,r-12,12)),r+=4),e.ctype==3){var f=e.plte.length;n(S,r,f*3),r+=4,l(S,r,"PLTE"),r+=4;for(var g=0;g<f;g++){var R=g*3,C=e.plte[g],u=C&255,m=C>>>8&255,y=C>>>16&255;S[r+R+0]=u,S[r+R+1]=m,S[r+R+2]=y}if(r+=f*3,n(S,r,a(S,r-f*3-4,f*3+4)),r+=4,h){n(S,r,f),r+=4,l(S,r,"tRNS"),r+=4;for(var g=0;g<f;g++)S[r+g]=e.plte[g]>>>24&255;r+=f,n(S,r,a(S,r-f-4,f+4)),r+=4}}for(var v=0,x=0;x<e.frames.length;x++){var w=e.frames[x];d&&(n(S,r,26),r+=4,l(S,r,"fcTL"),r+=4,n(S,r,v++),r+=4,n(S,r,w.rect.width),r+=4,n(S,r,w.rect.height),r+=4,n(S,r,w.rect.x),r+=4,n(S,r,w.rect.y),r+=4,o(S,r,t[x]),r+=2,o(S,r,1e3),r+=2,S[r]=w.dispose,r++,S[r]=w.blend,r++,n(S,r,a(S,r-30,30)),r+=4);var T=w.cimg,f=T.length;n(S,r,f+(x==0?0:4)),r+=4;var k=r;l(S,r,x==0?"IDAT":"fdAT"),r+=4,x!=0&&(n(S,r,v++),r+=4),S.set(T,r),r+=f,n(S,r,a(S,k,r-k)),r+=4}return n(S,r,0),r+=4,l(S,r,"IEND"),r+=4,n(S,r,a(S,r-4,4)),r+=4,S.buffer};UPNG.encode.compressPNG=function(e,i,s){for(var t=0;t<e.frames.length;t++){var c=e.frames[t];c.rect.width;var a=c.rect.height,n=new Uint8Array(a*c.bpl+a);c.cimg=UPNG.encode._filterZero(c.img,a,c.bpp,c.bpl,n,i,s)}};UPNG.encode.compress=function(e,i,s,t,c){for(var a=c[0],n=c[1],o=c[2],l=c[3],r=c[4],d=6,h=8,_=255,f=0;f<e.length;f++)for(var g=new Uint8Array(e[f]),x=g.length,w=0;w<x;w+=4)_&=g[w+3];var S=_!=255,M=UPNG.encode.framize(e,i,s,a,n,o),R={},C=[],u=[];if(t!=0){for(var m=[],w=0;w<M.length;w++)m.push(M[w].img.buffer);var y=UPNG.encode.concatRGBA(m),v=UPNG.quantize(y,t);console.log(v);for(var T=0,k=new Uint8Array(v.abuf),w=0;w<M.length;w++){var L=M[w].img,A=L.length;u.push(new Uint8Array(v.inds.buffer,T>>2,A>>2));for(var f=0;f<A;f+=4)L[f]=k[T+f],L[f+1]=k[T+f+1],L[f+2]=k[T+f+2],L[f+3]=k[T+f+3];T+=A}for(var w=0;w<v.plte.length;w++)C.push(v.plte[w].est.rgba)}else for(var f=0;f<M.length;f++){var F=M[f],K=new Uint32Array(F.img.buffer),Q=F.rect.width,x=K.length,Z=new Uint8Array(x);u.push(Z);for(var w=0;w<x;w++){var B=K[w];if(w!=0&&B==K[w-1])Z[w]=Z[w-1];else if(w>Q&&B==K[w-Q])Z[w]=Z[w-Q];else{var z=R[B];if(z==null&&(R[B]=z=C.length,C.push(B),C.length>=300))break;Z[w]=z}}}var b=C.length;b<=256&&r==!1&&(b<=2?h=1:b<=4?h=2:b<=16?h=4:h=8,h=Math.max(h,l));for(var f=0;f<M.length;f++){var F=M[f];F.rect.x,F.rect.y;var Q=F.rect.width,N=F.rect.height,U=F.img;new Uint32Array(U.buffer);var q=4*Q,j=4;if(b<=256&&r==!1){q=Math.ceil(h*Q/8);for(var Y=new Uint8Array(q*N),J=u[f],se=0;se<N;se++){var w=se*q,pe=se*Q;if(h==8)for(var _e=0;_e<Q;_e++)Y[w+_e]=J[pe+_e];else if(h==4)for(var _e=0;_e<Q;_e++)Y[w+(_e>>1)]|=J[pe+_e]<<4-(_e&1)*4;else if(h==2)for(var _e=0;_e<Q;_e++)Y[w+(_e>>2)]|=J[pe+_e]<<6-(_e&3)*2;else if(h==1)for(var _e=0;_e<Q;_e++)Y[w+(_e>>3)]|=J[pe+_e]<<7-(_e&7)*1}U=Y,d=3,j=1}else if(S==!1&&M.length==1){for(var Y=new Uint8Array(Q*N*3),Ee=Q*N,w=0;w<Ee;w++){var L=w*3,X=w*4;Y[L]=U[X],Y[L+1]=U[X+1],Y[L+2]=U[X+2]}U=Y,d=2,j=3,q=3*Q}F.img=U,F.bpl=q,F.bpp=j}return{ctype:d,depth:h,plte:C,frames:M}};UPNG.encode.framize=function(e,i,s,t,c,a){for(var n=[],o=0;o<e.length;o++){var l=new Uint8Array(e[o]),r=new Uint32Array(l.buffer),d,h=0,_=0,f=i,g=s,x=t?1:0;if(o!=0){for(var w=a||t||o==1||n[o-2].dispose!=0?1:2,S=0,M=1e9,R=0;R<w;R++){for(var F=new Uint8Array(e[o-1-R]),C=new Uint32Array(e[o-1-R]),u=i,m=s,y=-1,v=-1,T=0;T<s;T++)for(var k=0;k<i;k++){var L=T*i+k;r[L]!=C[L]&&(k<u&&(u=k),k>y&&(y=k),T<m&&(m=T),T>v&&(v=T))}y==-1&&(u=m=y=v=0),c&&((u&1)==1&&u--,(m&1)==1&&m--);var A=(y-u+1)*(v-m+1);A<M&&(M=A,S=R,h=u,_=m,f=y-u+1,g=v-m+1)}var F=new Uint8Array(e[o-1-S]);S==1&&(n[o-1].dispose=2),d=new Uint8Array(f*g*4),UPNG._copyTile(F,i,s,d,f,g,-h,-_,0),x=UPNG._copyTile(l,i,s,d,f,g,-h,-_,3)?1:0,x==1?UPNG.encode._prepareDiff(l,i,s,d,{x:h,y:_,width:f,height:g}):UPNG._copyTile(l,i,s,d,f,g,-h,-_,0)}else d=l.slice(0);n.push({rect:{x:h,y:_,width:f,height:g},img:d,blend:x,dispose:0})}if(t)for(var o=0;o<n.length;o++){var K=n[o];if(K.blend!=1){var Q=K.rect,Z=n[o-1].rect,B=Math.min(Q.x,Z.x),z=Math.min(Q.y,Z.y),b=Math.max(Q.x+Q.width,Z.x+Z.width),N=Math.max(Q.y+Q.height,Z.y+Z.height),U={x:B,y:z,width:b-B,height:N-z};n[o-1].dispose=1,o-1!=0&&UPNG.encode._updateFrame(e,i,s,n,o-1,U,c),UPNG.encode._updateFrame(e,i,s,n,o,U,c)}}var q=0;if(e.length!=1)for(var L=0;L<n.length;L++){var K=n[L];q+=K.rect.width*K.rect.height}return n};UPNG.encode._updateFrame=function(e,i,s,t,c,a,n){for(var o=Uint8Array,l=Uint32Array,r=new o(e[c-1]),d=new l(e[c-1]),h=c+1<e.length?new o(e[c+1]):null,_=new o(e[c]),f=new l(_.buffer),g=i,x=s,w=-1,S=-1,M=0;M<a.height;M++)for(var R=0;R<a.width;R++){var C=a.x+R,u=a.y+M,m=u*i+C,y=f[m];y==0||t[c-1].dispose==0&&d[m]==y&&(h==null||h[m*4+3]!=0)||(C<g&&(g=C),C>w&&(w=C),u<x&&(x=u),u>S&&(S=u))}w==-1&&(g=x=w=S=0),n&&((g&1)==1&&g--,(x&1)==1&&x--),a={x:g,y:x,width:w-g+1,height:S-x+1};var v=t[c];v.rect=a,v.blend=1,v.img=new Uint8Array(a.width*a.height*4),t[c-1].dispose==0?(UPNG._copyTile(r,i,s,v.img,a.width,a.height,-a.x,-a.y,0),UPNG.encode._prepareDiff(_,i,s,v.img,a)):UPNG._copyTile(_,i,s,v.img,a.width,a.height,-a.x,-a.y,0)};UPNG.encode._prepareDiff=function(e,i,s,t,c){UPNG._copyTile(e,i,s,t,c.width,c.height,-c.x,-c.y,2)};UPNG.encode._filterZero=function(e,i,s,t,c,a,n){var o=[],l=[0,1,2,3,4];a!=-1?l=[a]:(i*t>5e5||s==1)&&(l=[0]);var r;n&&(r={level:0});for(var d=c.length>1e7&&typeof UZIP<"u"&&UZIP!=null?UZIP:pako,h=0;h<l.length;h++){for(var _=0;_<i;_++)UPNG.encode._filterLine(c,e,_,t,s,l[h]);o.push(d.deflate(c,r))}for(var f,g=1e9,h=0;h<o.length;h++)o[h].length<g&&(f=h,g=o[h].length);return o[f]};UPNG.encode._filterLine=function(e,i,s,t,c,a){var n=s*t,o=n+s,l=UPNG.decode._paeth;if(e[o]=a,o++,a==0)if(t<500)for(var r=0;r<t;r++)e[o+r]=i[n+r];else e.set(new Uint8Array(i.buffer,n,t),o);else if(a==1){for(var r=0;r<c;r++)e[o+r]=i[n+r];for(var r=c;r<t;r++)e[o+r]=i[n+r]-i[n+r-c]+256&255}else if(s==0){for(var r=0;r<c;r++)e[o+r]=i[n+r];if(a==2)for(var r=c;r<t;r++)e[o+r]=i[n+r];if(a==3)for(var r=c;r<t;r++)e[o+r]=i[n+r]-(i[n+r-c]>>1)+256&255;if(a==4)for(var r=c;r<t;r++)e[o+r]=i[n+r]-l(i[n+r-c],0,0)+256&255}else{if(a==2)for(var r=0;r<t;r++)e[o+r]=i[n+r]+256-i[n+r-t]&255;if(a==3){for(var r=0;r<c;r++)e[o+r]=i[n+r]+256-(i[n+r-t]>>1)&255;for(var r=c;r<t;r++)e[o+r]=i[n+r]+256-(i[n+r-t]+i[n+r-c]>>1)&255}if(a==4){for(var r=0;r<c;r++)e[o+r]=i[n+r]+256-l(0,i[n+r-t],0)&255;for(var r=c;r<t;r++)e[o+r]=i[n+r]+256-l(i[n+r-c],i[n+r-t],i[n+r-c-t])&255}}};UPNG.crc={table:function(){for(var e=new Uint32Array(256),i=0;i<256;i++){for(var s=i,t=0;t<8;t++)s&1?s=3988292384^s>>>1:s=s>>>1;e[i]=s}return e}(),update:function(e,i,s,t){for(var c=0;c<t;c++)e=UPNG.crc.table[(e^i[s+c])&255]^e>>>8;return e},crc:function(e,i,s){return UPNG.crc.update(4294967295,e,i,s)^4294967295}};UPNG.quantize=function(e,i){var s=new Uint8Array(e),t=s.slice(0),c=new Uint32Array(t.buffer),a=UPNG.quantize.getKDtree(t,i),n=a[0],o=a[1],l=UPNG.quantize.planeDst,r=s,d=c,h=r.length,_=new Uint8Array(s.length>>2),f;if(s.length<2e7)for(var g=0;g<h;g+=4){var x=r[g]*.00392156862745098,w=r[g+1]*(1/255),S=r[g+2]*(1/255),M=r[g+3]*(1/255);f=UPNG.quantize.getNearest(n,x,w,S,M),_[g>>2]=f.ind,d[g>>2]=f.est.rgba}else for(var g=0;g<h;g+=4){var x=r[g]*.00392156862745098,w=r[g+1]*(1/255),S=r[g+2]*(1/255),M=r[g+3]*(1/255);for(f=n;f.left;)f=l(f.est,x,w,S,M)<=0?f.left:f.right;_[g>>2]=f.ind,d[g>>2]=f.est.rgba}return{abuf:t.buffer,inds:_,plte:o}};UPNG.quantize.getKDtree=function(e,i,s){s==null&&(s=1e-4);var t=new Uint32Array(e.buffer),c={i0:0,i1:e.length,bst:null,est:null,tdst:0,left:null,right:null};c.bst=UPNG.quantize.stats(e,c.i0,c.i1),c.est=UPNG.quantize.estats(c.bst);for(var a=[c];a.length<i;){for(var n=0,o=0,l=0;l<a.length;l++)a[l].est.L>n&&(n=a[l].est.L,o=l);if(n<s)break;var r=a[o],d=UPNG.quantize.splitPixels(e,t,r.i0,r.i1,r.est.e,r.est.eMq255),h=r.i0>=d||r.i1<=d;if(h){r.est.L=0;continue}var _={i0:r.i0,i1:d,bst:null,est:null,tdst:0,left:null,right:null};_.bst=UPNG.quantize.stats(e,_.i0,_.i1),_.est=UPNG.quantize.estats(_.bst);var f={i0:d,i1:r.i1,bst:null,est:null,tdst:0,left:null,right:null};f.bst={R:[],m:[],N:r.bst.N-_.bst.N};for(var l=0;l<16;l++)f.bst.R[l]=r.bst.R[l]-_.bst.R[l];for(var l=0;l<4;l++)f.bst.m[l]=r.bst.m[l]-_.bst.m[l];f.est=UPNG.quantize.estats(f.bst),r.left=_,r.right=f,a[o]=_,a.push(f)}a.sort(function(g,x){return x.bst.N-g.bst.N});for(var l=0;l<a.length;l++)a[l].ind=l;return[c,a]};UPNG.quantize.getNearest=function(e,i,s,t,c){if(e.left==null)return e.tdst=UPNG.quantize.dist(e.est.q,i,s,t,c),e;var a=UPNG.quantize.planeDst(e.est,i,s,t,c),n=e.left,o=e.right;a>0&&(n=e.right,o=e.left);var l=UPNG.quantize.getNearest(n,i,s,t,c);if(l.tdst<=a*a)return l;var r=UPNG.quantize.getNearest(o,i,s,t,c);return r.tdst<l.tdst?r:l};UPNG.quantize.planeDst=function(e,i,s,t,c){var a=e.e;return a[0]*i+a[1]*s+a[2]*t+a[3]*c-e.eMq};UPNG.quantize.dist=function(e,i,s,t,c){var a=i-e[0],n=s-e[1],o=t-e[2],l=c-e[3];return a*a+n*n+o*o+l*l};UPNG.quantize.splitPixels=function(e,i,s,t,c,a){var n=UPNG.quantize.vecDot;for(t-=4;s<t;){for(;n(e,s,c)<=a;)s+=4;for(;n(e,t,c)>a;)t-=4;if(s>=t)break;var o=i[s>>2];i[s>>2]=i[t>>2],i[t>>2]=o,s+=4,t-=4}for(;n(e,s,c)>a;)s-=4;return s+4};UPNG.quantize.vecDot=function(e,i,s){return e[i]*s[0]+e[i+1]*s[1]+e[i+2]*s[2]+e[i+3]*s[3]};UPNG.quantize.stats=function(e,i,s){for(var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=[0,0,0,0],a=s-i>>2,n=i;n<s;n+=4){var o=e[n]*.00392156862745098,l=e[n+1]*(1/255),r=e[n+2]*(1/255),d=e[n+3]*(1/255);c[0]+=o,c[1]+=l,c[2]+=r,c[3]+=d,t[0]+=o*o,t[1]+=o*l,t[2]+=o*r,t[3]+=o*d,t[5]+=l*l,t[6]+=l*r,t[7]+=l*d,t[10]+=r*r,t[11]+=r*d,t[15]+=d*d}return t[4]=t[1],t[8]=t[2],t[9]=t[6],t[12]=t[3],t[13]=t[7],t[14]=t[11],{R:t,m:c,N:a}};UPNG.quantize.estats=function(e){var i=e.R,s=e.m,t=e.N,c=s[0],a=s[1],n=s[2],o=s[3],l=t==0?0:1/t,r=[i[0]-c*c*l,i[1]-c*a*l,i[2]-c*n*l,i[3]-c*o*l,i[4]-a*c*l,i[5]-a*a*l,i[6]-a*n*l,i[7]-a*o*l,i[8]-n*c*l,i[9]-n*a*l,i[10]-n*n*l,i[11]-n*o*l,i[12]-o*c*l,i[13]-o*a*l,i[14]-o*n*l,i[15]-o*o*l],d=r,h=UPNG.M4,_=[Math.random(),Math.random(),Math.random(),Math.random()],f=0,g=0;if(t!=0)for(var x=0;x<16&&(_=h.multVec(d,_),g=Math.sqrt(h.dot(_,_)),_=h.sml(1/g,_),!(x!=0&&Math.abs(g-f)<1e-9));x++)f=g;var w=[c*l,a*l,n*l,o*l],S=h.dot(h.sml(255,w),_);return{Cov:r,q:w,e:_,L:f,eMq255:S,eMq:h.dot(_,w),rgba:(Math.round(255*w[3])<<24|Math.round(255*w[2])<<16|Math.round(255*w[1])<<8|Math.round(255*w[0])<<0)>>>0}};UPNG.M4={multVec:function(e,i){return[e[0]*i[0]+e[1]*i[1]+e[2]*i[2]+e[3]*i[3],e[4]*i[0]+e[5]*i[1]+e[6]*i[2]+e[7]*i[3],e[8]*i[0]+e[9]*i[1]+e[10]*i[2]+e[11]*i[3],e[12]*i[0]+e[13]*i[1]+e[14]*i[2]+e[15]*i[3]]},dot:function(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]+e[3]*i[3]},sml:function(e,i){return[e*i[0],e*i[1],e*i[2],e*i[3]]}};UPNG.encode.concatRGBA=function(e){for(var i=0,s=0;s<e.length;s++)i+=e[s].byteLength;for(var t=new Uint8Array(i),c=0,s=0;s<e.length;s++){for(var a=new Uint8Array(e[s]),n=a.length,o=0;o<n;o+=4){var l=a[o],r=a[o+1],d=a[o+2],h=a[o+3];h==0&&(l=r=d=0),t[c+o]=l,t[c+o+1]=r,t[c+o+2]=d,t[c+o+3]=h}c+=n}return t.buffer};(function(){var e={};typeof module=="object"?module.exports=e:self.UTIF=e;var i=typeof require=="function"?require("pako"):self.pako;function s(){typeof process>"u"&&console.log.apply(console,arguments)}(function(t,c){(function(){var a=function(){function r(d){this.message="JPEG error: "+d}return r.prototype=new Error,r.prototype.name="JpegError",r.constructor=r,r}(),n=function(){var r=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),d=4017,h=799,_=3406,f=2276,g=1567,x=3784,w=5793,S=2896;function M(T){T==null&&(T={}),T.w==null&&(T.w=-1),this.V=T.n,this.N=T.w}function R(T,k){for(var L=0,A=[],F,K,Q=16,Z;Q>0&&!T[Q-1];)Q--;A.push({children:[],index:0});var B=A[0];for(F=0;F<Q;F++){for(K=0;K<T[F];K++){for(B=A.pop(),B.children[B.index]=k[L];B.index>0;)B=A.pop();for(B.index++,A.push(B);A.length<=F;)A.push(Z={children:[],index:0}),B.children[B.index]=Z.children,B=Z;L++}F+1<Q&&(A.push(Z={children:[],index:0}),B.children[B.index]=Z.children,B=Z)}return A[0].children}function C(T,k,L){return 64*((T.P+1)*k+L)}function u(T,k,L,A,F,K,Q,Z,B,z){z==null&&(z=!1);var b=L.m,N=L.Z,U=k,q=0,j=0,Y=0,J=0,se,pe=0,_e,Ee,X,D,te,re,oe=0,ve,ee,le,H;function I(){if(j>0)return j--,q>>j&1;if(q=T[k++],q===255){var qe=T[k++];if(qe){if(qe===220&&z){k+=2;var W=o(T,k);if(k+=2,W>0&&W!==L.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",W)}else if(qe===217){if(z){var ne=pe*8;if(ne>0&&ne<L.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",ne)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new a("unexpected marker")}}return j=7,q>>>7}function O(qe){for(var W=qe;;){switch(W=W[I()],typeof W){case"number":return W;case"object":continue}throw new a("invalid huffman sequence")}}function ae(qe){for(var W=0;qe>0;)W=W<<1|I(),qe--;return W}function me(qe){if(qe===1)return I()===1?1:-1;var W=ae(qe);return W>=1<<qe-1?W:W+(-1<<qe)+1}function Ae(qe,W){var ne=O(qe.J),ue=ne===0?0:me(ne),he=1;for(qe.D[W]=qe.Q+=ue;he<64;){var we=O(qe.i),Pe=we&15,ge=we>>4;if(Pe===0){if(ge<15)break;he+=16;continue}he+=ge;var be=r[he];qe.D[W+be]=me(Pe),he++}}function Se(qe,W){var ne=O(qe.J),ue=ne===0?0:me(ne)<<B;qe.D[W]=qe.Q+=ue}function Ge(qe,W){qe.D[W]|=I()<<B}function Xe(qe,W){if(Y>0){Y--;return}for(var ne=K,ue=Q;ne<=ue;){var he=O(qe.i),we=he&15,Pe=he>>4;if(we===0){if(Pe<15){Y=ae(Pe)+(1<<Pe)-1;break}ne+=16;continue}ne+=Pe;var ge=r[ne];qe.D[W+ge]=me(we)*(1<<B),ne++}}function Ue(qe,W){for(var ne=K,ue=Q,he=0,we,Pe;ne<=ue;){var ge=W+r[ne],be=qe.D[ge]<0?-1:1;switch(J){case 0:if(Pe=O(qe.i),we=Pe&15,he=Pe>>4,we===0)he<15?(Y=ae(he)+(1<<he),J=4):(he=16,J=1);else{if(we!==1)throw new a("invalid ACn encoding");se=me(we),J=he?2:3}continue;case 1:case 2:qe.D[ge]?qe.D[ge]+=be*(I()<<B):(he--,he===0&&(J=J===2?3:0));break;case 3:qe.D[ge]?qe.D[ge]+=be*(I()<<B):(qe.D[ge]=se<<B,J=0);break;case 4:qe.D[ge]&&(qe.D[ge]+=be*(I()<<B));break}ne++}J===4&&(Y--,Y===0&&(J=0))}function Ze(qe,W,ne,ue,he){var we=ne/b|0,Pe=ne%b;pe=we*qe.A+ue;var ge=Pe*qe.h+he,be=C(qe,pe,ge);W(qe,be)}function He(qe,W,ne){pe=ne/qe.P|0;var ue=ne%qe.P,he=C(qe,pe,ue);W(qe,he)}var Je=A.length;for(N?K===0?re=Z===0?Se:Ge:re=Z===0?Xe:Ue:re=Ae,Je===1?ee=A[0].P*A[0].c:ee=b*L.R;oe<=ee;){var nt=F?Math.min(ee-oe,F):ee;if(nt>0){for(Ee=0;Ee<Je;Ee++)A[Ee].Q=0;if(Y=0,Je===1)for(_e=A[0],te=0;te<nt;te++)He(_e,re,oe),oe++;else for(te=0;te<nt;te++){for(Ee=0;Ee<Je;Ee++)for(_e=A[Ee],le=_e.h,H=_e.A,X=0;X<H;X++)for(D=0;D<le;D++)Ze(_e,re,oe,X,D);oe++}}if(j=0,ve=v(T,k),!ve)break;if(ve.u&&(k=ve.offset),ve.M>=65488&&ve.M<=65495)k+=2;else break}return k-U}function m(T,k,L){var A=T.$,F=T.D,K,Q,Z,B,z,b,N,U,q,j,Y,J,se,pe,_e,Ee,X;if(!A)throw new a("missing required Quantization Table.");for(var D=0;D<64;D+=8){if(q=F[k+D],j=F[k+D+1],Y=F[k+D+2],J=F[k+D+3],se=F[k+D+4],pe=F[k+D+5],_e=F[k+D+6],Ee=F[k+D+7],q*=A[D],!(j|Y|J|se|pe|_e|Ee)){X=w*q+512>>10,L[D]=X,L[D+1]=X,L[D+2]=X,L[D+3]=X,L[D+4]=X,L[D+5]=X,L[D+6]=X,L[D+7]=X;continue}j*=A[D+1],Y*=A[D+2],J*=A[D+3],se*=A[D+4],pe*=A[D+5],_e*=A[D+6],Ee*=A[D+7],K=w*q+128>>8,Q=w*se+128>>8,Z=Y,B=_e,z=S*(j-Ee)+128>>8,U=S*(j+Ee)+128>>8,b=J<<4,N=pe<<4,K=K+Q+1>>1,Q=K-Q,X=Z*x+B*g+128>>8,Z=Z*g-B*x+128>>8,B=X,z=z+N+1>>1,N=z-N,U=U+b+1>>1,b=U-b,K=K+B+1>>1,B=K-B,Q=Q+Z+1>>1,Z=Q-Z,X=z*f+U*_+2048>>12,z=z*_-U*f+2048>>12,U=X,X=b*h+N*d+2048>>12,b=b*d-N*h+2048>>12,N=X,L[D]=K+U,L[D+7]=K-U,L[D+1]=Q+N,L[D+6]=Q-N,L[D+2]=Z+b,L[D+5]=Z-b,L[D+3]=B+z,L[D+4]=B-z}for(var te=0;te<8;++te){if(q=L[te],j=L[te+8],Y=L[te+16],J=L[te+24],se=L[te+32],pe=L[te+40],_e=L[te+48],Ee=L[te+56],!(j|Y|J|se|pe|_e|Ee)){X=w*q+8192>>14,X<-2040?X=0:X>=2024?X=255:X=X+2056>>4,F[k+te]=X,F[k+te+8]=X,F[k+te+16]=X,F[k+te+24]=X,F[k+te+32]=X,F[k+te+40]=X,F[k+te+48]=X,F[k+te+56]=X;continue}K=w*q+2048>>12,Q=w*se+2048>>12,Z=Y,B=_e,z=S*(j-Ee)+2048>>12,U=S*(j+Ee)+2048>>12,b=J,N=pe,K=(K+Q+1>>1)+4112,Q=K-Q,X=Z*x+B*g+2048>>12,Z=Z*g-B*x+2048>>12,B=X,z=z+N+1>>1,N=z-N,U=U+b+1>>1,b=U-b,K=K+B+1>>1,B=K-B,Q=Q+Z+1>>1,Z=Q-Z,X=z*f+U*_+2048>>12,z=z*_-U*f+2048>>12,U=X,X=b*h+N*d+2048>>12,b=b*d-N*h+2048>>12,N=X,q=K+U,Ee=K-U,j=Q+N,_e=Q-N,Y=Z+b,pe=Z-b,J=B+z,se=B-z,q<16?q=0:q>=4080?q=255:q>>=4,j<16?j=0:j>=4080?j=255:j>>=4,Y<16?Y=0:Y>=4080?Y=255:Y>>=4,J<16?J=0:J>=4080?J=255:J>>=4,se<16?se=0:se>=4080?se=255:se>>=4,pe<16?pe=0:pe>=4080?pe=255:pe>>=4,_e<16?_e=0:_e>=4080?_e=255:_e>>=4,Ee<16?Ee=0:Ee>=4080?Ee=255:Ee>>=4,F[k+te]=q,F[k+te+8]=j,F[k+te+16]=Y,F[k+te+24]=J,F[k+te+32]=se,F[k+te+40]=pe,F[k+te+48]=_e,F[k+te+56]=Ee}}function y(T,k){for(var L=k.P,A=k.c,F=new Int16Array(64),K=0;K<A;K++)for(var Q=0;Q<L;Q++){var Z=C(k,K,Q);m(k,Z,F)}return k.D}function v(T,k,L){L==null&&(L=k);var A=T.length-1,F=L<k?L:k;if(k>=A)return null;var K=o(T,k);if(K>=65472&&K<=65534)return{u:null,M:K,offset:k};for(var Q=o(T,F);!(Q>=65472&&Q<=65534);){if(++F>=A)return null;Q=o(T,F)}return{u:K.toString(16),M:Q,offset:F}}return M.prototype={parse(T,k){k==null&&(k={});var L=k.F,A=0,F=null,K=null,Q,Z,B=0;function z(){var ge=o(T,A);A+=2;var be=A+ge-2,Ce=v(T,be,A);Ce&&Ce.u&&(be=Ce.offset);var Fe=T.subarray(A,be);return A+=Fe.length,Fe}function b(ge){for(var be=Math.ceil(ge.o/8/ge.X),Ce=Math.ceil(ge.s/8/ge.B),Fe=0;Fe<ge.W.length;Fe++){Ue=ge.W[Fe];var Ve=Math.ceil(Math.ceil(ge.o/8)*Ue.h/ge.X),Ye=Math.ceil(Math.ceil(ge.s/8)*Ue.A/ge.B),We=be*Ue.h,Ie=Ce*Ue.A,Oe=64*Ie*(We+1);Ue.D=new Int16Array(Oe),Ue.P=Ve,Ue.c=Ye}ge.m=be,ge.R=Ce}var N=[],U=[],q=[],j=o(T,A);if(A+=2,j!==65496)throw new a("SOI not found");j=o(T,A),A+=2;e:for(;j!==65497;){var Y,J,se;switch(j){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var pe=z();j===65504&&pe[0]===74&&pe[1]===70&&pe[2]===73&&pe[3]===70&&pe[4]===0&&(F={version:{d:pe[5],T:pe[6]},K:pe[7],j:pe[8]<<8|pe[9],H:pe[10]<<8|pe[11],S:pe[12],I:pe[13],C:pe.subarray(14,14+3*pe[12]*pe[13])}),j===65518&&pe[0]===65&&pe[1]===100&&pe[2]===111&&pe[3]===98&&pe[4]===101&&(K={version:pe[5]<<8|pe[6],k:pe[7]<<8|pe[8],q:pe[9]<<8|pe[10],a:pe[11]});break;case 65499:var _e=o(T,A),Ee;A+=2;for(var X=_e+A-2;A<X;){var D=T[A++],te=new Uint16Array(64);if(D>>4)if(D>>4===1)for(J=0;J<64;J++)Ee=r[J],te[Ee]=o(T,A),A+=2;else throw new a("DQT - invalid table spec");else for(J=0;J<64;J++)Ee=r[J],te[Ee]=T[A++];N[D&15]=te}break;case 65472:case 65473:case 65474:if(Q)throw new a("Only single frame JPEGs supported");A+=2,Q={},Q.G=j===65473,Q.Z=j===65474,Q.precision=T[A++];var re=o(T,A),oe,ve=0,ee=0;A+=2,Q.s=L||re,Q.o=o(T,A),A+=2,Q.W=[],Q._={};var le=T[A++];for(Y=0;Y<le;Y++){oe=T[A];var H=T[A+1]>>4,I=T[A+1]&15;ve<H&&(ve=H),ee<I&&(ee=I);var O=T[A+2];se=Q.W.push({h:H,A:I,L:O,$:null}),Q._[oe]=se-1,A+=3}Q.X=ve,Q.B=ee,b(Q);break;case 65476:var ae=o(T,A);for(A+=2,Y=2;Y<ae;){var me=T[A++],Ae=new Uint8Array(16),Se=0;for(J=0;J<16;J++,A++)Se+=Ae[J]=T[A];var Ge=new Uint8Array(Se);for(J=0;J<Se;J++,A++)Ge[J]=T[A];Y+=17+Se,(me>>4?U:q)[me&15]=R(Ae,Ge)}break;case 65501:A+=2,Z=o(T,A),A+=2;break;case 65498:var Xe=++B===1&&!L,Ue;A+=2;var Ze=T[A++],He=[];for(Y=0;Y<Ze;Y++){var Je=T[A++],nt=Q._[Je];Ue=Q.W[nt],Ue.index=Je;var qe=T[A++];Ue.J=q[qe>>4],Ue.i=U[qe&15],He.push(Ue)}var W=T[A++],ne=T[A++],ue=T[A++];try{var he=u(T,A,Q,He,Z,W,ne,ue>>4,ue&15,Xe);A+=he}catch(ge){if(ge instanceof DNLMarkerError)return this.parse(T,{F:ge.s});if(ge instanceof EOIMarkerError)break e;throw ge}break;case 65500:A+=4;break;case 65535:T[A]!==255&&A--;break;default:var we=v(T,A-2,A-3);if(we&&we.u){A=we.offset;break}if(A>=T.length-1)break e;throw new a("JpegImage.parse - unknown marker: "+j.toString(16))}j=o(T,A),A+=2}for(this.width=Q.o,this.height=Q.s,this.g=F,this.b=K,this.W=[],Y=0;Y<Q.W.length;Y++){Ue=Q.W[Y];var Pe=N[Ue.L];Pe&&(Ue.$=Pe),this.W.push({index:Ue.index,e:y(Q,Ue),l:Ue.h/Q.X,t:Ue.A/Q.B,P:Ue.P,c:Ue.c})}this.p=this.W.length},Y(T,k,L){L==null&&(L=!1);var A=this.width/T,F=this.height/k,K,Q,Z,B,z,b,N,U,q,j,Y=0,J,se=this.W.length,pe=T*k*se,_e=new Uint8ClampedArray(pe),Ee=new Uint32Array(T),X=4294967288,D;for(N=0;N<se;N++){if(K=this.W[N],Q=K.l*A,Z=K.t*F,Y=N,J=K.e,B=K.P+1<<3,Q!==D){for(z=0;z<T;z++)U=0|z*Q,Ee[z]=(U&X)<<3|U&7;D=Q}for(b=0;b<k;b++)for(U=0|b*Z,j=B*(U&X)|(U&7)<<3,z=0;z<T;z++)_e[Y]=J[j+Ee[z]],Y+=se}var te=this.V;if(!L&&se===4&&!te&&(te=new Int32Array([-256,255,-256,255,-256,255,-256,255])),te)for(N=0;N<pe;)for(U=0,q=0;U<se;U++,N++,q+=2)_e[N]=(_e[N]*te[q]>>8)+te[q+1];return _e},get f(){return this.b?!!this.b.a:this.p===3?this.N===0?!1:!(this.W[0].index===82&&this.W[1].index===71&&this.W[2].index===66):this.N===1},z:function(k){for(var L,A,F,K=0,Q=k.length;K<Q;K+=3)L=k[K],A=k[K+1],F=k[K+2],k[K]=L-179.456+1.402*F,k[K+1]=L+135.459-.344*A-.714*F,k[K+2]=L-226.816+1.772*A;return k},O:function(k){for(var L,A,F,K,Q=0,Z=0,B=k.length;Z<B;Z+=4)L=k[Z],A=k[Z+1],F=k[Z+2],K=k[Z+3],k[Q++]=-122.67195406894+A*(-660635669420364e-19*A+.000437130475926232*F-54080610064599e-18*L+.00048449797120281*K-.154362151871126)+F*(-.000957964378445773*F+.000817076911346625*L-.00477271405408747*K+1.53380253221734)+L*(.000961250184130688*L-.00266257332283933*K+.48357088451265)+K*(-.000336197177618394*K+.484791561490776),k[Q++]=107.268039397724+A*(219927104525741e-19*A-.000640992018297945*F+.000659397001245577*L+.000426105652938837*K-.176491792462875)+F*(-.000778269941513683*F+.00130872261408275*L+.000770482631801132*K-.151051492775562)+L*(.00126935368114843*L-.00265090189010898*K+.25802910206845)+K*(-.000318913117588328*K-.213742400323665),k[Q++]=-20.810012546947+A*(-.000570115196973677*A-263409051004589e-19*F+.0020741088115012*L-.00288260236853442*K+.814272968359295)+F*(-153496057440975e-19*F-.000132689043961446*L+.000560833691242812*K-.195152027534049)+L*(.00174418132927582*L-.00255243321439347*K+.116935020465145)+K*(-.000343531996510555*K+.24165260232407);return k.subarray(0,Q)},r:function(k){for(var L,A,F,K=0,Q=k.length;K<Q;K+=4)L=k[K],A=k[K+1],F=k[K+2],k[K]=434.456-L-1.402*F,k[K+1]=119.541-L+.344*A+.714*F,k[K+2]=481.816-L-1.772*A;return k},U:function(k){for(var L,A,F,K,Q=0,Z=0,B=k.length;Z<B;Z+=4)L=k[Z],A=k[Z+1],F=k[Z+2],K=k[Z+3],k[Q++]=255+L*(-6747147073602441e-20*L+.0008379262121013727*A+.0002894718188643294*F+.003264231057537806*K-1.1185611867203937)+A*(26374107616089405e-21*A-8626949158638572e-20*F-.0002748769067499491*K-.02155688794978967)+F*(-3878099212869363e-20*F-.0003267808279485286*K+.0686742238595345)-K*(.0003361971776183937*K+.7430659151342254),k[Q++]=255+L*(.00013596372813588848*L+.000924537132573585*A+.00010567359618683593*F+.0004791864687436512*K-.3109689587515875)+A*(-.00023545346108370344*A+.0002702845253534714*F+.0020200308977307156*K-.7488052167015494)+F*(6834815998235662e-20*F+.00015168452363460973*K-.09751927774728933)-K*(.0003189131175883281*K+.7364883807733168),k[Q++]=255+L*(13598650411385307e-21*L+.00012423956175490851*A+.0004751985097583589*F-36729317476630422e-22*K-.05562186980264034)+A*(.00016141380598724676*A+.0009692239130725186*F+.0007782692450036253*K-.44015232367526463)+F*(5068882914068769e-22*F+.0017778369011375071*K-.7591454649749609)-K*(.0003435319965105553*K+.7063770186160144);return k.subarray(0,Q)},getData:function(T){var k=T.width,L=T.height,A=T.forceRGB,F=T.isSourcePDF;if(this.p>4)throw new a("Unsupported color mode");var K=this.Y(k,L,F);if(this.p===1&&A){for(var Q=K.length,Z=new Uint8ClampedArray(Q*3),B=0,z=0;z<Q;z++){var b=K[z];Z[B++]=b,Z[B++]=b,Z[B++]=b}return Z}else{if(this.p===3&&this.f)return this.z(K);if(this.p===4){if(this.f)return A?this.O(K):this.r(K);if(A)return this.U(K)}}return K}},M}();function o(l,r){return l[r]<<8|l[r+1]}t.JpegDecoder=n})(),t.encodeImage=function(a,n,o,l){var r={t256:[n],t257:[o],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[o],t279:[n*o*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(l)for(var d in l)r[d]=l[d];for(var h=new Uint8Array(t.encode([r])),_=new Uint8Array(a),f=new Uint8Array(1e3+n*o*4),d=0;d<h.length;d++)f[d]=h[d];for(var d=0;d<_.length;d++)f[1e3+d]=_[d];return f.buffer},t.encode=function(a){var n=new Uint8Array(2e4),o=4,l=t._binBE;n[0]=n[1]=77,l.writeUshort(n,2,42);var r=8;l.writeUint(n,o,r),o+=4;for(var d=0;d<a.length;d++){var h=t._writeIFD(l,t._types.basic,n,r,a[d]);r=h[1],d<a.length-1&&(r&3&&(r+=4-(r&3)),l.writeUint(n,h[0],r))}return n.slice(0,r).buffer},t.decode=function(a,n){n==null&&(n={parseMN:!0,debug:!1});var o=new Uint8Array(a),l=0,r=t._binBE.readASCII(o,l,2);l+=2;var d=r=="II"?t._binLE:t._binBE;d.readUshort(o,l),l+=2;var h=d.readUint(o,l);l+=4;for(var _=[];;){var f=d.readUshort(o,h),g=d.readUshort(o,h+4);if(f!=0&&(g<1||13<g)){s("error in TIFF");break}if(t._readIFD(d,o,h,_,0,n),h=d.readUint(o,h+2+f*12),h==0)break}return _},t.decodeImage=function(a,n,o){if(!n.data){var l=new Uint8Array(a),r=t._binBE.readASCII(l,0,2);if(n.t256!=null){n.isLE=r=="II",n.width=n.t256[0],n.height=n.t257[0];var d=n.t259?n.t259[0]:1,h=n.t266?n.t266[0]:1;n.t284&&n.t284[0]==2&&s("PlanarConfiguration 2 should not be used!");var _;n.t258?_=Math.min(32,n.t258[0])*n.t258.length:_=n.t277?n.t277[0]:1,d==1&&n.t279!=null&&n.t278&&n.t262[0]==32803&&(_=Math.round(n.t279[0]*8/(n.width*n.t278[0])));var f=Math.ceil(n.width*_/8)*8,g=n.t273;g==null&&(g=n.t324);var x=n.t279;d==1&&g.length==1&&(x=[n.height*(f>>>3)]),x==null&&(x=n.t325);var w=new Uint8Array(n.height*(f>>>3)),S=0;if(n.t322!=null){for(var M=n.t322[0],R=n.t323[0],C=Math.floor((n.width+M-1)/M),u=Math.floor((n.height+R-1)/R),m=new Uint8Array(Math.ceil(M*R*_/8)|0),y=0;y<u;y++)for(var v=0;v<C;v++){for(var T=y*C+v,k=0;k<m.length;k++)m[k]=0;t.decode._decompress(n,o,l,g[T],x[T],d,m,0,h),d==6?w=m:t._copyTile(m,Math.ceil(M*_/8)|0,R,w,Math.ceil(n.width*_/8)|0,n.height,Math.ceil(v*M*_/8)|0,y*R)}S=w.length*8}else{var L=n.t278?n.t278[0]:n.height;L=Math.min(L,n.height);for(var T=0;T<g.length;T++)t.decode._decompress(n,o,l,g[T],x[T],d,w,Math.ceil(S/8)|0,h),S+=f*L;S=Math.min(S,w.length*8)}n.data=new Uint8Array(w.buffer,0,Math.ceil(S/8)|0)}}},t.decode._decompress=function(a,n,o,l,r,d,h,_,f){if(d==1)for(var g=0;g<r;g++)h[_+g]=o[l+g];else if(d==3)t.decode._decodeG3(o,l,r,h,_,a.width,f,a.t292?(a.t292[0]&1)==1:!1);else if(d==4)t.decode._decodeG4(o,l,r,h,_,a.width,f);else if(d==5)t.decode._decodeLZW(o,l,r,h,_,8);else if(d==6)t.decode._decodeOldJPEG(a,o,l,r,h,_);else if(d==7||d==34892)t.decode._decodeNewJPEG(a,o,l,r,h,_);else if(d==8||d==32946)for(var x=new Uint8Array(o.buffer,l,r),w=c.inflate(x),S=0;S<w.length;S++)h[_+S]=w[S];else d==9?t.decode._decodeVC5(o,l,r,h,_):d==32767?t.decode._decodeARW(a,o,l,r,h,_):d==32773?t.decode._decodePackBits(o,l,r,h,_):d==32809?t.decode._decodeThunder(o,l,r,h,_):d==34713?t.decode._decodeNikon(a,n,o,l,r,h,_):s("Unknown compression",d);var M=a.t258?Math.min(32,a.t258[0]):1,R=a.t277?a.t277[0]:1,C=M*R>>>3,u=a.t278?a.t278[0]:a.height,m=Math.ceil(M*R*a.width/8);if(M==16&&!a.isLE&&a.t33422==null)for(var y=0;y<u;y++)for(var v=_+y*m,T=1;T<m;T+=2){var k=h[v+T];h[v+T]=h[v+T-1],h[v+T-1]=k}if(a.t317&&a.t317[0]==2)for(var y=0;y<u;y++){var L=_+y*m;if(M==16)for(var g=C;g<m;g+=2){var A=(h[L+g+1]<<8|h[L+g])+(h[L+g-C+1]<<8|h[L+g-C]);h[L+g]=A&255,h[L+g+1]=A>>>8&255}else if(R==3)for(var g=3;g<m;g+=3)h[L+g]=h[L+g]+h[L+g-3]&255,h[L+g+1]=h[L+g+1]+h[L+g-2]&255,h[L+g+2]=h[L+g+2]+h[L+g-1]&255;else for(var g=C;g<m;g++)h[L+g]=h[L+g]+h[L+g-C]&255}},t.decode._decodeVC5=t.decode._decodeVC5=function(){var a=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],n,o,l,r=[3,3,3,3,2,2,2,1,1,1],d=24576,h=16384,_=8192,f=h|_;function g(y){var v=y[1],T=y[0][v>>>3]>>>7-(v&7)&1;return y[1]++,T}function x(y,v){if(n==null){n={};for(var T=0;T<a.length;T+=4)n[a[T+1]]=a.slice(T,T+4)}for(var k=g(y),L=n[k];L==null;)k=k<<1|g(y),L=n[k];var A=L[3];A!=0&&(A=g(y)==0?A:-A),v[0]=L[2],v[1]=A}function w(y,v){for(var T=0;T<v;T++)(y&1)==1&&y++,y=y>>>1;return y}function S(y,v){return y>>v}function M(y,v,T,k,L,A){v[T]=S(S(11*y[L]-4*y[L+A]+y[L+A+A]+4,3)+y[k],1),v[T+A]=S(S(5*y[L]+4*y[L+A]-y[L+A+A]+4,3)-y[k],1)}function R(y,v,T,k,L,A){var F=y[L-A]-y[L+A],K=y[L],Q=y[k];v[T]=S(S(F+4,3)+K+Q,1),v[T+A]=S(S(-F+4,3)+K-Q,1)}function C(y,v,T,k,L,A){v[T]=S(S(5*y[L]+4*y[L-A]-y[L-A-A]+4,3)+y[k],1),v[T+A]=S(S(11*y[L]-4*y[L-A]+y[L-A-A]+4,3)-y[k],1)}function u(y){return y=y<0?0:y>4095?4095:y,y=l[y]>>>2,y}function m(y,v,T,k,L){k=new Uint16Array(k.buffer);var A=Date.now(),F=t._binBE,K=v+T,Q,Z,B,z,b,N,U,q,j,Y;for(v+=4;v<K;){var J=F.readShort(y,v),se=F.readUshort(y,v+2);if(v+=4,J==12)Q=se;else if(J==20)Z=se;else if(J==21)B=se;else if(J==48)z=se;else if(J==53)b=se;else if(J!=35){if(J==62)N=se;else if(J!=101){if(J==109)U=se;else if(J!=84){if(J!=106){if(J!=107){if(J!=108){if(J!=102){if(J==104)q=se;else if(J!=105){var pe=J<0?-J:J,_e=pe&65280,Ee=0;if(pe&f&&(pe&_?(Ee=se&65535,Ee+=(pe&255)<<16):Ee=se&65535),(pe&d)==d){if(j==null){j=[];for(var X=0;X<4;X++)j[X]=new Int16Array((Z>>>1)*(B>>>1));Y=new Int16Array((Z>>>1)*(B>>>1)),o=new Int16Array(1024);for(var X=0;X<1024;X++){var D=X-512,te=Math.abs(D),Q=Math.floor(768*te*te*te/(255*255*255))+te;o[X]=Math.sign(D)*Q}l=new Uint16Array(4096);for(var re=65535,X=0;X<4096;X++){var oe=X,ve=re*(Math.pow(113,oe/4095)-1)/112;l[X]=Math.min(ve,re)}}var ee=j[N],le=w(Z,1+r[z]),H=w(B,1+r[z]);if(z==0)for(var I=0;I<H;I++)for(var O=0;O<le;O++){var ae=v+(I*le+O)*2;ee[I*(Z>>>1)+O]=y[ae]<<8|y[ae+1]}else{for(var me=[y,v*8],Ae=[],Se=0,Ge=le*H,Xe=[0,0],Ue=0,se=0;Se<Ge;)for(x(me,Xe),Ue=Xe[0],se=Xe[1];Ue>0;)Ae[Se++]=se,Ue--;for(var Ze=(z-1)%3,He=Ze!=1?le:0,Je=Ze!=0?H:0,I=0;I<H;I++)for(var nt=(I+Je)*(Z>>>1)+He,qe=I*le,O=0;O<le;O++)ee[nt+O]=o[Ae[qe+O]+512]*b;if(Ze==2){for(var q=Z>>>1,W=le*2,ne=H*2,I=0;I<H;I++)for(var O=0;O<W;O++){var X=I*2*q+O,ue=I*q+O,he=H*q+ue;I==0?M(ee,Y,X,he,ue,q):I==H-1?C(ee,Y,X,he,ue,q):R(ee,Y,X,he,ue,q)}var we=ee;ee=Y,Y=we;for(var I=0;I<ne;I++)for(var O=0;O<le;O++){var X=I*q+2*O,ue=I*q+O,he=le+ue;O==0?M(ee,Y,X,he,ue,1):O==le-1?C(ee,Y,X,he,ue,1):R(ee,Y,X,he,ue,1)}var we=ee;ee=Y,Y=we;for(var Pe=[],ge=2-~~((z-1)/3),be=0;be<3;be++)Pe[be]=U>>14-be*2&3;var Ce=Pe[ge];if(Ce!=0)for(var I=0;I<ne;I++)for(var O=0;O<W;O++){var X=I*q+O;ee[X]=ee[X]<<Ce}}}if(z==9&&N==3)for(var Fe=j[0],Ve=j[1],Ye=j[2],We=j[3],I=0;I<B;I+=2)for(var O=0;O<Z;O+=2){var Ie=I*Z+O,ae=(I>>>1)*(Z>>>1)+(O>>>1),Oe=Fe[ae],it=Ve[ae]-2048,at=Ye[ae]-2048,ht=We[ae]-2048,St=(it<<1)+Oe,Qt=(at<<1)+Oe,ln=Oe+ht,wt=Oe-ht;k[Ie]=u(St),k[Ie+1]=u(ln),k[Ie+Z]=u(wt),k[Ie+Z+1]=u(Qt)}v+=Ee*4}else if(pe==16388)v+=Ee*4;else if(!(_e==8192||_e==8448||_e==9216))throw pe.toString(16)}}}}}}}}}console.log(Date.now()-A)}return m}(),t.decode._ljpeg_diff=function(a,n,o){var l=t.decode._getbithuff,r,d;return r=l(a,n,o[0],o),d=l(a,n,r,0),d&1<<r-1||(d-=(1<<r)-1),d},t.decode._decodeARW=function(a,n,o,l,r,d){var h=a.t256[0],_=a.t257[0],f=a.t258[0],g=a.isLE?t._binLE:t._binBE,x=h*_==l||h*_*1.5==l;if(!x){_+=8;var w=[o,0,0,0],S=new Uint16Array(32770),M=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],q,R,C,K,F,u=0,m=t.decode._ljpeg_diff;for(S[0]=15,C=q=0;q<18;q++)for(var y=32768>>>(M[q]>>>8),R=0;R<y;R++)S[++C]=M[q];for(K=h;K--;)for(F=0;F<_+1;F+=2)if(F==_&&(F=1),u+=m(n,w,S),F<_){var v=u&4095;t.decode._putsF(r,(F*h+K)*f,v<<16-f)}return}if(h*_*1.5==l){for(var q=0;q<l;q+=3){var T=n[o+q+0],k=n[o+q+1],L=n[o+q+2];r[d+q]=k<<4|T>>>4,r[d+q+1]=T<<4|L>>>4,r[d+q+2]=L<<4|k>>>4}return}var A=new Uint16Array(16),F,K,Q,Z,B,z,b,N,U,q,j,Y=new Uint8Array(h+1);for(F=0;F<_;F++){for(var J=0;J<h;J++)Y[J]=n[o++];for(j=0,K=0;K<h-30;j+=16){for(Z=2047&(Q=g.readUint(Y,j)),B=2047&Q>>>11,z=15&Q>>>22,b=15&Q>>>26,N=0;N<4&&128<<N<=Z-B;N++);for(U=30,q=0;q<16;q++)q==z?A[q]=Z:q==b?A[q]=B:(A[q]=((g.readUshort(Y,j+(U>>3))>>>(U&7)&127)<<N)+B,A[q]>2047&&(A[q]=2047),U+=7);for(q=0;q<16;q++,K+=2){var v=A[q]<<1;t.decode._putsF(r,(F*h+K)*f,v<<16-f)}K-=K&1?1:31}}},t.decode._decodeNikon=function(a,n,o,l,r,d,h){var _=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],f=a.t256[0],g=a.t257[0],x=a.t258[0],w=0,S=0,M=t.decode._make_decoder,R=t.decode._getbithuff,C=n[0].exifIFD.makerNote,u=C.t150?C.t150:C.t140,m=0,y=u[m++],v=u[m++];(y==73||v==88)&&(m+=2110),y==70&&(w=2),x==14&&(w+=3);for(var T=[[0,0],[0,0]],k=a.isLE?t._binLE:t._binBE,Q=0;Q<2;Q++)for(var L=0;L<2;L++)T[Q][L]=k.readShort(u,m),m+=2;var A=1<<x&32767,F=0,K=k.readShort(u,m);m+=2,K>1&&(F=Math.floor(A/(K-1))),y==68&&v==32&&F>0&&(S=k.readShort(u,562));var Q,Z,B,z,b,N,U=[0,0],q=M(_[w]),j=[l,0,0,0];for(Z=0;Z<g;Z++)for(S&&Z==S&&(q=M(_[w+1])),B=0;B<f;B++){Q=R(o,j,q[0],q),z=Q&15,b=Q>>>4,N=(R(o,j,z-b,0)<<1)+1<<b>>>1,N&1<<z-1||(N-=(1<<z)-(b==0?1:0)),B<2?U[B]=T[Z&1][B]+=N:U[B&1]+=N;var Y=Math.min(Math.max(U[B&1],0),(1<<x)-1),J=(Z*f+B)*x;t.decode._putsF(d,J,Y<<16-x)}},t.decode._putsF=function(a,n,o){o=o<<8-(n&7);var l=n>>>3;a[l]|=o>>>16,a[l+1]|=o>>>8,a[l+2]|=o},t.decode._getbithuff=function(a,n,o,l){var r=0;t.decode._get_byte;var d,h=n[0],_=n[1],f=n[2],g=n[3];if(o==0||f<0)return 0;for(;!g&&f<o&&(d=a[h++])!=-1&&!(g=r);)_=(_<<8)+d,f+=8;if(d=_<<32-f>>>32-o,l?(f-=l[d+1]>>>8,d=l[d+1]&255):f-=o,f<0)throw"e";return n[0]=h,n[1]=_,n[2]=f,n[3]=g,d},t.decode._make_decoder=function(a){var n,o,l,r,d,h=[];for(n=16;n!=0&&!a[n];n--);var _=17;for(h[0]=n,l=o=1;o<=n;o++)for(r=0;r<a[o];r++,++_)for(d=0;d<1<<n-o;d++)l<=1<<n&&(h[l++]=o<<8|a[_]);return h},t.decode._decodeNewJPEG=function(a,n,o,l,r,d){l=Math.min(l,n.length-o);var h=a.t347,_=h?h.length:0,f=new Uint8Array(_+l);if(h){for(var g=216,x=217,w=0,S=0;S<_-1&&!(h[S]==255&&h[S+1]==x);S++)f[w++]=h[S];var M=n[o],R=n[o+1];(M!=255||R!=g)&&(f[w++]=M,f[w++]=R);for(var S=2;S<l;S++)f[w++]=n[o+S]}else for(var S=0;S<l;S++)f[S]=n[o+S];if(a.t262[0]==32803||a.t259[0]==7&&a.t262[0]==34892){var C=a.t258[0],u=t.LosslessJpegDecode(f),m=u.length;if(C==16)if(a.isLE)for(var S=0;S<m;S++)r[d+(S<<1)]=u[S]&255,r[d+(S<<1)+1]=u[S]>>>8;else for(var S=0;S<m;S++)r[d+(S<<1)]=u[S]>>>8,r[d+(S<<1)+1]=u[S]&255;else if(C==14||C==12)for(var y=16-C,S=0;S<m;S++)t.decode._putsF(r,S*C,u[S]<<y);else if(C==8)for(var S=0;S<m;S++)r[d+S]=u[S];else throw new Error("unsupported bit depth "+C)}else{var v=new t.JpegDecoder;v.parse(f);for(var T=v.getData({width:v.width,height:v.height,forceRGB:!0,isSourcePDF:!1}),S=0;S<T.length;S++)r[d+S]=T[S]}a.t262[0]==6&&(a.t262[0]=2)},t.decode._decodeOldJPEGInit=function(a,n,o,l){var r=216,d=219,h=196,_=221,f=192,g=218,x=0,w=0,S,M,R=!1,C,u,m,y=a.t513,v=y?y[0]:0,T=a.t514,k=T?T[0]:0,L=a.t324||a.t273||y,A=a.t530,F=0,K=0,Q=a.t277?a.t277[0]:1,Z=a.t515;if(L&&(w=L[0],R=L.length>1),!R){if(n[o]==255&&n[o+1]==r)return{jpegOffset:o};if(y!=null&&(n[o+v]==255&&n[o+v+1]==r?x=o+v:s("JPEGInterchangeFormat does not point to SOI"),T==null?s("JPEGInterchangeFormatLength field is missing"):(v>=w||v+k<=w)&&s("JPEGInterchangeFormatLength field value is invalid"),x!=null))return{jpegOffset:x}}if(A!=null&&(F=A[0],K=A[1]),y!=null&&T!=null)if(k>=2&&v+k<=w){for(n[o+v+k-2]==255&&n[o+v+k-1]==r?S=new Uint8Array(k-2):S=new Uint8Array(k),C=0;C<S.length;C++)S[C]=n[o+v+C];s("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else s("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(S==null){var B=0,z=[];z[B++]=255,z[B++]=r;var b=a.t519;if(b==null)throw new Error("JPEGQTables tag is missing");for(C=0;C<b.length;C++)for(z[B++]=255,z[B++]=d,z[B++]=0,z[B++]=67,z[B++]=C,u=0;u<64;u++)z[B++]=n[o+b[C]+u];for(m=0;m<2;m++){var N=a[m==0?"t520":"t521"];if(N==null)throw new Error((m==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(C=0;C<N.length;C++){z[B++]=255,z[B++]=h;var U=19;for(u=0;u<16;u++)U+=n[o+N[C]+u];for(z[B++]=U>>>8,z[B++]=U&255,z[B++]=C|m<<4,u=0;u<16;u++)z[B++]=n[o+N[C]+u];for(u=0;u<U;u++)z[B++]=n[o+N[C]+16+u]}}if(z[B++]=255,z[B++]=f,z[B++]=0,z[B++]=8+3*Q,z[B++]=8,z[B++]=a.height>>>8&255,z[B++]=a.height&255,z[B++]=a.width>>>8&255,z[B++]=a.width&255,z[B++]=Q,Q==1)z[B++]=1,z[B++]=17,z[B++]=0;else for(C=0;C<3;C++)z[B++]=C+1,z[B++]=C!=0?17:(F&15)<<4|K&15,z[B++]=C;Z!=null&&Z[0]!=0&&(z[B++]=255,z[B++]=_,z[B++]=0,z[B++]=4,z[B++]=Z[0]>>>8&255,z[B++]=Z[0]&255),S=new Uint8Array(z)}var q=-1;for(C=0;C<S.length-1;){if(S[C]==255&&S[C+1]==f){q=C;break}C++}if(q==-1){var j=new Uint8Array(S.length+10+3*Q);j.set(S);var Y=S.length;if(q=S.length,S=j,S[Y++]=255,S[Y++]=f,S[Y++]=0,S[Y++]=8+3*Q,S[Y++]=8,S[Y++]=a.height>>>8&255,S[Y++]=a.height&255,S[Y++]=a.width>>>8&255,S[Y++]=a.width&255,S[Y++]=Q,Q==1)S[Y++]=1,S[Y++]=17,S[Y++]=0;else for(C=0;C<3;C++)S[Y++]=C+1,S[Y++]=C!=0?17:(F&15)<<4|K&15,S[Y++]=C}if(n[w]==255&&n[w+1]==g){var J=n[w+2]<<8|n[w+3];for(M=new Uint8Array(J+2),M[0]=n[w],M[1]=n[w+1],M[2]=n[w+2],M[3]=n[w+3],C=0;C<J-2;C++)M[C+4]=n[w+C+4]}else{M=new Uint8Array(8+2*Q);var se=0;if(M[se++]=255,M[se++]=g,M[se++]=0,M[se++]=6+2*Q,M[se++]=Q,Q==1)M[se++]=1,M[se++]=0;else for(C=0;C<3;C++)M[se++]=C+1,M[se++]=C<<4|C;M[se++]=0,M[se++]=63,M[se++]=0}return{jpegOffset:o,tables:S,sosMarker:M,sofPosition:q}},t.decode._decodeOldJPEG=function(a,n,o,l,r,d){var h,_,f,g,x,w=t.decode._decodeOldJPEGInit(a,n,o,l);if(w.jpegOffset!=null)for(_=o+l-w.jpegOffset,g=new Uint8Array(_),h=0;h<_;h++)g[h]=n[w.jpegOffset+h];else{for(f=w.tables.length,g=new Uint8Array(f+w.sosMarker.length+l+2),g.set(w.tables),x=f,g[w.sofPosition+5]=a.height>>>8&255,g[w.sofPosition+6]=a.height&255,g[w.sofPosition+7]=a.width>>>8&255,g[w.sofPosition+8]=a.width&255,(n[o]!=255||n[o+1]!=SOS)&&(g.set(w.sosMarker,x),x+=sosMarker.length),h=0;h<l;h++)g[x++]=n[o+h];g[x++]=255,g[x++]=EOI}var S=new t.JpegDecoder;S.parse(g);for(var M=S.getData({width:S.width,height:S.height,forceRGB:!0,isSourcePDF:!1}),h=0;h<M.length;h++)r[d+h]=M[h];a.t262&&a.t262[0]==6&&(a.t262[0]=2)},t.decode._decodePackBits=function(a,n,o,l,r){for(var d=new Int8Array(a.buffer),h=new Int8Array(l.buffer),_=n+o;n<_;){var f=d[n];if(n++,f>=0&&f<128)for(var g=0;g<f+1;g++)h[r]=d[n],r++,n++;if(f>=-127&&f<0){for(var g=0;g<-f+1;g++)h[r]=d[n],r++;n++}}},t.decode._decodeThunder=function(a,n,o,l,r){for(var d=[0,1,0,-1],h=[0,1,2,3,0,-3,-2,-1],_=n+o,f=r*2,g=0;n<_;){var x=a[n],w=x>>>6,S=x&63;if(n++,w==3&&(g=S&15,l[f>>>1]|=g<<4*(1-f&1),f++),w==0)for(var M=0;M<S;M++)l[f>>>1]|=g<<4*(1-f&1),f++;if(w==2)for(var M=0;M<2;M++){var R=S>>>3*(1-M)&7;R!=4&&(g+=h[R],l[f>>>1]|=g<<4*(1-f&1),f++)}if(w==1)for(var M=0;M<3;M++){var R=S>>>2*(2-M)&3;R!=2&&(g+=d[R],l[f>>>1]|=g<<4*(1-f&1),f++)}}},t.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},t.decode._lens=function(){var a=function(f,g,x,w){for(var S=0;S<g.length;S++)f[g[S]]=x+S*w},n="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",o="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",l="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",r="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",d="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";n=n.split(","),o=o.split(","),l=l.split(","),r=r.split(","),d=d.split(",");var h={},_={};return a(h,n,0,1),a(h,l,64,64),a(h,d,1792,64),a(_,o,0,1),a(_,r,64,64),a(_,d,1792,64),[h,_]}(),t.decode._decodeG4=function(a,n,o,l,r,d,h){for(var _=t.decode,f=n<<3,g=0,x="",w=[],S=[],M=0;M<d;M++)S.push(0);S=_._makeDiff(S);for(var R=0,C=0,u=0,m=0,y=0,v=0,T="",k=0,L=Math.ceil(d/8)*8;f>>>3<n+o;){u=_._findDiff(S,R+(R==0?0:1),1-y),m=_._findDiff(S,u,y);var A=0;if(h==1&&(A=a[f>>>3]>>>7-(f&7)&1),h==2&&(A=a[f>>>3]>>>(f&7)&1),f++,x+=A,T=="H"){if(_._lens[y][x]!=null){var F=_._lens[y][x];x="",g+=F,F<64&&(_._addNtimes(w,g,y),R+=g,y=1-y,g=0,k--,k==0&&(T=""))}}else x=="0001"&&(x="",_._addNtimes(w,m-R,y),R=m),x=="001"&&(x="",T="H",k=2),_._dmap[x]!=null&&(C=u+_._dmap[x],_._addNtimes(w,C-R,y),R=C,x="",y=1-y);w.length==d&&T==""&&(_._writeBits(w,l,r*8+v*L),y=0,v++,R=0,S=_._makeDiff(w),w=[])}},t.decode._findDiff=function(a,n,o){for(var l=0;l<a.length;l+=2)if(a[l]>=n&&a[l+1]==o)return a[l]},t.decode._makeDiff=function(a){var n=[];a[0]==1&&n.push(0,1);for(var o=1;o<a.length;o++)a[o-1]!=a[o]&&n.push(o,a[o]);return n.push(a.length,0,a.length,1),n},t.decode._decodeG3=function(a,n,o,l,r,d,h,_){for(var f=t.decode,g=n<<3,x=0,w="",S=[],M=[],R=0;R<d;R++)S.push(0);for(var C=0,u=0,m=0,y=0,v=0,T=-1,k="",L=0,A=!0,F=Math.ceil(d/8)*8;g>>>3<n+o;){m=f._findDiff(M,C+(C==0?0:1),1-v),y=f._findDiff(M,m,v);var K=0;if(h==1&&(K=a[g>>>3]>>>7-(g&7)&1),h==2&&(K=a[g>>>3]>>>(g&7)&1),g++,w+=K,A){if(f._lens[v][w]!=null){var Q=f._lens[v][w];w="",x+=Q,Q<64&&(f._addNtimes(S,x,v),v=1-v,x=0)}}else if(k=="H"){if(f._lens[v][w]!=null){var Q=f._lens[v][w];w="",x+=Q,Q<64&&(f._addNtimes(S,x,v),C+=x,v=1-v,x=0,L--,L==0&&(k=""))}}else w=="0001"&&(w="",f._addNtimes(S,y-C,v),C=y),w=="001"&&(w="",k="H",L=2),f._dmap[w]!=null&&(u=m+f._dmap[w],f._addNtimes(S,u-C,v),C=u,w="",v=1-v);w.endsWith("000000000001")&&(T>=0&&f._writeBits(S,l,r*8+T*F),_&&(h==1&&(A=(a[g>>>3]>>>7-(g&7)&1)==1),h==2&&(A=(a[g>>>3]>>>(g&7)&1)==1),g++),w="",v=0,T++,C=0,M=f._makeDiff(S),S=[])}S.length==d&&f._writeBits(S,l,r*8+T*F)},t.decode._addNtimes=function(a,n,o){for(var l=0;l<n;l++)a.push(o)},t.decode._writeBits=function(a,n,o){for(var l=0;l<a.length;l++)n[o+l>>>3]|=a[l]<<7-(o+l&7)},t.decode._decodeLZW=t.decode._decodeLZW=function(){var a,n,o,l,r=0,d=0,h=0,_=0,f=function(){var u=a>>>3,m=n[u]<<16|n[u+1]<<8|n[u+2],y=m>>>24-(a&7)-d&(1<<d)-1;return a+=d,y},g=new Uint32Array(4096*4),x=0,w=function(u){if(u!=x){x=u,h=1<<u,_=h+1;for(var m=0;m<_+1;m++)g[4*m]=g[4*m+3]=m,g[4*m+1]=65535,g[4*m+2]=1}},S=function(u){d=u+1,r=_+1},M=function(u){for(var m=u<<2,y=g[m+2],v=l+y-1;m!=65535;)o[v--]=g[m],m=g[m+1];l+=y},R=function(u,m){var y=r<<2,v=u<<2;g[y]=g[(m<<2)+3],g[y+1]=v,g[y+2]=g[v+2]+1,g[y+3]=g[v+3],r++,r+1==1<<d&&d!=12&&d++},C=function(u,m,y,v,T,k){a=m<<3,n=u,o=v,l=T;var L=m+y<<3,A=0,F=0;for(w(k),S(k);a<L&&(A=f())!=_;){if(A==h){if(S(k),A=f(),A==_)break;M(A)}else A<r?(M(A),R(F,A)):(R(F,F),M(r-1));F=A}return l};return C}(),t.tags={},t._types=function(){var a=new Array(250);a.fill(0),a=a.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);var n={33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7};return{basic:{main:a,rest:n},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),t._readIFD=function(a,n,o,l,r,d){var h=a.readUshort(n,o);o+=2;var _={};d.debug&&s("   ".repeat(r),l.length-1,">>>----------------");for(var f=0;f<h;f++){var g=a.readUshort(n,o);o+=2;var x=a.readUshort(n,o);o+=2;var w=a.readUint(n,o);o+=4;var S=a.readUint(n,o);o+=4;var M=[];if((x==1||x==7)&&(M=new Uint8Array(n.buffer,w<5?o-4:S,w)),x==2){var R=w<5?o-4:S,C=n[R],u=Math.max(0,Math.min(w-1,n.length-R));C<128||u==0?M.push(a.readASCII(n,R,u)):M=new Uint8Array(n.buffer,R,u)}if(x==3)for(var m=0;m<w;m++)M.push(a.readUshort(n,(w<3?o-4:S)+2*m));if(x==4||x==13)for(var m=0;m<w;m++)M.push(a.readUint(n,(w<2?o-4:S)+4*m));if(x==5||x==10)for(var y=x==5?a.readUint:a.readInt,m=0;m<w;m++)M.push([y(n,S+m*8),y(n,S+m*8+4)]);if(x==8)for(var m=0;m<w;m++)M.push(a.readShort(n,(w<3?o-4:S)+2*m));if(x==9)for(var m=0;m<w;m++)M.push(a.readInt(n,(w<2?o-4:S)+4*m));if(x==11)for(var m=0;m<w;m++)M.push(a.readFloat(n,S+m*4));if(x==12)for(var m=0;m<w;m++)M.push(a.readDouble(n,S+m*8));if(w!=0&&M.length==0){if(s(g,"unknown TIFF tag type: ",x,"num:",w),f==0)return;continue}if(d.debug&&s("   ".repeat(r),g,x,t.tags[g],M),_["t"+g]=M,!(g==330&&_.t272&&_.t272[0]=="DSLR-A100")){if(g==330||g==34665||g==34853||g==50740&&a.readUshort(n,a.readUint(M,0))<300||g==61440){for(var v=g==50740?[a.readUint(M,0)]:M,T=[],m=0;m<v.length;m++)t._readIFD(a,n,v[m],T,r+1,d);g==330&&(_.subIFD=T),g==34665&&(_.exifIFD=T[0]),g==34853&&(_.gpsiIFD=T[0]),g==50740&&(_.dngPrvt=T[0]),g==61440&&(_.fujiIFD=T[0])}}if(g==37500&&d.parseMN){var k=M;if(a.readASCII(k,0,5)=="Nikon")_.makerNote=t.decode(k.slice(10).buffer)[0];else if(a.readUshort(n,S)<300&&a.readUshort(n,S+4)<=12){var L=[];t._readIFD(a,n,S,L,r+1,d),_.makerNote=L[0]}}}return l.push(_),d.debug&&s("   ".repeat(r),"<<<---------------"),o},t._writeIFD=function(a,n,o,l,r){var d=Object.keys(r),h=d.length;r.exifIFD&&h--,r.gpsiIFD&&h--,a.writeUshort(o,l,h),l+=2;for(var _=l+h*12+4,f=0;f<d.length;f++){var g=d[f];if(!(g=="t34665"||g=="t34853")){g=="exifIFD"&&(g="t34665"),g=="gpsiIFD"&&(g="t34853");var x=parseInt(g.slice(1)),w=n.main[x];if(w==null&&(w=n.rest[x]),w==null||w==0)throw new Error("unknown type of tag: "+x);var S=r[g];if(x==34665){var M=t._writeIFD(a,n,o,_,r.exifIFD);S=[_],_=M[1]}if(x==34853){var M=t._writeIFD(a,t._types.gps,o,_,r.gpsiIFD);S=[_],_=M[1]}w==2&&(S=S[0]+"\0");var R=S.length;a.writeUshort(o,l,x),l+=2,a.writeUshort(o,l,w),l+=2,a.writeUint(o,l,R),l+=4;var C=[-1,1,1,2,4,8,0,1,0,4,8,0,8][w]*R,u=l;if(C>4&&(a.writeUint(o,l,_),u=_),w==1||w==7)for(var m=0;m<R;m++)o[u+m]=S[m];else if(w==2)a.writeASCII(o,u,S);else if(w==3)for(var m=0;m<R;m++)a.writeUshort(o,u+2*m,S[m]);else if(w==4)for(var m=0;m<R;m++)a.writeUint(o,u+4*m,S[m]);else if(w==5||w==10)for(var y=w==5?a.writeUint:a.writeInt,m=0;m<R;m++){var v=S[m],T=v[0],k=v[1];if(T==null)throw"e";y(o,u+8*m,T),y(o,u+8*m+4,k)}else if(w==9)for(var m=0;m<R;m++)a.writeInt(o,u+4*m,S[m]);else if(w==12)for(var m=0;m<R;m++)a.writeDouble(o,u+8*m,S[m]);else throw w;C>4&&(C+=C&1,_+=C),l+=4}}return[l,_]},t.toRGBA8=function(a,n){var o=a.width,l=a.height,r=o*l,d=r*4,h=a.data,_=new Uint8Array(r*4),f=a.t262?a.t262[0]:2,g=a.t258?Math.min(32,a.t258[0]):1;if(a.t262==null&&g==1&&(f=0),f==0)for(var x=Math.ceil(g*o/8),w=0;w<l;w++){var S=w*x,M=w*o;if(g==1)for(var R=0;R<o;R++){var C=M+R<<2,u=h[S+(R>>3)]>>7-(R&7)&1;_[C]=_[C+1]=_[C+2]=(1-u)*255,_[C+3]=255}if(g==4)for(var R=0;R<o;R++){var C=M+R<<2,u=h[S+(R>>1)]>>4-4*(R&1)&15;_[C]=_[C+1]=_[C+2]=(15-u)*17,_[C+3]=255}if(g==8)for(var R=0;R<o;R++){var C=M+R<<2,u=h[S+R];_[C]=_[C+1]=_[C+2]=255-u,_[C+3]=255}}else if(f==1){var m=a.t258?a.t258.length:1,x=Math.ceil(m*g*o/8);n==null&&(n=1/256);for(var w=0;w<l;w++){var S=w*x,M=w*o;if(g==1)for(var R=0;R<o;R++){var C=M+R<<2,u=h[S+(R>>3)]>>7-(R&7)&1;_[C]=_[C+1]=_[C+2]=u*255,_[C+3]=255}if(g==2)for(var R=0;R<o;R++){var C=M+R<<2,u=h[S+(R>>2)]>>6-2*(R&3)&3;_[C]=_[C+1]=_[C+2]=u*85,_[C+3]=255}if(g==8)for(var R=0;R<o;R++){var C=M+R<<2,u=h[S+R*m];_[C]=_[C+1]=_[C+2]=u,_[C+3]=255}if(g==16)for(var R=0;R<o;R++){var C=M+R<<2,y=S+2*R,u=h[y+1]<<8|h[y];_[C]=_[C+1]=_[C+2]=Math.min(255,~~(u*n)),_[C+3]=255}}}else if(f==2){var m=a.t258?a.t258.length:3;if(g==8){if(m==4)for(var R=0;R<d;R++)_[R]=h[R];if(m==3)for(var R=0;R<r;R++){var C=R<<2,v=R*3;_[C]=h[v],_[C+1]=h[v+1],_[C+2]=h[v+2],_[C+3]=255}if(m==5)for(var R=0;R<r;R++){var C=R<<2,v=R*5;_[C]=h[v],_[C+1]=h[v+1],_[C+2]=h[v+2],_[C+3]=h[v+3]}}else{if(m==4)for(var R=0;R<r;R++){var C=R<<2,v=R*8+1;_[C]=h[v],_[C+1]=h[v+2],_[C+2]=h[v+4],_[C+3]=h[v+6]}if(m==3)for(var R=0;R<r;R++){var C=R<<2,v=R*6+1;_[C]=h[v],_[C+1]=h[v+2],_[C+2]=h[v+4],_[C+3]=255}}}else if(f==3)for(var T=a.t320,m=a.t258?a.t258.length:1,x=Math.ceil(m*g*o/8),k=1<<g,w=0;w<l;w++)for(var L=0;L<o;L++){var R=w*o+L,C=R<<2,A=0,F=w*x;if(g==1)A=h[F+(L>>>3)]>>>7-(L&7)&1;else if(g==2)A=h[F+(L>>>2)]>>>6-2*(L&3)&3;else if(g==4)A=h[F+(L>>>1)]>>>4-4*(L&1)&15;else if(g==8)A=h[F+L*m];else throw g;_[C]=T[A]>>8,_[C+1]=T[k+A]>>8,_[C+2]=T[k+k+A]>>8,_[C+3]=255}else if(f==5)for(var m=a.t258?a.t258.length:4,K=m>4?1:0,R=0;R<r;R++){var C=R<<2,Q=R*m,Z=255-h[Q],B=255-h[Q+1],z=255-h[Q+2],b=(255-h[Q+3])*(1/255);_[C]=~~(Z*b+.5),_[C+1]=~~(B*b+.5),_[C+2]=~~(z*b+.5),_[C+3]=255*(1-K)+h[Q+4]*K}else if(f==6&&a.t278)for(var N=a.t278[0],w=0;w<l;w+=N)for(var R=w*o,U=N*o,q=0;q<U;q++){var C=4*(R+q),Q=3*R+4*(q>>>1),z=h[Q+(q&1)],j=h[Q+2]-128,Y=h[Q+3]-128,J=z+((Y>>2)+(Y>>3)+(Y>>5)),se=z-((j>>2)+(j>>4)+(j>>5))-((Y>>1)+(Y>>3)+(Y>>4)+(Y>>5)),pe=z+(j+(j>>1)+(j>>2)+(j>>6));_[C]=Math.max(0,Math.min(255,J)),_[C+1]=Math.max(0,Math.min(255,se)),_[C+2]=Math.max(0,Math.min(255,pe)),_[C+3]=255}else s("Unknown Photometric interpretation: "+f);return _},t.replaceIMG=function(a){a==null&&(a=document.getElementsByTagName("img"));for(var n=["tif","tiff","dng","cr2","nef"],o=0;o<a.length;o++){var l=a[o],r=l.getAttribute("src");if(r!=null){var d=r.split(".").pop().toLowerCase();if(n.indexOf(d)!=-1){var h=new XMLHttpRequest;t._xhrs.push(h),t._imgs.push(l),h.open("GET",r),h.responseType="arraybuffer",h.onload=t._imgLoaded,h.send()}}}},t._xhrs=[],t._imgs=[],t._imgLoaded=function(a){var n=t._xhrs.indexOf(a.target),o=t._imgs[n];t._xhrs.splice(n,1),t._imgs.splice(n,1),o.setAttribute("src",t.bufferToURI(a.target.response))},t.bufferToURI=function(a){var n=t.decode(a),o=n,l=0,r=o[0];n[0].subIFD&&(o=o.concat(n[0].subIFD));for(var d=0;d<o.length;d++){var h=o[d];if(!(h.t258==null||h.t258.length<3)){var _=h.t256*h.t257;_>l&&(l=_,r=h)}}t.decodeImage(a,r,n);var f=t.toRGBA8(r),g=r.width,x=r.height,w=document.createElement("canvas");w.width=g,w.height=x;var S=w.getContext("2d"),M=new ImageData(new Uint8ClampedArray(f.buffer),g,x);return S.putImageData(M,0,0),w.toDataURL()},t._binBE={nextZero:function(a,n){for(;a[n]!=0;)n++;return n},readUshort:function(a,n){return a[n]<<8|a[n+1]},readShort:function(a,n){var o=t._binBE.ui8;return o[0]=a[n+1],o[1]=a[n+0],t._binBE.i16[0]},readInt:function(a,n){var o=t._binBE.ui8;return o[0]=a[n+3],o[1]=a[n+2],o[2]=a[n+1],o[3]=a[n+0],t._binBE.i32[0]},readUint:function(a,n){var o=t._binBE.ui8;return o[0]=a[n+3],o[1]=a[n+2],o[2]=a[n+1],o[3]=a[n+0],t._binBE.ui32[0]},readASCII:function(a,n,o){for(var l="",r=0;r<o;r++)l+=String.fromCharCode(a[n+r]);return l},readFloat:function(a,n){for(var o=t._binBE.ui8,l=0;l<4;l++)o[l]=a[n+3-l];return t._binBE.fl32[0]},readDouble:function(a,n){for(var o=t._binBE.ui8,l=0;l<8;l++)o[l]=a[n+7-l];return t._binBE.fl64[0]},writeUshort:function(a,n,o){a[n]=o>>8&255,a[n+1]=o&255},writeInt:function(a,n,o){var l=t._binBE.ui8;t._binBE.i32[0]=o,a[n+3]=l[0],a[n+2]=l[1],a[n+1]=l[2],a[n+0]=l[3]},writeUint:function(a,n,o){a[n]=o>>24&255,a[n+1]=o>>16&255,a[n+2]=o>>8&255,a[n+3]=o>>0&255},writeASCII:function(a,n,o){for(var l=0;l<o.length;l++)a[n+l]=o.charCodeAt(l)},writeDouble:function(a,n,o){t._binBE.fl64[0]=o;for(var l=0;l<8;l++)a[n+l]=t._binBE.ui8[7-l]}},t._binBE.ui8=new Uint8Array(8),t._binBE.i16=new Int16Array(t._binBE.ui8.buffer),t._binBE.i32=new Int32Array(t._binBE.ui8.buffer),t._binBE.ui32=new Uint32Array(t._binBE.ui8.buffer),t._binBE.fl32=new Float32Array(t._binBE.ui8.buffer),t._binBE.fl64=new Float64Array(t._binBE.ui8.buffer),t._binLE={nextZero:t._binBE.nextZero,readUshort:function(a,n){return a[n+1]<<8|a[n]},readShort:function(a,n){var o=t._binBE.ui8;return o[0]=a[n+0],o[1]=a[n+1],t._binBE.i16[0]},readInt:function(a,n){var o=t._binBE.ui8;return o[0]=a[n+0],o[1]=a[n+1],o[2]=a[n+2],o[3]=a[n+3],t._binBE.i32[0]},readUint:function(a,n){var o=t._binBE.ui8;return o[0]=a[n+0],o[1]=a[n+1],o[2]=a[n+2],o[3]=a[n+3],t._binBE.ui32[0]},readASCII:t._binBE.readASCII,readFloat:function(a,n){for(var o=t._binBE.ui8,l=0;l<4;l++)o[l]=a[n+l];return t._binBE.fl32[0]},readDouble:function(a,n){for(var o=t._binBE.ui8,l=0;l<8;l++)o[l]=a[n+l];return t._binBE.fl64[0]},writeUshort:function(a,n,o){a[n]=o&255,a[n+1]=o>>8&255},writeInt:function(a,n,o){var l=t._binBE.ui8;t._binBE.i32[0]=o,a[n+0]=l[0],a[n+1]=l[1],a[n+2]=l[2],a[n+3]=l[3]},writeUint:function(a,n,o){a[n]=o>>>0&255,a[n+1]=o>>>8&255,a[n+2]=o>>>16&255,a[n+3]=o>>>24&255},writeASCII:t._binBE.writeASCII},t._copyTile=function(a,n,o,l,r,d,h,_){for(var f=Math.min(n,r-h),g=Math.min(o,d-_),x=0;x<g;x++)for(var w=(_+x)*r+h,S=x*n,M=0;M<f;M++)l[w+M]=a[S+M]},t.LosslessJpegDecode=function(){var a,n,o,l,r,d,h,_,f,g;function x(){return a[n++]}function w(){return a[n++]<<8|a[n++]}function S(){for(var A=x(),F=[0,0,0,255],K=[],Q=8,Z=0;Z<16;Z++)K[Z]=x();for(var Z=0;Z<16;Z++)for(var B=0;B<K[Z];B++){var z=M(F,0,Z+1,1);F[z+3]=x()}var b=new Uint8Array(1<<Q);f[A]=[new Uint8Array(F),b];for(var Z=0;Z<1<<Q;Z++){for(var N=Q,U=Z,q=0,j=0;F[q+3]==255&&N!=0;)j=U>>--N&1,q=F[q+j];b[Z]=q}}function M(A,F,K,Q){if(A[F+3]!=255)return 0;if(K==0)return F;for(var Z=0;Z<2;Z++){A[F+Z]==0&&(A[F+Z]=A.length,A.push(0,0,Q,255));var B=M(A,A[F+Z],K-1,Q+1);if(B!=0)return B}return 0}function R(A){for(var F=A.e,K=A.c;F<25&&A.a<A.d;){var Q=A.data[A.a++];A.b||(A.a+=Q+1>>>8),K=K<<8|Q,F+=8}A.e=F,A.c=K}function C(A,F){return F.e<A&&R(F),F.c>>(F.e-=A)&65535>>16-A}function u(A,F){var K=A[0],Q=0,Z=255,B=0;F.e<16&&R(F);var z=F.c>>F.e-8&255;for(Q=A[1][z],Z=K[Q+3],F.e-=K[Q+2];Z==255;)B=F.c>>--F.e&1,Q=K[Q+B],Z=K[Q+3];return Z}function m(A,F){return A<32768>>16-F&&(A+=-(1<<F)+1),A}function y(A,F){var K=u(A,F);if(K==0)return 0;if(K==16)return-32768;var Q=C(K,F);return m(Q,K)}function v(A,F,K){for(var Q=d,Z=l,B=h,z=g,b=0;b<Q;b++)A[b]=y(z[b],K)+(1<<o-1);for(var N=Q;N<F;N+=Q)for(var b=0;b<Q;b++)A[N+b]=y(z[b],K)+A[N+b-Q];for(var U=F,q=1;q<Z;q++){for(var b=0;b<Q;b++)A[U+b]=y(z[b],K)+A[U+b-F];for(var N=Q;N<F;N+=Q)for(var b=0;b<Q;b++){var j=U+N+b,Y=A[j-Q],J=0;if(B==0)J=0;else if(B==1)J=Y;else if(B==2)J=A[j-F];else if(B==3)J=A[j-F-Q];else if(B==4)J=Y+(A[j-F]-A[j-F-Q]);else if(B==5)J=Y+(A[j-F]-A[j-F-Q]>>>1);else if(B==6)J=A[j-F]+(Y-A[j-F-Q]>>>1);else if(B==7)J=Y+A[j-F]>>>1;else throw B;A[j]=J+y(z[b],K)}U+=F}}function T(A,F){return m(C(A,F),A)}function k(A,F,K){for(var Q=a.length-n,Z=0;Z<Q;Z+=4){var B=a[n+Z];a[n+Z]=a[n+Z+3],a[n+Z+3]=B;var B=a[n+Z+1];a[n+Z+1]=a[n+Z+2],a[n+Z+2]=B}for(var z=g[0],b=0;b<l;b++)for(var N=32768,U=32768,q=0;q<F;q+=2){var j=u(z,K),Y=u(z,K);j!=0&&(N+=T(j,K)),Y!=0&&(U+=T(Y,K)),A[b*F+q]=N&65535,A[b*F+q+1]=U&65535}}function L(A){if(a=A,n=0,f=[],g=[],w()!=65496)throw"e";for(;;){var F=w();if(F==65535){n--;continue}var K=w();if(F==65475){o=x(),l=w(),r=w(),d=x(),_=[];for(var Q=0;Q<d;Q++){var Z=x(),B=x();if(B!=17)throw"e";var z=x();if(z!=0)throw"e";_[Z]=Q}}else if(F==65476)for(var b=n+K-2;n<b;)S();else if(F==65498){n++;for(var Q=0;Q<d;Q++){var N=x();g[_[N]]=f[x()>>>4]}h=x(),n+=2;break}else n+=K-2}var U=o>8?Uint16Array:Uint8Array,q=r*d,j=new U(l*q),Y={e:0,c:0,b:h==8,a:n,data:a,d:a.length};return Y.b?k(j,q,Y):v(j,q,Y),j}return L}(),function(){var a=0,n=1,o=2,l=3,r=4,d=5,h=6,_=7,f=8,g=9,x=10,w=11,S=12,M=13,R=14,C=15,u=16,m=17,y=18;function v(j){var Y=t._binBE.readUshort,J={m:Y(j,0),f:j[2],r:j[3],a:j[4],d:Y(j,5),t:Y(j,7),h:Y(j,9),n:Y(j,11),v:j[13],p:Y(j,14)};if(J.m!=18771||J.f>1||J.d<6||J.d%6||J.h<768||J.h%24||J.n!=768||J.t<J.n||J.t%J.n||J.t-J.h>=J.n||J.v>16||J.v!=J.t/J.n||J.v!=Math.ceil(J.h/J.n)||J.p!=J.d/6||J.a!=12&&J.a!=14&&J.a!=16||J.r!=16&&J.r!=0)throw"Invalid data";if(J.f==0)throw"Not implemented. We need this file!";return J.o=J.r==16,J.c=(J.o?J.n*2/3:J.n>>>1)|0,J.g=J.c+2,J.q=64,J.j=(1<<J.a)-1,J.w=4*J.a,J}function T(j,Y){for(var J=new Array(Y.v),se=16+4*Y.v,pe=0,_e=16;pe<Y.v;_e+=4){var Ee=t._binBE.readUint(j,_e);J[pe]=j.slice(se,se+Ee),J[pe].l=0,J[pe].s=0,se+=Ee,pe++}if(se!=j.length)throw"Invalid data";return J}function k(j,Y){for(var J=-Y[4],se=0;J<=Y[4];se++,J++)j[se]=J<=-Y[3]?-4:J<=-Y[2]?-3:J<=-Y[1]?-2:J<-Y[0]?-1:J<=Y[0]?0:J<Y[1]?1:J<Y[2]?2:J<Y[3]?3:4}function L(j,Y,J){var se=[Y,3*Y+18,5*Y+67,7*Y+276,J];j.k=Y,j.i=(se[4]+2*Y)/(2*Y+1)+1|0,j.b=Math.ceil(Math.log2(j.i)),j.e=9,k(j.u,se)}function A(j){var Y={u:new Int8Array(2<<j.a)};return L(Y,0,j.j),Y}function F(j){for(var Y=[[],[],[]],J=Math.max(2,j.i+32>>>6),se=0;se<3;se++)for(var pe=0;pe<41;pe++)Y[se][pe]=[J,1];return Y}function K(j){for(var Y=-1,J=0;!J;Y++)J=j[j.l]>>>7-j.s&1,j.s++,j.s&=7,j.s||j.l++;return Y}function Q(j,Y){var J=0,se=8-j.s;if(j.l,j.s,Y){if(Y>=se)do J<<=se,Y-=se,J|=j[j.l]&(1<<se)-1,j.l++,se=8;while(Y>=8);Y&&(J<<=Y,se-=Y,J|=j[j.l]>>>se&(1<<Y)-1),j.s=8-se}return J}function Z(j,Y){var J=0;if(Y<j)for(;J<=14&&Y<<++J<j;);return J}function B(j,Y,J,se,pe,_e,Ee,X){X==null&&(X=0);var D=_e+1,te=D%2,re=0,oe,ve,ee=se[pe],le=se[pe-1],H=se[pe-2][D],I=le[D-1],O=le[D],ae=le[D+1],me=ee[D-1],Ae=ee[D+1],Se=Math.abs,Ge,Xe,Ue,Ze;if(te&&(Ge=Se(ae-O),Xe=Se(H-O),Ue=Se(I-O)),te){if(Ze=Ge>Ue&&Xe<Ge?H+I:Ge<Ue&&Xe<Ue?H+ae:ae+I,Ze=Ze+2*O>>>2,X){ee[D]=Ze;return}oe=Y.e*Y.u[j.j+O-H]+Y.u[j.j+I-O]}else Ze=O>I&&O>ae||O<I&&O<ae?Ae+me+2*O>>>2:me+Ae>>>1,oe=Y.e*Y.u[j.j+O-I]+Y.u[j.j+I-me];ve=Se(oe);var He=K(J);if(He<j.w-Y.b-1){var Je=Z(Ee[ve][0],Ee[ve][1]);re=Q(J,Je)+(He<<Je)}else re=Q(J,Y.b)+1;re=re&1?-1-(re>>>1):re>>>1,Ee[ve][0]+=Se(re),Ee[ve][1]==j.q&&(Ee[ve][0]>>>=1,Ee[ve][1]>>>=1),Ee[ve][1]++,Ze=oe<0?Ze-re:Ze+re,j.f&&(Ze<0?Ze+=Y.i:Ze>j.j&&(Ze-=Y.i)),ee[D]=Ze>=0?Math.min(Ze,j.j):0}function z(j,Y,J){for(var se=j[0].length,pe=Y;pe<=J;pe++)j[pe][0]=j[pe-1][1],j[pe][se-1]=j[pe-1][se-2]}function b(j){z(j,_,S),z(j,o,r),z(j,C,m)}function N(j,Y,J,se,pe,_e,Ee,X,D,te,re,oe,ve){for(var ee=0,le=1,H=pe<M&&pe>r;le<j.c;)ee<j.c&&(B(j,Y,J,se,pe,ee,Ee[D],j.o&&(H&&te||!H&&(re||(ee&oe)==ve))),B(j,Y,J,se,_e,ee,Ee[D],j.o&&(!H&&te||H&&(re||(ee&oe)==ve))),ee+=2),ee>8&&(B(j,Y,J,se,pe,le,X[D]),B(j,Y,J,se,_e,le,X[D]),le+=2);b(se)}function U(j,Y,J,se,pe,_e){N(j,Y,J,se,o,_,pe,_e,0,0,1,0,8),N(j,Y,J,se,f,C,pe,_e,1,0,1,0,8),N(j,Y,J,se,l,g,pe,_e,2,1,0,3,0),N(j,Y,J,se,x,u,pe,_e,0,0,0,3,2),N(j,Y,J,se,r,w,pe,_e,1,0,0,3,2),N(j,Y,J,se,S,m,pe,_e,2,1,0,3,0)}function q(j,Y,J,se,pe,_e){var Ee=_e.length,X=j.n;pe+1==j.v&&(X=j.h-pe*j.n);for(var D=6*j.h*se+pe*j.n,te=0;te<6;te++){for(var re=0;re<X;re++){var oe=_e[te%Ee][re%Ee],ve;oe==0?ve=o+(te>>>1):oe==2?ve=C+(te>>>1):ve=_+te;var ee=j.o?(re*2/3&2147483646|re%3&1)+(re%3>>>1):re>>>1;Y[D+re]=J[ve][ee+1]}D+=j.h}}t._decompressRAF=function(j,Y){var J=v(j),se=T(j,J),pe=A(J),_e=new Int16Array(J.h*J.d);Y==null&&(Y=J.o?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var Ee=[[a,l],[n,r],[d,w],[h,S],[M,u],[R,m]],X=[],D=0;D<y;D++)X[D]=new Uint16Array(J.g);for(var te=0;te<J.v;te++){for(var re=F(pe),oe=F(pe),D=0;D<y;D++)for(var ve=0;ve<J.g;ve++)X[D][ve]=0;for(var ee=0;ee<J.p;ee++){U(J,pe,se[te],X,re,oe);for(var D=0;D<6;D++)for(var ve=0;ve<J.g;ve++)X[Ee[D][0]][ve]=X[Ee[D][1]][ve];q(J,_e,X,ee,te,Y);for(var D=o;D<y;D++)if([d,h,M,R].indexOf(D)==-1)for(var ve=0;ve<J.g;ve++)X[D][ve]=0;b(X)}}return _e}}()})(e,i)})();/**
 * Based on: https://github.com/shaozilee/bmp-js/blob/db2c466ca1869ddc09e4b2143404eb03ecd490db/lib/encoder.js
 * @author shaozilee
 * @author 1j01
 * @license MIT
 *
 * BMP format encoder, encodes 24bit, 8bit, 4bit, and 1bit BMP files.
 * Doesn't support compression.
 *
 *//**
 * Based on: https://github.com/hipstersmoothie/bmp-ts
 * @license MIT
 */const HeaderTypes={};HeaderTypes[HeaderTypes.BITMAP_INFO_HEADER=40]="BITMAP_INFO_HEADER";HeaderTypes[HeaderTypes.BITMAP_V2_INFO_HEADER=52]="BITMAP_V2_INFO_HEADER";HeaderTypes[HeaderTypes.BITMAP_V3_INFO_HEADER=56]="BITMAP_V3_INFO_HEADER";HeaderTypes[HeaderTypes.BITMAP_V4_HEADER=108]="BITMAP_V4_HEADER";HeaderTypes[HeaderTypes.BITMAP_V5_HEADER=124]="BITMAP_V5_HEADER";Object.freeze(HeaderTypes);(function(e,i){if(typeof define=="function"&&define.amd)define([],i);else if(typeof exports<"u")i();else{var s={exports:{}};i(),window.FileSaver=s.exports}})(void 0,function(){var e=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0;function i(o,l){return typeof l>"u"?l={autoBom:!1}:typeof l!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function s(o,l,r){var d=new XMLHttpRequest;d.open("GET",o),d.responseType="blob",d.onload=function(){n(d.response,l,r)},d.onerror=function(){console.error("could not download file")},d.send()}function t(o){var l=new XMLHttpRequest;l.open("HEAD",o,!1);try{l.send()}catch{}return l.status>=200&&l.status<=299}function c(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(l)}}var a=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),n=e.saveAs||(typeof window!="object"||window!==e?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(l,r,d){var h=e.URL||e.webkitURL,_=document.createElement("a");r=r||l.name||"download",_.download=r,_.rel="noopener",typeof l=="string"?(_.href=l,_.origin!==location.origin?t(_.href)?s(l,r,d):c(_,_.target="_blank"):c(_)):(_.href=h.createObjectURL(l),setTimeout(function(){h.revokeObjectURL(_.href)},4e4),setTimeout(function(){c(_)},0))}:"msSaveOrOpenBlob"in navigator?function(l,r,d){if(r=r||l.name||"download",typeof l=="string")if(t(l))s(l,r,d);else{var h=document.createElement("a");h.href=l,h.target="_blank",setTimeout(function(){c(h)})}else navigator.msSaveOrOpenBlob(i(l,d),r)}:function(l,r,d,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof l=="string")return s(l,r,d);var _=l.type==="application/octet-stream",f=/constructor/i.test(e.HTMLElement)||e.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||_&&f||a)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var M=x.result;M=g?M:M.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=M:location=M,h=null},x.readAsDataURL(l)}else{var w=e.URL||e.webkitURL,S=w.createObjectURL(l);h?h.location=S:location.href=S,h=null,setTimeout(function(){w.revokeObjectURL(S)},4e4)}});e.saveAs=n.saveAs=n,typeof module<"u"&&(module.exports=n)});(function e(i,s,t){function c(o,l){if(!s[o]){if(!i[o]){var r=typeof require=="function"&&require;if(!l&&r)return r(o,!0);if(a)return a(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var h=s[o]={exports:{}};i[o][0].call(h.exports,function(_){var f=i[o][1][_];return c(f||_)},h,h.exports,e,i,s,t)}return s[o].exports}for(var a=typeof require=="function"&&require,n=0;n<t.length;n++)c(t[n]);return c})({1:[function(e,i,s){var t,c,a;t=function(n,o){var l;return l=setTimeout(o,n),{stop:function(){return clearTimeout(l)}}},a=function(n,o){var l;return l=setInterval(o,n),{stop:function(){return clearInterval(l)}}},c=function(n){return/in/.test(document.readyState)?t(10,function(){return c(n)}):n()},function(n){var o,l,r,d,h,_,f,g,x,w;return o=n.FontDetective={},f="Helvetica,Lucida Grande,Lucida Sans,Tahoma,Arial,Geneva,Monaco,Verdana,Microsoft Sans Serif,Trebuchet MS,Courier New,Times New Roman,Courier,Lucida Bright,Lucida Sans Typewriter,URW Chancery L,Comic Sans MS,Georgia,Palatino Linotype,Lucida Sans Unicode,Times,Century Schoolbook L,URW Gothic L,Franklin Gothic Medium,Lucida Console,Impact,URW Bookman L,Helvetica Neue,Nimbus Sans L,URW Palladio L,Nimbus Mono L,Nimbus Roman No9 L,Arial Black,Sylfaen,MV Boli,Estrangelo Edessa,Tunga,Gautami,Raavi,Mangal,Shruti,Latha,Kartika,Vrinda,Arial Narrow,Century Gothic,Garamond,Book Antiqua,Bookman Old Style,Calibri,Cambria,Candara,Corbel,Monotype Corsiva,Cambria Math,Consolas,Constantia,MS Reference Sans Serif,MS Mincho,Segoe UI,Arial Unicode MS,Tempus Sans ITC,Kristen ITC,Mistral,Meiryo UI,Juice ITC,Papyrus,Bradley Hand ITC,French Script MT,Malgun Gothic,Microsoft YaHei,Gisha,Leelawadee,Microsoft JhengHei,Haettenschweiler,Microsoft Himalaya,Microsoft Uighur,MoolBoran,Jokerman,DFKai-SB,KaiTi,SimSun-ExtB,Freestyle Script,Vivaldi,FangSong,MingLiU-ExtB,MingLiU_HKSCS,MingLiU_HKSCS-ExtB,PMingLiU-ExtB,Copperplate Gothic Light,Copperplate Gothic Bold,Franklin Gothic Book,Maiandra GD,Perpetua,Eras Demi ITC,Felix Titling,Franklin Gothic Demi,Pristina,Edwardian Script ITC,OCR A Extended,Engravers MT,Eras Light ITC,Franklin Gothic Medium Cond,Rockwell Extra Bold,Rockwell,Curlz MT,Blackadder ITC,Franklin Gothic Heavy,Franklin Gothic Demi Cond,Lucida Handwriting,Segoe UI Light,Segoe UI Semibold,Lucida Calligraphy,Cooper Black,Viner Hand ITC,Britannic Bold,Wide Latin,Old English Text MT,Broadway,Footlight MT Light,Harrington,Snap ITC,Onyx,Playbill,Bauhaus 93,Baskerville Old Face,Algerian,Matura MT Script Capitals,Stencil,Batang,Chiller,Harlow Solid Italic,Kunstler Script,Bernard MT Condensed,Informal Roman,Vladimir Script,Bell MT,Colonna MT,High Tower Text,Californian FB,Ravie,Segoe Script,Brush Script MT,SimSun,Arial Rounded MT Bold,Berlin Sans FB,Centaur,Niagara Solid,Showcard Gothic,Niagara Engraved,Segoe Print,Gabriola,Gill Sans MT,Iskoola Pota,Calisto MT,Script MT Bold,Century Schoolbook,Berlin Sans FB Demi,Magneto,Arabic Typesetting,DaunPenh,Mongolian Baiti,DokChampa,Euphemia,Kalinga,Microsoft Yi Baiti,Nyala,Bodoni MT Poster Compressed,Goudy Old Style,Imprint MT Shadow,Gill Sans MT Condensed,Gill Sans Ultra Bold,Palace Script MT,Lucida Fax,Gill Sans MT Ext Condensed Bold,Goudy Stout,Eras Medium ITC,Rage Italic,Rockwell Condensed,Castellar,Eras Bold ITC,Forte,Gill Sans Ultra Bold Condensed,Perpetua Titling MT,Agency FB,Tw Cen MT,Gigi,Tw Cen MT Condensed,Aparajita,Gloucester MT Extra Condensed,Tw Cen MT Condensed Extra Bold,PMingLiU,Bodoni MT,Bodoni MT Black,Bodoni MT Condensed,MS Gothic,GulimChe,MS UI Gothic,MS PGothic,Gulim,MS PMincho,BatangChe,Dotum,DotumChe,Gungsuh,GungsuhChe,MingLiU,NSimSun,SimHei,DejaVu Sans,DejaVu Sans Condensed,DejaVu Sans Mono,DejaVu Serif,DejaVu Serif Condensed,Eurostile,Matisse ITC,Bitstream Vera Sans Mono,Bitstream Vera Sans,Staccato222 BT,Bitstream Vera Serif,Broadway BT,ParkAvenue BT,Square721 BT,Calligraph421 BT,MisterEarl BT,Cataneo BT,Ruach LET,Rage Italic LET,La Bamba LET,Blackletter686 BT,John Handy LET,Scruff LET,Westwood LET".split(",").sort(),w=[],d=!1,g=!1,r=document.createElement("div"),r.id="font-detective",l=function(){function S(M,R,C){this.name=M,this.type=R,this.style=C}return S.prototype.toString=function(){return'"'+this.name.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},S}(),h=function(){var S,M,R,C;return S=["monospace","sans-serif","serif"],C=document.createElement("span"),C.innerHTML="mmmmmmmmmmlli",C.style.fontSize="72px",R={},M={},{init:function(){var u,m,y,v;for(document.body.appendChild(r),v=[],m=0,y=S.length;m<y;m++)u=S[m],C.style.fontFamily=u,r.appendChild(C),R[u]=C.offsetWidth,M[u]=C.offsetHeight,v.push(r.removeChild(C));return v},check:function(u){var m,y,v,T;for(v=0,T=S.length;v<T;v++)if(m=S[v],C.style.fontFamily=u+", "+m,r.appendChild(C),y=C.offsetWidth!==R[m]||C.offsetHeight!==M[m],r.removeChild(C),y)return!0;return!1}}}(),_=function(){if(!g)return g=!0,o.incomplete=!0,c(function(S){return function(){var M;return x(function(){var R,C,u;for(u=[],R=0,C=f.length;R<C;R++)M=f[R],u.push(new l(M));return u}())}}())},x=function(S){var M,R;return h.init(),M=0,R=a(20,function(){var C,u,m,y,v,T,k,L,A,F;for(y=0;y<=5;y++){if(m=S[M],C=h.check(m),C)for(w.push(m),A=o.each.callbacks,v=0,k=A.length;v<k;v++)u=A[v],u(m);if(M++,M>=S.length){for(R.stop(),F=o.all.callbacks,T=0,L=F.length;T<L;T++)u=F[T],u(w);o.all.callbacks=[],o.each.callbacks=[],d=!0;return}}})},o.preload=_,o.each=function(S){var M,R,C;for(R=0,C=w.length;R<C;R++)M=w[R],S(M);if(!d)return o.each.callbacks.push(S),_()},o.each.callbacks=[],o.all=function(S){return d?S(w):(o.all.callbacks.push(S),_())},o.all.callbacks=[]}(window)},{}]},{},[1]);const libtess=(function(){var e;function i(W,ne){return W.b===ne.b&&W.a===ne.a}function s(W,ne){return W.b<ne.b||W.b===ne.b&&W.a<=ne.a}function t(W,ne,ue){var he=ne.b-W.b,we=ue.b-ne.b;return 0<he+we?he<we?ne.a-W.a+he/(he+we)*(W.a-ue.a):ne.a-ue.a+we/(he+we)*(ue.a-W.a):0}function c(W,ne,ue){var he=ne.b-W.b,we=ue.b-ne.b;return 0<he+we?(ne.a-ue.a)*he+(ne.a-W.a)*we:0}function a(W,ne){return W.a<ne.a||W.a===ne.a&&W.b<=ne.b}function n(W,ne,ue){var he=ne.a-W.a,we=ue.a-ne.a;return 0<he+we?he<we?ne.b-W.b+he/(he+we)*(W.b-ue.b):ne.b-ue.b+we/(he+we)*(ue.b-W.b):0}function o(W,ne,ue){var he=ne.a-W.a,we=ue.a-ne.a;return 0<he+we?(ne.b-ue.b)*he+(ne.b-W.b)*we:0}function l(W){return s(W.b.a,W.a)}function r(W){return s(W.a,W.b.a)}function d(W,ne,ue,he){return W=0>W?0:W,ue=0>ue?0:ue,W<=ue?ue===0?(ne+he)/2:ne+W/(W+ue)*(he-ne):he+ue/(W+ue)*(ne-he)}function h(W){var ne=w(W.b);return M(ne,W.c),M(ne.b,W.c),R(ne,W.a),ne}function _(W,ne){var ue=!1,he=!1;W!==ne&&(ne.a!==W.a&&(he=!0,u(ne.a,W.a)),ne.d!==W.d&&(ue=!0,m(ne.d,W.d)),S(ne,W),he||(M(ne,W.a),W.a.c=W),ue||(R(ne,W.d),W.d.a=W))}function f(W){var ne=W.b,ue=!1;W.d!==W.b.d&&(ue=!0,m(W.d,W.b.d)),W.c===W?u(W.a,null):(W.b.d.a=ee(W),W.a.c=W.c,S(W,ee(W)),ue||R(W,W.d)),ne.c===ne?(u(ne.a,null),m(ne.d,null)):(W.d.a=ee(ne),ne.a.c=ne.c,S(ne,ee(ne))),C(W)}function g(W){var ne=w(W),ue=ne.b;return S(ne,W.e),ne.a=W.b.a,M(ue,ne.a),ne.d=ue.d=W.d,ne=ne.b,S(W.b,ee(W.b)),S(W.b,ne),W.b.a=ne.a,ne.b.a.c=ne.b,ne.b.d=W.b.d,ne.f=W.f,ne.b.f=W.b.f,ne}function x(W,ne){var ue=!1,he=w(W),we=he.b;return ne.d!==W.d&&(ue=!0,m(ne.d,W.d)),S(he,W.e),S(we,ne),he.a=W.b.a,we.a=ne.a,he.d=we.d=W.d,W.d.a=we,ue||R(he,W.d),he}function w(W){var ne=new ve,ue=new ve,he=W.b.h;return ue.h=he,he.b.h=ne,ne.h=W,W.b.h=ue,ne.b=ue,ne.c=ne,ne.e=ue,ue.b=ne,ue.c=ue,ue.e=ne}function S(W,ne){var ue=W.c,he=ne.c;ue.b.e=ne,he.b.e=W,W.c=he,ne.c=ue}function M(W,ne){var ue=ne.f,he=new H(ne,ue);ue.e=he,ne.f=he,ue=he.c=W;do ue.a=he,ue=ue.c;while(ue!==W)}function R(W,ne){var ue=ne.d,he=new oe(ne,ue);ue.b=he,ne.d=he,he.a=W,he.c=ne.c,ue=W;do ue.d=he,ue=ue.e;while(ue!==W)}function C(W){var ne=W.h;W=W.b.h,ne.b.h=W,W.b.h=ne}function u(W,ne){var ue=W.c,he=ue;do he.a=ne,he=he.c;while(he!==ue);ue=W.f,he=W.e,he.f=ue,ue.e=he}function m(W,ne){var ue=W.a,he=ue;do he.d=ne,he=he.e;while(he!==ue);ue=W.d,he=W.b,he.d=ue,ue.b=he}function y(W){var ne=0;return Math.abs(W[1])>Math.abs(W[0])&&(ne=1),Math.abs(W[2])>Math.abs(W[ne])&&(ne=2),ne}var v=4*1e150;function T(W,ne){W.f+=ne.f,W.b.f+=ne.b.f}function k(W,ne,ue){return W=W.a,ne=ne.a,ue=ue.a,ne.b.a===W?ue.b.a===W?s(ne.a,ue.a)?0>=c(ue.b.a,ne.a,ue.a):0<=c(ne.b.a,ue.a,ne.a):0>=c(ue.b.a,W,ue.a):ue.b.a===W?0<=c(ne.b.a,W,ne.a):(ne=t(ne.b.a,W,ne.a),W=t(ue.b.a,W,ue.a),ne>=W)}function L(W){W.a.i=null;var ne=W.e;ne.a.c=ne.c,ne.c.a=ne.a,W.e=null}function A(W,ne){f(W.a),W.c=!1,W.a=ne,ne.i=W}function F(W){var ne=W.a.a;do W=qe(W);while(W.a.a===ne);return W.c&&(ne=x(nt(W).a.b,W.a.e),A(W,ne),W=qe(W)),W}function K(W,ne,ue){var he=new Je;return he.a=ue,he.e=_e(W.f,ne.e,he),ue.i=he}function Q(W,ne){switch(W.s){case 100130:return(ne&1)!==0;case 100131:return ne!==0;case 100132:return 0<ne;case 100133:return 0>ne;case 100134:return 2<=ne||-2>=ne}return!1}function Z(W){var ne=W.a,ue=ne.d;ue.c=W.d,ue.a=ne,L(W)}function B(W,ne,ue){for(W=ne,ne=ne.a;W!==ue;){W.c=!1;var he=nt(W),we=he.a;if(we.a!==ne.a){if(!he.c){Z(W);break}we=x(ne.c.b,we.b),A(he,we)}ne.c!==we&&(_(ee(we),we),_(ne,we)),Z(W),ne=he.a,W=he}return ne}function z(W,ne,ue,he,we,Pe){var ge=!0;do K(W,ne,ue.b),ue=ue.c;while(ue!==he);for(we===null&&(we=nt(ne).a.b.c);he=nt(ne),ue=he.a.b,ue.a===we.a;)ue.c!==we&&(_(ee(ue),ue),_(ee(we),ue)),he.f=ne.f-ue.f,he.d=Q(W,he.f),ne.b=!0,!ge&&q(W,ne)&&(T(ue,we),L(ne),f(we)),ge=!1,ne=he,we=ue;ne.b=!0,Pe&&Y(W,ne)}function b(W,ne,ue,he,we){var Pe=[ne.g[0],ne.g[1],ne.g[2]];ne.d=null,ne.d=W.o&&W.o(Pe,ue,he,W.c)||null,ne.d===null&&(we?W.n||(re(W,100156),W.n=!0):ne.d=ue[0])}function N(W,ne,ue){var he=[null,null,null,null];he[0]=ne.a.d,he[1]=ue.a.d,b(W,ne.a,he,[.5,.5,0,0],!1),_(ne,ue)}function U(W,ne,ue,he,we){var Pe=Math.abs(ne.b-W.b)+Math.abs(ne.a-W.a),ge=Math.abs(ue.b-W.b)+Math.abs(ue.a-W.a),be=we+1;he[we]=.5*ge/(Pe+ge),he[be]=.5*Pe/(Pe+ge),W.g[0]+=he[we]*ne.g[0]+he[be]*ue.g[0],W.g[1]+=he[we]*ne.g[1]+he[be]*ue.g[1],W.g[2]+=he[we]*ne.g[2]+he[be]*ue.g[2]}function q(W,ne){var ue=nt(ne),he=ne.a,we=ue.a;if(s(he.a,we.a)){if(0<c(we.b.a,he.a,we.a))return!1;if(!i(he.a,we.a))g(we.b),_(he,ee(we)),ne.b=ue.b=!0;else if(he.a!==we.a){var ue=W.e,Pe=he.a.h;if(0<=Pe){var ue=ue.b,ge=ue.d,be=ue.e,Ce=ue.c,Fe=Ce[Pe];ge[Fe]=ge[ue.a],Ce[ge[Fe]]=Fe,Fe<=--ue.a&&(1>=Fe||s(be[ge[Fe>>1]],be[ge[Fe]])?Ze(ue,Fe):He(ue,Fe)),be[Pe]=null,Ce[Pe]=ue.b,ue.b=Pe}else for(ue.c[-(Pe+1)]=null;0<ue.a&&ue.c[ue.d[ue.a-1]]===null;)--ue.a;N(W,ee(we),he)}}else{if(0>c(he.b.a,we.a,he.a))return!1;qe(ne).b=ne.b=!0,g(he.b),_(ee(we),he)}return!0}function j(W,ne){var ue=nt(ne),he=ne.a,we=ue.a,Pe=he.a,ge=we.a,be=he.b.a,Ce=we.b.a,Fe=new H;if(c(be,W.a,Pe),c(Ce,W.a,ge),Pe===ge||Math.min(Pe.a,be.a)>Math.max(ge.a,Ce.a))return!1;if(s(Pe,ge)){if(0<c(Ce,Pe,ge))return!1}else if(0>c(be,ge,Pe))return!1;var Ve=be,Ye=Pe,We=Ce,Ie=ge,Oe,it;if(s(Ve,Ye)||(Oe=Ve,Ve=Ye,Ye=Oe),s(We,Ie)||(Oe=We,We=Ie,Ie=Oe),s(Ve,We)||(Oe=Ve,Ve=We,We=Oe,Oe=Ye,Ye=Ie,Ie=Oe),s(We,Ye)?s(Ye,Ie)?(Oe=t(Ve,We,Ye),it=t(We,Ye,Ie),0>Oe+it&&(Oe=-Oe,it=-it),Fe.b=d(Oe,We.b,it,Ye.b)):(Oe=c(Ve,We,Ye),it=-c(Ve,Ie,Ye),0>Oe+it&&(Oe=-Oe,it=-it),Fe.b=d(Oe,We.b,it,Ie.b)):Fe.b=(We.b+Ye.b)/2,a(Ve,Ye)||(Oe=Ve,Ve=Ye,Ye=Oe),a(We,Ie)||(Oe=We,We=Ie,Ie=Oe),a(Ve,We)||(Oe=Ve,Ve=We,We=Oe,Oe=Ye,Ye=Ie,Ie=Oe),a(We,Ye)?a(Ye,Ie)?(Oe=n(Ve,We,Ye),it=n(We,Ye,Ie),0>Oe+it&&(Oe=-Oe,it=-it),Fe.a=d(Oe,We.a,it,Ye.a)):(Oe=o(Ve,We,Ye),it=-o(Ve,Ie,Ye),0>Oe+it&&(Oe=-Oe,it=-it),Fe.a=d(Oe,We.a,it,Ie.a)):Fe.a=(We.a+Ye.a)/2,s(Fe,W.a)&&(Fe.b=W.a.b,Fe.a=W.a.a),Ve=s(Pe,ge)?Pe:ge,s(Ve,Fe)&&(Fe.b=Ve.b,Fe.a=Ve.a),i(Fe,Pe)||i(Fe,ge))return q(W,ne),!1;if(!i(be,W.a)&&0<=c(be,W.a,Fe)||!i(Ce,W.a)&&0>=c(Ce,W.a,Fe)){if(Ce===W.a)return g(he.b),_(we.b,he),ne=F(ne),he=nt(ne).a,B(W,nt(ne),ue),z(W,ne,ee(he),he,he,!0),!0;if(be===W.a){g(we.b),_(he.e,ee(we)),Pe=ue=ne,ge=Pe.a.b.a;do Pe=qe(Pe);while(Pe.a.b.a===ge);return ne=Pe,Pe=nt(ne).a.b.c,ue.a=ee(we),we=B(W,ue,null),z(W,ne,we.c,he.b.c,Pe,!0),!0}return 0<=c(be,W.a,Fe)&&(qe(ne).b=ne.b=!0,g(he.b),he.a.b=W.a.b,he.a.a=W.a.a),0>=c(Ce,W.a,Fe)&&(ne.b=ue.b=!0,g(we.b),we.a.b=W.a.b,we.a.a=W.a.a),!1}return g(he.b),g(we.b),_(ee(we),he),he.a.b=Fe.b,he.a.a=Fe.a,he.a.h=ae(W.e,he.a),he=he.a,we=[0,0,0,0],Fe=[Pe.d,be.d,ge.d,Ce.d],he.g[0]=he.g[1]=he.g[2]=0,U(he,Pe,be,we,0),U(he,ge,Ce,we,2),b(W,he,Fe,we,!0),qe(ne).b=ne.b=ue.b=!0,!1}function Y(W,ne){for(var ue=nt(ne);;){for(;ue.b;)ne=ue,ue=nt(ue);if(!ne.b&&(ue=ne,ne=qe(ne),ne===null||!ne.b))break;ne.b=!1;var he=ne.a,we=ue.a,Pe;if(Pe=he.b.a!==we.b.a)e:{Pe=ne;var ge=nt(Pe),be=Pe.a,Ce=ge.a,Fe=void 0;if(s(be.b.a,Ce.b.a)){if(0>c(be.b.a,Ce.b.a,be.a)){Pe=!1;break e}qe(Pe).b=Pe.b=!0,Fe=g(be),_(Ce.b,Fe),Fe.d.c=Pe.d}else{if(0<c(Ce.b.a,be.b.a,Ce.a)){Pe=!1;break e}Pe.b=ge.b=!0,Fe=g(Ce),_(be.e,Ce.b),Fe.b.d.c=Pe.d}Pe=!0}if(Pe&&(ue.c?(L(ue),f(we),ue=nt(ne),we=ue.a):ne.c&&(L(ne),f(he),ne=qe(ue),he=ne.a)),he.a!==we.a){if(he.b.a===we.b.a||ne.c||ue.c||he.b.a!==W.a&&we.b.a!==W.a)q(W,ne);else if(j(W,ne))break}he.a===we.a&&he.b.a===we.b.a&&(T(we,he),L(ne),f(he),ne=qe(ue))}}function J(W,ne){W.a=ne;for(var ue=ne.c;ue.i===null;)if(ue=ue.c,ue===ne.c){var ue=W,he=ne,ge=new Je;ge.a=he.c.b;var we=ue.f,be=we.a;do be=be.a;while(be.b!==null&&!we.c(we.b,ge,be.b));var we=be.b,Pe=nt(we),ge=we.a,be=Pe.a;if(c(ge.b.a,he,ge.a)===0)ge=we.a,i(ge.a,he)||i(ge.b.a,he)||(g(ge.b),we.c&&(f(ge.c),we.c=!1),_(he.c,ge),J(ue,he));else{var Ce=s(be.b.a,ge.b.a)?we:Pe,Pe=void 0;we.d||Ce.c?(Ce===we?Pe=x(he.c.b,ge.e):Pe=x(be.b.c.b,he.c).b,Ce.c?A(Ce,Pe):(ge=ue,we=K(ue,we,Pe),we.f=qe(we).f+we.a.f,we.d=Q(ge,we.f)),J(ue,he)):z(ue,we,he.c,he.c,null,!0)}return}if(ue=F(ue.i),ge=nt(ue),we=ge.a,ge=B(W,ge,null),ge.c===we){var we=ge,ge=we.c,be=nt(ue),Pe=ue.a,Ce=be.a,Fe=!1;Pe.b.a!==Ce.b.a&&j(W,ue),i(Pe.a,W.a)&&(_(ee(ge),Pe),ue=F(ue),ge=nt(ue).a,B(W,nt(ue),be),Fe=!0),i(Ce.a,W.a)&&(_(we,ee(Ce)),we=B(W,be,null),Fe=!0),Fe?z(W,ue,we.c,ge,ge,!0):(s(Ce.a,Pe.a)?he=ee(Ce):he=Pe,he=x(we.c.b,he),z(W,ue,he,he.c,he.c,!1),he.b.i.c=!0,Y(W,ue))}else z(W,ue,ge.c,we,we,!0)}function se(W,ne){var ue=new Je,he=h(W.b);he.a.b=v,he.a.a=ne,he.b.a.b=-v,he.b.a.a=ne,W.a=he.b.a,ue.a=he,ue.f=0,ue.d=!1,ue.c=!1,ue.h=!0,ue.b=!1,he=W.f,he=_e(he,he.a,ue),ue.e=he}function pe(W){this.a=new Ee,this.b=W,this.c=k}function _e(W,ne,ue){do ne=ne.c;while(ne.b!==null&&!W.c(W.b,ne.b,ue));return W=new Ee(ue,ne.a,ne),ne.a.c=W,ne.a=W}function Ee(W,ne,ue){this.b=W||null,this.a=ne||this,this.c=ue||this}function X(){this.d=D,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}var D=0;e=X.prototype,e.x=function(){te(this,D)},e.B=function(W,ne){switch(W){case 100142:return;case 100140:switch(ne){case 100130:case 100131:case 100132:case 100133:case 100134:this.s=ne;return}break;case 100141:this.m=!!ne;return;default:re(this,100900);return}re(this,100901)},e.y=function(W){switch(W){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:re(this,100900)}return!1},e.A=function(W,ne,ue){this.j[0]=W,this.j[1]=ne,this.j[2]=ue},e.z=function(W,ne){var ue=ne||null;switch(W){case 100100:case 100106:this.h=ue;break;case 100104:case 100110:this.l=ue;break;case 100101:case 100107:this.k=ue;break;case 100102:case 100108:this.i=ue;break;case 100103:case 100109:this.p=ue;break;case 100105:case 100111:this.o=ue;break;case 100112:this.r=ue;break;default:re(this,100900)}},e.C=function(W,ne){var ue=!1,he=[0,0,0];te(this,2);for(var we=0;3>we;++we){var Pe=W[we];-1e150>Pe&&(Pe=-1e150,ue=!0),1e150<Pe&&(Pe=1e150,ue=!0),he[we]=Pe}ue&&re(this,100155),ue=this.q,ue===null?(ue=h(this.b),_(ue,ue.b)):(g(ue),ue=ue.e),ue.a.d=ne,ue.a.g[0]=he[0],ue.a.g[1]=he[1],ue.a.g[2]=he[2],ue.f=1,ue.b.f=-1,this.q=ue},e.u=function(W){te(this,D),this.d=1,this.b=new le,this.c=W},e.t=function(){te(this,1),this.d=2,this.q=null},e.v=function(){te(this,2),this.d=1},e.w=function(){te(this,1),this.d=D;var W=this.j[0],ne=this.j[1],ue=this.j[2],he=!1,we=[W,ne,ue];if(W===0&&ne===0&&ue===0){for(var ne=[-2*1e150,-2*1e150,-2*1e150],Pe=[2*1e150,2*1e150,2*1e150],ue=[],ge=[],he=this.b.c,W=he.e;W!==he;W=W.e)for(var be=0;3>be;++be){var Ce=W.g[be];Ce<Pe[be]&&(Pe[be]=Ce,ge[be]=W),Ce>ne[be]&&(ne[be]=Ce,ue[be]=W)}if(W=0,ne[1]-Pe[1]>ne[0]-Pe[0]&&(W=1),ne[2]-Pe[2]>ne[W]-Pe[W]&&(W=2),Pe[W]>=ne[W])we[0]=0,we[1]=0,we[2]=1;else{for(ne=0,Pe=ge[W],ue=ue[W],ge=[0,0,0],Pe=[Pe.g[0]-ue.g[0],Pe.g[1]-ue.g[1],Pe.g[2]-ue.g[2]],be=[0,0,0],W=he.e;W!==he;W=W.e)be[0]=W.g[0]-ue.g[0],be[1]=W.g[1]-ue.g[1],be[2]=W.g[2]-ue.g[2],ge[0]=Pe[1]*be[2]-Pe[2]*be[1],ge[1]=Pe[2]*be[0]-Pe[0]*be[2],ge[2]=Pe[0]*be[1]-Pe[1]*be[0],Ce=ge[0]*ge[0]+ge[1]*ge[1]+ge[2]*ge[2],Ce>ne&&(ne=Ce,we[0]=ge[0],we[1]=ge[1],we[2]=ge[2]);0>=ne&&(we[0]=we[1]=we[2]=0,we[y(Pe)]=1)}he=!0}for(ge=y(we),W=this.b.c,ne=(ge+1)%3,ue=(ge+2)%3,ge=0<we[ge]?1:-1,we=W.e;we!==W;we=we.e)we.b=we.g[ne],we.a=ge*we.g[ue];if(he){for(we=0,he=this.b.a,W=he.b;W!==he;W=W.b)if(ne=W.a,!(0>=ne.f))do we+=(ne.a.b-ne.b.a.b)*(ne.a.a+ne.b.a.a),ne=ne.e;while(ne!==W.a);if(0>we)for(we=this.b.c,he=we.e;he!==we;he=he.e)he.a=-he.a}for(this.n=!1,we=this.b.b,W=we.h;W!==we;W=he)he=W.h,ne=W.e,i(W.a,W.b.a)&&W.e.e!==W&&(N(this,ne,W),f(W),W=ne,ne=W.e),ne.e===W&&(ne!==W&&((ne===he||ne===he.b)&&(he=he.h),f(ne)),(W===he||W===he.b)&&(he=he.h),f(W));for(this.e=we=new I,he=this.b.c,W=he.e;W!==he;W=W.e)W.h=ae(we,W);for(O(we),this.f=new pe(this),se(this,-v),se(this,v);(we=me(this.e))!==null;){for(;;){e:if(W=this.e,W.a===0)he=Xe(W.b);else if(he=W.c[W.d[W.a-1]],W.b.a!==0&&(W=Xe(W.b),s(W,he))){he=W;break e}if(he===null||!i(he,we))break;he=me(this.e),N(this,we.c,he.c)}J(this,we)}for(this.a=this.f.a.a.b.a.a,we=0;(he=this.f.a.a.b)!==null;)he.h||++we,L(he);for(this.f=null,we=this.e,we.b=null,we.d=null,this.e=we.c=null,we=this.b,W=we.a.b;W!==we.a;W=he)he=W.b,W=W.a,W.e.e===W&&(T(W.c,W),f(W));if(!this.n){if(we=this.b,this.m)for(W=we.b.h;W!==we.b;W=he)he=W.h,W.b.d.c!==W.d.c?W.f=W.d.c?1:-1:f(W);else for(W=we.a.b;W!==we.a;W=he)if(he=W.b,W.c){for(W=W.a;s(W.b.a,W.a);W=W.c.b);for(;s(W.a,W.b.a);W=W.e);for(ne=W.c.b,ue=void 0;W.e!==ne;)if(s(W.b.a,ne.a)){for(;ne.e!==W&&(l(ne.e)||0>=c(ne.a,ne.b.a,ne.e.b.a));)ue=x(ne.e,ne),ne=ue.b;ne=ne.c.b}else{for(;ne.e!==W&&(r(W.c.b)||0<=c(W.b.a,W.a,W.c.b.a));)ue=x(W,W.c.b),W=ue.b;W=W.e}for(;ne.e.e!==W;)ue=x(ne.e,ne),ne=ue.b}if(this.h||this.i||this.k||this.l)if(this.m){for(we=this.b,he=we.a.b;he!==we.a;he=he.b)if(he.c){this.h&&this.h(2,this.c),W=he.a;do this.k&&this.k(W.a.d,this.c),W=W.e;while(W!==he.a);this.i&&this.i(this.c)}}else{for(we=this.b,he=!!this.l,W=!1,ne=-1,ue=we.a.d;ue!==we.a;ue=ue.d)if(ue.c){W||(this.h&&this.h(4,this.c),W=!0),ge=ue.a;do he&&(Pe=ge.b.d.c?0:1,ne!==Pe&&(ne=Pe,this.l&&this.l(!!ne,this.c))),this.k&&this.k(ge.a.d,this.c),ge=ge.e;while(ge!==ue.a)}W&&this.i&&this.i(this.c)}if(this.r){for(we=this.b,W=we.a.b;W!==we.a;W=he)if(he=W.b,!W.c){ne=W.a,ue=ne.e,ge=void 0;do ge=ue,ue=ge.e,ge.d=null,ge.b.d===null&&(ge.c===ge?u(ge.a,null):(ge.a.c=ge.c,S(ge,ee(ge))),Pe=ge.b,Pe.c===Pe?u(Pe.a,null):(Pe.a.c=Pe.c,S(Pe,ee(Pe))),C(ge));while(ge!==ne);ne=W.d,W=W.b,W.d=ne,ne.b=W}this.r(this.b),this.c=this.b=null;return}}this.b=this.c=null};function te(W,ne){if(W.d!==ne)for(;W.d!==ne;)if(W.d<ne)switch(W.d){case D:re(W,100151),W.u(null);break;case 1:re(W,100152),W.t()}else switch(W.d){case 2:re(W,100154),W.v();break;case 1:re(W,100153),W.w()}}function re(W,ne){W.p&&W.p(ne,W.c)}function oe(W,ne){this.b=W||this,this.d=ne||this,this.a=null,this.c=!1}function ve(){this.h=this,this.i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function ee(W){return W.b.e}function le(){this.c=new H,this.a=new oe,this.b=new ve,this.d=new ve,this.b.b=this.d,this.d.b=this.b}function H(W,ne){this.e=W||this,this.f=ne||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function I(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new Ae}function O(W){W.d=[];for(var ne=0;ne<W.a;ne++)W.d[ne]=ne;W.d.sort(function(ue){return function(he,we){return s(ue[he],ue[we])?1:-1}}(W.c)),W.e=!0,Ge(W.b)}function ae(W,ne){if(W.e){var ue=W.b,he=++ue.a;2*he>ue.f&&(ue.f*=2,ue.c=Se(ue.c,ue.f+1));var we;return ue.b===0?we=he:(we=ue.b,ue.b=ue.c[ue.b]),ue.e[we]=ne,ue.c[we]=he,ue.d[he]=we,ue.h&&He(ue,he),we}return ue=W.a++,W.c[ue]=ne,-(ue+1)}function me(W){if(W.a===0)return Ue(W.b);var ne=W.c[W.d[W.a-1]];if(W.b.a!==0&&s(Xe(W.b),ne))return Ue(W.b);do--W.a;while(0<W.a&&W.c[W.d[W.a-1]]===null);return ne}function Ae(){this.d=Se([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function Se(W,ne){for(var ue=Array(ne),he=0;he<W.length;he++)ue[he]=W[he];for(;he<ne;he++)ue[he]=0;return ue}function Ge(W){for(var ne=W.a;1<=ne;--ne)Ze(W,ne);W.h=!0}function Xe(W){return W.e[W.d[1]]}function Ue(W){var ne=W.d,ue=W.e,he=W.c,we=ne[1],Pe=ue[we];return 0<W.a&&(ne[1]=ne[W.a],he[ne[1]]=1,ue[we]=null,he[we]=W.b,W.b=we,0<--W.a&&Ze(W,1)),Pe}function Ze(W,ne){for(var ue=W.d,he=W.e,we=W.c,Pe=ne,ge=ue[Pe];;){var be=Pe<<1;be<W.a&&s(he[ue[be+1]],he[ue[be]])&&(be+=1);var Ce=ue[be];if(be>W.a||s(he[ge],he[Ce])){ue[Pe]=ge,we[ge]=Pe;break}ue[Pe]=Ce,we[Ce]=Pe,Pe=be}}function He(W,ne){for(var ue=W.d,he=W.e,we=W.c,Pe=ne,ge=ue[Pe];;){var be=Pe>>1,Ce=ue[be];if(be===0||s(he[Ce],he[ge])){ue[Pe]=ge,we[ge]=Pe;break}ue[Pe]=Ce,we[Ce]=Pe,Pe=be}}function Je(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function nt(W){return W.e.c.b}function qe(W){return W.e.a.b}return this.libtess={GluTesselator:X,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},X.prototype.gluDeleteTess=X.prototype.x,X.prototype.gluTessProperty=X.prototype.B,X.prototype.gluGetTessProperty=X.prototype.y,X.prototype.gluTessNormal=X.prototype.A,X.prototype.gluTessCallback=X.prototype.z,X.prototype.gluTessVertex=X.prototype.C,X.prototype.gluTessBeginPolygon=X.prototype.u,X.prototype.gluTessBeginContour=X.prototype.t,X.prototype.gluTessEndContour=X.prototype.v,X.prototype.gluTessEndPolygon=X.prototype.w,typeof module<"u"&&(module.exports=this.libtess),this.libtess}).apply(new Object),TrackyMouse={dependenciesRoot:"./tracky-mouse"};TrackyMouse.loadDependencies=function(){TrackyMouse.dependenciesRoot=TrackyMouse.dependenciesRoot.replace(/\/+$/,"");const e=s=>new Promise((t,c)=>{const a=document.createElement("script");a.type="text/javascript",a.onload=t,a.onerror=c,a.src=s,document.head.append(a)}),i=[`${TrackyMouse.dependenciesRoot}/lib/no-eval.js`,`${TrackyMouse.dependenciesRoot}/lib/clmtrackr.js`,`${TrackyMouse.dependenciesRoot}/lib/stats.js`];return Promise.all(i.map(e))};const is_selector_valid=(e=>i=>{try{e.querySelector(i)}catch{return!1}return!0})(document.createDocumentFragment());let clean_up_dwell_clicking=()=>{};const init_dwell_clicking=e=>{if(typeof e!="object")throw new Error("configuration object required for initDwellClicking");if(e.targets===void 0)throw new Error("config.targets is required (must be a CSS selector)");if(typeof e.targets!="string")throw new Error("config.targets must be a string (a CSS selector)");if(!is_selector_valid(e.targets))throw new Error("config.targets is not a valid CSS selector");if(e.click===void 0)throw new Error("config.click is required");if(typeof e.click!="function")throw new Error("config.click must be a function");if(e.shouldDrag!==void 0&&typeof e.shouldDrag!="function")throw new Error("config.shouldDrag must be a function");if(e.noCenter!==void 0&&typeof e.noCenter!="function")throw new Error("config.noCenter must be a function");if(e.isEquivalentTarget!==void 0&&typeof e.isEquivalentTarget!="function")throw new Error("config.isEquivalentTarget must be a function");if(e.dwellClickEvenIfPaused!==void 0&&typeof e.dwellClickEvenIfPaused!="function")throw new Error("config.dwellClickEvenIfPaused must be a function");if(e.beforeDispatch!==void 0&&typeof e.beforeDispatch!="function")throw new Error("config.beforeDispatch must be a function");if(e.afterDispatch!==void 0&&typeof e.afterDispatch!="function")throw new Error("config.afterDispatch must be a function");if(e.beforePointerDownDispatch!==void 0&&typeof e.beforePointerDownDispatch!="function")throw new Error("config.beforePointerDownDispatch must be a function");if(e.isHeld!==void 0&&typeof e.isHeld!="function")throw new Error("config.isHeld must be a function");if(e.retarget!==void 0){if(!Array.isArray(e.retarget))throw new Error("config.retarget must be an array of objects");for(let Z=0;Z<e.retarget.length;Z++){const B=e.retarget[Z];if(typeof B!="object")throw new Error("config.retarget must be an array of objects");if(B.from===void 0)throw new Error(`config.retarget[${Z}].from is required`);if(B.to===void 0)throw new Error(`config.retarget[${Z}].to is required (although can be null to ignore the element)`);if(B.withinMargin!==void 0&&typeof B.withinMargin!="number")throw new Error(`config.retarget[${Z}].withinMargin must be a number`);if(typeof B.from!="string"&&typeof B.from!="function"&&!(B.from instanceof Element))throw new Error(`config.retarget[${Z}].from must be a CSS selector string, an Element, or a function`);if(typeof B.to!="string"&&typeof B.to!="function"&&!(B.to instanceof Element)&&B.to!==null)throw new Error(`config.retarget[${Z}].to must be a CSS selector string, an Element, a function, or null`);if(typeof B.from=="string"&&!is_selector_valid(B.from))throw new Error(`config.retarget[${Z}].from is not a valid CSS selector`);if(typeof B.to=="string"&&!is_selector_valid(B.to))throw new Error(`config.retarget[${Z}].to is not a valid CSS selector`)}}const i=50,s=500,t=500,c=1500,a=1e3,n=1e3,o=1e3,l=1e3;let r=[],d=performance.now(),h=!1,_,f=null;const g=Z=>{d=Math.max(d,performance.now()+Z)};g(c);const x=document.createElement("div");x.className="tracky-mouse-hover-halo",x.style.display="none",document.body.appendChild(x);const w=document.createElement("div");w.className="tracky-mouse-dwell-indicator",w.style.width=`${i}px`,w.style.height=`${i}px`,w.style.display="none",document.body.appendChild(w);const S=Z=>{r.push({x:Z.clientX,y:Z.clientY,time:performance.now()})},M=Z=>{g(a),f=null};let R=document.visibilityState==="visible",C=!0;const u=()=>{R=!0,g(l)},m=()=>{R=!1},y=()=>{C=!1},v=()=>{C=!0};window.addEventListener("pointermove",S),window.addEventListener("pointerup",M),window.addEventListener("pointercancel",M),window.addEventListener("focus",u),window.addEventListener("blur",m),document.addEventListener("mouseleave",y),document.addEventListener("mouseenter",v);const T=(Z,B)=>{var U;if(!R||!C)return null;let z=document.elementFromPoint(Z,B);if(!z)return null;let b={x:Z,y:B,time:performance.now()},N=!1;for(const{from:q,to:j,withinMargin:Y=1/0}of e.retarget??[])if(q instanceof Element?q===z:typeof q=="function"?q(z):z.matches(q)){const J=j instanceof Element||j===null?j:typeof j=="function"?j(z):z.closest(j)||z.querySelector(j);if(J===null)return null;if(J){const se=J.getBoundingClientRect();b.x>se.left-Y&&b.y>se.top-Y&&b.x<se.right+Y&&b.y<se.bottom+Y&&(z=J,b.x=Math.min(se.right-1,Math.max(se.left,b.x)),b.y=Math.min(se.bottom-1,Math.max(se.top,b.y)),N=!0)}}if(!N&&(z=z.closest(e.targets),!z))return null;if(!((U=e.noCenter)!=null&&U.call(e,z))){const q=z.getBoundingClientRect();b.x=q.left+q.width/2,b.y=q.top+q.height/2}return b.target=z,b},k=({x:Z,y:B})=>({view:window,clientX:Z,clientY:B,pointerId:1234567890,pointerType:"mouse",isPrimary:!0,bubbles:!0,cancelable:!0}),L=Z=>{const B={x:0,y:0};for(const z of Z)B.x+=z.x,B.y+=z.y;return B.x/=Z.length,B.y/=Z.length,B},A=()=>{var B,z,b,N,U,q,j,Y,J,se,pe,_e,Ee,X,D;const Z=performance.now();if(r=r.filter(te=>Z<te.time+t),r.length){const te=r[r.length-1];r.push({x:te.x,y:te.y,time:Z});const re=L(r),oe=Math.hypot(te.x-re.x,te.y-re.y);if(_&&!f){const I=T(_.x,_.y),O=ae=>{const me=document.createElement("div"),Ae=ae.getBoundingClientRect(),Se=4;me.style.pointerEvents="none",me.style.zIndex=1000001,me.style.display="block",me.style.position="fixed",me.style.left=`${Ae.left+Se}px`,me.style.top=`${Ae.top+Se}px`,me.style.width=`${Ae.width-Se*2}px`,me.style.height=`${Ae.height-Se*2}px`,me.style.outline=`${Se}px dashed red`,me.style.boxShadow=`0 0 ${Se}px ${Se}px maroon`,document.body.appendChild(me),setTimeout(()=>{me.remove()},o*.5)};if(I)I.target!==_.target&&!((B=e.isEquivalentTarget)!=null&&B.call(e,I.target,_.target))&&(_=null,g(o),O(I.target));else{let ae=document.elementFromPoint(_.x,_.y);_=null,g(o),O(ae||document.body)}}let ve=te,ee=0,le=0;_&&(ve=_,ee=.4,le=(_.time-Z+s)/s*i,Z>_.time+s&&((z=e.isHeld)!=null&&z.call(e)||f?((b=e.beforeDispatch)==null||b.call(e),_.target.dispatchEvent(new PointerEvent("pointerup",Object.assign(k(_),{button:0,buttons:0}))),(N=e.afterDispatch)==null||N.call(e)):((U=e.beforePointerDownDispatch)==null||U.call(e),(q=e.beforeDispatch)==null||q.call(e),_.target.dispatchEvent(new PointerEvent("pointerdown",Object.assign(k(_),{button:0,buttons:1}))),(j=e.afterDispatch)==null||j.call(e),(Y=e.shouldDrag)!=null&&Y.call(e,_.target)?f=_.target:((J=e.beforeDispatch)==null||J.call(e),_.target.dispatchEvent(new PointerEvent("pointerup",Object.assign(k(_),{button:0,buttons:0}))),e.click(_),(se=e.afterDispatch)==null||se.call(e))),_=null,g(n))),f?w.classList.add("tracky-mouse-for-release"):w.classList.remove("tracky-mouse-for-release"),w.style.display="",w.style.opacity=ee,w.style.transform=`scale(${le/i})`,w.style.left=`${ve.x-i/2}px`,w.style.top=`${ve.y-i/2}px`;let H=f||(_||T(te.x,te.y)||{}).target;if(H&&(!h||(pe=e.dwellClickEvenIfPaused)!=null&&pe.call(e,H))){let I=H.getBoundingClientRect();const O=getComputedStyle(H);let ae=H,me=1;for(;ae instanceof HTMLElement;){const Ae=getComputedStyle(ae);if(Ae.transform){const Se=Ae.transform.match(/(?:scale|matrix)\((\d+(?:\.\d+)?)/);Se&&(me*=Number(Se[1]))}if(Ae.overflow!=="visible"){const Se=ae.getBoundingClientRect();I={left:Math.max(I.left,Se.left),top:Math.max(I.top,Se.top),right:Math.min(I.right,Se.right),bottom:Math.min(I.bottom,Se.bottom)},I.width=I.right-I.left,I.height=I.bottom-I.top}ae=ae.parentNode}x.style.display="block",x.style.position="fixed",x.style.left=`${I.left}px`,x.style.top=`${I.top}px`,x.style.width=`${I.width}px`,x.style.height=`${I.height}px`;for(const Ae of["borderTopRightRadius","borderTopLeftRadius","borderBottomRightRadius","borderBottomLeftRadius"])O[Ae].endsWith("px")?x.style[Ae]=`${parseFloat(O[Ae])*me}px`:x.style[Ae]=O[Ae]}else x.style.display="none";if(Z<d)return;oe<5&&(_||(_={x:re.x,y:re.y,time:performance.now(),target:f||null},f||(_=T(_.x,_.y)),_&&h&&!((_e=e.dwellClickEvenIfPaused)!=null&&_e.call(e,_.target))&&(_=null))),oe>100&&f&&((Ee=e.beforeDispatch)==null||Ee.call(e),window.dispatchEvent(new PointerEvent("pointerup",Object.assign(k(re),{button:0,buttons:0}))),(X=e.afterDispatch)==null||X.call(e),(D=e.afterReleaseDrag)==null||D.call(e)),oe>60&&(_=null)}};let F;const K=()=>{F=requestAnimationFrame(K),A()};return F=requestAnimationFrame(K),clean_up_dwell_clicking=()=>{cancelAnimationFrame(F),x.remove(),w.remove(),window.removeEventListener("pointermove",S),window.removeEventListener("pointerup",M),window.removeEventListener("pointercancel",M),window.removeEventListener("focus",u),window.removeEventListener("blur",m),document.removeEventListener("mouseleave",y),document.removeEventListener("mouseenter",v),clean_up_dwell_clicking=()=>{}},{get paused(){return h},set paused(Z){h=Z}}};TrackyMouse.initDwellClicking=function(e){return init_dwell_clicking(e)};TrackyMouse.cleanupDwellClicking=function(){clean_up_dwell_clicking()};TrackyMouse.init=function(e){var i=e||document.createElement("div");i.classList.add("tracky-mouse-ui"),i.innerHTML=`
		<div class="tracky-mouse-controls">
			<button class="tracky-mouse-start-stop-button" aria-pressed="false" aria-keyshortcuts="F9">Start</button>
			<br>
			<br>
			<label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Horizontal Sensitivity</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="25" class="tracky-mouse-sensitivity-x">
					<span class="tracky-mouse-min-label">Slow</span>
					<span class="tracky-mouse-max-label">Fast</span>
				</span>
			</label>
			<label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Vertical Sensitivity</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="50" class="tracky-mouse-sensitivity-y">
					<span class="tracky-mouse-min-label">Slow</span>
					<span class="tracky-mouse-max-label">Fast</span>
				</span>
			</label>
			<!-- <label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Smoothing</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="50" class="tracky-mouse-smoothing">
					<span class="tracky-mouse-min-label"></span>
					<span class="tracky-mouse-max-label"></span>
				</span>
			</label> -->
			<label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Acceleration</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="50" class="tracky-mouse-acceleration">
					<!-- TODO: "Linear" could be described as "Fast", and the other "Fast" labels are on the other side. Should it be swapped? What does other software with acceleration control look like? In Windows it's just a checkbox apparently, but it could go as far as a custom curve editor. -->
					<span class="tracky-mouse-min-label">Linear</span>
					<span class="tracky-mouse-max-label">Smooth</span>
				</span>
			</label>
			<!-- <label class="tracky-mouse-control-row">
				<span class="tracky-mouse-label-text">Easy Stop (min distance to move)</span>
				<span class="tracky-mouse-labeled-slider">
					<input type="range" min="0" max="100" value="50" class="tracky-mouse-min-distance">
					<span class="tracky-mouse-min-label">Jittery</span>
					<span class="tracky-mouse-max-label">Steady</span>
				</span>
			</label> -->
			<br>
			<!-- special interest: jspaint wants label not to use parent-child relationship so that os-gui's 98.css checkbox styles can work -->
			<!-- though this option might not be wanted in jspaint; might be good to hide it in the embedded case, or make it optional -->
			<!-- also TODO: add description of what this is for: on Windows, currently, when buttons are swapped at the system level, it affects serenade-driver's click() -->
			<!-- also this may be seen as a weirdly named/designed option for right-clicking -->
			<!-- btw: label is selected based on 'for' attribute -->
			<div class="tracky-mouse-control-row">
				<input type="checkbox" id="tracky-mouse-swap-mouse-buttons"/>
				<label for="tracky-mouse-swap-mouse-buttons"><span class="tracky-mouse-label-text">Swap mouse buttons</span></label>
			</div>
			<br>
			<!-- special interest: jspaint wants label not to use parent-child relationship so that os-gui's 98.css checkbox styles can work -->
			<!-- opposite, "Start paused", might be clearer, especially if I add a "pause" button -->
			<div class="tracky-mouse-control-row">
				<input type="checkbox" id="tracky-mouse-start-enabled"/>
				<label for="tracky-mouse-start-enabled"><span class="tracky-mouse-label-text">Start enabled</span></label>
			</div>
			<br>
			<!-- special interest: jspaint wants label not to use parent-child relationship so that os-gui's 98.css checkbox styles can work -->
			<div class="tracky-mouse-control-row">
				<input type="checkbox" id="tracky-mouse-run-at-login"/>
				<label for="tracky-mouse-run-at-login"><span class="tracky-mouse-label-text">Run at login</span></label>
			</div>
			<br>
			<!-- special interest: jspaint wants label not to use parent-child relationship so that os-gui's 98.css checkbox styles can work -->
			<!-- TODO: try moving this to the corner of the camera view, so it's clearer it applies only to the camera view -->
			<div class="tracky-mouse-control-row">
				<input type="checkbox" checked id="tracky-mouse-mirror"/>
				<label for="tracky-mouse-mirror"><span class="tracky-mouse-label-text">Mirror</span></label>
			</div>
			<br>
		</div>
		<div class="tracky-mouse-canvas-container-container">
			<div class="tracky-mouse-canvas-container">
				<div class="tracky-mouse-canvas-overlay">
					<button class="tracky-mouse-use-camera-button">Allow Camera Access</button>
					<!--<button class="tracky-mouse-use-camera-button">Use my camera</button>-->
					<button class="tracky-mouse-use-demo-footage-button" hidden>Use demo footage</button>
					<div class="tracky-mouse-error-message" role="alert" hidden></div>
				</div>
				<canvas class="tracky-mouse-canvas"></canvas>
			</div>
		</div>
		<p class="tracky-mouse-desktop-app-download-message">
			You can control your entire computer with the <a href="https://trackymouse.js.org/">TrackyMouse</a> desktop app.
		</p>
	`,e||document.body.appendChild(i);var s=i.querySelector(".tracky-mouse-start-stop-button"),t=i.querySelector("#tracky-mouse-mirror"),c=i.querySelector("#tracky-mouse-swap-mouse-buttons"),a=i.querySelector("#tracky-mouse-start-enabled"),n=i.querySelector("#tracky-mouse-run-at-login"),o=i.querySelector("label[for='tracky-mouse-swap-mouse-buttons']"),l=i.querySelector(".tracky-mouse-sensitivity-x"),r=i.querySelector(".tracky-mouse-sensitivity-y"),d=i.querySelector(".tracky-mouse-acceleration"),h=i.querySelector(".tracky-mouse-use-camera-button"),_=i.querySelector(".tracky-mouse-use-demo-footage-button"),f=i.querySelector(".tracky-mouse-error-message"),g=i.querySelector(".tracky-mouse-canvas-container"),x=i.querySelector(".tracky-mouse-desktop-app-download-message");window.electronAPI?(x.hidden=!0,window.electronAPI.getIsPackaged().then(Ie=>{n.disabled=!Ie})):(c.parentElement.hidden=!0,n.parentElement.hidden=!0);var w=i.querySelector(".tracky-mouse-canvas"),S=w.getContext("2d"),M=document.createElement("div");M.className="tracky-mouse-pointer",M.style.display="none",document.body.appendChild(M);var R=document.createElement("video");if(R.setAttribute("playsinline",""),typeof Stats<"u"){var C=new Stats;C.domElement.style.position="absolute",C.domElement.style.top="0px",C.domElement.style.right="0px",C.domElement.style.left="",document.body.appendChild(C.domElement)}var u=640,m=480,y=1e3,v=0,T=0,k=0,L=0,A=[],F,K,Q,Z,B=0,z=.5,b=0,N=!0,U=!0,q,j,Y,J,se=!0,pe=se,_e=!0,Ee={maxContinuousChecks:5,detectionConfidence:.9,maxFaces:1,iouThreshold:.3,scoreThreshold:.75},X,D=!1,te=!0,re=!1,oe=0,ve,ee,le=.7,H=0,I,O;let ae,me;const Ae=()=>{me&&me.terminate(),re=!1,te=!0,D=!1,me=new Worker(`${TrackyMouse.dependenciesRoot}/facemesh.worker.js`),me.addEventListener("message",Ie=>{Ie.data.type==="LOADED"&&(D=!0,ee=()=>{const Oe=ae;if(Oe)return me.postMessage({type:"ESTIMATE_FACES",imageData:Oe}),new Promise((it,at)=>{me.addEventListener("message",ht=>{ht.data.type==="ESTIMATED_FACES"&&it(ht.data.predictions)},{once:!0})})})},{once:!0}),me.postMessage({type:"LOAD",options:Ee})};Ae();function Se(Ie,Oe=!1){"globalSettings"in Ie&&(Ie.globalSettings.swapMouseButtons!==void 0&&(J=Ie.globalSettings.swapMouseButtons,c.checked=J),Ie.globalSettings.mirrorCameraView!==void 0&&(q=Ie.globalSettings.mirrorCameraView,t.checked=q),Ie.globalSettings.headTrackingSensitivityX!==void 0&&(F=Ie.globalSettings.headTrackingSensitivityX,l.value=F*1e3),Ie.globalSettings.headTrackingSensitivityY!==void 0&&(K=Ie.globalSettings.headTrackingSensitivityY,r.value=K*1e3),Ie.globalSettings.headTrackingAcceleration!==void 0&&(Q=Ie.globalSettings.headTrackingAcceleration,d.value=Q*100),Ie.globalSettings.startEnabled!==void 0&&(j=Ie.globalSettings.startEnabled,a.checked=j,Oe&&(N=!j)),Ie.globalSettings.runAtLogin!==void 0&&(Y=Ie.globalSettings.runAtLogin,n.checked=Y))}const Ge=1,Xe="tracky-mouse-settings";function Ue(){return{formatVersion:Ge,formatName:Xe,globalSettings:{startEnabled:j,runAtLogin:Y,swapMouseButtons:J,mirrorCameraView:q,headTrackingSensitivityX:F,headTrackingSensitivityY:K,headTrackingAcceleration:Q}}}const Ze=Ie=>{if(window.electronAPI)window.electronAPI.setOptions(Ie);else try{localStorage.setItem("tracky-mouse-settings",JSON.stringify(Ue(),null,"	"))}catch(Oe){console.error(Oe)}},He=async(Ie=!1)=>{if(window.electronAPI)Se(await window.electronAPI.getOptions(),Ie);else try{localStorage.getItem("tracky-mouse-settings")&&Se(JSON.parse(localStorage.getItem("tracky-mouse-settings")),Ie)}catch(Oe){console.error(Oe)}};l.onchange=Ie=>{F=l.value/1e3,Ie&&Ze({globalSettings:{headTrackingSensitivityX:F}})},r.onchange=Ie=>{K=r.value/1e3,Ie&&Ze({globalSettings:{headTrackingSensitivityY:K}})},d.onchange=Ie=>{Q=d.value/100,Ie&&Ze({globalSettings:{headTrackingAcceleration:Q}})},t.onchange=Ie=>{q=t.checked,Ie&&Ze({globalSettings:{mirrorCameraView:q}})},c.onchange=Ie=>{J=c.checked,Ie&&Ze({globalSettings:{swapMouseButtons:J}})},a.onchange=Ie=>{j=a.checked,Ie&&Ze({globalSettings:{startEnabled:j}})},n.onchange=Ie=>{Y=n.checked,Ie&&Ze({globalSettings:{runAtLogin:Y}})},t.onchange(),c.onchange(),a.onchange(),n.onchange(),l.onchange(),r.onchange(),d.onchange(),N=!j;for(const Ie of[o,c])Ie.addEventListener("contextmenu",Oe=>{Oe.preventDefault(),c.checked=!c.checked,c.onchange(Oe)});const Je=He(!0);var nt=new clm.tracker({useWebGL:!1});nt.init();var qe=!1;const W=()=>{qe=!1,A.length=0,ve&&(oe=Ee.maxContinuousChecks),ve=null,se=!0,pe=!0,b=0,B=0,s.textContent="Start",s.setAttribute("aria-pressed","false")};h.onclick=TrackyMouse.useCamera=()=>{navigator.mediaDevices.getUserMedia({audio:!1,video:{width:u,height:m,facingMode:"user"}}).then(Ie=>{W();try{"srcObject"in R?R.srcObject=Ie:R.src=window.URL.createObjectURL(Ie)}catch{R.src=Ie}h.hidden=!0,f.hidden=!0,N||(s.textContent="Stop",s.setAttribute("aria-pressed","true"))},Ie=>{console.log(Ie),Ie.name=="NotFoundError"||Ie.name=="DevicesNotFoundError"?f.textContent="No camera found. Please make sure you have a camera connected and enabled.":Ie.name=="NotReadableError"||Ie.name=="TrackStartError"?f.textContent="Webcam is already in use. Please make sure you have no other programs using the camera.":Ie.name=="OverconstrainedError"||Ie.name=="ConstraintNotSatisfiedError"?f.textContent="Webcam does not support the required resolution. Please change your settings.":Ie.name=="NotAllowedError"||Ie.name=="PermissionDeniedError"?f.textContent="Permission denied. Please enable access to the camera.":Ie.name=="TypeError"?f.textContent=`Something went wrong accessing the camera. (${Ie.name}: ${Ie.message})`:f.textContent=`Something went wrong accessing the camera. Please try again. (${Ie.name}: ${Ie.message})`,f.textContent=`⚠️ ${f.textContent}`,f.hidden=!1})},_.onclick=TrackyMouse.useDemoFootage=()=>{W(),R.srcObject=null,R.src=`${TrackyMouse.dependenciesRoot}/private/demo-input-footage.webm`,R.loop=!0},s.onclick=()=>{!h.hidden&&(TrackyMouse.useCamera(),!N)||We("toggle-tracking")},navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||console.log("getUserMedia not supported in this browser"),g.style.aspectRatio=`${u} / ${m}`,g.style.setProperty("--aspect-ratio",u/m),R.addEventListener("loadedmetadata",()=>{R.play(),R.width=R.videoWidth,R.height=R.videoHeight,w.width=R.videoWidth,w.height=R.videoHeight,ne.width=R.videoWidth,ne.height=R.videoHeight,ue.width=R.videoWidth,ue.height=R.videoHeight,g.style.aspectRatio=`${R.videoWidth} / ${R.videoHeight}`,g.style.setProperty("--aspect-ratio",R.videoWidth/R.videoHeight),I=new ge,O=new ge}),R.addEventListener("play",()=>{nt.reset(),nt.initFaceDetector(R),qe=!0}),R.addEventListener("ended",()=>{h.hidden=!1,N||We("toggle-tracking")}),R.addEventListener("error",()=>{h.hidden=!1,N||We("toggle-tracking")}),w.width=u,w.height=m,R.width=u,R.height=m;const ne=document.createElement("canvas");ne.width=w.width,ne.height=w.height,ne.getContext("2d");const ue=document.createElement("canvas");ue.width=w.width,ue.height=w.height;const he=ue.getContext("2d"),we=5,Pe=we*1.5;class ge{constructor(){this.curPyramid=new jsfeat.pyramid_t(3),this.prevPyramid=new jsfeat.pyramid_t(3),this.curPyramid.allocate(R.videoWidth,R.videoHeight,jsfeat.U8C1_t),this.prevPyramid.allocate(R.videoWidth,R.videoHeight,jsfeat.U8C1_t),this.pointCount=0,this.pointStatus=new Uint8Array(y),this.prevXY=new Float32Array(y*2),this.curXY=new Float32Array(y*2)}addPoint(Oe,it){if(this.pointCount<y){var at=this.pointCount*2;this.curXY[at]=Oe,this.curXY[at+1]=it,this.prevXY[at]=Oe,this.prevXY[at+1]=it,this.pointCount++}}filterPoints(Oe){for(var it=0,at=0;at<this.pointCount;at++)if(Oe(at)){if(it<at){const ht=at*2,St=it*2;this.curXY[St]=this.curXY[ht],this.curXY[St+1]=this.curXY[ht+1],this.prevXY[St]=this.prevXY[ht],this.prevXY[St+1]=this.prevXY[ht+1]}it++}else{he.fillStyle="red";const ht=at*2;Fe(he,this.curXY[ht],this.curXY[ht+1],5),he.fillText(Oe.toString(),5+this.curXY[ht],this.curXY[ht+1]),S.strokeStyle=S.fillStyle,S.beginPath(),S.moveTo(this.prevXY[ht],this.prevXY[ht+1]),S.lineTo(this.curXY[ht],this.curXY[ht+1]),S.stroke()}this.pointCount=it}prunePoints(){this.filterPoints(at=>this.pointStatus[at]==1);const Oe={};for(let at=0;at<this.pointCount;at++){const ht=at*2;Oe[`${~~(this.curXY[ht]/we)},${~~(this.curXY[ht+1]/we)}`]=at}const it=Object.values(Oe);this.filterPoints(at=>it.includes(at))}update(Oe){[this.prevXY,this.curXY]=[this.curXY,this.prevXY],[this.prevPyramid,this.curPyramid]=[this.curPyramid,this.prevPyramid];var it=20,at=30,ht=.01,St=.001;jsfeat.imgproc.grayscale(Oe.data,Oe.width,Oe.height,this.curPyramid.data[0]),this.curPyramid.build(this.curPyramid.data[0],!0),jsfeat.optical_flow_lk.track(this.prevPyramid,this.curPyramid,this.prevXY,this.curXY,this.pointCount,it,at,this.pointStatus,ht,St),this.prunePoints()}draw(Oe){for(var it=0;it<this.pointCount;it++){var at=it*2;Fe(Oe,this.curXY[at],this.curXY[at+1],3),Oe.strokeStyle=Oe.fillStyle,Oe.beginPath(),Oe.moveTo(this.prevXY[at],this.prevXY[at+1]),Oe.lineTo(this.curXY[at],this.curXY[at+1]),Oe.stroke()}}getMovement(){for(var Oe=0,it=0,at=0,ht=0;ht<this.pointCount;ht++){var St=ht*2;Oe+=this.curXY[St]-this.prevXY[St],it+=this.curXY[St+1]-this.prevXY[St+1],at+=1}return at>0&&(Oe/=at,it/=at),[Oe,it]}}w.addEventListener("click",Ie=>{if(!I)return;const Oe=w.getBoundingClientRect();q?I.addPoint((Oe.right-Ie.clientX)/Oe.width*w.width,(Ie.clientY-Oe.top)/Oe.height*w.height):I.addPoint((Ie.clientX-Oe.left)/Oe.width*w.width,(Ie.clientY-Oe.top)/Oe.height*w.height)});function be(Ie,Oe,it){for(var at=0;at<Ie.pointCount;at++){var ht=at*2;if(Math.abs(Oe-Ie.curXY[ht])<=Pe||Math.abs(it-Ie.curXY[ht+1])<=Pe)return}Ie.addPoint(Oe,it)}function Ce(Ie=!0){S.resetTransform(),S.clearRect(0,0,w.width,w.height),S.save(),S.drawImage(R,0,0,w.width,w.height);const Oe=S.getImageData(0,0,w.width,w.height);if(ae=Oe,q&&(S.translate(w.width,0),S.scale(-1,1),S.drawImage(R,0,0,w.width,w.height)),!!I){if(Ie){if(qe){if(se||pe){try{nt.track(R)}catch(wt){console.warn("Error in clmTracker.track()",wt),nt.getCurrentParameters().includes(NaN)&&console.warn("NaNs crept in.")}Z=nt.getCurrentPosition(),B=nt.getScore(),Math.pow(nt.getConvergence(),.5)}D&&!re&&(re=!0,A=[],clearTimeout(X),X=setTimeout(()=>{se||(W(),nt.init(),nt.reset(),nt.initFaceDetector(R),qe=!0,console.warn("Falling back to clmtrackr")),X=setInterval(()=>{try{document.createElement("canvas").getContext("webgl2"),clearInterval(X),setTimeout(()=>{console.warn("Re-initializing facemesh worker"),Ae(),oe=1},1e3)}catch(wt){if(wt.name!=="InvalidStateError")throw wt;console.warn("Trying to recover; can't create webgl2 canvas yet...")}},500)},te?2e4:2e3),ee().then(wt=>{if(re=!1,te=!1,oe-=1,oe>0||(ve=wt[0],se=!1,pe=!1,clearTimeout(X),!ve))return;O.filterPoints(()=>!1);const{annotations:gt}=ve;O.addPoint(gt.noseLeftCorner[0][0],gt.noseLeftCorner[0][1]),O.addPoint(gt.noseRightCorner[0][0],gt.noseRightCorner[0][1]),O.addPoint(gt.midwayBetweenEyes[0][0],gt.midwayBetweenEyes[0][1]);for(var Lt=0;Lt<O.pointCount;Lt++){const Yt=Lt*2;be(I,O.curXY[Yt],O.curXY[Yt+1])}H=ve.faceInViewConfidence,I.filterPoints(Yt=>{var zt=Yt*2,nn=Math.hypot((gt.noseTip[0][0]-I.curXY[zt])*1.4,gt.noseTip[0][1]-I.curXY[zt+1]),wn=Math.hypot(gt.leftCheek[0][0]-gt.rightCheek[0][0],gt.leftCheek[0][1]-gt.rightCheek[0][1]);return!(nn>wn||(nn=Math.min(Math.hypot(gt.leftEyeLower0[0][0]-I.curXY[zt],gt.leftEyeLower0[0][1]-I.curXY[zt+1]),Math.hypot(gt.rightEyeLower0[0][0]-I.curXY[zt],gt.rightEyeLower0[0][1]-I.curXY[zt+1])),nn<wn*.42))})},()=>{re=!1,te=!1}))}I.update(Oe)}if(window.electronAPI&&window.electronAPI.notifyCameraFeedDiagnostics({headNotFound:!Z&&!ve}),ve){S.fillStyle="red";const wt=ve.faceInViewConfidence<le;S.fillStyle=wt?"rgb(255,255,0)":"rgb(130,255,50)",!wt||I.pointCount<3||ve.faceInViewConfidence>H+.05?(wt&&(S.fillStyle="rgba(255,0,255)"),Ie&&_e&&ve.scaledMesh.forEach(gt=>{gt[0]+=k,gt[1]+=L}),ve.scaledMesh.forEach(([gt,Lt,Yt])=>{S.fillRect(gt,Lt,1,1)})):Ie&&_e&&(H-=.001)}if(Z){const wt=B<z;S.strokeStyle=wt?"rgb(255,255,0)":"rgb(130,255,50)",!wt||I.pointCount<2||B>b+.05?(wt&&(S.strokeStyle="rgba(255,0,255)"),Ie&&se&&(b=B,be(I,Z[42][0],Z[42][1]),be(I,Z[43][0],Z[43][1]),I.filterPoints(gt=>{var Lt=gt*2,Yt=Math.hypot((Z[62][0]-I.curXY[Lt])*1.4,Z[62][1]-I.curXY[Lt+1]),zt=Math.hypot(Z[23][0]-Z[28][0],Z[23][1]-Z[28][1]);return!(Yt>zt)}))):Ie&&se&&(b-=.001),pe&&nt.draw(w,void 0,void 0,!0)}if(S.fillStyle="lime",I.draw(S),he.fillStyle="green",I.draw(he),Ie){var[it,at]=I.getMovement(),ht=(wt,gt)=>wt/1*Math.abs(wt*5)**Q,St=Math.hypot(it,at),Qt=ht(it*F,St),ln=ht(at*K,St);if(!isFinite(Qt)||!isFinite(ln))return;if(!N){const wt=window.electronAPI?screen.width:innerWidth,gt=window.electronAPI?screen.height:innerHeight;v-=Qt*wt,T+=ln*gt,v=Math.min(Math.max(0,v),wt),T=Math.min(Math.max(0,T),gt),U&&(v=wt/2,T=gt/2,U=!1),window.electronAPI?(window.electronAPI.moveMouse(~~v,~~T),M.style.display="none"):(M.style.display="",M.style.left=`${v}px`,M.style.top=`${T}px`),TrackyMouse.onPointerMove&&TrackyMouse.onPointerMove(v,T)}k=it,L=at}S.restore(),C==null||C.update()}}function Fe(Ie,Oe,it,at){Ie.beginPath(),Ie.arc(Oe,it,at,0,Math.PI*2),Ie.fill()}setInterval(function(){Ce(!N||document.visibilityState==="visible")},15);let Ve=!1;try{Ve=localStorage.trackyMouseAutoDemo==="true"}catch{}Ve?TrackyMouse.useDemoFootage():window.electronAPI&&TrackyMouse.useCamera();const Ye=()=>{U=!0,N&&(M.style.display="none"),N?(s.textContent="Start",s.setAttribute("aria-pressed","false")):(s.textContent="Stop",s.setAttribute("aria-pressed","true")),window.electronAPI&&window.electronAPI.notifyToggleState(!N)},We=Ie=>{Ie==="toggle-tracking"&&(N=!N,Ye())};Je.then(Ye),window.electronAPI&&window.electronAPI.onShortcut(We),addEventListener("keydown",Ie=>{!Ie.ctrlKey&&!Ie.metaKey&&!Ie.altKey&&!Ie.shiftKey&&Ie.key==="F9"&&We("toggle-tracking")})};typeof module<"u"&&module.exports&&(module.exports=TrackyMouse);(e=>{const i=document.createElement.bind(document);function s(l){return l&&typeof l=="object"&&"tagName"in l?l.tagName.toLowerCase()+(l.id?"#"+l.id:"")+(l.className?"."+l.className.split(" ").join("."):"")+(l.src?`[src="${l.src}"]`:"")+(l.srcdoc?"[srcdoc]":"")+(l.href?`[href="${l.href}"]`:""):l?l.constructor.name:`${l}`}function t(l){let d=$(l).find(`
		input:enabled,
		textarea:enabled,
		select:enabled,
		button:enabled,
		a[href],
		[tabIndex='0'],
		details summary,
		iframe,
		object,
		embed,
		video[controls],
		audio[controls],
		[contenteditable]:not([contenteditable='false'])
	`).filter(":visible");const h={},_=[];for(const g of d.toArray())g.nodeName.toLowerCase()==="input"&&g.type==="radio"&&(h[g.name]?g.checked?(_.push(h[g.name]),h[g.name]=g):_.push(g):h[g.name]=g);return d.not(_)}var c=$(window);n.Z_INDEX=5;var a=[];function n(l={}){var D,te,re;var r=$(i("div")).addClass("window os-window").appendTo("body");r[0].$window=r,r.element=r[0],r[0].id=`os-window-${Math.random().toString(36).substr(2,9)}`,r.$titlebar=$(i("div")).addClass("window-titlebar").appendTo(r),r.$title_area=$(i("div")).addClass("window-title-area").appendTo(r.$titlebar),r.$title=$(i("span")).addClass("window-title").appendTo(r.$title_area),l.toolWindow&&(l.minimizeButton=!1,l.maximizeButton=!1),l.minimizeButton!==!1&&(r.$minimize=$(i("button")).addClass("window-minimize-button window-action-minimize window-button").appendTo(r.$titlebar),r.$minimize.attr("aria-label","Minimize window"),r.$minimize.append("<span class='window-button-icon'></span>")),l.maximizeButton!==!1&&(r.$maximize=$(i("button")).addClass("window-maximize-button window-action-maximize window-button").appendTo(r.$titlebar),r.$maximize.attr("aria-label","Maximize or restore window"),l.resizable||r.$maximize.prop("disabled",!0),r.$maximize.append("<span class='window-button-icon'></span>")),l.closeButton!==!1&&(r.$x=$(i("button")).addClass("window-close-button window-action-close window-button").appendTo(r.$titlebar),r.$x.attr("aria-label","Close window"),r.$x.append("<span class='window-button-icon'></span>")),r.$content=$(i("div")).addClass("window-content").appendTo(r),r.$content.attr("tabIndex","-1"),r.$content.css("outline","none"),l.toolWindow&&r.addClass("tool-window"),l.parentWindow&&(l.parentWindow.addChildWindow(r),l.toolWindow&&(r[0].dataset.semanticParent=l.parentWindow[0].id));var d=l.$component;if(typeof l.icon=="object"&&"tagName"in l.icon)l.icons={any:l.icon};else if(l.icon)if(console.warn("DEPRECATED: use options.icons instead of options.icon, e.g. new $Window({icons: {16: 'app-16x16.png', any: 'app-icon.svg'}})"),typeof $Icon<"u"&&typeof TITLEBAR_ICON_SIZE<"u")r.icon_name=l.icon,r.$icon=$Icon(l.icon,TITLEBAR_ICON_SIZE).prependTo(r.$titlebar);else throw new Error("Use {icon: img_element} or {icons: {16: url_or_img_element}} options");r.icons=l.icons||{};let h=16;r.setTitlebarIconSize=function(oe){var ve;if(r.icons){(ve=r.$icon)==null||ve.remove();const ee=r.getIconAtSize(oe);r.$icon=ee?$(ee):$(),r.$icon.prependTo(r.$titlebar)}h=oe,r.trigger("icon-change")},r.getTitlebarIconSize=function(){return h},r.getIconAtSize=function(oe){let ve;if(r.icons[oe])ve=oe;else if(r.icons.any)ve="any";else{const ee=Object.keys(r.icons).filter(le=>isFinite(le)&&isFinite(parseFloat(le)));ee.sort((le,H)=>Math.abs(parseFloat(le)-oe)-Math.abs(parseFloat(H)-oe)),ve=ee[0]}if(ve){const ee=r.icons[ve];let le;if(typeof ee=="object"&&"cloneNode"in ee)le=ee.cloneNode(!0);else{le=i("img");const H=$(le);typeof ee=="string"?H.attr("src",ee):"srcset"in ee?H.attr("srcset",ee.srcset):H.attr("src",ee.src),H.attr({width:ve,height:ve,draggable:!1}),H.css({width:oe,height:oe})}return le}return null},r.setTitlebarIconSize(h),r.getIconName=()=>(console.warn("DEPRECATED: use $w.icons object instead of $w.icon_name"),r.icon_name),r.setIconByID=oe=>{var ee;console.warn("DEPRECATED: use $w.setIcons(icons) instead of $w.setIconByID(icon_name)");var ve=r.$icon;return r.$icon=$Icon(oe,TITLEBAR_ICON_SIZE),ve.replaceWith(r.$icon),r.icon_name=oe,(ee=r.task)==null||ee.updateIcon(),r.trigger("icon-change"),r},r.setIcons=oe=>{var ve;r.icons=oe,r.setTitlebarIconSize(h),(ve=r.task)==null||ve.updateIcon()},d&&r.addClass("component-window"),setTimeout(()=>{_()=="rtl"&&r.addClass("rtl")},0);function _(){return window.get_direction?window.get_direction():getComputedStyle(r[0]).direction}const f=$({}),g=oe=>ve=>{const ee=()=>{ve()};return f.on(oe,ee),()=>{f.off(oe,ee)}};r.onFocus=g("focus"),r.onBlur=g("blur"),r.onClosed=g("closed"),r.setDimensions=({innerWidth:oe,innerHeight:ve,outerWidth:ee,outerHeight:le})=>{let H,I;if(oe&&(H=r.outerWidth()-r.$content.outerWidth()),ve){I=r.outerHeight()-r.$content.outerHeight();const O=r.$content.find(".menus");O.length&&(I+=O.outerHeight())}ee&&r.outerWidth(ee),le&&r.outerHeight(le),oe&&r.outerWidth(oe+H),ve&&r.outerHeight(ve+I)},r.setDimensions(l);let x=[];r.addChildWindow=oe=>{x.push(oe)};const w=()=>{r.hasClass("focused")||(r.addClass("focused"),f.triggerHandler("focus"))},S=()=>{r.hasClass("focused")&&(r.removeClass("focused"),f.triggerHandler("blur"))};r.focus=()=>{r.bringToFront(),B()},r.blur=()=>{S(),document.activeElement&&document.activeElement.closest(".window")==r[0]&&document.activeElement.blur()},l.toolWindow&&(l.parentWindow?(l.parentWindow.onFocus(w),l.parentWindow.onBlur(S),document.activeElement&&document.activeElement.closest(".window")==l.parentWindow[0]&&w()):($(window).on("focus",w),$(window).on("blur",S),document.hasFocus()&&w()));{let ve=function(H){if(!y.has(H)){const I=le(H,!1);y.set(H,I),setTimeout(()=>{try{const O=ae=>{H.contentDocument.readyState=="complete"?ae():setTimeout(()=>{O(ae)},100)};O(()=>{H.contentWindow.addEventListener("focusin",I),H.contentWindow.addEventListener("focusout",I),H.contentWindow.addEventListener("blur",I),H.contentWindow.addEventListener("focus",I),ee(H.contentDocument)})}catch(O){L(H,O)}},100)}},ee=function(H){new MutationObserver(O=>{for(const ae of O)for(const me of ae.addedNodes)me.tagName=="IFRAME"&&ve(me)}).observe(H,{childList:!0,subtree:!0});for(const O of H.querySelectorAll("iframe"))ve(O)},le=function(H,I){return function(ae){var Ue,Ze;const me=H.tagName=="IFRAME"?H.contentDocument:H,Ae=me.ownerDocument??me;let Se=ae?ae.type==="focusout"||ae.type==="blur"?ae.relatedTarget:ae.target:Ae.activeElement;(ae==null?void 0:ae.type)==="blur"&&(Se=null),Ae.activeElement&&Ae.activeElement.tagName==="IFRAME"&&((ae==null?void 0:ae.type)==="focusout"||(ae==null?void 0:ae.type)==="blur")&&!Se&&(Se=Ae.activeElement);const Ge=!Se||Se.window===Se||!me.contains(Se);if(Ge&&me!==Se&&I&&(l.toolWindow||S()),!Ge&&Se.tagName!=="HTML"&&Se.tagName!=="BODY"&&Se!==me&&!Se.matches(".window-content")&&!Se.closest(".menus")&&!Se.closest(".window-titlebar")&&(m.set(H,Se),A(Ae,me,Se,I)),!Ge&&Se.tagName==="IFRAME"){const He=Se;try{const Je=He.contentDocument.activeElement;Je&&Je.tagName!=="HTML"&&Je.tagName!=="BODY"&&!Je.closest(".menus")&&(m.set(He,Je),A(He.contentDocument,He.contentDocument,Je,I))}catch(Je){L(He,Je)}}if(I)do{const He=(Ue=Se==null?void 0:Se.closest)==null?void 0:Ue.call(Se,"[data-semantic-parent]");if(He){const Je=He.dataset.semanticParent,nt=He.ownerDocument.getElementById(Je);if(Se=nt,!nt){console.warn("semantic parent not found with id",Je);break}}else break}while(!0);if(Se&&Se.window!==Se&&me.contains(Se)){if(l.toolWindow||w(),r.bringToFront(),!I){let He=H;for(;He;)He.dispatchEvent(new Event("focusin",{bubbles:!0,target:He,view:He.ownerDocument.defaultView})),He=(Ze=He.ownerDocument.defaultView)==null?void 0:Ze.frameElement}}else I&&(l.toolWindow||S())}};var _e=ve,Ee=ee,X=le;const oe=le(r[0],!0);window.addEventListener("focusin",oe),window.addEventListener("focusout",oe),window.addEventListener("blur",oe),window.addEventListener("focus",oe),ee(r.$content[0])}r.css("touch-action","none");let M=null;r.setMinimizeTarget=function(oe){M=oe};let R;Object.defineProperty(r,"task",{get(){return R},set(oe){console.warn("DEPRECATED: use $w.setMinimizeTarget(taskbar_button_el) instead of setting $window.task object"),R=oe}});let C;r.minimize=()=>{if(M=M||(R==null?void 0:R.$task[0]),J){se.push(r.minimize);return}if(r.is(":visible"))if(M&&!r.hasClass("minimized-without-taskbar")){const oe=r.$titlebar[0].getBoundingClientRect(),ve=M.getBoundingClientRect();r.animateTitlebar(oe,ve,()=>{r.hide(),r.blur()})}else{if(r.hasClass("minimized-without-taskbar"))a[r._minimize_slot_index]=null;else{let Ae=0;for(;a[Ae];)Ae++;r._minimize_slot_index=Ae,a[Ae]=r}const ee=r._minimize_slot_index*160+10,le=r.$titlebar.outerHeight()??0;let H;const I=()=>{C={position:r.css("position"),left:r.css("left"),top:r.css("top"),width:r.css("width"),height:r.css("height")},r.addClass("minimized-without-taskbar"),r.hasClass("maximized")&&(r.removeClass("maximized"),r.addClass("was-maximized"),r.$maximize.removeClass("window-action-restore"),r.$maximize.addClass("window-action-maximize")),r.$minimize.removeClass("window-action-minimize"),r.$minimize.addClass("window-action-restore"),H?r.css({position:H.position,left:H.left,top:H.top,width:H.width,height:H.height}):r.css({position:"fixed",top:`calc(100% - ${le+5}px)`,left:`${ee}px`,width:"150px",height:`${le}px`})},O=()=>{H={position:r.css("position"),left:r.css("left"),top:r.css("top"),width:r.css("width"),height:r.css("height")},r.removeClass("minimized-without-taskbar"),r.hasClass("was-maximized")&&(r.removeClass("was-maximized"),r.addClass("maximized"),r.$maximize.removeClass("window-action-maximize"),r.$maximize.addClass("window-action-restore")),r.$minimize.removeClass("window-action-restore"),r.$minimize.addClass("window-action-minimize"),r.css({width:"",height:""}),C&&r.css({position:C.position,left:C.left,top:C.top,width:C.width,height:C.height})},ae=r.$titlebar[0].getBoundingClientRect();let me;r.css("transform",""),r.hasClass("minimized-without-taskbar")?(O(),me=r.$titlebar[0].getBoundingClientRect(),I()):(I(),me=r.$titlebar[0].getBoundingClientRect(),O()),r.animateTitlebar(ae,me,()=>{r.hasClass("minimized-without-taskbar")?O():(I(),r.blur())})}},r.unminimize=()=>{if(J){se.push(r.unminimize);return}if(r.hasClass("minimized-without-taskbar")){r.minimize();return}if(r.is(":hidden")){const oe=M.getBoundingClientRect();r.show();const ve=r.$titlebar[0].getBoundingClientRect();r.hide(),r.animateTitlebar(oe,ve,()=>{r.show(),r.bringToFront(),r.focus()})}};let u;r.maximize=()=>{if(!l.resizable)return;if(J){se.push(r.maximize);return}if(r.hasClass("minimized-without-taskbar")){r.minimize();return}const oe=()=>{u={position:r.css("position"),left:r.css("left"),top:r.css("top"),width:r.css("width"),height:r.css("height")},r.addClass("maximized");const I=$(".taskbar"),O=window.innerWidth-$(window).width(),ae=window.innerHeight-$(window).height(),me=I.length?I.outerHeight()+1:0;r.css({position:"fixed",top:0,left:0,width:`calc(100vw - ${O}px)`,height:`calc(100vh - ${ae}px - ${me}px)`})},ve=()=>{r.removeClass("maximized"),r.css({width:"",height:""}),u&&r.css({position:u.position,left:u.left,top:u.top,width:u.width,height:u.height})},ee=r.$titlebar[0].getBoundingClientRect();let le;r.css("transform","");const H=r.hasClass("maximized");H?(ve(),le=r.$titlebar[0].getBoundingClientRect(),oe()):(oe(),le=r.$titlebar[0].getBoundingClientRect(),ve()),r.animateTitlebar(ee,le,()=>{H?(ve(),r.$maximize.removeClass("window-action-restore"),r.$maximize.addClass("window-action-maximize")):(oe(),r.$maximize.removeClass("window-action-maximize"),r.$maximize.addClass("window-action-restore"))})},r.restore=()=>{r.is(".minimized-without-taskbar, .minimized")?r.unminimize():r.is(".maximized")&&r.maximize()},(D=r.$minimize)==null||D.on("click",oe=>{r.minimize()}),(te=r.$maximize)==null||te.on("click",oe=>{r.maximize()}),(re=r.$x)==null||re.on("click",oe=>{r.close()}),r.$title_area.on("dblclick",oe=>{r.maximize()}),r.css({position:"absolute",zIndex:n.Z_INDEX++}),r.bringToFront=()=>{r.css({zIndex:n.Z_INDEX++});for(const oe of x)oe.bringToFront()};var m=new Map,y=new Map,v=new Map,T=[],k=new WeakSet;const L=(oe,ve)=>{var H;const ee=I=>[`OS-GUI.js failed to access an iframe (${s(oe)}) for focus integration.
${I}
Original error:
`,ve];let le;if(oe.srcdoc)le=!1;else try{le=new URL(oe.src).origin!==window.location.origin}catch(I){console.error(...ee(`This may be a bug in OS-GUI. Is this a cross-origin iframe? Failed to parse URL (${I}).`));return}le?(H=l.iframes)!=null&&H.ignoreCrossOrigin&&!k.has(oe)&&(console.warn(...ee(`Only same-origin iframes can work with focus integration (showing window as focused, refocusing last focused controls).
If you can re-host the content on the same origin, you can resolve this and enable focus integration.
You can also disable this warning by passing {iframes: {ignoreCrossOrigin: true}} to $Window.`)),k.add(oe)):console.error(...ee("This may be a bug in OS-GUI, since it doesn't appear to be a cross-origin iframe."))},A=(oe,ve,ee,le)=>{if(!n.DEBUG_FOCUS)return;let H=v.get(ve);H||(H=oe.createElementNS("http://www.w3.org/2000/svg","svg"),H.style.position="fixed",H.style.top="0",H.style.left="0",H.style.width="100%",H.style.height="100%",H.style.pointerEvents="none",H.style.zIndex="100000000",H.style.direction="ltr",v.set(ve,H),T.push(H),oe.body.appendChild(H)),H._container_el=ve,H._descendant_el=ee,H._is_root=le,Q()},F=oe=>{var ae,me;const ve=oe._container_el,ee=oe._descendant_el,le=oe._is_root;for(;oe.lastChild;)oe.removeChild(oe.lastChild);const H=((ae=ee.getBoundingClientRect)==null?void 0:ae.call(ee))??{left:0,top:0,width:innerWidth,height:innerHeight,right:innerWidth,bottom:innerHeight},I=((me=ve.getBoundingClientRect)==null?void 0:me.call(ve))??{left:0,top:0,width:innerWidth,height:innerHeight,right:innerWidth,bottom:innerHeight};for(const Ae of[H,I]){const Se=document.createElementNS("http://www.w3.org/2000/svg","rect");Se.setAttribute("x",Ae.left),Se.setAttribute("y",Ae.top),Se.setAttribute("width",Ae.width),Se.setAttribute("height",Ae.height),Se.setAttribute("stroke","#f44"),Se.setAttribute("stroke-width","2"),Se.setAttribute("fill","none"),le||Se.setAttribute("stroke-dasharray","5,5"),oe.appendChild(Se);const Ge=document.createElementNS("http://www.w3.org/2000/svg","text");Ge.setAttribute("x",Ae.left),Ge.setAttribute("y",Ae.top+(Ae===H?20:0)),Ge.setAttribute("fill",Ae===H?"#f44":"aqua"),Ge.setAttribute("font-size","20"),Ge.style.textShadow="1px 1px 1px black, 0 0 10px black",Ge.textContent=s(Ae===H?ee:ve),oe.appendChild(Ge)}const O=[[H.left,H.top,I.left,I.top],[H.right,H.top,I.right,I.top],[H.left,H.bottom,I.left,I.bottom],[H.right,H.bottom,I.right,I.bottom]];for(const Ae of O){const Se=document.createElementNS("http://www.w3.org/2000/svg","line");Se.setAttribute("x1",Ae[0]),Se.setAttribute("y1",Ae[1]),Se.setAttribute("x2",Ae[2]),Se.setAttribute("y2",Ae[3]),Se.setAttribute("stroke","green"),Se.setAttribute("stroke-width","2"),oe.appendChild(Se)}};let K;const Q=()=>{if(cancelAnimationFrame(K),!n.DEBUG_FOCUS){Z();return}K=requestAnimationFrame(Q);for(const oe of T)F(oe)},Z=()=>{cancelAnimationFrame(K);for(const oe of T)oe.remove();T.length=0,v.clear()},B=(oe=r.$content[0])=>{const ve=oe.matches(".window-content")?r[0]:oe,ee=m.get(ve);if(ee){if(ee.focus({preventScroll:!0}),ee.tagName==="IFRAME")try{B(ee)}catch(I){L(ee,I)}return}const le=t(oe),H=le.filter(".default");if(H.length){H[0].focus({preventScroll:!0});return}if(le.length){if(le[0].tagName==="IFRAME"){const I=le[0];try{B(I)}catch(O){L(I,O)}}else le[0].focus({preventScroll:!0});return}if(l.toolWindow&&l.parentWindow){l.parentWindow.triggerHandler("refocus-window");return}if(oe.focus({preventScroll:!0}),oe.tagName==="IFRAME"){const I=oe;try{B(I.contentDocument.body)}catch(O){L(I,O)}}};r.on("refocus-window",()=>{B()}),r.on("pointerdown mousedown",z),c.on("focusin",oe=>{m.set(window,oe.target)});function z(oe){r.bringToFront(),requestAnimationFrame(()=>{var le,H;const ve=m.get(window);if(document.activeElement&&document.activeElement!==document&&document.activeElement!==document.body&&document.activeElement!==r.$content[0]&&document.activeElement!==ve||(H=(le=document.activeElement)==null?void 0:le.closest)!=null&&H.call(le,".menus, .menu-popup"))return;if(getComputedStyle(oe.target).userSelect!=="none"){r.$content.focus(),r.one("pointerup pointercancel",()=>{requestAnimationFrame(()=>{var I;(I=getSelection())!=null&&I.toString().trim()||B()})});return}B()})}r.on("keydown",oe=>{if(oe.isDefaultPrevented()||oe.ctrlKey||oe.altKey||oe.metaKey||oe.target.closest(".menus"))return;const ve=r.$content.find("button"),ee=$(document.activeElement),le=ve.index(ee);switch(oe.keyCode){case 40:case 39:ee.is("button")&&!oe.shiftKey&&le<ve.length-1&&(ve[le+1].focus(),oe.preventDefault());break;case 38:case 37:ee.is("button")&&!oe.shiftKey&&le>0&&(ve[le-1].focus(),oe.preventDefault());break;case 32:case 13:if(ee.is("button")&&!oe.shiftKey){ee.addClass("pressed");const H=()=>{ee.removeClass("pressed"),ee.off("focusout",H),$(window).off("keyup",I)},I=O=>{(O.keyCode===32||O.keyCode===13)&&H()};ee.on("focusout",H),$(window).on("keyup",I)}break;case 9:{const H=t(r.$content[0]);if(H.length>0){const I=H.index(ee);oe.shiftKey?I===0&&(oe.preventDefault(),H[H.length-1].focus()):I===H.length-1&&(oe.preventDefault(),H[0].focus())}break}case 27:r.close();break}}),r.applyBounds=()=>{const oe=Math.max(document.body.scrollWidth,innerWidth),ve=Math.max(document.body.scrollHeight,innerHeight);r.css({left:Math.max(0,Math.min(oe-r.width(),r.position().left)),top:Math.max(0,Math.min(ve-r.height(),r.position().top))})},r.bringTitleBarInBounds=()=>{const oe=Math.max(document.body.scrollWidth,innerWidth),ve=Math.max(document.body.scrollHeight,innerHeight),ee=40;r.css({left:Math.max(ee-r.outerWidth(),Math.min(oe-ee,r.position().left)),top:Math.max(0,Math.min(ve-r.$titlebar.outerHeight()-5,r.position().top))})},r.center=()=>{r.css({left:(innerWidth-r.width())/2+window.scrollX,top:(innerHeight-r.height())/2+window.scrollY}),r.applyBounds()},c.on("resize",r.bringTitleBarInBounds);var b,N,U,q,j,Y=oe=>{var ee;const ve=oe.pointerId??((ee=oe.originalEvent)==null?void 0:ee.pointerId);(j===ve||ve===void 0||j===void 0||j===1234567890)&&(U=oe.clientX??U,q=oe.clientY??q),r.css({left:U+scrollX-b,top:q+scrollY-N})};r.$titlebar.css("touch-action","none"),r.$titlebar.on("selectstart",oe=>{oe.preventDefault()}),r.$titlebar.on("mousedown","button",oe=>{B();const ve=oe.currentTarget;if(!$(ve).is(":enabled"))return;ve.classList.add("pressing");const ee=I=>{I&&I.type==="blur"&&document.hasFocus()||(ve.classList.remove("pressing"),c.off("mouseup blur",ee),$(ve).off("mouseenter",le),$(ve).off("mouseleave",H))},le=()=>{ve.classList.add("pressing")},H=()=>{ve.classList.remove("pressing")};c.on("mouseup blur",ee),$(ve).on("mouseenter",le),$(ve).on("mouseleave",H)}),r.$titlebar.on("pointerdown",oe=>{var ee;if($(oe.target).closest("button").length||r.hasClass("maximized"))return;const ve=$.Event("window-drag-start");r.trigger(ve),!ve.isDefaultPrevented()&&(b=oe.clientX+scrollX-r.position().left,N=oe.clientY+scrollY-r.position().top,U=oe.clientX,q=oe.clientY,j=oe.pointerId??((ee=oe.originalEvent)==null?void 0:ee.pointerId),c.on("pointermove",Y),c.on("scroll",Y),$("body").addClass("dragging"))}),c.on("pointerup pointercancel",oe=>{var ee;const ve=oe.pointerId??((ee=oe.originalEvent)==null?void 0:ee.pointerId);ve!==j&&ve!==void 0||(c.off("pointermove",Y),c.off("scroll",Y),$("body").removeClass("dragging"),r.bringTitleBarInBounds(),j=-1)}),r.$titlebar.on("dblclick",oe=>{d&&d.dock()}),l.resizable&&[[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1],[1,0],[1,1],[0,1]].forEach(([me,Ae])=>{const Se=$("<div>").addClass("handle").appendTo(r);let Ge="";me===-1&&(Ge+="n"),me===1&&(Ge+="s"),Ae===-1&&(Ge+="w"),Ae===1&&(Ge+="e"),Ge+="-resize";const Xe=(r.outerWidth()-r.width())/2,Ue=(r.outerWidth()-r.innerWidth())/2,Ze=r.outerHeight()-r.$content.outerHeight(),He=r.outerWidth()-r.$content.outerWidth();Se.css({position:"absolute",top:me===-1?-Ue:me===0?`calc(${Xe}px - ${Ue}px)`:"",bottom:me===1?-Ue:"",left:Ae===-1?-Ue:Ae===0?`calc(${Xe}px - ${Ue}px)`:"",right:Ae===1?-Ue:"",width:Ae===0?`calc(100% - ${Xe}px * 2 + ${Ue*2}px)`:`${Xe}px`,height:me===0?`calc(100% - ${Xe}px * 2 + ${Ue*2}px)`:`${Xe}px`,touchAction:"none",cursor:Ge});let Je,nt,qe,W,ne,ue;Se.on("pointerdown",ge=>{var be;ge.preventDefault(),c.on("pointermove",he),c.on("scroll",Pe),$("body").addClass("dragging"),c.on("pointerup pointercancel",we),Je={x:r.position().left,y:r.position().top,width:r.outerWidth(),height:r.outerHeight()},nt=ge.clientX+scrollX-Je.x-(Ae===1?Je.width:0),qe=ge.clientY+scrollY-Je.y-(me===1?Je.height:0),W=ge.clientX,ne=ge.clientY,ue=ge.pointerId??((be=ge.originalEvent)==null?void 0:be.pointerId);try{Se[0].setPointerCapture(ue)}catch(Ce){console.warn("Failed to capture pointer for resize handle drag:",Ce)}});function he(ge){var Ce;const be=ge.pointerId??((Ce=ge.originalEvent)==null?void 0:Ce.pointerId);be!==ue&&be!==void 0||(W=ge.clientX,ne=ge.clientY,Pe())}function we(ge){var Ce;const be=ge.pointerId??((Ce=ge.originalEvent)==null?void 0:Ce.pointerId);be!==ue&&be!==void 0||(c.off("pointermove",he),$("body").removeClass("dragging"),c.off("pointerup pointercancel",we),r.bringTitleBarInBounds())}function Pe(){const ge=W+scrollX-nt,be=ne+scrollY-qe;let Ce=0,Fe=0,Ve,Ye;Ae===1?(Ce=0,Ve=~~(ge-Je.x)):Ae===-1?(Ce=~~(ge-Je.x),Ve=~~(Je.x+Je.width-ge)):Ve=~~Je.width,me===1?(Fe=0,Ye=~~(be-Je.y)):me===-1?(Fe=~~(be-Je.y),Ye=~~(Je.y+Je.height-be)):Ye=~~Je.height;let We={x:Je.x+Ce,y:Je.y+Fe,width:Ve,height:Ye};We.width=Math.max(1,We.width),We.height=Math.max(1,We.height),l.constrainRect&&(We=l.constrainRect(We,Ae,me)),We.width=Math.max(We.width,l.minOuterWidth??100),We.height=Math.max(We.height,l.minOuterHeight??0),We.width=Math.max(We.width,(l.minInnerWidth??0)+He),We.height=Math.max(We.height,(l.minInnerHeight??0)+Ze),Ae===-1&&(We.x=Math.min(We.x,Je.x+Je.width-We.width)),me===-1&&(We.y=Math.min(We.y,Je.y+Je.height-We.height)),r.css({top:We.y,left:We.x}),r.outerWidth(We.width),r.outerHeight(We.height)}}),r.$Button=(oe,ve)=>{var ee=$(i("button")).appendTo(r.$content).text(oe).on("click",()=>{ve&&ve(),r.close()});return ee},r.title=oe=>typeof oe<"u"?(r.$title.text(oe),r.trigger("title-change"),r.task&&r.task.updateTitle(),r):r.$title.text(),r.getTitle=()=>r.title();let J=!1,se=[];r.animateTitlebar=(oe,ve,ee=()=>{})=>{J=!0;const le=r.$titlebar.clone(!0);le.find("button").remove(),le.appendTo("body");const H=n.OVERRIDE_TRANSITION_DURATION??200,I=`${H}ms`;le.css({transition:`left ${I} linear, top ${I} linear, width ${I} linear, height ${I} linear`,position:"fixed",zIndex:1e7,pointerEvents:"none",left:oe.left,top:oe.top,width:oe.width,height:oe.height}),setTimeout(()=>{le.css({left:ve.left,top:ve.top,width:ve.width,height:ve.height})},5);let O=!1;const ae=()=>{var me;O||(O=!0,J=!1,le.remove(),ee(),(me=se.shift())==null||me())};le.on("transitionend transitioncancel",ae),setTimeout(ae,H*1.2)},r.close=oe=>{if(oe&&oe!==!0)throw new TypeError("force must be a boolean or undefined, not "+Object.prototype.toString.call(oe));if(!oe){var ve=$.Event("close");if(r.trigger(ve),ve.isDefaultPrevented())return}d&&d.detach(),r.closed=!0,a[r._minimize_slot_index]=null,f.triggerHandler("closed"),r.trigger("closed"),r.remove();var ee=$($(".window:visible").toArray().sort((le,H)=>H.style.zIndex-le.style.zIndex)[0]);ee.triggerHandler("refocus-window"),Z()},r.closed=!1;let pe;return r.setMenuBar=oe=>{pe&&pe.element.remove(),oe&&(r.$titlebar.after(oe.element),oe.setKeyboardScope(r[0]),pe=oe)},l.title&&r.title(l.title),d||r.center(),r}function o(l){var r=n();return r.title(l),r.$form=$(i("form")).appendTo(r.$content),r.$main=$(i("div")).appendTo(r.$form),r.$buttons=$(i("div")).appendTo(r.$form).addClass("button-group"),r.$Button=(d,h)=>{var _=$(i("button")).appendTo(r.$buttons).text(d);return _.on("click",f=>{f.preventDefault(),h()}),_.on("pointerdown",()=>{_.focus()}),_},r}e.$Window=n,e.$FormWindow=o})(window);(e=>{function i(_,f){const g=document.createElement(_);if(f)for(const x in f)x==="class"?g.className=f[x]:g.setAttribute(x,f[x]);return g}let s=0;function t(){return(s++).toString(36)+Math.random().toString(36).slice(2)}const c={escape:function(_){return _.replace(/&/g,"&&")},unescape:function(_){return _.replace(/&&/g,"&")},indexOf:function(_){return` ${_}`.search(/[^&]&[^&\s]/)},has:function(_){return this.indexOf(_)>=0},get:function(_){const f=this.indexOf(_);return f>=0?_.charAt(f+1).toUpperCase():null},remove:function(_){const f=/\s?\(&[^&]\)/;return f.test(_)?this.unescape(_.replace(f,"")):this.toText(_)},toText:function(_){const f=this.indexOf(_);return f>=0?this.unescape(_.substring(0,f))+this.unescape(_.substring(f+1)):this.unescape(_)},toHTML:function(_){const f=this.toFragment(_),g=document.createElement("div");return g.appendChild(f),g.innerHTML},toFragment:function(_){const f=document.createDocumentFragment(),g=this.indexOf(_);if(g>=0){f.appendChild(document.createTextNode(this.unescape(_.substring(0,g))));const x=i("span",{class:"menu-hotkey"});x.appendChild(document.createTextNode(_.charAt(g+1))),f.appendChild(x),f.appendChild(document.createTextNode(this.unescape(_.substring(g+2))))}else f.appendChild(document.createTextNode(this.unescape(_)));return f}},a="MENU_DIVIDER",n=1e3;let o=null;function l(){document.activeElement&&document.activeElement.tagName!=="BODY"&&document.activeElement.tagName!=="HTML"&&!document.activeElement.closest(".menus, .menu-popup")&&(o=document.activeElement)}typeof window<"u"&&(window.addEventListener("focusin",l),window.addEventListener("focusout",l));let r=1;function d(){return typeof $Window<"u"?$Window.Z_INDEX+++n:++r+n}function h(_){if(!(this instanceof h))return new h(_);const f=i("div",{class:"menus",role:"menubar","aria-label":"Application Menu"});f.style.touchAction="none";function g(){return window.get_direction?window.get_direction():getComputedStyle(f).direction}let x=!1;const w=[];let S=-1,M;const R=new WeakMap,C=new WeakMap,u=()=>{for(const{menu_button_el:B}of w)B.getAttribute("aria-expanded")==="true"&&B.dispatchEvent(new CustomEvent("release",{}))},m=()=>{if(o&&(o.focus(),document.activeElement===o))return;const B=f.closest(".window");B&&B.dispatchEvent(new CustomEvent("refocus-window"))},y=B=>{const z=typeof B=="string"?Object.keys(_).indexOf(B):B;S!==-1&&S!==z&&w[S].menu_button_el.classList.remove("highlight"),z!==-1&&w[z].menu_button_el.classList.add("highlight"),S=z};f.addEventListener("pointerleave",()=>{S!==-1&&w[S].menu_popup_el.style.display==="none"&&y(-1)});const v=B=>typeof B.enabled=="function"?!B.enabled():typeof B.enabled=="boolean"?!B.enabled:!1;function T(B){const z=(B==null?void 0:B.description)||"";if(typeof jQuery<"u"){const b=new jQuery.Event("info",{detail:{description:z}}),N={toString(){return console.warn("jQuery extra parameter for info event is deprecated, use event.detail instead"),z}};jQuery(f).trigger(b,N)}else f.dispatchEvent(new CustomEvent("info",{detail:{description:z}}))}function k(B){if(B.defaultPrevented)return;const z=M==null?void 0:M.element,b=w[S],{menu_button_el:N,open_top_level_menu:U}=b||{},q=z||(b==null?void 0:b.menu_popup_el),j=z?C.get(z):void 0,Y=q==null?void 0:q.querySelector(".menu-item.highlight");if(Y&&!(Y instanceof HTMLElement))throw new Error("Unexpected type for highlighted item element");switch(B.key){case"ArrowLeft":case"ArrowRight":const J=B.key==="ArrowRight";if(Y!=null&&Y.matches(".has-submenu:not([aria-disabled='true'])")&&g()==="ltr"===J)Y.click(),B.preventDefault();else if(M&&M.parentMenuPopup&&g()==="ltr"!==J)M.close(!0),j.setAttribute("aria-expanded","false"),T(M.menuItems[M.itemElements.indexOf(j)]),B.preventDefault();else if(Y||!M||!M.parentMenuPopup){const D=q&&q.style.display!=="none",te=g()==="ltr"===J?1:-1;let re;S===-1?re=te===1?0:w.length-1:re=(S+te+w.length)%w.length;const oe=w[re],ve=oe.menu_button_el;D?oe.open_top_level_menu("keydown"):(N==null||N.dispatchEvent(new CustomEvent("release",{})),ve.focus({preventScroll:!0}),y(re)),B.preventDefault()}break;case"ArrowUp":case"ArrowDown":const se=B.key==="ArrowDown";if(M){const D=se?1:-1,te=[...q.querySelectorAll(".menu-item")],re=te.indexOf(Y);let oe=(re+D+te.length)%te.length;re===-1&&(se?oe=0:oe=te.length-1);const ve=te[oe];M.highlight(ve),T(M.menuItems[M.itemElements.indexOf(ve)]),B.preventDefault()}else U==null||U("keydown");B.preventDefault();break;case"Escape":if(M)j&&j!==N?(M.close(!0),j.setAttribute("aria-expanded","false"),T(M.menuItems[M.itemElements.indexOf(j)])):(u(),N.focus({preventScroll:!0})),B.preventDefault();else{const D=f.closest(".window");D&&(D.dispatchEvent(new CustomEvent("refocus-window")),B.preventDefault())}break;case"Alt":u(),m(),B.preventDefault();break;case"Space":break;case"Enter":N===document.activeElement?(U("keydown"),B.preventDefault()):(Y==null||Y.click(),B.preventDefault());break;default:if(B.ctrlKey||B.metaKey)break;const pe=B.key.toLowerCase(),_e=M?[...q.querySelectorAll(".menu-item")]:w.map(D=>D.menu_button_el),Ee={};for(const D of _e){const te=D.querySelector(".menu-hotkey"),re=(te?te.textContent:(D.querySelector(".menu-item-label")??D).textContent[0]).toLowerCase();Ee[re]=Ee[re]||[],Ee[re].push(D)}const X=Ee[pe]||[];if(X.length)if(X.length===1){const D=X[0],te=w.find(re=>re.menu_button_el===D);te?te.open_top_level_menu("keydown"):D.click(),B.preventDefault()}else{let D=X.indexOf(Y);D===-1?D=0:D=(D+1)%X.length;const te=X[D];M.highlight(te),B.preventDefault()}break}}f.addEventListener("keydown",k);function L(B,{parentMenuPopup:z}={}){this.parentMenuPopup=z,this.menuItems=B,this.itemElements=[];const b=i("div",{class:"menu-popup",id:`menu-popup-${t()}`,tabIndex:"-1",role:"menu"});b.style.touchAction="pan-y",b.style.outline="none";const N=i("table",{class:"menu-popup-table",role:"presentation"});b.appendChild(N),this.element=b;let U=[];b.addEventListener("keydown",k),b.addEventListener("pointerleave",()=>{for(const J of U)if(J.submenu_popup_el.style.display!=="none"){this.highlight(J.item_el);return}this.highlight(-1)}),b.addEventListener("focusin",J=>{b.focus({preventScroll:!0})});let q;this.highlight=J=>{let se;typeof J=="number"?se=this.itemElements[J]:se=J,q&&q!==se&&q.classList.remove("highlight"),se?(se.classList.add("highlight"),b.setAttribute("aria-activedescendant",se.id),q=se):(b.removeAttribute("aria-activedescendant"),q=null)},this.close=(J=!0)=>{var se;for(const pe of U)pe.submenu_popup.close(!1);J&&((se=this.parentMenuPopup)==null||se.element.focus({preventScroll:!0})),b.style.display="none",this.highlight(-1),M===this&&(M=this.parentMenuPopup)};const j=(J,se,pe)=>{var X,D;const _e=i("tr",{class:"menu-row"});if(this.itemElements.push(_e),J.appendChild(_e),se===a){const te=i("td",{colspan:"4"}),re=i("hr",{class:"menu-hr"});te.appendChild(re),_e.appendChild(te),re.addEventListener("pointerenter",()=>{this.highlight(-1)})}else{const te=_e;te.classList.add("menu-item"),te.id=`menu-item-${t()}`,te.tabIndex=-1,te.setAttribute("role",se.checkbox?se.checkbox.type==="radio"?"menuitemradio":"menuitemcheckbox":"menuitem"),(se.label||se.item)&&te.setAttribute("aria-label",c.toText(se.label||se.item)),te.setAttribute("aria-keyshortcuts",se.ariaKeyShortcuts||""),se.description&&te.setAttribute("aria-description",se.description);const re=i("td",{class:"menu-item-checkbox-area"}),oe=i("td",{class:"menu-item-label"}),ve=i("td",{class:"menu-item-shortcut"}),ee=i("td",{class:"menu-item-submenu-area"});te.appendChild(re),te.appendChild(oe),te.appendChild(ve),te.appendChild(ee),se.label?oe.appendChild(c.toFragment(se.label)):se.item&&(oe.appendChild(c.toFragment(se.item)),console.warn("Menu item option `item` is deprecated; use `label` instead.")),se.shortcutLabel?ve.textContent=se.shortcutLabel:se.shortcut&&(ve.textContent=se.shortcut,console.warn("Menu item option `shortcut` is deprecated; use `shortcutLabel` instead (and ideally provide `ariaKeyShortcuts` as well)")),b.addEventListener("update",()=>{if(v(se)?(te.setAttribute("disabled",""),te.setAttribute("aria-disabled","true")):(te.removeAttribute("disabled"),te.removeAttribute("aria-disabled")),se.checkbox&&se.checkbox.check){const ae=se.checkbox.check();te.setAttribute("aria-checked",ae?"true":"false")}}),te.addEventListener("pointerenter",()=>{this.highlight(pe),T(se)}),te.addEventListener("pointerleave",ae=>{b.style.display!=="none"&&ae.pointerType!=="touch"&&T()}),((X=se.checkbox)==null?void 0:X.type)==="radio"?re.classList.add("radio"):se.checkbox&&re.classList.add("checkbox");let le,H;if(se.submenu){let me=function(){for(const{submenu_popup:Ge,item_el:Xe}of U)Ge.close(!1),Xe.setAttribute("aria-expanded","false");b.focus({preventScroll:!0})};var Ee=me;te.classList.add("has-submenu"),ee.classList.toggle("point-right",g()==="rtl");const ae=new L(se.submenu,{parentMenuPopup:this});H=ae.element,(D=document.body)==null||D.appendChild(H),H.style.display="none",te.setAttribute("aria-haspopup","true"),te.setAttribute("aria-expanded","false"),te.setAttribute("aria-controls",H.id),R.set(te,ae),C.set(H,te),H.dataset.semanticParent=b.id,b.setAttribute("aria-owns",`${b.getAttribute("aria-owns")||""} ${H.id}`),H.setAttribute("aria-labelledby",te.id),le=(Ge=!0)=>{if(H.style.display!=="none"||te.getAttribute("aria-disabled")==="true")return;me(),te.setAttribute("aria-expanded","true"),H.style.display="",H.style.zIndex=`${d()}`,H.setAttribute("dir",g()),window.inheritTheme&&window.inheritTheme(H,b),H.parentElement||document.body.appendChild(H),H.dispatchEvent(new CustomEvent("update",{})),Ge?(ae.highlight(0),T(ae.menuItems[0])):ae.highlight(-1);const Xe=te.getBoundingClientRect();let Ue=H.getBoundingClientRect();H.style.position="absolute",H.style.left=`${(g()==="rtl"?Xe.left-Ue.width:Xe.right)+window.scrollX}px`,H.style.top=`${Xe.top+window.scrollY}px`,Ue=H.getBoundingClientRect(),g()==="rtl"?Ue.left<0&&(H.style.left=`${Xe.right}px`,Ue=H.getBoundingClientRect(),Ue.right>innerWidth&&(H.style.left=`${innerWidth-Ue.width}px`)):Ue.right>innerWidth&&(H.style.left=`${Xe.left-Ue.width}px`,Ue=H.getBoundingClientRect(),Ue.left<0&&(H.style.left="0")),H.focus({preventScroll:!0}),M=ae},U.push({item_el:te,submenu_popup_el:H,submenu_popup:ae});let Ae,Se;H.addEventListener("pointerenter",()=>{Ae&&(clearTimeout(Ae),Ae=null),Se&&(clearTimeout(Se),Se=null)}),te.addEventListener("pointerenter",()=>{Ae&&(clearTimeout(Ae),Ae=null),Se&&(clearTimeout(Se),Se=null),Ae=setTimeout(()=>{le(!1)},501)}),te.addEventListener("pointerleave",()=>{Ae&&(clearTimeout(Ae),Ae=null)}),b.addEventListener("pointerenter",Ge=>{Ge.target.closest(".menu-item")!==te&&(Se||H.style.display!=="none"&&(Se=setTimeout(()=>{window.debugKeepMenusOpen||me()},500)))}),b.addEventListener("pointerleave",()=>{Se&&(clearTimeout(Se),Se=null)}),te.addEventListener("pointerdown",()=>{le(!1)})}let I=!1;const O=()=>{I||(I=!0,setTimeout(()=>{I=!1},10),se.checkbox?(se.checkbox.toggle&&se.checkbox.toggle(),b.dispatchEvent(new CustomEvent("update",{}))):se.action&&(u(),m(),se.action()))};te.addEventListener("pointerup",ae=>{ae.pointerType==="mouse"&&ae.button!==0||ae.pointerType!=="touch"&&te.click()}),te.addEventListener("click",ae=>{se.submenu?le(!0):O()})}};B.length===0&&(B=[{label:"(Empty)",enabled:!1}]);let Y=0;for(const J of B)if(typeof J=="object"&&"radioItems"in J){const se=i("tbody",{role:"group"});J.ariaLabel&&se.setAttribute("aria-label",J.ariaLabel);for(const pe of J.radioItems)pe.checkbox={type:"radio",check:()=>pe.value===J.getValue(),toggle:()=>{J.setValue(pe.value)}},j(se,pe,Y++);N.appendChild(se)}else j(N,J,Y++)}const A=(B,z)=>{var J;const b=i("div",{class:"menu-button","aria-expanded":"false","aria-haspopup":"true",role:"menuitem"});f.appendChild(b);const N=new L(z),U=N.element;(J=document.body)==null||J.appendChild(U),R.set(b,N),C.set(U,b),b.id=`menu-button-${B}-${t()}`,U.dataset.semanticParent=b.id,b.setAttribute("aria-controls",U.id),U.setAttribute("aria-labelledby",b.id),f.setAttribute("aria-owns",`${f.getAttribute("aria-owns")||""} ${U.id}`);const q=()=>{const se=b.getBoundingClientRect();let pe=U.getBoundingClientRect();U.style.position="absolute",U.style.left=`${(g()==="rtl"?se.right-pe.width:se.left)+window.scrollX}px`,U.style.top=`${se.bottom+window.scrollY}px`;const _e=U.getBoundingClientRect();Math.floor(_e.right)>innerWidth&&(U.style.left=`${innerWidth-_e.width}px`),Math.ceil(_e.left)<0&&(U.style.left="0px")};window.addEventListener("resize",q),U.addEventListener("update",q);const j=B.replace("&","").replace(/ /g,"-").toLowerCase();b.classList.add(`${j}-menu-button`),U.style.display="none",b.innerHTML=`<span>${c.toHTML(B)}</span>`,b.tabIndex=-1,b.setAttribute("aria-haspopup","true"),b.setAttribute("aria-controls",U.id),b.addEventListener("focus",()=>{y(B)}),b.addEventListener("pointerdown",se=>{b.classList.contains("active")?(b.dispatchEvent(new CustomEvent("release",{})),m(),se.preventDefault()):Y(se.type)}),b.addEventListener("pointermove",se=>{y(B),se.pointerType!=="touch"&&x&&Y(se.type)});function Y(se="other"){Object.keys(_).indexOf(B)===S&&b.getAttribute("aria-expanded")==="true"||(u(),b.classList.add("active"),b.setAttribute("aria-expanded","true"),U.style.display="",U.style.zIndex=`${d()}`,U.setAttribute("dir",g()),window.inheritTheme&&window.inheritTheme(U,f),U.parentElement||document.body.appendChild(U),y(B),U.dispatchEvent(new CustomEvent("update",{})),x=!0,U.focus({preventScroll:!0}),M=N,se==="keydown"?(N.highlight(0),T(N.menuItems[0])):T())}b.addEventListener("release",()=>{x=!1,b.classList.remove("active"),window.debugKeepMenusOpen||(N.close(!0),b.setAttribute("aria-expanded","false")),f.dispatchEvent(new CustomEvent("default-info",{}))}),w.push({menu_button_el:b,menu_popup_el:U,menus_key:B,access_key:c.get(B),open_top_level_menu:Y})};for(const B in _)A(B,_[B]);window.addEventListener("keydown",B=>{(!document.activeElement||!document.activeElement.closest||!document.activeElement.closest(".menus, .menu-popup"))&&B.key==="Escape"&&M&&(u(),B.preventDefault())}),window.addEventListener("blur",B=>{B.isTrusted&&u()});function F(B){var z,b,N,U;((b=(z=B.target)==null?void 0:z.closest)==null?void 0:b.call(z,".menus"))===f||(U=(N=B.target)==null?void 0:N.closest)!=null&&U.call(N,".menu-popup")||(u(),y(-1))}window.addEventListener("pointerdown",F),window.addEventListener("pointerup",F),window.addEventListener("focusout",B=>{var z,b,N,U;((b=(z=B.relatedTarget)==null?void 0:z.closest)==null?void 0:b.call(z,".menus"))===f||(U=(N=B.relatedTarget)==null?void 0:N.closest)!=null&&U.call(N,".menu-popup")||(u(),y(w.findIndex(({menu_button_el:q})=>q.matches(":hover"))))});let K=[];function Q(...B){for(const z of K)z.removeEventListener("keydown",Z);K=B;for(const z of K)z.addEventListener("keydown",Z)}function Z(B){if((B.ctrlKey||B.metaKey)&&B.key!=="Control"&&B.key!=="Meta"){u();return}if(!B.defaultPrevented&&B.altKey&&!B.shiftKey&&!B.ctrlKey&&!B.metaKey){const z=w.find(b=>{var N;return((N=b.access_key)==null?void 0:N.toLowerCase())===B.key.toLowerCase()});z&&(B.preventDefault(),z.open_top_level_menu("keydown"))}}Q(window),this.element=f,this.closeMenus=u,this.setKeyboardScope=Q}e.MenuBar=h,e.AccessKeys=c,e.MENU_DIVIDER=a})(typeof module<"u"?module.exports:window);(function(){function e(){var i=this;this.versionnumber="1.2.5",this.imageToSVG=function(s,t,c){c=i.checkoptions(c),i.loadImage(s,function(a){t(i.imagedataToSVG(i.getImgdata(a),c))},c)},this.imagedataToSVG=function(s,t){t=i.checkoptions(t);var c=i.imagedataToTracedata(s,t);return i.getsvgstring(c,t)},this.imageToTracedata=function(s,t,c){c=i.checkoptions(c),i.loadImage(s,function(a){t(i.imagedataToTracedata(i.getImgdata(a),c))},c)},this.imagedataToTracedata=function(s,t){t=i.checkoptions(t);var c=i.colorquantization(s,t);if(t.layering===0)for(var a={layers:[],palette:c.palette,width:c.array[0].length-2,height:c.array.length-2},n=0;n<c.palette.length;n++){var o=i.batchtracepaths(i.internodes(i.pathscan(i.layeringstep(c,n),t.pathomit),t),t.ltres,t.qtres);a.layers.push(o)}else{var l=i.layering(c);t.layercontainerid&&i.drawLayers(l,i.specpalette,t.scale,t.layercontainerid);var r=i.batchpathscan(l,t.pathomit),d=i.batchinternodes(r,t),a={layers:i.batchtracelayers(d,t.ltres,t.qtres),palette:c.palette,width:s.width,height:s.height}}return a},this.optionpresets={default:{corsenabled:!1,ltres:1,qtres:1,pathomit:8,rightangleenhance:!0,colorsampling:2,numberofcolors:16,mincolorratio:0,colorquantcycles:3,layering:0,strokewidth:1,linefilter:!1,scale:1,roundcoords:1,viewbox:!1,desc:!1,lcpr:0,qcpr:0,blurradius:0,blurdelta:20},posterized1:{colorsampling:0,numberofcolors:2},posterized2:{numberofcolors:4,blurradius:5},curvy:{ltres:.01,linefilter:!0,rightangleenhance:!1},sharp:{qtres:.01,linefilter:!1},detailed:{pathomit:0,roundcoords:2,ltres:.5,qtres:.5,numberofcolors:64},smoothed:{blurradius:5,blurdelta:64},grayscale:{colorsampling:0,colorquantcycles:1,numberofcolors:7},fixedpalette:{colorsampling:0,colorquantcycles:1,numberofcolors:27},randomsampling1:{colorsampling:1,numberofcolors:8},randomsampling2:{colorsampling:1,numberofcolors:64},artistic1:{colorsampling:0,colorquantcycles:1,pathomit:0,blurradius:5,blurdelta:64,ltres:.01,linefilter:!0,numberofcolors:16,strokewidth:2},artistic2:{qtres:.01,colorsampling:0,colorquantcycles:1,numberofcolors:4,strokewidth:0},artistic3:{qtres:10,ltres:10,numberofcolors:8},artistic4:{qtres:10,ltres:10,numberofcolors:64,blurradius:5,blurdelta:256,strokewidth:2},posterized3:{ltres:1,qtres:1,pathomit:20,rightangleenhance:!0,colorsampling:0,numberofcolors:3,mincolorratio:0,colorquantcycles:3,blurradius:3,blurdelta:20,strokewidth:0,linefilter:!1,roundcoords:1,pal:[{r:0,g:0,b:100,a:255},{r:255,g:255,b:255,a:255}]}},this.checkoptions=function(s){s=s||{},typeof s=="string"&&(s=s.toLowerCase(),i.optionpresets[s]?s=i.optionpresets[s]:s={});for(var t=Object.keys(i.optionpresets.default),c=0;c<t.length;c++)s.hasOwnProperty(t[c])||(s[t[c]]=i.optionpresets.default[t[c]]);return s},this.colorquantization=function(s,t){var c=[],a=0,n,o,l,r=[],d=s.width*s.height,h,_,f,g,x;if(s.data.length<d*4){for(var w=new Uint8ClampedArray(d*4),S=0;S<d;S++)w[S*4]=s.data[S*3],w[S*4+1]=s.data[S*3+1],w[S*4+2]=s.data[S*3+2],w[S*4+3]=255;s.data=w}for(_=0;_<s.height+2;_++)for(c[_]=[],h=0;h<s.width+2;h++)c[_][h]=-1;for(t.pal?x=t.pal:t.colorsampling===0?x=i.generatepalette(t.numberofcolors):t.colorsampling===1?x=i.samplepalette(t.numberofcolors,s):x=i.samplepalette2(t.numberofcolors,s),t.blurradius>0&&(s=i.blur(s,t.blurradius,t.blurdelta)),g=0;g<t.colorquantcycles;g++){if(g>0)for(f=0;f<x.length;f++)r[f].n>0&&(x[f]={r:Math.floor(r[f].r/r[f].n),g:Math.floor(r[f].g/r[f].n),b:Math.floor(r[f].b/r[f].n),a:Math.floor(r[f].a/r[f].n)}),r[f].n/d<t.mincolorratio&&g<t.colorquantcycles-1&&(x[f]={r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255),a:Math.floor(Math.random()*255)});for(h=0;h<x.length;h++)r[h]={r:0,g:0,b:0,a:0,n:0};for(_=0;_<s.height;_++)for(h=0;h<s.width;h++){for(a=(_*s.width+h)*4,l=0,o=1024,f=0;f<x.length;f++)n=Math.abs(x[f].r-s.data[a])+Math.abs(x[f].g-s.data[a+1])+Math.abs(x[f].b-s.data[a+2])+Math.abs(x[f].a-s.data[a+3]),n<o&&(o=n,l=f);r[l].r+=s.data[a],r[l].g+=s.data[a+1],r[l].b+=s.data[a+2],r[l].a+=s.data[a+3],r[l].n++,c[_+1][h+1]=l}}return{array:c,palette:x}},this.samplepalette=function(s,t){for(var c,a=[],n=0;n<s;n++)c=Math.floor(Math.random()*t.data.length/4)*4,a.push({r:t.data[c],g:t.data[c+1],b:t.data[c+2],a:t.data[c+3]});return a},this.samplepalette2=function(s,t){for(var c,a=[],n=Math.ceil(Math.sqrt(s)),o=Math.ceil(s/n),l=t.width/(n+1),r=t.height/(o+1),d=0;d<o;d++)for(var h=0;h<n&&a.length!==s;h++)c=Math.floor((d+1)*r*t.width+(h+1)*l)*4,a.push({r:t.data[c],g:t.data[c+1],b:t.data[c+2],a:t.data[c+3]});return a},this.generatepalette=function(s){var t=[],c,a,n;if(s<8)for(var o=Math.floor(255/(s-1)),l=0;l<s;l++)t.push({r:l*o,g:l*o,b:l*o,a:255});else{var r=Math.floor(Math.pow(s,.3333333333333333)),d=Math.floor(255/(r-1)),h=s-r*r*r;for(c=0;c<r;c++)for(a=0;a<r;a++)for(n=0;n<r;n++)t.push({r:c*d,g:a*d,b:n*d,a:255});for(c=0;c<h;c++)t.push({r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255),a:Math.floor(Math.random()*255)})}return t},this.layering=function(s){var t=[],c=0,a=s.array.length,n=s.array[0].length,o,l,r,d,h,_,f,g,x,w,S;for(S=0;S<s.palette.length;S++)for(t[S]=[],w=0;w<a;w++)for(t[S][w]=[],x=0;x<n;x++)t[S][w][x]=0;for(w=1;w<a-1;w++)for(x=1;x<n-1;x++)c=s.array[w][x],o=s.array[w-1][x-1]===c?1:0,l=s.array[w-1][x]===c?1:0,r=s.array[w-1][x+1]===c?1:0,d=s.array[w][x-1]===c?1:0,h=s.array[w][x+1]===c?1:0,_=s.array[w+1][x-1]===c?1:0,f=s.array[w+1][x]===c?1:0,g=s.array[w+1][x+1]===c?1:0,t[c][w+1][x+1]=1+h*2+g*4+f*8,d||(t[c][w+1][x]=2+f*4+_*8),l||(t[c][w][x+1]=0+r*2+h*4+8),o||(t[c][w][x]=0+l*2+4+d*8);return t},this.layeringstep=function(s,t){var c=[],a=s.array.length,n=s.array[0].length,o,l;for(l=0;l<a;l++)for(c[l]=[],o=0;o<n;o++)c[l][o]=0;for(l=1;l<a;l++)for(o=1;o<n;o++)c[l][o]=(s.array[l-1][o-1]===t?1:0)+(s.array[l-1][o]===t?2:0)+(s.array[l][o-1]===t?8:0)+(s.array[l][o]===t?4:0);return c},this.pathscan_combined_lookup=[[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[13,3,0,1],[13,2,-1,0],[7,1,0,-1],[7,0,1,0]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[11,1,0,-1],[14,0,1,0],[14,3,0,1],[11,2,-1,0]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]],this.pathscan=function(s,t){for(var c=[],a=0,n=0,o=0,l=0,r=s[0].length,d=s.length,h=0,_=!0,f=!1,g,x=0;x<d;x++)for(var w=0;w<r;w++)if(s[x][w]==4||s[x][w]==11)for(o=w,l=x,c[a]={},c[a].points=[],c[a].boundingbox=[o,l,o,l],c[a].holechildren=[],_=!1,n=0,f=s[x][w]==11,h=1;!_;){if(c[a].points[n]={},c[a].points[n].x=o-1,c[a].points[n].y=l-1,c[a].points[n].t=s[l][o],o-1<c[a].boundingbox[0]&&(c[a].boundingbox[0]=o-1),o-1>c[a].boundingbox[2]&&(c[a].boundingbox[2]=o-1),l-1<c[a].boundingbox[1]&&(c[a].boundingbox[1]=l-1),l-1>c[a].boundingbox[3]&&(c[a].boundingbox[3]=l-1),g=i.pathscan_combined_lookup[s[l][o]][h],s[l][o]=g[0],h=g[1],o+=g[2],l+=g[3],o-1===c[a].points[0].x&&l-1===c[a].points[0].y)if(_=!0,c[a].points.length<t)c.pop();else{if(c[a].isholepath=!!f,f){for(var S=0,M=[-1,-1,r+1,d+1],R=0;R<a;R++)!c[R].isholepath&&i.boundingboxincludes(c[R].boundingbox,c[a].boundingbox)&&i.boundingboxincludes(M,c[R].boundingbox)&&(S=R,M=c[R].boundingbox);c[S].holechildren.push(a)}a++}n++}return c},this.boundingboxincludes=function(s,t){return s[0]<t[0]&&s[1]<t[1]&&s[2]>t[2]&&s[3]>t[3]},this.batchpathscan=function(s,t){var c=[];for(var a in s)s.hasOwnProperty(a)&&(c[a]=i.pathscan(s[a],t));return c},this.internodes=function(s,t){var c=[],a=0,n=0,o=0,l=0,r=0,d,h;for(d=0;d<s.length;d++)for(c[d]={},c[d].points=[],c[d].boundingbox=s[d].boundingbox,c[d].holechildren=s[d].holechildren,c[d].isholepath=s[d].isholepath,a=s[d].points.length,h=0;h<a;h++)n=(h+1)%a,o=(h+2)%a,l=(h-1+a)%a,r=(h-2+a)%a,t.rightangleenhance&&i.testrightangle(s[d],r,l,h,n,o)&&(c[d].points.length>0&&(c[d].points[c[d].points.length-1].linesegment=i.getdirection(c[d].points[c[d].points.length-1].x,c[d].points[c[d].points.length-1].y,s[d].points[h].x,s[d].points[h].y)),c[d].points.push({x:s[d].points[h].x,y:s[d].points[h].y,linesegment:i.getdirection(s[d].points[h].x,s[d].points[h].y,(s[d].points[h].x+s[d].points[n].x)/2,(s[d].points[h].y+s[d].points[n].y)/2)})),c[d].points.push({x:(s[d].points[h].x+s[d].points[n].x)/2,y:(s[d].points[h].y+s[d].points[n].y)/2,linesegment:i.getdirection((s[d].points[h].x+s[d].points[n].x)/2,(s[d].points[h].y+s[d].points[n].y)/2,(s[d].points[n].x+s[d].points[o].x)/2,(s[d].points[n].y+s[d].points[o].y)/2)});return c},this.testrightangle=function(s,t,c,a,n,o){return s.points[a].x===s.points[t].x&&s.points[a].x===s.points[c].x&&s.points[a].y===s.points[n].y&&s.points[a].y===s.points[o].y||s.points[a].y===s.points[t].y&&s.points[a].y===s.points[c].y&&s.points[a].x===s.points[n].x&&s.points[a].x===s.points[o].x},this.getdirection=function(s,t,c,a){var n=8;return s<c?t<a?n=1:t>a?n=7:n=0:s>c?t<a?n=3:t>a?n=5:n=4:t<a?n=2:t>a?n=6:n=8,n},this.batchinternodes=function(s,t){var c=[];for(var a in s)s.hasOwnProperty(a)&&(c[a]=i.internodes(s[a],t));return c},this.tracepath=function(s,t,c){var a=0,n,o,l,r={};for(r.segments=[],r.boundingbox=s.boundingbox,r.holechildren=s.holechildren,r.isholepath=s.isholepath;a<s.points.length;){for(n=s.points[a].linesegment,o=-1,l=a+1;(s.points[l].linesegment===n||s.points[l].linesegment===o||o===-1)&&l<s.points.length-1;)s.points[l].linesegment!==n&&o===-1&&(o=s.points[l].linesegment),l++;l===s.points.length-1&&(l=0),r.segments=r.segments.concat(i.fitseq(s,t,c,a,l)),l>0?a=l:a=s.points.length}return r},this.fitseq=function(s,t,c,a,n){if(n>s.points.length||n<0)return[];var o=a,l=0,r=!0,d,h,_,f=n-a;f<0&&(f+=s.points.length);for(var g=(s.points[n].x-s.points[a].x)/f,x=(s.points[n].y-s.points[a].y)/f,w=(a+1)%s.points.length,S;w!=n;)S=w-a,S<0&&(S+=s.points.length),d=s.points[a].x+g*S,h=s.points[a].y+x*S,_=(s.points[w].x-d)*(s.points[w].x-d)+(s.points[w].y-h)*(s.points[w].y-h),_>t&&(r=!1),_>l&&(o=w,l=_),w=(w+1)%s.points.length;if(r)return[{type:"L",x1:s.points[a].x,y1:s.points[a].y,x2:s.points[n].x,y2:s.points[n].y}];var M=o;r=!0,l=0;var R=(M-a)/f,C=(1-R)*(1-R),u=2*(1-R)*R,m=R*R,y=(C*s.points[a].x+m*s.points[n].x-s.points[M].x)/-u,v=(C*s.points[a].y+m*s.points[n].y-s.points[M].y)/-u;for(w=a+1;w!=n;)R=(w-a)/f,C=(1-R)*(1-R),u=2*(1-R)*R,m=R*R,d=C*s.points[a].x+u*y+m*s.points[n].x,h=C*s.points[a].y+u*v+m*s.points[n].y,_=(s.points[w].x-d)*(s.points[w].x-d)+(s.points[w].y-h)*(s.points[w].y-h),_>c&&(r=!1),_>l&&(o=w,l=_),w=(w+1)%s.points.length;if(r)return[{type:"Q",x1:s.points[a].x,y1:s.points[a].y,x2:y,y2:v,x3:s.points[n].x,y3:s.points[n].y}];var T=M;return i.fitseq(s,t,c,a,T).concat(i.fitseq(s,t,c,T,n))},this.batchtracepaths=function(s,t,c){var a=[];for(var n in s)s.hasOwnProperty(n)&&a.push(i.tracepath(s[n],t,c));return a},this.batchtracelayers=function(s,t,c){var a=[];for(var n in s)s.hasOwnProperty(n)&&(a[n]=i.batchtracepaths(s[n],t,c));return a},this.roundtodec=function(s,t){return+s.toFixed(t)},this.svgpathstring=function(s,t,c,a){var n=s.layers[t],o=n[c],l="",r;if(a.linefilter&&o.segments.length<3)return l;if(l="<path "+(a.desc?'desc="l '+t+" p "+c+'" ':"")+i.tosvgcolorstr(s.palette[t],a)+'d="',a.roundcoords===-1){for(l+="M "+o.segments[0].x1*a.scale+" "+o.segments[0].y1*a.scale+" ",r=0;r<o.segments.length;r++)l+=o.segments[r].type+" "+o.segments[r].x2*a.scale+" "+o.segments[r].y2*a.scale+" ",o.segments[r].hasOwnProperty("x3")&&(l+=o.segments[r].x3*a.scale+" "+o.segments[r].y3*a.scale+" ");l+="Z "}else{for(l+="M "+i.roundtodec(o.segments[0].x1*a.scale,a.roundcoords)+" "+i.roundtodec(o.segments[0].y1*a.scale,a.roundcoords)+" ",r=0;r<o.segments.length;r++)l+=o.segments[r].type+" "+i.roundtodec(o.segments[r].x2*a.scale,a.roundcoords)+" "+i.roundtodec(o.segments[r].y2*a.scale,a.roundcoords)+" ",o.segments[r].hasOwnProperty("x3")&&(l+=i.roundtodec(o.segments[r].x3*a.scale,a.roundcoords)+" "+i.roundtodec(o.segments[r].y3*a.scale,a.roundcoords)+" ");l+="Z "}for(var d=0;d<o.holechildren.length;d++){var h=n[o.holechildren[d]];if(a.roundcoords===-1)for(h.segments[h.segments.length-1].hasOwnProperty("x3")?l+="M "+h.segments[h.segments.length-1].x3*a.scale+" "+h.segments[h.segments.length-1].y3*a.scale+" ":l+="M "+h.segments[h.segments.length-1].x2*a.scale+" "+h.segments[h.segments.length-1].y2*a.scale+" ",r=h.segments.length-1;r>=0;r--)l+=h.segments[r].type+" ",h.segments[r].hasOwnProperty("x3")&&(l+=h.segments[r].x2*a.scale+" "+h.segments[r].y2*a.scale+" "),l+=h.segments[r].x1*a.scale+" "+h.segments[r].y1*a.scale+" ";else for(h.segments[h.segments.length-1].hasOwnProperty("x3")?l+="M "+i.roundtodec(h.segments[h.segments.length-1].x3*a.scale)+" "+i.roundtodec(h.segments[h.segments.length-1].y3*a.scale)+" ":l+="M "+i.roundtodec(h.segments[h.segments.length-1].x2*a.scale)+" "+i.roundtodec(h.segments[h.segments.length-1].y2*a.scale)+" ",r=h.segments.length-1;r>=0;r--)l+=h.segments[r].type+" ",h.segments[r].hasOwnProperty("x3")&&(l+=i.roundtodec(h.segments[r].x2*a.scale)+" "+i.roundtodec(h.segments[r].y2*a.scale)+" "),l+=i.roundtodec(h.segments[r].x1*a.scale)+" "+i.roundtodec(h.segments[r].y1*a.scale)+" ";l+="Z "}if(l+='" />',a.lcpr||a.qcpr){for(r=0;r<o.segments.length;r++)o.segments[r].hasOwnProperty("x3")&&a.qcpr&&(l+='<circle cx="'+o.segments[r].x2*a.scale+'" cy="'+o.segments[r].y2*a.scale+'" r="'+a.qcpr+'" fill="cyan" stroke-width="'+a.qcpr*.2+'" stroke="black" />',l+='<circle cx="'+o.segments[r].x3*a.scale+'" cy="'+o.segments[r].y3*a.scale+'" r="'+a.qcpr+'" fill="white" stroke-width="'+a.qcpr*.2+'" stroke="black" />',l+='<line x1="'+o.segments[r].x1*a.scale+'" y1="'+o.segments[r].y1*a.scale+'" x2="'+o.segments[r].x2*a.scale+'" y2="'+o.segments[r].y2*a.scale+'" stroke-width="'+a.qcpr*.2+'" stroke="cyan" />',l+='<line x1="'+o.segments[r].x2*a.scale+'" y1="'+o.segments[r].y2*a.scale+'" x2="'+o.segments[r].x3*a.scale+'" y2="'+o.segments[r].y3*a.scale+'" stroke-width="'+a.qcpr*.2+'" stroke="cyan" />'),!o.segments[r].hasOwnProperty("x3")&&a.lcpr&&(l+='<circle cx="'+o.segments[r].x2*a.scale+'" cy="'+o.segments[r].y2*a.scale+'" r="'+a.lcpr+'" fill="white" stroke-width="'+a.lcpr*.2+'" stroke="black" />');for(var d=0;d<o.holechildren.length;d++){var h=n[o.holechildren[d]];for(r=0;r<h.segments.length;r++)h.segments[r].hasOwnProperty("x3")&&a.qcpr&&(l+='<circle cx="'+h.segments[r].x2*a.scale+'" cy="'+h.segments[r].y2*a.scale+'" r="'+a.qcpr+'" fill="cyan" stroke-width="'+a.qcpr*.2+'" stroke="black" />',l+='<circle cx="'+h.segments[r].x3*a.scale+'" cy="'+h.segments[r].y3*a.scale+'" r="'+a.qcpr+'" fill="white" stroke-width="'+a.qcpr*.2+'" stroke="black" />',l+='<line x1="'+h.segments[r].x1*a.scale+'" y1="'+h.segments[r].y1*a.scale+'" x2="'+h.segments[r].x2*a.scale+'" y2="'+h.segments[r].y2*a.scale+'" stroke-width="'+a.qcpr*.2+'" stroke="cyan" />',l+='<line x1="'+h.segments[r].x2*a.scale+'" y1="'+h.segments[r].y2*a.scale+'" x2="'+h.segments[r].x3*a.scale+'" y2="'+h.segments[r].y3*a.scale+'" stroke-width="'+a.qcpr*.2+'" stroke="cyan" />'),!h.segments[r].hasOwnProperty("x3")&&a.lcpr&&(l+='<circle cx="'+h.segments[r].x2*a.scale+'" cy="'+h.segments[r].y2*a.scale+'" r="'+a.lcpr+'" fill="white" stroke-width="'+a.lcpr*.2+'" stroke="black" />')}}return l},this.getsvgstring=function(s,t){t=i.checkoptions(t);for(var c=s.width*t.scale,a=s.height*t.scale,n="<svg "+(t.viewbox?'viewBox="0 0 '+c+" "+a+'" ':'width="'+c+'" height="'+a+'" ')+'version="1.1" xmlns="http://www.w3.org/2000/svg" desc="Created with imagetracer.js version '+i.versionnumber+'" >',o=0;o<s.layers.length;o++)for(var l=0;l<s.layers[o].length;l++)s.layers[o][l].isholepath||(n+=i.svgpathstring(s,o,l,t));return n+="</svg>",n},this.compareNumbers=function(s,t){return s-t},this.torgbastr=function(s){return"rgba("+s.r+","+s.g+","+s.b+","+s.a+")"},this.tosvgcolorstr=function(s,t){return'fill="rgb('+s.r+","+s.g+","+s.b+')" stroke="rgb('+s.r+","+s.g+","+s.b+')" stroke-width="'+t.strokewidth+'" opacity="'+s.a/255+'" '},this.appendSVGString=function(s,t){var c;t?(c=document.getElementById(t),c||(c=document.createElement("div"),c.id=t,document.body.appendChild(c))):(c=document.createElement("div"),document.body.appendChild(c)),c.innerHTML+=s},this.gks=[[.27901,.44198,.27901],[.135336,.228569,.272192,.228569,.135336],[.086776,.136394,.178908,.195843,.178908,.136394,.086776],[.063327,.093095,.122589,.144599,.152781,.144599,.122589,.093095,.063327],[.049692,.069304,.089767,.107988,.120651,.125194,.120651,.107988,.089767,.069304,.049692]],this.blur=function(s,t,c){var a,n,o,l,r,d,h,_,f,g,x={width:s.width,height:s.height,data:[]};if(t=Math.floor(t),t<1)return s;t>5&&(t=5),c=Math.abs(c),c>1024&&(c=1024);var w=i.gks[t-1];for(n=0;n<s.height;n++)for(a=0;a<s.width;a++){for(d=0,h=0,_=0,f=0,g=0,o=-t;o<t+1;o++)a+o>0&&a+o<s.width&&(r=(n*s.width+a+o)*4,d+=s.data[r]*w[o+t],h+=s.data[r+1]*w[o+t],_+=s.data[r+2]*w[o+t],f+=s.data[r+3]*w[o+t],g+=w[o+t]);r=(n*s.width+a)*4,x.data[r]=Math.floor(d/g),x.data[r+1]=Math.floor(h/g),x.data[r+2]=Math.floor(_/g),x.data[r+3]=Math.floor(f/g)}var S=new Uint8ClampedArray(x.data);for(n=0;n<s.height;n++)for(a=0;a<s.width;a++){for(d=0,h=0,_=0,f=0,g=0,o=-t;o<t+1;o++)n+o>0&&n+o<s.height&&(r=((n+o)*s.width+a)*4,d+=S[r]*w[o+t],h+=S[r+1]*w[o+t],_+=S[r+2]*w[o+t],f+=S[r+3]*w[o+t],g+=w[o+t]);r=(n*s.width+a)*4,x.data[r]=Math.floor(d/g),x.data[r+1]=Math.floor(h/g),x.data[r+2]=Math.floor(_/g),x.data[r+3]=Math.floor(f/g)}for(n=0;n<s.height;n++)for(a=0;a<s.width;a++)r=(n*s.width+a)*4,l=Math.abs(x.data[r]-s.data[r])+Math.abs(x.data[r+1]-s.data[r+1])+Math.abs(x.data[r+2]-s.data[r+2])+Math.abs(x.data[r+3]-s.data[r+3]),l>c&&(x.data[r]=s.data[r],x.data[r+1]=s.data[r+1],x.data[r+2]=s.data[r+2],x.data[r+3]=s.data[r+3]);return x},this.loadImage=function(s,t,c){var a=new Image;c&&c.corsenabled&&(a.crossOrigin="Anonymous"),a.onload=function(){var n=document.createElement("canvas");n.width=a.width,n.height=a.height;var o=n.getContext("2d");o.drawImage(a,0,0),t(n)},a.src=s},this.getImgdata=function(s){var t=s.getContext("2d");return t.getImageData(0,0,s.width,s.height)},this.specpalette=[{r:0,g:0,b:0,a:255},{r:128,g:128,b:128,a:255},{r:0,g:0,b:128,a:255},{r:64,g:64,b:128,a:255},{r:192,g:192,b:192,a:255},{r:255,g:255,b:255,a:255},{r:128,g:128,b:192,a:255},{r:0,g:0,b:192,a:255},{r:128,g:0,b:0,a:255},{r:128,g:64,b:64,a:255},{r:128,g:0,b:128,a:255},{r:168,g:168,b:168,a:255},{r:192,g:128,b:128,a:255},{r:192,g:0,b:0,a:255},{r:255,g:255,b:255,a:255},{r:0,g:128,b:0,a:255}],this.drawLayers=function(s,t,c,a){c=c||1;var n,o,l,r,d,h;a?(h=document.getElementById(a),h||(h=document.createElement("div"),h.id=a,document.body.appendChild(h))):(h=document.createElement("div"),document.body.appendChild(h));for(d in s)if(s.hasOwnProperty(d)){n=s[d][0].length,o=s[d].length;var _=document.createElement("canvas");_.width=n*c,_.height=o*c;var f=_.getContext("2d");for(r=0;r<o;r++)for(l=0;l<n;l++)f.fillStyle=i.torgbastr(t[s[d][r][l]%t.length]),f.fillRect(l*c,r*c,c,c);h.appendChild(_)}}}typeof define=="function"&&define.amd?define(function(){return new e}):typeof module<"u"?module.exports=new e:typeof self<"u"?self.ImageTracer=new e:window.ImageTracer=new e})();/*! jQuery UI - v1.14.1 - 2024-11-08
* https://jqueryui.com
* Includes: widget.js, keycode.js, widgets/mouse.js, widgets/slider.js
* Copyright OpenJS Foundation and other contributors; Licensed MIT */(e=>{typeof define=="function"&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){e.ui=e.ui||{},e.ui.version="1.14.1";var i,s=0,t=Array.prototype.hasOwnProperty,c=Array.prototype.slice,a=(e.cleanData=(i=e.cleanData,function(n){for(var o,l,r=0;(l=n[r])!=null;r++)(o=e._data(l,"events"))&&o.remove&&e(l).triggerHandler("remove");i(n)}),e.widget=function(n,o,l){var r,d,h,_,f={},g=n.split(".")[0];return(n=n.split(".")[1])==="__proto__"||n==="constructor"?e.error("Invalid widget name: "+n):(_=g+"-"+n,l||(l=o,o=e.Widget),Array.isArray(l)&&(l=e.extend.apply(null,[{}].concat(l))),e.expr.pseudos[_.toLowerCase()]=function(x){return!!e.data(x,_)},e[g]=e[g]||{},r=e[g][n],d=e[g][n]=function(x,w){if(!this||!this._createWidget)return new d(x,w);arguments.length&&this._createWidget(x,w)},e.extend(d,r,{version:l.version,_proto:e.extend({},l),_childConstructors:[]}),(h=new o).options=e.widget.extend({},h.options),e.each(l,function(x,w){function S(){return o.prototype[x].apply(this,arguments)}function M(R){return o.prototype[x].apply(this,R)}f[x]=typeof w!="function"?w:function(){var R,C=this._super,u=this._superApply;return this._super=S,this._superApply=M,R=w.apply(this,arguments),this._super=C,this._superApply=u,R}}),d.prototype=e.widget.extend(h,{widgetEventPrefix:r&&h.widgetEventPrefix||n},f,{constructor:d,namespace:g,widgetName:n,widgetFullName:_}),r?(e.each(r._childConstructors,function(x,w){var S=w.prototype;e.widget(S.namespace+"."+S.widgetName,d,w._proto)}),delete r._childConstructors):o._childConstructors.push(d),e.widget.bridge(n,d),d)},e.widget.extend=function(n){for(var o,l,r=c.call(arguments,1),d=0,h=r.length;d<h;d++)for(o in r[d])l=r[d][o],t.call(r[d],o)&&l!==void 0&&(e.isPlainObject(l)?n[o]=e.isPlainObject(n[o])?e.widget.extend({},n[o],l):e.widget.extend({},l):n[o]=l);return n},e.widget.bridge=function(n,o){var l=o.prototype.widgetFullName||n;e.fn[n]=function(r){var d=typeof r=="string",h=c.call(arguments,1),_=this;return d?this.length||r!=="instance"?this.each(function(){var f,g=e.data(this,l);return r==="instance"?(_=g,!1):g?typeof g[r]!="function"||r.charAt(0)==="_"?e.error("no such method '"+r+"' for "+n+" widget instance"):(f=g[r].apply(g,h))!==g&&f!==void 0?(_=f&&f.jquery?_.pushStack(f.get()):f,!1):void 0:e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+r+"'")}):_=void 0:(h.length&&(r=e.widget.extend.apply(null,[r].concat(h))),this.each(function(){var f=e.data(this,l);f?(f.option(r||{}),f._init&&f._init()):e.data(this,l,new o(r,this))})),_}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(n,o){o=e(o||this.defaultElement||this)[0],this.element=e(o),this.uuid=s++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),this.classesElementLookup={},o!==this&&(e.data(o,this.widgetFullName,this),this._on(!0,this.element,{remove:function(l){l.target===o&&this.destroy()}}),this.document=e(o.style?o.ownerDocument:o.document||o),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),n),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){var n=this;this._destroy(),e.each(this.classesElementLookup,function(o,l){n._removeClass(l,o)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:e.noop,widget:function(){return this.element},option:function(n,o){var l,r,d,h=n;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof n=="string")if(h={},n=(l=n.split(".")).shift(),l.length){for(r=h[n]=e.widget.extend({},this.options[n]),d=0;d<l.length-1;d++)r[l[d]]=r[l[d]]||{},r=r[l[d]];if(n=l.pop(),arguments.length===1)return r[n]===void 0?null:r[n];r[n]=o}else{if(arguments.length===1)return this.options[n]===void 0?null:this.options[n];h[n]=o}return this._setOptions(h),this},_setOptions:function(n){for(var o in n)this._setOption(o,n[o]);return this},_setOption:function(n,o){return n==="classes"&&this._setOptionClasses(o),this.options[n]=o,n==="disabled"&&this._setOptionDisabled(o),this},_setOptionClasses:function(n){var o,l,r;for(o in n)r=this.classesElementLookup[o],n[o]!==this.options.classes[o]&&r&&r.length&&(l=e(r.get()),this._removeClass(r,o),l.addClass(this._classes({element:l,keys:o,classes:n,add:!0})))},_setOptionDisabled:function(n){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!n),n&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(n){var o=[],l=this;function r(d,h){for(var _,f=0;f<d.length;f++)_=l.classesElementLookup[d[f]]||e(),_=n.add?((()=>{var g=[];n.element.each(function(x,w){e.map(l.classesElementLookup,function(S){return S}).some(function(S){return S.is(w)})||g.push(w)}),l._on(e(g),{remove:"_untrackClassesElement"})})(),e(e.uniqueSort(_.get().concat(n.element.get())))):e(_.not(n.element).get()),l.classesElementLookup[d[f]]=_,o.push(d[f]),h&&n.classes[d[f]]&&o.push(n.classes[d[f]])}return(n=e.extend({element:this.element,classes:this.options.classes||{}},n)).keys&&r(n.keys.match(/\S+/g)||[],!0),n.extra&&r(n.extra.match(/\S+/g)||[]),o.join(" ")},_untrackClassesElement:function(n){var o=this;e.each(o.classesElementLookup,function(l,r){e.inArray(n.target,r)!==-1&&(o.classesElementLookup[l]=e(r.not(n.target).get()))}),this._off(e(n.target))},_removeClass:function(n,o,l){return this._toggleClass(n,o,l,!1)},_addClass:function(n,o,l){return this._toggleClass(n,o,l,!0)},_toggleClass:function(n,h,l,r){var d=typeof n=="string"||n===null,h={extra:d?h:l,keys:d?n:h,element:d?this.element:n,add:r=typeof r=="boolean"?r:l};return h.element.toggleClass(this._classes(h),r),this},_on:function(n,o,l){var r,d=this;typeof n!="boolean"&&(l=o,o=n,n=!1),l?(o=r=e(o),this.bindings=this.bindings.add(o)):(l=o,o=this.element,r=this.widget()),e.each(l,function(x,_){function f(){if(n||d.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled"))return(typeof _=="string"?d[_]:_).apply(d,arguments)}typeof _!="string"&&(f.guid=_.guid=_.guid||f.guid||e.guid++);var x=x.match(/^([\w:-]*)\s*(.*)$/),g=x[1]+d.eventNamespace,x=x[2];x?r.on(g,x,f):o.on(g,f)})},_off:function(n,o){o=(o||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,n.off(o),this.bindings=e(this.bindings.not(n).get()),this.focusable=e(this.focusable.not(n).get()),this.hoverable=e(this.hoverable.not(n).get())},_delay:function(n,o){var l=this;return setTimeout(function(){return(typeof n=="string"?l[n]:n).apply(l,arguments)},o||0)},_hoverable:function(n){this.hoverable=this.hoverable.add(n),this._on(n,{mouseenter:function(o){this._addClass(e(o.currentTarget),null,"ui-state-hover")},mouseleave:function(o){this._removeClass(e(o.currentTarget),null,"ui-state-hover")}})},_focusable:function(n){this.focusable=this.focusable.add(n),this._on(n,{focusin:function(o){this._addClass(e(o.currentTarget),null,"ui-state-focus")},focusout:function(o){this._removeClass(e(o.currentTarget),null,"ui-state-focus")}})},_trigger:function(n,o,l){var r,d,h=this.options[n];if(l=l||{},(o=e.Event(o)).type=(n===this.widgetEventPrefix?n:this.widgetEventPrefix+n).toLowerCase(),o.target=this.element[0],d=o.originalEvent)for(r in d)r in o||(o[r]=d[r]);return this.element.trigger(o,l),!(typeof h=="function"&&h.apply(this.element[0],[o].concat(l))===!1||o.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(n,o){e.Widget.prototype["_"+n]=function(l,r,d){var h,_=(r=typeof r=="string"?{effect:r}:r)?r!==!0&&typeof r!="number"&&r.effect||o:n;typeof(r=r||{})=="number"?r={duration:r}:r===!0&&(r={}),h=!e.isEmptyObject(r),r.complete=d,r.delay&&l.delay(r.delay),h&&e.effects&&e.effects.effect[_]?l[n](r):_!==n&&l[_]?l[_](r.duration,r.easing,d):l.queue(function(f){e(this)[n](),d&&d.call(l[0]),f()})}}),e.widget,e.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},!1);e(document).on("mouseup",function(){a=!1}),e.widget("ui.mouse",{version:"1.14.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var n=this;this.element.on("mousedown."+this.widgetName,function(o){return n._mouseDown(o)}).on("click."+this.widgetName,function(o){if(e.data(o.target,n.widgetName+".preventClickEvent")===!0)return e.removeData(o.target,n.widgetName+".preventClickEvent"),o.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){var o,l,r;if(!a)return this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(n),l=(this._mouseDownEvent=n).which===1,r=typeof(o=this).options.cancel=="string"&&e(n.target).closest(this.options.cancel).length,l&&!r&&this._mouseCapture(n)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){o.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?n.preventDefault():(e.data(n.target,this.widgetName+".preventClickEvent")===!0&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(d){return o._mouseMove(d)},this._mouseUpDelegate=function(d){return o._mouseUp(d)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),a=!0)),!0},_mouseMove:function(n){if(this._mouseMoved&&!n.which){if(n.originalEvent.altKey||n.originalEvent.ctrlKey||n.originalEvent.metaKey||n.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(n)}return(n.which||n.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(n),n.preventDefault()):(this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,n)!==!1,this._mouseStarted?this._mouseDrag(n):this._mouseUp(n)),!this._mouseStarted)},_mouseUp:function(n){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,n.target===this._mouseDownEvent.target&&e.data(n.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(n)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,a=!1,n.preventDefault()},_mouseDistanceMet:function(n){return Math.max(Math.abs(this._mouseDownEvent.pageX-n.pageX),Math.abs(this._mouseDownEvent.pageY-n.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),e.widget("ui.slider",e.ui.mouse,{version:"1.14.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var n,o=this.options,l=this.element.find(".ui-slider-handle"),r=[],d=o.values&&o.values.length||1;for(l.length>d&&(l.slice(d).remove(),l=l.slice(0,d)),n=l.length;n<d;n++)r.push("<span tabindex='0'></span>");this.handles=l.add(e(r.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(h){e(this).data("ui-slider-handle-index",h).attr("tabIndex",0)})},_createRange:function(){var n=this.options;n.range?(n.range===!0&&(n.values?n.values.length&&n.values.length!==2?n.values=[n.values[0],n.values[0]]:Array.isArray(n.values)&&(n.values=n.values.slice(0)):n.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=e("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),n.range!=="min"&&n.range!=="max"||this._addClass(this.range,"ui-slider-range-"+n.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(n){var o,l,r,d,h,_,f=this,g=this.options;return!g.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),h={x:n.pageX,y:n.pageY},o=this._normValueFromMouse(h),l=this._valueMax()-this._valueMin()+1,this.handles.each(function(x){var w=Math.abs(o-f.values(x));(w<l||l===w&&(x===f._lastChangedValue||f.values(x)===g.min))&&(l=w,r=e(this),d=x)}),this._start(n,d)!==!1)&&(this._mouseSliding=!0,this._handleIndex=d,this._addClass(r,null,"ui-state-active"),r.trigger("focus"),h=r.offset(),_=!e(n.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=_?{left:0,top:0}:{left:n.pageX-h.left-r.width()/2,top:n.pageY-h.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(n,d,o),this._animateOff=!0)},_mouseStart:function(){return!0},_mouseDrag:function(n){var o={x:n.pageX,y:n.pageY},o=this._normValueFromMouse(o);return this._slide(n,this._handleIndex,o),!1},_mouseStop:function(n){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(n,this._handleIndex),this._change(n,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(l){var o,l=this.orientation==="horizontal"?(o=this.elementSize.width,l.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(o=this.elementSize.height,l.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),l=l/o;return(l=1<l?1:l)<0&&(l=0),this.orientation==="vertical"&&(l=1-l),o=this._valueMax()-this._valueMin(),l=this._valueMin()+l*o,this._trimAlignValue(l)},_uiHash:function(n,o,l){var r={handle:this.handles[n],handleIndex:n,value:o!==void 0?o:this.value()};return this._hasMultipleValues()&&(r.value=o!==void 0?o:this.values(n),r.values=l||this.values()),r},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(n,o){return this._trigger("start",n,this._uiHash(o))},_slide:function(n,o,l){var r,d=this.value(),h=this.values();this._hasMultipleValues()&&(r=this.values(o?0:1),d=this.values(o),this.options.values.length===2&&this.options.range===!0&&(l=o===0?Math.min(r,l):Math.max(r,l)),h[o]=l),l!==d&&this._trigger("slide",n,this._uiHash(o,l,h))!==!1&&(this._hasMultipleValues()?this.values(o,l):this.value(l))},_stop:function(n,o){this._trigger("stop",n,this._uiHash(o))},_change:function(n,o){this._keySliding||this._mouseSliding||(this._lastChangedValue=o,this._trigger("change",n,this._uiHash(o)))},value:function(n){if(!arguments.length)return this._value();this.options.value=this._trimAlignValue(n),this._refreshValue(),this._change(null,0)},values:function(n,o){var l,r,d;if(1<arguments.length)this.options.values[n]=this._trimAlignValue(o),this._refreshValue(),this._change(null,n);else{if(!arguments.length)return this._values();if(!Array.isArray(n))return this._hasMultipleValues()?this._values(n):this.value();for(l=this.options.values,r=n,d=0;d<l.length;d+=1)l[d]=this._trimAlignValue(r[d]),this._change(null,d);this._refreshValue()}},_setOption:function(n,o){var l,r=0;switch(n==="range"&&this.options.range===!0&&(o==="min"?(this.options.value=this._values(0),this.options.values=null):o==="max"&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),Array.isArray(this.options.values)&&(r=this.options.values.length),this._super(n,o),n){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(o),this.handles.css(o==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),l=r-1;0<=l;l--)this._change(null,l);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(n){this._super(n),this._toggleClass(null,"ui-state-disabled",!!n)},_value:function(){var n=this.options.value;return this._trimAlignValue(n)},_values:function(n){var o,l;if(arguments.length)return n=this.options.values[n],this._trimAlignValue(n);if(this._hasMultipleValues()){for(o=this.options.values.slice(),l=0;l<o.length;l+=1)o[l]=this._trimAlignValue(o[l]);return o}return[]},_trimAlignValue:function(n){var o,l;return n<=this._valueMin()?this._valueMin():n>=this._valueMax()?this._valueMax():(o=0<this.options.step?this.options.step:1,l=n-(n=(n-this._valueMin())%o),2*Math.abs(n)>=o&&(l+=0<n?o:-o),parseFloat(l.toFixed(5)))},_calculateNewMax:function(){var n=this.options.max,o=this._valueMin(),l=this.options.step;(n=Math.round((n-o)/l)*l+o)>this.options.max&&(n-=l),this.max=parseFloat(n.toFixed(this._precision()))},_precision:function(){var n=this._precisionOf(this.options.step);return n=this.options.min!==null?Math.max(n,this._precisionOf(this.options.min)):n},_precisionOf:function(o){var o=o.toString(),l=o.indexOf(".");return l===-1?0:o.length-l-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(n){n==="vertical"&&this.range.css({width:"",left:""}),n==="horizontal"&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var n,o,l,r,d,h=this.options.range,_=this.options,f=this,g=!this._animateOff&&_.animate,x={};this._hasMultipleValues()?this.handles.each(function(w){o=(f.values(w)-f._valueMin())/(f._valueMax()-f._valueMin())*100,x[f.orientation==="horizontal"?"left":"bottom"]=o+"%",e(this).stop(1,1)[g?"animate":"css"](x,_.animate),f.options.range===!0&&(f.orientation==="horizontal"?(w===0&&f.range.stop(1,1)[g?"animate":"css"]({left:o+"%"},_.animate),w===1&&f.range[g?"animate":"css"]({width:o-n+"%"},{queue:!1,duration:_.animate})):(w===0&&f.range.stop(1,1)[g?"animate":"css"]({bottom:o+"%"},_.animate),w===1&&f.range[g?"animate":"css"]({height:o-n+"%"},{queue:!1,duration:_.animate}))),n=o}):(l=this.value(),r=this._valueMin(),d=this._valueMax(),o=d!==r?(l-r)/(d-r)*100:0,x[this.orientation==="horizontal"?"left":"bottom"]=o+"%",this.handle.stop(1,1)[g?"animate":"css"](x,_.animate),h==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[g?"animate":"css"]({width:o+"%"},_.animate),h==="max"&&this.orientation==="horizontal"&&this.range.stop(1,1)[g?"animate":"css"]({width:100-o+"%"},_.animate),h==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[g?"animate":"css"]({height:o+"%"},_.animate),h==="max"&&this.orientation==="vertical"&&this.range.stop(1,1)[g?"animate":"css"]({height:100-o+"%"},_.animate))},_handleEvents:{keydown:function(n){var o,l,r,d=e(n.target).data("ui-slider-handle-index");switch(n.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n.preventDefault(),this._keySliding||(this._keySliding=!0,this._addClass(e(n.target),null,"ui-state-active"),this._start(n,d)!==!1))break;return}switch(r=this.options.step,o=l=this._hasMultipleValues()?this.values(d):this.value(),n.keyCode){case e.ui.keyCode.HOME:l=this._valueMin();break;case e.ui.keyCode.END:l=this._valueMax();break;case e.ui.keyCode.PAGE_UP:l=this._trimAlignValue(o+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:l=this._trimAlignValue(o-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(o===this._valueMax())return;l=this._trimAlignValue(o+r);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(o===this._valueMin())return;l=this._trimAlignValue(o-r)}this._slide(n,d,l)},keyup:function(n){var o=e(n.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(n,o),this._change(n,o),this._removeClass(e(n.target),null,"ui-state-active"))}}})});console.log("JS 실행:","app-localization.js");(e=>{let i={};function s(S,...M){function R(u){if(AccessKeys.has(u)){const m=AccessKeys.remove(u);if(i[m]){const y=AccessKeys.get(u);return i[m].toUpperCase().indexOf(y.toUpperCase())>-1?i[m]:AccessKeys.has(i[m])?`${AccessKeys.remove(i[m])} (${y})`:`${i[m]} (${y})`}}return i[u]?i[u]:u}function C(u,m){for(let y=0;y<m.length;y++)u=u.replace(`%${y+1}`,m[y]);return u}return C(R(S),M)}const t="jspaint language",c=Array.from(navigator.languages||[navigator.language||navigator.userLanguage]);try{localStorage[t]&&c.unshift(localStorage[t])}catch{}var a={aa:"ET",ab:"GE",abr:"GH",ace:"ID",ach:"UG",ada:"GH",ady:"RU",ae:"IR",aeb:"TN",af:"ZA",agq:"CM",aho:"IN",ak:"GH",akk:"IQ",aln:"XK",alt:"RU",am:"ET",amo:"NG",aoz:"ID",apd:"TG",ar:"EG",arc:"IR","arc-Nbat":"JO","arc-Palm":"SY",arn:"CL",aro:"BO",arq:"DZ",ary:"MA",arz:"EG",as:"IN",asa:"TZ",ase:"US",ast:"ES",atj:"CA",av:"RU",awa:"IN",ay:"BO",az:"AZ","az-Arab":"IR",ba:"RU",bal:"PK",ban:"ID",bap:"NP",bar:"AT",bas:"CM",bax:"CM",bbc:"ID",bbj:"CM",bci:"CI",be:"BY",bej:"SD",bem:"ZM",bew:"ID",bez:"TZ",bfd:"CM",bfq:"IN",bft:"PK",bfy:"IN",bg:"BG",bgc:"IN",bgn:"PK",bgx:"TR",bhb:"IN",bhi:"IN",bhk:"PH",bho:"IN",bi:"VU",bik:"PH",bin:"NG",bjj:"IN",bjn:"ID",bjt:"SN",bkm:"CM",bku:"PH",blt:"VN",bm:"ML",bmq:"ML",bn:"BD",bo:"CN",bpy:"IN",bqi:"IR",bqv:"CI",br:"FR",bra:"IN",brh:"PK",brx:"IN",bs:"BA",bsq:"LR",bss:"CM",bto:"PH",btv:"PK",bua:"RU",buc:"YT",bug:"ID",bum:"CM",bvb:"GQ",byn:"ER",byv:"CM",bze:"ML",ca:"ES",cch:"NG",ccp:"BD",ce:"RU",ceb:"PH",cgg:"UG",ch:"GU",chk:"FM",chm:"RU",cho:"US",chp:"CA",chr:"US",cja:"KH",cjm:"VN",ckb:"IQ",co:"FR",cop:"EG",cps:"PH",cr:"CA",crh:"UA",crj:"CA",crk:"CA",crl:"CA",crm:"CA",crs:"SC",cs:"CZ",csb:"PL",csw:"CA",ctd:"MM",cu:"RU","cu-Glag":"BG",cv:"RU",cy:"GB",da:"DK",dak:"US",dar:"RU",dav:"KE",dcc:"IN",de:"DE",den:"CA",dgr:"CA",dje:"NE",dnj:"CI",doi:"IN",dsb:"DE",dtm:"ML",dtp:"MY",dty:"NP",dua:"CM",dv:"MV",dyo:"SN",dyu:"BF",dz:"BT",ebu:"KE",ee:"GH",efi:"NG",egl:"IT",egy:"EG",eky:"MM",el:"GR",en:"US","en-Shaw":"GB",es:"ES",esu:"US",et:"EE",ett:"IT",eu:"ES",ewo:"CM",ext:"ES",fa:"IR",fan:"GQ",ff:"SN","ff-Adlm":"GN",ffm:"ML",fi:"FI",fia:"SD",fil:"PH",fit:"SE",fj:"FJ",fo:"FO",fon:"BJ",fr:"FR",frc:"US",frp:"FR",frr:"DE",frs:"DE",fub:"CM",fud:"WF",fuf:"GN",fuq:"NE",fur:"IT",fuv:"NG",fvr:"SD",fy:"NL",ga:"IE",gaa:"GH",gag:"MD",gan:"CN",gay:"ID",gbm:"IN",gbz:"IR",gcr:"GF",gd:"GB",gez:"ET",ggn:"NP",gil:"KI",gjk:"PK",gju:"PK",gl:"ES",glk:"IR",gn:"PY",gom:"IN",gon:"IN",gor:"ID",gos:"NL",got:"UA",grc:"CY","grc-Linb":"GR",grt:"IN",gsw:"CH",gu:"IN",gub:"BR",guc:"CO",gur:"GH",guz:"KE",gv:"IM",gvr:"NP",gwi:"CA",ha:"NG",hak:"CN",haw:"US",haz:"AF",he:"IL",hi:"IN",hif:"FJ",hil:"PH",hlu:"TR",hmd:"CN",hnd:"PK",hne:"IN",hnj:"LA",hnn:"PH",hno:"PK",ho:"PG",hoc:"IN",hoj:"IN",hr:"HR",hsb:"DE",hsn:"CN",ht:"HT",hu:"HU",hy:"AM",hz:"NA",ia:"FR",iba:"MY",ibb:"NG",id:"ID",ife:"TG",ig:"NG",ii:"CN",ik:"US",ikt:"CA",ilo:"PH",in:"ID",inh:"RU",is:"IS",it:"IT",iu:"CA",iw:"IL",izh:"RU",ja:"JP",jam:"JM",jgo:"CM",ji:"UA",jmc:"TZ",jml:"NP",jut:"DK",jv:"ID",jw:"ID",ka:"GE",kaa:"UZ",kab:"DZ",kac:"MM",kaj:"NG",kam:"KE",kao:"ML",kbd:"RU",kby:"NE",kcg:"NG",kck:"ZW",kde:"TZ",kdh:"TG",kdt:"TH",kea:"CV",ken:"CM",kfo:"CI",kfr:"IN",kfy:"IN",kg:"CD",kge:"ID",kgp:"BR",kha:"IN",khb:"CN",khn:"IN",khq:"ML",kht:"IN",khw:"PK",ki:"KE",kiu:"TR",kj:"NA",kjg:"LA",kk:"KZ","kk-Arab":"CN",kkj:"CM",kl:"GL",kln:"KE",km:"KH",kmb:"AO",kn:"IN",knf:"SN",ko:"KR",koi:"RU",kok:"IN",kos:"FM",kpe:"LR",krc:"RU",kri:"SL",krj:"PH",krl:"RU",kru:"IN",ks:"IN",ksb:"TZ",ksf:"CM",ksh:"DE",ku:"TR","ku-Arab":"IQ",kum:"RU",kv:"RU",kvr:"ID",kvx:"PK",kw:"GB",kxm:"TH",kxp:"PK",ky:"KG","ky-Arab":"CN","ky-Latn":"TR",la:"VA",lab:"GR",lad:"IL",lag:"TZ",lah:"PK",laj:"UG",lb:"LU",lbe:"RU",lbw:"ID",lcp:"CN",lep:"IN",lez:"RU",lg:"UG",li:"NL",lif:"NP","lif-Limb":"IN",lij:"IT",lis:"CN",ljp:"ID",lki:"IR",lkt:"US",lmn:"IN",lmo:"IT",ln:"CD",lo:"LA",lol:"CD",loz:"ZM",lrc:"IR",lt:"LT",ltg:"LV",lu:"CD",lua:"CD",luo:"KE",luy:"KE",luz:"IR",lv:"LV",lwl:"TH",lzh:"CN",lzz:"TR",mad:"ID",maf:"CM",mag:"IN",mai:"IN",mak:"ID",man:"GM","man-Nkoo":"GN",mas:"KE",maz:"MX",mdf:"RU",mdh:"PH",mdr:"ID",men:"SL",mer:"KE",mfa:"TH",mfe:"MU",mg:"MG",mgh:"MZ",mgo:"CM",mgp:"NP",mgy:"TZ",mh:"MH",mi:"NZ",min:"ID",mis:"IQ",mk:"MK",ml:"IN",mls:"SD",mn:"MN","mn-Mong":"CN",mni:"IN",mnw:"MM",moe:"CA",moh:"CA",mos:"BF",mr:"IN",mrd:"NP",mrj:"RU",mro:"BD",ms:"MY",mt:"MT",mtr:"IN",mua:"CM",mus:"US",mvy:"PK",mwk:"ML",mwr:"IN",mwv:"ID",mxc:"ZW",my:"MM",myv:"RU",myx:"UG",myz:"IR",mzn:"IR",na:"NR",nan:"CN",nap:"IT",naq:"NA",nb:"NO",nch:"MX",nd:"ZW",ndc:"MZ",nds:"DE",ne:"NP",new:"NP",ng:"NA",ngl:"MZ",nhe:"MX",nhw:"MX",nij:"ID",niu:"NU",njo:"IN",nl:"NL",nmg:"CM",nn:"NO",nnh:"CM",no:"NO",nod:"TH",noe:"IN",non:"SE",nqo:"GN",nr:"ZA",nsk:"CA",nso:"ZA",nus:"SS",nv:"US",nxq:"CN",ny:"MW",nym:"TZ",nyn:"UG",nzi:"GH",oc:"FR",om:"ET",or:"IN",os:"GE",osa:"US",otk:"MN",pa:"IN","pa-Arab":"PK",pag:"PH",pal:"IR","pal-Phlp":"CN",pam:"PH",pap:"AW",pau:"PW",pcd:"FR",pcm:"NG",pdc:"US",pdt:"CA",peo:"IR",pfl:"DE",phn:"LB",pka:"IN",pko:"KE",pl:"PL",pms:"IT",pnt:"GR",pon:"FM",pra:"PK",prd:"IR",ps:"AF",pt:"PT",puu:"GA",qu:"PE",quc:"GT",qug:"EC",raj:"IN",rcf:"RE",rej:"ID",rgn:"IT",ria:"IN",rif:"MA",rjs:"NP",rkt:"BD",rm:"CH",rmf:"FI",rmo:"CH",rmt:"IR",rmu:"SE",rn:"BI",rng:"MZ",ro:"RO",rob:"ID",rof:"TZ",rtm:"FJ",ru:"RU",rue:"UA",rug:"SB",rw:"RW",rwk:"TZ",ryu:"JP",sa:"IN",saf:"GH",sah:"RU",saq:"KE",sas:"ID",sat:"IN",sav:"SN",saz:"IN",sbp:"TZ",sc:"IT",sck:"IN",scn:"IT",sco:"GB",scs:"CA",sd:"PK","sd-Deva":"IN","sd-Khoj":"IN","sd-Sind":"IN",sdc:"IT",sdh:"IR",se:"NO",sef:"CI",seh:"MZ",sei:"MX",ses:"ML",sg:"CF",sga:"IE",sgs:"LT",shi:"MA",shn:"MM",si:"LK",sid:"ET",sk:"SK",skr:"PK",sl:"SI",sli:"PL",sly:"ID",sm:"WS",sma:"SE",smj:"SE",smn:"FI",smp:"IL",sms:"FI",sn:"ZW",snk:"ML",so:"SO",sou:"TH",sq:"AL",sr:"RS",srb:"IN",srn:"SR",srr:"SN",srx:"IN",ss:"ZA",ssy:"ER",st:"ZA",stq:"DE",su:"ID",suk:"TZ",sus:"GN",sv:"SE",sw:"TZ",swb:"YT",swc:"CD",swg:"DE",swv:"IN",sxn:"ID",syl:"BD",syr:"IQ",szl:"PL",ta:"IN",taj:"NP",tbw:"PH",tcy:"IN",tdd:"CN",tdg:"NP",tdh:"NP",te:"IN",tem:"SL",teo:"UG",tet:"TL",tg:"TJ","tg-Arab":"PK",th:"TH",thl:"NP",thq:"NP",thr:"NP",ti:"ET",tig:"ER",tiv:"NG",tk:"TM",tkl:"TK",tkr:"AZ",tkt:"NP",tl:"PH",tly:"AZ",tmh:"NE",tn:"ZA",to:"TO",tog:"MW",tpi:"PG",tr:"TR",tru:"TR",trv:"TW",ts:"ZA",tsd:"GR",tsf:"NP",tsg:"PH",tsj:"BT",tt:"RU",ttj:"UG",tts:"TH",ttt:"AZ",tum:"MW",tvl:"TV",twq:"NE",txg:"CN",ty:"PF",tyv:"RU",tzm:"MA",udm:"RU",ug:"CN","ug-Cyrl":"KZ",uga:"SY",uk:"UA",uli:"FM",umb:"AO",und:"US",unr:"IN","unr-Deva":"NP",unx:"IN",ur:"PK",uz:"UZ","uz-Arab":"AF",vai:"LR",ve:"ZA",vec:"IT",vep:"RU",vi:"VN",vic:"SX",vls:"BE",vmf:"DE",vmw:"MZ",vot:"RU",vro:"EE",vun:"TZ",wa:"BE",wae:"CH",wal:"ET",war:"PH",wbp:"AU",wbq:"IN",wbr:"IN",wls:"WF",wni:"KM",wo:"SN",wtm:"IN",wuu:"CN",xav:"BR",xcr:"TR",xh:"ZA",xlc:"TR",xld:"TR",xmf:"GE",xmn:"CN",xmr:"SD",xna:"SA",xnr:"IN",xog:"UG",xpr:"IR",xsa:"YE",xsr:"NP",yao:"MZ",yap:"FM",yav:"CM",ybb:"CM",yo:"NG",yrl:"BR",yua:"MX",yue:"HK","yue-Hans":"CN",za:"CN",zag:"SD",zdj:"KM",zea:"NL",zgh:"MA",zh:"CN","zh-Bopo":"TW","zh-Hanb":"TW","zh-Hant":"TW",zlm:"TG",zmi:"MY",zu:"ZA",zza:"TR"};function n(S){var M=S.toUpperCase().split(/-|_/),R=M.shift(),C=M.pop();if(/^[A-Z]{2}$/.test(C)||(C=a[R.toLowerCase()]),!C)return"";const u=String.fromCodePoint(C.codePointAt(0)-65+127462),m=String.fromCodePoint(C.codePointAt(1)-65+127462);return u+m}const o="en",l=["ar","cs","da","de","el","en","es","fi","fr","he","hu","it","ja","ko","nl","no","pl","pt","pt-br","ru","sk","sl","sv","tr","zh","zh-simplified"],r={ab:[["Abkhazian"],["Аҧсуа Бызшәа","Аҧсшәа"]],aa:[["Afar"],["Afaraf"]],af:[["Afrikaans"],["Afrikaans"]],ak:[["Akan"],["Akan"]],sq:[["Albanian"],["Shqip"]],am:[["Amharic"],["አማርኛ"]],ar:[["Arabic"],["العربية"]],an:[["Aragonese"],["Aragonés"]],hy:[["Armenian"],["Հայերեն"]],as:[["Assamese"],["অসমীয়া"]],av:[["Avaric"],["Авар МацӀ","МагӀарул МацӀ"]],ae:[["Avestan"],["Avesta"]],ay:[["Aymara"],["Aymar Aru"]],az:[["Azerbaijani"],["Azərbaycan Dili"]],bm:[["Bambara"],["Bamanankan"]],ba:[["Bashkir"],["Башҡорт Теле"]],eu:[["Basque"],["Euskara","Euskera"]],be:[["Belarusian"],["Беларуская Мова"]],bn:[["Bengali"],["বাংলা"]],bh:[["Bihari Languages"],["भोजपुरी"]],bi:[["Bislama"],["Bislama"]],bs:[["Bosnian"],["Bosanski Jezik"]],br:[["Breton"],["Brezhoneg"]],bg:[["Bulgarian"],["Български Език"]],my:[["Burmese"],["ဗမာစာ"]],ca:[["Catalan","Valencian"],["Català","Valencià"]],ch:[["Chamorro"],["Chamoru"]],ce:[["Chechen"],["Нохчийн Мотт"]],ny:[["Chichewa","Chewa","Nyanja"],["ChiCheŵa","Chinyanja"]],zh:[["Traditional Chinese"],["繁體中文","傳統中文","正體中文","繁体中文"]],"zh-traditional":[["Traditional Chinese"],["繁體中文","傳統中文","正體中文","繁体中文"]],"zh-simplified":[["Simple Chinese"],["简体中文"]],cv:[["Chuvash"],["Чӑваш Чӗлхи"]],kw:[["Cornish"],["Kernewek"]],co:[["Corsican"],["Corsu","Lingua Corsa"]],cr:[["Cree"],["ᓀᐦᐃᔭᐍᐏᐣ"]],hr:[["Croatian"],["Hrvatski Jezik"]],cs:[["Czech"],["Čeština","Český Jazyk"]],da:[["Danish"],["Dansk"]],dv:[["Divehi","Dhivehi","Maldivian"],["ދިވެހި"]],nl:[["Dutch","Flemish"],["Nederlands","Vlaams"]],dz:[["Dzongkha"],["རྫོང་ཁ"]],en:[["English"],["English"]],eo:[["Esperanto"],["Esperanto"]],et:[["Estonian"],["Eesti","Eesti Keel"]],ee:[["Ewe"],["Eʋegbe"]],fo:[["Faroese"],["Føroyskt"]],fj:[["Fijian"],["Vosa Vakaviti"]],fi:[["Finnish"],["Suomi","Suomen Kieli"]],fr:[["French"],["Français","Langue Française"]],ff:[["Fulah"],["Fulfulde","Pulaar","Pular"]],gl:[["Galician"],["Galego"]],ka:[["Georgian"],["ქართული"]],de:[["German"],["Deutsch"]],el:[["Greek"],["Ελληνικά"]],gn:[["Guarani"],["Avañe'ẽ"]],gu:[["Gujarati"],["ગુજરાતી"]],ht:[["Haitian","Haitian Creole"],["Kreyòl Ayisyen"]],ha:[["Hausa"],["هَوُسَ"]],he:[["Hebrew"],["עברית"]],hz:[["Herero"],["Otjiherero"]],hi:[["Hindi"],["हिन्दी","हिंदी"]],ho:[["Hiri Motu"],["Hiri Motu"]],hu:[["Hungarian"],["Magyar"]],ia:[["Interlingua"],["Interlingua"]],id:[["Indonesian"],["Bahasa Indonesia"]],ie:[["Interlingue","Occidental"],["Interlingue","Occidental"]],ga:[["Irish"],["Gaeilge"]],ig:[["Igbo"],["Asụsụ Igbo"]],ik:[["Inupiaq"],["Iñupiaq","Iñupiatun"]],io:[["Ido"],["Ido"]],is:[["Icelandic"],["Íslenska"]],it:[["Italian"],["Italiano"]],iu:[["Inuktitut"],["ᐃᓄᒃᑎᑐᑦ"]],ja:[["Japanese"],["日本語","にほんご"]],jv:[["Javanese"],["ꦧꦱꦗꦮ","Basa Jawa"]],kl:[["Kalaallisut","Greenlandic"],["Kalaallisut","Kalaallit Oqaasii"]],kn:[["Kannada"],["ಕನ್ನಡ"]],kr:[["Kanuri"],["Kanuri"]],ks:[["Kashmiri"],["कश्मीरी","كشميري‎"]],kk:[["Kazakh"],["Қазақ Тілі"]],km:[["Central Khmer"],["ខ្មែរ","ខេមរភាសា","ភាសាខ្មែរ"]],ki:[["Kikuyu","Gikuyu"],["Gĩkũyũ"]],rw:[["Kinyarwanda"],["Ikinyarwanda"]],ky:[["Kirghiz","Kyrgyz"],["Кыргызча","Кыргыз Тили"]],kv:[["Komi"],["Коми Кыв"]],kg:[["Kongo"],["Kikongo"]],ko:[["Korean"],["한국어"]],ku:[["Kurdish"],["Kurdî","کوردی‎"]],kj:[["Kuanyama","Kwanyama"],["Kuanyama"]],la:[["Latin"],["Latine","Lingua Latina"]],lb:[["Luxembourgish","Letzeburgesch"],["Lëtzebuergesch"]],lg:[["Ganda"],["Luganda"]],li:[["Limburgan","Limburger","Limburgish"],["Limburgs"]],ln:[["Lingala"],["Lingála"]],lo:[["Lao"],["ພາສາລາວ"]],lt:[["Lithuanian"],["Lietuvių Kalba"]],lu:[["Luba-Katanga"],["Kiluba"]],lv:[["Latvian"],["Latviešu Valoda"]],gv:[["Manx"],["Gaelg","Gailck"]],mk:[["Macedonian"],["Македонски Јазик"]],mg:[["Malagasy"],["Fiteny Malagasy"]],ms:[["Malay"],["Bahasa Melayu","بهاس ملايو‎"]],ml:[["Malayalam"],["മലയാളം"]],mt:[["Maltese"],["Malti"]],mi:[["Maori"],["Te Reo Māori"]],mr:[["Marathi"],["मराठी"]],mh:[["Marshallese"],["Kajin M̧ajeļ"]],mn:[["Mongolian"],["Монгол Хэл"]],na:[["Nauru"],["Dorerin Naoero"]],nv:[["Navajo","Navaho"],["Diné Bizaad"]],nd:[["North Ndebele"],["IsiNdebele"]],ne:[["Nepali"],["नेपाली"]],ng:[["Ndonga"],["Owambo"]],nb:[["Norwegian Bokmål"],["Norsk Bokmål"]],nn:[["Norwegian Nynorsk"],["Norsk Nynorsk"]],no:[["Norwegian"],["Norsk"]],ii:[["Sichuan Yi","Nuosu"],["ꆈꌠ꒿","Nuosuhxop"]],nr:[["South Ndebele"],["IsiNdebele"]],oc:[["Occitan"],["Occitan","Lenga d'Òc"]],oj:[["Ojibwa"],["ᐊᓂᔑᓈᐯᒧᐎᓐ"]],cu:[["Church Slavic","Old Slavonic","Church Slavonic","Old Bulgarian","Old Church Slavonic"],["Ѩзыкъ Словѣньскъ"]],om:[["Oromo"],["Afaan Oromoo"]],or:[["Oriya"],["ଓଡ଼ିଆ"]],os:[["Ossetian","Ossetic"],["Ирон Æвзаг"]],pa:[["Punjabi","Panjabi"],["ਪੰਜਾਬੀ","پنجابی‎"]],pi:[["Pali"],["पालि","पाळि"]],fa:[["Persian"],["فارسی"]],pl:[["Polish"],["Język Polski","Polszczyzna"]],ps:[["Pashto","Pushto"],["پښتو"]],pt:[["Portuguese"],["Português"]],"pt-br":[["Brazilian Portuguese"],["Português Brasileiro"]],"pt-pt":[["Portuguese (Portugal)"],["Português De Portugal"]],qu:[["Quechua"],["Runa Simi","Kichwa"]],rm:[["Romansh"],["Rumantsch Grischun"]],rn:[["Rundi"],["Ikirundi"]],ro:[["Romanian","Moldavian","Moldovan"],["Română"]],ru:[["Russian"],["Русский"]],sa:[["Sanskrit"],["संस्कृतम्"]],sc:[["Sardinian"],["Sardu"]],sd:[["Sindhi"],["सिन्धी","سنڌي، سندھی‎"]],se:[["Northern Sami"],["Davvisámegiella"]],sm:[["Samoan"],["Gagana Fa'a Samoa"]],sg:[["Sango"],["Yângâ Tî Sängö"]],sr:[["Serbian"],["Српски Језик"]],gd:[["Gaelic","Scottish Gaelic"],["Gàidhlig"]],sn:[["Shona"],["ChiShona"]],si:[["Sinhala","Sinhalese"],["සිංහල"]],sk:[["Slovak"],["Slovenčina","Slovenský Jazyk"]],sl:[["Slovenian"],["Slovenski Jezik","Slovenščina"]],so:[["Somali"],["Soomaaliga","Af Soomaali"]],st:[["Southern Sotho"],["Sesotho"]],es:[["Spanish","Castilian"],["Español"]],su:[["Sundanese"],["Basa Sunda"]],sw:[["Swahili"],["Kiswahili"]],ss:[["Swati"],["SiSwati"]],sv:[["Swedish"],["Svenska"]],ta:[["Tamil"],["தமிழ்"]],te:[["Telugu"],["తెలుగు"]],tg:[["Tajik"],["Тоҷикӣ","Toçikī","تاجیکی‎"]],th:[["Thai"],["ไทย"]],ti:[["Tigrinya"],["ትግርኛ"]],bo:[["Tibetan"],["བོད་ཡིག"]],tk:[["Turkmen"],["Türkmen","Түркмен"]],tl:[["Tagalog"],["Wikang Tagalog"]],tn:[["Tswana"],["Setswana"]],to:[["Tonga"],["Faka Tonga"]],tr:[["Turkish"],["Türkçe"]],ts:[["Tsonga"],["Xitsonga"]],tt:[["Tatar"],["Татар Теле","Tatar Tele"]],tw:[["Twi"],["Twi"]],ty:[["Tahitian"],["Reo Tahiti"]],ug:[["Uighur","Uyghur"],["ئۇيغۇرچە‎","Uyghurche"]],uk:[["Ukrainian"],["Українська"]],ur:[["Urdu"],["اردو"]],uz:[["Uzbek"],["Oʻzbek","Ўзбек","أۇزبېك‎"]],ve:[["Venda"],["Tshivenḓa"]],vi:[["Vietnamese"],["Tiếng Việt"]],vo:[["Volapük"],["Volapük"]],wa:[["Walloon"],["Walon"]],cy:[["Welsh"],["Cymraeg"]],wo:[["Wolof"],["Wollof"]],fy:[["Western Frisian"],["Frysk"]],xh:[["Xhosa"],["IsiXhosa"]],yi:[["Yiddish"],["ייִדיש"]],yo:[["Yoruba"],["Yorùbá"]],za:[["Zhuang","Chuang"],["Saɯ Cueŋƅ","Saw Cuengh"]],zu:[["Zulu"],["IsiZulu"]]};function d(S){return r[S][0][0]}function h(S){return r[S][1][0]}let _=o;for(const S of c)if(l.indexOf(S)!==-1){_=S;break}function f(){return _}function g(S=_){return S.match(/^(ar|dv|fa|ha|he|ks|ku|ms|pa|ps|sd|ug|yi)\b/i)?"rtl":"ltr"}function x(S){const M=[...document.querySelectorAll(".flippable-layout-stylesheet")];for(const C of M){let u=C.getAttribute("href");g(S)==="rtl"?u.indexOf(".rtl.css")===-1&&(u=u.replace(/\.css$/i,".rtl.css")):u.indexOf(".rtl.css")>-1&&(u=u.replace(/\.rtl\.css$/i,".css")),C.setAttribute("href",u);const m=document.createElement("img");m.onerror=()=>{$(()=>{$G.triggerHandler("theme-load")})},m.src=u}if(S===o){i={},_=o;return}(async C=>{const u=`../localization/${C}/localizations.js`;try{return(await import(u)).default}catch(m){console.error(`Failed to load localization for language ${C}`,m)}})(S).then(C=>{})}window.loaded_localizations=function(M,R){i=R,_=M};function w(S){showMessageBox({title:"Reload Required",message:"The application needs to reload to change the language.",buttons:[{label:s("OK"),value:"reload",default:!0},{label:s("Cancel"),value:"cancel"}],windowOptions:{innerWidth:450}}).then(M=>{M==="reload"&&are_you_sure(()=>{try{localStorage[t]=S,exit_fullscreen_if_ios(),location.reload()}catch(R){show_error_message("Failed to store language preference. Make sure cookies / local storage is enabled in your browser settings.",R)}})})}x(_),e.localize=s,e.set_language=w,e.get_language=f,e.get_iso_language_name=d,e.get_language_endonym=h,e.get_language_emoji=n,e.get_direction=g,e.available_languages=l})(window);console.log("JS 실행:","helpers.js");const TAU=- - - - - - - -Math.PI+Math.PI-0,is_pride_month=new Date().getMonth()===5,$G$1=$(window);function render_access_key(e){return`<span style="white-space: pre">${AccessKeys.toHTML(e)}</span>`}function make_css_cursor(e,i,s){return`url(images/cursors/${e}.png) ${i.join(" ")}, ${s}`}const E=function(i){return document.createElement(i)};function debounce(e,i,s){let t;const c=function(){const a=this,n=arguments,o=()=>{t=null,e.apply(a,n)};clearTimeout(t),t=setTimeout(o,i)};return c.cancel=()=>{clearTimeout(t)},c}function memoize_synchronous_function(e,i=5e4){const s={},t=[],c=(...a)=>{if(a.some(o=>o instanceof CanvasPattern))return e.apply(null,a);const n=JSON.stringify(a);if(s[n])return s[n];{const o=e.apply(null,a);if(s[n]=o,t.push(n),t.length>i){const l=t.shift();delete s[l]}return o}};return c.clear_memo_cache=()=>{for(const a of t)delete s[a];t.length=0},c}const get_rgba_from_color_implementation=e=>{const i=make_canvas(1,1);i.ctx.fillStyle=e,i.ctx.fillRect(0,0,1,1);const s=i.ctx.getImageData(0,0,1,1);return Array.from(s.data)},get_rgba_from_color=memoize_synchronous_function(get_rgba_from_color_implementation);function image_data_match(e,i,s){const t=e.data,c=i.data;if(t.length!==c.length)return!1;for(let a=t.length,n=0;n<a;n++)if(t[n]!==c[n]&&Math.abs(t[n]-c[n])>s)return!1;return!0}function make_canvas(e,i){const s=e,t=E("canvas"),c=t.getContext("2d");return t.ctx=c,c.disable_image_smoothing=()=>{c.imageSmoothingEnabled=!1,c.imageSmoothingEnabled!==!1&&(c.mozImageSmoothingEnabled=!1,c.webkitImageSmoothingEnabled=!1,c.msImageSmoothingEnabled=!1)},c.enable_image_smoothing=()=>{c.imageSmoothingEnabled=!0,c.imageSmoothingEnabled!==!0&&(c.mozImageSmoothingEnabled=!0,c.webkitImageSmoothingEnabled=!0,c.msImageSmoothingEnabled=!0)},c.copy=a=>{t.width=a.naturalWidth||a.width,t.height=a.naturalHeight||a.height,c.disable_image_smoothing(),a instanceof ImageData?c.putImageData(a,0,0):c.drawImage(a,0,0)},e&&i?(t.width=e,t.height=i,c.disable_image_smoothing()):s&&c.copy(s),t}function get_help_folder_icon(e){const i=new Image;return i.src=`help/${e}`,i}function get_icon_for_tool(e){return get_help_folder_icon(e.help_icon)}function load_image_simple(e){return new Promise((i,s)=>{const t=new Image;t.onload=()=>{i(t)},t.onerror=()=>{s(new Error(`failed to load image from ${e}`))},t.src=e})}function get_icon_for_tools(e){if(e.length===1)return get_icon_for_tool(e[0]);const i=make_canvas(16,16);return Promise.all(e.map(s=>load_image_simple(`help/${s.help_icon}`))).then(s=>{s.forEach((t,c)=>{const a=i.width/s.length,n=c*a,o=i.height,l=0;i.ctx.drawImage(t,n,l,a,o,n,l,a,o)})}),i}function get_file_extension(e){var i;return((i=e.match(/\.([^./]+)$/))==null?void 0:i[1])||""}function rgb_to_hsl(e,i,s){e/=255,i/=255,s/=255;var t=Math.max(e,i,s),c=Math.min(e,i,s),a,n,o=(t+c)/2;if(t==c)a=n=0;else{var l=t-c;switch(n=o>.5?l/(2-t-c):l/(t+c),t){case e:a=(i-s)/l+(i<s?6:0);break;case i:a=(s-e)/l+2;break;case s:a=(e-i)/l+4;break}a/=6}return[a,n,o]}function to_canvas_coords({clientX:e,clientY:i}){if(e===void 0||i===void 0)throw new TypeError("clientX and clientY must be defined (not {x, y} or x, y or [x, y])");const s=window.canvas_bounding_client_rect;return{x:~~((e-s.left)/s.width*main_canvas.width),y:~~((i-s.top)/s.height*main_canvas.height)}}function from_canvas_coords({x:e,y:i}){const s=window.canvas_bounding_client_rect;return{clientX:~~(e/main_canvas.width*s.width+s.left),clientY:~~(i/main_canvas.height*s.height+s.top)}}window.$G=$G$1;window.make_canvas=make_canvas;console.log("JS 실행:","$ToolWindow.js");function make_window_supporting_scale(e){const i=$Window(e),s=()=>{if(!i.is(".edit-colors-window, .storage-manager, .attributes-window, .flip-and-rotate, .stretch-and-skew"))return;const t=i.$content[0],c=i.$titlebar[0];let a=1;i.$content.css({transform:`scale(${a})`,transformOrigin:"0 0",marginRight:"",marginBottom:""}),document.body.classList.contains("eye-gaze-mode")&&(a=Math.min(innerWidth/t.offsetWidth,(innerHeight-c.offsetHeight)/t.offsetHeight),i.$content.css({transform:`scale(${a})`,transformOrigin:"0 0",marginRight:t.scrollWidth*(a-1)}),i.$content.css({marginBottom:t.scrollHeight*(a-1)}),i.center())};if(!e.$component){i.center();const t=()=>{requestAnimationFrame(s)},c=()=>{i.off("close",c),$G$1.off("eye-gaze-mode-toggled resize",t)};i.on("close",c),$G$1.on("eye-gaze-mode-toggled resize",t),t()}return e.$component&&i.$content.css({contain:"none"}),i}function $ToolWindow(e){return make_window_supporting_scale({$component:e,toolWindow:!0})}function $DialogWindow(e){const i=make_window_supporting_scale({title:e,resizable:!1,maximizeButton:!1,minimizeButton:!1});i.addClass("dialog-window"),i.$form=$(E("form")).appendTo(i.$content),i.$main=$(E("div")).appendTo(i.$form),i.$buttons=$(E("div")).appendTo(i.$form).addClass("button-group"),i.$Button=(t,c,a={type:"button"})=>{const n=$(E("button")).appendTo(i.$buttons);return n[0].append(t),n.on("click",()=>{c()}),n.on("pointerdown",()=>{n.focus()}),n.attr({type:a.type}),n},i.$form.on("submit",t=>{t.preventDefault()});function s(){i.find("button, input").removeClass("default");let t=$(document.activeElement).closest("button, input[type='submit'], input[type='button'], textarea, select");t.length===0&&(t=i.$form.find('button[type="submit"], input[type="submit"], button:not([type])').first()),t.is("button, input[type='submit'], input[type='button']")&&t.addClass("default")}return i.on("focusin",s),i.on("focusout",()=>{i.find("button, input").removeClass("default")}),setTimeout(()=>{s()},0),i}console.log("JS 실행:","msgbox.js");const exports$1={};function showMessageBox_implementation({title:e=window.defaultMessageBoxTitle??"Alert",message:i,messageHTML:s,buttons:t=[{label:"OK",value:"ok",default:!0}],iconID:c="warning",windowOptions:a={}}){let n,o;const l=new Promise(r=>{n=make_window_supporting_scale(Object.assign({title:e,resizable:!1,innerWidth:400,maximizeButton:!1,minimizeButton:!1},a)),o=$("<div>").css({textAlign:"left",fontFamily:"MS Sans Serif, Arial, sans-serif",fontSize:"14px",marginTop:"22px",flex:1,minWidth:0,whiteSpace:"normal"}),s?o.html(s):i&&o.text(i).css({whiteSpace:"pre-wrap",wordWrap:"break-word"}),$("<div>").append($("<img width='32' height='32'>").attr("src",`images/${c}-32x32-8bpp.png`).css({margin:"16px",display:"block"}),o).css({display:"flex",flexDirection:"row"}).appendTo(n.$content),n.$content.css({textAlign:"center"});for(const d of t){const h=n.$Button(d.label,()=>{var _;(_=d.action)==null||_.call(d),r(d.value),n.close()});d.default&&(h.addClass("default"),h.focus(),setTimeout(()=>h.focus(),0)),h.css({minWidth:75,height:23,margin:"16px 2px"})}n.on("focusin","button",d=>{$(d.currentTarget).addClass("default")}),n.on("focusout","button",d=>{$(d.currentTarget).removeClass("default")}),n.on("closed",()=>{r("closed")}),n.center()});return l.$window=n,l.$message=o,l.promise=l,l}exports$1.showMessageBox=window.showMessageBox||showMessageBox_implementation;window.defaultMessageBoxTitle=localize("Paint");const{showMessageBox:showMessageBox$1}=exports$1;window.showMessageBox=showMessageBox$1;let pdfjs;const pdfjs$1=pdfjs;(function(i,s){typeof exports=="object"&&typeof module=="object"?module.exports=s():typeof define=="function"&&define.amd?define("pdfjs-dist/build/pdf",[],s):typeof exports=="object"?exports["pdfjs-dist/build/pdf"]=s():(window["pdfjs-dist/build/pdf"]=window.pdfjsLib=s(),pdfjs=s())})(void 0,function(){return(()=>{var __webpack_modules__=[,(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.addLinkAttributes=g,i.deprecated=y,i.getFilenameFromUrl=S,i.getPdfFilenameFromUrl=M,i.isDataScheme=x,i.isFetchSupported=C,i.isPdfFile=w,i.isValidFetchUrl=u,i.loadScript=m,i.StatTimer=i.RenderingCancelledException=i.PDFDateString=i.PageViewport=i.LinkTarget=i.DOMSVGFactory=i.DOMCMapReaderFactory=i.DOMCanvasFactory=i.DEFAULT_LINK_REL=i.BaseCMapReaderFactory=i.BaseCanvasFactory=void 0;var t=s(2);const c="noopener noreferrer nofollow";i.DEFAULT_LINK_REL=c;const a="http://www.w3.org/2000/svg";class n{constructor(){this.constructor===n&&(0,t.unreachable)("Cannot initialize BaseCanvasFactory.")}create(L,A){(0,t.unreachable)("Abstract method `create` called.")}reset(L,A,F){if(!L.canvas)throw new Error("Canvas is not specified");if(A<=0||F<=0)throw new Error("Invalid canvas size");L.canvas.width=A,L.canvas.height=F}destroy(L){if(!L.canvas)throw new Error("Canvas is not specified");L.canvas.width=0,L.canvas.height=0,L.canvas=null,L.context=null}}i.BaseCanvasFactory=n;class o extends n{constructor({ownerDocument:L=globalThis.document}={}){super(),this._document=L}create(L,A){if(L<=0||A<=0)throw new Error("Invalid canvas size");const F=this._document.createElement("canvas"),K=F.getContext("2d");return F.width=L,F.height=A,{canvas:F,context:K}}}i.DOMCanvasFactory=o;class l{constructor({baseUrl:L=null,isCompressed:A=!1}){this.constructor===l&&(0,t.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=L,this.isCompressed=A}async fetch({name:L}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!L)throw new Error("CMap name must be specified.");const A=this.baseUrl+L+(this.isCompressed?".bcmap":""),F=this.isCompressed?t.CMapCompressionType.BINARY:t.CMapCompressionType.NONE;return this._fetchData(A,F).catch(K=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${A}`)})}_fetchData(L,A){(0,t.unreachable)("Abstract method `_fetchData` called.")}}i.BaseCMapReaderFactory=l;class r extends l{_fetchData(L,A){return C()&&u(L,document.baseURI)?fetch(L).then(async F=>{if(!F.ok)throw new Error(F.statusText);let K;return this.isCompressed?K=new Uint8Array(await F.arrayBuffer()):K=(0,t.stringToBytes)(await F.text()),{cMapData:K,compressionType:A}}):new Promise((F,K)=>{const Q=new XMLHttpRequest;Q.open("GET",L,!0),this.isCompressed&&(Q.responseType="arraybuffer"),Q.onreadystatechange=()=>{if(Q.readyState===XMLHttpRequest.DONE){if(Q.status===200||Q.status===0){let Z;if(this.isCompressed&&Q.response?Z=new Uint8Array(Q.response):!this.isCompressed&&Q.responseText&&(Z=(0,t.stringToBytes)(Q.responseText)),Z){F({cMapData:Z,compressionType:A});return}}K(new Error(Q.statusText))}},Q.send(null)})}}i.DOMCMapReaderFactory=r;class d{create(L,A){(0,t.assert)(L>0&&A>0,"Invalid SVG dimensions");const F=document.createElementNS(a,"svg:svg");return F.setAttribute("version","1.1"),F.setAttribute("width",L+"px"),F.setAttribute("height",A+"px"),F.setAttribute("preserveAspectRatio","none"),F.setAttribute("viewBox","0 0 "+L+" "+A),F}createElement(L){return(0,t.assert)(typeof L=="string","Invalid SVG element type"),document.createElementNS(a,L)}}i.DOMSVGFactory=d;class h{constructor({viewBox:L,scale:A,rotation:F,offsetX:K=0,offsetY:Q=0,dontFlip:Z=!1}){this.viewBox=L,this.scale=A,this.rotation=F,this.offsetX=K,this.offsetY=Q;const B=(L[2]+L[0])/2,z=(L[3]+L[1])/2;let b,N,U,q;switch(F%=360,F<0&&(F+=360),F){case 180:b=-1,N=0,U=0,q=1;break;case 90:b=0,N=1,U=1,q=0;break;case 270:b=0,N=-1,U=-1,q=0;break;case 0:b=1,N=0,U=0,q=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Z&&(U=-U,q=-q);let j,Y,J,se;b===0?(j=Math.abs(z-L[1])*A+K,Y=Math.abs(B-L[0])*A+Q,J=Math.abs(L[3]-L[1])*A,se=Math.abs(L[2]-L[0])*A):(j=Math.abs(B-L[0])*A+K,Y=Math.abs(z-L[1])*A+Q,J=Math.abs(L[2]-L[0])*A,se=Math.abs(L[3]-L[1])*A),this.transform=[b*A,N*A,U*A,q*A,j-b*A*B-U*A*z,Y-N*A*B-q*A*z],this.width=J,this.height=se}clone({scale:L=this.scale,rotation:A=this.rotation,offsetX:F=this.offsetX,offsetY:K=this.offsetY,dontFlip:Q=!1}={}){return new h({viewBox:this.viewBox.slice(),scale:L,rotation:A,offsetX:F,offsetY:K,dontFlip:Q})}convertToViewportPoint(L,A){return t.Util.applyTransform([L,A],this.transform)}convertToViewportRectangle(L){const A=t.Util.applyTransform([L[0],L[1]],this.transform),F=t.Util.applyTransform([L[2],L[3]],this.transform);return[A[0],A[1],F[0],F[1]]}convertToPdfPoint(L,A){return t.Util.applyInverseTransform([L,A],this.transform)}}i.PageViewport=h;class _ extends t.BaseException{constructor(L,A){super(L),this.type=A}}i.RenderingCancelledException=_;const f={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};i.LinkTarget=f;function g(k,{url:L,target:A,rel:F,enabled:K=!0}={}){(0,t.assert)(L&&typeof L=="string",'addLinkAttributes: A valid "url" parameter must provided.');const Q=(0,t.removeNullCharacters)(L);K?k.href=k.title=Q:(k.href="",k.title=`Disabled: ${Q}`,k.onclick=()=>!1);let Z="";switch(A){case f.NONE:break;case f.SELF:Z="_self";break;case f.BLANK:Z="_blank";break;case f.PARENT:Z="_parent";break;case f.TOP:Z="_top";break}k.target=Z,k.rel=typeof F=="string"?F:c}function x(k){const L=k.length;let A=0;for(;A<L&&k[A].trim()==="";)A++;return k.substring(A,A+5).toLowerCase()==="data:"}function w(k){return typeof k=="string"&&/\.pdf$/i.test(k)}function S(k){const L=k.indexOf("#"),A=k.indexOf("?"),F=Math.min(L>0?L:k.length,A>0?A:k.length);return k.substring(k.lastIndexOf("/",F)+1,F)}function M(k,L="document.pdf"){if(typeof k!="string")return L;if(x(k))return(0,t.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),L;const A=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,F=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,K=A.exec(k);let Q=F.exec(K[1])||F.exec(K[2])||F.exec(K[3]);if(Q&&(Q=Q[0],Q.includes("%")))try{Q=F.exec(decodeURIComponent(Q))[0]}catch{}return Q||L}class R{constructor(){this.started=Object.create(null),this.times=[]}time(L){L in this.started&&(0,t.warn)(`Timer is already running for ${L}`),this.started[L]=Date.now()}timeEnd(L){L in this.started||(0,t.warn)(`Timer has not been started for ${L}`),this.times.push({name:L,start:this.started[L],end:Date.now()}),delete this.started[L]}toString(){const L=[];let A=0;for(const F of this.times){const K=F.name;K.length>A&&(A=K.length)}for(const F of this.times){const K=F.end-F.start;L.push(`${F.name.padEnd(A)} ${K}ms
`)}return L.join("")}}i.StatTimer=R;function C(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&typeof ReadableStream<"u"}function u(k,L){try{const{protocol:A}=L?new URL(k,L):new URL(k);return A==="http:"||A==="https:"}catch{return!1}}function m(k,L=!1){return new Promise((A,F)=>{const K=document.createElement("script");K.src=k,K.onload=function(Q){L&&K.remove(),A(Q)},K.onerror=function(){F(new Error(`Cannot load script at: ${K.src}`))},(document.head||document.documentElement).appendChild(K)})}function y(k){console.log("Deprecated API usage: "+k)}let v;class T{static toDateObject(L){if(!L||!(0,t.isString)(L))return null;v||(v=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const A=v.exec(L);if(!A)return null;const F=parseInt(A[1],10);let K=parseInt(A[2],10);K=K>=1&&K<=12?K-1:0;let Q=parseInt(A[3],10);Q=Q>=1&&Q<=31?Q:1;let Z=parseInt(A[4],10);Z=Z>=0&&Z<=23?Z:0;let B=parseInt(A[5],10);B=B>=0&&B<=59?B:0;let z=parseInt(A[6],10);z=z>=0&&z<=59?z:0;const b=A[7]||"Z";let N=parseInt(A[8],10);N=N>=0&&N<=23?N:0;let U=parseInt(A[9],10)||0;return U=U>=0&&U<=59?U:0,b==="-"?(Z+=N,B+=U):b==="+"&&(Z-=N,B-=U),new Date(Date.UTC(F,K,Q,Z,B,z))}}i.PDFDateString=T},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.arrayByteLength=re,i.arraysToBytes=oe,i.assert=Z,i.bytesToString=D,i.createObjectURL=Pe,i.createPromiseCapability=we,i.createValidAbsoluteUrl=b,i.escapeString=Xe,i.getModificationDate=he,i.getVerbosityLevel=A,i.info=F,i.isArrayBuffer=ne,i.isArrayEqual=ue,i.isAscii=Ue,i.isBool=nt,i.isNum=qe,i.isSameOrigin=B,i.isString=W,i.objectFromMap=le,i.objectSize=ee,i.removeNullCharacters=X,i.setVerbosityLevel=L,i.shadow=N,i.string32=ve,i.stringToBytes=te,i.stringToPDFString=Ge,i.stringToUTF16BEString=Ze,i.stringToUTF8String=He,i.unreachable=Q,i.utf8StringToString=Je,i.warn=K,i.VerbosityLevel=i.Util=i.UNSUPPORTED_FEATURES=i.UnknownErrorException=i.UnexpectedResponseException=i.TextRenderingMode=i.StreamType=i.PermissionFlag=i.PasswordResponses=i.PasswordException=i.PageActionEventType=i.OPS=i.MissingPDFException=i.IsLittleEndianCached=i.IsEvalSupportedCached=i.InvalidPDFException=i.ImageKind=i.IDENTITY_MATRIX=i.FormatError=i.FontType=i.FONT_IDENTITY_MATRIX=i.DocumentActionEventType=i.CMapCompressionType=i.BaseException=i.AnnotationType=i.AnnotationStateModelType=i.AnnotationReviewState=i.AnnotationReplyType=i.AnnotationMarkedState=i.AnnotationFlag=i.AnnotationFieldFlag=i.AnnotationBorderStyleType=i.AnnotationActionEventType=i.AbortException=void 0,s(3);const t=[1,0,0,1,0,0];i.IDENTITY_MATRIX=t;const c=[.001,0,0,.001,0,0];i.FONT_IDENTITY_MATRIX=c;const a={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};i.PermissionFlag=a;const n={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};i.TextRenderingMode=n;const o={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};i.ImageKind=o;const l={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};i.AnnotationType=l;const r={MARKED:"Marked",REVIEW:"Review"};i.AnnotationStateModelType=r;const d={MARKED:"Marked",UNMARKED:"Unmarked"};i.AnnotationMarkedState=d;const h={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};i.AnnotationReviewState=h;const _={GROUP:"Group",REPLY:"R"};i.AnnotationReplyType=_;const f={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};i.AnnotationFlag=f;const g={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};i.AnnotationFieldFlag=g;const x={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};i.AnnotationBorderStyleType=x;const w={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};i.AnnotationActionEventType=w;const S={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};i.DocumentActionEventType=S;const M={O:"PageOpen",C:"PageClose"};i.PageActionEventType=M;const R={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};i.StreamType=R;const C={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};i.FontType=C;const u={ERRORS:0,WARNINGS:1,INFOS:5};i.VerbosityLevel=u;const m={NONE:0,BINARY:1,STREAM:2};i.CMapCompressionType=m;const y={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};i.OPS=y;const v={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent"};i.UNSUPPORTED_FEATURES=v;const T={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};i.PasswordResponses=T;let k=u.WARNINGS;function L(ge){Number.isInteger(ge)&&(k=ge)}function A(){return k}function F(ge){k>=u.INFOS&&console.log(`Info: ${ge}`)}function K(ge){k>=u.WARNINGS&&console.log(`Warning: ${ge}`)}function Q(ge){throw new Error(ge)}function Z(ge,be){ge||Q(be)}function B(ge,be){let Ce;try{if(Ce=new URL(ge),!Ce.origin||Ce.origin==="null")return!1}catch{return!1}const Fe=new URL(be,Ce);return Ce.origin===Fe.origin}function z(ge){if(!ge)return!1;switch(ge.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function b(ge,be){if(!ge)return null;try{const Ce=be?new URL(ge,be):new URL(ge);if(z(Ce))return Ce}catch{}return null}function N(ge,be,Ce){return Object.defineProperty(ge,be,{value:Ce,enumerable:!0,configurable:!0,writable:!1}),Ce}const U=function(){function be(Ce){this.constructor===be&&Q("Cannot initialize BaseException."),this.message=Ce,this.name=this.constructor.name}return be.prototype=new Error,be.constructor=be,be}();i.BaseException=U;class q extends U{constructor(be,Ce){super(be),this.code=Ce}}i.PasswordException=q;class j extends U{constructor(be,Ce){super(be),this.details=Ce}}i.UnknownErrorException=j;class Y extends U{}i.InvalidPDFException=Y;class J extends U{}i.MissingPDFException=J;class se extends U{constructor(be,Ce){super(be),this.status=Ce}}i.UnexpectedResponseException=se;class pe extends U{}i.FormatError=pe;class _e extends U{}i.AbortException=_e;const Ee=/\x00/g;function X(ge){return typeof ge!="string"?(K("The argument for removeNullCharacters must be a string."),ge):ge.replace(Ee,"")}function D(ge){Z(ge!==null&&typeof ge=="object"&&ge.length!==void 0,"Invalid argument for bytesToString");const be=ge.length,Ce=8192;if(be<Ce)return String.fromCharCode.apply(null,ge);const Fe=[];for(let Ve=0;Ve<be;Ve+=Ce){const Ye=Math.min(Ve+Ce,be),We=ge.subarray(Ve,Ye);Fe.push(String.fromCharCode.apply(null,We))}return Fe.join("")}function te(ge){Z(typeof ge=="string","Invalid argument for stringToBytes");const be=ge.length,Ce=new Uint8Array(be);for(let Fe=0;Fe<be;++Fe)Ce[Fe]=ge.charCodeAt(Fe)&255;return Ce}function re(ge){return ge.length!==void 0?ge.length:(Z(ge.byteLength!==void 0,"arrayByteLength - invalid argument."),ge.byteLength)}function oe(ge){const be=ge.length;if(be===1&&ge[0]instanceof Uint8Array)return ge[0];let Ce=0;for(let Ye=0;Ye<be;Ye++)Ce+=re(ge[Ye]);let Fe=0;const Ve=new Uint8Array(Ce);for(let Ye=0;Ye<be;Ye++){let We=ge[Ye];We instanceof Uint8Array||(typeof We=="string"?We=te(We):We=new Uint8Array(We));const Ie=We.byteLength;Ve.set(We,Fe),Fe+=Ie}return Ve}function ve(ge){return String.fromCharCode(ge>>24&255,ge>>16&255,ge>>8&255,ge&255)}function ee(ge){return Object.keys(ge).length}function le(ge){const be=Object.create(null);for(const[Ce,Fe]of ge)be[Ce]=Fe;return be}function H(){const ge=new Uint8Array(4);return ge[0]=1,new Uint32Array(ge.buffer,0,1)[0]===1}const I={get value(){return N(this,"value",H())}};i.IsLittleEndianCached=I;function O(){try{return new Function(""),!0}catch{return!1}}const ae={get value(){return N(this,"value",O())}};i.IsEvalSupportedCached=ae;const me=[...Array(256).keys()].map(ge=>ge.toString(16).padStart(2,"0"));class Ae{static makeHexColor(be,Ce,Fe){return`#${me[be]}${me[Ce]}${me[Fe]}`}static transform(be,Ce){return[be[0]*Ce[0]+be[2]*Ce[1],be[1]*Ce[0]+be[3]*Ce[1],be[0]*Ce[2]+be[2]*Ce[3],be[1]*Ce[2]+be[3]*Ce[3],be[0]*Ce[4]+be[2]*Ce[5]+be[4],be[1]*Ce[4]+be[3]*Ce[5]+be[5]]}static applyTransform(be,Ce){const Fe=be[0]*Ce[0]+be[1]*Ce[2]+Ce[4],Ve=be[0]*Ce[1]+be[1]*Ce[3]+Ce[5];return[Fe,Ve]}static applyInverseTransform(be,Ce){const Fe=Ce[0]*Ce[3]-Ce[1]*Ce[2],Ve=(be[0]*Ce[3]-be[1]*Ce[2]+Ce[2]*Ce[5]-Ce[4]*Ce[3])/Fe,Ye=(-be[0]*Ce[1]+be[1]*Ce[0]+Ce[4]*Ce[1]-Ce[5]*Ce[0])/Fe;return[Ve,Ye]}static getAxialAlignedBoundingBox(be,Ce){const Fe=Ae.applyTransform(be,Ce),Ve=Ae.applyTransform(be.slice(2,4),Ce),Ye=Ae.applyTransform([be[0],be[3]],Ce),We=Ae.applyTransform([be[2],be[1]],Ce);return[Math.min(Fe[0],Ve[0],Ye[0],We[0]),Math.min(Fe[1],Ve[1],Ye[1],We[1]),Math.max(Fe[0],Ve[0],Ye[0],We[0]),Math.max(Fe[1],Ve[1],Ye[1],We[1])]}static inverseTransform(be){const Ce=be[0]*be[3]-be[1]*be[2];return[be[3]/Ce,-be[1]/Ce,-be[2]/Ce,be[0]/Ce,(be[2]*be[5]-be[4]*be[3])/Ce,(be[4]*be[1]-be[5]*be[0])/Ce]}static apply3dTransform(be,Ce){return[be[0]*Ce[0]+be[1]*Ce[1]+be[2]*Ce[2],be[3]*Ce[0]+be[4]*Ce[1]+be[5]*Ce[2],be[6]*Ce[0]+be[7]*Ce[1]+be[8]*Ce[2]]}static singularValueDecompose2dScale(be){const Ce=[be[0],be[2],be[1],be[3]],Fe=be[0]*Ce[0]+be[1]*Ce[2],Ve=be[0]*Ce[1]+be[1]*Ce[3],Ye=be[2]*Ce[0]+be[3]*Ce[2],We=be[2]*Ce[1]+be[3]*Ce[3],Ie=(Fe+We)/2,Oe=Math.sqrt((Fe+We)**2-4*(Fe*We-Ye*Ve))/2,it=Ie+Oe||1,at=Ie-Oe||1;return[Math.sqrt(it),Math.sqrt(at)]}static normalizeRect(be){const Ce=be.slice(0);return be[0]>be[2]&&(Ce[0]=be[2],Ce[2]=be[0]),be[1]>be[3]&&(Ce[1]=be[3],Ce[3]=be[1]),Ce}static intersect(be,Ce){function Fe(Ie,Oe){return Ie-Oe}const Ve=[be[0],be[2],Ce[0],Ce[2]].sort(Fe),Ye=[be[1],be[3],Ce[1],Ce[3]].sort(Fe),We=[];if(be=Ae.normalizeRect(be),Ce=Ae.normalizeRect(Ce),Ve[0]===be[0]&&Ve[1]===Ce[0]||Ve[0]===Ce[0]&&Ve[1]===be[0])We[0]=Ve[1],We[2]=Ve[2];else return null;if(Ye[0]===be[1]&&Ye[1]===Ce[1]||Ye[0]===Ce[1]&&Ye[1]===be[1])We[1]=Ye[1],We[3]=Ye[2];else return null;return We}}i.Util=Ae;const Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Ge(ge){const be=ge.length,Ce=[];if(ge[0]==="þ"&&ge[1]==="ÿ")for(let Fe=2;Fe<be;Fe+=2)Ce.push(String.fromCharCode(ge.charCodeAt(Fe)<<8|ge.charCodeAt(Fe+1)));else if(ge[0]==="ÿ"&&ge[1]==="þ")for(let Fe=2;Fe<be;Fe+=2)Ce.push(String.fromCharCode(ge.charCodeAt(Fe+1)<<8|ge.charCodeAt(Fe)));else for(let Fe=0;Fe<be;++Fe){const Ve=Se[ge.charCodeAt(Fe)];Ce.push(Ve?String.fromCharCode(Ve):ge.charAt(Fe))}return Ce.join("")}function Xe(ge){return ge.replace(/([()\\\n\r])/g,be=>be===`
`?"\\n":be==="\r"?"\\r":`\\${be}`)}function Ue(ge){return/^[\x00-\x7F]*$/.test(ge)}function Ze(ge){const be=["þÿ"];for(let Ce=0,Fe=ge.length;Ce<Fe;Ce++){const Ve=ge.charCodeAt(Ce);be.push(String.fromCharCode(Ve>>8&255)),be.push(String.fromCharCode(Ve&255))}return be.join("")}function He(ge){return decodeURIComponent(escape(ge))}function Je(ge){return unescape(encodeURIComponent(ge))}function nt(ge){return typeof ge=="boolean"}function qe(ge){return typeof ge=="number"}function W(ge){return typeof ge=="string"}function ne(ge){return typeof ge=="object"&&ge!==null&&ge.byteLength!==void 0}function ue(ge,be){if(ge.length!==be.length)return!1;for(let Ce=0,Fe=ge.length;Ce<Fe;Ce++)if(ge[Ce]!==be[Ce])return!1;return!0}function he(ge=new Date){return[ge.getUTCFullYear().toString(),(ge.getUTCMonth()+1).toString().padStart(2,"0"),ge.getUTCDate().toString().padStart(2,"0"),ge.getUTCHours().toString().padStart(2,"0"),ge.getUTCMinutes().toString().padStart(2,"0"),ge.getUTCSeconds().toString().padStart(2,"0")].join("")}function we(){const ge=Object.create(null);let be=!1;return Object.defineProperty(ge,"settled",{get(){return be}}),ge.promise=new Promise(function(Ce,Fe){ge.resolve=function(Ve){be=!0,Ce(Ve)},ge.reject=function(Ve){be=!0,Fe(Ve)}}),ge}function Pe(ge,be="",Ce=!1){if(URL.createObjectURL&&!Ce)return URL.createObjectURL(new Blob([ge],{type:be}));const Fe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let Ve=`data:${be};base64,`;for(let Ye=0,We=ge.length;Ye<We;Ye+=3){const Ie=ge[Ye]&255,Oe=ge[Ye+1]&255,it=ge[Ye+2]&255,at=Ie>>2,ht=(Ie&3)<<4|Oe>>4,St=Ye+1<We?(Oe&15)<<2|it>>6:64,Qt=Ye+2<We?it&63:64;Ve+=Fe[at]+Fe[ht]+Fe[St]+Fe[Qt]}return Ve}},(e,i,s)=>{s(4)},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isNodeJS=void 0;const s=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");i.isNodeJS=s},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultCMapReaderFactory=exports.DefaultCanvasFactory=exports.build=void 0;var _util=__w_pdfjs_require__(2),_display_utils=__w_pdfjs_require__(1),_font_loader=__w_pdfjs_require__(6),_node_utils=__w_pdfjs_require__(7),_annotation_storage=__w_pdfjs_require__(8),_api_compatibility=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(12),_is_node=__w_pdfjs_require__(4),_message_handler=__w_pdfjs_require__(13),_metadata=__w_pdfjs_require__(14),_optional_content_config=__w_pdfjs_require__(15),_transport_stream=__w_pdfjs_require__(16),_webgl=__w_pdfjs_require__(17);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DefaultCanvasFactory=_is_node.isNodeJS?_node_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_is_node.isNodeJS?_node_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let createPDFNetworkStream;function setPDFNetworkStreamFactory(e){createPDFNetworkStream=e}function getDocument(e){const i=new PDFDocumentLoadingTask;let s;if(typeof e=="string"||e instanceof URL)s={url:e};else if((0,_util.isArrayBuffer)(e))s={data:e};else if(e instanceof PDFDataRangeTransport)s={range:e};else{if(typeof e!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");s=e}const t=Object.create(null);let c=null,a=null;for(const o in s){const l=s[o];switch(o){case"url":if(typeof window<"u")try{t[o]=new URL(l,window.location).href;continue}catch(r){(0,_util.warn)(`Cannot create valid URL: "${r}".`)}else if(typeof l=="string"||l instanceof URL){t[o]=l.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":c=l;continue;case"worker":a=l;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&l instanceof Buffer)t[o]=new Uint8Array(l);else{if(l instanceof Uint8Array)break;if(typeof l=="string")t[o]=(0,_util.stringToBytes)(l);else if(typeof l=="object"&&l!==null&&!isNaN(l.length))t[o]=new Uint8Array(l);else if((0,_util.isArrayBuffer)(l))t[o]=new Uint8Array(l);else throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.")}continue}t[o]=l}if(t.rangeChunkSize=t.rangeChunkSize||DEFAULT_RANGE_CHUNK_SIZE,t.CMapReaderFactory=t.CMapReaderFactory||DefaultCMapReaderFactory,t.ignoreErrors=t.stopAtErrors!==!0,t.fontExtraProperties=t.fontExtraProperties===!0,t.pdfBug=t.pdfBug===!0,t.enableXfa=t.enableXfa===!0,(typeof t.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(t.docBaseUrl))&&(t.docBaseUrl=null),Number.isInteger(t.maxImageSize)||(t.maxImageSize=-1),typeof t.isEvalSupported!="boolean"&&(t.isEvalSupported=!0),typeof t.disableFontFace!="boolean"&&(t.disableFontFace=_api_compatibility.apiCompatibilityParams.disableFontFace||!1),typeof t.ownerDocument>"u"&&(t.ownerDocument=globalThis.document),typeof t.disableRange!="boolean"&&(t.disableRange=!1),typeof t.disableStream!="boolean"&&(t.disableStream=!1),typeof t.disableAutoFetch!="boolean"&&(t.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(t.verbosity),!a){const o={verbosity:t.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};a=o.port?PDFWorker.fromPort(o):new PDFWorker(o),i._worker=a}const n=i.docId;return a.promise.then(function(){if(i.destroyed)throw new Error("Loading aborted");const o=_fetchDocument(a,t,c,n),l=new Promise(function(r){let d;c?d=new _transport_stream.PDFDataTransportStream({length:t.length,initialData:t.initialData,progressiveDone:t.progressiveDone,contentDispositionFilename:t.contentDispositionFilename,disableRange:t.disableRange,disableStream:t.disableStream},c):t.data||(d=createPDFNetworkStream({url:t.url,length:t.length,httpHeaders:t.httpHeaders,withCredentials:t.withCredentials,rangeChunkSize:t.rangeChunkSize,disableRange:t.disableRange,disableStream:t.disableStream})),r(d)});return Promise.all([o,l]).then(function([r,d]){if(i.destroyed)throw new Error("Loading aborted");const h=new _message_handler.MessageHandler(n,r,a.port);h.postMessageTransfers=a.postMessageTransfers;const _=new WorkerTransport(h,i,d,t);i._transport=_,h.send("Ready",null)})}).catch(i._capability.reject),i}function _fetchDocument(e,i,s,t){return e.destroyed?Promise.reject(new Error("Worker was destroyed")):(s&&(i.length=s.length,i.initialData=s.initialData,i.progressiveDone=s.progressiveDone,i.contentDispositionFilename=s.contentDispositionFilename),e.messageHandler.sendWithPromise("GetDocRequest",{docId:t,apiVersion:"2.8.335",source:{data:i.data,url:i.url,password:i.password,disableAutoFetch:i.disableAutoFetch,rangeChunkSize:i.rangeChunkSize,length:i.length},maxImageSize:i.maxImageSize,disableFontFace:i.disableFontFace,postMessageTransfers:e.postMessageTransfers,docBaseUrl:i.docBaseUrl,ignoreErrors:i.ignoreErrors,isEvalSupported:i.isEvalSupported,fontExtraProperties:i.fontExtraProperties,enableXfa:i.enableXfa}).then(function(c){if(e.destroyed)throw new Error("Worker was destroyed");return c}))}const PDFDocumentLoadingTask=function(){let i=0;class s{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+i++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}destroy(){return this.destroyed=!0,(this._transport?this._transport.destroy():Promise.resolve()).then(()=>{this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}}return s}();class PDFDataRangeTransport{constructor(i,s,t=!1,c=null){this.length=i,this.initialData=s,this.progressiveDone=t,this.contentDispositionFilename=c,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(i){this._rangeListeners.push(i)}addProgressListener(i){this._progressListeners.push(i)}addProgressiveReadListener(i){this._progressiveReadListeners.push(i)}addProgressiveDoneListener(i){this._progressiveDoneListeners.push(i)}onDataRange(i,s){for(const t of this._rangeListeners)t(i,s)}onDataProgress(i,s){this._readyCapability.promise.then(()=>{for(const t of this._progressListeners)t(i,s)})}onDataProgressiveRead(i){this._readyCapability.promise.then(()=>{for(const s of this._progressiveReadListeners)s(i)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const i of this._progressiveDoneListeners)i()})}transportReady(){this._readyCapability.resolve()}requestDataRange(i,s){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(i,s){this._pdfInfo=i,this._transport=s}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get numPages(){return this._pdfInfo.numPages}get fingerprint(){return this._pdfInfo.fingerprint}get isPureXfa(){return this._pdfInfo.isPureXfa}getPage(i){return this._transport.getPage(i)}getPageIndex(i){return this._transport.getPageIndex(i)}getDestinations(){return this._transport.getDestinations()}getDestination(i){return this._transport.getDestination(i)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}getStats(){return this._transport.getStats()}cleanup(i=!1){return this._transport.startCleanup(i||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(i){return this._transport.saveDocument(i)}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(i,s,t,c,a=!1){this._pageIndex=i,this._pageInfo=s,this._ownerDocument=c,this._transport=t,this._stats=a?new _display_utils.StatTimer:null,this._pdfBug=a,this.commonObjs=t.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:i,rotation:s=this.rotate,offsetX:t=0,offsetY:c=0,dontFlip:a=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:i,rotation:s,offsetX:t,offsetY:c,dontFlip:a})}getAnnotations({intent:i=null}={}){return(!this._annotationsPromise||this._annotationsIntent!==i)&&(this._annotationsPromise=this._transport.getAnnotations(this._pageIndex,i),this._annotationsIntent=i),this._annotationsPromise}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}getXfa(){return this._xfaPromise||(this._xfaPromise=this._transport.getPageXfa(this._pageIndex))}render({canvasContext:i,viewport:s,intent:t="display",enableWebGL:c=!1,renderInteractiveForms:a=!1,transform:n=null,imageLayer:o=null,canvasFactory:l=null,background:r=null,annotationStorage:d=null,optionalContentConfigPromise:h=null}){var _;this._stats&&this._stats.time("Overall");const f=t==="print"?"print":"display";this.pendingCleanup=!1,h||(h=this._transport.getOptionalContentConfig());let g=this._intentStates.get(f);g||(g=Object.create(null),this._intentStates.set(f,g)),g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null);const x=l||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),w=new _webgl.WebGLContext({enable:c});g.displayReadyCapability||(g.displayReadyCapability=(0,_util.createPromiseCapability)(),g.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:f,renderInteractiveForms:a===!0,annotationStorage:(d==null?void 0:d.serializable)||null}));const S=C=>{g.renderTasks.delete(M),(this.cleanupAfterRender||f==="print")&&(this.pendingCleanup=!0),this._tryCleanup(),C?(M.capability.reject(C),this._abortOperatorList({intentState:g,reason:C})):M.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},M=new InternalRenderTask({callback:S,params:{canvasContext:i,viewport:s,transform:n,imageLayer:o,background:r},objs:this.objs,commonObjs:this.commonObjs,operatorList:g.operatorList,pageIndex:this._pageIndex,canvasFactory:x,webGLContext:w,useRequestAnimationFrame:f!=="print",pdfBug:this._pdfBug});((_=g).renderTasks||(_.renderTasks=new Set)).add(M);const R=M.task;return Promise.all([g.displayReadyCapability.promise,h]).then(([C,u])=>{if(this.pendingCleanup){S();return}this._stats&&this._stats.time("Rendering"),M.initializeGraphics({transparency:C,optionalContentConfig:u}),M.operatorListChanged()}).catch(S),R}getOperatorList(){function i(){t.operatorList.lastChunk&&(t.opListReadCapability.resolve(t.operatorList),t.renderTasks.delete(c))}const s="oplist";let t=this._intentStates.get(s);t||(t=Object.create(null),this._intentStates.set(s,t));let c;if(!t.opListReadCapability){var a;c=Object.create(null),c.operatorListChanged=i,t.opListReadCapability=(0,_util.createPromiseCapability)(),((a=t).renderTasks||(a.renderTasks=new Set)).add(c),t.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:s})}return t.opListReadCapability.promise}streamTextContent({normalizeWhitespace:i=!1,disableCombineTextItems:s=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,normalizeWhitespace:i===!0,combineTextItems:s!==!0},{highWaterMark:100,size(c){return c.items.length}})}getTextContent(i={}){const s=this.streamTextContent(i);return new Promise(function(t,c){function a(){n.read().then(function({value:l,done:r}){if(r){t(o);return}Object.assign(o.styles,l.styles),o.items.push(...l.items),a()},c)}const n=s.getReader(),o={items:[],styles:Object.create(null)};a()})}_destroy(){this.destroyed=!0,this._transport.pageCache[this._pageIndex]=null;const i=[];for(const[s,t]of this._intentStates)if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),s!=="oplist")for(const c of t.renderTasks)i.push(c.completed),c.cancel();return this.objs.clear(),this._annotationsPromise=null,this._jsActionsPromise=null,this._xfaPromise=null,this.pendingCleanup=!1,Promise.all(i)}cleanup(i=!1){return this.pendingCleanup=!0,this._tryCleanup(i)}_tryCleanup(i=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:s,operatorList:t}of this._intentStates.values())if(s.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this._annotationsPromise=null,this._jsActionsPromise=null,this._xfaPromise=null,i&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,!0}_startRenderPage(i,s){const t=this._intentStates.get(s);t&&(this._stats&&this._stats.timeEnd("Page Request"),t.displayReadyCapability&&t.displayReadyCapability.resolve(i))}_renderPageChunk(i,s){for(let t=0,c=i.length;t<c;t++)s.operatorList.fnArray.push(i.fnArray[t]),s.operatorList.argsArray.push(i.argsArray[t]);s.operatorList.lastChunk=i.lastChunk;for(const t of s.renderTasks)t.operatorListChanged();i.lastChunk&&this._tryCleanup()}_pumpOperatorList(i){(0,_util.assert)(i.intent,'PDFPageProxy._pumpOperatorList: Expected "intent" argument.');const t=this._transport.messageHandler.sendWithStream("GetOperatorList",i).getReader(),c=this._intentStates.get(i.intent);c.streamReader=t;const a=()=>{t.read().then(({value:n,done:o})=>{if(o){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(n,c),a())},n=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const o of c.renderTasks)o.operatorListChanged();this._tryCleanup()}if(c.displayReadyCapability)c.displayReadyCapability.reject(n);else if(c.opListReadCapability)c.opListReadCapability.reject(n);else throw n}})};a()}_abortOperatorList({intentState:i,reason:s,force:t=!1}){if((0,_util.assert)(s instanceof Error||typeof s=="object"&&s!==null,'PDFPageProxy._abortOperatorList: Expected "reason" argument.'),!!i.streamReader){if(!t){if(i.renderTasks.size>0)return;if(s instanceof _display_utils.RenderingCancelledException){i.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:i,reason:s,force:!0}),i.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(i.streamReader.cancel(new _util.AbortException(s==null?void 0:s.message)),i.streamReader=null,!this._transport.destroyed){for(const[c,a]of this._intentStates)if(a===i){this._intentStates.delete(c);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve(void 0)}postMessage(i,s){function t(n){var r;if(typeof n!="object"||n===null)return n;if(c.has(n))return c.get(n);let o,l;if((o=n.buffer)&&(0,_util.isArrayBuffer)(o))return s!=null&&s.includes(o)?l=new n.constructor(o,n.byteOffset,n.byteLength):l=new n.constructor(n),c.set(n,l),l;if(n instanceof Map){l=new Map,c.set(n,l);for(const[d,h]of n)l.set(d,t(h));return l}if(n instanceof Set){l=new Set,c.set(n,l);for(const d of n)l.add(t(d));return l}l=Array.isArray(n)?[]:{},c.set(n,l);for(const d in n){let h,_=n;for(;!(h=Object.getOwnPropertyDescriptor(_,d));)_=Object.getPrototypeOf(_);if(!(typeof h.value>"u")){if(typeof h.value=="function"){if((r=n.hasOwnProperty)!=null&&r.call(n,d))throw new Error(`LoopbackPort.postMessage - cannot clone: ${n[d]}`);continue}l[d]=t(h.value)}}return l}const c=new WeakMap,a={data:t(i)};this._deferred.then(()=>{for(const n of this._listeners)n.call(this,a)})}addEventListener(i,s){this._listeners.push(s)}removeEventListener(i,s){const t=this._listeners.indexOf(s);this._listeners.splice(t,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorker=function PDFWorkerClosure(){var e;const pdfWorkerPorts=new WeakMap;let isWorkerDisabled=!1,fallbackWorkerSrc,nextFakeWorkerId=0,fakeWorkerCapability;if(_is_node.isNodeJS&&typeof require=="function")isWorkerDisabled=!0,fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"&&"currentScript"in document){const i=(e=document.currentScript)==null?void 0:e.src;i&&(fallbackWorkerSrc=i.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}function getWorkerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(typeof fallbackWorkerSrc<"u")return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}function getMainThreadWorkerMessageHandler(){var s;let i;try{i=(s=globalThis.pdfjsWorker)==null?void 0:s.WorkerMessageHandler}catch{}return i||null}function setupFakeWorkerGlobal(){if(fakeWorkerCapability)return fakeWorkerCapability.promise;fakeWorkerCapability=(0,_util.createPromiseCapability)();const loader=async function(){const mainWorkerMessageHandler=getMainThreadWorkerMessageHandler();if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof require=="function"){const worker=eval("require")(getWorkerSrc());return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(getWorkerSrc()),window.pdfjsWorker.WorkerMessageHandler};return loader().then(fakeWorkerCapability.resolve,fakeWorkerCapability.reject),fakeWorkerCapability.promise}function createCDNWrapper(i){const s="importScripts('"+i+"');";return URL.createObjectURL(new Blob([s]))}class PDFWorker{constructor({name:s=null,port:t=null,verbosity:c=(0,_util.getVerbosityLevel)()}={}){if(t&&pdfWorkerPorts.has(t))throw new Error("Cannot use more than one PDFWorker per port");if(this.name=s,this.destroyed=!1,this.postMessageTransfers=!0,this.verbosity=c,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,t){pdfWorkerPorts.set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(s){this._port=s,this._messageHandler=new _message_handler.MessageHandler("main","worker",s),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(typeof Worker<"u"&&!isWorkerDisabled&&!getMainThreadWorkerMessageHandler()){let s=getWorkerSrc();try{(0,_util.isSameOrigin)(window.location.href,s)||(s=createCDNWrapper(new URL(s,window.location).href));const t=new Worker(s),c=new _message_handler.MessageHandler("main","worker",t),a=()=>{t.removeEventListener("error",n),c.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},n=()=>{this._webWorker||a()};t.addEventListener("error",n),c.on("test",l=>{if(t.removeEventListener("error",n),this.destroyed){a();return}l?(this._messageHandler=c,this._port=t,this._webWorker=t,l.supportTransfers||(this.postMessageTransfers=!1),this._readyCapability.resolve(),c.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),c.destroy(),t.terminate())}),c.on("ready",l=>{if(t.removeEventListener("error",n),this.destroyed){a();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const l=new Uint8Array([this.postMessageTransfers?255:0]);try{c.send("test",l,[l.buffer])}catch{(0,_util.warn)("Cannot use postMessage transfers."),l[0]=0,c.send("test",l)}};o();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),isWorkerDisabled=!0),setupFakeWorkerGlobal().then(s=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this._port=t;const c="fake"+nextFakeWorkerId++,a=new _message_handler.MessageHandler(c+"_worker",c,t);s.setup(a,t);const n=new _message_handler.MessageHandler(c,c+"_worker",t);this._messageHandler=n,this._readyCapability.resolve(),n.send("configure",{verbosity:this.verbosity})}).catch(s=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${s.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),pdfWorkerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(s){if(!s||!s.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return pdfWorkerPorts.has(s.port)?pdfWorkerPorts.get(s.port):new PDFWorker(s)}static getWorkerSrc(){return getWorkerSrc()}}return PDFWorker}();exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(i,s,t,c){this.messageHandler=i,this.loadingTask=s,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:s.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:c.ownerDocument}),this._params=c,this.CMapReaderFactory=new c.CMapReaderFactory({baseUrl:c.cMapUrl,isCompressed:c.cMapPacked}),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=t,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get loadingTaskSettled(){return this.loadingTask._capability.settled}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const i=[];this.pageCache.forEach(function(t){t&&i.push(t._destroy())}),this.pageCache.length=0,this.pagePromises.length=0;const s=this.messageHandler.sendWithPromise("Terminate",null);if(i.push(s),this.loadingTaskSettled){const t=this.loadingTask.promise.then(c=>{c.hasOwnProperty("annotationStorage")&&c.annotationStorage.resetModified()}).catch(()=>{});i.push(t)}return Promise.all(i).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:i,loadingTask:s}=this;i.on("GetReader",(t,c)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},c.onPull=()=>{this._fullReader.read().then(function({value:a,done:n}){if(n){c.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(a),"GetReader - expected an ArrayBuffer."),c.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{c.error(a)})},c.onCancel=a=>{this._fullReader.cancel(a),c.ready.catch(n=>{if(!this.destroyed)throw n})}}),i.on("ReaderHeadersReady",t=>{const c=(0,_util.createPromiseCapability)(),a=this._fullReader;return a.headersReady.then(()=>{(!a.isStreamingSupported||!a.isRangeSupported)&&(this._lastProgress&&s.onProgress&&s.onProgress(this._lastProgress),a.onProgress=n=>{s.onProgress&&s.onProgress({loaded:n.loaded,total:n.total})}),c.resolve({isStreamingSupported:a.isStreamingSupported,isRangeSupported:a.isRangeSupported,contentLength:a.contentLength})},c.reject),c.promise}),i.on("GetRangeReader",(t,c)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(t.begin,t.end);if(!a){c.close();return}c.onPull=()=>{a.read().then(function({value:n,done:o}){if(o){c.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(n),"GetRangeReader - expected an ArrayBuffer."),c.enqueue(new Uint8Array(n),1,[n])}).catch(n=>{c.error(n)})},c.onCancel=n=>{a.cancel(n),c.ready.catch(o=>{if(!this.destroyed)throw o})}}),i.on("GetDoc",({pdfInfo:t})=>{this._numPages=t.numPages,s._capability.resolve(new PDFDocumentProxy(t,this))}),i.on("DocException",function(t){let c;switch(t.name){case"PasswordException":c=new _util.PasswordException(t.message,t.code);break;case"InvalidPDFException":c=new _util.InvalidPDFException(t.message);break;case"MissingPDFException":c=new _util.MissingPDFException(t.message);break;case"UnexpectedResponseException":c=new _util.UnexpectedResponseException(t.message,t.status);break;case"UnknownErrorException":c=new _util.UnknownErrorException(t.message,t.details);break}c instanceof Error||(0,_util.warn)("DocException - expected a valid Error."),s._capability.reject(c)}),i.on("PasswordRequest",t=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),s.onPassword){const c=a=>{this._passwordCapability.resolve({password:a})};try{s.onPassword(c,t.code)}catch(a){this._passwordCapability.reject(a)}}else this._passwordCapability.reject(new _util.PasswordException(t.message,t.code));return this._passwordCapability.promise}),i.on("DataLoaded",t=>{s.onProgress&&s.onProgress({loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)}),i.on("StartRenderPage",t=>{if(this.destroyed)return;this.pageCache[t.pageIndex]._startRenderPage(t.transparency,t.intent)}),i.on("commonobj",t=>{var o;if(this.destroyed)return;const[c,a,n]=t;if(!this.commonObjs.has(c))switch(a){case"Font":const l=this._params;if("error"in n){const h=n.error;(0,_util.warn)(`Error during font loading: ${h}`),this.commonObjs.resolve(c,h);break}let r=null;l.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)&&(r={registerFont(h,_){globalThis.FontInspector.fontAdded(h,_)}});const d=new _font_loader.FontFaceObject(n,{isEvalSupported:l.isEvalSupported,disableFontFace:l.disableFontFace,ignoreErrors:l.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:r});this.fontLoader.bind(d).catch(h=>i.sendWithPromise("FontFallback",{id:c})).finally(()=>{!l.fontExtraProperties&&d.data&&(d.data=null),this.commonObjs.resolve(c,d)});break;case"FontPath":case"Image":this.commonObjs.resolve(c,n);break;default:throw new Error(`Got unknown common object type ${a}`)}}),i.on("obj",t=>{var r;if(this.destroyed)return;const[c,a,n,o]=t,l=this.pageCache[a];if(!l.objs.has(c))switch(n){case"Image":l.objs.resolve(c,o),((r=o==null?void 0:o.data)==null?void 0:r.length)>8e6&&(l.cleanupAfterRender=!0);break;default:throw new Error(`Got unknown object type ${n}`)}}),i.on("DocProgress",t=>{this.destroyed||s.onProgress&&s.onProgress({loaded:t.loaded,total:t.total})}),i.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),i.on("FetchBuiltInCMap",(t,c)=>{if(this.destroyed){c.error(new Error("Worker was destroyed"));return}let a=!1;c.onPull=()=>{if(a){c.close();return}a=!0,this.CMapReaderFactory.fetch(t).then(function(n){c.enqueue(n,1,[n.cMapData.buffer])}).catch(function(n){c.error(n)})}})}_onUnsupportedFeature({featureId:i}){this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(i)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(i){if(!Number.isInteger(i)||i<=0||i>this._numPages)return Promise.reject(new Error("Invalid page request"));const s=i-1;if(s in this.pagePromises)return this.pagePromises[s];const t=this.messageHandler.sendWithPromise("GetPage",{pageIndex:s}).then(c=>{if(this.destroyed)throw new Error("Transport destroyed");const a=new PDFPageProxy(s,c,this,this._params.ownerDocument,this._params.pdfBug);return this.pageCache[s]=a,a});return this.pagePromises[s]=t,t}getPageIndex(i){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:i}).catch(function(s){return Promise.reject(new Error(s))})}getAnnotations(i,s){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:i,intent:s})}saveDocument(i){var s;return this.messageHandler.sendWithPromise("SaveDocument",{numPages:this._numPages,annotationStorage:(i==null?void 0:i.serializable)||null,filename:((s=this._fullReader)==null?void 0:s.filename)??null}).finally(()=>{i&&i.resetModified()})}getFieldObjects(){return this.messageHandler.sendWithPromise("GetFieldObjects",null)}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(i){return typeof i!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:i})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(i){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:i})}getPageXfa(i){return this.messageHandler.sendWithPromise("GetPageXfa",{pageIndex:i})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(i=>new _optional_content_config.OptionalContentConfig(i))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.messageHandler.sendWithPromise("GetMetadata",null).then(i=>{var s,t;return{info:i[0],metadata:i[1]?new _metadata.Metadata(i[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((t=this._fullReader)==null?void 0:t.contentLength)??null}})}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}getStats(){return this.messageHandler.sendWithPromise("GetStats",null)}async startCleanup(i=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(let s=0,t=this.pageCache.length;s<t;s++){const c=this.pageCache[s];if(!c)continue;if(!c.cleanup())throw new Error(`startCleanup: Page ${s+1} is currently rendering.`)}this.commonObjs.clear(),i||this.fontLoader.clear(),this._hasJSActionsPromise=null}}get loadingParams(){const i=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:i.disableAutoFetch,disableFontFace:i.disableFontFace})}}class PDFObjects{constructor(){this._objs=Object.create(null)}_ensureObj(i){return this._objs[i]?this._objs[i]:this._objs[i]={capability:(0,_util.createPromiseCapability)(),data:null,resolved:!1}}get(i,s=null){if(s)return this._ensureObj(i).capability.promise.then(s),null;const t=this._objs[i];if(!t||!t.resolved)throw new Error(`Requesting object that isn't resolved yet ${i}.`);return t.data}has(i){const s=this._objs[i];return(s==null?void 0:s.resolved)||!1}resolve(i,s){const t=this._ensureObj(i);t.resolved=!0,t.data=s,t.capability.resolve(s)}clear(){this._objs=Object.create(null)}}class RenderTask{constructor(i){this._internalRenderTask=i,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}const InternalRenderTask=function e(){const i=new WeakSet;class s{constructor({callback:c,params:a,objs:n,commonObjs:o,operatorList:l,pageIndex:r,canvasFactory:d,webGLContext:h,useRequestAnimationFrame:_=!1,pdfBug:f=!1}){this.callback=c,this.params=a,this.objs=n,this.commonObjs=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=r,this.canvasFactory=d,this.webGLContext=h,this._pdfBug=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=_===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=a.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:c=!1,optionalContentConfig:a}){var h;if(this.cancelled)return;if(this._canvas){if(i.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");i.add(this._canvas)}this._pdfBug&&((h=globalThis.StepperManager)!=null&&h.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:o,transform:l,imageLayer:r,background:d}=this.params;this.gfx=new _canvas.CanvasGraphics(n,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext,r,a),this.gfx.beginDrawing({transform:l,viewport:o,transparency:c,background:d}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(c=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&i.delete(this._canvas),this.callback(c||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&i.delete(this._canvas),this.callback())))}}return s}(),version="2.8.335";exports.version=version;const build="228adbf67";exports.build=build},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.FontLoader=i.FontFaceObject=void 0;var t=s(2);class c{constructor({docId:l,onUnsupportedFeature:r,ownerDocument:d=globalThis.document}){this.constructor===c&&(0,t.unreachable)("Cannot initialize BaseFontLoader."),this.docId=l,this._onUnsupportedFeature=r,this._document=d,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(l){this.nativeFontFaces.push(l),this._document.fonts.add(l)}insertRule(l){let r=this.styleElement;r||(r=this.styleElement=this._document.createElement("style"),r.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].appendChild(r));const d=r.sheet;d.insertRule(l,d.cssRules.length)}clear(){this.nativeFontFaces.forEach(l=>{this._document.fonts.delete(l)}),this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(l){if(l.attached||l.missingFile)return;if(l.attached=!0,this.isFontLoadingAPISupported){const d=l.createNativeFontFace();if(d){this.addNativeFontFace(d);try{await d.loaded}catch(h){throw this._onUnsupportedFeature({featureId:t.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,t.warn)(`Failed to load font '${d.family}': '${h}'.`),l.disableFontFace=!0,h}}return}const r=l.createFontFaceRule();if(r){if(this.insertRule(r),this.isSyncFontLoadingSupported)return;await new Promise(d=>{const h=this._queueLoadingCallback(d);this._prepareFontLoadEvent([r],[l],h)})}}_queueLoadingCallback(l){(0,t.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var l;return(0,t.shadow)(this,"isFontLoadingAPISupported",!!((l=this._document)!=null&&l.fonts))}get isSyncFontLoadingSupported(){(0,t.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,t.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(l,r,d){(0,t.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let a;i.FontLoader=a,i.FontLoader=a=class extends c{constructor(l){super(l),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let l=!1;if(typeof navigator>"u")l=!0;else{const r=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(r==null?void 0:r[1])>=14&&(l=!0)}return(0,t.shadow)(this,"isSyncFontLoadingSupported",l)}_queueLoadingCallback(l){function r(){for((0,t.assert)(!h.done,"completeRequest() cannot be called twice."),h.done=!0;d.requests.length>0&&d.requests[0].done;){const _=d.requests.shift();setTimeout(_.callback,0)}}const d=this.loadingContext,h={id:`pdfjs-font-loading-${d.nextRequestId++}`,done:!1,complete:r,callback:l};return d.requests.push(h),h}get _loadTestFont(){const l=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,t.shadow)(this,"_loadTestFont",l())}_prepareFontLoadEvent(l,r,d){function h(F,K){return F.charCodeAt(K)<<24|F.charCodeAt(K+1)<<16|F.charCodeAt(K+2)<<8|F.charCodeAt(K+3)&255}function _(F,K,Q,Z){const B=F.substring(0,K),z=F.substring(K+Q);return B+Z+z}let f,g;const x=this._document.createElement("canvas");x.width=1,x.height=1;const w=x.getContext("2d");let S=0;function M(F,K){if(S++,S>30){(0,t.warn)("Load test font never loaded."),K();return}if(w.font="30px "+F,w.fillText(".",0,20),w.getImageData(0,0,1,1).data[3]>0){K();return}setTimeout(M.bind(null,F,K))}const R=`lt${Date.now()}${this.loadTestFontId++}`;let C=this._loadTestFont;C=_(C,976,R.length,R);const m=16,y=1482184792;let v=h(C,m);for(f=0,g=R.length-3;f<g;f+=4)v=v-y+h(R,f)|0;f<R.length&&(v=v-y+h(R+"XXX",f)|0),C=_(C,m,4,(0,t.string32)(v));const T=`url(data:font/opentype;base64,${btoa(C)});`,k=`@font-face {font-family:"${R}";src:${T}}`;this.insertRule(k);const L=[];for(f=0,g=r.length;f<g;f++)L.push(r[f].loadedName);L.push(R);const A=this._document.createElement("div");for(A.style.visibility="hidden",A.style.width=A.style.height="10px",A.style.position="absolute",A.style.top=A.style.left="0px",f=0,g=L.length;f<g;++f){const F=this._document.createElement("span");F.textContent="Hi",F.style.fontFamily=L[f],A.appendChild(F)}this._document.body.appendChild(A),M(R,()=>{this._document.body.removeChild(A),d.complete()})}};class n{constructor(l,{isEvalSupported:r=!0,disableFontFace:d=!1,ignoreErrors:h=!1,onUnsupportedFeature:_,fontRegistry:f=null}){this.compiledGlyphs=Object.create(null);for(const g in l)this[g]=l[g];this.isEvalSupported=r!==!1,this.disableFontFace=d===!0,this.ignoreErrors=h===!0,this._onUnsupportedFeature=_,this.fontRegistry=f}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;const l=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),l}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const l=(0,t.bytesToString)(new Uint8Array(this.data)),r=`url(data:${this.mimetype};base64,${btoa(l)});`,d=`@font-face {font-family:"${this.loadedName}";src:${r}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,r),d}getPathGenerator(l,r){if(this.compiledGlyphs[r]!==void 0)return this.compiledGlyphs[r];let d,h;try{d=l.get(this.loadedName+"_path_"+r)}catch(_){if(!this.ignoreErrors)throw _;return this._onUnsupportedFeature({featureId:t.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,t.warn)(`getPathGenerator - ignoring character: "${_}".`),this.compiledGlyphs[r]=function(f,g){}}if(this.isEvalSupported&&t.IsEvalSupportedCached.value){let _,f="";for(let g=0,x=d.length;g<x;g++)h=d[g],h.args!==void 0?_=h.args.join(","):_="",f+="c."+h.cmd+"("+_+`);
`;return this.compiledGlyphs[r]=new Function("c","size",f)}return this.compiledGlyphs[r]=function(_,f){for(let g=0,x=d.length;g<x;g++)h=d[g],h.cmd==="scale"&&(h.args=[f,-f]),_[h.cmd].apply(_,h.args)}}}i.FontFaceObject=n},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NodeCMapReaderFactory=i.NodeCanvasFactory=void 0;var t=s(1),c=s(4),a=s(2);let n=class{constructor(){(0,a.unreachable)("Not implemented: NodeCanvasFactory")}};i.NodeCanvasFactory=n;let o=class{constructor(){(0,a.unreachable)("Not implemented: NodeCMapReaderFactory")}};i.NodeCMapReaderFactory=o,c.isNodeJS&&(i.NodeCanvasFactory=n=class extends t.BaseCanvasFactory{create(l,r){if(l<=0||r<=0)throw new Error("Invalid canvas size");const h=require("canvas").createCanvas(l,r);return{canvas:h,context:h.getContext("2d")}}},i.NodeCMapReaderFactory=o=class extends t.BaseCMapReaderFactory{_fetchData(l,r){return new Promise((d,h)=>{require("fs").readFile(l,(f,g)=>{if(f||!g){h(new Error(f));return}d({cMapData:new Uint8Array(g),compressionType:r})})})}})},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationStorage=void 0;var t=s(1),c=s(2);class a{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(o,l){const r=this._storage.get(o);return r!==void 0?r:l}getOrCreateValue(o,l){return(0,t.deprecated)("Use getValue instead."),this._storage.has(o)?this._storage.get(o):(this._storage.set(o,l),l)}setValue(o,l){const r=this._storage.get(o);let d=!1;if(r!==void 0)for(const[h,_]of Object.entries(l))r[h]!==_&&(d=!0,r[h]=_);else this._storage.set(o,l),d=!0;d&&this._setModified()}getAll(){return this._storage.size>0?(0,c.objectFromMap)(this._storage):null}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get serializable(){return this._storage.size>0?this._storage:null}}i.AnnotationStorage=a},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.apiCompatibilityParams=void 0;var t=s(4);const c=Object.create(null);(function(){t.isNodeJS&&(c.disableFontFace=!0)})();const a=Object.freeze(c);i.apiCompatibilityParams=a},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CanvasGraphics=void 0;var t=s(2),c=s(11);const a=16,n=100,o=4096,l=1e3,r=16,d=1.000001;function h(w){if(!w.mozCurrentTransform){w._originalSave=w.save,w._originalRestore=w.restore,w._originalRotate=w.rotate,w._originalScale=w.scale,w._originalTranslate=w.translate,w._originalTransform=w.transform,w._originalSetTransform=w.setTransform,w._originalResetTransform=w.resetTransform,w._transformMatrix=w._transformMatrix||[1,0,0,1,0,0],w._transformStack=[];try{const S=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(w),"lineWidth");w._setLineWidth=S.set,w._getLineWidth=S.get,Object.defineProperty(w,"lineWidth",{set:function(R){this._setLineWidth(R*d)},get:function(){return this._getLineWidth()}})}catch{}Object.defineProperty(w,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(w,"mozCurrentTransformInverse",{get:function(){const M=this._transformMatrix,R=M[0],C=M[1],u=M[2],m=M[3],y=M[4],v=M[5],T=R*m-C*u,k=C*u-R*m;return[m/T,C/k,u/k,R/T,(m*y-u*v)/k,(C*y-R*v)/T]}}),w.save=function(){const M=this._transformMatrix;this._transformStack.push(M),this._transformMatrix=M.slice(0,6),this._originalSave()},w.restore=function(){const M=this._transformStack.pop();M&&(this._transformMatrix=M,this._originalRestore())},w.translate=function(M,R){const C=this._transformMatrix;C[4]=C[0]*M+C[2]*R+C[4],C[5]=C[1]*M+C[3]*R+C[5],this._originalTranslate(M,R)},w.scale=function(M,R){const C=this._transformMatrix;C[0]=C[0]*M,C[1]=C[1]*M,C[2]=C[2]*R,C[3]=C[3]*R,this._originalScale(M,R)},w.transform=function(M,R,C,u,m,y){const v=this._transformMatrix;this._transformMatrix=[v[0]*M+v[2]*R,v[1]*M+v[3]*R,v[0]*C+v[2]*u,v[1]*C+v[3]*u,v[0]*m+v[2]*y+v[4],v[1]*m+v[3]*y+v[5]],w._originalTransform(M,R,C,u,m,y)},w.setTransform=function(M,R,C,u,m,y){this._transformMatrix=[M,R,C,u,m,y],w._originalSetTransform(M,R,C,u,m,y)},w.resetTransform=function(){this._transformMatrix=[1,0,0,1,0,0],w._originalResetTransform()},w.rotate=function(M){const R=Math.cos(M),C=Math.sin(M),u=this._transformMatrix;this._transformMatrix=[u[0]*R+u[2]*C,u[1]*R+u[3]*C,u[0]*-C+u[2]*R,u[1]*-C+u[3]*R,u[4],u[5]],this._originalRotate(M)}}}const _=function(){function S(M){this.canvasFactory=M,this.cache=Object.create(null)}return S.prototype={getCanvas:function(R,C,u,m){let y;return this.cache[R]!==void 0?(y=this.cache[R],this.canvasFactory.reset(y,C,u),y.context.setTransform(1,0,0,1,0,0)):(y=this.canvasFactory.create(C,u),this.cache[R]=y),m&&h(y.context),y},clear(){for(const M in this.cache){const R=this.cache[M];this.canvasFactory.destroy(R),delete this.cache[M]}}},S}();function f(w){const M=w.width,R=w.height,C=M+1;let u,m,y,v;const T=new Uint8Array(C*(R+1)),k=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),L=M+7&-8,A=w.data,F=new Uint8Array(L*R);let K=0;for(u=0,m=A.length;u<m;u++){const b=A[u];let N=128;for(;N>0;)F[K++]=b&N?0:255,N>>=1}let Q=0;for(K=0,F[K]!==0&&(T[0]=1,++Q),y=1;y<M;y++)F[K]!==F[K+1]&&(T[y]=F[K]?2:1,++Q),K++;for(F[K]!==0&&(T[y]=2,++Q),u=1;u<R;u++){K=u*L,v=u*C,F[K-L]!==F[K]&&(T[v]=F[K]?1:8,++Q);let b=(F[K]?4:0)+(F[K-L]?8:0);for(y=1;y<M;y++)b=(b>>2)+(F[K+1]?4:0)+(F[K-L+1]?8:0),k[b]&&(T[v+y]=k[b],++Q),K++;if(F[K-L]!==F[K]&&(T[v+y]=F[K]?2:4,++Q),Q>1e3)return null}for(K=L*(R-1),v=u*C,F[K]!==0&&(T[v]=8,++Q),y=1;y<M;y++)F[K]!==F[K+1]&&(T[v+y]=F[K]?4:8,++Q),K++;if(F[K]!==0&&(T[v+y]=4,++Q),Q>1e3)return null;const Z=new Int32Array([0,C,-1,0,-C,0,0,0,1]),B=[];for(u=0;Q&&u<=R;u++){let b=u*C;const N=b+M;for(;b<N&&!T[b];)b++;if(b===N)continue;const U=[b%C,u],q=b;let j=T[b];do{const Y=Z[j];do b+=Y;while(!T[b]);const J=T[b];J!==5&&J!==10?(j=J,T[b]=0):(j=J&51*j>>4,T[b]&=j>>2|j<<2),U.push(b%C),U.push(b/C|0),T[b]||--Q}while(q!==b);B.push(U),--u}return function(b){b.save(),b.scale(1/M,-1/R),b.translate(0,-R),b.beginPath();for(let N=0,U=B.length;N<U;N++){const q=B[N];b.moveTo(q[0],q[1]);for(let j=2,Y=q.length;j<Y;j+=2)b.lineTo(q[j],q[j+1])}b.fill(),b.beginPath(),b.restore()}}const g=function(){function S(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=t.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=t.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=t.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null,this.transferMaps=null}return S.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(R,C){this.x=R,this.y=C}},S}(),x=function(){function R(B,z,b,N,U,q,j){this.ctx=B,this.current=new g,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=z,this.objs=b,this.canvasFactory=N,this.webGLContext=U,this.imageLayer=q,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=j,this.cachedCanvases=new _(this.canvasFactory),B&&h(B),this._cachedGetSinglePixelWidth=null}function C(B,z,b=null){if(typeof ImageData<"u"&&z instanceof ImageData){B.putImageData(z,0,0);return}const N=z.height,U=z.width,q=N%r,j=(N-q)/r,Y=q===0?j:j+1,J=B.createImageData(U,r);let se=0,pe;const _e=z.data,Ee=J.data;let X,D,te,re,oe,ve,ee,le;if(b)switch(b.length){case 1:oe=b[0],ve=b[0],ee=b[0],le=b[0];break;case 4:oe=b[0],ve=b[1],ee=b[2],le=b[3];break}if(z.kind===t.ImageKind.GRAYSCALE_1BPP){const H=_e.byteLength,I=new Uint32Array(Ee.buffer,0,Ee.byteLength>>2),O=I.length,ae=U+7>>3;let me=4294967295,Ae=t.IsLittleEndianCached.value?4278190080:255;for(le&&le[0]===255&&le[255]===0&&([me,Ae]=[Ae,me]),X=0;X<Y;X++){for(te=X<j?r:q,pe=0,D=0;D<te;D++){const Se=H-se;let Ge=0;const Xe=Se>ae?U:Se*8-7,Ue=Xe&-8;let Ze=0,He=0;for(;Ge<Ue;Ge+=8)He=_e[se++],I[pe++]=He&128?me:Ae,I[pe++]=He&64?me:Ae,I[pe++]=He&32?me:Ae,I[pe++]=He&16?me:Ae,I[pe++]=He&8?me:Ae,I[pe++]=He&4?me:Ae,I[pe++]=He&2?me:Ae,I[pe++]=He&1?me:Ae;for(;Ge<Xe;Ge++)Ze===0&&(He=_e[se++],Ze=128),I[pe++]=He&Ze?me:Ae,Ze>>=1}for(;pe<O;)I[pe++]=0;B.putImageData(J,0,X*r)}}else if(z.kind===t.ImageKind.RGBA_32BPP){const H=!!(oe||ve||ee);for(D=0,re=U*r*4,X=0;X<j;X++){if(Ee.set(_e.subarray(se,se+re)),se+=re,H)for(let I=0;I<re;I+=4)oe&&(Ee[I+0]=oe[Ee[I+0]]),ve&&(Ee[I+1]=ve[Ee[I+1]]),ee&&(Ee[I+2]=ee[Ee[I+2]]);B.putImageData(J,0,D),D+=r}if(X<Y){if(re=U*q*4,Ee.set(_e.subarray(se,se+re)),H)for(let I=0;I<re;I+=4)oe&&(Ee[I+0]=oe[Ee[I+0]]),ve&&(Ee[I+1]=ve[Ee[I+1]]),ee&&(Ee[I+2]=ee[Ee[I+2]]);B.putImageData(J,0,D)}}else if(z.kind===t.ImageKind.RGB_24BPP){const H=!!(oe||ve||ee);for(te=r,re=U*te,X=0;X<Y;X++){for(X>=j&&(te=q,re=U*te),pe=0,D=re;D--;)Ee[pe++]=_e[se++],Ee[pe++]=_e[se++],Ee[pe++]=_e[se++],Ee[pe++]=255;if(H)for(let I=0;I<pe;I+=4)oe&&(Ee[I+0]=oe[Ee[I+0]]),ve&&(Ee[I+1]=ve[Ee[I+1]]),ee&&(Ee[I+2]=ee[Ee[I+2]]);B.putImageData(J,0,X*r)}}else throw new Error(`bad image kind: ${z.kind}`)}function u(B,z){const b=z.height,N=z.width,U=b%r,q=(b-U)/r,j=U===0?q:q+1,Y=B.createImageData(N,r);let J=0;const se=z.data,pe=Y.data;for(let _e=0;_e<j;_e++){const Ee=_e<q?r:U;let X=3;for(let D=0;D<Ee;D++){let te,re=0;for(let oe=0;oe<N;oe++)re||(te=se[J++],re=128),pe[X]=te&re?0:255,X+=4,re>>=1}B.putImageData(Y,0,_e*r)}}function m(B,z){const b=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let N=0,U=b.length;N<U;N++){const q=b[N];B[q]!==void 0&&(z[q]=B[q])}B.setLineDash!==void 0&&(z.setLineDash(B.getLineDash()),z.lineDashOffset=B.lineDashOffset)}function y(B){B.strokeStyle="#000000",B.fillStyle="#000000",B.fillRule="nonzero",B.globalAlpha=1,B.lineWidth=1,B.lineCap="butt",B.lineJoin="miter",B.miterLimit=10,B.globalCompositeOperation="source-over",B.font="10px sans-serif",B.setLineDash!==void 0&&(B.setLineDash([]),B.lineDashOffset=0)}function v(B,z,b,N){const U=B.length;for(let q=3;q<U;q+=4){const j=B[q];if(j===0)B[q-3]=z,B[q-2]=b,B[q-1]=N;else if(j<255){const Y=255-j;B[q-3]=B[q-3]*j+z*Y>>8,B[q-2]=B[q-2]*j+b*Y>>8,B[q-1]=B[q-1]*j+N*Y>>8}}}function T(B,z,b){const N=B.length,U=1/255;for(let q=3;q<N;q+=4){const j=b?b[B[q]]:B[q];z[q]=z[q]*j*U|0}}function k(B,z,b){const N=B.length;for(let U=3;U<N;U+=4){const q=B[U-3]*77+B[U-2]*152+B[U-1]*28;z[U]=b?z[U]*b[q>>8]>>8:z[U]*q>>16}}function L(B,z,b,N,U,q,j){const Y=!!q,J=Y?q[0]:0,se=Y?q[1]:0,pe=Y?q[2]:0;let _e;U==="Luminosity"?_e=k:_e=T;const X=Math.min(N,Math.ceil(1048576/b));for(let D=0;D<N;D+=X){const te=Math.min(X,N-D),re=B.getImageData(0,D,b,te),oe=z.getImageData(0,D,b,te);Y&&v(re.data,J,se,pe),_e(re.data,oe.data,j),B.putImageData(oe,0,D)}}function A(B,z,b,N){const U=z.canvas,q=z.context;B.setTransform(z.scaleX,0,0,z.scaleY,z.offsetX,z.offsetY);const j=z.backdrop||null;if(!z.transferMap&&N.isEnabled){const Y=N.composeSMask({layer:b.canvas,mask:U,properties:{subtype:z.subtype,backdrop:j}});B.setTransform(1,0,0,1,0,0),B.drawImage(Y,z.offsetX,z.offsetY);return}L(q,b,U.width,U.height,z.subtype,j,z.transferMap),B.drawImage(U,0,0)}const F=["butt","round","square"],K=["miter","round","bevel"],Q={},Z={};R.prototype={beginDrawing({transform:B,viewport:z,transparency:b=!1,background:N=null}){const U=this.ctx.canvas.width,q=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=N||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,U,q),this.ctx.restore(),b){const j=this.cachedCanvases.getCanvas("transparent",U,q,!0);this.compositeCtx=this.ctx,this.transparentCanvas=j.canvas,this.ctx=j.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),y(this.ctx),B&&this.ctx.transform.apply(this.ctx,B),this.ctx.transform.apply(this.ctx,z.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this._combinedScaleFactor=Math.hypot(this.baseTransform[0],this.baseTransform[2]),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(z,b,N,U){const q=z.argsArray,j=z.fnArray;let Y=b||0;const J=q.length;if(J===Y)return Y;const se=J-Y>10&&typeof N=="function",pe=se?Date.now()+15:0;let _e=0;const Ee=this.commonObjs,X=this.objs;let D;for(;;){if(U!==void 0&&Y===U.nextBreakPoint)return U.breakIt(Y,N),Y;if(D=j[Y],D!==t.OPS.dependency)this[D].apply(this,q[Y]);else for(const te of q[Y]){const re=te.startsWith("g_")?Ee:X;if(!re.has(te))return re.get(te,N),Y}if(Y++,Y===J)return Y;if(se&&++_e>10){if(Date.now()>pe)return N(),Y;_e=0}}},endDrawing:function(){for(;this.stateStack.length||this.current.activeSMask!==null;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.webGLContext.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(z){this.current.lineWidth=z,this.ctx.lineWidth=z},setLineCap:function(z){this.ctx.lineCap=F[z]},setLineJoin:function(z){this.ctx.lineJoin=K[z]},setMiterLimit:function(z){this.ctx.miterLimit=z},setDash:function(z,b){const N=this.ctx;N.setLineDash!==void 0&&(N.setLineDash(z),N.lineDashOffset=b)},setRenderingIntent(B){},setFlatness(B){},setGState:function(z){for(let b=0,N=z.length;b<N;b++){const U=z[b],q=U[0],j=U[1];switch(q){case"LW":this.setLineWidth(j);break;case"LC":this.setLineCap(j);break;case"LJ":this.setLineJoin(j);break;case"ML":this.setMiterLimit(j);break;case"D":this.setDash(j[0],j[1]);break;case"RI":this.setRenderingIntent(j);break;case"FL":this.setFlatness(j);break;case"Font":this.setFont(j[0],j[1]);break;case"CA":this.current.strokeAlpha=U[1];break;case"ca":this.current.fillAlpha=U[1],this.ctx.globalAlpha=U[1];break;case"BM":this.ctx.globalCompositeOperation=j;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=j?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null;break;case"TR":this.current.transferMaps=j}}},beginSMaskGroup:function(){const z=this.current.activeSMask,b=z.canvas.width,N=z.canvas.height,U="smaskGroupAt"+this.groupLevel,q=this.cachedCanvases.getCanvas(U,b,N,!0),j=this.ctx,Y=j.mozCurrentTransform;this.ctx.save();const J=q.context;J.scale(1/z.scaleX,1/z.scaleY),J.translate(-z.offsetX,-z.offsetY),J.transform.apply(J,Y),z.startTransformInverse=J.mozCurrentTransformInverse,m(j,J),this.ctx=J,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(j),this.groupLevel++},suspendSMaskGroup:function(){const z=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),A(this.ctx,this.current.activeSMask,z,this.webGLContext),this.ctx.restore(),this.ctx.save(),m(z,this.ctx),this.current.resumeSMaskCtx=z;const b=t.Util.transform(this.current.activeSMask.startTransformInverse,z.mozCurrentTransform);this.ctx.transform.apply(this.ctx,b),z.save(),z.setTransform(1,0,0,1,0,0),z.clearRect(0,0,z.canvas.width,z.canvas.height),z.restore()},resumeSMaskGroup:function(){const z=this.current.resumeSMaskCtx,b=this.ctx;this.ctx=z,this.groupStack.push(b),this.groupLevel++},endSMaskGroup:function(){const z=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),A(this.ctx,this.current.activeSMask,z,this.webGLContext),this.ctx.restore(),m(z,this.ctx);const b=t.Util.transform(this.current.activeSMask.startTransformInverse,z.mozCurrentTransform);this.ctx.transform.apply(this.ctx,b)},save:function(){this.ctx.save();const z=this.current;this.stateStack.push(z),this.current=z.clone(),this.current.resumeSMaskCtx=null},restore:function(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),this.current.activeSMask!==null&&(this.stateStack.length===0||this.stateStack[this.stateStack.length-1].activeSMask!==this.current.activeSMask)&&this.endSMaskGroup(),this.stateStack.length!==0?(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null):this.current.activeSMask=null},transform:function(z,b,N,U,q,j){this.ctx.transform(z,b,N,U,q,j),this._cachedGetSinglePixelWidth=null},constructPath:function(z,b){const N=this.ctx,U=this.current;let q=U.x,j=U.y;for(let Y=0,J=0,se=z.length;Y<se;Y++)switch(z[Y]|0){case t.OPS.rectangle:q=b[J++],j=b[J++];const pe=b[J++],_e=b[J++],Ee=q+pe,X=j+_e;N.moveTo(q,j),pe===0||_e===0?N.lineTo(Ee,X):(N.lineTo(Ee,j),N.lineTo(Ee,X),N.lineTo(q,X)),N.closePath();break;case t.OPS.moveTo:q=b[J++],j=b[J++],N.moveTo(q,j);break;case t.OPS.lineTo:q=b[J++],j=b[J++],N.lineTo(q,j);break;case t.OPS.curveTo:q=b[J+4],j=b[J+5],N.bezierCurveTo(b[J],b[J+1],b[J+2],b[J+3],q,j),J+=6;break;case t.OPS.curveTo2:N.bezierCurveTo(q,j,b[J],b[J+1],b[J+2],b[J+3]),q=b[J+2],j=b[J+3],J+=4;break;case t.OPS.curveTo3:q=b[J+2],j=b[J+3],N.bezierCurveTo(b[J],b[J+1],q,j,q,j),J+=4;break;case t.OPS.closePath:N.closePath();break}U.setCurrentPoint(q,j)},closePath:function(){this.ctx.closePath()},stroke:function(z){z=typeof z<"u"?z:!0;const b=this.ctx,N=this.current.strokeColor;if(b.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof N=="object"&&(N!=null&&N.getPattern)){b.save();const U=b.mozCurrentTransform,q=t.Util.singularValueDecompose2dScale(U)[0];b.strokeStyle=N.getPattern(b,this);const j=this.getSinglePixelWidth(),Y=this.current.lineWidth*q;j<0&&-j>=Y?(b.resetTransform(),b.lineWidth=Math.round(this._combinedScaleFactor)):b.lineWidth=Math.max(j,Y),b.stroke(),b.restore()}else{const U=this.getSinglePixelWidth();U<0&&-U>=this.current.lineWidth?(b.save(),b.resetTransform(),b.lineWidth=Math.round(this._combinedScaleFactor),b.stroke(),b.restore()):(b.lineWidth=Math.max(U,this.current.lineWidth),b.stroke())}z&&this.consumePath(),b.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(z){z=typeof z<"u"?z:!0;const b=this.ctx,N=this.current.fillColor,U=this.current.patternFill;let q=!1;U&&(b.save(),this.baseTransform&&b.setTransform.apply(b,this.baseTransform),b.fillStyle=N.getPattern(b,this),q=!0),this.contentVisible&&(this.pendingEOFill?(b.fill("evenodd"),this.pendingEOFill=!1):b.fill()),q&&b.restore(),z&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=Q},eoClip:function(){this.pendingClip=Z},beginText:function(){this.current.textMatrix=t.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){const z=this.pendingTextPaths,b=this.ctx;if(z===void 0){b.beginPath();return}b.save(),b.beginPath();for(let N=0;N<z.length;N++){const U=z[N];b.setTransform.apply(b,U.transform),b.translate(U.x,U.y),U.addToPath(b,U.fontSize)}b.restore(),b.clip(),b.beginPath(),delete this.pendingTextPaths},setCharSpacing:function(z){this.current.charSpacing=z},setWordSpacing:function(z){this.current.wordSpacing=z},setHScale:function(z){this.current.textHScale=z/100},setLeading:function(z){this.current.leading=-z},setFont:function(z,b){const N=this.commonObjs.get(z),U=this.current;if(!N)throw new Error(`Can't find font for ${z}`);if(U.fontMatrix=N.fontMatrix||t.FONT_IDENTITY_MATRIX,(U.fontMatrix[0]===0||U.fontMatrix[3]===0)&&(0,t.warn)("Invalid font matrix for font "+z),b<0?(b=-b,U.fontDirection=-1):U.fontDirection=1,this.current.font=N,this.current.fontSize=b,N.isType3Font)return;const q=N.loadedName||"sans-serif";let j="normal";N.black?j="900":N.bold&&(j="bold");const Y=N.italic?"italic":"normal",J=`"${q}", ${N.fallbackName}`;let se=b;b<a?se=a:b>n&&(se=n),this.current.fontSizeScale=b/se,this.ctx.font=`${Y} ${j} ${se}px ${J}`},setTextRenderingMode:function(z){this.current.textRenderingMode=z},setTextRise:function(z){this.current.textRise=z},moveText:function(z,b){this.current.x=this.current.lineX+=z,this.current.y=this.current.lineY+=b},setLeadingMoveText:function(z,b){this.setLeading(-b),this.moveText(z,b)},setTextMatrix:function(z,b,N,U,q,j){this.current.textMatrix=[z,b,N,U,q,j],this.current.textMatrixScale=Math.hypot(z,b),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar(B,z,b,N,U){const q=this.ctx,j=this.current,Y=j.font,J=j.textRenderingMode,se=j.fontSize/j.fontSizeScale,pe=J&t.TextRenderingMode.FILL_STROKE_MASK,_e=!!(J&t.TextRenderingMode.ADD_TO_PATH_FLAG),Ee=j.patternFill&&!Y.missingFile;let X;(Y.disableFontFace||_e||Ee)&&(X=Y.getPathGenerator(this.commonObjs,B)),Y.disableFontFace||Ee?(q.save(),q.translate(z,b),q.beginPath(),X(q,se),N&&q.setTransform.apply(q,N),(pe===t.TextRenderingMode.FILL||pe===t.TextRenderingMode.FILL_STROKE)&&q.fill(),(pe===t.TextRenderingMode.STROKE||pe===t.TextRenderingMode.FILL_STROKE)&&(U&&(q.resetTransform(),q.lineWidth=Math.round(this._combinedScaleFactor)),q.stroke()),q.restore()):((pe===t.TextRenderingMode.FILL||pe===t.TextRenderingMode.FILL_STROKE)&&q.fillText(B,z,b),(pe===t.TextRenderingMode.STROKE||pe===t.TextRenderingMode.FILL_STROKE)&&(U?(q.save(),q.moveTo(z,b),q.resetTransform(),q.lineWidth=Math.round(this._combinedScaleFactor),q.strokeText(B,0,0),q.restore()):q.strokeText(B,z,b))),_e&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:q.mozCurrentTransform,x:z,y:b,fontSize:se,addToPath:X})},get isFontSubpixelAAEnabled(){const{context:B}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);B.scale(1.5,1),B.fillText("I",0,10);const z=B.getImageData(0,0,10,10).data;let b=!1;for(let N=3;N<z.length;N+=4)if(z[N]>0&&z[N]<255){b=!0;break}return(0,t.shadow)(this,"isFontSubpixelAAEnabled",b)},showText:function(z){const b=this.current,N=b.font;if(N.isType3Font)return this.showType3Text(z);const U=b.fontSize;if(U===0)return;const q=this.ctx,j=b.fontSizeScale,Y=b.charSpacing,J=b.wordSpacing,se=b.fontDirection,pe=b.textHScale*se,_e=z.length,Ee=N.vertical,X=Ee?1:-1,D=N.defaultVMetrics,te=U*b.fontMatrix[0],re=b.textRenderingMode===t.TextRenderingMode.FILL&&!N.disableFontFace&&!b.patternFill;q.save();let oe;if(b.patternFill){q.save();const O=b.fillColor.getPattern(q,this);oe=q.mozCurrentTransform,q.restore(),q.fillStyle=O}q.transform.apply(q,b.textMatrix),q.translate(b.x,b.y+b.textRise),se>0?q.scale(pe,-1):q.scale(pe,1);let ve=b.lineWidth,ee=!1;const le=b.textMatrixScale;if(le===0||ve===0){const O=b.textRenderingMode&t.TextRenderingMode.FILL_STROKE_MASK;(O===t.TextRenderingMode.STROKE||O===t.TextRenderingMode.FILL_STROKE)&&(this._cachedGetSinglePixelWidth=null,ve=this.getSinglePixelWidth(),ee=ve<0)}else ve/=le;j!==1&&(q.scale(j,j),ve/=j),q.lineWidth=ve;let H=0,I;for(I=0;I<_e;++I){const O=z[I];if((0,t.isNum)(O)){H+=X*O*U/1e3;continue}let ae=!1;const me=(O.isSpace?J:0)+Y,Ae=O.fontChar,Se=O.accent;let Ge,Xe,Ue=O.width;if(Ee){const He=O.vmetric||D,Je=-(O.vmetric?He[1]:Ue*.5)*te,nt=He[2]*te;Ue=He?-He[0]:Ue,Ge=Je/j,Xe=(H+nt)/j}else Ge=H/j,Xe=0;if(N.remeasure&&Ue>0){const He=q.measureText(Ae).width*1e3/U*j;if(Ue<He&&this.isFontSubpixelAAEnabled){const Je=Ue/He;ae=!0,q.save(),q.scale(Je,1),Ge/=Je}else Ue!==He&&(Ge+=(Ue-He)/2e3*U/j)}if(this.contentVisible&&(O.isInFont||N.missingFile)){if(re&&!Se)q.fillText(Ae,Ge,Xe);else if(this.paintChar(Ae,Ge,Xe,oe,ee),Se){const He=Ge+U*Se.offset.x/j,Je=Xe-U*Se.offset.y/j;this.paintChar(Se.fontChar,He,Je,oe,ee)}}let Ze;Ee?Ze=Ue*te-me*se:Ze=Ue*te+me*se,H+=Ze,ae&&q.restore()}Ee?b.y-=H:b.x+=H*pe,q.restore()},showType3Text:function(z){const b=this.ctx,N=this.current,U=N.font,q=N.fontSize,j=N.fontDirection,Y=U.vertical?1:-1,J=N.charSpacing,se=N.wordSpacing,pe=N.textHScale*j,_e=N.fontMatrix||t.FONT_IDENTITY_MATRIX,Ee=z.length,X=N.textRenderingMode===t.TextRenderingMode.INVISIBLE;let D,te,re,oe;if(!(X||q===0)){for(this._cachedGetSinglePixelWidth=null,b.save(),b.transform.apply(b,N.textMatrix),b.translate(N.x,N.y),b.scale(pe,j),D=0;D<Ee;++D){if(te=z[D],(0,t.isNum)(te)){oe=Y*te*q/1e3,this.ctx.translate(oe,0),N.x+=oe*pe;continue}const ve=(te.isSpace?se:0)+J,ee=U.charProcOperatorList[te.operatorListId];if(!ee){(0,t.warn)(`Type3 character "${te.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=te,this.save(),b.scale(q,q),b.transform.apply(b,_e),this.executeOperatorList(ee),this.restore()),re=t.Util.applyTransform([te.width,0],_e)[0]*q+ve,b.translate(re,0),N.x+=re*pe}b.restore(),this.processingType3=null}},setCharWidth:function(z,b){},setCharWidthAndBounds:function(z,b,N,U,q,j){this.ctx.rect(N,U,q-N,j-U),this.clip(),this.endPath()},getColorN_Pattern:function(z){let b;if(z[0]==="TilingPattern"){const N=z[1],U=this.baseTransform||this.ctx.mozCurrentTransform.slice(),q={createCanvasGraphics:j=>new R(j,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext)};b=new c.TilingPattern(z,N,this.ctx,q,U)}else b=(0,c.getShadingPatternFromIR)(z);return b},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(z,b,N){const U=t.Util.makeHexColor(z,b,N);this.ctx.strokeStyle=U,this.current.strokeColor=U},setFillRGBColor:function(z,b,N){const U=t.Util.makeHexColor(z,b,N);this.ctx.fillStyle=U,this.current.fillColor=U,this.current.patternFill=!1},shadingFill:function(z){if(!this.contentVisible)return;const b=this.ctx;this.save();const N=(0,c.getShadingPatternFromIR)(z);b.fillStyle=N.getPattern(b,this,!0);const U=b.mozCurrentTransformInverse;if(U){const q=b.canvas,j=q.width,Y=q.height,J=t.Util.applyTransform([0,0],U),se=t.Util.applyTransform([0,Y],U),pe=t.Util.applyTransform([j,0],U),_e=t.Util.applyTransform([j,Y],U),Ee=Math.min(J[0],se[0],pe[0],_e[0]),X=Math.min(J[1],se[1],pe[1],_e[1]),D=Math.max(J[0],se[0],pe[0],_e[0]),te=Math.max(J[1],se[1],pe[1],_e[1]);this.ctx.fillRect(Ee,X,D-Ee,te-X)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()},beginInlineImage:function(){(0,t.unreachable)("Should not call beginInlineImage")},beginImageData:function(){(0,t.unreachable)("Should not call beginImageData")},paintFormXObjectBegin:function(z,b){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(z)&&z.length===6&&this.transform.apply(this,z),this.baseTransform=this.ctx.mozCurrentTransform,b)){const N=b[2]-b[0],U=b[3]-b[1];this.ctx.rect(b[0],b[1],N,U),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())},beginGroup:function(z){if(!this.contentVisible)return;this.save();const b=this.ctx;z.isolated||(0,t.info)("TODO: Support non-isolated groups."),z.knockout&&(0,t.warn)("Knockout groups not supported.");const N=b.mozCurrentTransform;if(z.matrix&&b.transform.apply(b,z.matrix),!z.bbox)throw new Error("Bounding box is required.");let U=t.Util.getAxialAlignedBoundingBox(z.bbox,b.mozCurrentTransform);const q=[0,0,b.canvas.width,b.canvas.height];U=t.Util.intersect(U,q)||[0,0,0,0];const j=Math.floor(U[0]),Y=Math.floor(U[1]);let J=Math.max(Math.ceil(U[2])-j,1),se=Math.max(Math.ceil(U[3])-Y,1),pe=1,_e=1;J>o&&(pe=J/o,J=o),se>o&&(_e=se/o,se=o);let Ee="groupAt"+this.groupLevel;z.smask&&(Ee+="_smask_"+this.smaskCounter++%2);const X=this.cachedCanvases.getCanvas(Ee,J,se,!0),D=X.context;D.scale(1/pe,1/_e),D.translate(-j,-Y),D.transform.apply(D,N),z.smask?this.smaskStack.push({canvas:X.canvas,context:D,offsetX:j,offsetY:Y,scaleX:pe,scaleY:_e,subtype:z.smask.subtype,backdrop:z.smask.backdrop,transferMap:z.smask.transferMap||null,startTransformInverse:null}):(b.setTransform(1,0,0,1,0,0),b.translate(j,Y),b.scale(pe,_e)),m(b,D),this.ctx=D,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(b),this.groupLevel++,this.current.activeSMask=null},endGroup:function(z){if(!this.contentVisible)return;this.groupLevel--;const b=this.ctx;this.ctx=this.groupStack.pop(),this.ctx.imageSmoothingEnabled!==void 0?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,z.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(b.canvas,0,0),this.restore()},beginAnnotations:function(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(z,b,N){if(this.save(),y(this.ctx),this.current=new g,Array.isArray(z)&&z.length===4){const U=z[2]-z[0],q=z[3]-z[1];this.ctx.rect(z[0],z[1],U,q),this.clip(),this.endPath()}this.transform.apply(this,b),this.transform.apply(this,N)},endAnnotation:function(){this.restore()},paintImageMaskXObject:function(z){if(!this.contentVisible)return;const b=this.ctx,N=z.width,U=z.height,q=this.current.fillColor,j=this.current.patternFill,Y=this.processingType3;if(Y&&Y.compiled===void 0&&(N<=l&&U<=l?Y.compiled=f({data:z.data,width:N,height:U}):Y.compiled=null),Y!=null&&Y.compiled){Y.compiled(b);return}const J=this.cachedCanvases.getCanvas("maskCanvas",N,U),se=J.context;se.save(),u(se,z),se.globalCompositeOperation="source-in",se.fillStyle=j?q.getPattern(se,this):q,se.fillRect(0,0,N,U),se.restore(),this.paintInlineImageXObject(J.canvas)},paintImageMaskXObjectRepeat(B,z,b=0,N=0,U,q){if(!this.contentVisible)return;const j=B.width,Y=B.height,J=this.current.fillColor,se=this.current.patternFill,pe=this.cachedCanvases.getCanvas("maskCanvas",j,Y),_e=pe.context;_e.save(),u(_e,B),_e.globalCompositeOperation="source-in",_e.fillStyle=se?J.getPattern(_e,this):J,_e.fillRect(0,0,j,Y),_e.restore();const Ee=this.ctx;for(let X=0,D=q.length;X<D;X+=2)Ee.save(),Ee.transform(z,b,N,U,q[X],q[X+1]),Ee.scale(1,-1),Ee.drawImage(pe.canvas,0,0,j,Y,0,-1,1,1),Ee.restore()},paintImageMaskXObjectGroup:function(z){if(!this.contentVisible)return;const b=this.ctx,N=this.current.fillColor,U=this.current.patternFill;for(let q=0,j=z.length;q<j;q++){const Y=z[q],J=Y.width,se=Y.height,pe=this.cachedCanvases.getCanvas("maskCanvas",J,se),_e=pe.context;_e.save(),u(_e,Y),_e.globalCompositeOperation="source-in",_e.fillStyle=U?N.getPattern(_e,this):N,_e.fillRect(0,0,J,se),_e.restore(),b.save(),b.transform.apply(b,Y.transform),b.scale(1,-1),b.drawImage(pe.canvas,0,0,J,se,0,-1,1,1),b.restore()}},paintImageXObject:function(z){if(!this.contentVisible)return;const b=z.startsWith("g_")?this.commonObjs.get(z):this.objs.get(z);if(!b){(0,t.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(b)},paintImageXObjectRepeat:function(z,b,N,U){if(!this.contentVisible)return;const q=z.startsWith("g_")?this.commonObjs.get(z):this.objs.get(z);if(!q){(0,t.warn)("Dependent image isn't ready yet");return}const j=q.width,Y=q.height,J=[];for(let se=0,pe=U.length;se<pe;se+=2)J.push({transform:[b,0,0,N,U[se],U[se+1]],x:0,y:0,w:j,h:Y});this.paintInlineImageXObjectGroup(q,J)},paintInlineImageXObject:function(z){if(!this.contentVisible)return;const b=z.width,N=z.height,U=this.ctx;this.save(),U.scale(1/b,-1/N);const q=U.mozCurrentTransformInverse;let j=Math.max(Math.hypot(q[0],q[1]),1),Y=Math.max(Math.hypot(q[2],q[3]),1),J,se,pe;typeof HTMLElement=="function"&&z instanceof HTMLElement||!z.data?J=z:(se=this.cachedCanvases.getCanvas("inlineImage",b,N),pe=se.context,C(pe,z,this.current.transferMaps),J=se.canvas);let _e=b,Ee=N,X="prescale1";for(;j>2&&_e>1||Y>2&&Ee>1;){let D=_e,te=Ee;j>2&&_e>1&&(D=Math.ceil(_e/2),j/=_e/D),Y>2&&Ee>1&&(te=Math.ceil(Ee/2),Y/=Ee/te),se=this.cachedCanvases.getCanvas(X,D,te),pe=se.context,pe.clearRect(0,0,D,te),pe.drawImage(J,0,0,_e,Ee,0,0,D,te),J=se.canvas,_e=D,Ee=te,X=X==="prescale1"?"prescale2":"prescale1"}if(U.drawImage(J,0,0,_e,Ee,0,-N,b,N),this.imageLayer){const D=this.getCanvasPosition(0,-N);this.imageLayer.appendImage({imgData:z,left:D[0],top:D[1],width:b/q[0],height:N/q[3]})}this.restore()},paintInlineImageXObjectGroup:function(z,b){if(!this.contentVisible)return;const N=this.ctx,U=z.width,q=z.height,j=this.cachedCanvases.getCanvas("inlineImage",U,q),Y=j.context;C(Y,z,this.current.transferMaps);for(let J=0,se=b.length;J<se;J++){const pe=b[J];if(N.save(),N.transform.apply(N,pe.transform),N.scale(1,-1),N.drawImage(j.canvas,pe.x,pe.y,pe.w,pe.h,0,-1,1,1),this.imageLayer){const _e=this.getCanvasPosition(pe.x,pe.y);this.imageLayer.appendImage({imgData:z,left:_e[0],top:_e[1],width:U,height:q})}N.restore()}},paintSolidColorImageMask:function(){this.contentVisible&&this.ctx.fillRect(0,0,1,1)},markPoint:function(z){},markPointProps:function(z,b){},beginMarkedContent:function(z){this.markedContentStack.push({visible:!0})},beginMarkedContentProps:function(z,b){z==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(b)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()},endMarkedContent:function(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()},beginCompat:function(){},endCompat:function(){},consumePath:function(){const z=this.ctx;this.pendingClip&&(this.pendingClip===Z?z.clip("evenodd"):z.clip(),this.pendingClip=null),z.beginPath()},getSinglePixelWidth(){if(this._cachedGetSinglePixelWidth===null){const B=this.ctx.mozCurrentTransform,z=Math.abs(B[0]*B[3]-B[2]*B[1]),b=B[0]**2+B[2]**2,N=B[1]**2+B[3]**2,U=Math.sqrt(Math.max(b,N))/z;b!==N&&this._combinedScaleFactor*U>1?this._cachedGetSinglePixelWidth=-(this._combinedScaleFactor*U):z>Number.EPSILON?this._cachedGetSinglePixelWidth=U:this._cachedGetSinglePixelWidth=1}return this._cachedGetSinglePixelWidth},getCanvasPosition:function(z,b){const N=this.ctx.mozCurrentTransform;return[N[0]*z+N[2]*b+N[4],N[1]*z+N[3]*b+N[5]]},isContentVisible:function(){for(let z=this.markedContentStack.length-1;z>=0;z--)if(!this.markedContentStack[z].visible)return!1;return!0}};for(const B in t.OPS)R.prototype[t.OPS[B]]=R.prototype[B];return R}();i.CanvasGraphics=x},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getShadingPatternFromIR=o,i.TilingPattern=void 0;var t=s(2);const c={};function a(r,d){if(!d||typeof Path2D>"u")return;const h=d[2]-d[0],_=d[3]-d[1],f=new Path2D;f.rect(d[0],d[1],h,_),r.clip(f)}c.RadialAxial={fromIR:function(d){const h=d[1],_=d[2],f=d[3],g=d[4],x=d[5],w=d[6],S=d[7];return{getPattern:function(R){a(R,_);let C;h==="axial"?C=R.createLinearGradient(g[0],g[1],x[0],x[1]):h==="radial"&&(C=R.createRadialGradient(g[0],g[1],w,x[0],x[1],S));for(let u=0,m=f.length;u<m;++u){const y=f[u];C.addColorStop(y[0],y[1])}return C}}}};const n=function(){function d(f,g,x,w,S,M,R,C){const u=g.coords,m=g.colors,y=f.data,v=f.width*4;let T;u[x+1]>u[w+1]&&(T=x,x=w,w=T,T=M,M=R,R=T),u[w+1]>u[S+1]&&(T=w,w=S,S=T,T=R,R=C,C=T),u[x+1]>u[w+1]&&(T=x,x=w,w=T,T=M,M=R,R=T);const k=(u[x]+g.offsetX)*g.scaleX,L=(u[x+1]+g.offsetY)*g.scaleY,A=(u[w]+g.offsetX)*g.scaleX,F=(u[w+1]+g.offsetY)*g.scaleY,K=(u[S]+g.offsetX)*g.scaleX,Q=(u[S+1]+g.offsetY)*g.scaleY;if(L>=Q)return;const Z=m[M],B=m[M+1],z=m[M+2],b=m[R],N=m[R+1],U=m[R+2],q=m[C],j=m[C+1],Y=m[C+2],J=Math.round(L),se=Math.round(Q);let pe,_e,Ee,X,D,te,re,oe;for(let ve=J;ve<=se;ve++){if(ve<F){let O;ve<L?O=0:L===F?O=1:O=(L-ve)/(L-F),pe=k-(k-A)*O,_e=Z-(Z-b)*O,Ee=B-(B-N)*O,X=z-(z-U)*O}else{let O;ve>Q?O=1:F===Q?O=0:O=(F-ve)/(F-Q),pe=A-(A-K)*O,_e=b-(b-q)*O,Ee=N-(N-j)*O,X=U-(U-Y)*O}let ee;ve<L?ee=0:ve>Q?ee=1:ee=(L-ve)/(L-Q),D=k-(k-K)*ee,te=Z-(Z-q)*ee,re=B-(B-j)*ee,oe=z-(z-Y)*ee;const le=Math.round(Math.min(pe,D)),H=Math.round(Math.max(pe,D));let I=v*ve+le*4;for(let O=le;O<=H;O++)ee=(pe-O)/(pe-D),ee<0?ee=0:ee>1&&(ee=1),y[I++]=_e-(_e-te)*ee|0,y[I++]=Ee-(Ee-re)*ee|0,y[I++]=X-(X-oe)*ee|0,y[I++]=255}}function h(f,g,x){const w=g.coords,S=g.colors;let M,R;switch(g.type){case"lattice":const C=g.verticesPerRow,u=Math.floor(w.length/C)-1,m=C-1;for(M=0;M<u;M++){let y=M*C;for(let v=0;v<m;v++,y++)d(f,x,w[y],w[y+1],w[y+C],S[y],S[y+1],S[y+C]),d(f,x,w[y+C+1],w[y+1],w[y+C],S[y+C+1],S[y+1],S[y+C])}break;case"triangles":for(M=0,R=w.length;M<R;M+=3)d(f,x,w[M],w[M+1],w[M+2],S[M],S[M+1],S[M+2]);break;default:throw new Error("illegal figure")}}function _(f,g,x,w,S,M,R,C){const v=Math.floor(f[0]),T=Math.floor(f[1]),k=Math.ceil(f[2])-v,L=Math.ceil(f[3])-T,A=Math.min(Math.ceil(Math.abs(k*g[0]*1.1)),3e3),F=Math.min(Math.ceil(Math.abs(L*g[1]*1.1)),3e3),K=k/A,Q=L/F,Z={coords:x,colors:w,offsetX:-v,offsetY:-T,scaleX:1/K,scaleY:1/Q},B=A+2*2,z=F+2*2;let b,N,U,q;if(C.isEnabled)b=C.drawFigures({width:A,height:F,backgroundColor:M,figures:S,context:Z}),N=R.getCanvas("mesh",B,z,!1),N.context.drawImage(b,2,2),b=N.canvas;else{N=R.getCanvas("mesh",B,z,!1);const j=N.context,Y=j.createImageData(A,F);if(M){const J=Y.data;for(U=0,q=J.length;U<q;U+=4)J[U]=M[0],J[U+1]=M[1],J[U+2]=M[2],J[U+3]=255}for(U=0;U<S.length;U++)h(Y,S[U],Z);j.putImageData(Y,2,2),b=N.canvas}return{canvas:b,offsetX:v-2*K,offsetY:T-2*Q,scaleX:K,scaleY:Q}}return _}();c.Mesh={fromIR:function(d){const h=d[2],_=d[3],f=d[4],g=d[5],x=d[6],w=d[7],S=d[8];return{getPattern:function(R,C,u){a(R,w);let m;if(u)m=t.Util.singularValueDecompose2dScale(R.mozCurrentTransform);else if(m=t.Util.singularValueDecompose2dScale(C.baseTransform),x){const v=t.Util.singularValueDecompose2dScale(x);m=[m[0]*v[0],m[1]*v[1]]}const y=n(g,m,h,_,f,u?null:S,C.cachedCanvases,C.webGLContext);return u||(R.setTransform.apply(R,C.baseTransform),x&&R.transform.apply(R,x)),R.translate(y.offsetX,y.offsetY),R.scale(y.scaleX,y.scaleY),R.createPattern(y.canvas,"no-repeat")}}}},c.Dummy={fromIR:function(){return{getPattern:function(){return"hotpink"}}}};function o(r){const d=c[r[0]];if(!d)throw new Error(`Unknown IR type: ${r[0]}`);return d.fromIR(r)}const l=function(){const d={COLORED:1,UNCOLORED:2},h=3e3;function _(f,g,x,w,S){this.operatorList=f[2],this.matrix=f[3]||[1,0,0,1,0,0],this.bbox=f[4],this.xstep=f[5],this.ystep=f[6],this.paintType=f[7],this.tilingType=f[8],this.color=g,this.canvasGraphicsFactory=w,this.baseTransform=S,this.ctx=x}return _.prototype={createPatternCanvas:function(g){const x=this.operatorList,w=this.bbox,S=this.xstep,M=this.ystep,R=this.paintType,C=this.tilingType,u=this.color,m=this.canvasGraphicsFactory;(0,t.info)("TilingType: "+C);const y=w[0],v=w[1],T=w[2],k=w[3],L=t.Util.singularValueDecompose2dScale(this.matrix),A=t.Util.singularValueDecompose2dScale(this.baseTransform),F=[L[0]*A[0],L[1]*A[1]],K=this.getSizeAndScale(S,this.ctx.canvas.width,F[0]),Q=this.getSizeAndScale(M,this.ctx.canvas.height,F[1]),Z=g.cachedCanvases.getCanvas("pattern",K.size,Q.size,!0),B=Z.context,z=m.createCanvasGraphics(B);return z.groupLevel=g.groupLevel,this.setFillAndStrokeStyleToContext(z,R,u),z.transform(K.scale,0,0,Q.scale,0,0),z.transform(1,0,0,1,-y,-v),this.clipBbox(z,w,y,v,T,k),z.executeOperatorList(x),this.ctx.transform(1,0,0,1,y,v),this.ctx.scale(1/K.scale,1/Q.scale),Z.canvas},getSizeAndScale:function(g,x,w){g=Math.abs(g);const S=Math.max(h,x);let M=Math.ceil(g*w);return M>=S?M=S:w=M/g,{scale:w,size:M}},clipBbox:function(g,x,w,S,M,R){if(Array.isArray(x)&&x.length===4){const C=M-w,u=R-S;g.ctx.rect(w,S,C,u),g.clip(),g.endPath()}},setFillAndStrokeStyleToContext:function(g,x,w){const S=g.ctx,M=g.current;switch(x){case d.COLORED:const R=this.ctx;S.fillStyle=R.fillStyle,S.strokeStyle=R.strokeStyle,M.fillColor=R.fillStyle,M.strokeColor=R.strokeStyle;break;case d.UNCOLORED:const C=t.Util.makeHexColor(w[0],w[1],w[2]);S.fillStyle=C,S.strokeStyle=C,M.fillColor=C,M.strokeColor=C;break;default:throw new t.FormatError(`Unsupported paint type: ${x}`)}},getPattern:function(g,x){g=this.ctx,g.setTransform.apply(g,this.baseTransform),g.transform.apply(g,this.matrix);const w=this.createPatternCanvas(x);return g.createPattern(w,"repeat")}},_}();i.TilingPattern=l},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GlobalWorkerOptions=void 0;const s=Object.create(null);i.GlobalWorkerOptions=s,s.workerPort=s.workerPort===void 0?null:s.workerPort,s.workerSrc=s.workerSrc===void 0?"":s.workerSrc},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.MessageHandler=void 0;var t=s(2);const c={UNKNOWN:0,DATA:1,ERROR:2},a={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function n(l){if(typeof l!="object"||l===null)return l;switch(l.name){case"AbortException":return new t.AbortException(l.message);case"MissingPDFException":return new t.MissingPDFException(l.message);case"UnexpectedResponseException":return new t.UnexpectedResponseException(l.message,l.status);case"UnknownErrorException":return new t.UnknownErrorException(l.message,l.details);default:return new t.UnknownErrorException(l.message,l.toString())}}class o{constructor(r,d,h){this.sourceName=r,this.targetName=d,this.comObj=h,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=_=>{const f=_.data;if(f.targetName!==this.sourceName)return;if(f.stream){this._processStreamMessage(f);return}if(f.callback){const x=f.callbackId,w=this.callbackCapabilities[x];if(!w)throw new Error(`Cannot resolve callback ${x}`);if(delete this.callbackCapabilities[x],f.callback===c.DATA)w.resolve(f.data);else if(f.callback===c.ERROR)w.reject(n(f.reason));else throw new Error("Unexpected callback case");return}const g=this.actionHandler[f.action];if(!g)throw new Error(`Unknown action from worker: ${f.action}`);if(f.callbackId){const x=this.sourceName,w=f.sourceName;new Promise(function(S){S(g(f.data))}).then(function(S){h.postMessage({sourceName:x,targetName:w,callback:c.DATA,callbackId:f.callbackId,data:S})},function(S){h.postMessage({sourceName:x,targetName:w,callback:c.ERROR,callbackId:f.callbackId,reason:n(S)})});return}if(f.streamId){this._createStreamSink(f);return}g(f.data)},h.addEventListener("message",this._onComObjOnMessage)}on(r,d){const h=this.actionHandler;if(h[r])throw new Error(`There is already an actionName called "${r}"`);h[r]=d}send(r,d,h){this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:r,data:d},h)}sendWithPromise(r,d,h){const _=this.callbackId++,f=(0,t.createPromiseCapability)();this.callbackCapabilities[_]=f;try{this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:r,callbackId:_,data:d},h)}catch(g){f.reject(g)}return f.promise}sendWithStream(r,d,h,_){const f=this.streamId++,g=this.sourceName,x=this.targetName,w=this.comObj;return new ReadableStream({start:S=>{const M=(0,t.createPromiseCapability)();return this.streamControllers[f]={controller:S,startCall:M,pullCall:null,cancelCall:null,isClosed:!1},this._postMessage({sourceName:g,targetName:x,action:r,streamId:f,data:d,desiredSize:S.desiredSize},_),M.promise},pull:S=>{const M=(0,t.createPromiseCapability)();return this.streamControllers[f].pullCall=M,w.postMessage({sourceName:g,targetName:x,stream:a.PULL,streamId:f,desiredSize:S.desiredSize}),M.promise},cancel:S=>{(0,t.assert)(S instanceof Error,"cancel must have a valid reason");const M=(0,t.createPromiseCapability)();return this.streamControllers[f].cancelCall=M,this.streamControllers[f].isClosed=!0,w.postMessage({sourceName:g,targetName:x,stream:a.CANCEL,streamId:f,reason:n(S)}),M.promise}},h)}_createStreamSink(r){const d=this,h=this.actionHandler[r.action],_=r.streamId,f=this.sourceName,g=r.sourceName,x=this.comObj,w={enqueue(S,M=1,R){if(this.isCancelled)return;const C=this.desiredSize;this.desiredSize-=M,C>0&&this.desiredSize<=0&&(this.sinkCapability=(0,t.createPromiseCapability)(),this.ready=this.sinkCapability.promise),d._postMessage({sourceName:f,targetName:g,stream:a.ENQUEUE,streamId:_,chunk:S},R)},close(){this.isCancelled||(this.isCancelled=!0,x.postMessage({sourceName:f,targetName:g,stream:a.CLOSE,streamId:_}),delete d.streamSinks[_])},error(S){(0,t.assert)(S instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,x.postMessage({sourceName:f,targetName:g,stream:a.ERROR,streamId:_,reason:n(S)}))},sinkCapability:(0,t.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:r.desiredSize,ready:null};w.sinkCapability.resolve(),w.ready=w.sinkCapability.promise,this.streamSinks[_]=w,new Promise(function(S){S(h(r.data,w))}).then(function(){x.postMessage({sourceName:f,targetName:g,stream:a.START_COMPLETE,streamId:_,success:!0})},function(S){x.postMessage({sourceName:f,targetName:g,stream:a.START_COMPLETE,streamId:_,reason:n(S)})})}_processStreamMessage(r){const d=r.streamId,h=this.sourceName,_=r.sourceName,f=this.comObj;switch(r.stream){case a.START_COMPLETE:r.success?this.streamControllers[d].startCall.resolve():this.streamControllers[d].startCall.reject(n(r.reason));break;case a.PULL_COMPLETE:r.success?this.streamControllers[d].pullCall.resolve():this.streamControllers[d].pullCall.reject(n(r.reason));break;case a.PULL:if(!this.streamSinks[d]){f.postMessage({sourceName:h,targetName:_,stream:a.PULL_COMPLETE,streamId:d,success:!0});break}this.streamSinks[d].desiredSize<=0&&r.desiredSize>0&&this.streamSinks[d].sinkCapability.resolve(),this.streamSinks[d].desiredSize=r.desiredSize;const{onPull:g}=this.streamSinks[r.streamId];new Promise(function(w){w(g&&g())}).then(function(){f.postMessage({sourceName:h,targetName:_,stream:a.PULL_COMPLETE,streamId:d,success:!0})},function(w){f.postMessage({sourceName:h,targetName:_,stream:a.PULL_COMPLETE,streamId:d,reason:n(w)})});break;case a.ENQUEUE:if((0,t.assert)(this.streamControllers[d],"enqueue should have stream controller"),this.streamControllers[d].isClosed)break;this.streamControllers[d].controller.enqueue(r.chunk);break;case a.CLOSE:if((0,t.assert)(this.streamControllers[d],"close should have stream controller"),this.streamControllers[d].isClosed)break;this.streamControllers[d].isClosed=!0,this.streamControllers[d].controller.close(),this._deleteStreamController(d);break;case a.ERROR:(0,t.assert)(this.streamControllers[d],"error should have stream controller"),this.streamControllers[d].controller.error(n(r.reason)),this._deleteStreamController(d);break;case a.CANCEL_COMPLETE:r.success?this.streamControllers[d].cancelCall.resolve():this.streamControllers[d].cancelCall.reject(n(r.reason)),this._deleteStreamController(d);break;case a.CANCEL:if(!this.streamSinks[d])break;const{onCancel:x}=this.streamSinks[r.streamId];new Promise(function(w){w(x&&x(n(r.reason)))}).then(function(){f.postMessage({sourceName:h,targetName:_,stream:a.CANCEL_COMPLETE,streamId:d,success:!0})},function(w){f.postMessage({sourceName:h,targetName:_,stream:a.CANCEL_COMPLETE,streamId:d,reason:n(w)})}),this.streamSinks[d].sinkCapability.reject(n(r.reason)),this.streamSinks[d].isCancelled=!0,delete this.streamSinks[d];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(r){await Promise.allSettled([this.streamControllers[r].startCall,this.streamControllers[r].pullCall,this.streamControllers[r].cancelCall].map(function(d){return d&&d.promise})),delete this.streamControllers[r]}_postMessage(r,d){d&&this.postMessageTransfers?this.comObj.postMessage(r,d):this.comObj.postMessage(r)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}i.MessageHandler=o},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Metadata=void 0;var t=s(2);class c{constructor({parsedData:n,rawData:o}){this._metadataMap=n,this._data=o}getRaw(){return this._data}get(n){return this._metadataMap.get(n)??null}getAll(){return(0,t.objectFromMap)(this._metadataMap)}has(n){return this._metadataMap.has(n)}}i.Metadata=c},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.OptionalContentConfig=void 0;var t=s(2);class c{constructor(o,l){this.visible=!0,this.name=o,this.intent=l}}class a{constructor(o){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,o!==null){this.name=o.name,this.creator=o.creator,this._order=o.order;for(const l of o.groups)this._groups.set(l.id,new c(l.name,l.intent));if(o.baseState==="OFF")for(const l of this._groups)l.visible=!1;for(const l of o.on)this._groups.get(l).visible=!0;for(const l of o.off)this._groups.get(l).visible=!1}}isVisible(o){if(o.type==="OCG")return this._groups.has(o.id)?this._groups.get(o.id).visible:((0,t.warn)(`Optional content group not found: ${o.id}`),!0);if(o.type==="OCMD"){if(o.expression&&(0,t.warn)("Visibility expression not supported yet."),!o.policy||o.policy==="AnyOn"){for(const l of o.ids){if(!this._groups.has(l))return(0,t.warn)(`Optional content group not found: ${l}`),!0;if(this._groups.get(l).visible)return!0}return!1}else if(o.policy==="AllOn"){for(const l of o.ids){if(!this._groups.has(l))return(0,t.warn)(`Optional content group not found: ${l}`),!0;if(!this._groups.get(l).visible)return!1}return!0}else if(o.policy==="AnyOff"){for(const l of o.ids){if(!this._groups.has(l))return(0,t.warn)(`Optional content group not found: ${l}`),!0;if(!this._groups.get(l).visible)return!0}return!1}else if(o.policy==="AllOff"){for(const l of o.ids){if(!this._groups.has(l))return(0,t.warn)(`Optional content group not found: ${l}`),!0;if(this._groups.get(l).visible)return!1}return!0}return(0,t.warn)(`Unknown optional content policy ${o.policy}.`),!0}return(0,t.warn)(`Unknown group type ${o.type}.`),!0}setVisibility(o,l=!0){if(!this._groups.has(o)){(0,t.warn)(`Optional content group not found: ${o}`);return}this._groups.get(o).visible=!!l}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size>0?(0,t.objectFromMap)(this._groups):null}getGroup(o){return this._groups.get(o)||null}}i.OptionalContentConfig=a},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFDataTransportStream=void 0;var t=s(2),c=s(1);class a{constructor(r,d){(0,t.assert)(d,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=r.progressiveDone||!1,this._contentDispositionFilename=r.contentDispositionFilename||null;const h=r.initialData;if((h==null?void 0:h.length)>0){const _=new Uint8Array(h).buffer;this._queuedChunks.push(_)}this._pdfDataRangeTransport=d,this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._contentLength=r.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((_,f)=>{this._onReceiveData({begin:_,chunk:f})}),this._pdfDataRangeTransport.addProgressListener((_,f)=>{this._onProgress({loaded:_,total:f})}),this._pdfDataRangeTransport.addProgressiveReadListener(_=>{this._onReceiveData({chunk:_})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(r){const d=new Uint8Array(r.chunk).buffer;if(r.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(d):this._queuedChunks.push(d);else{const h=this._rangeReaders.some(function(_){return _._begin!==r.begin?!1:(_._enqueue(d),!0)});(0,t.assert)(h,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var r;return((r=this._fullRequestReader)==null?void 0:r._loaded)??0}_onProgress(r){if(r.total===void 0){const d=this._rangeReaders[0];d!=null&&d.onProgress&&d.onProgress({loaded:r.loaded})}else{const d=this._fullRequestReader;d!=null&&d.onProgress&&d.onProgress({loaded:r.loaded,total:r.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(r){const d=this._rangeReaders.indexOf(r);d>=0&&this._rangeReaders.splice(d,1)}getFullReader(){(0,t.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const r=this._queuedChunks;return this._queuedChunks=null,new n(this,r,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(r,d){if(d<=this._progressiveDataLength)return null;const h=new o(this,r,d);return this._pdfDataRangeTransport.requestDataRange(r,d),this._rangeReaders.push(h),h}cancelAllRequests(r){this._fullRequestReader&&this._fullRequestReader.cancel(r),this._rangeReaders.slice(0).forEach(function(h){h.cancel(r)}),this._pdfDataRangeTransport.abort()}}i.PDFDataTransportStream=a;class n{constructor(r,d,h=!1,_=null){this._stream=r,this._done=h||!1,this._filename=(0,c.isPdfFile)(_)?_:null,this._queuedChunks=d||[],this._loaded=0;for(const f of this._queuedChunks)this._loaded+=f.byteLength;this._requests=[],this._headersReady=Promise.resolve(),r._fullRequestReader=this,this.onProgress=null}_enqueue(r){this._done||(this._requests.length>0?this._requests.shift().resolve({value:r,done:!1}):this._queuedChunks.push(r),this._loaded+=r.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const r=(0,t.createPromiseCapability)();return this._requests.push(r),r.promise}cancel(r){this._done=!0,this._requests.forEach(function(d){d.resolve({value:void 0,done:!0})}),this._requests=[]}progressiveDone(){this._done||(this._done=!0)}}class o{constructor(r,d,h){this._stream=r,this._begin=d,this._end=h,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(r){this._done||(this._requests.length===0?this._queuedChunk=r:(this._requests.shift().resolve({value:r,done:!1}),this._requests.forEach(function(h){h.resolve({value:void 0,done:!0})}),this._requests=[]),this._done=!0,this._stream._removeRangeReader(this))}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const d=this._queuedChunk;return this._queuedChunk=null,{value:d,done:!1}}if(this._done)return{value:void 0,done:!0};const r=(0,t.createPromiseCapability)();return this._requests.push(r),r.promise}cancel(r){this._done=!0,this._requests.forEach(function(d){d.resolve({value:void 0,done:!0})}),this._requests=[],this._stream._removeRangeReader(this)}}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WebGLContext=void 0;var t=s(2);class c{constructor({enable:o=!1}){this._enabled=o===!0}get isEnabled(){let o=this._enabled;return o&&(o=a.tryInitGL()),(0,t.shadow)(this,"isEnabled",o)}composeSMask({layer:o,mask:l,properties:r}){return a.composeSMask(o,l,r)}drawFigures({width:o,height:l,backgroundColor:r,figures:d,context:h}){return a.drawFigures(o,l,r,d,h)}clear(){a.cleanup()}}i.WebGLContext=c;const a=function(){function o(T,k,L){const A=T.createShader(L);if(T.shaderSource(A,k),T.compileShader(A),!T.getShaderParameter(A,T.COMPILE_STATUS)){const K=T.getShaderInfoLog(A);throw new Error("Error during shader compilation: "+K)}return A}function l(T,k){return o(T,k,T.VERTEX_SHADER)}function r(T,k){return o(T,k,T.FRAGMENT_SHADER)}function d(T,k){const L=T.createProgram();for(let F=0,K=k.length;F<K;++F)T.attachShader(L,k[F]);if(T.linkProgram(L),!T.getProgramParameter(L,T.LINK_STATUS)){const F=T.getProgramInfoLog(L);throw new Error("Error during program linking: "+F)}return L}function h(T,k,L){T.activeTexture(L);const A=T.createTexture();return T.bindTexture(T.TEXTURE_2D,A),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.NEAREST),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.NEAREST),T.texImage2D(T.TEXTURE_2D,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,k),A}let _,f;function g(){_||(f=document.createElement("canvas"),_=f.getContext("webgl",{premultipliedalpha:!1}))}const x="  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             ",w="  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ";let S=null;function M(){g();const T=f;f=null;const k=_;_=null;const L=l(k,x),A=r(k,w),F=d(k,[L,A]);k.useProgram(F);const K={};K.gl=k,K.canvas=T,K.resolutionLocation=k.getUniformLocation(F,"u_resolution"),K.positionLocation=k.getAttribLocation(F,"a_position"),K.backdropLocation=k.getUniformLocation(F,"u_backdrop"),K.subtypeLocation=k.getUniformLocation(F,"u_subtype");const Q=k.getAttribLocation(F,"a_texCoord"),Z=k.getUniformLocation(F,"u_image"),B=k.getUniformLocation(F,"u_mask"),z=k.createBuffer();k.bindBuffer(k.ARRAY_BUFFER,z),k.bufferData(k.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),k.STATIC_DRAW),k.enableVertexAttribArray(Q),k.vertexAttribPointer(Q,2,k.FLOAT,!1,0,0),k.uniform1i(Z,0),k.uniform1i(B,1),S=K}function R(T,k,L){const A=T.width,F=T.height;S||M();const K=S,Q=K.canvas,Z=K.gl;Q.width=A,Q.height=F,Z.viewport(0,0,Z.drawingBufferWidth,Z.drawingBufferHeight),Z.uniform2f(K.resolutionLocation,A,F),L.backdrop?Z.uniform4f(K.resolutionLocation,L.backdrop[0],L.backdrop[1],L.backdrop[2],1):Z.uniform4f(K.resolutionLocation,0,0,0,0),Z.uniform1i(K.subtypeLocation,L.subtype==="Luminosity"?1:0);const B=h(Z,T,Z.TEXTURE0),z=h(Z,k,Z.TEXTURE1),b=Z.createBuffer();return Z.bindBuffer(Z.ARRAY_BUFFER,b),Z.bufferData(Z.ARRAY_BUFFER,new Float32Array([0,0,A,0,0,F,0,F,A,0,A,F]),Z.STATIC_DRAW),Z.enableVertexAttribArray(K.positionLocation),Z.vertexAttribPointer(K.positionLocation,2,Z.FLOAT,!1,0,0),Z.clearColor(0,0,0,0),Z.enable(Z.BLEND),Z.blendFunc(Z.ONE,Z.ONE_MINUS_SRC_ALPHA),Z.clear(Z.COLOR_BUFFER_BIT),Z.drawArrays(Z.TRIANGLES,0,6),Z.flush(),Z.deleteTexture(B),Z.deleteTexture(z),Z.deleteBuffer(b),Q}const C="  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             ",u="  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ";let m=null;function y(){g();const T=f;f=null;const k=_;_=null;const L=l(k,C),A=r(k,u),F=d(k,[L,A]);k.useProgram(F);const K={};K.gl=k,K.canvas=T,K.resolutionLocation=k.getUniformLocation(F,"u_resolution"),K.scaleLocation=k.getUniformLocation(F,"u_scale"),K.offsetLocation=k.getUniformLocation(F,"u_offset"),K.positionLocation=k.getAttribLocation(F,"a_position"),K.colorLocation=k.getAttribLocation(F,"a_color"),m=K}function v(T,k,L,A,F){m||y();const K=m,Q=K.canvas,Z=K.gl;Q.width=T,Q.height=k,Z.viewport(0,0,Z.drawingBufferWidth,Z.drawingBufferHeight),Z.uniform2f(K.resolutionLocation,T,k);let B=0;for(let se=0,pe=A.length;se<pe;se++)switch(A[se].type){case"lattice":const _e=A[se].coords.length/A[se].verticesPerRow|0;B+=(_e-1)*(A[se].verticesPerRow-1)*6;break;case"triangles":B+=A[se].coords.length;break}const z=new Float32Array(B*2),b=new Uint8Array(B*3),N=F.coords,U=F.colors;let q=0,j=0;for(let se=0,pe=A.length;se<pe;se++){const _e=A[se],Ee=_e.coords,X=_e.colors;switch(_e.type){case"lattice":const D=_e.verticesPerRow,te=Ee.length/D|0;for(let re=1;re<te;re++){let oe=re*D+1;for(let ve=1;ve<D;ve++,oe++)z[q]=N[Ee[oe-D-1]],z[q+1]=N[Ee[oe-D-1]+1],z[q+2]=N[Ee[oe-D]],z[q+3]=N[Ee[oe-D]+1],z[q+4]=N[Ee[oe-1]],z[q+5]=N[Ee[oe-1]+1],b[j]=U[X[oe-D-1]],b[j+1]=U[X[oe-D-1]+1],b[j+2]=U[X[oe-D-1]+2],b[j+3]=U[X[oe-D]],b[j+4]=U[X[oe-D]+1],b[j+5]=U[X[oe-D]+2],b[j+6]=U[X[oe-1]],b[j+7]=U[X[oe-1]+1],b[j+8]=U[X[oe-1]+2],z[q+6]=z[q+2],z[q+7]=z[q+3],z[q+8]=z[q+4],z[q+9]=z[q+5],z[q+10]=N[Ee[oe]],z[q+11]=N[Ee[oe]+1],b[j+9]=b[j+3],b[j+10]=b[j+4],b[j+11]=b[j+5],b[j+12]=b[j+6],b[j+13]=b[j+7],b[j+14]=b[j+8],b[j+15]=U[X[oe]],b[j+16]=U[X[oe]+1],b[j+17]=U[X[oe]+2],q+=12,j+=18}break;case"triangles":for(let re=0,oe=Ee.length;re<oe;re++)z[q]=N[Ee[re]],z[q+1]=N[Ee[re]+1],b[j]=U[X[re]],b[j+1]=U[X[re]+1],b[j+2]=U[X[re]+2],q+=2,j+=3;break}}L?Z.clearColor(L[0]/255,L[1]/255,L[2]/255,1):Z.clearColor(0,0,0,0),Z.clear(Z.COLOR_BUFFER_BIT);const Y=Z.createBuffer();Z.bindBuffer(Z.ARRAY_BUFFER,Y),Z.bufferData(Z.ARRAY_BUFFER,z,Z.STATIC_DRAW),Z.enableVertexAttribArray(K.positionLocation),Z.vertexAttribPointer(K.positionLocation,2,Z.FLOAT,!1,0,0);const J=Z.createBuffer();return Z.bindBuffer(Z.ARRAY_BUFFER,J),Z.bufferData(Z.ARRAY_BUFFER,b,Z.STATIC_DRAW),Z.enableVertexAttribArray(K.colorLocation),Z.vertexAttribPointer(K.colorLocation,3,Z.UNSIGNED_BYTE,!1,0,0),Z.uniform2f(K.scaleLocation,F.scaleX,F.scaleY),Z.uniform2f(K.offsetLocation,F.offsetX,F.offsetY),Z.drawArrays(Z.TRIANGLES,0,B),Z.flush(),Z.deleteBuffer(Y),Z.deleteBuffer(J),Q}return{tryInitGL(){try{return g(),!!_}catch{}return!1},composeSMask:R,drawFigures:v,cleanup(){S!=null&&S.canvas&&(S.canvas.width=0,S.canvas.height=0),m!=null&&m.canvas&&(m.canvas.width=0,m.canvas.height=0),S=null,m=null}}}()},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationLayer=void 0;var t=s(1),c=s(2),a=s(8),n=s(19);class o{static create(b){switch(b.data.annotationType){case c.AnnotationType.LINK:return new r(b);case c.AnnotationType.TEXT:return new d(b);case c.AnnotationType.WIDGET:switch(b.data.fieldType){case"Tx":return new _(b);case"Btn":return b.data.radioButton?new g(b):b.data.checkBox?new f(b):new x(b);case"Ch":return new w(b)}return new h(b);case c.AnnotationType.POPUP:return new S(b);case c.AnnotationType.FREETEXT:return new R(b);case c.AnnotationType.LINE:return new C(b);case c.AnnotationType.SQUARE:return new u(b);case c.AnnotationType.CIRCLE:return new m(b);case c.AnnotationType.POLYLINE:return new y(b);case c.AnnotationType.CARET:return new T(b);case c.AnnotationType.INK:return new k(b);case c.AnnotationType.POLYGON:return new v(b);case c.AnnotationType.HIGHLIGHT:return new L(b);case c.AnnotationType.UNDERLINE:return new A(b);case c.AnnotationType.SQUIGGLY:return new F(b);case c.AnnotationType.STRIKEOUT:return new K(b);case c.AnnotationType.STAMP:return new Q(b);case c.AnnotationType.FILEATTACHMENT:return new Z(b);default:return new l(b)}}}class l{constructor(b,{isRenderable:N=!1,ignoreBorder:U=!1,createQuadrilaterals:q=!1}={}){this.isRenderable=N,this.data=b.data,this.layer=b.layer,this.page=b.page,this.viewport=b.viewport,this.linkService=b.linkService,this.downloadManager=b.downloadManager,this.imageResourcesPath=b.imageResourcesPath,this.renderInteractiveForms=b.renderInteractiveForms,this.svgFactory=b.svgFactory,this.annotationStorage=b.annotationStorage,this.enableScripting=b.enableScripting,this.hasJSActions=b.hasJSActions,this._mouseState=b.mouseState,N&&(this.container=this._createContainer(U)),q&&(this.quadrilaterals=this._createQuadrilaterals(U))}_createContainer(b=!1){const N=this.data,U=this.page,q=this.viewport,j=document.createElement("section");let Y=N.rect[2]-N.rect[0],J=N.rect[3]-N.rect[1];j.setAttribute("data-annotation-id",N.id);const se=c.Util.normalizeRect([N.rect[0],U.view[3]-N.rect[1]+U.view[1],N.rect[2],U.view[3]-N.rect[3]+U.view[1]]);if(j.style.transform=`matrix(${q.transform.join(",")})`,j.style.transformOrigin=`${-se[0]}px ${-se[1]}px`,!b&&N.borderStyle.width>0){j.style.borderWidth=`${N.borderStyle.width}px`,N.borderStyle.style!==c.AnnotationBorderStyleType.UNDERLINE&&(Y=Y-2*N.borderStyle.width,J=J-2*N.borderStyle.width);const pe=N.borderStyle.horizontalCornerRadius,_e=N.borderStyle.verticalCornerRadius;if(pe>0||_e>0){const Ee=`${pe}px / ${_e}px`;j.style.borderRadius=Ee}switch(N.borderStyle.style){case c.AnnotationBorderStyleType.SOLID:j.style.borderStyle="solid";break;case c.AnnotationBorderStyleType.DASHED:j.style.borderStyle="dashed";break;case c.AnnotationBorderStyleType.BEVELED:(0,c.warn)("Unimplemented border style: beveled");break;case c.AnnotationBorderStyleType.INSET:(0,c.warn)("Unimplemented border style: inset");break;case c.AnnotationBorderStyleType.UNDERLINE:j.style.borderBottomStyle="solid";break}N.color?j.style.borderColor=c.Util.makeHexColor(N.color[0]|0,N.color[1]|0,N.color[2]|0):j.style.borderWidth=0}return j.style.left=`${se[0]}px`,j.style.top=`${se[1]}px`,j.style.width=`${Y}px`,j.style.height=`${J}px`,j}_createQuadrilaterals(b=!1){if(!this.data.quadPoints)return null;const N=[],U=this.data.rect;for(const q of this.data.quadPoints)this.data.rect=[q[2].x,q[2].y,q[1].x,q[1].y],N.push(this._createContainer(b));return this.data.rect=U,N}_createPopup(b,N){let U=this.container;this.quadrilaterals&&(b=b||this.quadrilaterals,U=this.quadrilaterals[0]),b||(b=document.createElement("div"),b.style.height=U.style.height,b.style.width=U.style.width,U.appendChild(b));const j=new M({container:U,trigger:b,color:N.color,title:N.title,modificationDate:N.modificationDate,contents:N.contents,hideWrapper:!0}).render();j.style.left=U.style.width,U.appendChild(j)}_renderQuadrilaterals(b){return this.quadrilaterals.forEach(N=>{N.className=b}),this.quadrilaterals}render(){(0,c.unreachable)("Abstract method `AnnotationElement.render` called")}}class r extends l{constructor(b){const N=!!(b.data.url||b.data.dest||b.data.action||b.data.isTooltipOnly||b.data.actions&&(b.data.actions.Action||b.data.actions["Mouse Up"]||b.data.actions["Mouse Down"]));super(b,{isRenderable:N,createQuadrilaterals:!0})}render(){const{data:b,linkService:N}=this,U=document.createElement("a");return b.url?(0,t.addLinkAttributes)(U,{url:b.url,target:b.newWindow?t.LinkTarget.BLANK:N.externalLinkTarget,rel:N.externalLinkRel,enabled:N.externalLinkEnabled}):b.action?this._bindNamedAction(U,b.action):b.dest?this._bindLink(U,b.dest):b.actions&&(b.actions.Action||b.actions["Mouse Up"]||b.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions?this._bindJSAction(U,b):this._bindLink(U,""),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((q,j)=>{const Y=j===0?U:U.cloneNode();return q.appendChild(Y),q}):(this.container.className="linkAnnotation",this.container.appendChild(U),this.container)}_bindLink(b,N){b.href=this.linkService.getDestinationHash(N),b.onclick=()=>(N&&this.linkService.goToDestination(N),!1),(N||N==="")&&(b.className="internalLink")}_bindNamedAction(b,N){b.href=this.linkService.getAnchorUrl(""),b.onclick=()=>(this.linkService.executeNamedAction(N),!1),b.className="internalLink"}_bindJSAction(b,N){b.href=this.linkService.getAnchorUrl("");const U=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const q of Object.keys(N.actions)){const j=U.get(q);j&&(b[j]=()=>{var Y;return(Y=this.linkService.eventBus)==null||Y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N.id,name:q}}),!1})}b.className="internalLink"}}class d extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N})}render(){this.container.className="textAnnotation";const b=document.createElement("img");return b.style.height=this.container.style.height,b.style.width=this.container.style.width,b.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",b.alt="[{{type}} Annotation]",b.dataset.l10nId="text_annotation_type",b.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(b,this.data),this.container.appendChild(b),this.container}}class h extends l{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(b){return navigator.platform.includes("Win")&&b.ctrlKey||navigator.platform.includes("Mac")&&b.metaKey}_setEventListener(b,N,U,q){N.includes("mouse")?b.addEventListener(N,j=>{var Y;(Y=this.linkService.eventBus)==null||Y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:U,value:q(j),shift:j.shiftKey,modifier:this._getKeyModifier(j)}})}):b.addEventListener(N,j=>{var Y;(Y=this.linkService.eventBus)==null||Y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:U,value:j.target.checked}})})}_setEventListeners(b,N,U){var q;for(const[j,Y]of N)(Y==="Action"||(q=this.data.actions)!=null&&q[Y])&&this._setEventListener(b,j,Y,U)}_setColor(b){const{detail:N,target:U}=b,{style:q}=U;for(const j of["bgColor","fillColor","fgColor","textColor","borderColor","strokeColor"]){let Y=N[j];if(Y)switch(Y=n.ColorConverters[`${Y[0]}_HTML`](Y.slice(1)),j){case"bgColor":case"fillColor":q.backgroundColor=Y;break;case"fgColor":case"textColor":q.color=Y;break;case"borderColor":case"strokeColor":q.borderColor=Y;break}}}}class _ extends h{constructor(b){const N=b.renderInteractiveForms||!b.data.hasAppearance&&!!b.data.fieldValue;super(b,{isRenderable:N})}render(){var q;const b=this.annotationStorage,N=this.data.id;this.container.className="textWidgetAnnotation";let U=null;if(this.renderInteractiveForms){const j=b.getValue(N,{value:this.data.fieldValue,valueAsString:this.data.fieldValue}),Y=j.valueAsString||j.value||"",J={userValue:null,formattedValue:null,beforeInputSelectionRange:null,beforeInputValue:null};this.data.multiLine?(U=document.createElement("textarea"),U.textContent=Y):(U=document.createElement("input"),U.type="text",U.setAttribute("value",Y)),J.userValue=Y,U.setAttribute("id",N),U.addEventListener("input",function(pe){b.setValue(N,{value:pe.target.value})});let se=pe=>{J.formattedValue&&(pe.target.value=J.formattedValue),pe.target.setSelectionRange(0,0),J.beforeInputSelectionRange=null};if(this.enableScripting&&this.hasJSActions){U.addEventListener("focus",_e=>{J.userValue&&(_e.target.value=J.userValue)}),U.addEventListener("updatefromsandbox",_e=>{const{detail:Ee}=_e,X={value(){J.userValue=Ee.value||"",b.setValue(N,{value:J.userValue.toString()}),J.formattedValue||(_e.target.value=J.userValue)},valueAsString(){J.formattedValue=Ee.valueAsString||"",_e.target!==document.activeElement&&(_e.target.value=J.formattedValue),b.setValue(N,{formattedValue:J.formattedValue})},focus(){setTimeout(()=>_e.target.focus({preventScroll:!1}),0)},userName(){_e.target.title=Ee.userName},hidden(){_e.target.style.visibility=Ee.hidden?"hidden":"visible",b.setValue(N,{hidden:Ee.hidden})},editable(){_e.target.disabled=!Ee.editable},selRange(){const[D,te]=Ee.selRange;D>=0&&te<_e.target.value.length&&_e.target.setSelectionRange(D,te)}};Object.keys(Ee).filter(D=>D in X).forEach(D=>X[D]()),this._setColor(_e)}),U.addEventListener("keydown",_e=>{var X;J.beforeInputValue=_e.target.value;let Ee=-1;_e.key==="Escape"?Ee=0:_e.key==="Enter"?Ee=2:_e.key==="Tab"&&(Ee=3),Ee!==-1&&(J.userValue=_e.target.value,(X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:_e.target.value,willCommit:!0,commitKey:Ee,selStart:_e.target.selectionStart,selEnd:_e.target.selectionEnd}}))});const pe=se;se=null,U.addEventListener("blur",_e=>{var Ee;this._mouseState.isDown&&(J.userValue=_e.target.value,(Ee=this.linkService.eventBus)==null||Ee.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:_e.target.value,willCommit:!0,commitKey:1,selStart:_e.target.selectionStart,selEnd:_e.target.selectionEnd}})),pe(_e)}),U.addEventListener("mousedown",_e=>{J.beforeInputValue=_e.target.value,J.beforeInputSelectionRange=null}),U.addEventListener("keyup",_e=>{_e.target.selectionStart===_e.target.selectionEnd&&(J.beforeInputSelectionRange=null)}),U.addEventListener("select",_e=>{J.beforeInputSelectionRange=[_e.target.selectionStart,_e.target.selectionEnd]}),(q=this.data.actions)!=null&&q.Keystroke&&U.addEventListener("input",_e=>{var D;let Ee=-1,X=-1;J.beforeInputSelectionRange&&([Ee,X]=J.beforeInputSelectionRange),(D=this.linkService.eventBus)==null||D.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:J.beforeInputValue,change:_e.data,willCommit:!1,selStart:Ee,selEnd:X}})}),this._setEventListeners(U,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_e=>_e.target.value)}if(se&&U.addEventListener("blur",se),U.disabled=this.data.readOnly,U.name=this.data.fieldName,this.data.maxLen!==null&&(U.maxLength=this.data.maxLen),this.data.comb){const _e=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;U.classList.add("comb"),U.style.letterSpacing=`calc(${_e}px - 1ch)`}}else U=document.createElement("div"),U.textContent=this.data.fieldValue,U.style.verticalAlign="middle",U.style.display="table-cell";return this._setTextStyle(U),this.container.appendChild(U),this.container}_setTextStyle(b){const N=["left","center","right"],{fontSize:U,fontColor:q}=this.data.defaultAppearanceData,j=b.style;U&&(j.fontSize=`${U}px`),j.color=c.Util.makeHexColor(q[0],q[1],q[2]),this.data.textAlignment!==null&&(j.textAlign=N[this.data.textAlignment])}}class f extends h{constructor(b){super(b,{isRenderable:b.renderInteractiveForms})}render(){const b=this.annotationStorage,N=this.data,U=N.id,q=b.getValue(U,{value:N.fieldValue&&(N.exportValue&&N.exportValue===N.fieldValue||!N.exportValue&&N.fieldValue!=="Off")}).value;this.container.className="buttonWidgetAnnotation checkBox";const j=document.createElement("input");return j.disabled=N.readOnly,j.type="checkbox",j.name=this.data.fieldName,q&&j.setAttribute("checked",!0),j.setAttribute("id",U),j.addEventListener("change",function(Y){const J=Y.target.name;for(const se of document.getElementsByName(J))se!==Y.target&&(se.checked=!1,b.setValue(se.parentNode.getAttribute("data-annotation-id"),{value:!1}));b.setValue(U,{value:Y.target.checked})}),this.enableScripting&&this.hasJSActions&&(j.addEventListener("updatefromsandbox",Y=>{const{detail:J}=Y,se={value(){Y.target.checked=J.value!=="Off",b.setValue(U,{value:Y.target.checked})},focus(){setTimeout(()=>Y.target.focus({preventScroll:!1}),0)},hidden(){Y.target.style.visibility=J.hidden?"hidden":"visible",b.setValue(U,{hidden:J.hidden})},editable(){Y.target.disabled=!J.editable}};Object.keys(J).filter(pe=>pe in se).forEach(pe=>se[pe]()),this._setColor(Y)}),this._setEventListeners(j,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Y=>Y.target.checked)),this.container.appendChild(j),this.container}}class g extends h{constructor(b){super(b,{isRenderable:b.renderInteractiveForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const b=this.annotationStorage,N=this.data,U=N.id,q=b.getValue(U,{value:N.fieldValue===N.buttonValue}).value,j=document.createElement("input");if(j.disabled=N.readOnly,j.type="radio",j.name=N.fieldName,q&&j.setAttribute("checked",!0),j.setAttribute("id",U),j.addEventListener("change",function(Y){const{target:J}=Y;for(const se of document.getElementsByName(J.name))se!==J&&b.setValue(se.getAttribute("id"),{value:!1});b.setValue(U,{value:J.checked})}),this.enableScripting&&this.hasJSActions){const Y=N.buttonValue;j.addEventListener("updatefromsandbox",J=>{const{detail:se}=J,pe={value(){const _e=Y===se.value;for(const Ee of document.getElementsByName(J.target.name)){const X=Ee.getAttribute("id");Ee.checked=X===U&&_e,b.setValue(X,{value:Ee.checked})}},focus(){setTimeout(()=>J.target.focus({preventScroll:!1}),0)},hidden(){J.target.style.visibility=se.hidden?"hidden":"visible",b.setValue(U,{hidden:se.hidden})},editable(){J.target.disabled=!se.editable}};Object.keys(se).filter(_e=>_e in pe).forEach(_e=>pe[_e]()),this._setColor(J)}),this._setEventListeners(j,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],J=>J.target.checked)}return this.container.appendChild(j),this.container}}class x extends r{render(){const b=super.render();return b.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(b.title=this.data.alternativeText),b}}class w extends h{constructor(b){super(b,{isRenderable:b.renderInteractiveForms})}render(){this.container.className="choiceWidgetAnnotation";const b=this.annotationStorage,N=this.data.id;b.getValue(N,{value:this.data.fieldValue.length>0?this.data.fieldValue[0]:void 0});const U=document.createElement("select");U.disabled=this.data.readOnly,U.name=this.data.fieldName,U.setAttribute("id",N),this.data.combo||(U.size=this.data.options.length,this.data.multiSelect&&(U.multiple=!0));for(const Y of this.data.options){const J=document.createElement("option");J.textContent=Y.displayValue,J.value=Y.exportValue,this.data.fieldValue.includes(Y.exportValue)&&J.setAttribute("selected",!0),U.appendChild(J)}const q=(Y,J)=>{const se=J?"value":"textContent",pe=Y.target.options;return Y.target.multiple?Array.prototype.filter.call(pe,_e=>_e.selected).map(_e=>_e[se]):pe.selectedIndex===-1?null:pe[pe.selectedIndex][se]},j=Y=>{const J=Y.target.options;return Array.prototype.map.call(J,se=>({displayValue:se.textContent,exportValue:se.value}))};return this.enableScripting&&this.hasJSActions?(U.addEventListener("updatefromsandbox",Y=>{const{detail:J}=Y,se={value(){const pe=U.options,_e=J.value,Ee=new Set(Array.isArray(_e)?_e:[_e]);Array.prototype.forEach.call(pe,X=>{X.selected=Ee.has(X.value)}),b.setValue(N,{value:q(Y,!0)})},multipleSelection(){U.multiple=!0},remove(){const pe=U.options,_e=J.remove;pe[_e].selected=!1,U.remove(_e),pe.length>0&&Array.prototype.findIndex.call(pe,X=>X.selected)===-1&&(pe[0].selected=!0),b.setValue(N,{value:q(Y,!0),items:j(Y)})},clear(){for(;U.length!==0;)U.remove(0);b.setValue(N,{value:null,items:[]})},insert(){const{index:pe,displayValue:_e,exportValue:Ee}=J.insert,X=document.createElement("option");X.textContent=_e,X.value=Ee,U.insertBefore(X,U.children[pe]),b.setValue(N,{value:q(Y,!0),items:j(Y)})},items(){const{items:pe}=J;for(;U.length!==0;)U.remove(0);for(const _e of pe){const{displayValue:Ee,exportValue:X}=_e,D=document.createElement("option");D.textContent=Ee,D.value=X,U.appendChild(D)}U.options.length>0&&(U.options[0].selected=!0),b.setValue(N,{value:q(Y,!0),items:j(Y)})},indices(){const pe=new Set(J.indices),_e=Y.target.options;Array.prototype.forEach.call(_e,(Ee,X)=>{Ee.selected=pe.has(X)}),b.setValue(N,{value:q(Y,!0)})},focus(){setTimeout(()=>Y.target.focus({preventScroll:!1}),0)},hidden(){Y.target.style.visibility=J.hidden?"hidden":"visible",b.setValue(N,{hidden:J.hidden})},editable(){Y.target.disabled=!J.editable}};Object.keys(J).filter(pe=>pe in se).forEach(pe=>se[pe]()),this._setColor(Y)}),U.addEventListener("input",Y=>{var pe;const J=q(Y,!0),se=q(Y,!1);b.setValue(N,{value:J}),(pe=this.linkService.eventBus)==null||pe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:se,changeEx:J,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(U,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],Y=>Y.target.checked)):U.addEventListener("input",function(Y){b.setValue(N,{value:q(Y)})}),this.container.appendChild(U),this.container}}class S extends l{constructor(b){const N=!!(b.data.title||b.data.contents);super(b,{isRenderable:N})}render(){const b=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",b.includes(this.data.parentType))return this.container;const N=`[data-annotation-id="${this.data.parentId}"]`,U=this.layer.querySelectorAll(N);if(U.length===0)return this.container;const q=new M({container:this.container,trigger:Array.from(U),color:this.data.color,title:this.data.title,modificationDate:this.data.modificationDate,contents:this.data.contents}),j=this.page,Y=c.Util.normalizeRect([this.data.parentRect[0],j.view[3]-this.data.parentRect[1]+j.view[1],this.data.parentRect[2],j.view[3]-this.data.parentRect[3]+j.view[1]]),J=Y[0]+this.data.parentRect[2]-this.data.parentRect[0],se=Y[1];return this.container.style.transformOrigin=`${-J}px ${-se}px`,this.container.style.left=`${J}px`,this.container.style.top=`${se}px`,this.container.appendChild(q.render()),this.container}}class M{constructor(b){this.container=b.container,this.trigger=b.trigger,this.color=b.color,this.title=b.title,this.modificationDate=b.modificationDate,this.contents=b.contents,this.hideWrapper=b.hideWrapper||!1,this.pinned=!1}render(){const N=document.createElement("div");N.className="popupWrapper",this.hideElement=this.hideWrapper?N:this.container,this.hideElement.hidden=!0;const U=document.createElement("div");U.className="popup";const q=this.color;if(q){const se=.7*(255-q[0])+q[0],pe=.7*(255-q[1])+q[1],_e=.7*(255-q[2])+q[2];U.style.backgroundColor=c.Util.makeHexColor(se|0,pe|0,_e|0)}const j=document.createElement("h1");j.textContent=this.title,U.appendChild(j);const Y=t.PDFDateString.toDateObject(this.modificationDate);if(Y){const se=document.createElement("span");se.textContent="{{date}}, {{time}}",se.dataset.l10nId="annotation_date_string",se.dataset.l10nArgs=JSON.stringify({date:Y.toLocaleDateString(),time:Y.toLocaleTimeString()}),U.appendChild(se)}const J=this._formatContents(this.contents);return U.appendChild(J),Array.isArray(this.trigger)||(this.trigger=[this.trigger]),this.trigger.forEach(se=>{se.addEventListener("click",this._toggle.bind(this)),se.addEventListener("mouseover",this._show.bind(this,!1)),se.addEventListener("mouseout",this._hide.bind(this,!1))}),U.addEventListener("click",this._hide.bind(this,!0)),N.appendChild(U),N}_formatContents(b){const N=document.createElement("p"),U=b.split(/(?:\r\n?|\n)/);for(let q=0,j=U.length;q<j;++q){const Y=U[q];N.appendChild(document.createTextNode(Y)),q<j-1&&N.appendChild(document.createElement("br"))}return N}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(b=!1){b&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(b=!0){b&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class R extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N,ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class C extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const b=this.data,N=b.rect[2]-b.rect[0],U=b.rect[3]-b.rect[1],q=this.svgFactory.create(N,U),j=this.svgFactory.createElement("svg:line");return j.setAttribute("x1",b.rect[2]-b.lineCoordinates[0]),j.setAttribute("y1",b.rect[3]-b.lineCoordinates[1]),j.setAttribute("x2",b.rect[2]-b.lineCoordinates[2]),j.setAttribute("y2",b.rect[3]-b.lineCoordinates[3]),j.setAttribute("stroke-width",b.borderStyle.width||1),j.setAttribute("stroke","transparent"),q.appendChild(j),this.container.append(q),this._createPopup(j,b),this.container}}class u extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const b=this.data,N=b.rect[2]-b.rect[0],U=b.rect[3]-b.rect[1],q=this.svgFactory.create(N,U),j=b.borderStyle.width,Y=this.svgFactory.createElement("svg:rect");return Y.setAttribute("x",j/2),Y.setAttribute("y",j/2),Y.setAttribute("width",N-j),Y.setAttribute("height",U-j),Y.setAttribute("stroke-width",j||1),Y.setAttribute("stroke","transparent"),Y.setAttribute("fill","none"),q.appendChild(Y),this.container.append(q),this._createPopup(Y,b),this.container}}class m extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const b=this.data,N=b.rect[2]-b.rect[0],U=b.rect[3]-b.rect[1],q=this.svgFactory.create(N,U),j=b.borderStyle.width,Y=this.svgFactory.createElement("svg:ellipse");return Y.setAttribute("cx",N/2),Y.setAttribute("cy",U/2),Y.setAttribute("rx",N/2-j/2),Y.setAttribute("ry",U/2-j/2),Y.setAttribute("stroke-width",j||1),Y.setAttribute("stroke","transparent"),Y.setAttribute("fill","none"),q.appendChild(Y),this.container.append(q),this._createPopup(Y,b),this.container}}class y extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const b=this.data,N=b.rect[2]-b.rect[0],U=b.rect[3]-b.rect[1],q=this.svgFactory.create(N,U);let j=[];for(const J of b.vertices){const se=J.x-b.rect[0],pe=b.rect[3]-J.y;j.push(se+","+pe)}j=j.join(" ");const Y=this.svgFactory.createElement(this.svgElementName);return Y.setAttribute("points",j),Y.setAttribute("stroke-width",b.borderStyle.width||1),Y.setAttribute("stroke","transparent"),Y.setAttribute("fill","none"),q.appendChild(Y),this.container.append(q),this._createPopup(Y,b),this.container}}class v extends y{constructor(b){super(b),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class T extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class k extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const b=this.data,N=b.rect[2]-b.rect[0],U=b.rect[3]-b.rect[1],q=this.svgFactory.create(N,U);for(const j of b.inkLists){let Y=[];for(const se of j){const pe=se.x-b.rect[0],_e=b.rect[3]-se.y;Y.push(`${pe},${_e}`)}Y=Y.join(" ");const J=this.svgFactory.createElement(this.svgElementName);J.setAttribute("points",Y),J.setAttribute("stroke-width",b.borderStyle.width||1),J.setAttribute("stroke","transparent"),J.setAttribute("fill","none"),this._createPopup(J,b),q.appendChild(J)}return this.container.append(q),this.container}}class L extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class A extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class F extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class K extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class Q extends l{constructor(b){const N=!!(b.data.hasPopup||b.data.title||b.data.contents);super(b,{isRenderable:N,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Z extends l{constructor(b){var q;super(b,{isRenderable:!0});const{filename:N,content:U}=this.data.file;this.filename=(0,t.getFilenameFromUrl)(N),this.content=U,(q=this.linkService.eventBus)==null||q.dispatch("fileattachmentannotation",{source:this,id:(0,c.stringToPDFString)(N),filename:N,content:U})}render(){this.container.className="fileAttachmentAnnotation";const b=document.createElement("div");return b.style.height=this.container.style.height,b.style.width=this.container.style.width,b.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.title||this.data.contents)&&this._createPopup(b,this.data),this.container.appendChild(b),this.container}_download(){var b;(b=this.downloadManager)==null||b.openOrDownloadData(this.container,this.content,this.filename)}}class B{static render(b){const N=[],U=[];for(const q of b.annotations)if(q){if(q.annotationType===c.AnnotationType.POPUP){U.push(q);continue}N.push(q)}U.length&&N.push(...U);for(const q of N){const j=o.create({data:q,layer:b.div,page:b.page,viewport:b.viewport,linkService:b.linkService,downloadManager:b.downloadManager,imageResourcesPath:b.imageResourcesPath||"",renderInteractiveForms:b.renderInteractiveForms!==!1,svgFactory:new t.DOMSVGFactory,annotationStorage:b.annotationStorage||new a.AnnotationStorage,enableScripting:b.enableScripting,hasJSActions:b.hasJSActions,mouseState:b.mouseState||{isDown:!1}});if(j.isRenderable){const Y=j.render();if(q.hidden&&(Y.style.visibility="hidden"),Array.isArray(Y))for(const J of Y)b.div.appendChild(J);else j instanceof S?b.div.prepend(Y):b.div.appendChild(Y)}}}static update(b){const N=`matrix(${b.viewport.transform.join(",")})`;for(const U of b.annotations){const q=b.div.querySelectorAll(`[data-annotation-id="${U.id}"]`);q&&q.forEach(j=>{j.style.transform=N})}b.div.hidden=!1}}i.AnnotationLayer=B},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorConverters=void 0;function s(c){return Math.floor(Math.max(0,Math.min(1,c))*255).toString(16).padStart(2,"0")}class t{static CMYK_G([a,n,o,l]){return["G",1-Math.min(1,.3*a+.59*o+.11*n+l)]}static G_CMYK([a]){return["CMYK",0,0,0,1-a]}static G_RGB([a]){return["RGB",a,a,a]}static G_HTML([a]){const n=s(a);return`#${n}${n}${n}`}static RGB_G([a,n,o]){return["G",.3*a+.59*n+.11*o]}static RGB_HTML([a,n,o]){const l=s(a),r=s(n),d=s(o);return`#${l}${r}${d}`}static T_HTML(){return"#00000000"}static CMYK_RGB([a,n,o,l]){return["RGB",1-Math.min(1,a+l),1-Math.min(1,o+l),1-Math.min(1,n+l)]}static CMYK_HTML(a){return this.RGB_HTML(this.CMYK_RGB(a))}static RGB_CMYK([a,n,o]){const l=1-a,r=1-n,d=1-o,h=Math.min(l,r,d);return["CMYK",l,r,d,h]}}i.ColorConverters=t},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.renderTextLayer=void 0;var t=s(2);const c=function(){const r=new Map,d=/\S/;function h(u){return!d.test(u)}function _(u,m){const y=r.get(u);if(y)return y;m.save(),m.font=`30px ${u}`;const v=m.measureText("");let T=v.fontBoundingBoxAscent,k=Math.abs(v.fontBoundingBoxDescent);if(T){m.restore();const A=T/(T+k);return r.set(u,A),A}m.strokeStyle="red",m.clearRect(0,0,30,30),m.strokeText("g",0,0);let L=m.getImageData(0,0,30,30).data;k=0;for(let A=L.length-1-3;A>=0;A-=4)if(L[A]>0){k=Math.ceil(A/4/30);break}m.clearRect(0,0,30,30),m.strokeText("A",0,30),L=m.getImageData(0,0,30,30).data,T=0;for(let A=0,F=L.length;A<F;A+=4)if(L[A]>0){T=30-Math.floor(A/4/30);break}if(m.restore(),T){const A=T/(T+k);return r.set(u,A),A}return r.set(u,.8),.8}function f(u,m,y,v){const T=document.createElement("span"),k={angle:0,canvasWidth:0,isWhitespace:!1,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};if(u._textDivs.push(T),h(m.str)){k.isWhitespace=!0,u._textDivProperties.set(T,k);return}const L=t.Util.transform(u._viewport.transform,m.transform);let A=Math.atan2(L[1],L[0]);const F=y[m.fontName];F.vertical&&(A+=Math.PI/2);const K=Math.hypot(L[2],L[3]),Q=K*_(F.fontFamily,v);let Z,B;A===0?(Z=L[4],B=L[5]-Q):(Z=L[4]+Q*Math.sin(A),B=L[5]-Q*Math.cos(A)),T.style.left=`${Z}px`,T.style.top=`${B}px`,T.style.fontSize=`${K}px`,T.style.fontFamily=F.fontFamily,T.textContent=m.str,T.dir=m.dir,u._fontInspectorEnabled&&(T.dataset.fontName=m.fontName),A!==0&&(k.angle=A*(180/Math.PI));let z=!1;if(m.str.length>1)z=!0;else if(m.transform[0]!==m.transform[3]){const b=Math.abs(m.transform[0]),N=Math.abs(m.transform[3]);b!==N&&Math.max(b,N)/Math.min(b,N)>1.5&&(z=!0)}if(z&&(F.vertical?k.canvasWidth=m.height*u._viewport.scale:k.canvasWidth=m.width*u._viewport.scale),u._textDivProperties.set(T,k),u._textContentStream&&u._layoutText(T),u._enhanceTextSelection){let b=1,N=0;A!==0&&(b=Math.cos(A),N=Math.sin(A));const U=(F.vertical?m.height:m.width)*u._viewport.scale,q=K;let j,Y;A!==0?(j=[b,N,-N,b,Z,B],Y=t.Util.getAxialAlignedBoundingBox([0,0,U,q],j)):Y=[Z,B,Z+U,B+q],u._bounds.push({left:Y[0],top:Y[1],right:Y[2],bottom:Y[3],div:T,size:[U,q],m:j})}}function g(u){if(u._canceled)return;const m=u._textDivs,y=u._capability,v=m.length;if(v>1e5){u._renderingDone=!0,y.resolve();return}if(!u._textContentStream)for(let T=0;T<v;T++)u._layoutText(m[T]);u._renderingDone=!0,y.resolve()}function x(u,m,y){let v=0;for(let T=0;T<y;T++){const k=u[m++];k>0&&(v=v?Math.min(k,v):k)}return v}function w(u){const m=u._bounds,y=u._viewport,v=S(y.width,y.height,m);for(let T=0;T<v.length;T++){const k=m[T].div,L=u._textDivProperties.get(k);if(L.angle===0){L.paddingLeft=m[T].left-v[T].left,L.paddingTop=m[T].top-v[T].top,L.paddingRight=v[T].right-m[T].right,L.paddingBottom=v[T].bottom-m[T].bottom,u._textDivProperties.set(k,L);continue}const A=v[T],F=m[T],K=F.m,Q=K[0],Z=K[1],B=[[0,0],[0,F.size[1]],[F.size[0],0],F.size],z=new Float64Array(64);B.forEach(function(N,U){const q=t.Util.applyTransform(N,K);z[U+0]=Q&&(A.left-q[0])/Q,z[U+4]=Z&&(A.top-q[1])/Z,z[U+8]=Q&&(A.right-q[0])/Q,z[U+12]=Z&&(A.bottom-q[1])/Z,z[U+16]=Z&&(A.left-q[0])/-Z,z[U+20]=Q&&(A.top-q[1])/Q,z[U+24]=Z&&(A.right-q[0])/-Z,z[U+28]=Q&&(A.bottom-q[1])/Q,z[U+32]=Q&&(A.left-q[0])/-Q,z[U+36]=Z&&(A.top-q[1])/-Z,z[U+40]=Q&&(A.right-q[0])/-Q,z[U+44]=Z&&(A.bottom-q[1])/-Z,z[U+48]=Z&&(A.left-q[0])/Z,z[U+52]=Q&&(A.top-q[1])/-Q,z[U+56]=Z&&(A.right-q[0])/Z,z[U+60]=Q&&(A.bottom-q[1])/-Q});const b=1+Math.min(Math.abs(Q),Math.abs(Z));L.paddingLeft=x(z,32,16)/b,L.paddingTop=x(z,48,16)/b,L.paddingRight=x(z,0,16)/b,L.paddingBottom=x(z,16,16)/b,u._textDivProperties.set(k,L)}}function S(u,m,y){const v=y.map(function(k,L){return{x1:k.left,y1:k.top,x2:k.right,y2:k.bottom,index:L,x1New:void 0,x2New:void 0}});M(u,v);const T=new Array(y.length);return v.forEach(function(k){const L=k.index;T[L]={left:k.x1New,top:0,right:k.x2New,bottom:0}}),y.map(function(k,L){const A=T[L],F=v[L];F.x1=k.top,F.y1=u-A.right,F.x2=k.bottom,F.y2=u-A.left,F.index=L,F.x1New=void 0,F.x2New=void 0}),M(m,v),v.forEach(function(k){const L=k.index;T[L].top=k.x1New,T[L].bottom=k.x2New}),T}function M(u,m){m.sort(function(T,k){return T.x1-k.x1||T.index-k.index});const v=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];m.forEach(function(T){let k=0;for(;k<v.length&&v[k].end<=T.y1;)k++;let L=v.length-1;for(;L>=0&&v[L].start>=T.y2;)L--;let A,F,K,Q,Z=-1/0;for(K=k;K<=L;K++){A=v[K],F=A.boundary;let b;F.x2>T.x1?b=F.index>T.index?F.x1New:T.x1:F.x2New===void 0?b=(F.x2+T.x1)/2:b=F.x2New,b>Z&&(Z=b)}for(T.x1New=Z,K=k;K<=L;K++)A=v[K],F=A.boundary,F.x2New===void 0?F.x2>T.x1?F.index>T.index&&(F.x2New=F.x2):F.x2New=Z:F.x2New>Z&&(F.x2New=Math.max(Z,F.x2));const B=[];let z=null;for(K=k;K<=L;K++){A=v[K],F=A.boundary;const b=F.x2>T.x2?F:T;z===b?B[B.length-1].end=A.end:(B.push({start:A.start,end:A.end,boundary:b}),z=b)}for(v[k].start<T.y1&&(B[0].start=T.y1,B.unshift({start:v[k].start,end:T.y1,boundary:v[k].boundary})),T.y2<v[L].end&&(B[B.length-1].end=T.y2,B.push({start:T.y2,end:v[L].end,boundary:v[L].boundary})),K=k;K<=L;K++){if(A=v[K],F=A.boundary,F.x2New!==void 0)continue;let b=!1;for(Q=k-1;!b&&Q>=0&&v[Q].start>=F.y1;Q--)b=v[Q].boundary===F;for(Q=L+1;!b&&Q<v.length&&v[Q].end<=F.y2;Q++)b=v[Q].boundary===F;for(Q=0;!b&&Q<B.length;Q++)b=B[Q].boundary===F;b||(F.x2New=Z)}Array.prototype.splice.apply(v,[k,L-k+1].concat(B))}),v.forEach(function(T){const k=T.boundary;k.x2New===void 0&&(k.x2New=Math.max(u,k.x2))})}function R({textContent:u,textContentStream:m,container:y,viewport:v,textDivs:T,textContentItemsStr:k,enhanceTextSelection:L}){var A;this._textContent=u,this._textContentStream=m,this._container=y,this._document=y.ownerDocument,this._viewport=v,this._textDivs=T||[],this._textContentItemsStr=k||[],this._enhanceTextSelection=!!L,this._fontInspectorEnabled=!!((A=globalThis.FontInspector)!=null&&A.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,t.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally(()=>{this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}R.prototype={get promise(){return this._capability.promise},cancel:function(){this._canceled=!0,this._reader&&(this._reader.cancel(new t.AbortException("TextLayer task cancelled.")),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))},_processItems(u,m){for(let y=0,v=u.length;y<v;y++)this._textContentItemsStr.push(u[y].str),f(this,u[y],m,this._layoutTextCtx)},_layoutText(u){const m=this._textDivProperties.get(u);if(m.isWhitespace)return;let y="";if(m.canvasWidth!==0){const{fontSize:v,fontFamily:T}=u.style;(v!==this._layoutTextLastFontSize||T!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${v} ${T}`,this._layoutTextLastFontSize=v,this._layoutTextLastFontFamily=T);const{width:k}=this._layoutTextCtx.measureText(u.textContent);k>0&&(m.scale=m.canvasWidth/k,y=`scaleX(${m.scale})`)}m.angle!==0&&(y=`rotate(${m.angle}deg) ${y}`),y.length>0&&(this._enhanceTextSelection&&(m.originalTransform=y),u.style.transform=y),this._textDivProperties.set(u,m),this._container.appendChild(u)},_render:function(m){const y=(0,t.createPromiseCapability)();let v=Object.create(null);const T=this._document.createElement("canvas");if(T.height=T.width=30,T.mozOpaque=!0,this._layoutTextCtx=T.getContext("2d",{alpha:!1}),this._textContent){const k=this._textContent.items,L=this._textContent.styles;this._processItems(k,L),y.resolve()}else if(this._textContentStream){const k=()=>{this._reader.read().then(({value:L,done:A})=>{if(A){y.resolve();return}Object.assign(v,L.styles),this._processItems(L.items,v),k()},y.reject)};this._reader=this._textContentStream.getReader(),k()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');y.promise.then(()=>{v=null,m?this._renderTimer=setTimeout(()=>{g(this),this._renderTimer=null},m):g(this)},this._capability.reject)},expandTextDivs:function(m){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(w(this),this._bounds=null);const y=[],v=[];for(let T=0,k=this._textDivs.length;T<k;T++){const L=this._textDivs[T],A=this._textDivProperties.get(L);A.isWhitespace||(m?(y.length=0,v.length=0,A.originalTransform&&y.push(A.originalTransform),A.paddingTop>0?(v.push(`${A.paddingTop}px`),y.push(`translateY(${-A.paddingTop}px)`)):v.push(0),A.paddingRight>0?v.push(`${A.paddingRight/A.scale}px`):v.push(0),A.paddingBottom>0?v.push(`${A.paddingBottom}px`):v.push(0),A.paddingLeft>0?(v.push(`${A.paddingLeft/A.scale}px`),y.push(`translateX(${-A.paddingLeft/A.scale}px)`)):v.push(0),L.style.padding=v.join(" "),y.length&&(L.style.transform=y.join(" "))):(L.style.padding=null,L.style.transform=A.originalTransform))}}};function C(u){const m=new R({textContent:u.textContent,textContentStream:u.textContentStream,container:u.container,viewport:u.viewport,textDivs:u.textDivs,textContentItemsStr:u.textContentItemsStr,enhanceTextSelection:u.enhanceTextSelection});return m._render(u.timeout),m}return C}();i.renderTextLayer=c},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SVGGraphics=void 0;var t=s(2),c=s(1),a=s(4);let n=function(){throw new Error("Not implemented: SVGGraphics")};i.SVGGraphics=n;{let S=function(y){let v=[];const T=[];for(const k of y){if(k.fn==="save"){v.push({fnId:92,fn:"group",items:[]}),T.push(v),v=v[v.length-1].items;continue}k.fn==="restore"?v=T.pop():v.push(k)}return v},M=function(y){if(Number.isInteger(y))return y.toString();const v=y.toFixed(10);let T=v.length-1;if(v[T]!=="0")return v;do T--;while(v[T]==="0");return v.substring(0,v[T]==="."?T:T+1)},R=function(y){if(y[4]===0&&y[5]===0){if(y[1]===0&&y[2]===0)return y[0]===1&&y[3]===1?"":`scale(${M(y[0])} ${M(y[3])})`;if(y[0]===y[3]&&y[1]===-y[2]){const v=Math.acos(y[0])*180/Math.PI;return`rotate(${M(v)})`}}else if(y[0]===1&&y[1]===0&&y[2]===0&&y[3]===1)return`translate(${M(y[4])} ${M(y[5])})`;return`matrix(${M(y[0])} ${M(y[1])} ${M(y[2])} ${M(y[3])} ${M(y[4])} ${M(y[5])})`};var o=S,l=M,r=R;const d={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},h="http://www.w3.org/XML/1998/namespace",_="http://www.w3.org/1999/xlink",f=["butt","round","square"],g=["miter","round","bevel"],x=function(){const y=new Uint8Array([137,80,78,71,13,10,26,10]),v=12,T=new Int32Array(256);for(let Z=0;Z<256;Z++){let B=Z;for(let z=0;z<8;z++)B&1?B=3988292384^B>>1&2147483647:B=B>>1&2147483647;T[Z]=B}function k(Z,B,z){let b=-1;for(let N=B;N<z;N++){const U=(b^Z[N])&255,q=T[U];b=b>>>8^q}return b^-1}function L(Z,B,z,b){let N=b;const U=B.length;z[N]=U>>24&255,z[N+1]=U>>16&255,z[N+2]=U>>8&255,z[N+3]=U&255,N+=4,z[N]=Z.charCodeAt(0)&255,z[N+1]=Z.charCodeAt(1)&255,z[N+2]=Z.charCodeAt(2)&255,z[N+3]=Z.charCodeAt(3)&255,N+=4,z.set(B,N),N+=B.length;const q=k(z,b+4,N);z[N]=q>>24&255,z[N+1]=q>>16&255,z[N+2]=q>>8&255,z[N+3]=q&255}function A(Z,B,z){let b=1,N=0;for(let U=B;U<z;++U)b=(b+(Z[U]&255))%65521,N=(N+b)%65521;return N<<16|b}function F(Z){if(!a.isNodeJS)return K(Z);try{let B;parseInt(process.versions.node)>=8?B=Z:B=Buffer.from(Z);const z=require("zlib").deflateSync(B,{level:9});return z instanceof Uint8Array?z:new Uint8Array(z)}catch(B){(0,t.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+B)}return K(Z)}function K(Z){let B=Z.length;const z=65535,b=Math.ceil(B/z),N=new Uint8Array(2+B+b*5+4);let U=0;N[U++]=120,N[U++]=156;let q=0;for(;B>z;)N[U++]=0,N[U++]=255,N[U++]=255,N[U++]=0,N[U++]=0,N.set(Z.subarray(q,q+z),U),U+=z,q+=z,B-=z;N[U++]=1,N[U++]=B&255,N[U++]=B>>8&255,N[U++]=~B&65535&255,N[U++]=(~B&65535)>>8&255,N.set(Z.subarray(q),U),U+=Z.length-q;const j=A(Z,0,Z.length);return N[U++]=j>>24&255,N[U++]=j>>16&255,N[U++]=j>>8&255,N[U++]=j&255,N}function Q(Z,B,z,b){const N=Z.width,U=Z.height;let q,j,Y;const J=Z.data;switch(B){case t.ImageKind.GRAYSCALE_1BPP:j=0,q=1,Y=N+7>>3;break;case t.ImageKind.RGB_24BPP:j=2,q=8,Y=N*3;break;case t.ImageKind.RGBA_32BPP:j=6,q=8,Y=N*4;break;default:throw new Error("invalid format")}const se=new Uint8Array((1+Y)*U);let pe=0,_e=0;for(let oe=0;oe<U;++oe)se[pe++]=0,se.set(J.subarray(_e,_e+Y),pe),_e+=Y,pe+=Y;if(B===t.ImageKind.GRAYSCALE_1BPP&&b){pe=0;for(let oe=0;oe<U;oe++){pe++;for(let ve=0;ve<Y;ve++)se[pe++]^=255}}const Ee=new Uint8Array([N>>24&255,N>>16&255,N>>8&255,N&255,U>>24&255,U>>16&255,U>>8&255,U&255,q,j,0,0,0]),X=F(se),D=y.length+v*3+Ee.length+X.length,te=new Uint8Array(D);let re=0;return te.set(y,re),re+=y.length,L("IHDR",Ee,te,re),re+=v+Ee.length,L("IDATA",X,te,re),re+=v+X.length,L("IEND",new Uint8Array(0),te,re),(0,t.createObjectURL)(te,"image/png",z)}return function(B,z,b){const N=B.kind===void 0?t.ImageKind.GRAYSCALE_1BPP:B.kind;return Q(B,N,z,b)}}();class w{constructor(){this.fontSizeScale=1,this.fontWeight=d.fontWeight,this.fontSize=0,this.textMatrix=t.IDENTITY_MATRIX,this.fontMatrix=t.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=t.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=d.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(v,T){this.x=v,this.y=T}}let C=0,u=0,m=0;i.SVGGraphics=n=class{constructor(v,T,k=!1){this.svgFactory=new c.DOMSVGFactory,this.current=new w,this.transformMatrix=t.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=v,this.objs=T,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!k,this._operatorIdMapping=[];for(const L in t.OPS)this._operatorIdMapping[t.OPS[L]]=L}save(){this.transformStack.push(this.transformMatrix);const v=this.current;this.extraStack.push(v),this.current=v.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(v){this.save(),this.executeOpTree(v),this.restore()}loadDependencies(v){const T=v.fnArray,k=v.argsArray;for(let L=0,A=T.length;L<A;L++)if(T[L]===t.OPS.dependency)for(const F of k[L]){const K=F.startsWith("g_")?this.commonObjs:this.objs,Q=new Promise(Z=>{K.get(F,Z)});this.current.dependencies.push(Q)}return Promise.all(this.current.dependencies)}transform(v,T,k,L,A,F){const K=[v,T,k,L,A,F];this.transformMatrix=t.Util.transform(this.transformMatrix,K),this.tgrp=null}getSVG(v,T){this.viewport=T;const k=this._initialize(T);return this.loadDependencies(v).then(()=>(this.transformMatrix=t.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(v)),k))}convertOpList(v){const T=this._operatorIdMapping,k=v.argsArray,L=v.fnArray,A=[];for(let F=0,K=L.length;F<K;F++){const Q=L[F];A.push({fnId:Q,fn:T[Q],args:k[F]})}return S(A)}executeOpTree(v){for(const T of v){const k=T.fn,L=T.fnId,A=T.args;switch(L|0){case t.OPS.beginText:this.beginText();break;case t.OPS.dependency:break;case t.OPS.setLeading:this.setLeading(A);break;case t.OPS.setLeadingMoveText:this.setLeadingMoveText(A[0],A[1]);break;case t.OPS.setFont:this.setFont(A);break;case t.OPS.showText:this.showText(A[0]);break;case t.OPS.showSpacedText:this.showText(A[0]);break;case t.OPS.endText:this.endText();break;case t.OPS.moveText:this.moveText(A[0],A[1]);break;case t.OPS.setCharSpacing:this.setCharSpacing(A[0]);break;case t.OPS.setWordSpacing:this.setWordSpacing(A[0]);break;case t.OPS.setHScale:this.setHScale(A[0]);break;case t.OPS.setTextMatrix:this.setTextMatrix(A[0],A[1],A[2],A[3],A[4],A[5]);break;case t.OPS.setTextRise:this.setTextRise(A[0]);break;case t.OPS.setTextRenderingMode:this.setTextRenderingMode(A[0]);break;case t.OPS.setLineWidth:this.setLineWidth(A[0]);break;case t.OPS.setLineJoin:this.setLineJoin(A[0]);break;case t.OPS.setLineCap:this.setLineCap(A[0]);break;case t.OPS.setMiterLimit:this.setMiterLimit(A[0]);break;case t.OPS.setFillRGBColor:this.setFillRGBColor(A[0],A[1],A[2]);break;case t.OPS.setStrokeRGBColor:this.setStrokeRGBColor(A[0],A[1],A[2]);break;case t.OPS.setStrokeColorN:this.setStrokeColorN(A);break;case t.OPS.setFillColorN:this.setFillColorN(A);break;case t.OPS.shadingFill:this.shadingFill(A[0]);break;case t.OPS.setDash:this.setDash(A[0],A[1]);break;case t.OPS.setRenderingIntent:this.setRenderingIntent(A[0]);break;case t.OPS.setFlatness:this.setFlatness(A[0]);break;case t.OPS.setGState:this.setGState(A[0]);break;case t.OPS.fill:this.fill();break;case t.OPS.eoFill:this.eoFill();break;case t.OPS.stroke:this.stroke();break;case t.OPS.fillStroke:this.fillStroke();break;case t.OPS.eoFillStroke:this.eoFillStroke();break;case t.OPS.clip:this.clip("nonzero");break;case t.OPS.eoClip:this.clip("evenodd");break;case t.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case t.OPS.paintImageXObject:this.paintImageXObject(A[0]);break;case t.OPS.paintInlineImageXObject:this.paintInlineImageXObject(A[0]);break;case t.OPS.paintImageMaskXObject:this.paintImageMaskXObject(A[0]);break;case t.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(A[0],A[1]);break;case t.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case t.OPS.closePath:this.closePath();break;case t.OPS.closeStroke:this.closeStroke();break;case t.OPS.closeFillStroke:this.closeFillStroke();break;case t.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case t.OPS.nextLine:this.nextLine();break;case t.OPS.transform:this.transform(A[0],A[1],A[2],A[3],A[4],A[5]);break;case t.OPS.constructPath:this.constructPath(A[0],A[1]);break;case t.OPS.endPath:this.endPath();break;case 92:this.group(T.items);break;default:(0,t.warn)(`Unimplemented operator ${k}`);break}}}setWordSpacing(v){this.current.wordSpacing=v}setCharSpacing(v){this.current.charSpacing=v}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(v,T,k,L,A,F){const K=this.current;K.textMatrix=K.lineMatrix=[v,T,k,L,A,F],K.textMatrixScale=Math.hypot(v,T),K.x=K.lineX=0,K.y=K.lineY=0,K.xcoords=[],K.ycoords=[],K.tspan=this.svgFactory.createElement("svg:tspan"),K.tspan.setAttributeNS(null,"font-family",K.fontFamily),K.tspan.setAttributeNS(null,"font-size",`${M(K.fontSize)}px`),K.tspan.setAttributeNS(null,"y",M(-K.y)),K.txtElement=this.svgFactory.createElement("svg:text"),K.txtElement.appendChild(K.tspan)}beginText(){const v=this.current;v.x=v.lineX=0,v.y=v.lineY=0,v.textMatrix=t.IDENTITY_MATRIX,v.lineMatrix=t.IDENTITY_MATRIX,v.textMatrixScale=1,v.tspan=this.svgFactory.createElement("svg:tspan"),v.txtElement=this.svgFactory.createElement("svg:text"),v.txtgrp=this.svgFactory.createElement("svg:g"),v.xcoords=[],v.ycoords=[]}moveText(v,T){const k=this.current;k.x=k.lineX+=v,k.y=k.lineY+=T,k.xcoords=[],k.ycoords=[],k.tspan=this.svgFactory.createElement("svg:tspan"),k.tspan.setAttributeNS(null,"font-family",k.fontFamily),k.tspan.setAttributeNS(null,"font-size",`${M(k.fontSize)}px`),k.tspan.setAttributeNS(null,"y",M(-k.y))}showText(v){const T=this.current,k=T.font,L=T.fontSize;if(L===0)return;const A=T.fontSizeScale,F=T.charSpacing,K=T.wordSpacing,Q=T.fontDirection,Z=T.textHScale*Q,B=k.vertical,z=B?1:-1,b=k.defaultVMetrics,N=L*T.fontMatrix[0];let U=0;for(const Y of v){if(Y===null){U+=Q*K;continue}else if((0,t.isNum)(Y)){U+=z*Y*L/1e3;continue}const J=(Y.isSpace?K:0)+F,se=Y.fontChar;let pe,_e,Ee=Y.width;if(B){let D;const te=Y.vmetric||b;D=Y.vmetric?te[1]:Ee*.5,D=-D*N;const re=te[2]*N;Ee=te?-te[0]:Ee,pe=D/A,_e=(U+re)/A}else pe=U/A,_e=0;(Y.isInFont||k.missingFile)&&(T.xcoords.push(T.x+pe),B&&T.ycoords.push(-T.y+_e),T.tspan.textContent+=se);let X;B?X=Ee*N-J*Q:X=Ee*N+J*Q,U+=X}T.tspan.setAttributeNS(null,"x",T.xcoords.map(M).join(" ")),B?T.tspan.setAttributeNS(null,"y",T.ycoords.map(M).join(" ")):T.tspan.setAttributeNS(null,"y",M(-T.y)),B?T.y-=U:T.x+=U*Z,T.tspan.setAttributeNS(null,"font-family",T.fontFamily),T.tspan.setAttributeNS(null,"font-size",`${M(T.fontSize)}px`),T.fontStyle!==d.fontStyle&&T.tspan.setAttributeNS(null,"font-style",T.fontStyle),T.fontWeight!==d.fontWeight&&T.tspan.setAttributeNS(null,"font-weight",T.fontWeight);const q=T.textRenderingMode&t.TextRenderingMode.FILL_STROKE_MASK;if(q===t.TextRenderingMode.FILL||q===t.TextRenderingMode.FILL_STROKE?(T.fillColor!==d.fillColor&&T.tspan.setAttributeNS(null,"fill",T.fillColor),T.fillAlpha<1&&T.tspan.setAttributeNS(null,"fill-opacity",T.fillAlpha)):T.textRenderingMode===t.TextRenderingMode.ADD_TO_PATH?T.tspan.setAttributeNS(null,"fill","transparent"):T.tspan.setAttributeNS(null,"fill","none"),q===t.TextRenderingMode.STROKE||q===t.TextRenderingMode.FILL_STROKE){const Y=1/(T.textMatrixScale||1);this._setStrokeAttributes(T.tspan,Y)}let j=T.textMatrix;T.textRise!==0&&(j=j.slice(),j[5]+=T.textRise),T.txtElement.setAttributeNS(null,"transform",`${R(j)} scale(${M(Z)}, -1)`),T.txtElement.setAttributeNS(h,"xml:space","preserve"),T.txtElement.appendChild(T.tspan),T.txtgrp.appendChild(T.txtElement),this._ensureTransformGroup().appendChild(T.txtElement)}setLeadingMoveText(v,T){this.setLeading(-T),this.moveText(v,T)}addFontStyle(v){if(!v.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const T=(0,t.createObjectURL)(v.data,v.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${v.loadedName}"; src: url(${T}); }
`}setFont(v){const T=this.current,k=this.commonObjs.get(v[0]);let L=v[1];T.font=k,this.embedFonts&&!k.missingFile&&!this.embeddedFonts[k.loadedName]&&(this.addFontStyle(k),this.embeddedFonts[k.loadedName]=k),T.fontMatrix=k.fontMatrix||t.FONT_IDENTITY_MATRIX;let A="normal";k.black?A="900":k.bold&&(A="bold");const F=k.italic?"italic":"normal";L<0?(L=-L,T.fontDirection=-1):T.fontDirection=1,T.fontSize=L,T.fontFamily=k.loadedName,T.fontWeight=A,T.fontStyle=F,T.tspan=this.svgFactory.createElement("svg:tspan"),T.tspan.setAttributeNS(null,"y",M(-T.y)),T.xcoords=[],T.ycoords=[]}endText(){var T;const v=this.current;v.textRenderingMode&t.TextRenderingMode.ADD_TO_PATH_FLAG&&((T=v.txtElement)!=null&&T.hasChildNodes())&&(v.element=v.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(v){v>0&&(this.current.lineWidth=v)}setLineCap(v){this.current.lineCap=f[v]}setLineJoin(v){this.current.lineJoin=g[v]}setMiterLimit(v){this.current.miterLimit=v}setStrokeAlpha(v){this.current.strokeAlpha=v}setStrokeRGBColor(v,T,k){this.current.strokeColor=t.Util.makeHexColor(v,T,k)}setFillAlpha(v){this.current.fillAlpha=v}setFillRGBColor(v,T,k){this.current.fillColor=t.Util.makeHexColor(v,T,k),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(v){this.current.strokeColor=this._makeColorN_Pattern(v)}setFillColorN(v){this.current.fillColor=this._makeColorN_Pattern(v)}shadingFill(v){const T=this.viewport.width,k=this.viewport.height,L=t.Util.inverseTransform(this.transformMatrix),A=t.Util.applyTransform([0,0],L),F=t.Util.applyTransform([0,k],L),K=t.Util.applyTransform([T,0],L),Q=t.Util.applyTransform([T,k],L),Z=Math.min(A[0],F[0],K[0],Q[0]),B=Math.min(A[1],F[1],K[1],Q[1]),z=Math.max(A[0],F[0],K[0],Q[0]),b=Math.max(A[1],F[1],K[1],Q[1]),N=this.svgFactory.createElement("svg:rect");N.setAttributeNS(null,"x",Z),N.setAttributeNS(null,"y",B),N.setAttributeNS(null,"width",z-Z),N.setAttributeNS(null,"height",b-B),N.setAttributeNS(null,"fill",this._makeShadingPattern(v)),this.current.fillAlpha<1&&N.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(N)}_makeColorN_Pattern(v){return v[0]==="TilingPattern"?this._makeTilingPattern(v):this._makeShadingPattern(v)}_makeTilingPattern(v){const T=v[1],k=v[2],L=v[3]||t.IDENTITY_MATRIX,[A,F,K,Q]=v[4],Z=v[5],B=v[6],z=v[7],b=`shading${m++}`,[N,U]=t.Util.applyTransform([A,F],L),[q,j]=t.Util.applyTransform([K,Q],L),[Y,J]=t.Util.singularValueDecompose2dScale(L),se=Z*Y,pe=B*J,_e=this.svgFactory.createElement("svg:pattern");_e.setAttributeNS(null,"id",b),_e.setAttributeNS(null,"patternUnits","userSpaceOnUse"),_e.setAttributeNS(null,"width",se),_e.setAttributeNS(null,"height",pe),_e.setAttributeNS(null,"x",`${N}`),_e.setAttributeNS(null,"y",`${U}`);const Ee=this.svg,X=this.transformMatrix,D=this.current.fillColor,te=this.current.strokeColor,re=this.svgFactory.create(q-N,j-U);if(this.svg=re,this.transformMatrix=L,z===2){const oe=t.Util.makeHexColor(...T);this.current.fillColor=oe,this.current.strokeColor=oe}return this.executeOpTree(this.convertOpList(k)),this.svg=Ee,this.transformMatrix=X,this.current.fillColor=D,this.current.strokeColor=te,_e.appendChild(re.childNodes[0]),this.defs.appendChild(_e),`url(#${b})`}_makeShadingPattern(v){switch(v[0]){case"RadialAxial":const T=`shading${m++}`,k=v[3];let L;switch(v[1]){case"axial":const A=v[4],F=v[5];L=this.svgFactory.createElement("svg:linearGradient"),L.setAttributeNS(null,"id",T),L.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),L.setAttributeNS(null,"x1",A[0]),L.setAttributeNS(null,"y1",A[1]),L.setAttributeNS(null,"x2",F[0]),L.setAttributeNS(null,"y2",F[1]);break;case"radial":const K=v[4],Q=v[5],Z=v[6],B=v[7];L=this.svgFactory.createElement("svg:radialGradient"),L.setAttributeNS(null,"id",T),L.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),L.setAttributeNS(null,"cx",Q[0]),L.setAttributeNS(null,"cy",Q[1]),L.setAttributeNS(null,"r",B),L.setAttributeNS(null,"fx",K[0]),L.setAttributeNS(null,"fy",K[1]),L.setAttributeNS(null,"fr",Z);break;default:throw new Error(`Unknown RadialAxial type: ${v[1]}`)}for(const A of k){const F=this.svgFactory.createElement("svg:stop");F.setAttributeNS(null,"offset",A[0]),F.setAttributeNS(null,"stop-color",A[1]),L.appendChild(F)}return this.defs.appendChild(L),`url(#${T})`;case"Mesh":return(0,t.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${v[0]}`)}}setDash(v,T){this.current.dashArray=v,this.current.dashPhase=T}constructPath(v,T){const k=this.current;let L=k.x,A=k.y,F=[],K=0;for(const Q of v)switch(Q|0){case t.OPS.rectangle:L=T[K++],A=T[K++];const Z=T[K++],B=T[K++],z=L+Z,b=A+B;F.push("M",M(L),M(A),"L",M(z),M(A),"L",M(z),M(b),"L",M(L),M(b),"Z");break;case t.OPS.moveTo:L=T[K++],A=T[K++],F.push("M",M(L),M(A));break;case t.OPS.lineTo:L=T[K++],A=T[K++],F.push("L",M(L),M(A));break;case t.OPS.curveTo:L=T[K+4],A=T[K+5],F.push("C",M(T[K]),M(T[K+1]),M(T[K+2]),M(T[K+3]),M(L),M(A)),K+=6;break;case t.OPS.curveTo2:F.push("C",M(L),M(A),M(T[K]),M(T[K+1]),M(T[K+2]),M(T[K+3])),L=T[K+2],A=T[K+3],K+=4;break;case t.OPS.curveTo3:L=T[K+2],A=T[K+3],F.push("C",M(T[K]),M(T[K+1]),M(L),M(A),M(L),M(A)),K+=4;break;case t.OPS.closePath:F.push("Z");break}F=F.join(" "),k.path&&v.length>0&&v[0]!==t.OPS.rectangle&&v[0]!==t.OPS.moveTo?F=k.path.getAttributeNS(null,"d")+F:(k.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(k.path)),k.path.setAttributeNS(null,"d",F),k.path.setAttributeNS(null,"fill","none"),k.element=k.path,k.setCurrentPoint(L,A)}endPath(){const v=this.current;if(v.path=null,!this.pendingClip)return;if(!v.element){this.pendingClip=null;return}const T=`clippath${C++}`,k=this.svgFactory.createElement("svg:clipPath");k.setAttributeNS(null,"id",T),k.setAttributeNS(null,"transform",R(this.transformMatrix));const L=v.element.cloneNode(!0);this.pendingClip==="evenodd"?L.setAttributeNS(null,"clip-rule","evenodd"):L.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,k.appendChild(L),this.defs.appendChild(k),v.activeClipUrl&&(v.clipGroup=null,this.extraStack.forEach(function(A){A.clipGroup=null}),k.setAttributeNS(null,"clip-path",v.activeClipUrl)),v.activeClipUrl=`url(#${T})`,this.tgrp=null}clip(v){this.pendingClip=v}closePath(){const v=this.current;if(v.path){const T=`${v.path.getAttributeNS(null,"d")}Z`;v.path.setAttributeNS(null,"d",T)}}setLeading(v){this.current.leading=-v}setTextRise(v){this.current.textRise=v}setTextRenderingMode(v){this.current.textRenderingMode=v}setHScale(v){this.current.textHScale=v/100}setRenderingIntent(v){}setFlatness(v){}setGState(v){for(const[T,k]of v)switch(T){case"LW":this.setLineWidth(k);break;case"LC":this.setLineCap(k);break;case"LJ":this.setLineJoin(k);break;case"ML":this.setMiterLimit(k);break;case"D":this.setDash(k[0],k[1]);break;case"RI":this.setRenderingIntent(k);break;case"FL":this.setFlatness(k);break;case"Font":this.setFont(k);break;case"CA":this.setStrokeAlpha(k);break;case"ca":this.setFillAlpha(k);break;default:(0,t.warn)(`Unimplemented graphic state operator ${T}`);break}}fill(){const v=this.current;v.element&&(v.element.setAttributeNS(null,"fill",v.fillColor),v.element.setAttributeNS(null,"fill-opacity",v.fillAlpha),this.endPath())}stroke(){const v=this.current;v.element&&(this._setStrokeAttributes(v.element),v.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(v,T=1){const k=this.current;let L=k.dashArray;T!==1&&L.length>0&&(L=L.map(function(A){return T*A})),v.setAttributeNS(null,"stroke",k.strokeColor),v.setAttributeNS(null,"stroke-opacity",k.strokeAlpha),v.setAttributeNS(null,"stroke-miterlimit",M(k.miterLimit)),v.setAttributeNS(null,"stroke-linecap",k.lineCap),v.setAttributeNS(null,"stroke-linejoin",k.lineJoin),v.setAttributeNS(null,"stroke-width",M(T*k.lineWidth)+"px"),v.setAttributeNS(null,"stroke-dasharray",L.map(M).join(" ")),v.setAttributeNS(null,"stroke-dashoffset",M(T*k.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const v=this.svgFactory.createElement("svg:rect");v.setAttributeNS(null,"x","0"),v.setAttributeNS(null,"y","0"),v.setAttributeNS(null,"width","1px"),v.setAttributeNS(null,"height","1px"),v.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(v)}paintImageXObject(v){const T=v.startsWith("g_")?this.commonObjs.get(v):this.objs.get(v);if(!T){(0,t.warn)(`Dependent image with object ID ${v} is not ready yet`);return}this.paintInlineImageXObject(T)}paintInlineImageXObject(v,T){const k=v.width,L=v.height,A=x(v,this.forceDataSchema,!!T),F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",M(k)),F.setAttributeNS(null,"height",M(L)),this.current.element=F,this.clip("nonzero");const K=this.svgFactory.createElement("svg:image");K.setAttributeNS(_,"xlink:href",A),K.setAttributeNS(null,"x","0"),K.setAttributeNS(null,"y",M(-L)),K.setAttributeNS(null,"width",M(k)+"px"),K.setAttributeNS(null,"height",M(L)+"px"),K.setAttributeNS(null,"transform",`scale(${M(1/k)} ${M(-1/L)})`),T?T.appendChild(K):this._ensureTransformGroup().appendChild(K)}paintImageMaskXObject(v){const T=this.current,k=v.width,L=v.height,A=T.fillColor;T.maskId=`mask${u++}`;const F=this.svgFactory.createElement("svg:mask");F.setAttributeNS(null,"id",T.maskId);const K=this.svgFactory.createElement("svg:rect");K.setAttributeNS(null,"x","0"),K.setAttributeNS(null,"y","0"),K.setAttributeNS(null,"width",M(k)),K.setAttributeNS(null,"height",M(L)),K.setAttributeNS(null,"fill",A),K.setAttributeNS(null,"mask",`url(#${T.maskId})`),this.defs.appendChild(F),this._ensureTransformGroup().appendChild(K),this.paintInlineImageXObject(v,F)}paintFormXObjectBegin(v,T){if(Array.isArray(v)&&v.length===6&&this.transform(v[0],v[1],v[2],v[3],v[4],v[5]),T){const k=T[2]-T[0],L=T[3]-T[1],A=this.svgFactory.createElement("svg:rect");A.setAttributeNS(null,"x",T[0]),A.setAttributeNS(null,"y",T[1]),A.setAttributeNS(null,"width",M(k)),A.setAttributeNS(null,"height",M(L)),this.current.element=A,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(v){const T=this.svgFactory.create(v.width,v.height),k=this.svgFactory.createElement("svg:defs");T.appendChild(k),this.defs=k;const L=this.svgFactory.createElement("svg:g");return L.setAttributeNS(null,"transform",R(v.transform)),T.appendChild(L),this.svg=L,T}_ensureClipGroup(){if(!this.current.clipGroup){const v=this.svgFactory.createElement("svg:g");v.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(v),this.current.clipGroup=v}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",R(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaLayer=void 0;class s{static setAttributes(c,a){for(const[n,o]of Object.entries(a))o!=null&&(n!=="style"?c.setAttribute(n,o):Object.assign(c.style,o))}static render(c){const a=c.xfa,n=document.createElement(a.name);a.attributes&&s.setAttributes(n,a.attributes);const o=[[a,-1,n]],l=c.div;l.appendChild(n);const r=c.viewport.transform.join(",");for(l.style.transform=`matrix(${r})`,l.setAttribute("class","xfaLayer xfaFont");o.length>0;){const[d,h,_]=o[o.length-1];if(h+1===d.children.length){o.pop();continue}const f=d.children[++o[o.length-1][1]];if(f===null)continue;const{name:g}=f;if(g==="#text"){_.appendChild(document.createTextNode(f.value));continue}const x=document.createElement(g);_.appendChild(x),f.attributes&&s.setAttributes(x,f.attributes),f.children&&f.children.length>0?o.push([f,-1,x]):f.value&&x.appendChild(document.createTextNode(f.value))}}static update(c){const a=`matrix(${c.viewport.transform.join(",")})`;c.div.style.transform=a,c.div.hidden=!1}}i.XfaLayer=s},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNodeStream=void 0;var t=s(2),c=s(24);const a=require("fs"),n=require("http"),o=require("https"),l=require("url"),r=/^file:\/\/\/[a-zA-Z]:\//;function d(R){const C=l.parse(R);return C.protocol==="file:"||C.host?C:/^[a-z]:[/\\]/i.test(R)?l.parse(`file:///${R}`):(C.host||(C.protocol="file:"),C)}class h{constructor(C){this.source=C,this.url=d(C.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&C.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var C;return((C=this._fullRequestReader)==null?void 0:C._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new S(this):new x(this),this._fullRequestReader}getRangeReader(C,u){if(u<=this._progressiveDataLength)return null;const m=this.isFsUrl?new M(this,C,u):new w(this,C,u);return this._rangeRequestReaders.push(m),m}cancelAllRequests(C){this._fullRequestReader&&this._fullRequestReader.cancel(C),this._rangeRequestReaders.slice(0).forEach(function(m){m.cancel(C)})}}i.PDFNodeStream=h;class _{constructor(C){this._url=C.url,this._done=!1,this._storedError=null,this.onProgress=null;const u=C.source;this._contentLength=u.length,this._loaded=0,this._filename=null,this._disableRange=u.disableRange||!1,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._readableStream=null,this._readCapability=(0,t.createPromiseCapability)(),this._headersCapability=(0,t.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const C=this._readableStream.read();return C===null?(this._readCapability=(0,t.createPromiseCapability)(),this.read()):(this._loaded+=C.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(C).buffer,done:!1})}cancel(C){if(!this._readableStream){this._error(C);return}this._readableStream.destroy(C)}_error(C){this._storedError=C,this._readCapability.resolve()}_setReadableStream(C){this._readableStream=C,C.on("readable",()=>{this._readCapability.resolve()}),C.on("end",()=>{C.destroy(),this._done=!0,this._readCapability.resolve()}),C.on("error",u=>{this._error(u)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new t.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class f{constructor(C){this._url=C.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,t.createPromiseCapability)();const u=C.source;this._isStreamingSupported=!u.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const C=this._readableStream.read();return C===null?(this._readCapability=(0,t.createPromiseCapability)(),this.read()):(this._loaded+=C.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(C).buffer,done:!1})}cancel(C){if(!this._readableStream){this._error(C);return}this._readableStream.destroy(C)}_error(C){this._storedError=C,this._readCapability.resolve()}_setReadableStream(C){this._readableStream=C,C.on("readable",()=>{this._readCapability.resolve()}),C.on("end",()=>{C.destroy(),this._done=!0,this._readCapability.resolve()}),C.on("error",u=>{this._error(u)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function g(R,C){return{protocol:R.protocol,auth:R.auth,host:R.hostname,port:R.port,path:R.path,method:"GET",headers:C}}class x extends _{constructor(C){super(C);const u=m=>{if(m.statusCode===404){const k=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=k,this._headersCapability.reject(k);return}this._headersCapability.resolve(),this._setReadableStream(m);const y=k=>this._readableStream.headers[k.toLowerCase()],{allowRangeRequests:v,suggestedLength:T}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:y,isHttp:C.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=v,this._contentLength=T||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(y)};this._request=null,this._url.protocol==="http:"?this._request=n.request(g(this._url,C.httpHeaders),u):this._request=o.request(g(this._url,C.httpHeaders),u),this._request.on("error",m=>{this._storedError=m,this._headersCapability.reject(m)}),this._request.end()}}class w extends f{constructor(C,u,m){super(C),this._httpHeaders={};for(const v in C.httpHeaders){const T=C.httpHeaders[v];typeof T>"u"||(this._httpHeaders[v]=T)}this._httpHeaders.Range=`bytes=${u}-${m-1}`;const y=v=>{if(v.statusCode===404){const T=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=T;return}this._setReadableStream(v)};this._request=null,this._url.protocol==="http:"?this._request=n.request(g(this._url,this._httpHeaders),y):this._request=o.request(g(this._url,this._httpHeaders),y),this._request.on("error",v=>{this._storedError=v}),this._request.end()}}class S extends _{constructor(C){super(C);let u=decodeURIComponent(this._url.path);r.test(this._url.href)&&(u=u.replace(/^\//,"")),a.lstat(u,(m,y)=>{if(m){m.code==="ENOENT"&&(m=new t.MissingPDFException(`Missing PDF "${u}".`)),this._storedError=m,this._headersCapability.reject(m);return}this._contentLength=y.size,this._setReadableStream(a.createReadStream(u)),this._headersCapability.resolve()})}}class M extends f{constructor(C,u,m){super(C);let y=decodeURIComponent(this._url.path);r.test(this._url.href)&&(y=y.replace(/^\//,"")),this._setReadableStream(a.createReadStream(y,{start:u,end:m-1}))}}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createResponseStatusError=l,i.extractFilenameFromHeader=o,i.validateRangeRequestCapabilities=n,i.validateResponseStatus=r;var t=s(2),c=s(25),a=s(1);function n({getResponseHeader:d,isHttp:h,rangeChunkSize:_,disableRange:f}){(0,t.assert)(_>0,"Range chunk size must be larger than zero");const g={allowRangeRequests:!1,suggestedLength:void 0},x=parseInt(d("Content-Length"),10);return!Number.isInteger(x)||(g.suggestedLength=x,x<=2*_)||f||!h||d("Accept-Ranges")!=="bytes"||(d("Content-Encoding")||"identity")!=="identity"||(g.allowRangeRequests=!0),g}function o(d){const h=d("Content-Disposition");if(h){let _=(0,c.getFilenameFromContentDispositionHeader)(h);if(_.includes("%"))try{_=decodeURIComponent(_)}catch{}if((0,a.isPdfFile)(_))return _}return null}function l(d,h){return d===404||d===0&&h.startsWith("file:")?new t.MissingPDFException('Missing PDF "'+h+'".'):new t.UnexpectedResponseException(`Unexpected server response (${d}) while retrieving PDF "${h}".`,d)}function r(d){return d===200||d===206}},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getFilenameFromContentDispositionHeader=s;function s(t){let c=!0,a=n("filename\\*","i").exec(t);if(a){a=a[1];let f=d(a);return f=unescape(f),f=h(f),f=_(f),l(f)}if(a=r(t),a){const f=_(a);return l(f)}if(a=n("filename","i").exec(t),a){a=a[1];let f=d(a);return f=_(f),l(f)}function n(f,g){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function o(f,g){if(f){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const x=new TextDecoder(f,{fatal:!0}),w=Array.from(g,function(S){return S.charCodeAt(0)&255});g=x.decode(new Uint8Array(w)),c=!1}catch{if(/^utf-?8$/i.test(f))try{g=decodeURIComponent(escape(g)),c=!1}catch{}}}return g}function l(f){return c&&/[\x80-\xff]/.test(f)&&(f=o("utf-8",f),c&&(f=o("iso-8859-1",f))),f}function r(f){const g=[];let x;const w=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(x=w.exec(f))!==null;){let[,M,R,C]=x;if(M=parseInt(M,10),M in g){if(M===0)break;continue}g[M]=[R,C]}const S=[];for(let M=0;M<g.length&&M in g;++M){let[R,C]=g[M];C=d(C),R&&(C=unescape(C),M===0&&(C=h(C))),S.push(C)}return S.join("")}function d(f){if(f.startsWith('"')){const g=f.slice(1).split('\\"');for(let x=0;x<g.length;++x){const w=g[x].indexOf('"');w!==-1&&(g[x]=g[x].slice(0,w),g.length=x+1),g[x]=g[x].replace(/\\(.)/g,"$1")}f=g.join('"')}return f}function h(f){const g=f.indexOf("'");if(g===-1)return f;const x=f.slice(0,g),S=f.slice(g+1).replace(/^[^']*'/,"");return o(x,S)}function _(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,x,w,S){if(w==="q"||w==="Q")return S=S.replace(/_/g," "),S=S.replace(/=([0-9a-fA-F]{2})/g,function(M,R){return String.fromCharCode(parseInt(R,16))}),o(x,S);try{S=atob(S)}catch{}return o(x,S)})}return""}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNetworkStream=void 0;var t=s(2),c=s(24);const a=200,n=206;function o(_){const f=_.response;return typeof f!="string"?f:(0,t.stringToBytes)(f).buffer}class l{constructor(f,g){this.url=f,g=g||{},this.isHttp=/^https?:/i.test(f),this.httpHeaders=this.isHttp&&g.httpHeaders||{},this.withCredentials=g.withCredentials||!1,this.getXhr=g.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(f,g,x){const w={begin:f,end:g};for(const S in x)w[S]=x[S];return this.request(w)}requestFull(f){return this.request(f)}request(f){const g=this.getXhr(),x=this.currXhrId++,w=this.pendingRequests[x]={xhr:g};g.open("GET",this.url),g.withCredentials=this.withCredentials;for(const S in this.httpHeaders){const M=this.httpHeaders[S];typeof M>"u"||g.setRequestHeader(S,M)}return this.isHttp&&"begin"in f&&"end"in f?(g.setRequestHeader("Range",`bytes=${f.begin}-${f.end-1}`),w.expectedStatus=n):w.expectedStatus=a,g.responseType="arraybuffer",f.onError&&(g.onerror=function(S){f.onError(g.status)}),g.onreadystatechange=this.onStateChange.bind(this,x),g.onprogress=this.onProgress.bind(this,x),w.onHeadersReceived=f.onHeadersReceived,w.onDone=f.onDone,w.onError=f.onError,w.onProgress=f.onProgress,g.send(null),x}onProgress(f,g){const x=this.pendingRequests[f];x&&x.onProgress&&x.onProgress(g)}onStateChange(f,g){const x=this.pendingRequests[f];if(!x)return;const w=x.xhr;if(w.readyState>=2&&x.onHeadersReceived&&(x.onHeadersReceived(),delete x.onHeadersReceived),w.readyState!==4||!(f in this.pendingRequests))return;if(delete this.pendingRequests[f],w.status===0&&this.isHttp){x.onError&&x.onError(w.status);return}const S=w.status||a;if(!(S===a&&x.expectedStatus===n)&&S!==x.expectedStatus){x.onError&&x.onError(w.status);return}const R=o(w);if(S===n){const C=w.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(C);x.onDone({begin:parseInt(u[1],10),chunk:R})}else R?x.onDone({begin:0,chunk:R}):x.onError&&x.onError(w.status)}getRequestXhr(f){return this.pendingRequests[f].xhr}isPendingRequest(f){return f in this.pendingRequests}abortRequest(f){const g=this.pendingRequests[f].xhr;delete this.pendingRequests[f],g.abort()}}class r{constructor(f){this._source=f,this._manager=new l(f.url,{httpHeaders:f.httpHeaders,withCredentials:f.withCredentials}),this._rangeChunkSize=f.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(f){const g=this._rangeRequestReaders.indexOf(f);g>=0&&this._rangeRequestReaders.splice(g,1)}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new d(this._manager,this._source),this._fullRequestReader}getRangeReader(f,g){const x=new h(this._manager,f,g);return x.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(x),x}cancelAllRequests(f){this._fullRequestReader&&this._fullRequestReader.cancel(f),this._rangeRequestReaders.slice(0).forEach(function(x){x.cancel(f)})}}i.PDFNetworkStream=r;class d{constructor(f,g){this._manager=f;const x={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._fullRequestId=f.requestFull(x),this._headersReceivedCapability=(0,t.createPromiseCapability)(),this._disableRange=g.disableRange||!1,this._contentLength=g.length,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const f=this._fullRequestId,g=this._manager.getRequestXhr(f),x=M=>g.getResponseHeader(M),{allowRangeRequests:w,suggestedLength:S}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});w&&(this._isRangeSupported=!0),this._contentLength=S||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(x),this._isRangeSupported&&this._manager.abortRequest(f),this._headersReceivedCapability.resolve()}_onDone(f){f&&(this._requests.length>0?this._requests.shift().resolve({value:f.chunk,done:!1}):this._cachedChunks.push(f.chunk)),this._done=!0,!(this._cachedChunks.length>0)&&(this._requests.forEach(function(g){g.resolve({value:void 0,done:!0})}),this._requests=[])}_onError(f){const g=this._url,x=(0,c.createResponseStatusError)(f,g);this._storedError=x,this._headersReceivedCapability.reject(x),this._requests.forEach(function(w){w.reject(x)}),this._requests=[],this._cachedChunks=[]}_onProgress(f){this.onProgress&&this.onProgress({loaded:f.loaded,total:f.lengthComputable?f.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=(0,t.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0,this._headersReceivedCapability.reject(f),this._requests.forEach(function(g){g.resolve({value:void 0,done:!0})}),this._requests=[],this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class h{constructor(f,g,x){this._manager=f;const w={onDone:this._onDone.bind(this),onProgress:this._onProgress.bind(this)};this._requestId=f.requestRange(g,x,w),this._requests=[],this._queuedChunk=null,this._done=!1,this.onProgress=null,this.onClosed=null}_close(){this.onClosed&&this.onClosed(this)}_onDone(f){const g=f.chunk;this._requests.length>0?this._requests.shift().resolve({value:g,done:!1}):this._queuedChunk=g,this._done=!0,this._requests.forEach(function(x){x.resolve({value:void 0,done:!0})}),this._requests=[],this._close()}_onProgress(f){!this.isStreamingSupported&&this.onProgress&&this.onProgress({loaded:f.loaded})}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk!==null){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const f=(0,t.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0,this._requests.forEach(function(g){g.resolve({value:void 0,done:!0})}),this._requests=[],this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFFetchStream=void 0;var t=s(2),c=s(24);function a(d,h,_){return{method:"GET",headers:d,signal:_==null?void 0:_.signal,mode:"cors",credentials:h?"include":"same-origin",redirect:"follow"}}function n(d){const h=new Headers;for(const _ in d){const f=d[_];typeof f>"u"||h.append(_,f)}return h}class o{constructor(h){this.source=h,this.isHttp=/^https?:/i.test(h.url),this.httpHeaders=this.isHttp&&h.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var h;return((h=this._fullRequestReader)==null?void 0:h._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new l(this),this._fullRequestReader}getRangeReader(h,_){if(_<=this._progressiveDataLength)return null;const f=new r(this,h,_);return this._rangeRequestReaders.push(f),f}cancelAllRequests(h){this._fullRequestReader&&this._fullRequestReader.cancel(h),this._rangeRequestReaders.slice(0).forEach(function(f){f.cancel(h)})}}i.PDFFetchStream=o;class l{constructor(h){this._stream=h,this._reader=null,this._loaded=0,this._filename=null;const _=h.source;this._withCredentials=_.withCredentials||!1,this._contentLength=_.length,this._headersCapability=(0,t.createPromiseCapability)(),this._disableRange=_.disableRange||!1,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),typeof AbortController<"u"&&(this._abortController=new AbortController),this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._headers=n(this._stream.httpHeaders);const f=_.url;fetch(f,a(this._headers,this._withCredentials,this._abortController)).then(g=>{if(!(0,c.validateResponseStatus)(g.status))throw(0,c.createResponseStatusError)(g.status,f);this._reader=g.body.getReader(),this._headersCapability.resolve();const x=M=>g.headers.get(M),{allowRangeRequests:w,suggestedLength:S}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=w,this._contentLength=S||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(x),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new t.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:h,done:_}=await this._reader.read();return _?{value:h,done:_}:(this._loaded+=h.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){this._reader&&this._reader.cancel(h),this._abortController&&this._abortController.abort()}}class r{constructor(h,_,f){this._stream=h,this._reader=null,this._loaded=0;const g=h.source;this._withCredentials=g.withCredentials||!1,this._readCapability=(0,t.createPromiseCapability)(),this._isStreamingSupported=!g.disableStream,typeof AbortController<"u"&&(this._abortController=new AbortController),this._headers=n(this._stream.httpHeaders),this._headers.append("Range",`bytes=${_}-${f-1}`);const x=g.url;fetch(x,a(this._headers,this._withCredentials,this._abortController)).then(w=>{if(!(0,c.validateResponseStatus)(w.status))throw(0,c.createResponseStatusError)(w.status,x);this._readCapability.resolve(),this._reader=w.body.getReader()}).catch(w=>{if((w==null?void 0:w.name)!=="AbortError")throw w}),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:h,done:_}=await this._reader.read();return _?{value:h,done:_}:(this._loaded+=h.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){this._reader&&this._reader.cancel(h),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var i=__webpack_module_cache__[e];if(i!==void 0)return i.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](s,s.exports,__w_pdfjs_require__),s.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"addLinkAttributes",{enumerable:!0,get:function(){return i.addLinkAttributes}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return i.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return i.getPdfFilenameFromUrl}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return i.isPdfFile}}),Object.defineProperty(e,"LinkTarget",{enumerable:!0,get:function(){return i.LinkTarget}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return i.loadScript}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return i.PDFDateString}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return i.RenderingCancelledException}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return s.build}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return s.getDocument}}),Object.defineProperty(e,"LoopbackPort",{enumerable:!0,get:function(){return s.LoopbackPort}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return s.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return s.PDFWorker}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return s.version}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(e,"createObjectURL",{enumerable:!0,get:function(){return t.createObjectURL}}),Object.defineProperty(e,"createPromiseCapability",{enumerable:!0,get:function(){return t.createPromiseCapability}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(e,"removeNullCharacters",{enumerable:!0,get:function(){return t.removeNullCharacters}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(e,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return t.UNSUPPORTED_FEATURES}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return c.AnnotationLayer}}),Object.defineProperty(e,"apiCompatibilityParams",{enumerable:!0,get:function(){return a.apiCompatibilityParams}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return n.GlobalWorkerOptions}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return o.renderTextLayer}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return l.SVGGraphics}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return r.XfaLayer}});var i=__w_pdfjs_require__(1),s=__w_pdfjs_require__(5),t=__w_pdfjs_require__(2),c=__w_pdfjs_require__(18),a=__w_pdfjs_require__(9),n=__w_pdfjs_require__(12),o=__w_pdfjs_require__(20),l=__w_pdfjs_require__(21),r=__w_pdfjs_require__(22);{const{isNodeJS:d}=__w_pdfjs_require__(4);if(d){const h=__w_pdfjs_require__(23).PDFNodeStream;(0,s.setPDFNetworkStreamFactory)(_=>new h(_))}else{const h=__w_pdfjs_require__(26).PDFNetworkStream;let _;(0,i.isFetchSupported)()&&(_=__w_pdfjs_require__(27).PDFFetchStream),(0,s.setPDFNetworkStreamFactory)(f=>_&&(0,i.isValidFetchUrl)(f.url)?new _(f):new h(f))}}})(),__webpack_exports__})()});/**
 * Modules in this bundle
 * @license
 *
 * anypalette:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Isaiah Odhner <isaiahodhner@gmail.com>
 *   homepage: https://1j01.github.io/anypalette.js/
 *   version: 0.6.0
 *
 * base64-js:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: T. Jameson Little <t.jameson.little@gmail.com>
 *   homepage: https://github.com/beatgammit/base64-js
 *   version: 1.5.1
 *
 * browser-resolve:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Roman Shtylman <shtylman@gmail.com>
 *   homepage: https://github.com/browserify/browser-resolve#readme
 *   version: 2.0.0
 *
 * buffer:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Feross Aboukhadijeh <feross@feross.org>
 *   contributors: Romain Beauxis <toots@rastageeks.org>, James Halliday <mail@substack.net>
 *   homepage: https://github.com/feross/buffer
 *   version: 5.2.1
 *
 * css.escape:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Mathias Bynens
 *   homepage: https://mths.be/cssescape
 *   version: 1.5.1
 *
 * events:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Irakli Gozalishvili <rfobic@gmail.com>
 *   homepage: https://github.com/Gozala/events#readme
 *   version: 3.2.0
 *
 * ieee754:
 *   license: BSD-3-Clause (http://opensource.org/licenses/BSD-3-Clause)
 *   author: Feross Aboukhadijeh <feross@feross.org>
 *   contributors: Romain Beauxis <toots@rastageeks.org>
 *   homepage: https://github.com/feross/ieee754#readme
 *   version: 1.2.1
 *
 * inherits:
 *   license: ISC (http://opensource.org/licenses/ISC)
 *   homepage: https://github.com/isaacs/inherits#readme
 *   version: 2.0.4
 *
 * jdataview:
 *   licenses: WTFPL (http://www.wtfpl.net/about/)
 *   author: Vjeux <vjeuxx@gmail.com>
 *   contributors: Vjeux <vjeuxx@gmail.com>, RReverser <me@rreverser.com>
 *   homepage: http://jDataView.github.io/
 *   version: 2.5.0
 *
 * process:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Roman Shtylman <shtylman@gmail.com>
 *   homepage: https://github.com/shtylman/node-process#readme
 *   version: 0.11.10
 *
 * readable-stream:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   homepage: https://github.com/nodejs/readable-stream#readme
 *   version: 3.6.0
 *
 * safe-buffer:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Feross Aboukhadijeh <feross@feross.org>
 *   homepage: https://github.com/feross/safe-buffer
 *   version: 5.1.2
 *
 * sax:
 *   license: ISC (http://opensource.org/licenses/ISC)
 *   author: Isaac Z. Schlueter <i@izs.me>
 *   homepage: https://github.com/isaacs/sax-js#readme
 *   version: 1.2.4
 *
 * stream-browserify:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: James Halliday <mail@substack.net>
 *   homepage: https://github.com/browserify/stream-browserify
 *   version: 3.0.0
 *
 * string_decoder:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   homepage: https://github.com/nodejs/string_decoder
 *   version: 1.1.1
 *
 * util-deprecate:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Nathan Rajlich <nathan@tootallnate.net>
 *   homepage: https://github.com/TooTallNate/util-deprecate
 *   version: 1.0.2
 *
 * xml-js:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Yousuf Almarzooqi <ysf953@gmail.com>
 *   homepage: https://github.com/nashwaan/xml-js#readme
 *   version: 1.6.11
 *
 * This header is generated by licensify (https://github.com/twada/licensify)
 */(function(e){if(typeof exports=="object"&&typeof module<"u")module.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var i;typeof window<"u"?i=window:typeof global<"u"?i=global:typeof self<"u"?i=self:i=this,i.AnyPalette=e()}})(function(){return function(){function e(i,s,t){function c(o,l){if(!s[o]){if(!i[o]){var r=typeof require=="function"&&require;if(!l&&r)return r(o,!0);if(a)return a(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var h=s[o]={exports:{}};i[o][0].call(h.exports,function(_){var f=i[o][1][_];return c(f||_)},h,h.exports,e,i,s,t)}return s[o].exports}for(var a=typeof require=="function"&&require,n=0;n<t.length;n++)c(t[n]);return c}return e}()({1:[function(e,i,s){s.byteLength=d,s.toByteArray=_,s.fromByteArray=x;for(var t=[],c=[],a=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=n.length;o<l;++o)t[o]=n[o],c[n.charCodeAt(o)]=o;c[45]=62,c[95]=63;function r(w){var S=w.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var M=w.indexOf("=");M===-1&&(M=S);var R=M===S?0:4-M%4;return[M,R]}function d(w){var S=r(w),M=S[0],R=S[1];return(M+R)*3/4-R}function h(w,S,M){return(S+M)*3/4-M}function _(w){var S,M=r(w),R=M[0],C=M[1],u=new a(h(w,R,C)),m=0,y=C>0?R-4:R,v;for(v=0;v<y;v+=4)S=c[w.charCodeAt(v)]<<18|c[w.charCodeAt(v+1)]<<12|c[w.charCodeAt(v+2)]<<6|c[w.charCodeAt(v+3)],u[m++]=S>>16&255,u[m++]=S>>8&255,u[m++]=S&255;return C===2&&(S=c[w.charCodeAt(v)]<<2|c[w.charCodeAt(v+1)]>>4,u[m++]=S&255),C===1&&(S=c[w.charCodeAt(v)]<<10|c[w.charCodeAt(v+1)]<<4|c[w.charCodeAt(v+2)]>>2,u[m++]=S>>8&255,u[m++]=S&255),u}function f(w){return t[w>>18&63]+t[w>>12&63]+t[w>>6&63]+t[w&63]}function g(w,S,M){for(var R,C=[],u=S;u<M;u+=3)R=(w[u]<<16&16711680)+(w[u+1]<<8&65280)+(w[u+2]&255),C.push(f(R));return C.join("")}function x(w){for(var S,M=w.length,R=M%3,C=[],u=16383,m=0,y=M-R;m<y;m+=u)C.push(g(w,m,m+u>y?y:m+u));return R===1?(S=w[M-1],C.push(t[S>>2]+t[S<<4&63]+"==")):R===2&&(S=(w[M-2]<<8)+w[M-1],C.push(t[S>>10]+t[S>>4&63]+t[S<<2&63]+"=")),C.join("")}},{}],2:[function(e,i,s){},{}],3:[function(e,i,s){(function(t){(function(){var c=e("base64-js"),a=e("ieee754");s.Buffer=r,s.SlowBuffer=R,s.INSPECT_MAX_BYTES=50;var n=2147483647;s.kMaxLength=n,r.TYPED_ARRAY_SUPPORT=o(),!r.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var H=new Uint8Array(1);return H.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},H.foo()===42}catch{return!1}}Object.defineProperty(r.prototype,"parent",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.buffer}}),Object.defineProperty(r.prototype,"offset",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.byteOffset}});function l(H){if(H>n)throw new RangeError('The value "'+H+'" is invalid for option "size"');var I=new Uint8Array(H);return I.__proto__=r.prototype,I}function r(H,I,O){if(typeof H=="number"){if(typeof I=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(H)}return d(H,I,O)}typeof Symbol<"u"&&Symbol.species!=null&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192;function d(H,I,O){if(typeof H=="string")return g(H,I);if(ArrayBuffer.isView(H))return x(H);if(H==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof H);if(ee(H,ArrayBuffer)||H&&ee(H.buffer,ArrayBuffer))return w(H,I,O);if(typeof H=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ae=H.valueOf&&H.valueOf();if(ae!=null&&ae!==H)return r.from(ae,I,O);var me=S(H);if(me)return me;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof H[Symbol.toPrimitive]=="function")return r.from(H[Symbol.toPrimitive]("string"),I,O);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof H)}r.from=function(H,I,O){return d(H,I,O)},r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array;function h(H){if(typeof H!="number")throw new TypeError('"size" argument must be of type number');if(H<0)throw new RangeError('The value "'+H+'" is invalid for option "size"')}function _(H,I,O){return h(H),H<=0?l(H):I!==void 0?typeof O=="string"?l(H).fill(I,O):l(H).fill(I):l(H)}r.alloc=function(H,I,O){return _(H,I,O)};function f(H){return h(H),l(H<0?0:M(H)|0)}r.allocUnsafe=function(H){return f(H)},r.allocUnsafeSlow=function(H){return f(H)};function g(H,I){if((typeof I!="string"||I==="")&&(I="utf8"),!r.isEncoding(I))throw new TypeError("Unknown encoding: "+I);var O=C(H,I)|0,ae=l(O),me=ae.write(H,I);return me!==O&&(ae=ae.slice(0,me)),ae}function x(H){for(var I=H.length<0?0:M(H.length)|0,O=l(I),ae=0;ae<I;ae+=1)O[ae]=H[ae]&255;return O}function w(H,I,O){if(I<0||H.byteLength<I)throw new RangeError('"offset" is outside of buffer bounds');if(H.byteLength<I+(O||0))throw new RangeError('"length" is outside of buffer bounds');var ae;return I===void 0&&O===void 0?ae=new Uint8Array(H):O===void 0?ae=new Uint8Array(H,I):ae=new Uint8Array(H,I,O),ae.__proto__=r.prototype,ae}function S(H){if(r.isBuffer(H)){var I=M(H.length)|0,O=l(I);return O.length===0||H.copy(O,0,0,I),O}if(H.length!==void 0)return typeof H.length!="number"||le(H.length)?l(0):x(H);if(H.type==="Buffer"&&Array.isArray(H.data))return x(H.data)}function M(H){if(H>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return H|0}function R(H){return+H!=H&&(H=0),r.alloc(+H)}r.isBuffer=function(I){return I!=null&&I._isBuffer===!0&&I!==r.prototype},r.compare=function(I,O){if(ee(I,Uint8Array)&&(I=r.from(I,I.offset,I.byteLength)),ee(O,Uint8Array)&&(O=r.from(O,O.offset,O.byteLength)),!r.isBuffer(I)||!r.isBuffer(O))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===O)return 0;for(var ae=I.length,me=O.length,Ae=0,Se=Math.min(ae,me);Ae<Se;++Ae)if(I[Ae]!==O[Ae]){ae=I[Ae],me=O[Ae];break}return ae<me?-1:me<ae?1:0},r.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(I,O){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(I.length===0)return r.alloc(0);var ae;if(O===void 0)for(O=0,ae=0;ae<I.length;++ae)O+=I[ae].length;var me=r.allocUnsafe(O),Ae=0;for(ae=0;ae<I.length;++ae){var Se=I[ae];if(ee(Se,Uint8Array)&&(Se=r.from(Se)),!r.isBuffer(Se))throw new TypeError('"list" argument must be an Array of Buffers');Se.copy(me,Ae),Ae+=Se.length}return me};function C(H,I){if(r.isBuffer(H))return H.length;if(ArrayBuffer.isView(H)||ee(H,ArrayBuffer))return H.byteLength;if(typeof H!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof H);var O=H.length,ae=arguments.length>2&&arguments[2]===!0;if(!ae&&O===0)return 0;for(var me=!1;;)switch(I){case"ascii":case"latin1":case"binary":return O;case"utf8":case"utf-8":return D(H).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O*2;case"hex":return O>>>1;case"base64":return oe(H).length;default:if(me)return ae?-1:D(H).length;I=(""+I).toLowerCase(),me=!0}}r.byteLength=C;function u(H,I,O){var ae=!1;if((I===void 0||I<0)&&(I=0),I>this.length||((O===void 0||O>this.length)&&(O=this.length),O<=0)||(O>>>=0,I>>>=0,O<=I))return"";for(H||(H="utf8");;)switch(H){case"hex":return U(this,I,O);case"utf8":case"utf-8":return Z(this,I,O);case"ascii":return b(this,I,O);case"latin1":case"binary":return N(this,I,O);case"base64":return Q(this,I,O);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,I,O);default:if(ae)throw new TypeError("Unknown encoding: "+H);H=(H+"").toLowerCase(),ae=!0}}r.prototype._isBuffer=!0;function m(H,I,O){var ae=H[I];H[I]=H[O],H[O]=ae}r.prototype.swap16=function(){var I=this.length;if(I%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var O=0;O<I;O+=2)m(this,O,O+1);return this},r.prototype.swap32=function(){var I=this.length;if(I%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var O=0;O<I;O+=4)m(this,O,O+3),m(this,O+1,O+2);return this},r.prototype.swap64=function(){var I=this.length;if(I%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var O=0;O<I;O+=8)m(this,O,O+7),m(this,O+1,O+6),m(this,O+2,O+5),m(this,O+3,O+4);return this},r.prototype.toString=function(){var I=this.length;return I===0?"":arguments.length===0?Z(this,0,I):u.apply(this,arguments)},r.prototype.toLocaleString=r.prototype.toString,r.prototype.equals=function(I){if(!r.isBuffer(I))throw new TypeError("Argument must be a Buffer");return this===I?!0:r.compare(this,I)===0},r.prototype.inspect=function(){var I="",O=s.INSPECT_MAX_BYTES;return I=this.toString("hex",0,O).replace(/(.{2})/g,"$1 ").trim(),this.length>O&&(I+=" ... "),"<Buffer "+I+">"},r.prototype.compare=function(I,O,ae,me,Ae){if(ee(I,Uint8Array)&&(I=r.from(I,I.offset,I.byteLength)),!r.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(O===void 0&&(O=0),ae===void 0&&(ae=I?I.length:0),me===void 0&&(me=0),Ae===void 0&&(Ae=this.length),O<0||ae>I.length||me<0||Ae>this.length)throw new RangeError("out of range index");if(me>=Ae&&O>=ae)return 0;if(me>=Ae)return-1;if(O>=ae)return 1;if(O>>>=0,ae>>>=0,me>>>=0,Ae>>>=0,this===I)return 0;for(var Se=Ae-me,Ge=ae-O,Xe=Math.min(Se,Ge),Ue=this.slice(me,Ae),Ze=I.slice(O,ae),He=0;He<Xe;++He)if(Ue[He]!==Ze[He]){Se=Ue[He],Ge=Ze[He];break}return Se<Ge?-1:Ge<Se?1:0};function y(H,I,O,ae,me){if(H.length===0)return-1;if(typeof O=="string"?(ae=O,O=0):O>2147483647?O=2147483647:O<-2147483648&&(O=-2147483648),O=+O,le(O)&&(O=me?0:H.length-1),O<0&&(O=H.length+O),O>=H.length){if(me)return-1;O=H.length-1}else if(O<0)if(me)O=0;else return-1;if(typeof I=="string"&&(I=r.from(I,ae)),r.isBuffer(I))return I.length===0?-1:v(H,I,O,ae,me);if(typeof I=="number")return I=I&255,typeof Uint8Array.prototype.indexOf=="function"?me?Uint8Array.prototype.indexOf.call(H,I,O):Uint8Array.prototype.lastIndexOf.call(H,I,O):v(H,[I],O,ae,me);throw new TypeError("val must be string, number or Buffer")}function v(H,I,O,ae,me){var Ae=1,Se=H.length,Ge=I.length;if(ae!==void 0&&(ae=String(ae).toLowerCase(),ae==="ucs2"||ae==="ucs-2"||ae==="utf16le"||ae==="utf-16le")){if(H.length<2||I.length<2)return-1;Ae=2,Se/=2,Ge/=2,O/=2}function Xe(nt,qe){return Ae===1?nt[qe]:nt.readUInt16BE(qe*Ae)}var Ue;if(me){var Ze=-1;for(Ue=O;Ue<Se;Ue++)if(Xe(H,Ue)===Xe(I,Ze===-1?0:Ue-Ze)){if(Ze===-1&&(Ze=Ue),Ue-Ze+1===Ge)return Ze*Ae}else Ze!==-1&&(Ue-=Ue-Ze),Ze=-1}else for(O+Ge>Se&&(O=Se-Ge),Ue=O;Ue>=0;Ue--){for(var He=!0,Je=0;Je<Ge;Je++)if(Xe(H,Ue+Je)!==Xe(I,Je)){He=!1;break}if(He)return Ue}return-1}r.prototype.includes=function(I,O,ae){return this.indexOf(I,O,ae)!==-1},r.prototype.indexOf=function(I,O,ae){return y(this,I,O,ae,!0)},r.prototype.lastIndexOf=function(I,O,ae){return y(this,I,O,ae,!1)};function T(H,I,O,ae){O=Number(O)||0;var me=H.length-O;ae?(ae=Number(ae),ae>me&&(ae=me)):ae=me;var Ae=I.length;ae>Ae/2&&(ae=Ae/2);for(var Se=0;Se<ae;++Se){var Ge=parseInt(I.substr(Se*2,2),16);if(le(Ge))return Se;H[O+Se]=Ge}return Se}function k(H,I,O,ae){return ve(D(I,H.length-O),H,O,ae)}function L(H,I,O,ae){return ve(te(I),H,O,ae)}function A(H,I,O,ae){return L(H,I,O,ae)}function F(H,I,O,ae){return ve(oe(I),H,O,ae)}function K(H,I,O,ae){return ve(re(I,H.length-O),H,O,ae)}r.prototype.write=function(I,O,ae,me){if(O===void 0)me="utf8",ae=this.length,O=0;else if(ae===void 0&&typeof O=="string")me=O,ae=this.length,O=0;else if(isFinite(O))O=O>>>0,isFinite(ae)?(ae=ae>>>0,me===void 0&&(me="utf8")):(me=ae,ae=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Ae=this.length-O;if((ae===void 0||ae>Ae)&&(ae=Ae),I.length>0&&(ae<0||O<0)||O>this.length)throw new RangeError("Attempt to write outside buffer bounds");me||(me="utf8");for(var Se=!1;;)switch(me){case"hex":return T(this,I,O,ae);case"utf8":case"utf-8":return k(this,I,O,ae);case"ascii":return L(this,I,O,ae);case"latin1":case"binary":return A(this,I,O,ae);case"base64":return F(this,I,O,ae);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,I,O,ae);default:if(Se)throw new TypeError("Unknown encoding: "+me);me=(""+me).toLowerCase(),Se=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Q(H,I,O){return I===0&&O===H.length?c.fromByteArray(H):c.fromByteArray(H.slice(I,O))}function Z(H,I,O){O=Math.min(H.length,O);for(var ae=[],me=I;me<O;){var Ae=H[me],Se=null,Ge=Ae>239?4:Ae>223?3:Ae>191?2:1;if(me+Ge<=O){var Xe,Ue,Ze,He;switch(Ge){case 1:Ae<128&&(Se=Ae);break;case 2:Xe=H[me+1],(Xe&192)===128&&(He=(Ae&31)<<6|Xe&63,He>127&&(Se=He));break;case 3:Xe=H[me+1],Ue=H[me+2],(Xe&192)===128&&(Ue&192)===128&&(He=(Ae&15)<<12|(Xe&63)<<6|Ue&63,He>2047&&(He<55296||He>57343)&&(Se=He));break;case 4:Xe=H[me+1],Ue=H[me+2],Ze=H[me+3],(Xe&192)===128&&(Ue&192)===128&&(Ze&192)===128&&(He=(Ae&15)<<18|(Xe&63)<<12|(Ue&63)<<6|Ze&63,He>65535&&He<1114112&&(Se=He))}}Se===null?(Se=65533,Ge=1):Se>65535&&(Se-=65536,ae.push(Se>>>10&1023|55296),Se=56320|Se&1023),ae.push(Se),me+=Ge}return z(ae)}var B=4096;function z(H){var I=H.length;if(I<=B)return String.fromCharCode.apply(String,H);for(var O="",ae=0;ae<I;)O+=String.fromCharCode.apply(String,H.slice(ae,ae+=B));return O}function b(H,I,O){var ae="";O=Math.min(H.length,O);for(var me=I;me<O;++me)ae+=String.fromCharCode(H[me]&127);return ae}function N(H,I,O){var ae="";O=Math.min(H.length,O);for(var me=I;me<O;++me)ae+=String.fromCharCode(H[me]);return ae}function U(H,I,O){var ae=H.length;(!I||I<0)&&(I=0),(!O||O<0||O>ae)&&(O=ae);for(var me="",Ae=I;Ae<O;++Ae)me+=X(H[Ae]);return me}function q(H,I,O){for(var ae=H.slice(I,O),me="",Ae=0;Ae<ae.length;Ae+=2)me+=String.fromCharCode(ae[Ae]+ae[Ae+1]*256);return me}r.prototype.slice=function(I,O){var ae=this.length;I=~~I,O=O===void 0?ae:~~O,I<0?(I+=ae,I<0&&(I=0)):I>ae&&(I=ae),O<0?(O+=ae,O<0&&(O=0)):O>ae&&(O=ae),O<I&&(O=I);var me=this.subarray(I,O);return me.__proto__=r.prototype,me};function j(H,I,O){if(H%1!==0||H<0)throw new RangeError("offset is not uint");if(H+I>O)throw new RangeError("Trying to access beyond buffer length")}r.prototype.readUIntLE=function(I,O,ae){I=I>>>0,O=O>>>0,ae||j(I,O,this.length);for(var me=this[I],Ae=1,Se=0;++Se<O&&(Ae*=256);)me+=this[I+Se]*Ae;return me},r.prototype.readUIntBE=function(I,O,ae){I=I>>>0,O=O>>>0,ae||j(I,O,this.length);for(var me=this[I+--O],Ae=1;O>0&&(Ae*=256);)me+=this[I+--O]*Ae;return me},r.prototype.readUInt8=function(I,O){return I=I>>>0,O||j(I,1,this.length),this[I]},r.prototype.readUInt16LE=function(I,O){return I=I>>>0,O||j(I,2,this.length),this[I]|this[I+1]<<8},r.prototype.readUInt16BE=function(I,O){return I=I>>>0,O||j(I,2,this.length),this[I]<<8|this[I+1]},r.prototype.readUInt32LE=function(I,O){return I=I>>>0,O||j(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+this[I+3]*16777216},r.prototype.readUInt32BE=function(I,O){return I=I>>>0,O||j(I,4,this.length),this[I]*16777216+(this[I+1]<<16|this[I+2]<<8|this[I+3])},r.prototype.readIntLE=function(I,O,ae){I=I>>>0,O=O>>>0,ae||j(I,O,this.length);for(var me=this[I],Ae=1,Se=0;++Se<O&&(Ae*=256);)me+=this[I+Se]*Ae;return Ae*=128,me>=Ae&&(me-=Math.pow(2,8*O)),me},r.prototype.readIntBE=function(I,O,ae){I=I>>>0,O=O>>>0,ae||j(I,O,this.length);for(var me=O,Ae=1,Se=this[I+--me];me>0&&(Ae*=256);)Se+=this[I+--me]*Ae;return Ae*=128,Se>=Ae&&(Se-=Math.pow(2,8*O)),Se},r.prototype.readInt8=function(I,O){return I=I>>>0,O||j(I,1,this.length),this[I]&128?(255-this[I]+1)*-1:this[I]},r.prototype.readInt16LE=function(I,O){I=I>>>0,O||j(I,2,this.length);var ae=this[I]|this[I+1]<<8;return ae&32768?ae|4294901760:ae},r.prototype.readInt16BE=function(I,O){I=I>>>0,O||j(I,2,this.length);var ae=this[I+1]|this[I]<<8;return ae&32768?ae|4294901760:ae},r.prototype.readInt32LE=function(I,O){return I=I>>>0,O||j(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},r.prototype.readInt32BE=function(I,O){return I=I>>>0,O||j(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},r.prototype.readFloatLE=function(I,O){return I=I>>>0,O||j(I,4,this.length),a.read(this,I,!0,23,4)},r.prototype.readFloatBE=function(I,O){return I=I>>>0,O||j(I,4,this.length),a.read(this,I,!1,23,4)},r.prototype.readDoubleLE=function(I,O){return I=I>>>0,O||j(I,8,this.length),a.read(this,I,!0,52,8)},r.prototype.readDoubleBE=function(I,O){return I=I>>>0,O||j(I,8,this.length),a.read(this,I,!1,52,8)};function Y(H,I,O,ae,me,Ae){if(!r.isBuffer(H))throw new TypeError('"buffer" argument must be a Buffer instance');if(I>me||I<Ae)throw new RangeError('"value" argument is out of bounds');if(O+ae>H.length)throw new RangeError("Index out of range")}r.prototype.writeUIntLE=function(I,O,ae,me){if(I=+I,O=O>>>0,ae=ae>>>0,!me){var Ae=Math.pow(2,8*ae)-1;Y(this,I,O,ae,Ae,0)}var Se=1,Ge=0;for(this[O]=I&255;++Ge<ae&&(Se*=256);)this[O+Ge]=I/Se&255;return O+ae},r.prototype.writeUIntBE=function(I,O,ae,me){if(I=+I,O=O>>>0,ae=ae>>>0,!me){var Ae=Math.pow(2,8*ae)-1;Y(this,I,O,ae,Ae,0)}var Se=ae-1,Ge=1;for(this[O+Se]=I&255;--Se>=0&&(Ge*=256);)this[O+Se]=I/Ge&255;return O+ae},r.prototype.writeUInt8=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,1,255,0),this[O]=I&255,O+1},r.prototype.writeUInt16LE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,2,65535,0),this[O]=I&255,this[O+1]=I>>>8,O+2},r.prototype.writeUInt16BE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,2,65535,0),this[O]=I>>>8,this[O+1]=I&255,O+2},r.prototype.writeUInt32LE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,4,4294967295,0),this[O+3]=I>>>24,this[O+2]=I>>>16,this[O+1]=I>>>8,this[O]=I&255,O+4},r.prototype.writeUInt32BE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,4,4294967295,0),this[O]=I>>>24,this[O+1]=I>>>16,this[O+2]=I>>>8,this[O+3]=I&255,O+4},r.prototype.writeIntLE=function(I,O,ae,me){if(I=+I,O=O>>>0,!me){var Ae=Math.pow(2,8*ae-1);Y(this,I,O,ae,Ae-1,-Ae)}var Se=0,Ge=1,Xe=0;for(this[O]=I&255;++Se<ae&&(Ge*=256);)I<0&&Xe===0&&this[O+Se-1]!==0&&(Xe=1),this[O+Se]=(I/Ge>>0)-Xe&255;return O+ae},r.prototype.writeIntBE=function(I,O,ae,me){if(I=+I,O=O>>>0,!me){var Ae=Math.pow(2,8*ae-1);Y(this,I,O,ae,Ae-1,-Ae)}var Se=ae-1,Ge=1,Xe=0;for(this[O+Se]=I&255;--Se>=0&&(Ge*=256);)I<0&&Xe===0&&this[O+Se+1]!==0&&(Xe=1),this[O+Se]=(I/Ge>>0)-Xe&255;return O+ae},r.prototype.writeInt8=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,1,127,-128),I<0&&(I=255+I+1),this[O]=I&255,O+1},r.prototype.writeInt16LE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,2,32767,-32768),this[O]=I&255,this[O+1]=I>>>8,O+2},r.prototype.writeInt16BE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,2,32767,-32768),this[O]=I>>>8,this[O+1]=I&255,O+2},r.prototype.writeInt32LE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,4,2147483647,-2147483648),this[O]=I&255,this[O+1]=I>>>8,this[O+2]=I>>>16,this[O+3]=I>>>24,O+4},r.prototype.writeInt32BE=function(I,O,ae){return I=+I,O=O>>>0,ae||Y(this,I,O,4,2147483647,-2147483648),I<0&&(I=4294967295+I+1),this[O]=I>>>24,this[O+1]=I>>>16,this[O+2]=I>>>8,this[O+3]=I&255,O+4};function J(H,I,O,ae,me,Ae){if(O+ae>H.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("Index out of range")}function se(H,I,O,ae,me){return I=+I,O=O>>>0,me||J(H,I,O,4),a.write(H,I,O,ae,23,4),O+4}r.prototype.writeFloatLE=function(I,O,ae){return se(this,I,O,!0,ae)},r.prototype.writeFloatBE=function(I,O,ae){return se(this,I,O,!1,ae)};function pe(H,I,O,ae,me){return I=+I,O=O>>>0,me||J(H,I,O,8),a.write(H,I,O,ae,52,8),O+8}r.prototype.writeDoubleLE=function(I,O,ae){return pe(this,I,O,!0,ae)},r.prototype.writeDoubleBE=function(I,O,ae){return pe(this,I,O,!1,ae)},r.prototype.copy=function(I,O,ae,me){if(!r.isBuffer(I))throw new TypeError("argument should be a Buffer");if(ae||(ae=0),!me&&me!==0&&(me=this.length),O>=I.length&&(O=I.length),O||(O=0),me>0&&me<ae&&(me=ae),me===ae||I.length===0||this.length===0)return 0;if(O<0)throw new RangeError("targetStart out of bounds");if(ae<0||ae>=this.length)throw new RangeError("Index out of range");if(me<0)throw new RangeError("sourceEnd out of bounds");me>this.length&&(me=this.length),I.length-O<me-ae&&(me=I.length-O+ae);var Ae=me-ae;if(this===I&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(O,ae,me);else if(this===I&&ae<O&&O<me)for(var Se=Ae-1;Se>=0;--Se)I[Se+O]=this[Se+ae];else Uint8Array.prototype.set.call(I,this.subarray(ae,me),O);return Ae},r.prototype.fill=function(I,O,ae,me){if(typeof I=="string"){if(typeof O=="string"?(me=O,O=0,ae=this.length):typeof ae=="string"&&(me=ae,ae=this.length),me!==void 0&&typeof me!="string")throw new TypeError("encoding must be a string");if(typeof me=="string"&&!r.isEncoding(me))throw new TypeError("Unknown encoding: "+me);if(I.length===1){var Ae=I.charCodeAt(0);(me==="utf8"&&Ae<128||me==="latin1")&&(I=Ae)}}else typeof I=="number"&&(I=I&255);if(O<0||this.length<O||this.length<ae)throw new RangeError("Out of range index");if(ae<=O)return this;O=O>>>0,ae=ae===void 0?this.length:ae>>>0,I||(I=0);var Se;if(typeof I=="number")for(Se=O;Se<ae;++Se)this[Se]=I;else{var Ge=r.isBuffer(I)?I:r.from(I,me),Xe=Ge.length;if(Xe===0)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(Se=0;Se<ae-O;++Se)this[Se+O]=Ge[Se%Xe]}return this};var _e=/[^+/0-9A-Za-z-_]/g;function Ee(H){if(H=H.split("=")[0],H=H.trim().replace(_e,""),H.length<2)return"";for(;H.length%4!==0;)H=H+"=";return H}function X(H){return H<16?"0"+H.toString(16):H.toString(16)}function D(H,I){I=I||1/0;for(var O,ae=H.length,me=null,Ae=[],Se=0;Se<ae;++Se){if(O=H.charCodeAt(Se),O>55295&&O<57344){if(!me){if(O>56319){(I-=3)>-1&&Ae.push(239,191,189);continue}else if(Se+1===ae){(I-=3)>-1&&Ae.push(239,191,189);continue}me=O;continue}if(O<56320){(I-=3)>-1&&Ae.push(239,191,189),me=O;continue}O=(me-55296<<10|O-56320)+65536}else me&&(I-=3)>-1&&Ae.push(239,191,189);if(me=null,O<128){if((I-=1)<0)break;Ae.push(O)}else if(O<2048){if((I-=2)<0)break;Ae.push(O>>6|192,O&63|128)}else if(O<65536){if((I-=3)<0)break;Ae.push(O>>12|224,O>>6&63|128,O&63|128)}else if(O<1114112){if((I-=4)<0)break;Ae.push(O>>18|240,O>>12&63|128,O>>6&63|128,O&63|128)}else throw new Error("Invalid code point")}return Ae}function te(H){for(var I=[],O=0;O<H.length;++O)I.push(H.charCodeAt(O)&255);return I}function re(H,I){for(var O,ae,me,Ae=[],Se=0;Se<H.length&&!((I-=2)<0);++Se)O=H.charCodeAt(Se),ae=O>>8,me=O%256,Ae.push(me),Ae.push(ae);return Ae}function oe(H){return c.toByteArray(Ee(H))}function ve(H,I,O,ae){for(var me=0;me<ae&&!(me+O>=I.length||me>=H.length);++me)I[me+O]=H[me];return me}function ee(H,I){return H instanceof I||H!=null&&H.constructor!=null&&H.constructor.name!=null&&H.constructor.name===I.name}function le(H){return H!==H}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:6}],4:[function(e,i,s){(function(t){(function(){(function(c,a){typeof s=="object"?i.exports=a(c):a(c)})(typeof t<"u"?t:this,function(c){if(c.CSS&&c.CSS.escape)return c.CSS.escape;var a=function(n){if(arguments.length==0)throw new TypeError("`CSS.escape` requires an argument.");for(var o=String(n),l=o.length,r=-1,d,h="",_=o.charCodeAt(0);++r<l;){if(d=o.charCodeAt(r),d==0){h+="�";continue}if(d>=1&&d<=31||d==127||r==0&&d>=48&&d<=57||r==1&&d>=48&&d<=57&&_==45){h+="\\"+d.toString(16)+" ";continue}if(r==0&&l==1&&d==45){h+="\\"+o.charAt(r);continue}if(d>=128||d==45||d==95||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122){h+=o.charAt(r);continue}h+="\\"+o.charAt(r)}return h};return c.CSS||(c.CSS={}),c.CSS.escape=a,a})}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],5:[function(e,i,s){var t=typeof Reflect=="object"?Reflect:null,c=t&&typeof t.apply=="function"?t.apply:function(m,y,v){return Function.prototype.apply.call(m,y,v)},a;t&&typeof t.ownKeys=="function"?a=t.ownKeys:Object.getOwnPropertySymbols?a=function(m){return Object.getOwnPropertyNames(m).concat(Object.getOwnPropertySymbols(m))}:a=function(m){return Object.getOwnPropertyNames(m)};function n(u){console&&console.warn&&console.warn(u)}var o=Number.isNaN||function(m){return m!==m};function l(){l.init.call(this)}i.exports=l,i.exports.once=C,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var r=10;function d(u){if(typeof u!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof u)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return r},set:function(u){if(typeof u!="number"||u<0||o(u))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+u+".");r=u}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(m){if(typeof m!="number"||m<0||o(m))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+m+".");return this._maxListeners=m,this};function h(u){return u._maxListeners===void 0?l.defaultMaxListeners:u._maxListeners}l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(m){for(var y=[],v=1;v<arguments.length;v++)y.push(arguments[v]);var T=m==="error",k=this._events;if(k!==void 0)T=T&&k.error===void 0;else if(!T)return!1;if(T){var L;if(y.length>0&&(L=y[0]),L instanceof Error)throw L;var A=new Error("Unhandled error."+(L?" ("+L.message+")":""));throw A.context=L,A}var F=k[m];if(F===void 0)return!1;if(typeof F=="function")c(F,this,y);else for(var K=F.length,Q=S(F,K),v=0;v<K;++v)c(Q[v],this,y);return!0};function _(u,m,y,v){var T,k,L;if(d(y),k=u._events,k===void 0?(k=u._events=Object.create(null),u._eventsCount=0):(k.newListener!==void 0&&(u.emit("newListener",m,y.listener?y.listener:y),k=u._events),L=k[m]),L===void 0)L=k[m]=y,++u._eventsCount;else if(typeof L=="function"?L=k[m]=v?[y,L]:[L,y]:v?L.unshift(y):L.push(y),T=h(u),T>0&&L.length>T&&!L.warned){L.warned=!0;var A=new Error("Possible EventEmitter memory leak detected. "+L.length+" "+String(m)+" listeners added. Use emitter.setMaxListeners() to increase limit");A.name="MaxListenersExceededWarning",A.emitter=u,A.type=m,A.count=L.length,n(A)}return u}l.prototype.addListener=function(m,y){return _(this,m,y,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(m,y){return _(this,m,y,!0)};function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(u,m,y){var v={fired:!1,wrapFn:void 0,target:u,type:m,listener:y},T=f.bind(v);return T.listener=y,v.wrapFn=T,T}l.prototype.once=function(m,y){return d(y),this.on(m,g(this,m,y)),this},l.prototype.prependOnceListener=function(m,y){return d(y),this.prependListener(m,g(this,m,y)),this},l.prototype.removeListener=function(m,y){var v,T,k,L,A;if(d(y),T=this._events,T===void 0)return this;if(v=T[m],v===void 0)return this;if(v===y||v.listener===y)--this._eventsCount===0?this._events=Object.create(null):(delete T[m],T.removeListener&&this.emit("removeListener",m,v.listener||y));else if(typeof v!="function"){for(k=-1,L=v.length-1;L>=0;L--)if(v[L]===y||v[L].listener===y){A=v[L].listener,k=L;break}if(k<0)return this;k===0?v.shift():M(v,k),v.length===1&&(T[m]=v[0]),T.removeListener!==void 0&&this.emit("removeListener",m,A||y)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(m){var y,v,T;if(v=this._events,v===void 0)return this;if(v.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):v[m]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete v[m]),this;if(arguments.length===0){var k=Object.keys(v),L;for(T=0;T<k.length;++T)L=k[T],L!=="removeListener"&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(y=v[m],typeof y=="function")this.removeListener(m,y);else if(y!==void 0)for(T=y.length-1;T>=0;T--)this.removeListener(m,y[T]);return this};function x(u,m,y){var v=u._events;if(v===void 0)return[];var T=v[m];return T===void 0?[]:typeof T=="function"?y?[T.listener||T]:[T]:y?R(T):S(T,T.length)}l.prototype.listeners=function(m){return x(this,m,!0)},l.prototype.rawListeners=function(m){return x(this,m,!1)},l.listenerCount=function(u,m){return typeof u.listenerCount=="function"?u.listenerCount(m):w.call(u,m)},l.prototype.listenerCount=w;function w(u){var m=this._events;if(m!==void 0){var y=m[u];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]};function S(u,m){for(var y=new Array(m),v=0;v<m;++v)y[v]=u[v];return y}function M(u,m){for(;m+1<u.length;m++)u[m]=u[m+1];u.pop()}function R(u){for(var m=new Array(u.length),y=0;y<m.length;++y)m[y]=u[y].listener||u[y];return m}function C(u,m){return new Promise(function(y,v){function T(){k!==void 0&&u.removeListener("error",k),y([].slice.call(arguments))}var k;m!=="error"&&(k=function(A){u.removeListener(m,T),v(A)},u.once("error",k)),u.once(m,T)})}},{}],6:[function(e,i,s){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */s.read=function(t,c,a,n,o){var l,r,d=o*8-n-1,h=(1<<d)-1,_=h>>1,f=-7,g=a?o-1:0,x=a?-1:1,w=t[c+g];for(g+=x,l=w&(1<<-f)-1,w>>=-f,f+=d;f>0;l=l*256+t[c+g],g+=x,f-=8);for(r=l&(1<<-f)-1,l>>=-f,f+=n;f>0;r=r*256+t[c+g],g+=x,f-=8);if(l===0)l=1-_;else{if(l===h)return r?NaN:(w?-1:1)*(1/0);r=r+Math.pow(2,n),l=l-_}return(w?-1:1)*r*Math.pow(2,l-n)},s.write=function(t,c,a,n,o,l){var r,d,h,_=l*8-o-1,f=(1<<_)-1,g=f>>1,x=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=n?0:l-1,S=n?1:-1,M=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(d=isNaN(c)?1:0,r=f):(r=Math.floor(Math.log(c)/Math.LN2),c*(h=Math.pow(2,-r))<1&&(r--,h*=2),r+g>=1?c+=x/h:c+=x*Math.pow(2,1-g),c*h>=2&&(r++,h/=2),r+g>=f?(d=0,r=f):r+g>=1?(d=(c*h-1)*Math.pow(2,o),r=r+g):(d=c*Math.pow(2,g-1)*Math.pow(2,o),r=0));o>=8;t[a+w]=d&255,w+=S,d/=256,o-=8);for(r=r<<o|d,_+=o;_>0;t[a+w]=r&255,w+=S,r/=256,_-=8);t[a+w-S]|=M*128}},{}],7:[function(e,i,s){(function(t){(function(){(function(c){var a=this;i.exports=c(a)})(function(c){function a(u,m){return typeof u!="object"||u===null?!1:u.constructor===m||Object.prototype.toString.call(u)==="[object "+m.name+"]"}function n(u,m){return!m&&a(u,Array)?u:Array.prototype.slice.call(u)}function o(u,m){return u!==void 0?u:m}function l(u,m,y,v){if(l.is(u)){var T=u.slice(m,m+y);return T._littleEndian=o(v,T._littleEndian),T}if(!l.is(this))return new l(u,m,y,v);if(this.buffer=u=l.wrapBuffer(u),this._isArrayBuffer=f.ArrayBuffer&&a(u,ArrayBuffer),this._isPixelData=!1,this._isDataView=f.DataView&&this._isArrayBuffer,this._isNodeBuffer=f.NodeBuffer&&a(u,t),!this._isNodeBuffer&&!this._isArrayBuffer&&!a(u,Array))throw new TypeError("jDataView buffer has an incompatible type");this._littleEndian=!!v;var k="byteLength"in u?u.byteLength:u.length;this.byteOffset=m=o(m,0),this.byteLength=y=o(y,k-m),this._offset=this._bitOffset=0,this._isDataView?this._view=new DataView(u,m,y):this._checkBounds(m,y,k),this._engineAction=this._isDataView?this._dataViewAction:this._isNodeBuffer?this._nodeBufferAction:this._isArrayBuffer?this._arrayBufferAction:this._arrayAction}function r(u){if(f.NodeBuffer)return new t(u,"binary");for(var m=f.ArrayBuffer?Uint8Array:Array,y=new m(u.length),v=0,T=u.length;T>v;v++)y[v]=255&u.charCodeAt(v);return y}function d(u){return u>=0&&31>u?1<<u:d[u]||(d[u]=Math.pow(2,u))}function h(u,m){this.lo=u,this.hi=m}function _(){h.apply(this,arguments)}var f={NodeBuffer:"Buffer"in window,DataView:"DataView"in window,ArrayBuffer:"ArrayBuffer"in window,PixelData:!1},g=window.TextEncoder,x=window.TextDecoder;f.NodeBuffer&&function(u){try{u.writeFloatLE(1/0,0)}catch{f.NodeBuffer=!1}}(new t(4));var w={Int8:1,Int16:2,Int32:4,Uint8:1,Uint16:2,Uint32:4,Float32:4,Float64:8};l.wrapBuffer=function(u){switch(typeof u){case"number":if(f.NodeBuffer)u=new t(u),u.fill(0);else if(f.ArrayBuffer)u=new Uint8Array(u).buffer;else{u=new Array(u);for(var m=0;m<u.length;m++)u[m]=0}return u;case"string":u=r(u);default:return"length"in u&&!(f.NodeBuffer&&a(u,t)||f.ArrayBuffer&&a(u,ArrayBuffer))&&(f.NodeBuffer?u=new t(u):f.ArrayBuffer?a(u,ArrayBuffer)||(u=new Uint8Array(u).buffer,a(u,ArrayBuffer)||(u=new Uint8Array(n(u,!0)).buffer)):u=n(u)),u}},l.is=function(u){return u&&u.jDataView},l.from=function(){return new l(arguments)},l.Uint64=h,h.prototype={valueOf:function(){return this.lo+d(32)*this.hi},toString:function(){return Number.prototype.toString.apply(this.valueOf(),arguments)}},h.fromNumber=function(u){var m=Math.floor(u/d(32)),y=u-m*d(32);return new h(y,m)},l.Int64=_,_.prototype="create"in Object?Object.create(h.prototype):new h,_.prototype.valueOf=function(){return this.hi<d(31)?h.prototype.valueOf.apply(this,arguments):-(d(32)-this.lo+d(32)*(d(32)-1-this.hi))},_.fromNumber=function(u){var m,y;if(u>=0){var v=h.fromNumber(u);m=v.lo,y=v.hi}else y=Math.floor(u/d(32)),m=u-y*d(32),y+=d(32);return new _(m,y)};var S=l.prototype={compatibility:f,jDataView:!0,_checkBounds:function(u,m,y){if(typeof u!="number")throw new TypeError("Offset is not a number.");if(typeof m!="number")throw new TypeError("Size is not a number.");if(0>m)throw new RangeError("Length is negative.");if(0>u||u+m>o(y,this.byteLength))throw new RangeError("Offsets are out of bounds.")},_action:function(u,m,y,v,T){return this._engineAction(u,m,o(y,this._offset),o(v,this._littleEndian),T)},_dataViewAction:function(u,m,y,v,T){return this._offset=y+w[u],m?this._view["get"+u](y,v):this._view["set"+u](y,T,v)},_arrayBufferAction:function(u,m,y,v,T){var k,L=w[u],A=c[u+"Array"];if(v=o(v,this._littleEndian),L===1||(this.byteOffset+y)%L===0&&v)return k=new A(this.buffer,this.byteOffset+y,1),this._offset=y+L,m?k[0]:k[0]=T;var F=new Uint8Array(m?this.getBytes(L,y,v,!0):L);return k=new A(F.buffer,0,1),m?k[0]:(k[0]=T,void this._setBytes(y,F,v))},_arrayAction:function(u,m,y,v,T){return m?this["_get"+u](y,v):this["_set"+u](y,T,v)},_getBytes:function(u,m,y){y=o(y,this._littleEndian),m=o(m,this._offset),u=o(u,this.byteLength-m),this._checkBounds(m,u),m+=this.byteOffset,this._offset=m-this.byteOffset+u;var v=this._isArrayBuffer?new Uint8Array(this.buffer,m,u):(this.buffer.slice||Array.prototype.slice).call(this.buffer,m,m+u);return y||1>=u?v:n(v).reverse()},getBytes:function(u,m,y,v){var T=this._getBytes(u,m,o(y,!0));return v?n(T):T},_setBytes:function(u,m,y){var v=m.length;if(v!==0){if(y=o(y,this._littleEndian),u=o(u,this._offset),this._checkBounds(u,v),!y&&v>1&&(m=n(m,!0).reverse()),u+=this.byteOffset,this._isArrayBuffer)new Uint8Array(this.buffer,u,v).set(m);else if(this._isNodeBuffer)new t(m).copy(this.buffer,u);else for(var T=0;v>T;T++)this.buffer[u+T]=m[T];this._offset=u-this.byteOffset+v}},setBytes:function(u,m,y){this._setBytes(u,m,o(y,!0))},getString:function(u,m,y){if(this._isNodeBuffer)return m=o(m,this._offset),u=o(u,this.byteLength-m),this._checkBounds(m,u),this._offset=m+u,this.buffer.toString(y||"binary",this.byteOffset+m,this.byteOffset+this._offset);var v=this._getBytes(u,m,!0);if(y=y==="utf8"?"utf-8":y||"binary",x&&y!=="binary")return new x(y).decode(this._isArrayBuffer?v:new Uint8Array(v));var T="";u=v.length;for(var k=0;u>k;k++)T+=String.fromCharCode(v[k]);return y==="utf-8"&&(T=decodeURIComponent(escape(T))),T},setString:function(u,m,y){if(this._isNodeBuffer)return u=o(u,this._offset),this._checkBounds(u,m.length),void(this._offset=u+this.buffer.write(m,this.byteOffset+u,y||"binary"));y=y==="utf8"?"utf-8":y||"binary";var v;g&&y!=="binary"?v=new g(y).encode(m):(y==="utf-8"&&(m=unescape(encodeURIComponent(m))),v=r(m)),this._setBytes(u,v,!0)},getChar:function(u){return this.getString(1,u)},setChar:function(u,m){this.setString(u,m)},tell:function(){return this._offset},seek:function(u){return this._checkBounds(u,0),this._offset=u},skip:function(u){return this.seek(this._offset+u)},slice:function(u,m,y){function v(T,k){return 0>T?T+k:T}return u=v(u,this.byteLength),m=v(o(m,this.byteLength),this.byteLength),y?new l(this.getBytes(m-u,u,!0,!0),void 0,void 0,this._littleEndian):new l(this.buffer,this.byteOffset+u,m-u,this._littleEndian)},alignBy:function(u){return this._bitOffset=0,o(u,1)!==1?this.skip(u-(this._offset%u||u)):this._offset},_getFloat64:function(u,m){var y=this._getBytes(8,u,m),v=1-2*(y[7]>>7),T=((y[7]<<1&255)<<3|y[6]>>4)-1023,k=(15&y[6])*d(48)+y[5]*d(40)+y[4]*d(32)+y[3]*d(24)+y[2]*d(16)+y[1]*d(8)+y[0];return T===1024?k!==0?NaN:1/0*v:T===-1023?v*k*d(-1074):v*(1+k*d(-52))*d(T)},_getFloat32:function(u,m){var y=this._getBytes(4,u,m),v=1-2*(y[3]>>7),T=(y[3]<<1&255|y[2]>>7)-127,k=(127&y[2])<<16|y[1]<<8|y[0];return T===128?k!==0?NaN:1/0*v:T===-127?v*k*d(-149):v*(1+k*d(-23))*d(T)},_get64:function(u,m,y){y=o(y,this._littleEndian),m=o(m,this._offset);for(var v=y?[0,4]:[4,0],T=0;2>T;T++)v[T]=this.getUint32(m+v[T],y);return this._offset=m+8,new u(v[0],v[1])},getInt64:function(u,m){return this._get64(_,u,m)},getUint64:function(u,m){return this._get64(h,u,m)},_getInt32:function(u,m){var y=this._getBytes(4,u,m);return y[3]<<24|y[2]<<16|y[1]<<8|y[0]},_getUint32:function(u,m){return this._getInt32(u,m)>>>0},_getInt16:function(u,m){return this._getUint16(u,m)<<16>>16},_getUint16:function(u,m){var y=this._getBytes(2,u,m);return y[1]<<8|y[0]},_getInt8:function(u){return this._getUint8(u)<<24>>24},_getUint8:function(u){return this._getBytes(1,u)[0]},_getBitRangeData:function(u,m){var y=(o(m,this._offset)<<3)+this._bitOffset,v=y+u,T=y>>>3,k=v+7>>>3,L=this._getBytes(k-T,T,!0),A=0;(this._bitOffset=7&v)&&(this._bitOffset-=8);for(var F=0,K=L.length;K>F;F++)A=A<<8|L[F];return{start:T,bytes:L,wideValue:A}},getSigned:function(u,m){var y=32-u;return this.getUnsigned(u,m)<<y>>y},getUnsigned:function(u,m){var y=this._getBitRangeData(u,m).wideValue>>>-this._bitOffset;return 32>u?y&~(-1<<u):y},_setBinaryFloat:function(u,m,y,v,T){var k,L,A=0>m?1:0,F=~(-1<<v-1),K=1-F;0>m&&(m=-m),m===0?(k=0,L=0):isNaN(m)?(k=2*F+1,L=1):m===1/0?(k=2*F+1,L=0):(k=Math.floor(Math.log(m)/Math.LN2),k>=K&&F>=k?(L=Math.floor((m*d(-k)-1)*d(y)),k+=F):(L=Math.floor(m/d(K-y)),k=0));for(var Q=[];y>=8;)Q.push(L%256),L=Math.floor(L/256),y-=8;for(k=k<<y|L,v+=y;v>=8;)Q.push(255&k),k>>>=8,v-=8;Q.push(A<<v|k),this._setBytes(u,Q,T)},_setFloat32:function(u,m,y){this._setBinaryFloat(u,m,23,8,y)},_setFloat64:function(u,m,y){this._setBinaryFloat(u,m,52,11,y)},_set64:function(u,m,y,v){typeof y!="object"&&(y=u.fromNumber(y)),v=o(v,this._littleEndian),m=o(m,this._offset);var T=v?{lo:0,hi:4}:{lo:4,hi:0};for(var k in T)this.setUint32(m+T[k],y[k],v);this._offset=m+8},setInt64:function(u,m,y){this._set64(_,u,m,y)},setUint64:function(u,m,y){this._set64(h,u,m,y)},_setUint32:function(u,m,y){this._setBytes(u,[255&m,m>>>8&255,m>>>16&255,m>>>24],y)},_setUint16:function(u,m,y){this._setBytes(u,[255&m,m>>>8&255],y)},_setUint8:function(u,m){this._setBytes(u,[255&m])},setUnsigned:function(u,m,y){var v=this._getBitRangeData(y,u),T=v.wideValue,k=v.bytes;T&=~(~(-1<<y)<<-this._bitOffset),T|=(32>y?m&~(-1<<y):m)<<-this._bitOffset;for(var L=k.length-1;L>=0;L--)k[L]=255&T,T>>>=8;this._setBytes(v.start,k,!0)}},M={Int8:"Int8",Int16:"Int16",Int32:"Int32",Uint8:"UInt8",Uint16:"UInt16",Uint32:"UInt32",Float32:"Float",Float64:"Double"};S._nodeBufferAction=function(u,m,y,v,T){this._offset=y+w[u];var k=M[u]+(u==="Int8"||u==="Uint8"?"":v?"LE":"BE");return y+=this.byteOffset,m?this.buffer["read"+k](y):this.buffer["write"+k](T,y)};for(var R in w)(function(u){S["get"+u]=function(m,y){return this._action(u,!0,m,y)},S["set"+u]=function(m,y,v){this._action(u,!1,m,v,y)}})(R);S._setInt32=S._setUint32,S._setInt16=S._setUint16,S._setInt8=S._setUint8,S.setSigned=S.setUnsigned;for(var C in S)C.slice(0,3)==="set"&&function(u){S["write"+u]=function(){Array.prototype.unshift.call(arguments,void 0),this["set"+u].apply(this,arguments)}}(C.slice(3));return l})}).call(this)}).call(this,e("buffer").Buffer)},{buffer:3}],8:[function(e,i,s){var t=i.exports={},c,a;function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?c=setTimeout:c=n}catch{c=n}try{typeof clearTimeout=="function"?a=clearTimeout:a=o}catch{a=o}})();function l(M){if(c===setTimeout)return setTimeout(M,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(M,0);try{return c(M,0)}catch{try{return c.call(null,M,0)}catch{return c.call(this,M,0)}}}function r(M){if(a===clearTimeout)return clearTimeout(M);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(M);try{return a(M)}catch{try{return a.call(null,M)}catch{return a.call(this,M)}}}var d=[],h=!1,_,f=-1;function g(){!h||!_||(h=!1,_.length?d=_.concat(d):f=-1,d.length&&x())}function x(){if(!h){var M=l(g);h=!0;for(var R=d.length;R;){for(_=d,d=[];++f<R;)_&&_[f].run();f=-1,R=d.length}_=null,h=!1,r(M)}}t.nextTick=function(M){var R=new Array(arguments.length-1);if(arguments.length>1)for(var C=1;C<arguments.length;C++)R[C-1]=arguments[C];d.push(new w(M,R)),d.length===1&&!h&&l(x)};function w(M,R){this.fun=M,this.array=R}w.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={};function S(){}t.on=S,t.addListener=S,t.once=S,t.off=S,t.removeListener=S,t.removeAllListeners=S,t.emit=S,t.prependListener=S,t.prependOnceListener=S,t.listeners=function(M){return[]},t.binding=function(M){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(M){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],9:[function(e,i,s){var t=e("buffer"),c=t.Buffer;function a(o,l){for(var r in o)l[r]=o[r]}c.from&&c.alloc&&c.allocUnsafe&&c.allocUnsafeSlow?i.exports=t:(a(t,s),s.Buffer=n);function n(o,l,r){return c(o,l,r)}a(c,n),n.from=function(o,l,r){if(typeof o=="number")throw new TypeError("Argument must not be a number");return c(o,l,r)},n.alloc=function(o,l,r){if(typeof o!="number")throw new TypeError("Argument must be a number");var d=c(o);return l!==void 0?typeof r=="string"?d.fill(l,r):d.fill(l):d.fill(0),d},n.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return c(o)},n.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(o)}},{buffer:3}],10:[function(e,i,s){(function(t){(function(){(function(c){c.parser=function(X,D){return new n(X,D)},c.SAXParser=n,c.SAXStream=f,c.createStream=_,c.MAX_BUFFER_LENGTH=64*1024;var a=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];c.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(X,D){if(!(this instanceof n))return new n(X,D);var te=this;l(te),te.q=te.c="",te.bufferCheckPosition=c.MAX_BUFFER_LENGTH,te.opt=D||{},te.opt.lowercase=te.opt.lowercase||te.opt.lowercasetags,te.looseCase=te.opt.lowercase?"toLowerCase":"toUpperCase",te.tags=[],te.closed=te.closedRoot=te.sawRoot=!1,te.tag=te.error=null,te.strict=!!X,te.noscript=!!(X||te.opt.noscript),te.state=A.BEGIN,te.strictEntities=te.opt.strictEntities,te.ENTITIES=te.strictEntities?Object.create(c.XML_ENTITIES):Object.create(c.ENTITIES),te.attribList=[],te.opt.xmlns&&(te.ns=Object.create(M)),te.trackPosition=te.opt.position!==!1,te.trackPosition&&(te.position=te.line=te.column=0),K(te,"onready")}Object.create||(Object.create=function(X){function D(){}D.prototype=X;var te=new D;return te}),Object.keys||(Object.keys=function(X){var D=[];for(var te in X)X.hasOwnProperty(te)&&D.push(te);return D});function o(X){for(var D=Math.max(c.MAX_BUFFER_LENGTH,10),te=0,re=0,oe=a.length;re<oe;re++){var ve=X[a[re]].length;if(ve>D)switch(a[re]){case"textNode":Z(X);break;case"cdata":Q(X,"oncdata",X.cdata),X.cdata="";break;case"script":Q(X,"onscript",X.script),X.script="";break;default:z(X,"Max buffer length exceeded: "+a[re])}te=Math.max(te,ve)}var ee=c.MAX_BUFFER_LENGTH-te;X.bufferCheckPosition=ee+X.position}function l(X){for(var D=0,te=a.length;D<te;D++)X[a[D]]=""}function r(X){Z(X),X.cdata!==""&&(Q(X,"oncdata",X.cdata),X.cdata=""),X.script!==""&&(Q(X,"onscript",X.script),X.script="")}n.prototype={end:function(){b(this)},write:Ee,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){r(this)}};var d;try{d=e("stream").Stream}catch{d=function(){}}var h=c.EVENTS.filter(function(X){return X!=="error"&&X!=="end"});function _(X,D){return new f(X,D)}function f(X,D){if(!(this instanceof f))return new f(X,D);d.apply(this),this._parser=new n(X,D),this.writable=!0,this.readable=!0;var te=this;this._parser.onend=function(){te.emit("end")},this._parser.onerror=function(re){te.emit("error",re),te._parser.error=null},this._decoder=null,h.forEach(function(re){Object.defineProperty(te,"on"+re,{get:function(){return te._parser["on"+re]},set:function(oe){if(!oe)return te.removeAllListeners(re),te._parser["on"+re]=oe,oe;te.on(re,oe)},enumerable:!0,configurable:!1})})}f.prototype=Object.create(d.prototype,{constructor:{value:f}}),f.prototype.write=function(X){if(typeof t=="function"&&typeof t.isBuffer=="function"&&t.isBuffer(X)){if(!this._decoder){var D=e("string_decoder").StringDecoder;this._decoder=new D("utf8")}X=this._decoder.write(X)}return this._parser.write(X.toString()),this.emit("data",X),!0},f.prototype.end=function(X){return X&&X.length&&this.write(X),this._parser.end(),!0},f.prototype.on=function(X,D){var te=this;return!te._parser["on"+X]&&h.indexOf(X)!==-1&&(te._parser["on"+X]=function(){var re=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);re.splice(0,0,X),te.emit.apply(te,re)}),d.prototype.on.call(te,X,D)};var g="[CDATA[",x="DOCTYPE",w="http://www.w3.org/XML/1998/namespace",S="http://www.w3.org/2000/xmlns/",M={xml:w,xmlns:S},R=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,C=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,u=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function y(X){return X===" "||X===`
`||X==="\r"||X==="	"}function v(X){return X==='"'||X==="'"}function T(X){return X===">"||y(X)}function k(X,D){return X.test(D)}function L(X,D){return!k(X,D)}var A=0;c.STATE={BEGIN:A++,BEGIN_WHITESPACE:A++,TEXT:A++,TEXT_ENTITY:A++,OPEN_WAKA:A++,SGML_DECL:A++,SGML_DECL_QUOTED:A++,DOCTYPE:A++,DOCTYPE_QUOTED:A++,DOCTYPE_DTD:A++,DOCTYPE_DTD_QUOTED:A++,COMMENT_STARTING:A++,COMMENT:A++,COMMENT_ENDING:A++,COMMENT_ENDED:A++,CDATA:A++,CDATA_ENDING:A++,CDATA_ENDING_2:A++,PROC_INST:A++,PROC_INST_BODY:A++,PROC_INST_ENDING:A++,OPEN_TAG:A++,OPEN_TAG_SLASH:A++,ATTRIB:A++,ATTRIB_NAME:A++,ATTRIB_NAME_SAW_WHITE:A++,ATTRIB_VALUE:A++,ATTRIB_VALUE_QUOTED:A++,ATTRIB_VALUE_CLOSED:A++,ATTRIB_VALUE_UNQUOTED:A++,ATTRIB_VALUE_ENTITY_Q:A++,ATTRIB_VALUE_ENTITY_U:A++,CLOSE_TAG:A++,CLOSE_TAG_SAW_WHITE:A++,SCRIPT:A++,SCRIPT_ENDING:A++},c.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},c.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(c.ENTITIES).forEach(function(X){var D=c.ENTITIES[X],te=typeof D=="number"?String.fromCharCode(D):D;c.ENTITIES[X]=te});for(var F in c.STATE)c.STATE[c.STATE[F]]=F;A=c.STATE;function K(X,D,te){X[D]&&X[D](te)}function Q(X,D,te){X.textNode&&Z(X),K(X,D,te)}function Z(X){X.textNode=B(X.opt,X.textNode),X.textNode&&K(X,"ontext",X.textNode),X.textNode=""}function B(X,D){return X.trim&&(D=D.trim()),X.normalize&&(D=D.replace(/\s+/g," ")),D}function z(X,D){return Z(X),X.trackPosition&&(D+=`
Line: `+X.line+`
Column: `+X.column+`
Char: `+X.c),D=new Error(D),X.error=D,K(X,"onerror",D),X}function b(X){return X.sawRoot&&!X.closedRoot&&N(X,"Unclosed root tag"),X.state!==A.BEGIN&&X.state!==A.BEGIN_WHITESPACE&&X.state!==A.TEXT&&z(X,"Unexpected end"),Z(X),X.c="",X.closed=!0,K(X,"onend"),n.call(X,X.strict,X.opt),X}function N(X,D){if(typeof X!="object"||!(X instanceof n))throw new Error("bad call to strictFail");X.strict&&z(X,D)}function U(X){X.strict||(X.tagName=X.tagName[X.looseCase]());var D=X.tags[X.tags.length-1]||X,te=X.tag={name:X.tagName,attributes:{}};X.opt.xmlns&&(te.ns=D.ns),X.attribList.length=0,Q(X,"onopentagstart",te)}function q(X,D){var te=X.indexOf(":"),re=te<0?["",X]:X.split(":"),oe=re[0],ve=re[1];return D&&X==="xmlns"&&(oe="xmlns",ve=""),{prefix:oe,local:ve}}function j(X){if(X.strict||(X.attribName=X.attribName[X.looseCase]()),X.attribList.indexOf(X.attribName)!==-1||X.tag.attributes.hasOwnProperty(X.attribName)){X.attribName=X.attribValue="";return}if(X.opt.xmlns){var D=q(X.attribName,!0),te=D.prefix,re=D.local;if(te==="xmlns")if(re==="xml"&&X.attribValue!==w)N(X,"xml: prefix must be bound to "+w+`
Actual: `+X.attribValue);else if(re==="xmlns"&&X.attribValue!==S)N(X,"xmlns: prefix must be bound to "+S+`
Actual: `+X.attribValue);else{var oe=X.tag,ve=X.tags[X.tags.length-1]||X;oe.ns===ve.ns&&(oe.ns=Object.create(ve.ns)),oe.ns[re]=X.attribValue}X.attribList.push([X.attribName,X.attribValue])}else X.tag.attributes[X.attribName]=X.attribValue,Q(X,"onattribute",{name:X.attribName,value:X.attribValue});X.attribName=X.attribValue=""}function Y(X,D){if(X.opt.xmlns){var te=X.tag,re=q(X.tagName);te.prefix=re.prefix,te.local=re.local,te.uri=te.ns[re.prefix]||"",te.prefix&&!te.uri&&(N(X,"Unbound namespace prefix: "+JSON.stringify(X.tagName)),te.uri=re.prefix);var oe=X.tags[X.tags.length-1]||X;te.ns&&oe.ns!==te.ns&&Object.keys(te.ns).forEach(function(Ge){Q(X,"onopennamespace",{prefix:Ge,uri:te.ns[Ge]})});for(var ve=0,ee=X.attribList.length;ve<ee;ve++){var le=X.attribList[ve],H=le[0],I=le[1],O=q(H,!0),ae=O.prefix,me=O.local,Ae=ae===""?"":te.ns[ae]||"",Se={name:H,value:I,prefix:ae,local:me,uri:Ae};ae&&ae!=="xmlns"&&!Ae&&(N(X,"Unbound namespace prefix: "+JSON.stringify(ae)),Se.uri=ae),X.tag.attributes[H]=Se,Q(X,"onattribute",Se)}X.attribList.length=0}X.tag.isSelfClosing=!!D,X.sawRoot=!0,X.tags.push(X.tag),Q(X,"onopentag",X.tag),D||(!X.noscript&&X.tagName.toLowerCase()==="script"?X.state=A.SCRIPT:X.state=A.TEXT,X.tag=null,X.tagName=""),X.attribName=X.attribValue="",X.attribList.length=0}function J(X){if(!X.tagName){N(X,"Weird empty close tag."),X.textNode+="</>",X.state=A.TEXT;return}if(X.script){if(X.tagName!=="script"){X.script+="</"+X.tagName+">",X.tagName="",X.state=A.SCRIPT;return}Q(X,"onscript",X.script),X.script=""}var D=X.tags.length,te=X.tagName;X.strict||(te=te[X.looseCase]());for(var re=te;D--;){var oe=X.tags[D];if(oe.name!==re)N(X,"Unexpected close tag");else break}if(D<0){N(X,"Unmatched closing tag: "+X.tagName),X.textNode+="</"+X.tagName+">",X.state=A.TEXT;return}X.tagName=te;for(var ve=X.tags.length;ve-- >D;){var ee=X.tag=X.tags.pop();X.tagName=X.tag.name,Q(X,"onclosetag",X.tagName);var le={};for(var H in ee.ns)le[H]=ee.ns[H];var I=X.tags[X.tags.length-1]||X;X.opt.xmlns&&ee.ns!==I.ns&&Object.keys(ee.ns).forEach(function(O){var ae=ee.ns[O];Q(X,"onclosenamespace",{prefix:O,uri:ae})})}D===0&&(X.closedRoot=!0),X.tagName=X.attribValue=X.attribName="",X.attribList.length=0,X.state=A.TEXT}function se(X){var D=X.entity,te=D.toLowerCase(),re,oe="";return X.ENTITIES[D]?X.ENTITIES[D]:X.ENTITIES[te]?X.ENTITIES[te]:(D=te,D.charAt(0)==="#"&&(D.charAt(1)==="x"?(D=D.slice(2),re=parseInt(D,16),oe=re.toString(16)):(D=D.slice(1),re=parseInt(D,10),oe=re.toString(10))),D=D.replace(/^0+/,""),isNaN(re)||oe.toLowerCase()!==D?(N(X,"Invalid character entity"),"&"+X.entity+";"):String.fromCodePoint(re))}function pe(X,D){D==="<"?(X.state=A.OPEN_WAKA,X.startTagPosition=X.position):y(D)||(N(X,"Non-whitespace before first tag."),X.textNode=D,X.state=A.TEXT)}function _e(X,D){var te="";return D<X.length&&(te=X.charAt(D)),te}function Ee(X){var D=this;if(this.error)throw this.error;if(D.closed)return z(D,"Cannot write after close. Assign an onready handler.");if(X===null)return b(D);typeof X=="object"&&(X=X.toString());for(var te=0,re="";re=_e(X,te++),D.c=re,!!re;)switch(D.trackPosition&&(D.position++,re===`
`?(D.line++,D.column=0):D.column++),D.state){case A.BEGIN:if(D.state=A.BEGIN_WHITESPACE,re==="\uFEFF")continue;pe(D,re);continue;case A.BEGIN_WHITESPACE:pe(D,re);continue;case A.TEXT:if(D.sawRoot&&!D.closedRoot){for(var oe=te-1;re&&re!=="<"&&re!=="&";)re=_e(X,te++),re&&D.trackPosition&&(D.position++,re===`
`?(D.line++,D.column=0):D.column++);D.textNode+=X.substring(oe,te-1)}re==="<"&&!(D.sawRoot&&D.closedRoot&&!D.strict)?(D.state=A.OPEN_WAKA,D.startTagPosition=D.position):(!y(re)&&(!D.sawRoot||D.closedRoot)&&N(D,"Text data outside of root node."),re==="&"?D.state=A.TEXT_ENTITY:D.textNode+=re);continue;case A.SCRIPT:re==="<"?D.state=A.SCRIPT_ENDING:D.script+=re;continue;case A.SCRIPT_ENDING:re==="/"?D.state=A.CLOSE_TAG:(D.script+="<"+re,D.state=A.SCRIPT);continue;case A.OPEN_WAKA:if(re==="!")D.state=A.SGML_DECL,D.sgmlDecl="";else if(!y(re))if(k(R,re))D.state=A.OPEN_TAG,D.tagName=re;else if(re==="/")D.state=A.CLOSE_TAG,D.tagName="";else if(re==="?")D.state=A.PROC_INST,D.procInstName=D.procInstBody="";else{if(N(D,"Unencoded <"),D.startTagPosition+1<D.position){var ve=D.position-D.startTagPosition;re=new Array(ve).join(" ")+re}D.textNode+="<"+re,D.state=A.TEXT}continue;case A.SGML_DECL:(D.sgmlDecl+re).toUpperCase()===g?(Q(D,"onopencdata"),D.state=A.CDATA,D.sgmlDecl="",D.cdata=""):D.sgmlDecl+re==="--"?(D.state=A.COMMENT,D.comment="",D.sgmlDecl=""):(D.sgmlDecl+re).toUpperCase()===x?(D.state=A.DOCTYPE,(D.doctype||D.sawRoot)&&N(D,"Inappropriately located doctype declaration"),D.doctype="",D.sgmlDecl=""):re===">"?(Q(D,"onsgmldeclaration",D.sgmlDecl),D.sgmlDecl="",D.state=A.TEXT):(v(re)&&(D.state=A.SGML_DECL_QUOTED),D.sgmlDecl+=re);continue;case A.SGML_DECL_QUOTED:re===D.q&&(D.state=A.SGML_DECL,D.q=""),D.sgmlDecl+=re;continue;case A.DOCTYPE:re===">"?(D.state=A.TEXT,Q(D,"ondoctype",D.doctype),D.doctype=!0):(D.doctype+=re,re==="["?D.state=A.DOCTYPE_DTD:v(re)&&(D.state=A.DOCTYPE_QUOTED,D.q=re));continue;case A.DOCTYPE_QUOTED:D.doctype+=re,re===D.q&&(D.q="",D.state=A.DOCTYPE);continue;case A.DOCTYPE_DTD:D.doctype+=re,re==="]"?D.state=A.DOCTYPE:v(re)&&(D.state=A.DOCTYPE_DTD_QUOTED,D.q=re);continue;case A.DOCTYPE_DTD_QUOTED:D.doctype+=re,re===D.q&&(D.state=A.DOCTYPE_DTD,D.q="");continue;case A.COMMENT:re==="-"?D.state=A.COMMENT_ENDING:D.comment+=re;continue;case A.COMMENT_ENDING:re==="-"?(D.state=A.COMMENT_ENDED,D.comment=B(D.opt,D.comment),D.comment&&Q(D,"oncomment",D.comment),D.comment=""):(D.comment+="-"+re,D.state=A.COMMENT);continue;case A.COMMENT_ENDED:re!==">"?(N(D,"Malformed comment"),D.comment+="--"+re,D.state=A.COMMENT):D.state=A.TEXT;continue;case A.CDATA:re==="]"?D.state=A.CDATA_ENDING:D.cdata+=re;continue;case A.CDATA_ENDING:re==="]"?D.state=A.CDATA_ENDING_2:(D.cdata+="]"+re,D.state=A.CDATA);continue;case A.CDATA_ENDING_2:re===">"?(D.cdata&&Q(D,"oncdata",D.cdata),Q(D,"onclosecdata"),D.cdata="",D.state=A.TEXT):re==="]"?D.cdata+="]":(D.cdata+="]]"+re,D.state=A.CDATA);continue;case A.PROC_INST:re==="?"?D.state=A.PROC_INST_ENDING:y(re)?D.state=A.PROC_INST_BODY:D.procInstName+=re;continue;case A.PROC_INST_BODY:if(!D.procInstBody&&y(re))continue;re==="?"?D.state=A.PROC_INST_ENDING:D.procInstBody+=re;continue;case A.PROC_INST_ENDING:re===">"?(Q(D,"onprocessinginstruction",{name:D.procInstName,body:D.procInstBody}),D.procInstName=D.procInstBody="",D.state=A.TEXT):(D.procInstBody+="?"+re,D.state=A.PROC_INST_BODY);continue;case A.OPEN_TAG:k(C,re)?D.tagName+=re:(U(D),re===">"?Y(D):re==="/"?D.state=A.OPEN_TAG_SLASH:(y(re)||N(D,"Invalid character in tag name"),D.state=A.ATTRIB));continue;case A.OPEN_TAG_SLASH:re===">"?(Y(D,!0),J(D)):(N(D,"Forward-slash in opening tag not followed by >"),D.state=A.ATTRIB);continue;case A.ATTRIB:if(y(re))continue;re===">"?Y(D):re==="/"?D.state=A.OPEN_TAG_SLASH:k(R,re)?(D.attribName=re,D.attribValue="",D.state=A.ATTRIB_NAME):N(D,"Invalid attribute name");continue;case A.ATTRIB_NAME:re==="="?D.state=A.ATTRIB_VALUE:re===">"?(N(D,"Attribute without value"),D.attribValue=D.attribName,j(D),Y(D)):y(re)?D.state=A.ATTRIB_NAME_SAW_WHITE:k(C,re)?D.attribName+=re:N(D,"Invalid attribute name");continue;case A.ATTRIB_NAME_SAW_WHITE:if(re==="=")D.state=A.ATTRIB_VALUE;else{if(y(re))continue;N(D,"Attribute without value"),D.tag.attributes[D.attribName]="",D.attribValue="",Q(D,"onattribute",{name:D.attribName,value:""}),D.attribName="",re===">"?Y(D):k(R,re)?(D.attribName=re,D.state=A.ATTRIB_NAME):(N(D,"Invalid attribute name"),D.state=A.ATTRIB)}continue;case A.ATTRIB_VALUE:if(y(re))continue;v(re)?(D.q=re,D.state=A.ATTRIB_VALUE_QUOTED):(N(D,"Unquoted attribute value"),D.state=A.ATTRIB_VALUE_UNQUOTED,D.attribValue=re);continue;case A.ATTRIB_VALUE_QUOTED:if(re!==D.q){re==="&"?D.state=A.ATTRIB_VALUE_ENTITY_Q:D.attribValue+=re;continue}j(D),D.q="",D.state=A.ATTRIB_VALUE_CLOSED;continue;case A.ATTRIB_VALUE_CLOSED:y(re)?D.state=A.ATTRIB:re===">"?Y(D):re==="/"?D.state=A.OPEN_TAG_SLASH:k(R,re)?(N(D,"No whitespace between attributes"),D.attribName=re,D.attribValue="",D.state=A.ATTRIB_NAME):N(D,"Invalid attribute name");continue;case A.ATTRIB_VALUE_UNQUOTED:if(!T(re)){re==="&"?D.state=A.ATTRIB_VALUE_ENTITY_U:D.attribValue+=re;continue}j(D),re===">"?Y(D):D.state=A.ATTRIB;continue;case A.CLOSE_TAG:if(D.tagName)re===">"?J(D):k(C,re)?D.tagName+=re:D.script?(D.script+="</"+D.tagName,D.tagName="",D.state=A.SCRIPT):(y(re)||N(D,"Invalid tagname in closing tag"),D.state=A.CLOSE_TAG_SAW_WHITE);else{if(y(re))continue;L(R,re)?D.script?(D.script+="</"+re,D.state=A.SCRIPT):N(D,"Invalid tagname in closing tag."):D.tagName=re}continue;case A.CLOSE_TAG_SAW_WHITE:if(y(re))continue;re===">"?J(D):N(D,"Invalid characters in closing tag");continue;case A.TEXT_ENTITY:case A.ATTRIB_VALUE_ENTITY_Q:case A.ATTRIB_VALUE_ENTITY_U:var ee,le;switch(D.state){case A.TEXT_ENTITY:ee=A.TEXT,le="textNode";break;case A.ATTRIB_VALUE_ENTITY_Q:ee=A.ATTRIB_VALUE_QUOTED,le="attribValue";break;case A.ATTRIB_VALUE_ENTITY_U:ee=A.ATTRIB_VALUE_UNQUOTED,le="attribValue";break}re===";"?(D[le]+=se(D),D.entity="",D.state=ee):k(D.entity.length?m:u,re)?D.entity+=re:(N(D,"Invalid character in entity name"),D[le]+="&"+D.entity+re,D.entity="",D.state=ee);continue;default:throw new Error(D,"Unknown state: "+D.state)}return D.position>=D.bufferCheckPosition&&o(D),D}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var X=String.fromCharCode,D=Math.floor,te=function(){var re=16384,oe=[],ve,ee,le=-1,H=arguments.length;if(!H)return"";for(var I="";++le<H;){var O=Number(arguments[le]);if(!isFinite(O)||O<0||O>1114111||D(O)!==O)throw RangeError("Invalid code point: "+O);O<=65535?oe.push(O):(O-=65536,ve=(O>>10)+55296,ee=O%1024+56320,oe.push(ve,ee)),(le+1===H||oe.length>re)&&(I+=X.apply(null,oe),oe.length=0)}return I};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:te,configurable:!0,writable:!0}):String.fromCodePoint=te}()})(typeof s>"u"?this.sax={}:s)}).call(this)}).call(this,e("buffer").Buffer)},{buffer:3,stream:11,string_decoder:27}],11:[function(e,i,s){i.exports=a;var t=e("events").EventEmitter,c=e("inherits");c(a,t),a.Readable=e("readable-stream/lib/_stream_readable.js"),a.Writable=e("readable-stream/lib/_stream_writable.js"),a.Duplex=e("readable-stream/lib/_stream_duplex.js"),a.Transform=e("readable-stream/lib/_stream_transform.js"),a.PassThrough=e("readable-stream/lib/_stream_passthrough.js"),a.finished=e("readable-stream/lib/internal/streams/end-of-stream.js"),a.pipeline=e("readable-stream/lib/internal/streams/pipeline.js"),a.Stream=a;function a(){t.call(this)}a.prototype.pipe=function(n,o){var l=this;function r(w){n.writable&&n.write(w)===!1&&l.pause&&l.pause()}l.on("data",r);function d(){l.readable&&l.resume&&l.resume()}n.on("drain",d),!n._isStdio&&(!o||o.end!==!1)&&(l.on("end",_),l.on("close",f));var h=!1;function _(){h||(h=!0,n.end())}function f(){h||(h=!0,typeof n.destroy=="function"&&n.destroy())}function g(w){if(x(),t.listenerCount(this,"error")===0)throw w}l.on("error",g),n.on("error",g);function x(){l.removeListener("data",r),n.removeListener("drain",d),l.removeListener("end",_),l.removeListener("close",f),l.removeListener("error",g),n.removeListener("error",g),l.removeListener("end",x),l.removeListener("close",x),n.removeListener("close",x)}return l.on("end",x),l.on("close",x),n.on("close",x),n.emit("pipe",l),n}},{events:5,inherits:12,"readable-stream/lib/_stream_duplex.js":14,"readable-stream/lib/_stream_passthrough.js":15,"readable-stream/lib/_stream_readable.js":16,"readable-stream/lib/_stream_transform.js":17,"readable-stream/lib/_stream_writable.js":18,"readable-stream/lib/internal/streams/end-of-stream.js":22,"readable-stream/lib/internal/streams/pipeline.js":24}],12:[function(e,i,s){typeof Object.create=="function"?i.exports=function(c,a){a&&(c.super_=a,c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}))}:i.exports=function(c,a){if(a){c.super_=a;var n=function(){};n.prototype=a.prototype,c.prototype=new n,c.prototype.constructor=c}}},{}],13:[function(e,i,s){function t(d,h){d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.__proto__=h}var c={};function a(d,h,_){_||(_=Error);function f(x,w,S){return typeof h=="string"?h:h(x,w,S)}var g=function(x){t(w,x);function w(S,M,R){return x.call(this,f(S,M,R))||this}return w}(_);g.prototype.name=_.name,g.prototype.code=d,c[d]=g}function n(d,h){if(Array.isArray(d)){var _=d.length;return d=d.map(function(f){return String(f)}),_>2?"one of ".concat(h," ").concat(d.slice(0,_-1).join(", "),", or ")+d[_-1]:_===2?"one of ".concat(h," ").concat(d[0]," or ").concat(d[1]):"of ".concat(h," ").concat(d[0])}else return"of ".concat(h," ").concat(String(d))}function o(d,h,_){return d.substr(0,h.length)===h}function l(d,h,_){return(_===void 0||_>d.length)&&(_=d.length),d.substring(_-h.length,_)===h}function r(d,h,_){return typeof _!="number"&&(_=0),_+h.length>d.length?!1:d.indexOf(h,_)!==-1}a("ERR_INVALID_OPT_VALUE",function(d,h){return'The value "'+h+'" is invalid for option "'+d+'"'},TypeError),a("ERR_INVALID_ARG_TYPE",function(d,h,_){var f;typeof h=="string"&&o(h,"not ")?(f="must not be",h=h.replace(/^not /,"")):f="must be";var g;if(l(d," argument"))g="The ".concat(d," ").concat(f," ").concat(n(h,"type"));else{var x=r(d,".")?"property":"argument";g='The "'.concat(d,'" ').concat(x," ").concat(f," ").concat(n(h,"type"))}return g+=". Received type ".concat(typeof _),g},TypeError),a("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),a("ERR_METHOD_NOT_IMPLEMENTED",function(d){return"The "+d+" method is not implemented"}),a("ERR_STREAM_PREMATURE_CLOSE","Premature close"),a("ERR_STREAM_DESTROYED",function(d){return"Cannot call "+d+" after a stream was destroyed"}),a("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),a("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),a("ERR_STREAM_WRITE_AFTER_END","write after end"),a("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),a("ERR_UNKNOWN_ENCODING",function(d){return"Unknown encoding: "+d},TypeError),a("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),i.exports.codes=c},{}],14:[function(e,i,s){(function(t){(function(){var c=Object.keys||function(f){var g=[];for(var x in f)g.push(x);return g};i.exports=d;var a=e("./_stream_readable"),n=e("./_stream_writable");e("inherits")(d,a);for(var o=c(n.prototype),l=0;l<o.length;l++){var r=o[l];d.prototype[r]||(d.prototype[r]=n.prototype[r])}function d(f){if(!(this instanceof d))return new d(f);a.call(this,f),n.call(this,f),this.allowHalfOpen=!0,f&&(f.readable===!1&&(this.readable=!1),f.writable===!1&&(this.writable=!1),f.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",h)))}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function h(){this._writableState.ended||t.nextTick(_,this)}function _(f){f.end()}Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=g,this._writableState.destroyed=g)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":16,"./_stream_writable":18,_process:8,inherits:12}],15:[function(e,i,s){i.exports=c;var t=e("./_stream_transform");e("inherits")(c,t);function c(a){if(!(this instanceof c))return new c(a);t.call(this,a)}c.prototype._transform=function(a,n,o){o(null,a)}},{"./_stream_transform":17,inherits:12}],16:[function(e,i,s){(function(t,c){(function(){i.exports=K;var a;K.ReadableState=F,e("events").EventEmitter;var n=function(le,H){return le.listeners(H).length},o=e("./internal/streams/stream"),l=e("buffer").Buffer,r=c.Uint8Array||function(){};function d(ee){return l.from(ee)}function h(ee){return l.isBuffer(ee)||ee instanceof r}var _=e("util"),f;_&&_.debuglog?f=_.debuglog("stream"):f=function(){};var g=e("./internal/streams/buffer_list"),x=e("./internal/streams/destroy"),w=e("./internal/streams/state"),S=w.getHighWaterMark,M=e("../errors").codes,R=M.ERR_INVALID_ARG_TYPE,C=M.ERR_STREAM_PUSH_AFTER_EOF,u=M.ERR_METHOD_NOT_IMPLEMENTED,m=M.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,y,v,T;e("inherits")(K,o);var k=x.errorOrDestroy,L=["error","close","destroy","pause","resume"];function A(ee,le,H){if(typeof ee.prependListener=="function")return ee.prependListener(le,H);!ee._events||!ee._events[le]?ee.on(le,H):Array.isArray(ee._events[le])?ee._events[le].unshift(H):ee._events[le]=[H,ee._events[le]]}function F(ee,le,H){a=a||e("./_stream_duplex"),ee=ee||{},typeof H!="boolean"&&(H=le instanceof a),this.objectMode=!!ee.objectMode,H&&(this.objectMode=this.objectMode||!!ee.readableObjectMode),this.highWaterMark=S(this,ee,"readableHighWaterMark",H),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=ee.emitClose!==!1,this.autoDestroy=!!ee.autoDestroy,this.destroyed=!1,this.defaultEncoding=ee.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,ee.encoding&&(y||(y=e("string_decoder/").StringDecoder),this.decoder=new y(ee.encoding),this.encoding=ee.encoding)}function K(ee){if(a=a||e("./_stream_duplex"),!(this instanceof K))return new K(ee);var le=this instanceof a;this._readableState=new F(ee,this,le),this.readable=!0,ee&&(typeof ee.read=="function"&&(this._read=ee.read),typeof ee.destroy=="function"&&(this._destroy=ee.destroy)),o.call(this)}Object.defineProperty(K.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(le){this._readableState&&(this._readableState.destroyed=le)}}),K.prototype.destroy=x.destroy,K.prototype._undestroy=x.undestroy,K.prototype._destroy=function(ee,le){le(ee)},K.prototype.push=function(ee,le){var H=this._readableState,I;return H.objectMode?I=!0:typeof ee=="string"&&(le=le||H.defaultEncoding,le!==H.encoding&&(ee=l.from(ee,le),le=""),I=!0),Q(this,ee,le,!1,I)},K.prototype.unshift=function(ee){return Q(this,ee,null,!0,!1)};function Q(ee,le,H,I,O){f("readableAddChunk",le);var ae=ee._readableState;if(le===null)ae.reading=!1,U(ee,ae);else{var me;if(O||(me=B(ae,le)),me)k(ee,me);else if(ae.objectMode||le&&le.length>0)if(typeof le!="string"&&!ae.objectMode&&Object.getPrototypeOf(le)!==l.prototype&&(le=d(le)),I)ae.endEmitted?k(ee,new m):Z(ee,ae,le,!0);else if(ae.ended)k(ee,new C);else{if(ae.destroyed)return!1;ae.reading=!1,ae.decoder&&!H?(le=ae.decoder.write(le),ae.objectMode||le.length!==0?Z(ee,ae,le,!1):Y(ee,ae)):Z(ee,ae,le,!1)}else I||(ae.reading=!1,Y(ee,ae))}return!ae.ended&&(ae.length<ae.highWaterMark||ae.length===0)}function Z(ee,le,H,I){le.flowing&&le.length===0&&!le.sync?(le.awaitDrain=0,ee.emit("data",H)):(le.length+=le.objectMode?1:H.length,I?le.buffer.unshift(H):le.buffer.push(H),le.needReadable&&q(ee)),Y(ee,le)}function B(ee,le){var H;return!h(le)&&typeof le!="string"&&le!==void 0&&!ee.objectMode&&(H=new R("chunk",["string","Buffer","Uint8Array"],le)),H}K.prototype.isPaused=function(){return this._readableState.flowing===!1},K.prototype.setEncoding=function(ee){y||(y=e("string_decoder/").StringDecoder);var le=new y(ee);this._readableState.decoder=le,this._readableState.encoding=this._readableState.decoder.encoding;for(var H=this._readableState.buffer.head,I="";H!==null;)I+=le.write(H.data),H=H.next;return this._readableState.buffer.clear(),I!==""&&this._readableState.buffer.push(I),this._readableState.length=I.length,this};var z=1073741824;function b(ee){return ee>=z?ee=z:(ee--,ee|=ee>>>1,ee|=ee>>>2,ee|=ee>>>4,ee|=ee>>>8,ee|=ee>>>16,ee++),ee}function N(ee,le){return ee<=0||le.length===0&&le.ended?0:le.objectMode?1:ee!==ee?le.flowing&&le.length?le.buffer.head.data.length:le.length:(ee>le.highWaterMark&&(le.highWaterMark=b(ee)),ee<=le.length?ee:le.ended?le.length:(le.needReadable=!0,0))}K.prototype.read=function(ee){f("read",ee),ee=parseInt(ee,10);var le=this._readableState,H=ee;if(ee!==0&&(le.emittedReadable=!1),ee===0&&le.needReadable&&((le.highWaterMark!==0?le.length>=le.highWaterMark:le.length>0)||le.ended))return f("read: emitReadable",le.length,le.ended),le.length===0&&le.ended?re(this):q(this),null;if(ee=N(ee,le),ee===0&&le.ended)return le.length===0&&re(this),null;var I=le.needReadable;f("need readable",I),(le.length===0||le.length-ee<le.highWaterMark)&&(I=!0,f("length less than watermark",I)),le.ended||le.reading?(I=!1,f("reading or ended",I)):I&&(f("do read"),le.reading=!0,le.sync=!0,le.length===0&&(le.needReadable=!0),this._read(le.highWaterMark),le.sync=!1,le.reading||(ee=N(H,le)));var O;return ee>0?O=te(ee,le):O=null,O===null?(le.needReadable=le.length<=le.highWaterMark,ee=0):(le.length-=ee,le.awaitDrain=0),le.length===0&&(le.ended||(le.needReadable=!0),H!==ee&&le.ended&&re(this)),O!==null&&this.emit("data",O),O};function U(ee,le){if(f("onEofChunk"),!le.ended){if(le.decoder){var H=le.decoder.end();H&&H.length&&(le.buffer.push(H),le.length+=le.objectMode?1:H.length)}le.ended=!0,le.sync?q(ee):(le.needReadable=!1,le.emittedReadable||(le.emittedReadable=!0,j(ee)))}}function q(ee){var le=ee._readableState;f("emitReadable",le.needReadable,le.emittedReadable),le.needReadable=!1,le.emittedReadable||(f("emitReadable",le.flowing),le.emittedReadable=!0,t.nextTick(j,ee))}function j(ee){var le=ee._readableState;f("emitReadable_",le.destroyed,le.length,le.ended),!le.destroyed&&(le.length||le.ended)&&(ee.emit("readable"),le.emittedReadable=!1),le.needReadable=!le.flowing&&!le.ended&&le.length<=le.highWaterMark,D(ee)}function Y(ee,le){le.readingMore||(le.readingMore=!0,t.nextTick(J,ee,le))}function J(ee,le){for(;!le.reading&&!le.ended&&(le.length<le.highWaterMark||le.flowing&&le.length===0);){var H=le.length;if(f("maybeReadMore read 0"),ee.read(0),H===le.length)break}le.readingMore=!1}K.prototype._read=function(ee){k(this,new u("_read()"))},K.prototype.pipe=function(ee,le){var H=this,I=this._readableState;switch(I.pipesCount){case 0:I.pipes=ee;break;case 1:I.pipes=[I.pipes,ee];break;default:I.pipes.push(ee);break}I.pipesCount+=1,f("pipe count=%d opts=%j",I.pipesCount,le);var O=(!le||le.end!==!1)&&ee!==t.stdout&&ee!==t.stderr,ae=O?Ae:nt;I.endEmitted?t.nextTick(ae):H.once("end",ae),ee.on("unpipe",me);function me(qe,W){f("onunpipe"),qe===H&&W&&W.hasUnpiped===!1&&(W.hasUnpiped=!0,Xe())}function Ae(){f("onend"),ee.end()}var Se=se(H);ee.on("drain",Se);var Ge=!1;function Xe(){f("cleanup"),ee.removeListener("close",He),ee.removeListener("finish",Je),ee.removeListener("drain",Se),ee.removeListener("error",Ze),ee.removeListener("unpipe",me),H.removeListener("end",Ae),H.removeListener("end",nt),H.removeListener("data",Ue),Ge=!0,I.awaitDrain&&(!ee._writableState||ee._writableState.needDrain)&&Se()}H.on("data",Ue);function Ue(qe){f("ondata");var W=ee.write(qe);f("dest.write",W),W===!1&&((I.pipesCount===1&&I.pipes===ee||I.pipesCount>1&&ve(I.pipes,ee)!==-1)&&!Ge&&(f("false write response, pause",I.awaitDrain),I.awaitDrain++),H.pause())}function Ze(qe){f("onerror",qe),nt(),ee.removeListener("error",Ze),n(ee,"error")===0&&k(ee,qe)}A(ee,"error",Ze);function He(){ee.removeListener("finish",Je),nt()}ee.once("close",He);function Je(){f("onfinish"),ee.removeListener("close",He),nt()}ee.once("finish",Je);function nt(){f("unpipe"),H.unpipe(ee)}return ee.emit("pipe",H),I.flowing||(f("pipe resume"),H.resume()),ee};function se(ee){return function(){var H=ee._readableState;f("pipeOnDrain",H.awaitDrain),H.awaitDrain&&H.awaitDrain--,H.awaitDrain===0&&n(ee,"data")&&(H.flowing=!0,D(ee))}}K.prototype.unpipe=function(ee){var le=this._readableState,H={hasUnpiped:!1};if(le.pipesCount===0)return this;if(le.pipesCount===1)return ee&&ee!==le.pipes?this:(ee||(ee=le.pipes),le.pipes=null,le.pipesCount=0,le.flowing=!1,ee&&ee.emit("unpipe",this,H),this);if(!ee){var I=le.pipes,O=le.pipesCount;le.pipes=null,le.pipesCount=0,le.flowing=!1;for(var ae=0;ae<O;ae++)I[ae].emit("unpipe",this,{hasUnpiped:!1});return this}var me=ve(le.pipes,ee);return me===-1?this:(le.pipes.splice(me,1),le.pipesCount-=1,le.pipesCount===1&&(le.pipes=le.pipes[0]),ee.emit("unpipe",this,H),this)},K.prototype.on=function(ee,le){var H=o.prototype.on.call(this,ee,le),I=this._readableState;return ee==="data"?(I.readableListening=this.listenerCount("readable")>0,I.flowing!==!1&&this.resume()):ee==="readable"&&!I.endEmitted&&!I.readableListening&&(I.readableListening=I.needReadable=!0,I.flowing=!1,I.emittedReadable=!1,f("on readable",I.length,I.reading),I.length?q(this):I.reading||t.nextTick(_e,this)),H},K.prototype.addListener=K.prototype.on,K.prototype.removeListener=function(ee,le){var H=o.prototype.removeListener.call(this,ee,le);return ee==="readable"&&t.nextTick(pe,this),H},K.prototype.removeAllListeners=function(ee){var le=o.prototype.removeAllListeners.apply(this,arguments);return(ee==="readable"||ee===void 0)&&t.nextTick(pe,this),le};function pe(ee){var le=ee._readableState;le.readableListening=ee.listenerCount("readable")>0,le.resumeScheduled&&!le.paused?le.flowing=!0:ee.listenerCount("data")>0&&ee.resume()}function _e(ee){f("readable nexttick read 0"),ee.read(0)}K.prototype.resume=function(){var ee=this._readableState;return ee.flowing||(f("resume"),ee.flowing=!ee.readableListening,Ee(this,ee)),ee.paused=!1,this};function Ee(ee,le){le.resumeScheduled||(le.resumeScheduled=!0,t.nextTick(X,ee,le))}function X(ee,le){f("resume",le.reading),le.reading||ee.read(0),le.resumeScheduled=!1,ee.emit("resume"),D(ee),le.flowing&&!le.reading&&ee.read(0)}K.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function D(ee){var le=ee._readableState;for(f("flow",le.flowing);le.flowing&&ee.read()!==null;);}K.prototype.wrap=function(ee){var le=this,H=this._readableState,I=!1;ee.on("end",function(){if(f("wrapped end"),H.decoder&&!H.ended){var me=H.decoder.end();me&&me.length&&le.push(me)}le.push(null)}),ee.on("data",function(me){if(f("wrapped data"),H.decoder&&(me=H.decoder.write(me)),!(H.objectMode&&me==null)&&!(!H.objectMode&&(!me||!me.length))){var Ae=le.push(me);Ae||(I=!0,ee.pause())}});for(var O in ee)this[O]===void 0&&typeof ee[O]=="function"&&(this[O]=function(Ae){return function(){return ee[Ae].apply(ee,arguments)}}(O));for(var ae=0;ae<L.length;ae++)ee.on(L[ae],this.emit.bind(this,L[ae]));return this._read=function(me){f("wrapped _read",me),I&&(I=!1,ee.resume())},this},typeof Symbol=="function"&&(K.prototype[Symbol.asyncIterator]=function(){return v===void 0&&(v=e("./internal/streams/async_iterator")),v(this)}),Object.defineProperty(K.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(K.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(K.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(le){this._readableState&&(this._readableState.flowing=le)}}),K._fromList=te,Object.defineProperty(K.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function te(ee,le){if(le.length===0)return null;var H;return le.objectMode?H=le.buffer.shift():!ee||ee>=le.length?(le.decoder?H=le.buffer.join(""):le.buffer.length===1?H=le.buffer.first():H=le.buffer.concat(le.length),le.buffer.clear()):H=le.buffer.consume(ee,le.decoder),H}function re(ee){var le=ee._readableState;f("endReadable",le.endEmitted),le.endEmitted||(le.ended=!0,t.nextTick(oe,le,ee))}function oe(ee,le){if(f("endReadableNT",ee.endEmitted,ee.length),!ee.endEmitted&&ee.length===0&&(ee.endEmitted=!0,le.readable=!1,le.emit("end"),ee.autoDestroy)){var H=le._writableState;(!H||H.autoDestroy&&H.finished)&&le.destroy()}}typeof Symbol=="function"&&(K.from=function(ee,le){return T===void 0&&(T=e("./internal/streams/from")),T(K,ee,le)});function ve(ee,le){for(var H=0,I=ee.length;H<I;H++)if(ee[H]===le)return H;return-1}}).call(this)}).call(this,e("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":13,"./_stream_duplex":14,"./internal/streams/async_iterator":19,"./internal/streams/buffer_list":20,"./internal/streams/destroy":21,"./internal/streams/from":23,"./internal/streams/state":25,"./internal/streams/stream":26,_process:8,buffer:3,events:5,inherits:12,"string_decoder/":27,util:2}],17:[function(e,i,s){i.exports=d;var t=e("../errors").codes,c=t.ERR_METHOD_NOT_IMPLEMENTED,a=t.ERR_MULTIPLE_CALLBACK,n=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=t.ERR_TRANSFORM_WITH_LENGTH_0,l=e("./_stream_duplex");e("inherits")(d,l);function r(f,g){var x=this._transformState;x.transforming=!1;var w=x.writecb;if(w===null)return this.emit("error",new a);x.writechunk=null,x.writecb=null,g!=null&&this.push(g),w(f);var S=this._readableState;S.reading=!1,(S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}function d(f){if(!(this instanceof d))return new d(f);l.call(this,f),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,f&&(typeof f.transform=="function"&&(this._transform=f.transform),typeof f.flush=="function"&&(this._flush=f.flush)),this.on("prefinish",h)}function h(){var f=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(g,x){_(f,g,x)}):_(this,null,null)}d.prototype.push=function(f,g){return this._transformState.needTransform=!1,l.prototype.push.call(this,f,g)},d.prototype._transform=function(f,g,x){x(new c("_transform()"))},d.prototype._write=function(f,g,x){var w=this._transformState;if(w.writecb=x,w.writechunk=f,w.writeencoding=g,!w.transforming){var S=this._readableState;(w.needTransform||S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}},d.prototype._read=function(f){var g=this._transformState;g.writechunk!==null&&!g.transforming?(g.transforming=!0,this._transform(g.writechunk,g.writeencoding,g.afterTransform)):g.needTransform=!0},d.prototype._destroy=function(f,g){l.prototype._destroy.call(this,f,function(x){g(x)})};function _(f,g,x){if(g)return f.emit("error",g);if(x!=null&&f.push(x),f._writableState.length)throw new o;if(f._transformState.transforming)throw new n;return f.push(null)}},{"../errors":13,"./_stream_duplex":14,inherits:12}],18:[function(e,i,s){(function(t,c){(function(){i.exports=F;function a(D){var te=this;this.next=null,this.entry=null,this.finish=function(){X(te,D)}}var n;F.WritableState=L;var o={deprecate:e("util-deprecate")},l=e("./internal/streams/stream"),r=e("buffer").Buffer,d=c.Uint8Array||function(){};function h(D){return r.from(D)}function _(D){return r.isBuffer(D)||D instanceof d}var f=e("./internal/streams/destroy"),g=e("./internal/streams/state"),x=g.getHighWaterMark,w=e("../errors").codes,S=w.ERR_INVALID_ARG_TYPE,M=w.ERR_METHOD_NOT_IMPLEMENTED,R=w.ERR_MULTIPLE_CALLBACK,C=w.ERR_STREAM_CANNOT_PIPE,u=w.ERR_STREAM_DESTROYED,m=w.ERR_STREAM_NULL_VALUES,y=w.ERR_STREAM_WRITE_AFTER_END,v=w.ERR_UNKNOWN_ENCODING,T=f.errorOrDestroy;e("inherits")(F,l);function k(){}function L(D,te,re){n=n||e("./_stream_duplex"),D=D||{},typeof re!="boolean"&&(re=te instanceof n),this.objectMode=!!D.objectMode,re&&(this.objectMode=this.objectMode||!!D.writableObjectMode),this.highWaterMark=x(this,D,"writableHighWaterMark",re),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var oe=D.decodeStrings===!1;this.decodeStrings=!oe,this.defaultEncoding=D.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ve){U(te,ve)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=D.emitClose!==!1,this.autoDestroy=!!D.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}L.prototype.getBuffer=function(){for(var te=this.bufferedRequest,re=[];te;)re.push(te),te=te.next;return re},function(){try{Object.defineProperty(L.prototype,"buffer",{get:o.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var A;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(A=Function.prototype[Symbol.hasInstance],Object.defineProperty(F,Symbol.hasInstance,{value:function(te){return A.call(this,te)?!0:this!==F?!1:te&&te._writableState instanceof L}})):A=function(te){return te instanceof this};function F(D){n=n||e("./_stream_duplex");var te=this instanceof n;if(!te&&!A.call(F,this))return new F(D);this._writableState=new L(D,this,te),this.writable=!0,D&&(typeof D.write=="function"&&(this._write=D.write),typeof D.writev=="function"&&(this._writev=D.writev),typeof D.destroy=="function"&&(this._destroy=D.destroy),typeof D.final=="function"&&(this._final=D.final)),l.call(this)}F.prototype.pipe=function(){T(this,new C)};function K(D,te){var re=new y;T(D,re),t.nextTick(te,re)}function Q(D,te,re,oe){var ve;return re===null?ve=new m:typeof re!="string"&&!te.objectMode&&(ve=new S("chunk",["string","Buffer"],re)),ve?(T(D,ve),t.nextTick(oe,ve),!1):!0}F.prototype.write=function(D,te,re){var oe=this._writableState,ve=!1,ee=!oe.objectMode&&_(D);return ee&&!r.isBuffer(D)&&(D=h(D)),typeof te=="function"&&(re=te,te=null),ee?te="buffer":te||(te=oe.defaultEncoding),typeof re!="function"&&(re=k),oe.ending?K(this,re):(ee||Q(this,oe,D,re))&&(oe.pendingcb++,ve=B(this,oe,ee,D,te,re)),ve},F.prototype.cork=function(){this._writableState.corked++},F.prototype.uncork=function(){var D=this._writableState;D.corked&&(D.corked--,!D.writing&&!D.corked&&!D.bufferProcessing&&D.bufferedRequest&&Y(this,D))},F.prototype.setDefaultEncoding=function(te){if(typeof te=="string"&&(te=te.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((te+"").toLowerCase())>-1))throw new v(te);return this._writableState.defaultEncoding=te,this},Object.defineProperty(F.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function Z(D,te,re){return!D.objectMode&&D.decodeStrings!==!1&&typeof te=="string"&&(te=r.from(te,re)),te}Object.defineProperty(F.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function B(D,te,re,oe,ve,ee){if(!re){var le=Z(te,oe,ve);oe!==le&&(re=!0,ve="buffer",oe=le)}var H=te.objectMode?1:oe.length;te.length+=H;var I=te.length<te.highWaterMark;if(I||(te.needDrain=!0),te.writing||te.corked){var O=te.lastBufferedRequest;te.lastBufferedRequest={chunk:oe,encoding:ve,isBuf:re,callback:ee,next:null},O?O.next=te.lastBufferedRequest:te.bufferedRequest=te.lastBufferedRequest,te.bufferedRequestCount+=1}else z(D,te,!1,H,oe,ve,ee);return I}function z(D,te,re,oe,ve,ee,le){te.writelen=oe,te.writecb=le,te.writing=!0,te.sync=!0,te.destroyed?te.onwrite(new u("write")):re?D._writev(ve,te.onwrite):D._write(ve,ee,te.onwrite),te.sync=!1}function b(D,te,re,oe,ve){--te.pendingcb,re?(t.nextTick(ve,oe),t.nextTick(_e,D,te),D._writableState.errorEmitted=!0,T(D,oe)):(ve(oe),D._writableState.errorEmitted=!0,T(D,oe),_e(D,te))}function N(D){D.writing=!1,D.writecb=null,D.length-=D.writelen,D.writelen=0}function U(D,te){var re=D._writableState,oe=re.sync,ve=re.writecb;if(typeof ve!="function")throw new R;if(N(re),te)b(D,re,oe,te,ve);else{var ee=J(re)||D.destroyed;!ee&&!re.corked&&!re.bufferProcessing&&re.bufferedRequest&&Y(D,re),oe?t.nextTick(q,D,re,ee,ve):q(D,re,ee,ve)}}function q(D,te,re,oe){re||j(D,te),te.pendingcb--,oe(),_e(D,te)}function j(D,te){te.length===0&&te.needDrain&&(te.needDrain=!1,D.emit("drain"))}function Y(D,te){te.bufferProcessing=!0;var re=te.bufferedRequest;if(D._writev&&re&&re.next){var oe=te.bufferedRequestCount,ve=new Array(oe),ee=te.corkedRequestsFree;ee.entry=re;for(var le=0,H=!0;re;)ve[le]=re,re.isBuf||(H=!1),re=re.next,le+=1;ve.allBuffers=H,z(D,te,!0,te.length,ve,"",ee.finish),te.pendingcb++,te.lastBufferedRequest=null,ee.next?(te.corkedRequestsFree=ee.next,ee.next=null):te.corkedRequestsFree=new a(te),te.bufferedRequestCount=0}else{for(;re;){var I=re.chunk,O=re.encoding,ae=re.callback,me=te.objectMode?1:I.length;if(z(D,te,!1,me,I,O,ae),re=re.next,te.bufferedRequestCount--,te.writing)break}re===null&&(te.lastBufferedRequest=null)}te.bufferedRequest=re,te.bufferProcessing=!1}F.prototype._write=function(D,te,re){re(new M("_write()"))},F.prototype._writev=null,F.prototype.end=function(D,te,re){var oe=this._writableState;return typeof D=="function"?(re=D,D=null,te=null):typeof te=="function"&&(re=te,te=null),D!=null&&this.write(D,te),oe.corked&&(oe.corked=1,this.uncork()),oe.ending||Ee(this,oe,re),this},Object.defineProperty(F.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function J(D){return D.ending&&D.length===0&&D.bufferedRequest===null&&!D.finished&&!D.writing}function se(D,te){D._final(function(re){te.pendingcb--,re&&T(D,re),te.prefinished=!0,D.emit("prefinish"),_e(D,te)})}function pe(D,te){!te.prefinished&&!te.finalCalled&&(typeof D._final=="function"&&!te.destroyed?(te.pendingcb++,te.finalCalled=!0,t.nextTick(se,D,te)):(te.prefinished=!0,D.emit("prefinish")))}function _e(D,te){var re=J(te);if(re&&(pe(D,te),te.pendingcb===0&&(te.finished=!0,D.emit("finish"),te.autoDestroy))){var oe=D._readableState;(!oe||oe.autoDestroy&&oe.endEmitted)&&D.destroy()}return re}function Ee(D,te,re){te.ending=!0,_e(D,te),re&&(te.finished?t.nextTick(re):D.once("finish",re)),te.ended=!0,D.writable=!1}function X(D,te,re){var oe=D.entry;for(D.entry=null;oe;){var ve=oe.callback;te.pendingcb--,ve(re),oe=oe.next}te.corkedRequestsFree.next=D}Object.defineProperty(F.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(te){this._writableState&&(this._writableState.destroyed=te)}}),F.prototype.destroy=f.destroy,F.prototype._undestroy=f.undestroy,F.prototype._destroy=function(D,te){te(D)}}).call(this)}).call(this,e("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":13,"./_stream_duplex":14,"./internal/streams/destroy":21,"./internal/streams/state":25,"./internal/streams/stream":26,_process:8,buffer:3,inherits:12,"util-deprecate":28}],19:[function(e,i,s){(function(t){(function(){var c;function a(u,m,y){return m in u?Object.defineProperty(u,m,{value:y,enumerable:!0,configurable:!0,writable:!0}):u[m]=y,u}var n=e("./end-of-stream"),o=Symbol("lastResolve"),l=Symbol("lastReject"),r=Symbol("error"),d=Symbol("ended"),h=Symbol("lastPromise"),_=Symbol("handlePromise"),f=Symbol("stream");function g(u,m){return{value:u,done:m}}function x(u){var m=u[o];if(m!==null){var y=u[f].read();y!==null&&(u[h]=null,u[o]=null,u[l]=null,m(g(y,!1)))}}function w(u){t.nextTick(x,u)}function S(u,m){return function(y,v){u.then(function(){if(m[d]){y(g(void 0,!0));return}m[_](y,v)},v)}}var M=Object.getPrototypeOf(function(){}),R=Object.setPrototypeOf((c={get stream(){return this[f]},next:function(){var m=this,y=this[r];if(y!==null)return Promise.reject(y);if(this[d])return Promise.resolve(g(void 0,!0));if(this[f].destroyed)return new Promise(function(L,A){t.nextTick(function(){m[r]?A(m[r]):L(g(void 0,!0))})});var v=this[h],T;if(v)T=new Promise(S(v,this));else{var k=this[f].read();if(k!==null)return Promise.resolve(g(k,!1));T=new Promise(this[_])}return this[h]=T,T}},a(c,Symbol.asyncIterator,function(){return this}),a(c,"return",function(){var m=this;return new Promise(function(y,v){m[f].destroy(null,function(T){if(T){v(T);return}y(g(void 0,!0))})})}),c),M),C=function(m){var y,v=Object.create(R,(y={},a(y,f,{value:m,writable:!0}),a(y,o,{value:null,writable:!0}),a(y,l,{value:null,writable:!0}),a(y,r,{value:null,writable:!0}),a(y,d,{value:m._readableState.endEmitted,writable:!0}),a(y,_,{value:function(k,L){var A=v[f].read();A?(v[h]=null,v[o]=null,v[l]=null,k(g(A,!1))):(v[o]=k,v[l]=L)},writable:!0}),y));return v[h]=null,n(m,function(T){if(T&&T.code!=="ERR_STREAM_PREMATURE_CLOSE"){var k=v[l];k!==null&&(v[h]=null,v[o]=null,v[l]=null,k(T)),v[r]=T;return}var L=v[o];L!==null&&(v[h]=null,v[o]=null,v[l]=null,L(g(void 0,!0))),v[d]=!0}),m.on("readable",w.bind(null,v)),v};i.exports=C}).call(this)}).call(this,e("_process"))},{"./end-of-stream":22,_process:8}],20:[function(e,i,s){function t(x,w){var S=Object.keys(x);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(x);w&&(M=M.filter(function(R){return Object.getOwnPropertyDescriptor(x,R).enumerable})),S.push.apply(S,M)}return S}function c(x){for(var w=1;w<arguments.length;w++){var S=arguments[w]!=null?arguments[w]:{};w%2?t(Object(S),!0).forEach(function(M){a(x,M,S[M])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(S)):t(Object(S)).forEach(function(M){Object.defineProperty(x,M,Object.getOwnPropertyDescriptor(S,M))})}return x}function a(x,w,S){return w in x?Object.defineProperty(x,w,{value:S,enumerable:!0,configurable:!0,writable:!0}):x[w]=S,x}function n(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function o(x,w){for(var S=0;S<w.length;S++){var M=w[S];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(x,M.key,M)}}function l(x,w,S){return w&&o(x.prototype,w),x}var r=e("buffer"),d=r.Buffer,h=e("util"),_=h.inspect,f=_&&_.custom||"inspect";function g(x,w,S){d.prototype.copy.call(x,w,S)}i.exports=function(){function x(){n(this,x),this.head=null,this.tail=null,this.length=0}return l(x,[{key:"push",value:function(S){var M={data:S,next:null};this.length>0?this.tail.next=M:this.head=M,this.tail=M,++this.length}},{key:"unshift",value:function(S){var M={data:S,next:this.head};this.length===0&&(this.tail=M),this.head=M,++this.length}},{key:"shift",value:function(){if(this.length!==0){var S=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,S}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(S){if(this.length===0)return"";for(var M=this.head,R=""+M.data;M=M.next;)R+=S+M.data;return R}},{key:"concat",value:function(S){if(this.length===0)return d.alloc(0);for(var M=d.allocUnsafe(S>>>0),R=this.head,C=0;R;)g(R.data,M,C),C+=R.data.length,R=R.next;return M}},{key:"consume",value:function(S,M){var R;return S<this.head.data.length?(R=this.head.data.slice(0,S),this.head.data=this.head.data.slice(S)):S===this.head.data.length?R=this.shift():R=M?this._getString(S):this._getBuffer(S),R}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(S){var M=this.head,R=1,C=M.data;for(S-=C.length;M=M.next;){var u=M.data,m=S>u.length?u.length:S;if(m===u.length?C+=u:C+=u.slice(0,S),S-=m,S===0){m===u.length?(++R,M.next?this.head=M.next:this.head=this.tail=null):(this.head=M,M.data=u.slice(m));break}++R}return this.length-=R,C}},{key:"_getBuffer",value:function(S){var M=d.allocUnsafe(S),R=this.head,C=1;for(R.data.copy(M),S-=R.data.length;R=R.next;){var u=R.data,m=S>u.length?u.length:S;if(u.copy(M,M.length-S,0,m),S-=m,S===0){m===u.length?(++C,R.next?this.head=R.next:this.head=this.tail=null):(this.head=R,R.data=u.slice(m));break}++C}return this.length-=C,M}},{key:f,value:function(S,M){return _(this,c({},M,{depth:0,customInspect:!1}))}}]),x}()},{buffer:3,util:2}],21:[function(e,i,s){(function(t){(function(){function c(d,h){var _=this,f=this._readableState&&this._readableState.destroyed,g=this._writableState&&this._writableState.destroyed;return f||g?(h?h(d):d&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(l,this,d)):t.nextTick(l,this,d)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(d||null,function(x){!h&&x?_._writableState?_._writableState.errorEmitted?t.nextTick(n,_):(_._writableState.errorEmitted=!0,t.nextTick(a,_,x)):t.nextTick(a,_,x):h?(t.nextTick(n,_),h(x)):t.nextTick(n,_)}),this)}function a(d,h){l(d,h),n(d)}function n(d){d._writableState&&!d._writableState.emitClose||d._readableState&&!d._readableState.emitClose||d.emit("close")}function o(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function l(d,h){d.emit("error",h)}function r(d,h){var _=d._readableState,f=d._writableState;_&&_.autoDestroy||f&&f.autoDestroy?d.destroy(h):d.emit("error",h)}i.exports={destroy:c,undestroy:o,errorOrDestroy:r}}).call(this)}).call(this,e("_process"))},{_process:8}],22:[function(e,i,s){var t=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function c(l){var r=!1;return function(){if(!r){r=!0;for(var d=arguments.length,h=new Array(d),_=0;_<d;_++)h[_]=arguments[_];l.apply(this,h)}}}function a(){}function n(l){return l.setHeader&&typeof l.abort=="function"}function o(l,r,d){if(typeof r=="function")return o(l,null,r);r||(r={}),d=c(d||a);var h=r.readable||r.readable!==!1&&l.readable,_=r.writable||r.writable!==!1&&l.writable,f=function(){l.writable||x()},g=l._writableState&&l._writableState.finished,x=function(){_=!1,g=!0,h||d.call(l)},w=l._readableState&&l._readableState.endEmitted,S=function(){h=!1,w=!0,_||d.call(l)},M=function(m){d.call(l,m)},R=function(){var m;if(h&&!w)return(!l._readableState||!l._readableState.ended)&&(m=new t),d.call(l,m);if(_&&!g)return(!l._writableState||!l._writableState.ended)&&(m=new t),d.call(l,m)},C=function(){l.req.on("finish",x)};return n(l)?(l.on("complete",x),l.on("abort",R),l.req?C():l.on("request",C)):_&&!l._writableState&&(l.on("end",f),l.on("close",f)),l.on("end",S),l.on("finish",x),r.error!==!1&&l.on("error",M),l.on("close",R),function(){l.removeListener("complete",x),l.removeListener("abort",R),l.removeListener("request",C),l.req&&l.req.removeListener("finish",x),l.removeListener("end",f),l.removeListener("close",f),l.removeListener("finish",x),l.removeListener("end",S),l.removeListener("error",M),l.removeListener("close",R)}}i.exports=o},{"../../../errors":13}],23:[function(e,i,s){i.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],24:[function(e,i,s){var t;function c(x){var w=!1;return function(){w||(w=!0,x.apply(void 0,arguments))}}var a=e("../../../errors").codes,n=a.ERR_MISSING_ARGS,o=a.ERR_STREAM_DESTROYED;function l(x){if(x)throw x}function r(x){return x.setHeader&&typeof x.abort=="function"}function d(x,w,S,M){M=c(M);var R=!1;x.on("close",function(){R=!0}),t===void 0&&(t=e("./end-of-stream")),t(x,{readable:w,writable:S},function(u){if(u)return M(u);R=!0,M()});var C=!1;return function(u){if(!R&&!C){if(C=!0,r(x))return x.abort();if(typeof x.destroy=="function")return x.destroy();M(u||new o("pipe"))}}}function h(x){x()}function _(x,w){return x.pipe(w)}function f(x){return!x.length||typeof x[x.length-1]!="function"?l:x.pop()}function g(){for(var x=arguments.length,w=new Array(x),S=0;S<x;S++)w[S]=arguments[S];var M=f(w);if(Array.isArray(w[0])&&(w=w[0]),w.length<2)throw new n("streams");var R,C=w.map(function(u,m){var y=m<w.length-1,v=m>0;return d(u,y,v,function(T){R||(R=T),T&&C.forEach(h),!y&&(C.forEach(h),M(R))})});return w.reduce(_)}i.exports=g},{"../../../errors":13,"./end-of-stream":22}],25:[function(e,i,s){var t=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;function c(n,o,l){return n.highWaterMark!=null?n.highWaterMark:o?n[l]:null}function a(n,o,l,r){var d=c(o,r,l);if(d!=null){if(!(isFinite(d)&&Math.floor(d)===d)||d<0){var h=r?l:"highWaterMark";throw new t(h,d)}return Math.floor(d)}return n.objectMode?16:16*1024}i.exports={getHighWaterMark:a}},{"../../../errors":13}],26:[function(e,i,s){i.exports=e("events").EventEmitter},{events:5}],27:[function(e,i,s){var t=e("safe-buffer").Buffer,c=t.isEncoding||function(C){switch(C=""+C,C&&C.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(C){if(!C)return"utf8";for(var u;;)switch(C){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return C;default:if(u)return;C=(""+C).toLowerCase(),u=!0}}function n(C){var u=a(C);if(typeof u!="string"&&(t.isEncoding===c||!c(C)))throw new Error("Unknown encoding: "+C);return u||C}s.StringDecoder=o;function o(C){this.encoding=n(C);var u;switch(this.encoding){case"utf16le":this.text=g,this.end=x,u=4;break;case"utf8":this.fillLast=h,u=4;break;case"base64":this.text=w,this.end=S,u=3;break;default:this.write=M,this.end=R;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(u)}o.prototype.write=function(C){if(C.length===0)return"";var u,m;if(this.lastNeed){if(u=this.fillLast(C),u===void 0)return"";m=this.lastNeed,this.lastNeed=0}else m=0;return m<C.length?u?u+this.text(C,m):this.text(C,m):u||""},o.prototype.end=f,o.prototype.text=_,o.prototype.fillLast=function(C){if(this.lastNeed<=C.length)return C.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);C.copy(this.lastChar,this.lastTotal-this.lastNeed,0,C.length),this.lastNeed-=C.length};function l(C){return C<=127?0:C>>5===6?2:C>>4===14?3:C>>3===30?4:C>>6===2?-1:-2}function r(C,u,m){var y=u.length-1;if(y<m)return 0;var v=l(u[y]);return v>=0?(v>0&&(C.lastNeed=v-1),v):--y<m||v===-2?0:(v=l(u[y]),v>=0?(v>0&&(C.lastNeed=v-2),v):--y<m||v===-2?0:(v=l(u[y]),v>=0?(v>0&&(v===2?v=0:C.lastNeed=v-3),v):0))}function d(C,u,m){if((u[0]&192)!==128)return C.lastNeed=0,"�";if(C.lastNeed>1&&u.length>1){if((u[1]&192)!==128)return C.lastNeed=1,"�";if(C.lastNeed>2&&u.length>2&&(u[2]&192)!==128)return C.lastNeed=2,"�"}}function h(C){var u=this.lastTotal-this.lastNeed,m=d(this,C);if(m!==void 0)return m;if(this.lastNeed<=C.length)return C.copy(this.lastChar,u,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);C.copy(this.lastChar,u,0,C.length),this.lastNeed-=C.length}function _(C,u){var m=r(this,C,u);if(!this.lastNeed)return C.toString("utf8",u);this.lastTotal=m;var y=C.length-(m-this.lastNeed);return C.copy(this.lastChar,0,y),C.toString("utf8",u,y)}function f(C){var u=C&&C.length?this.write(C):"";return this.lastNeed?u+"�":u}function g(C,u){if((C.length-u)%2===0){var m=C.toString("utf16le",u);if(m){var y=m.charCodeAt(m.length-1);if(y>=55296&&y<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=C[C.length-2],this.lastChar[1]=C[C.length-1],m.slice(0,-1)}return m}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=C[C.length-1],C.toString("utf16le",u,C.length-1)}function x(C){var u=C&&C.length?this.write(C):"";if(this.lastNeed){var m=this.lastTotal-this.lastNeed;return u+this.lastChar.toString("utf16le",0,m)}return u}function w(C,u){var m=(C.length-u)%3;return m===0?C.toString("base64",u):(this.lastNeed=3-m,this.lastTotal=3,m===1?this.lastChar[0]=C[C.length-1]:(this.lastChar[0]=C[C.length-2],this.lastChar[1]=C[C.length-1]),C.toString("base64",u,C.length-m))}function S(C){var u=C&&C.length?this.write(C):"";return this.lastNeed?u+this.lastChar.toString("base64",0,3-this.lastNeed):u}function M(C){return C.toString(this.encoding)}function R(C){return C&&C.length?this.write(C):""}},{"safe-buffer":9}],28:[function(e,i,s){(function(t){(function(){i.exports=c;function c(n,o){if(a("noDeprecation"))return n;var l=!1;function r(){if(!l){if(a("throwDeprecation"))throw new Error(o);a("traceDeprecation")?console.trace(o):console.warn(o),l=!0}return n.apply(this,arguments)}return r}function a(n){try{if(!t.localStorage)return!1}catch{return!1}var o=t.localStorage[n];return o==null?!1:String(o).toLowerCase()==="true"}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],29:[function(e,i,s){i.exports={isArray:function(t){return Array.isArray?Array.isArray(t):Object.prototype.toString.call(t)==="[object Array]"}}},{}],30:[function(e,i,s){var t=e("./xml2js"),c=e("./xml2json"),a=e("./js2xml"),n=e("./json2xml");i.exports={xml2js:t,xml2json:c,js2xml:a,json2xml:n}},{"./js2xml":31,"./json2xml":32,"./xml2js":34,"./xml2json":35}],31:[function(e,i,s){var t=e("./options-helper"),c=e("./array-helper").isArray,a,n;function o(m){var y=t.copyOptions(m);return t.ensureFlagExists("ignoreDeclaration",y),t.ensureFlagExists("ignoreInstruction",y),t.ensureFlagExists("ignoreAttributes",y),t.ensureFlagExists("ignoreText",y),t.ensureFlagExists("ignoreComment",y),t.ensureFlagExists("ignoreCdata",y),t.ensureFlagExists("ignoreDoctype",y),t.ensureFlagExists("compact",y),t.ensureFlagExists("indentText",y),t.ensureFlagExists("indentCdata",y),t.ensureFlagExists("indentAttributes",y),t.ensureFlagExists("indentInstruction",y),t.ensureFlagExists("fullTagEmptyElement",y),t.ensureFlagExists("noQuotesForNativeAttributes",y),t.ensureSpacesExists(y),typeof y.spaces=="number"&&(y.spaces=Array(y.spaces+1).join(" ")),t.ensureKeyExists("declaration",y),t.ensureKeyExists("instruction",y),t.ensureKeyExists("attributes",y),t.ensureKeyExists("text",y),t.ensureKeyExists("comment",y),t.ensureKeyExists("cdata",y),t.ensureKeyExists("doctype",y),t.ensureKeyExists("type",y),t.ensureKeyExists("name",y),t.ensureKeyExists("elements",y),t.checkFnExists("doctype",y),t.checkFnExists("instruction",y),t.checkFnExists("cdata",y),t.checkFnExists("comment",y),t.checkFnExists("text",y),t.checkFnExists("instructionName",y),t.checkFnExists("elementName",y),t.checkFnExists("attributeName",y),t.checkFnExists("attributeValue",y),t.checkFnExists("attributes",y),t.checkFnExists("fullTagEmptyElement",y),y}function l(m,y,v){return(!v&&m.spaces?`
`:"")+Array(y+1).join(m.spaces)}function r(m,y,v){if(y.ignoreAttributes)return"";"attributesFn"in y&&(m=y.attributesFn(m,n,a));var T,k,L,A,F=[];for(T in m)m.hasOwnProperty(T)&&m[T]!==null&&m[T]!==void 0&&(A=y.noQuotesForNativeAttributes&&typeof m[T]!="string"?"":'"',k=""+m[T],k=k.replace(/"/g,"&quot;"),L="attributeNameFn"in y?y.attributeNameFn(T,k,n,a):T,F.push(y.spaces&&y.indentAttributes?l(y,v+1,!1):" "),F.push(L+"="+A+("attributeValueFn"in y?y.attributeValueFn(k,T,n,a):k)+A));return m&&Object.keys(m).length&&y.spaces&&y.indentAttributes&&F.push(l(y,v,!1)),F.join("")}function d(m,y,v){return a=m,n="xml",y.ignoreDeclaration?"":"<?xml"+r(m[y.attributesKey],y,v)+"?>"}function h(m,y,v){if(y.ignoreInstruction)return"";var T;for(T in m)if(m.hasOwnProperty(T))break;var k="instructionNameFn"in y?y.instructionNameFn(T,m[T],n,a):T;if(typeof m[T]=="object")return a=m,n=k,"<?"+k+r(m[T][y.attributesKey],y,v)+"?>";var L=m[T]?m[T]:"";return"instructionFn"in y&&(L=y.instructionFn(L,T,n,a)),"<?"+k+(L?" "+L:"")+"?>"}function _(m,y){return y.ignoreComment?"":"<!--"+("commentFn"in y?y.commentFn(m,n,a):m)+"-->"}function f(m,y){return y.ignoreCdata?"":"<![CDATA["+("cdataFn"in y?y.cdataFn(m,n,a):m.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function g(m,y){return y.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in y?y.doctypeFn(m,n,a):m)+">"}function x(m,y){return y.ignoreText?"":(m=""+m,m=m.replace(/&amp;/g,"&"),m=m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in y?y.textFn(m,n,a):m)}function w(m,y){var v;if(m.elements&&m.elements.length)for(v=0;v<m.elements.length;++v)switch(m.elements[v][y.typeKey]){case"text":if(y.indentText)return!0;break;case"cdata":if(y.indentCdata)return!0;break;case"instruction":if(y.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function S(m,y,v){a=m,n=m.name;var T=[],k="elementNameFn"in y?y.elementNameFn(m.name,m):m.name;T.push("<"+k),m[y.attributesKey]&&T.push(r(m[y.attributesKey],y,v));var L=m[y.elementsKey]&&m[y.elementsKey].length||m[y.attributesKey]&&m[y.attributesKey]["xml:space"]==="preserve";return L||("fullTagEmptyElementFn"in y?L=y.fullTagEmptyElementFn(m.name,m):L=y.fullTagEmptyElement),L?(T.push(">"),m[y.elementsKey]&&m[y.elementsKey].length&&(T.push(M(m[y.elementsKey],y,v+1)),a=m,n=m.name),T.push(y.spaces&&w(m,y)?`
`+Array(v+1).join(y.spaces):""),T.push("</"+k+">")):T.push("/>"),T.join("")}function M(m,y,v,T){return m.reduce(function(k,L){var A=l(y,v,T&&!k);switch(L.type){case"element":return k+A+S(L,y,v);case"comment":return k+A+_(L[y.commentKey],y);case"doctype":return k+A+g(L[y.doctypeKey],y);case"cdata":return k+(y.indentCdata?A:"")+f(L[y.cdataKey],y);case"text":return k+(y.indentText?A:"")+x(L[y.textKey],y);case"instruction":var F={};return F[L[y.nameKey]]=L[y.attributesKey]?L:L[y.instructionKey],k+(y.indentInstruction?A:"")+h(F,y,v)}},"")}function R(m,y,v){var T;for(T in m)if(m.hasOwnProperty(T))switch(T){case y.parentKey:case y.attributesKey:break;case y.textKey:if(y.indentText||v)return!0;break;case y.cdataKey:if(y.indentCdata||v)return!0;break;case y.instructionKey:if(y.indentInstruction||v)return!0;break;case y.doctypeKey:case y.commentKey:return!0;default:return!0}return!1}function C(m,y,v,T,k){a=m,n=y;var L="elementNameFn"in v?v.elementNameFn(y,m):y;if(typeof m>"u"||m===null||m==="")return"fullTagEmptyElementFn"in v&&v.fullTagEmptyElementFn(y,m)||v.fullTagEmptyElement?"<"+L+"></"+L+">":"<"+L+"/>";var A=[];if(y){if(A.push("<"+L),typeof m!="object")return A.push(">"+x(m,v)+"</"+L+">"),A.join("");m[v.attributesKey]&&A.push(r(m[v.attributesKey],v,T));var F=R(m,v,!0)||m[v.attributesKey]&&m[v.attributesKey]["xml:space"]==="preserve";if(F||("fullTagEmptyElementFn"in v?F=v.fullTagEmptyElementFn(y,m):F=v.fullTagEmptyElement),F)A.push(">");else return A.push("/>"),A.join("")}return A.push(u(m,v,T+1,!1)),a=m,n=y,y&&A.push((k?l(v,T,!1):"")+"</"+L+">"),A.join("")}function u(m,y,v,T){var k,L,A,F=[];for(L in m)if(m.hasOwnProperty(L))for(A=c(m[L])?m[L]:[m[L]],k=0;k<A.length;++k){switch(L){case y.declarationKey:F.push(d(A[k],y,v));break;case y.instructionKey:F.push((y.indentInstruction?l(y,v,T):"")+h(A[k],y,v));break;case y.attributesKey:case y.parentKey:break;case y.textKey:F.push((y.indentText?l(y,v,T):"")+x(A[k],y));break;case y.cdataKey:F.push((y.indentCdata?l(y,v,T):"")+f(A[k],y));break;case y.doctypeKey:F.push(l(y,v,T)+g(A[k],y));break;case y.commentKey:F.push(l(y,v,T)+_(A[k],y));break;default:F.push(l(y,v,T)+C(A[k],L,y,v,R(A[k],y)))}T=T&&!F.length}return F.join("")}i.exports=function(m,y){y=o(y);var v=[];return a=m,n="_root_",y.compact?v.push(u(m,y,0,!0)):(m[y.declarationKey]&&v.push(d(m[y.declarationKey],y,0)),m[y.elementsKey]&&m[y.elementsKey].length&&v.push(M(m[y.elementsKey],y,0,!v.length))),v.join("")}},{"./array-helper":29,"./options-helper":33}],32:[function(e,i,s){(function(t){(function(){var c=e("./js2xml.js");i.exports=function(a,n){a instanceof t&&(a=a.toString());var o=null;if(typeof a=="string")try{o=JSON.parse(a)}catch{throw new Error("The JSON structure is invalid")}else o=a;return c(o,n)}}).call(this)}).call(this,e("buffer").Buffer)},{"./js2xml.js":31,buffer:3}],33:[function(e,i,s){var t=e("./array-helper").isArray;i.exports={copyOptions:function(c){var a,n={};for(a in c)c.hasOwnProperty(a)&&(n[a]=c[a]);return n},ensureFlagExists:function(c,a){(!(c in a)||typeof a[c]!="boolean")&&(a[c]=!1)},ensureSpacesExists:function(c){(!("spaces"in c)||typeof c.spaces!="number"&&typeof c.spaces!="string")&&(c.spaces=0)},ensureAlwaysArrayExists:function(c){(!("alwaysArray"in c)||typeof c.alwaysArray!="boolean"&&!t(c.alwaysArray))&&(c.alwaysArray=!1)},ensureKeyExists:function(c,a){(!(c+"Key"in a)||typeof a[c+"Key"]!="string")&&(a[c+"Key"]=a.compact?"_"+c:c)},checkFnExists:function(c,a){return c+"Fn"in a}}},{"./array-helper":29}],34:[function(e,i,s){var t=e("sax"),c=e("./options-helper"),a=e("./array-helper").isArray,n,o;function l(C){return n=c.copyOptions(C),c.ensureFlagExists("ignoreDeclaration",n),c.ensureFlagExists("ignoreInstruction",n),c.ensureFlagExists("ignoreAttributes",n),c.ensureFlagExists("ignoreText",n),c.ensureFlagExists("ignoreComment",n),c.ensureFlagExists("ignoreCdata",n),c.ensureFlagExists("ignoreDoctype",n),c.ensureFlagExists("compact",n),c.ensureFlagExists("alwaysChildren",n),c.ensureFlagExists("addParent",n),c.ensureFlagExists("trim",n),c.ensureFlagExists("nativeType",n),c.ensureFlagExists("nativeTypeAttributes",n),c.ensureFlagExists("sanitize",n),c.ensureFlagExists("instructionHasAttributes",n),c.ensureFlagExists("captureSpacesBetweenElements",n),c.ensureAlwaysArrayExists(n),c.ensureKeyExists("declaration",n),c.ensureKeyExists("instruction",n),c.ensureKeyExists("attributes",n),c.ensureKeyExists("text",n),c.ensureKeyExists("comment",n),c.ensureKeyExists("cdata",n),c.ensureKeyExists("doctype",n),c.ensureKeyExists("type",n),c.ensureKeyExists("name",n),c.ensureKeyExists("elements",n),c.ensureKeyExists("parent",n),c.checkFnExists("doctype",n),c.checkFnExists("instruction",n),c.checkFnExists("cdata",n),c.checkFnExists("comment",n),c.checkFnExists("text",n),c.checkFnExists("instructionName",n),c.checkFnExists("elementName",n),c.checkFnExists("attributeName",n),c.checkFnExists("attributeValue",n),c.checkFnExists("attributes",n),n}function r(C){var u=Number(C);if(!isNaN(u))return u;var m=C.toLowerCase();return m==="true"?!0:m==="false"?!1:C}function d(C,u){var m;if(n.compact){if(!o[n[C+"Key"]]&&(a(n.alwaysArray)?n.alwaysArray.indexOf(n[C+"Key"])!==-1:n.alwaysArray)&&(o[n[C+"Key"]]=[]),o[n[C+"Key"]]&&!a(o[n[C+"Key"]])&&(o[n[C+"Key"]]=[o[n[C+"Key"]]]),C+"Fn"in n&&typeof u=="string"&&(u=n[C+"Fn"](u,o)),C==="instruction"&&("instructionFn"in n||"instructionNameFn"in n)){for(m in u)if(u.hasOwnProperty(m))if("instructionFn"in n)u[m]=n.instructionFn(u[m],m,o);else{var y=u[m];delete u[m],u[n.instructionNameFn(m,y,o)]=y}}a(o[n[C+"Key"]])?o[n[C+"Key"]].push(u):o[n[C+"Key"]]=u}else{o[n.elementsKey]||(o[n.elementsKey]=[]);var v={};if(v[n.typeKey]=C,C==="instruction"){for(m in u)if(u.hasOwnProperty(m))break;v[n.nameKey]="instructionNameFn"in n?n.instructionNameFn(m,u,o):m,n.instructionHasAttributes?(v[n.attributesKey]=u[m][n.attributesKey],"instructionFn"in n&&(v[n.attributesKey]=n.instructionFn(v[n.attributesKey],m,o))):("instructionFn"in n&&(u[m]=n.instructionFn(u[m],m,o)),v[n.instructionKey]=u[m])}else C+"Fn"in n&&(u=n[C+"Fn"](u,o)),v[n[C+"Key"]]=u;n.addParent&&(v[n.parentKey]=o),o[n.elementsKey].push(v)}}function h(C){if("attributesFn"in n&&C&&(C=n.attributesFn(C,o)),(n.trim||"attributeValueFn"in n||"attributeNameFn"in n||n.nativeTypeAttributes)&&C){var u;for(u in C)if(C.hasOwnProperty(u)&&(n.trim&&(C[u]=C[u].trim()),n.nativeTypeAttributes&&(C[u]=r(C[u])),"attributeValueFn"in n&&(C[u]=n.attributeValueFn(C[u],u,o)),"attributeNameFn"in n)){var m=C[u];delete C[u],C[n.attributeNameFn(u,C[u],o)]=m}}return C}function _(C){var u={};if(C.body&&(C.name.toLowerCase()==="xml"||n.instructionHasAttributes)){for(var m=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,y;(y=m.exec(C.body))!==null;)u[y[1]]=y[2]||y[3]||y[4];u=h(u)}if(C.name.toLowerCase()==="xml"){if(n.ignoreDeclaration)return;o[n.declarationKey]={},Object.keys(u).length&&(o[n.declarationKey][n.attributesKey]=u),n.addParent&&(o[n.declarationKey][n.parentKey]=o)}else{if(n.ignoreInstruction)return;n.trim&&(C.body=C.body.trim());var v={};n.instructionHasAttributes&&Object.keys(u).length?(v[C.name]={},v[C.name][n.attributesKey]=u):v[C.name]=C.body,d("instruction",v)}}function f(C,u){var m;if(typeof C=="object"&&(u=C.attributes,C=C.name),u=h(u),"elementNameFn"in n&&(C=n.elementNameFn(C,o)),n.compact){if(m={},!n.ignoreAttributes&&u&&Object.keys(u).length){m[n.attributesKey]={};var y;for(y in u)u.hasOwnProperty(y)&&(m[n.attributesKey][y]=u[y])}!(C in o)&&(a(n.alwaysArray)?n.alwaysArray.indexOf(C)!==-1:n.alwaysArray)&&(o[C]=[]),o[C]&&!a(o[C])&&(o[C]=[o[C]]),a(o[C])?o[C].push(m):o[C]=m}else o[n.elementsKey]||(o[n.elementsKey]=[]),m={},m[n.typeKey]="element",m[n.nameKey]=C,!n.ignoreAttributes&&u&&Object.keys(u).length&&(m[n.attributesKey]=u),n.alwaysChildren&&(m[n.elementsKey]=[]),o[n.elementsKey].push(m);m[n.parentKey]=o,o=m}function g(C){n.ignoreText||!C.trim()&&!n.captureSpacesBetweenElements||(n.trim&&(C=C.trim()),n.nativeType&&(C=r(C)),n.sanitize&&(C=C.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),d("text",C))}function x(C){n.ignoreComment||(n.trim&&(C=C.trim()),d("comment",C))}function w(C){var u=o[n.parentKey];n.addParent||delete o[n.parentKey],o=u}function S(C){n.ignoreCdata||(n.trim&&(C=C.trim()),d("cdata",C))}function M(C){n.ignoreDoctype||(C=C.replace(/^ /,""),n.trim&&(C=C.trim()),d("doctype",C))}function R(C){C.note=C}i.exports=function(C,u){var m=t.parser(!0,{}),y={};if(o=y,n=l(u),m.opt={strictEntities:!0},m.onopentag=f,m.ontext=g,m.oncomment=x,m.onclosetag=w,m.onerror=R,m.oncdata=S,m.ondoctype=M,m.onprocessinginstruction=_,m.write(C).close(),y[n.elementsKey]){var v=y[n.elementsKey];delete y[n.elementsKey],y[n.elementsKey]=v,delete y.text}return y}},{"./array-helper":29,"./options-helper":33,sax:10}],35:[function(e,i,s){var t=e("./options-helper"),c=e("./xml2js");function a(n){var o=t.copyOptions(n);return t.ensureSpacesExists(o),o}i.exports=function(n,o){var l,r,d,h;return l=a(o),r=c(n,l),h="compact"in l&&l.compact?"_parent":"parent","addParent"in l&&l.addParent?d=JSON.stringify(r,function(_,f){return _===h?"_":f},l.spaces):d=JSON.stringify(r,null,l.spaces),d.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}},{"./options-helper":33,"./xml2js":34}],36:[function(e,i,s){var t,c;c=function(a,n,o){var l,r;return l=n*Math.min(o,1-o),r=function(d,h=(d+a*12)%12){return o-l*Math.max(Math.min(h-3,9-h,1),-1)},[r(0),r(8),r(4)].map(function(d){return d})},t=["red","green","blue","hue","saturation","lightness","value","cyan","magenta","yellow","key","alpha","x","y","z","l","a","b"],i.exports=class{constructor(n){var o,l,r,d,h,_,f,g;for({red:this.red,green:this.green,blue:this.blue,hue:this.hue,saturation:this.saturation,value:this.value,lightness:this.lightness,cyan:l,magenta:_,yellow:g,key:d,alpha:this.alpha,name:this.name}=n,r=0,h=t.length;r<h;r++)if(o=t[r],n[o]!=null){if(!isFinite(n[o])||typeof n[o]!="number")throw new TypeError(`Color component option ${o} is not a finite number: ${JSON.stringify(n[o])}`);if(n[o]<0||n[o]>1)throw new TypeError(`Color component option ${o} outside range of [0,1]: ${n[o]}`)}if(f=function(){throw new TypeError(`Color constructor must be called with {red,green,blue} or {hue,saturation,value} or {hue,saturation,lightness} or {cyan,magenta,yellow,key} or {x,y,z} or {l,a,b}, ${function(){try{return`got ${JSON.stringify(n)}`}catch{return"got something that couldn't be displayed with JSON.stringify for this error message"}}()}`)},!(this.red!=null&&this.green!=null&&this.blue!=null))if(this.hue!=null&&this.saturation!=null){if(this.value!=null)this.lightness=(2-this.saturation)*this.value/2,this.saturation=this.saturation*this.value/(this.lightness<.5?this.lightness*2:2-this.lightness*2),isNaN(this.saturation)&&(this.saturation=0);else if(this.lightness==null){if(n.brightness!=null)throw new TypeError("{hue, saturation, brightness} not supported. Use {hue, saturation, value} instead for an equivalent color space");f()}[this.red,this.green,this.blue]=c(this.hue,this.saturation,this.lightness)}else{if(l!=null&&_!=null&&g!=null&&d!=null)throw new Error("CMYK color space is not currently supported");if(n.l!=null&&n.a!=null&&n.b!=null)throw new Error("L*a*b* color space is not currently supported");if(n.x!=null&&n.y!=null&&n.z!=null)throw new Error("XYZ color space is not currently supported");f()}}toString(){if(this.hue!=null)return this.alpha!=null?`hsla(${this.hue*360}, ${this.saturation*100}%, ${this.lightness*100}%, ${this.alpha})`:`hsl(${this.hue*360}, ${this.saturation*100}%, ${this.lightness*100}%)`;if(this.red!=null)return this.alpha!=null?`rgba(${this.red*255}, ${this.green*255}, ${this.blue*255}, ${this.alpha})`:`rgb(${this.red*255}, ${this.green*255}, ${this.blue*255})`}static is(n,o,l=1e-4){var r,d;return Math.abs(n.red-o.red)<l&&Math.abs(n.green-o.green)<l&&Math.abs(n.blue-o.blue)<l&&Math.abs(((r=n.alpha)!=null?r:1)-((d=o.alpha)!=null?d:1))<l}}},{}],37:[function(e,i,s){var t,c;t=e("./Color"),c=["r","g","b","h","s","l","v","x","y","z","a","b","c","m","y","k","red","green","blue","hue","saturation","lightness","value","cyan","magenta","yellow","key","alpha"],i.exports=class extends Array{constructor(...n){super(...n),this.name=void 0,this.description=void 0,this.numberOfColumns=void 0,this.geometrySpecifiedByFile=void 0}add(n){var o,l,r,d;for(l=0,r=c.length;l<r;l++)if(o=c[l],n[o]!=null){if(!isFinite(n[o])||typeof n[o]!="number")throw new TypeError(`palette.add() component option ${o} is not a finite number: ${JSON.stringify(n[o])}`);if(n[o]<0||n[o]>1)throw new TypeError(`palette.add() component option ${o} outside range of [0,1]: ${n[o]}`)}return d=n instanceof t?n:new t(n),this.push(d)}}},{"./Color":36}],38:[function(e,i,s){var t,c,a,n,o;o=e("jdataview"),c=e("../Palette"),t=2**16-1,a=Object.freeze({RGB:0,HSB:1,CMYK:2,PANTONE:3,FOCOLTONE:4,TRUMATCH:5,TOYO:6,LAB:7,GRAYSCALE:8,WIDE_CMYK:9,HKS:10,DIC:11,TOTAL_INK:12,MONITOR_RGB:13,DUOTONE:14,OPACITY:15,WEB:16,GRAY_FLOAT:17,RGB_FLOAT:18,OPACITY_FLOAT:19,0:"RGB",1:"HSB",2:"CMYK",3:"PANTONE",4:"FOCOLTONE",5:"TRUMATCH",6:"TOYO",7:"LAB",8:"GRAYSCALE",9:"WIDE_CMYK",10:"HKS",11:"DIC",12:"TOTAL_INK",13:"MONITOR_RGB",14:"DUOTONE",15:"OPACITY",16:"WEB",17:"GRAY_FLOAT",18:"RGB_FLOAT",19:"OPACITY_FLOAT"}),n=function(l,r,d){var h,_,f;for(d&&(r-=1),f="",h=0,_=r;0<=_?h<_:h>_;0<=_?h++:h--)f+=String.fromCharCode(l.getUint16());return d&&l.getUint16(),f},i.exports.read_adobe_color_swatch=function({data:l}){var r,d,h,_,f,g,x,w,S,M,R,C,u;if(S=new c,u=new o(l),M=function(m){var y,v,T,k,L,A,F;switch(y=u.getUint16(),k=u.getUint16()/t,L=u.getUint16()/t,A=u.getUint16()/t,F=u.getUint16()/t,m?(u.getUint16(),v=u.getUint16(),T=n(u,v,!0)):T=void 0,y){case a.RGB:return S.add({red:k,green:L,blue:A,name:T});case a.HSB:return S.add({hue:k,saturation:L,value:A,name:T});case a.CMYK:case a.WIDE_CMYK:return S.add({cyan:k,magenta:L,yellow:A,key:F,name:T});case a.LAB:return S.add({l:k,a:L,b:A,name:T});case a.GRAYSCALE:return S.add({red:k,green:k,blue:k,name:T})}},r=u.getUint16(),w=u.getUint16(),r!==1)throw new Error("Not an Adobe Color Swatch file");if(f=4,h=f+w*(5*2),u.byteLength<=h){for(g=0,R=w;0<=R?g<R:g>R;0<=R?g++:g--)M(!1);return S}if(u.seek(h),_=u.getUint16(),d=u.getUint16(),_!==2)throw new Error("Not an Adobe Color Swatch file v2");if(d!==w)throw new Error("Number of colors mismatch between ACO v1 and v2 sections");for(x=0,C=w;0<=C?x<C:x>C;0<=C?x++:x--)M(!0);return S},i.exports.write_adobe_color_swatch=function(l){var r,d,h,_,f,g,x,w,S,M,R;for(R=function(C,u){var m,y,v,T,k,L,A,F,K,Q,Z,B;for(Q=(Z=C.name)!=null?Z:C.toString(),y=a.RGB,k=[C.red,C.green,C.blue,0],B=2+k.length*2,u&&(B+=4+(Q.length+1)*2),v=new o(B),v.writeUint16(y),L=0,F=k.length;L<F;L++)T=k[L],v.writeUint16(T*t);if(u){for(v.writeUint16(0),v.writeUint16(Q.length+1),A=0,K=Q.length;A<K;A++)m=Q[A],v.writeUint16(m.charCodeAt(0));v.writeUint16(0)}return v.buffer},r=function(){var C,u,m;for(m=[],C=0,u=l.length;C<u;C++)_=l[C],m.push(R(_,!1));return m}(),d=function(){var C,u,m;for(m=[],C=0,u=l.length;C<u;C++)_=l[C],m.push(R(_,!0));return m}(),f=4+r.reduce(function(C,u){return C+u.byteLength},0)+2+2+d.reduce(function(C,u){return C+u.byteLength},0),g=new o(f),g.writeUint16(1),g.writeUint16(l.length),x=0,S=r.length;x<S;x++)h=r[x],g.writeBytes(new Uint8Array(h));for(g.writeUint16(2),g.writeUint16(l.length),w=0,M=d.length;w<M;w++)h=d[w],g.writeBytes(new Uint8Array(h));return g.buffer},i.exports.read_adobe_swatch_exchange=function({data:l}){var r,d,h,_,f,g,x,w,S,M,R,C,u,m,y,v,T,k,L;if(v=new c,k=new o(l),k.getString(4)!=="ASEF")throw new Error("Not an Adobe Swatch Exchange file");for(k.getUint32(),y=k.getUint32(),h=49153,d=49154,r=1,_="CMYK",g="RGB ",f="GRAY",L=[],C=0,T=y;0<=T?C<T:C>T;0<=T?C++:C--){switch(S=k.getUint16(),w=k.getUint32(),x=k.tell()+w,S){case h:m=k.getUint16(),u=n(k,m,!0),L.push({name:u});break;case d:L.pop();break;case r:switch(m=k.getUint16(),u=n(k,m,!0),M=k.getString(4),M){case _:v.add({cyan:k.getFloat32(),magenta:k.getFloat32(),yellow:k.getFloat32(),key:k.getFloat32(),name:u});break;case g:v.add({red:k.getFloat32(),green:k.getFloat32(),blue:k.getFloat32(),name:u});break;case f:R=k.getFloat32(),v.add({red:R,green:R,blue:R,name:u})}k.getUint16()}k.seek(x)}return v},i.exports.write_adobe_swatch_exchange=function(l){var r,d,h,_,f,g,x,w,S,M,R,C,u,m,y,v,T,k,L,A,F,K,Q;for(r=1,h="RGB ",d=0,w=[],F=0,u=0,v=l.length;u<v;u++){for(R=l[u],L=(A=R.name)!=null?A:R.toString(),g=r,S=2+(L.length+1)*2+4+3*4+2,f=6+S,x=o(f),x.writeUint16(g),x.writeUint32(S),x.writeUint16(L.length+1),m=0,T=L.length;m<T;m++)M=L[m],x.writeUint16(M.charCodeAt(0));x.writeUint16(0),x.writeString(h),x.writeFloat32(R.red),x.writeFloat32(R.green),x.writeFloat32(R.blue),x.writeUint16(d),w.push(x.buffer),F+=f}for(C=12+F,Q=new o(C),Q.writeString("ASEF"),K=1,Q.writeUint32(K),Q.writeUint32(w.length),y=0,k=w.length;y<k;y++)_=w[y],Q.writeBytes(new Uint8Array(_));return Q.buffer},i.exports.read_adobe_color_book=function({data:l}){var r,d,h,_,f,g,x,w,S,M,R,C,u,m,y,v,T,k;if(u=new c,k=new o(l),v=k.getString(4),v!=="8BCB")throw new Error("Not an Adobe Color Book");if(T=k.getUint16(),T!==1)throw new Error(`Unknown Adobe Color Book version: ${T}?`);for(R=function(L){var A;return A=L.replace(/^"(.*)"$/,"$1"),A.startsWith("$$$")&&(A=A.split("=")[1]),A=A.replace("^R","®"),A=A.replace("^C","©"),A},k.getUint16(),_=R(n(k,k.getUint32(),!1)),w=R(n(k,k.getUint32(),!1)),S=R(n(k,k.getUint32(),!1)),h=R(n(k,k.getUint32())),g=k.getUint16(),k.getUint16(),k.getUint16(),M=k.getUint16(),C=0,y=g;0<=y?C<y:C>y;0<=y?C++:C--)switch(x=R(n(k,k.getUint32(),!1)),f=k.getString(6).trim(),f=f.replace(/^0*(\d+)$/,"$1"),f=f.replace("X","-"),f&&!x&&(m=f.lastIndexOf(S.trim()),x=m>=0?f.slice(0,m):f),r=function(L){if(!(!x.trim()&&!f.trim()))return L.name=w+x+S,u.add(L)},d=function(){throw new Error(`Color space #${M} (${a[M]}) not supported.`)},M){case 0:r({red:k.getUint8()/255,green:k.getUint8()/255,blue:k.getUint8()/255});break;case 1:r({hue:k.getUint8()/255,saturation:k.getUint8()/255,value:k.getUint8()/255});break;case 2:r({cyan:1-k.getUint8()/255,magenta:1-k.getUint8()/255,yellow:1-k.getUint8()/255,key:1-k.getUint8()/255});break;case 3:d();break;case 4:d();break;case 5:d();break;case 6:d();break;case 7:r({l:k.getUint8()/255,a:k.getUint8()/255,b:k.getUint8()/255});break;case 8:d();break;case 9:d();break;case 10:d();break;default:d()}return u.name=_,u.description=h,u}},{"../Palette":37,jdataview:7}],39:[function(e,i,s){var t,c;c=e("jdataview"),t=e("../Palette"),i.exports=function({data:a,fileExt:n}){var o,l,r,d;if(l=new t,d=new c(a),!((r=d.byteLength)===768||r===772||n==="act"))throw new Error(`file size must be 768 or 772 bytes (saw ${d.byteLength}), OR file extension must be '.act' (saw '.${n}')`);for(var o=0;o<256;o++)l.add({red:d.getUint8()/255,green:d.getUint8()/255,blue:d.getUint8()/255});return l.numberOfColumns=16,l},i.exports.write=function(a){var n,o,l;for(l=new c(256*3),n=o=0;o<256;n=++o)l.writeUint8(a[n]?Math.round(a[n].red*255):0),l.writeUint8(a[n]?Math.round(a[n].green*255):0),l.writeUint8(a[n]?Math.round(a[n].blue*255):0);return l.buffer}},{"../Palette":37,jdataview:7}],40:[function(e,i,s){var t,c;c=e("css.escape"),t=e("../Palette"),i.exports=function({fileContentString:a}){var n,o,l,r,d,h,_,f,g,x,w,S,M,R,C,u,m;for(g=0,l=0,d=a.length;l<d;l++)n=a[l],(n==="\0"||n===""||n===""||n===""||n===""||n===""||n===""||n==="\x07"||n==="\b"||n==="\v"||n==="\f"||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n==="\x1B"||n===""||n===""||n===""||n===""||n==="")&&g++;if(g>5)throw new Error("looks like a binary file");for(m=[w=new t,S=new t,C=new t,M=new t,R=new t,u=new t],o=function(y){return parseInt(y,16)},a.replace(/\#([0-9A-F]{3}|[0-9A-F]{6}|[0-9A-F]{4}|[0-9A-F]{8})(?![0-9A-F])/gim,function(y,v){return v.length>4?w.add({red:o(v[0]+v[1])/255,green:o(v[2]+v[3])/255,blue:o(v[4]+v[5])/255,alpha:v.length===8?o(v[6]+v[7])/255:void 0}):S.add({red:o(v[0]+v[0])/255,green:o(v[1]+v[1])/255,blue:o(v[2]+v[2])/255,alpha:v.length===4?o(v[3]+v[3])/255:void 0})}),a.replace(/rgb\(\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*\)/gim,function(y,v,T,k,L,A,F){return C.add({red:Number(v)/(T==="%"?100:255),green:Number(k)/(L==="%"?100:255),blue:Number(A)/(F==="%"?100:255)})}),a.replace(/rgba?\(\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\/)\s*([0-9]*\.?[0-9]+)(%?)\s*\)/gim,function(y,v,T,k,L,A,F,K,Q){return u.add({red:Number(v)/(T==="%"?100:255),green:Number(k)/(L==="%"?100:255),blue:Number(A)/(F==="%"?100:255),alpha:Number(K)/(Q==="%"?100:1)})}),a.replace(/hsl\(\s*([0-9]*\.?[0-9]+)(deg|rad|turn|)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*\)/gim,function(y,v,T,k,L,A,F){return M.add({hue:Number(v)/(T==="rad"?2*Math.PI:T==="turn"?1:360),saturation:Number(k)/(L==="%"?100:1),lightness:Number(A)/(F==="%"?100:1)})}),a.replace(/hsla?\(\s*([0-9]*\.?[0-9]+)(deg|rad|turn|)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\s)\s*([0-9]*\.?[0-9]+)(%?)\s*(?:,|\/)\s*([0-9]*\.?[0-9]+)(%?)\s*\)/gim,function(y,v,T,k,L,A,F,K,Q){return R.add({hue:Number(v)/(T==="rad"?2*Math.PI:T==="turn"?1:360),saturation:Number(k)/(L==="%"?100:1),lightness:Number(A)/(F==="%"?100:1),alpha:Number(K)/(Q==="%"?100:1)})}),_=[],r=0,h=m.length;r<h;r++)x=m[r],x.length>=_.length&&(_=x);if(f=_.length,f<4)throw new Error(["No colors found","Only one color found","Only a couple colors found","Only a few colors found"][f]+` (${f})`);return _},i.exports.write_css=function(a){return`:root {
	${a.map(function(n,o){return`--${n.name?c(n.name.replace(/\s/g,"-")):`color-${o+1}`}: ${n};`}).join(`
	`)}
}`},i.exports.write_styl=function(a){return a.map(function(n,o){return`${n.name?c(n.name.replace(/\s/g,"-")):`color-${o+1}`} = ${n};`}).join(`
`)},i.exports.write_less=function(a){return a.map(function(n,o){return`@${n.name?c(n.name.replace(/\s/g,"-")):`color-${o+1}`}: ${n};`}).join(`
`)},i.exports.write_scss=function(a){return a.map(function(n,o){return`$${n.name?c(n.name.replace(/\s/g,"-")):`color-${o+1}`}: ${n};`}).join(`
`)},i.exports.write_sass=function(a){return a.map(function(n,o){return`$${n.name?c(n.name.replace(/\s/g,"-")):`color-${o+1}`}: ${n}`}).join(`
`)}},{"../Palette":37,"css.escape":4}],41:[function(e,i,s){var t,c;c=e("jdataview"),t=e("../Palette"),i.exports=function({data:a,fileExt:n}){var o,l,r,d,h,_,f;if(n!=="cs")throw new Error(`ColorSchemer loader is only enabled when file extension is '.cs' (saw '.${n}' instead)`);for(h=new t,d=!0,f=new c(a,0,void 0,d),f.getUint16(),o=f.getUint16(),l=r=0,_=o;0<=_?r<_:r>_;l=0<=_?++r:--r)f.seek(8+l*26),h.add({red:f.getUint8()/255,green:f.getUint8()/255,blue:f.getUint8()/255});return h}},{"../Palette":37,jdataview:7}],42:[function(e,i,s){var t,c,a;t=e("../Palette"),c=function(n,o){var l,r,d,h,_,f;if(d=n.split(/\r?\n/),d[0]!==o)throw new Error(`Not a ${o}`);for(_=new t,r=0;(r+=1)<d.length;)if(l=d[r],!(l[0]==="#"||l==="")){if(h=l.match(/Name:\s*(.*)/),h){_.name=h[1];continue}if(h=l.match(/Columns:\s*(.*)/),h){_.numberOfColumns=Number(h[1]),_.geometrySpecifiedByFile=!0;continue}if(f=l.match(/^\s*([0-9]+)\s+([0-9]+)\s+([0-9]+)(?:\s+(.*))?$/),!f)throw new Error(`Line ${r+1} doesn't match pattern of red green blue name`);_.add({red:Number(f[1])/255,green:Number(f[2])/255,blue:Number(f[3])/255,name:f[4]})}return _},i.exports=function({fileContentString:n}){return c(n,"GIMP Palette")},a=function(n,o){return`${o||"GIMP Palette"}
Name: ${n.name||"Saved Colors"}
Columns: ${n.numberOfColumns||8}
#
${n.map(l=>{var r,d,h;return{red:h,green:d,blue:r}=l,`${[h,d,r].map(_=>`${Math.round(_*255)}`.padEnd(3," ")).join(" ")}   ${l.name||l}`}).join(`
`)}`},i.exports.write=function(n){return a(n,"GIMP Palette")},i.exports.extension="gpl",i.exports.write_gimp_or_kde_rgb_palette=a,i.exports.parse_gimp_or_kde_rgb_palette=c},{"../Palette":37}],43:[function(e,i,s){var t;t=e("../Palette"),i.exports=function({fileContentString:c}){var a,n,o,l,r,d;if(l=c.split(/\r?\n/),l[0]!=="Palette")throw new Error("Not a Homesite palette");if(!l[1].match(/Version [34]\.0/))throw new Error("Unsupported Homesite palette version");for(d=new t,a=0,n=l.length;a<n;a++)o=l[a],r=o.match(/(\d+)\s+(\d+)\s+(\d+)/),r&&d.add({red:Number(r[1])/255,green:Number(r[2])/255,blue:Number(r[3])/255});return d},i.exports.write=function(c){return`Palette
Version 4.0
-----------
${c.map(function(a){return`${Math.round(a.red*255)} ${Math.round(a.green*255)} ${Math.round(a.blue*255)}`}).join(`
`)}`}},{"../Palette":37}],44:[function(e,i,s){var t,c;({parse_gimp_or_kde_rgb_palette:t,write_gimp_or_kde_rgb_palette:c}=e("./GIMP")),i.exports=function({fileContentString:a}){return t(a,"KDE RGB Palette")},i.exports.write=function(a){return c(a,"KDE RGB Palette")},i.exports.extension="colors"},{"./GIMP":42}],45:[function(e,i,s){var t;t=e("../Palette"),i.exports=function({fileContentString:c}){var a,n,o,l,r,d,h;for(d=new t,a=function(_){return parseInt(_,16)},h=c.split(/\r?\n/),n=0,o=h.length;n<o;n++)l=h[n],r=l.match(/^([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i),r&&d.add({alpha:a(r[1])/255,red:a(r[2])/255,green:a(r[3])/255,blue:a(r[4])/255});return d},i.exports.write=function(c){var a,n,o;return n=function(l){var r;return r=Math.round(l*255).toString(16),r.length===1?`0${r}`:r},o=function(l){var r,d,h,_;return{alpha:r,red:_,green:h,blue:d}=l,r==null&&(r=1),[r,_,h,d].map(n).join("")},a=`Paint.NET Palette File
Lines that start with a semicolon are comments
Colors are written as 8-digit hexadecimal numbers: aarrggbb
For example, this would specify green: FF00FF00
The alpha ('aa') value specifies how transparent a color is. FF is fully opaque, 00 is fully transparent.
A palette must consist of ninety six (96) colors. If there are less than this, the remaining color
slots will be set to white (FFFFFFFF). If there are more, then the remaining colors will be ignored.

`,c.name&&(a+=`Palette Name: ${c.name}
`),c.description&&(a+=`Description: ${c.description}
`),a+=`Colors: ${c.length}
`,c.numberOfColumns&&(a+=`Columns: ${c.numberOfColumns}
`),a=`; ${a}`.replace(/\n/g,`
; `).replace(/\s*\n/g,`
`),`${a}
${c.map(o).join(`
`)}`}},{"../Palette":37}],46:[function(e,i,s){var t;t=e("../Palette"),i.exports=function({fileContentString:c}){var a,n,o,l,r,d,h;if(r=c.split(/[\n\r]+/m),r[0]!=="JASC-PAL")throw new Error("Not a JASC-PAL");if(r[1]!=="0100")throw new Error("Unknown JASC-PAL version");for(d=new t,a=n=0,o=r.length;n<o;a=++n)l=r[a],l!==""&&a>2&&(h=l.split(" "),d.add({red:Number(h[0])/255,green:Number(h[1])/255,blue:Number(h[2])/255}));return d},i.exports.write=function(c){return`JASC-PAL
0100
${c.length}
${c.map(function(a){return`${Math.round(a.red*255)} ${Math.round(a.green*255)} ${Math.round(a.blue*255)}`}).join(`
`)}`}},{"../Palette":37}],47:[function(e,i,s){var t,c;c=e("jdataview"),t=e("../Palette"),i.exports=function({data:a}){var n,o,l,r,d,h,_,f,g,x;if(r=!0,x=new c(a,0,void 0,r),f=x.getString(4),x.getUint32(),g=x.getString(4),f!=="RIFF")throw new Error("RIFF header not found; not a RIFF PAL file");if(g!=="PAL ")throw new Error(`RIFF header says this isn't a PAL file,
more of a sort of ${(g+"").trim()} file`);if(n=x.getString(4),x.getUint32(),d=x.getUint16(),o=x.getUint16(),n!=="data")throw new Error(`Data chunk not found (...'${n}'?)`);if(d!==768)throw new Error(`Unsupported PAL file format version: 0x${d.toString(16)}`);for(h=new t,l=0,_=o;0<=_?l<_:l>_;0<=_?l++:l--)h.add({red:x.getUint8()/255,green:x.getUint8()/255,blue:x.getUint8()/255}),x.getUint8();return h},i.exports.write=function(a){var n,o,l,r,d,h,_,f;for(o=4+4*a.length,l=8+o,r=12+l,f=!0,d=new c(r,0,void 0,f),d.writeString("RIFF"),d.writeUint32(l+4),d.writeString("PAL "),d.writeString("data"),d.writeUint32(o),d.writeUint16(768),d.writeUint16(a.length),h=0,_=a.length;h<_;h++)n=a[h],d.writeUint8(Math.round(n.red*255)),d.writeUint8(Math.round(n.green*255)),d.writeUint8(Math.round(n.blue*255)),d.writeUint8(0);return d.buffer}},{"../Palette":37,jdataview:7}],48:[function(e,i,s){var t,c;t=e("../Palette"),{parse_css_hex_color:c}=e("../helpers"),i.exports=function({fileContentString:a}){var n,o,l,r,d,h,_,f,g,x,w,S,M,R,C;for(w=a.split(/[\n\r]+/m),R=new t,h={set_name:function(u){return R.name=u},add_comments:function(u){return R.description==null&&(R.description=""),R.description.length>0&&(R.description+=`
`),R.description+=u},set_columns:function(u){return R.numberOfColumns=u,R.geometrySpecifiedByFile=!0},hexcolor:function(u,m){var y;return y=c("#"+u),y.name=m,R.add(y)},rgbcolor:function(u,m,y,v){return R.add({red:u/255,green:m/255,blue:y/255,name:v})},color:function([u,m,y,v]){switch(u){case"RGB":return R.add({red:m[0],green:m[1],blue:m[2],alpha:y,name:v});case"Grayscale":return R.add({red:m[0],green:m[0],blue:m[0],alpha:y,name:v});case"CMYK":return R.add({cyan:m[0],magenta:m[1],yellow:m[2],key:m[3],alpha:y,name:v});case"HSL":return R.add({hue:m[0],saturation:m[1],lightness:m[2],alpha:y,name:v})}}},C=function(u,m){var y,v,T,k,L,A,F;for(y=[],v=0,L=function(){var K,Q;if(Q="",K=u[v],K!=="'"&&K!=='"')throw new Error("Expected to start parsing string on a quote character");for(v+=1;v<u.length;){if(u[v]==="\\")v+=1,u[v]==="\\"?Q+="\\":u[v]==="r"?Q+="\r":u[v]==="n"?Q+=`
`:u[v]==="t"?Q+="	":u[v]==="v"?Q+="\v":u[v]==="a"?Q+="a":u[v]==="b"?Q+="\b":u[v]==="'"?Q+="'":u[v]==='"'?Q+='"':u[v].match(/\d/)||u[v]==="x"||u[v]==="N"||u[v]==="u"||u[v]==="U"||(console.log(`Warning: unecessary escape in python string: \\${u[v]}`),Q+=u[v]);else{if(u[v]===K)return Q;Q+=u[v]}v+=1}throw new SyntaxError(`Expected end of string on line ${m}`)},k=function(){var K;for(K="";v<u.length&&u[v].match(/[\d\.]/);){K+=u[v];v+=1}return v-=1,parseFloat(K)},T=function(){var K,Q,Z;for(v+=1,Z=[];v<u.length;){if(u[v]==="u")if(v+=1,(K=u[v])==="'"||K==='"')Z.push(L());else throw new SyntaxError(`Unexpected 'u${u.slice(v)}' on line ${m}`);else if((Q=u[v])==="'"||Q==='"')Z.push(L());else if(u[v]==="[")Z.push(T());else if(u[v].match(/\d/))Z.push(k());else{if(u[v]==="]")return Z;if(u[v]!==","){if(u[v].match(/\S/))throw new SyntaxError(`Unexpected '${u.slice(v)}' on line ${m}`)}}v+=1}throw new SyntaxError(`Expected end of array on line ${m}`)};v<u.length;){if(u[v]==="u")if(v+=1,(A=u[v])==="'"||A==='"')y.push(L());else throw new SyntaxError(`Unexpected 'u${u.slice(v)}' on line ${m}`);else if((F=u[v])==="'"||F==='"')y.push(L());else if(u[v]==="[")y.push(T());else if(u[v].match(/\d/))y.push(k());else if(u[v]!==","){if(u[v].match(/\S/))throw new SyntaxError(`Unexpected '${u.slice(v)}' on line ${m}`)}v+=1}return y},x=_=0,f=w.length;_<f;x=++_)g=w[x],S=g.match(/([\w_]+)\((.*)\)/),S&&([n,d,l]=S,r=h[d],r&&(o=C(l,x+1),r(...o)));if(M=R.length,M<2)throw new Error(["No colors found","Only one color found"][M]+` (${M})`);return R},i.exports.write=function(a){var n,o,l,r,d,h,_,f,g,x,w,S,M,R,C;if(R=function(u){return`'${u.replace(/[\r\n]+/g," ").replace(/'/g,"\\'")}'`},C=`##sK1 palette
`,C+=`palette()
`,a.name&&(C+=`set_name(${R(a.name)})
`),a.source&&(C+=`set_source(${R(a.source)})
`),a.description)for(w=a.description.split(/\r?\n/g),d=0,f=w.length;d<f;d++)h=w[d],C+=`add_comments(${R(h)})
`;for(a.numberOfColumns&&(C+=`set_columns(${a.numberOfColumns})
`),_=0,g=a.length;_<g;_++)o=a[_],o.hue!=null?(l="HSL",r=[o.hue,o.saturation,o.lightness]):(l="RGB",r=[o.red,o.green,o.blue]),n=(S=o.alpha)!=null?S:1,x=(M=o.name)!=null?M:o.toString(),C+=`color([${R(l)}, [${r.join(", ")}], ${n}, ${R(x)}])
`;return C+=`palette_end()
`,C}},{"../Palette":37,"../helpers":56}],49:[function(e,i,s){var t;t=e("../Palette"),i.exports=function({fileContentString:c}){var a,n,o,l,r,d,h;if(r=c.split(/[\n\r]+/m),r[0]!=="##Sketch RGBPalette 0")throw new Error("Not a Skencil palette");for(d=new t,l=a=0,n=r.length;a<n;l=++a)if(o=r[l],!(o[0]==="#"||o==="")){if(h=o.match(/^\s*([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)(?:\s+(.*))?$/),!h)throw new Error(`Line ${l+1} doesn't match pattern of red green blue name`);d.add({red:Number(h[1]),green:Number(h[2]),blue:Number(h[3]),name:h[4]})}return d},i.exports.write=function(c){return`##Sketch RGBPalette 0
${c.map(function(a){var n;return`${a.red.toFixed(6)} ${a.green.toFixed(6)} ${a.blue.toFixed(6)} ${(n=a.name)!=null?n:a}`}).join(`
`)}`}},{"../Palette":37}],50:[function(e,i,s){var t,c;c=e("jdataview"),t=e("../Palette"),i.exports=function({data:a}){var n,o,l;if(o=new t,l=new c(a),l.byteLength!==768)throw new Error(`Wrong file size, must be 768 bytes long (not ${l.byteLength})`);for(var n=0;n<256;n++)o.add({red:l.getUint8()/255,green:l.getUint8()/255,blue:l.getUint8()/255});return o},i.exports.write=function(a){var n,o,l;for(l=new c(256*3),n=o=0;o<256;n=++o)l.writeUint8(a[n]?Math.round(a[n].red*255):0),l.writeUint8(a[n]?Math.round(a[n].green*255):0),l.writeUint8(a[n]?Math.round(a[n].blue*255):0);return l.buffer}},{"../Palette":37,jdataview:7}],51:[function(e,i,s){var t,c;c=e("jdataview"),t=e("../Palette"),i.exports=function({data:a}){var n,o,l;if(o=new t,l=new c(a),l.byteLength!==1024)throw new Error(`Wrong file size, must be 1024 bytes long (not ${l.byteLength})`);for(var n=0;n<256;n++)o.add({red:l.getUint8()/255,green:l.getUint8()/255,blue:l.getUint8()/255}),l.getUint8();return o.numberOfColumns=16,o},i.exports.write=function(a){var n,o,l;for(l=new c(256*4),n=o=0;o<256;n=++o)l.writeUint8(a[n]?Math.round(a[n].red*255):0),l.writeUint8(a[n]?Math.round(a[n].green*255):0),l.writeUint8(a[n]?Math.round(a[n].blue*255):0),l.writeUint8(0);return l.buffer}},{"../Palette":37,jdataview:7}],52:[function(e,i,s){var t,c,a,n;c=e("xml-js"),t=e("../Palette"),{parse_css_hex_color:a}=e("../helpers"),i.exports.read_soc=function({fileContentString:o}){var l,r,d,h,_,f,g,x,w,S,M,R,C,u;if(!o.match(/^\s*<\?\s*xml/i))throw new Error("not a StarOffice palette (no <?xml...?> declaration)");if(x=new t,w=c.xml2js(o,{compact:!1}),!((S=w.elements)!=null&&S.length))throw new Error("No XML elements found");for(M=w.elements,h=0,f=M.length;h<f;h++)if(d=M[h],(R=d.name)!=null&&R.match(/:color-table$/)&&d.elements)for(C=d.elements,_=0,g=C.length;_<g;_++)l=C[_],l.name==="draw:color"&&((u=l.attributes["draw:color"])!=null&&u.match(/#/))&&(r=a(l.attributes["draw:color"]),r.name=l.attributes["draw:name"],x.add(r));return x},n=function(o,l){var r,d,h;return d=function(_){var f;return f=Math.round(_*255).toString(16),f.length===1?`0${f}`:f},h=function(_){var f,g,x;return{red:x,green:g,blue:f}=_,"#"+[x,g,f].map(d).join("")},c.js2xml({declaration:{attributes:{version:"1.0",encoding:"UTF-8"}},elements:[{type:"element",name:l?"ooo:color-table":"office:color-table",attributes:l?{"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:svg":"http://www.w3.org/2000/svg","xmlns:ooo":"http://openoffice.org/2004/office"}:{"xmlns:form":"http://openoffice.org/2000/form","xmlns:number":"http://openoffice.org/2000/datastyle","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:office":"http://openoffice.org/2000/office","xmlns:meta":"http://openoffice.org/2000/meta","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:svg":"http://www.w3.org/2000/svg","xmlns:dr3d":"http://openoffice.org/2000/dr3d","xmlns:text":"http://openoffice.org/2000/text","xmlns:style":"http://openoffice.org/2000/style","xmlns:script":"http://openoffice.org/2000/script","xmlns:chart":"http://openoffice.org/2000/chart","xmlns:draw":"http://openoffice.org/2000/drawing","xmlns:table":"http://openoffice.org/2000/table","xmlns:fo":"http://www.w3.org/1999/XSL/Format","xmlns:config":"http://openoffice.org/2001/config","xmlns:dc":"http://purl.org/dc/elements/1.1/"},elements:function(){var _,f,g;for(g=[],_=0,f=o.length;_<f;_++)r=o[_],g.push({type:"element",name:"draw:color",attributes:{"draw:name":r.name||r.toString(),"draw:color":h(r)}});return g}()}]},{spaces:"	"})},i.exports.write_staroffice_soc=function(o){return n(o,!1)},i.exports.write_libreoffice_soc=function(o){return n(o,!0)}},{"../Palette":37,"../helpers":56,"xml-js":30}],53:[function(e,i,s){var t,c,a;t=e("../Palette"),{parse_css_hex_color:c}=e("../helpers"),a=1.4,i.exports=function({fileContentString:n}){var o,l,r,d,h,_,f,g,x,w,S;if(!n.match(/^\s*{/))throw new Error("not sketchpalette JSON");if(w=JSON.parse(n),r=w.compatibleVersion,o=(S=w.colors)!=null?S:[],x=new t,r&&r>a)throw new Error(`Can't handle compatibleVersion of ${r}.`);if(!r||r<1.4)for(h=0,f=o.length;h<f;h++)d=o[h],x.add(c(d));else if(o.length>0)for(_=0,g=o.length;_<g;_++)l=o[_],x.add(l);return x},i.exports.write=function(n){return JSON.stringify({compatibleVersion:"1.4",pluginVersion:"1.4",colors:n.map(function(o){var l,r,d,h;return{red:h,green:d,blue:r,alpha:l}=o,l==null&&(l=1),{red:h,green:d,blue:r,alpha:l}})},null,"	")},i.exports.extension="sketchpalette"},{"../Palette":37,"../helpers":56}],54:[function(e,i,s){var t;t=e("../Palette"),i.exports=function({fileContentString:c}){var a,n,o,l,r,d,h,_,f,g,x,w,S;for(h=c.split(/[\n\r]+/m),x=[a=new t,w=new t],S=function(M,R,C){var u;if(u=M.match(C),u)return R.add({red:Number(u[1])/255,green:Number(u[2])/255,blue:Number(u[3])/255})},n=0,l=h.length;n<l;n++)d=h[n],S(d,a,/([0-9]*\.?[0-9]+),\s*([0-9]*\.?[0-9]+),\s*([0-9]*\.?[0-9]+)/),S(d,w,/([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)/);for(_=[],o=0,r=x.length;o<r;o++)g=x[o],g.length>=_.length&&(_=g);if(f=_.length,f<4)throw new Error(["No colors found","Only one color found","Only a couple colors found","Only a few colors found"][f]+` (${f})`);return _.every(function(M){return M.red<=1/255&&M.green<=1/255&&M.blue<=1/255})&&_.forEach(function(M){return M.red*=255,M.green*=255,M.blue*=255}),_}},{"../Palette":37}],55:[function(e,i,s){var t,c,a;t=e("../Palette"),c=function(n){var o,l,r,d;return l={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([^=]+?)\s*=\s*(.*?)\s*$/,comment:/^\s*;.*$/},d={},o=n.split(/[\r\n]+/),r=null,o.forEach(function(h){var _;l.comment.test(h)||(l.param.test(h)?(_=h.match(l.param),r?d[r][_[1]]=_[2]:d[_[1]]=_[2]):l.section.test(h)?(_=h.match(l.section),d[_[1]]={},r=_[1]):h.length===0&&r&&(r=null))}),d},a=function(n){var o,l,r,d,h,_,f,g,x,w;if(w=c(n),o=w["Control Panel\\Colors"],!o)throw new Error("Invalid theme file, no [Control Panel\\Colors] section");g=new t;for(_ in o)if(!_.match(/\W/)&&(r=o[_].split(" "),r.length===3)){for(d=h=0,f=r.length;h<f;d=++h)l=r[d],r[d]=parseInt(l,10);r.every(function(S){return isFinite(S)})&&g.add({red:r[0]/255,green:r[1]/255,blue:r[2]/255,name:_})}return g.name=(x=w.Theme)!=null?x.DisplayName:void 0,g},i.exports=function({fileContentString:n}){return a(n)}},{"../Palette":37}],56:[function(e,i,s){i.exports.parse_css_hex_color=function(t){var c,a,n,o;return n=function(l){return parseInt(l,16)},o=t.match(/\#([0-9A-F]{3}|[0-9A-F]{6}|[0-9A-F]{4}|[0-9A-F]{8})(?![0-9A-F])/im),[c,a]=o,a.length>4?{red:n(a[0]+a[1])/255,green:n(a[2]+a[3])/255,blue:n(a[4]+a[5])/255,alpha:a.length===8?n(a[6]+a[7])/255:void 0}:{red:n(a[0]+a[0])/255,green:n(a[1]+a[1])/255,blue:n(a[2]+a[2])/255,alpha:a.length===4?n(a[3]+a[3])/255:void 0}}},{}],57:[function(e,i,s){let t,c,a,n,o,l,r,d,h,_,f,g,x=[].splice;for(n=e("./Palette"),c=e("./Color"),a=class extends Error{constructor(S){var M;super(),this.errors=S,this.message="Some errors were encountered when loading:"+(function(){var R,C,u,m;for(u=this.errors,m=[],R=0,C=u.length;R<C;R++)M=u[R],m.push(`
	`+M.message);return m}).call(this)}},r={PAINT_SHOP_PRO_PALETTE:{name:"Paint Shop Pro palette",fileExtensions:["psppalette","pal"],readFromText:e("./formats/PaintShopPro"),write:e("./formats/PaintShopPro").write},RIFF_PALETTE:{name:"RIFF PAL",fileExtensions:["pal"],read:e("./formats/RIFF"),write:e("./formats/RIFF").write},COLORSCHEMER_PALETTE:{name:"ColorSchemer palette",fileExtensions:["cs"],read:e("./formats/ColorSchemer")},PAINTDOTNET_PALETTE:{name:"Paint.NET palette",fileExtensions:["txt"],readFromText:e("./formats/Paint.NET"),write:e("./formats/Paint.NET").write},GIMP_PALETTE:{name:"GIMP palette",fileExtensions:["gpl","gimp","colors"],readFromText:e("./formats/GIMP"),write:e("./formats/GIMP").write},KDE_RGB_PALETTE:{name:"KolourPaint palette",fileExtensions:["colors"],readFromText:e("./formats/KolourPaint"),write:e("./formats/KolourPaint").write},SKENCIL_PALETTE:{name:"Skencil palette",fileExtensions:["spl"],readFromText:e("./formats/SPL"),write:e("./formats/SPL").write},SKETCH_JSON_PALETTE:{name:"Sketch palette",fileExtensions:["sketchpalette"],readFromText:e("./formats/sketchpalette"),write:e("./formats/sketchpalette").write},SK1_PALETTE:{name:"sK1 palette",fileExtensions:["skp"],readFromText:e("./formats/SKP"),write:e("./formats/SKP").write},WINDOWS_THEME_COLORS:{name:"Windows desktop theme",fileExtensions:["theme","themepack"],readFromText:e("./formats/theme")},ADOBE_SWATCH_EXCHANGE_PALETTE:{name:"Adobe Swatch Exchange",fileExtensions:["ase"],read:e("./formats/Adobe").read_adobe_swatch_exchange,write:e("./formats/Adobe").write_adobe_swatch_exchange},ADOBE_COLOR_BOOK_PALETTE:{name:"Adobe Color Book",fileExtensions:["acb"],read:e("./formats/Adobe").read_adobe_color_book},STAROFFICE_PALETTE:{name:"StarOffice Colors",fileExtensions:["soc"],readFromText:e("./formats/StarOffice").read_soc,write:e("./formats/StarOffice").write_libreoffice_soc},CSS_VARIABLES:{name:"CSS variables",fileExtensions:["css"],write:e("./formats/CSS").write_css},SCSS_VARIABLES:{name:"SCSS variables",fileExtensions:["scss"],write:e("./formats/CSS").write_scss},SASS_VARIABLES:{name:"SASS variables",fileExtensions:["sass"],write:e("./formats/CSS").write_sass},LESS_VARIABLES:{name:"LESS variables",fileExtensions:["less"],write:e("./formats/CSS").write_less},STYLUS_VARIABLES:{name:"Stylus variables",fileExtensions:["styl"],write:e("./formats/CSS").write_styl},CSS_COLORS:{name:"CSS colors",fileExtensions:["css","scss","sass","less","styl","html","htm","svg","js","ts","xml","txt"],readFromText:e("./formats/CSS")},HOMESITE_PALETTE:{name:"Homesite palette",fileExtensions:["hpl"],readFromText:e("./formats/Homesite"),write:e("./formats/Homesite").write},ADOBE_COLOR_SWATCH_PALETTE:{name:"Adobe Color Swatch",fileExtensions:["aco"],read:e("./formats/Adobe").read_adobe_color_swatch,write:e("./formats/Adobe").write_adobe_color_swatch},ADOBE_COLOR_TABLE_PALETTE:{name:"Adobe Color Table",fileExtensions:["act"],read:e("./formats/AdobeColorTable"),write:e("./formats/AdobeColorTable").write},STARCRAFT_PALETTE:{name:"StarCraft palette",fileExtensions:["pal"],read:e("./formats/StarCraft"),write:e("./formats/StarCraft").write},STARCRAFT_PADDED:{name:"StarCraft terrain palette",fileExtensions:["wpe"],read:e("./formats/StarCraftPadded"),write:e("./formats/StarCraftPadded").write},TABULAR:{name:"tabular colors",fileExtensions:["csv","tsv","txt"],readFromText:e("./formats/tabular")}},g=Object.keys(r),d=0,h=g.length;d<h;d++)l=g[d],o=r[l],o.fileExtensionsPretty=`.${o.fileExtensions.join(", .")}`;f=function(w,S){var M,R,C,u,m,y,v,T,k,L,A,F;for(w.fileContentString=typeof w.data=="string"?w.data:new TextDecoder().decode(w.data),k={},F=Object.keys(r),m=0,y=F.length;m<y;m++)l=F[m],r[l].fileExtensions.indexOf(w.fileExt)>-1&&(k[l]=!0);for(u=Object.keys(r),u.sort(function(K,Q){return(k[Q]!=null)-(k[K]!=null)}),C=[],T=0,v=u.length;T<v;T++)if(l=u[T],o=r[l],!!(o.read||o.readFromText)){try{if(o.readFromText?A=o.readFromText(w):A=o.read(w),A.length===0)throw A=null,new Error("no colors returned")}catch(K){M=K,L=`failed to load ${w.fileName} as ${o.name}: ${M.message}`,R=new Error(L),R.error=M,R.__PATCHED_LIB_TO_ADD_THIS__format=o,C.push(R)}if(A){A.confidence=k[l]!=null?.9:.01,S(null,A,o,k[l]!=null,{__errors_before_success:C});return}}S(new a(C))},_=function(w={}){var S,M;return(typeof w=="string"||w instanceof String)&&(w={filePath:w}),typeof File<"u"&&File!==null&&w instanceof File&&(w={file:w}),w.fileName==null&&(w.fileName=(S=(M=w.file)!=null?M.name:void 0)!=null?S:w.filePath?e("path").basename(w.filePath):void 0),w.fileExt==null&&(w.fileExt=`${w.fileName}`.split(".").pop()),w.fileExt=`${w.fileExt}`.toLowerCase(),w},t={Color:c,Palette:n,formats:r},t.loadPalette=function(w,S){var M,R;if(!w)throw new TypeError("parameters required: AnyPalette.loadPalette(options, function callback(error, palette){})");if(!S)throw new TypeError("callback required: AnyPalette.loadPalette(options, function callback(error, palette){})");if(w=_(w),w.data)return f(w,S);if(w.file){if(!(w.file instanceof File))throw new TypeError("options.file was passed but it is not a File");return M=new FileReader,M.onerror=function(){return S(M.error)},M.onload=function(){return w.data=M.result,f(w,S)},M.readAsArrayBuffer(w.file)}else{if(w.filePath!=null)return R=e("fs"),R.readFile(w.filePath,function(C,u){return C?S(C):(w.data=u,f(w,S))});throw new TypeError("either options.data or options.file or options.filePath must be passed")}},t.writePalette=function(w,S){return S==null&&(S=t.formats.GIMP_PALETTE),S.write(w)},t.uniqueColors=function(w,S){var M,R,C,u,m;for(m=new n,m.name=this.name,m.description=this.description,x.apply(m,[0,9e9].concat(w.slice(0))),M=0;M<m.length;){for(R=m[M],C=M+1;C<m.length;)u=m[C],c.is(R,u,S)&&(m.splice(C,1),C-=1),C+=1;M+=1}return m}},{"./Color":36,"./Palette":37,"./formats/Adobe":38,"./formats/AdobeColorTable":39,"./formats/CSS":40,"./formats/ColorSchemer":41,"./formats/GIMP":42,"./formats/Homesite":43,"./formats/KolourPaint":44,"./formats/Paint.NET":45,"./formats/PaintShopPro":46,"./formats/RIFF":47,"./formats/SKP":48,"./formats/SPL":49,"./formats/StarCraft":50,"./formats/StarCraftPadded":51,"./formats/StarOffice":52,"./formats/sketchpalette":53,"./formats/tabular":54,"./formats/theme":55,fs:"fs",path:"path"}]},{},[57])(57)});const AnyPalette$1=AnyPalette;console.log("JS 실행:","OnCanvasObject.js");class OnCanvasObject{constructor(i,s,t,c,a){this.x=i,this.y=s,this.width=t,this.height=c,this.hideMainCanvasHandles=a,this.$el=$(E("div")).addClass("on-canvas-object").appendTo($canvas_area),this.hideMainCanvasHandles&&canvas_handles.hide(),$G$1.on("resize theme-load",this._global_resize_handler=()=>{this.position()})}position(i){const s=parseFloat($canvas_area.css("padding-left")),t=parseFloat($canvas_area.css("padding-top"));this.$el.css({position:"absolute",left:magnification*this.x+s,top:magnification*this.y+t,width:magnification*this.width,height:magnification*this.height}),i&&($status_position.text(`${this.x}, ${this.y}px`),$status_size.text(`${this.width} x ${this.height}px`))}destroy(){this.$el.remove(),this.hideMainCanvasHandles&&canvas_handles.show(),$G$1.off("resize theme-load",this._global_resize_handler)}}console.log("JS 실행:","OnCanvasHelpLayer.js");class OnCanvasHelperLayer extends OnCanvasObject{constructor(i,s,t,c,a,n=1){super(i,s,t,c,a),this.$el.addClass("helper-layer"),this.$el.css({pointerEvents:"none"}),this.position(),this.canvas=make_canvas(this.width*n,this.height*n),this.$el.append(this.canvas)}}console.log("JS 실행:","Hendles.js");function Handles(e){const{$handles_container:i,$object_container:s}=e,t=e.outset||0,c=e.get_handles_offset_left||(()=>0),a=e.get_handles_offset_top||(()=>0),n=e.get_ghost_offset_left||(()=>0),o=e.get_ghost_offset_top||(()=>0),l=e.size_only||!1,r=0,d=-1,h=1,_=d,f=h,g=d,x=h,w=$(E("div")).addClass("resize-ghost");e.thick&&w.addClass("thick");const S=[];[[g,f],[g,r],[g,_],[r,_],[x,_],[x,r],[x,f],[r,f]].forEach(([M,R])=>{const C=$(E("div")).addClass("handle");C.appendTo(i);const u=$(E("div")).addClass("grab-region").appendTo(i);(M===r||R===r)&&u.addClass("is-middle"),C.css("touch-action","none");let m,y=!1;const v=M!==r,T=R!==r;if(l&&(M===g||R===_))C.addClass("useless-handle"),u.remove();else{let L;R===_&&M===g||R===f&&M===x?L="nwse-resize":R===f&&M===g||R===_&&M===x?L="nesw-resize":T?L="ew-resize":v&&(L="ns-resize");let A="";M===g&&(A+="n"),M===x&&(A+="s"),R===_&&(A+="w"),R===f&&(A+="e"),A+="-resize";const F=make_css_cursor(L,[16,16],A);C.add(u).css({cursor:F});const K=Q=>{w.appendTo(s),y=!0,m=e.get_rect();const Z=to_canvas_coords(Q);let B=0,z=0,b,N;R===f?(B=0,b=~~(Z.x-m.x)):R===_?(B=~~(Z.x-m.x),b=~~(m.x+m.width-Z.x)):b=~~m.width,M===x?(z=0,N=~~(Z.y-m.y)):M===g?(z=~~(Z.y-m.y),N=~~(m.y+m.height-Z.y)):N=~~m.height;let U={x:m.x+B,y:m.y+z,width:b,height:N};U.width=Math.max(1,U.width),U.height=Math.max(1,U.height),e.constrain_rect?U=e.constrain_rect(U,R,M):(U.x=Math.min(U.x,m.x+m.width),U.y=Math.min(U.y,m.y+m.height)),w.css({position:"absolute",left:magnification*U.x+n(),top:magnification*U.y+o(),width:magnification*U.width-2,height:magnification*U.height-2}),m=U};C.add(u).on("pointerdown",Q=>{y=!1,Q.button===0&&($G$1.on("pointermove",K),$("body").css({cursor:F}).addClass("cursor-bully")),$G$1.one("pointerup",()=>{$G$1.off("pointermove",K),$("body").css({cursor:""}).removeClass("cursor-bully"),w.remove(),y&&e.set_rect(m),i.trigger("update")})}),C.on("mousedown selectstart",Q=>{Q.preventDefault()})}const k=()=>{const L=e.get_rect(),A=C.width(),F=c(),K=a(),Q=32;for(const{len_key:Z,pos_key:B,region:z,offset:b}of[{len_key:"width",pos_key:"left",region:R,offset:F},{len_key:"height",pos_key:"top",region:M,offset:K}]){let N=Math.max(L[Z]*magnification/2-Q/2,Math.min(Q/2,L[Z]*magnification/3)),U=L[Z]*magnification-N;U-N<magnification&&(N=0,U=magnification);const q=-Q/2,j=Math.min(Q/2,N),Y=L[Z]*magnification-j,J=L[Z]*magnification-q;l&&(N=Math.max(-b,Math.min(N,U-Q))),z===d?(C.css({[B]:b-t}),u.css({[B]:b+q,[Z]:j-q})):z===r?(C.css({[B]:b+(L[Z]*magnification-A)/2}),u.css({[B]:b+N,[Z]:U-N})):z===h&&(C.css({[B]:b+(L[Z]*magnification-A/2)}),u.css({[B]:b+Y,[Z]:J-Y}))}};i.on("update resize scroll",k),$G$1.on("resize theme-load",k),setTimeout(k,50),S.push(C[0],u[0])}),this.handles=S,this.hide=()=>{$(S).css({opacity:0,pointerEvents:"none"})},this.show=()=>{$(S).css({opacity:"",pointerEvents:""})}}console.log("JS 실행:","image-manipulation.js");const fill_threshold=1;function get_brush_canvas_size(e,i){return Math.ceil(e*(i==="circle"?2.1:1)/2)*2}function render_brush(e,i,s){i.match(/diagonal/)&&(s-=.4);const t=Math.round(e.canvas.width/2),c=Math.round(t-s/2),a=Math.round(t+s/2),n=Math.round(e.canvas.height/2),o=Math.round(n-s/2),l=Math.round(n+s/2);i==="circle"?draw_ellipse(e,c,o,s,s,!1,!0):i==="square"?e.fillRect(c,o,~~s,~~s):i==="diagonal"?draw_line_without_pattern_support(e,c,o,a,l):i==="reverse_diagonal"?draw_line_without_pattern_support(e,c,l,a,o):i==="horizontal"?draw_line_without_pattern_support(e,c,n,s,n):i==="vertical"&&draw_line_without_pattern_support(e,t,o,t,s)}function draw_ellipse(e,i,s,t,c,a,n){const o=i+t/2,l=s+c/2;if(aliasing){const r=[];for(let h=0;h<TAU;h+=.05)r.push({x:o+Math.cos(h)*t/2,y:l+Math.sin(h)*c/2});draw_polygon(e,r,a,n)}else e.beginPath(),e.ellipse(o,l,Math.abs(t/2),Math.abs(c/2),0,0,TAU,!1),e.stroke(),e.fill()}function draw_rounded_rectangle(e,i,s,t,c,a,n,o,l){if(aliasing){const r=[],d=(g,x)=>{r.push({x:g,y:x})},h=(g,x,w,S,M,R)=>{for(let u=M;u<R;u+=.05)r.push({x:g+Math.cos(u)*w,y:x+Math.sin(u)*S});r.push({x:g+Math.cos(R)*w,y:x+Math.sin(R)*S})},_=i+t,f=s+c;h(_-a,s+n,a,n,TAU*3/4,TAU),d(_,f-n),h(_-a,f-n,a,n,0,TAU*1/4),d(i+a,f),h(i+a,f-n,a,n,TAU*1/4,TAU*1/2),d(i,s+n),h(i+a,s+n,a,n,TAU/2,TAU*3/4),draw_polygon(e,r,o,l)}else e.beginPath(),e.moveTo(i+a,s),e.lineTo(i+t-a,s),e.quadraticCurveTo(i+t,s,i+t,s+n),e.lineTo(i+t,s+c-n),e.quadraticCurveTo(i+t,s+c,i+t-a,s+c),e.lineTo(i+a,s+c),e.quadraticCurveTo(i,s+c,i,s+c-n),e.lineTo(i,s+n),e.quadraticCurveTo(i,s,i+a,s),e.closePath(),o&&e.stroke(),l&&e.fill()}const get_brush_canvas_implementation=(e,i)=>{const s=get_brush_canvas_size(i,e),t=make_canvas(s,s);return render_brush(t.ctx,e,i),t},get_brush_canvas=memoize_synchronous_function(get_brush_canvas_implementation,20);$G$1.on("invalidate-brush-canvases",()=>{get_brush_canvas.clear_memo_cache()});const stamp_brush_canvas=(e,i,s,t,c)=>{const a=get_brush_canvas(t,c),n=-Math.ceil(a.width/2),o=-Math.ceil(a.height/2);e.drawImage(a,i+n,s+o)},get_circumference_points_for_brush_implementation=(e,i)=>{const s=get_brush_canvas(e,i),t=s.ctx.getImageData(0,0,s.width,s.height),c=(l,r)=>l>=0&&r>=0&&l<t.width&&r<t.height&&t.data[(r*t.width+l)*4+3]>127,a=-Math.ceil(s.width/2),n=-Math.ceil(s.height/2),o=[];for(let l=0;l<t.width;l+=1)for(let r=0;r<t.height;r+=1)c(l,r)&&(!c(l,r-1)||!c(l,r+1)||!c(l-1,r)||!c(l+1,r))&&o.push({x:l+a,y:r+n});return o},get_circumference_points_for_brush=memoize_synchronous_function(get_circumference_points_for_brush_implementation);$G$1.on("invalidate-brush-canvases",()=>{get_circumference_points_for_brush.clear_memo_cache()});let line_brush_canvas;function update_brush_for_drawing_lines(e){aliasing&&e>1&&(line_brush_canvas=get_brush_canvas("circle",e))}function draw_line_without_pattern_support(e,i,s,t,c,a=1){aliasing?a>1?bresenham_line(i,s,t,c,(n,o)=>{e.drawImage(line_brush_canvas,~~(n-line_brush_canvas.width/2),~~(o-line_brush_canvas.height/2))}):bresenham_line(i,s,t,c,(n,o)=>{e.fillRect(n,o,1,1)}):(e.beginPath(),e.moveTo(i,s),e.lineTo(t,c),e.lineWidth=a,e.lineCap="round",e.stroke(),e.lineCap="butt")}function bresenham_line(e,i,s,t,c){e=~~e,s=~~s,i=~~i,t=~~t;const a=Math.abs(s-e),n=Math.abs(t-i),o=e<s?1:-1,l=i<t?1:-1;let r=a-n;for(;c(e,i),!(e===s&&i===t);){const d=r*2;d>-n&&(r-=n,e+=o),d<a&&(r+=a,i+=l)}}function bresenham_dense_line(e,i,s,t,c){e=~~e,s=~~s,i=~~i,t=~~t;const a=Math.abs(s-e),n=Math.abs(t-i),o=e<s?1:-1,l=i<t?1:-1;let r=a-n;for(;c(e,i),!(e===s&&i===t);){const d=r*2;d>-n&&(r-=n,e+=o),c(e,i),d<a&&(r+=a,i+=l)}}function draw_fill_without_pattern_support(e,i,s,t,c,a,n){const o=main_canvas.width,l=main_canvas.height;i=Math.max(0,Math.min(Math.floor(i),o)),s=Math.max(0,Math.min(Math.floor(s),l));const r=[[i,s]],d=e.getImageData(0,0,o,l);let h=(s*o+i)*4;const _=d.data[h+0],f=d.data[h+1],g=d.data[h+2],x=d.data[h+3];if(Math.abs(t-_)<=fill_threshold&&Math.abs(c-f)<=fill_threshold&&Math.abs(a-g)<=fill_threshold&&Math.abs(n-x)<=fill_threshold)return;for(;r.length;){let M,R,C,u,m;for(M=r.pop(),R=M[0],C=M[1],h=(C*o+R)*4;w(h);)C--,h=(C*o+R)*4;for(u=!1,m=!1;C++,h=(C*o+R)*4,!!(C<l&&w(h));)S(h),R>0&&(w(h-4)?u||(r.push([R-1,C]),u=!0):u&&(u=!1)),R<o-1&&(w(h+4)?m||(r.push([R+1,C]),m=!0):m&&(m=!1)),h+=o*4}e.putImageData(d,0,0);function w(M){return Math.abs(d.data[M+0]-_)<=fill_threshold&&Math.abs(d.data[M+1]-f)<=fill_threshold&&Math.abs(d.data[M+2]-g)<=fill_threshold&&Math.abs(d.data[M+3]-x)<=fill_threshold}function S(M){d.data[M+0]=t,d.data[M+1]=c,d.data[M+2]=a,d.data[M+3]=n}}function draw_fill(e,i,s,t){if(typeof t=="string"){const c=get_rgba_from_color(t);draw_fill_without_pattern_support(e,i,s,c[0],c[1],c[2],c[3])}else{const c=e.canvas,a=make_canvas(c.width,c.height);draw_fill_separately(e,a.ctx,i,s,255,255,255,255),replace_colors_with_swatch(a.ctx,t,0,0),e.drawImage(a,0,0)}}function draw_fill_separately(e,i,s,t,c,a,n,o){const l=main_canvas.width,r=main_canvas.height;s=Math.max(0,Math.min(Math.floor(s),l)),t=Math.max(0,Math.min(Math.floor(t),r));const d=[[s,t]],h=e.getImageData(0,0,l,r),_=i.getImageData(0,0,l,r);let f=(t*l+s)*4;const g=h.data[f+0],x=h.data[f+1],w=h.data[f+2],S=h.data[f+3];for(;d.length;){let C,u,m,y,v;for(C=d.pop(),u=C[0],m=C[1],f=(m*l+u)*4;M(f);)m--,f=(m*l+u)*4;for(y=!1,v=!1;m++,f=(m*l+u)*4,!!(m<r&&M(f));)R(f),u>0&&(M(f-4)?y||(d.push([u-1,m]),y=!0):y&&(y=!1)),u<l-1&&(M(f+4)?v||(d.push([u+1,m]),v=!0):v&&(v=!1)),f+=l*4}i.putImageData(_,0,0);function M(C){return _.data[C+3]===0&&Math.abs(h.data[C+0]-g)<=fill_threshold&&Math.abs(h.data[C+1]-x)<=fill_threshold&&Math.abs(h.data[C+2]-w)<=fill_threshold&&Math.abs(h.data[C+3]-S)<=fill_threshold}function R(C){_.data[C+0]=c,_.data[C+1]=a,_.data[C+2]=n,_.data[C+3]=o}}function replace_color_globally(e,i,s,t,c,a,n,o,l){if(i===a&&s===n&&t===o&&c===l)return;const{data:r}=e;for(let d=0;d<r.length;d+=4)Math.abs(r[d+0]-i)<=fill_threshold&&Math.abs(r[d+1]-s)<=fill_threshold&&Math.abs(r[d+2]-t)<=fill_threshold&&Math.abs(r[d+3]-c)<=fill_threshold&&(r[d+0]=a,r[d+1]=n,r[d+2]=o,r[d+3]=l)}function find_color_globally(e,i,s,t,c,a){const n=e.data,o=i.data;for(let l=0;l<n.length;l+=4)Math.abs(n[l+0]-s)<=fill_threshold&&Math.abs(n[l+1]-t)<=fill_threshold&&Math.abs(n[l+2]-c)<=fill_threshold&&Math.abs(n[l+3]-a)<=fill_threshold&&(o[l+0]=255,o[l+1]=255,o[l+2]=255,o[l+3]=255)}function draw_noncontiguous_fill_without_pattern_support(e,i,s,t,c,a,n){i=Math.max(0,Math.min(Math.floor(i),e.canvas.width)),s=Math.max(0,Math.min(Math.floor(s),e.canvas.height));const o=e.getImageData(0,0,e.canvas.width,e.canvas.height),l=(s*o.width+i)*4,r=o.data[l+0],d=o.data[l+1],h=o.data[l+2],_=o.data[l+3];replace_color_globally(o,r,d,h,_,t,c,a,n),e.putImageData(o,0,0)}function draw_noncontiguous_fill(e,i,s,t){if(typeof t=="string"){const c=get_rgba_from_color(t);draw_noncontiguous_fill_without_pattern_support(e,i,s,c[0],c[1],c[2],c[3])}else{const c=e.canvas,a=make_canvas(c.width,c.height);draw_noncontiguous_fill_separately(e,a.ctx,i,s),replace_colors_with_swatch(a.ctx,t,0,0),e.drawImage(a,0,0)}}function draw_noncontiguous_fill_separately(e,i,s,t){s=Math.max(0,Math.min(Math.floor(s),e.canvas.width)),t=Math.max(0,Math.min(Math.floor(t),e.canvas.height));const c=e.getImageData(0,0,e.canvas.width,e.canvas.height),a=i.getImageData(0,0,i.canvas.width,i.canvas.height),n=(t*c.width+s)*4,o=c.data[n+0],l=c.data[n+1],r=c.data[n+2],d=c.data[n+3];find_color_globally(c,a,o,l,r,d),i.putImageData(a,0,0)}function apply_image_transformation(e,i){const s=selection?selection.source_canvas:main_canvas,t=make_canvas(s.width,s.height),c=s.ctx,a=t.ctx;i(s,c,t,a),selection?undoable({name:`${e.name} (${localize("Selection")})`,icon:e.icon,soft:!0},()=>{selection.replace_source_canvas(t)}):(deselect(),cancel(),undoable({name:e.name,icon:e.icon},()=>{saved=!1,update_title(),main_ctx.copy(t),$canvas_area.trigger("resize")}))}function flip_horizontal(){apply_image_transformation({name:localize("Flip horizontal"),icon:get_help_folder_icon("p_fliph.png")},(e,i,s,t)=>{t.translate(s.width,0),t.scale(-1,1),t.drawImage(e,0,0)})}function flip_vertical(){apply_image_transformation({name:localize("Flip vertical"),icon:get_help_folder_icon("p_flipv.png")},(e,i,s,t)=>{t.translate(0,s.height),t.scale(1,-1),t.drawImage(e,0,0)})}function rotate(e){apply_image_transformation({name:`${localize("Rotate by angle")} ${e/TAU*360} ${localize("Degrees")}`,icon:get_help_folder_icon(`p_rotate_${e>=0?"cw":"ccw"}.png`)},(i,s,t,c)=>{switch(c.save(),e){case TAU/4:case TAU*-3/4:t.width=i.height,t.height=i.width,c.disable_image_smoothing(),c.translate(t.width,0),c.rotate(TAU/4);break;case TAU/2:case TAU/-2:c.translate(t.width,t.height),c.rotate(TAU/2);break;case TAU*3/4:case TAU/-4:t.width=i.height,t.height=i.width,c.disable_image_smoothing(),c.translate(0,t.height),c.rotate(TAU/-4);break;default:{const a=i.width,n=i.height;let o=1/0,l=-1/0,r=1/0,d=-1/0;const h=(w,S)=>{const M=Math.sin(-e)*n*w+Math.cos(+e)*a*S,R=Math.sin(+e)*a*S+Math.cos(-e)*n*w;o=Math.min(o,M),l=Math.max(l,M),r=Math.min(r,R),d=Math.max(d,R)};h(0,0),h(0,1),h(1,0),h(1,1);const _=o,f=r,g=l-o,x=d-r;t.width=g,t.height=x,c.disable_image_smoothing(),transparency||(c.fillStyle=selected_colors.background,c.fillRect(0,0,t.width,t.height)),c.translate(-_,-f),c.rotate(e),c.drawImage(i,0,0,a,n);break}}c.drawImage(i,0,0),c.restore()})}function stretch_and_skew(e,i,s,t){apply_image_transformation({name:s!==0||t!==0?e!==1||i!==1?localize("Stretch and Skew"):localize("Skew"):localize("Stretch"),icon:get_help_folder_icon(s!==0?"p_skew_h.png":t!==0?"p_skew_v.png":i!==1?e!==1?"p_stretch_both.png":"p_stretch_v.png":"p_stretch_h.png")},(c,a,n,o)=>{const l=c.width*e,r=c.height*i;let d=1/0,h=-1/0,_=1/0,f=-1/0;const g=(R,C)=>{const u=Math.tan(s)*r*R+l*C,m=Math.tan(t)*l*C+r*R;d=Math.min(d,u),h=Math.max(h,u),_=Math.min(_,m),f=Math.max(f,m)};g(0,0),g(0,1),g(1,0),g(1,1);const x=d,w=_,S=h-d,M=f-_;n.width=Math.max(1,S),n.height=Math.max(1,M),o.disable_image_smoothing(),transparency||(o.fillStyle=selected_colors.background,o.fillRect(0,0,n.width,n.height)),o.save(),o.transform(1,Math.tan(t),Math.tan(s),1,-x,-w),o.drawImage(c,0,0,l,r),o.restore()})}function invert_rgb(e,i=e){const s=e.getImageData(0,0,e.canvas.width,e.canvas.height);for(let t=0;t<s.data.length;t+=4)s.data[t+0]=255-s.data[t+0],s.data[t+1]=255-s.data[t+1],s.data[t+2]=255-s.data[t+2];i.putImageData(s,0,0)}function replace_colors_with_swatch(e,i,s=0,t=0){e.globalCompositeOperation="source-in",e.fillStyle=i,e.beginPath(),e.rect(0,0,e.canvas.width,e.canvas.height),e.save(),e.translate(-s,-t),e.fill(),e.restore()}function compute_bezier(e,i,s,t,c,a,n,o,l){const r=1-e,d=r*r,h=e*e;let _,f,g,x=0;return _=d*r,f=d*e*3,g=r*h*3,x=e*h,{x:_*i+f*t+g*a+x*o,y:_*s+f*c+g*n+x*l}}function draw_bezier_curve_without_pattern_support(e,i,s,t,c,a,n,o,l,r){let h={x:i,y:s};for(let _=0;_<1;_+=1/100){const f=compute_bezier(_,i,s,t,c,a,n,o,l);draw_line_without_pattern_support(e,h.x,h.y,f.x,f.y,r),h=f}}function draw_quadratic_curve(e,i,s,t,c,a,n,o){draw_bezier_curve(e,i,s,t,c,t,c,a,n,o)}function draw_bezier_curve(e,i,s,t,c,a,n,o,l,r){const d=Math.min(i,t,a,o),h=Math.min(s,c,n,l),_=Math.max(i,t,a,o),f=Math.max(s,c,n,l);draw_with_swatch(e,d,h,_,f,stroke_color,g=>{draw_bezier_curve_without_pattern_support(g,i,s,t,c,a,n,o,l,r)})}function draw_line(e,i,s,t,c,a){const n=Math.min(i,t),o=Math.min(s,c),l=Math.max(i,t),r=Math.max(s,c);draw_with_swatch(e,n,o,l,r,stroke_color,d=>{draw_line_without_pattern_support(d,i,s,t,c,a)})}let grid_pattern,grid_pattern_size=-1;function draw_grid(e,i){const s=Math.floor(i);if(!grid_pattern||grid_pattern_size!==s){grid_pattern_size=s;const t=make_canvas(s,s),c="#808080",a="#c0c0c0";t.ctx.fillStyle=c,t.ctx.fillRect(0,0,1,s),t.ctx.fillStyle=c,t.ctx.fillRect(0,0,s,1),t.ctx.fillStyle=a;for(let n=1;n<s;n+=2)t.ctx.fillRect(n,0,1,1),t.ctx.fillRect(0,n,1,1);grid_pattern=e.createPattern(t,"repeat")}e.save(),e.rect(0,0,e.canvas.width,e.canvas.height),i!==s&&e.translate(-.5,-.75),e.scale(i/s,i/s),e.enable_image_smoothing(),e.fillStyle=grid_pattern,e.fill(),e.restore()}const svg_for_creating_matrices=document.createElementNS("http://www.w3.org/2000/svg","svg"),horizontal_pattern_canvas=make_canvas(8,4),vertical_pattern_canvas=make_canvas(4,8);let horizontal_pattern,vertical_pattern;function draw_dashes(e,i,s,t,c,a,n,o){vertical_pattern||(horizontal_pattern_canvas.ctx.fillStyle="white",horizontal_pattern_canvas.ctx.fillRect(4,0,4,4),vertical_pattern_canvas.ctx.fillStyle="white",vertical_pattern_canvas.ctx.fillRect(0,4,4,4),horizontal_pattern=e.createPattern(horizontal_pattern_canvas,"repeat"),vertical_pattern=e.createPattern(vertical_pattern_canvas,"repeat"));const l=1,r=1/a;if(e.save(),e.scale(a,a),e.translate(n,o),e.translate(i,s),e.globalCompositeOperation="difference",t>0){const d=svg_for_creating_matrices.createSVGMatrix();horizontal_pattern.setTransform&&horizontal_pattern.setTransform(d.translate(-i,-s).translate(r,0).scale(1/a)),e.fillStyle=horizontal_pattern,e.fillRect(0,0,t,l)}else if(c>0){const d=svg_for_creating_matrices.createSVGMatrix();vertical_pattern.setTransform&&vertical_pattern.setTransform(d.translate(-i,-s).translate(0,r).scale(1/a)),e.fillStyle=vertical_pattern,e.fillRect(0,0,l,c)}e.restore()}function draw_selection_box(e,i,s,t,c,a,n,o){draw_dashes(e,i,s,t-1,0,a,n,o),c===1?draw_dashes(e,i,s,0,1,a,n,o):draw_dashes(e,i,s+1,0,c-2,a,n,o),draw_dashes(e,i+t-1,s,0,c,a,n,o),draw_dashes(e,i,s+c-1,t-1,0,a,n,o),draw_dashes(e,i,s+1,0,1,a,n,o)}let tessy,gl,positionLoc,op_canvas_webgl,op_canvas_2d,op_ctx_2d;function initTesselator(){function e(n,o){o[o.length]=n[0],o[o.length]=n[1]}function i(n){var o;n!==libtess.primitiveType.GL_TRIANGLES&&((o=window.console)==null||o.log(`Expected TRIANGLES but got type: ${n}`))}function s(n){var o,l;(o=window.console)==null||o.log("error callback"),(l=window.console)==null||l.log(`error number: ${n}`)}function t(n,o,l){return[n[0],n[1],n[2]]}function c(n){}const a=new libtess.GluTesselator;return a.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA,e),a.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN,i),a.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR,s),a.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE,t),a.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG,c),a}function triangulate(e){tessy.gluTessNormal(0,0,1);const i=[];tessy.gluTessBeginPolygon(i);for(let s=0;s<e.length;s++){tessy.gluTessBeginContour();const t=e[s];for(let c=0;c<t.length;c+=2){const a=[t[c],t[c+1],0];tessy.gluTessVertex(a,a)}tessy.gluTessEndContour()}return tessy.gluTessEndPolygon(),i}function initWebGL(e){try{gl=e.getContext("webgl",{antialias:!1})}catch(s){show_error_message$1("Failed to get WebGL context. You may need to refresh the web page, or restart your computer.",s);return}if(!gl){show_error_message$1("Failed to get WebGL context. You may need to refresh the web page, or restart your computer.");return}window.WEBGL_lose_context=gl.getExtension("WEBGL_lose_context");const i=createShaderProgram();positionLoc=gl.getAttribLocation(i,"position"),gl.enableVertexAttribArray(positionLoc)}function initArrayBuffer(e){const i=new Float32Array(e),s=gl.createBuffer();return gl.bindBuffer(gl.ARRAY_BUFFER,s),gl.bufferData(gl.ARRAY_BUFFER,i,gl.STATIC_DRAW),gl.vertexAttribPointer(positionLoc,2,gl.FLOAT,!1,0,0),e.length/2}function createShaderProgram(){var a,n;const e=["attribute vec4 position;","void main() {","	/* already in normalized coordinates, so just pass through */","	gl_Position = position;","}"].join(""),i=gl.createShader(gl.VERTEX_SHADER);gl.shaderSource(i,e),gl.compileShader(i),gl.getShaderParameter(i,gl.COMPILE_STATUS)||(a=window.console)==null||a.log(`Vertex shader failed to compile. Log: ${gl.getShaderInfoLog(i)}`);const s=["precision mediump float;","void main() {","	gl_FragColor = vec4(0, 0, 0, 1);","}"].join(""),t=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(t,s),gl.compileShader(t),gl.getShaderParameter(t,gl.COMPILE_STATUS)||(n=window.console)==null||n.log(`Fragment shader failed to compile. Log: ${gl.getShaderInfoLog(t)}`);const c=gl.createProgram();return gl.attachShader(c,i),gl.attachShader(c,t),gl.linkProgram(c),gl.useProgram(c),c}function init_webgl_stuff(){tessy=initTesselator(),op_canvas_webgl=document.createElement("canvas"),op_canvas_2d=document.createElement("canvas"),op_ctx_2d=op_canvas_2d.getContext("2d"),initWebGL(op_canvas_webgl);let e;op_canvas_webgl.addEventListener("webglcontextlost",i=>{var s;i.preventDefault(),(s=window.console)==null||s.warn("WebGL context lost"),clamp_brush_sizes(),e=setTimeout(()=>{show_error_message$1("The WebGL context was lost. You may need to refresh the web page, or restart your computer.")},3e3)},!1),op_canvas_webgl.addEventListener("webglcontextrestored",()=>{var i;initWebGL(op_canvas_webgl),(i=window.console)==null||i.warn("WebGL context restored"),clearTimeout(e),clamp_brush_sizes(),$G$1.triggerHandler("invalidate-brush-canvases"),$G$1.triggerHandler("redraw-tool-options-because-webglcontextrestored")},!1)}function clamp_brush_sizes(){brush_size>100&&(brush_size=100,show_error_message$1("Brush size clamped to 100")),pencil_size>100&&(pencil_size=100,show_error_message$1("Pencil size clamped to 100")),stroke_size>100&&(stroke_size=100,show_error_message$1("Stroke size clamped to 100"))}function draw_line_strip(e,i){draw_polygon_or_line_strip(e,i,!0,!1,!1)}function draw_polygon(e,i,s,t){draw_polygon_or_line_strip(e,i,s,t,!0)}function draw_polygon_or_line_strip(e,i,s,t,c){if(!gl){show_error_message$1("Failed to get WebGL context. You may need to refresh the web page, or restart your computer.");return}s&&stroke_size>1&&update_brush_for_drawing_lines(stroke_size);const a=e.strokeStyle,n=e.fillStyle,o=i.length,l=o*2;if(o===0)return;let r=1/0,d=-1/0,h=1/0,_=-1/0;for(const{x:g,y:x}of i)r=Math.min(g,r),d=Math.max(g,d),h=Math.min(x,h),_=Math.max(x,_);d+=1,_+=1,r-=1,h-=1,op_canvas_webgl.width=d-r,op_canvas_webgl.height=_-h,gl.viewport(0,0,op_canvas_webgl.width,op_canvas_webgl.height);const f=new Float32Array(l);for(let g=0;g<o;g++)f[g*2+0]=(i[g].x-r)/op_canvas_webgl.width*2-1,f[g*2+1]=1-(i[g].y-h)/op_canvas_webgl.height*2;if(t){const x=triangulate([f]);let w=initArrayBuffer(x);gl.clear(gl.COLOR_BUFFER_BIT),gl.drawArrays(gl.TRIANGLES,0,w),op_canvas_2d.width=op_canvas_webgl.width,op_canvas_2d.height=op_canvas_webgl.height,op_ctx_2d.drawImage(op_canvas_webgl,0,0),replace_colors_with_swatch(op_ctx_2d,n,r,h),e.drawImage(op_canvas_2d,r,h)}if(s)if(stroke_size>1){const g=~~(stroke_size*1.1),x=r-g,w=h-g;op_canvas_2d.width=d-r+g*2,op_canvas_2d.height=_-h+g*2;for(let S=0;S<o-(c?0:1);S++){const M=i[S],R=i[(S+1)%o];draw_line_without_pattern_support(op_ctx_2d,M.x-x,M.y-w,R.x-x,R.y-w,stroke_size)}replace_colors_with_swatch(op_ctx_2d,a,x,w),e.drawImage(op_canvas_2d,x,w)}else{let g=initArrayBuffer(f);gl.clear(gl.COLOR_BUFFER_BIT),gl.drawArrays(c?gl.LINE_LOOP:gl.LINE_STRIP,0,g),op_canvas_2d.width=op_canvas_webgl.width,op_canvas_2d.height=op_canvas_webgl.height,op_ctx_2d.drawImage(op_canvas_webgl,0,0),replace_colors_with_swatch(op_ctx_2d,a,r,h),e.drawImage(op_canvas_2d,r,h)}}function copy_contents_within_polygon(e,i,s,t,c,a){c=Math.max(c,s+1),a=Math.max(a,t+1);const n=c-s,o=a-t,l=make_canvas(e);l.ctx.save(),l.ctx.globalCompositeOperation="destination-in",draw_polygon(l.ctx,i,!1,!0),l.ctx.restore();const r=make_canvas(n,o);return r.ctx.drawImage(l,s,t,n,o,0,0,n,o),r}function draw_with_swatch(e,i,s,t,c,a,n){const o=~~(stroke_size*1.1);t=Math.max(t,i+1),c=Math.max(c,s+1),op_canvas_2d.width=t-i+o*2,op_canvas_2d.height=c-s+o*2;const l=i-o,r=s-o;op_ctx_2d.save(),op_ctx_2d.translate(-l,-r),n(op_ctx_2d),op_ctx_2d.restore(),replace_colors_with_swatch(op_ctx_2d,a,l,r),e.drawImage(op_canvas_2d,l,r)}console.log("JS 실행:","$FontBox.js");const eachFont=async(e,i)=>{function s(){FontDetective.each(e),FontDetective.all(i)}if(window.queryLocalFonts){let t;try{t=await window.queryLocalFonts()}catch(a){console.log("queryLocalFonts failed:",a,`
Falling back to FontDetective.`),s();return}if(t.length===0){console.log("queryLocalFonts returned no fonts; falling back to FontDetective."),s();return}const c=new Set;for(const a of t)c.has(a.family)||(c.add(a.family),e({name:a.family,toString(){return'"'+this.name.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}}));i()}else console.log("queryLocalFonts unavailable; falling back to FontDetective."),s()};function $FontBox(){const e=$(E("div")).addClass("font-box"),i=$(E("select")).addClass("inset-deep").attr({"aria-label":"Font Family","aria-description":localize("Selects the font used by the text.")}),s=$(E("input")).addClass("inset-deep").attr({type:"number",min:8,max:72,value:text_tool_font.size,"aria-label":"Font Size","aria-description":localize("Selects the point size of the text.")}).css({maxWidth:50}),t=$(E("span")).addClass("text-toolbar-button-group"),c=h(0,"bold","Bold",localize("Sets or clears the text bold attribute.")),a=h(1,"italic","Italic",localize("Sets or clears the text italic attribute.")),n=h(2,"underline","Underline",localize("Sets or clears the text underline attribute.")),o=h(3,"vertical","Vertical Writing Mode",localize("Only a Far East font can be used for vertical editing."));o.prop("disabled",!0),t.append(c,a,n,o),e.append(i,s,t);const l=()=>{text_tool_font.size=Number(s.val()),text_tool_font.family=i.val(),$G$1.trigger("option-changed")},r=text_tool_font.family;eachFont(_=>{const f=$(E("option"));f.val(_).text(_.name);const g=i.children("option");let x=0;for(;x<g.length&&!(g.eq(x).text().localeCompare(_.name)>0);x++);g.eq(x).length?g.eq(x).before(f):i.append(f),text_tool_font.family||l()},()=>{i.val(r),i.val()||i.val('"Liberation Sans"'),i.val()||i.val(i.children("option").eq(0).val()),l()}),text_tool_font.family&&i.val(text_tool_font.family),i.on("change",l),s.on("change",l);const d=$ToolWindow();return d.title(localize("Fonts")),d.$content.append(e),d.center(),d;function h(_,f,g,x){const w=$(E("button")).addClass("toggle").attr({"aria-pressed":!1,"aria-label":g,"aria-description":x}),S=$(E("span")).addClass("icon").appendTo(w);return w.css({width:23,height:22,padding:0,display:"inline-flex",alignContent:"center",alignItems:"center",justifyContent:"center"}),S.css({flex:"0 0 auto",display:"block",width:16,height:16,"--icon-index":_}),w.on("click",()=>{w.toggleClass("selected"),text_tool_font[f]=w.hasClass("selected"),w.attr("aria-pressed",w.hasClass("selected")?"true":"false"),l()}),text_tool_font[f]&&w.addClass("selected").attr("aria-pressed","true"),w}}console.log("JS 실행:","OnCanvasTextBox.js");class OnCanvasTextBox extends OnCanvasObject{constructor(i,s,t,c,a=""){super(i,s,t,c,!0),this.$el.addClass("textbox");var n=E("textarea");this.$editor=$(n).addClass("textbox-editor");var o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("version","1.1");var l=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");l.setAttribute("x","0"),l.setAttribute("y","0"),o.append(l),this.$editor.css({position:"absolute",left:"0",top:"0",right:"0",bottom:"0",padding:"0",margin:"0",border:"0",resize:"none",overflow:"hidden",minWidth:"3em"});var r=n.cloneNode(!1);l.append(r),n.value=a,this.canvas=make_canvas(t,c),this.canvas.style.pointerEvents="none",this.$el.append(this.canvas);const d=()=>{this.position(),this.$el.triggerHandler("update"),this.$editor.add(r).css({width:this.width,height:this.height})},h=()=>{n.style.height="",n.style.minHeight="0px",n.style.bottom="",n.setAttribute("rows","1"),this.height=Math.max(n.scrollHeight,this.height),n.removeAttribute("rows"),this.width=n.scrollWidth,n.style.bottom="0",d()},_=()=>{requestAnimationFrame(()=>{n.scrollTop=0});const M=text_tool_font,R=y=>`rgba(${get_rgba_from_color(y).join(", ")}`;for(M.color=R(selected_colors.foreground),M.background=tool_transparent_mode?"transparent":R(selected_colors.background),this.$editor.add(this.canvas).css({transform:`scale(${magnification})`,transformOrigin:"left top"}),this.$editor.add(r).css({width:this.width,height:this.height,fontFamily:M.family,fontSize:`${M.size}pt`,fontWeight:M.bold?"bold":"normal",fontStyle:M.italic?"italic":"normal",textDecoration:M.underline?"underline":"none",writingMode:M.vertical?"vertical-lr":"",MsWritingMode:M.vertical?"vertical-lr":"",WebkitWritingMode:M.vertical?"vertical-lr":"",lineHeight:`${M.size*M.line_scale}px`,color:M.color,background:M.background}),h();r.firstChild;)r.removeChild(r.firstChild);r.appendChild(document.createTextNode(n.value)),o.setAttribute("width",this.width.toString()),o.setAttribute("height",this.height.toString()),l.setAttribute("width",this.width.toString()),l.setAttribute("height",this.height.toString());var C=new XMLSerializer().serializeToString(o),u=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(C)}`,m=new Image;m.onload=()=>{this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.ctx.drawImage(m,0,0),update_helper_layer()},m.onerror=y=>{var v;(v=window.console)==null||v.log("Failed to load image",y)},m.src=u};$G$1.on("option-changed",this._on_option_changed=_),this.$editor.on("input",this._on_input=_),this.$editor.on("scroll",this._on_scroll=()=>{requestAnimationFrame(()=>{n.scrollTop=0})}),this.$el.css({cursor:make_css_cursor("move",[8,8],"move"),touchAction:"none"}),this.position(),this.$el.append(this.$editor),this.$editor[0].focus(),this.handles=new Handles({$handles_container:this.$el,$object_container:$canvas_area,outset:2,thick:!0,get_rect:()=>({x:this.x,y:this.y,width:this.width,height:this.height}),set_rect:({x:M,y:R,width:C,height:u})=>{this.x=M,this.y=R,this.width=C,this.height=u,this.position(),_(),this.canvas.width=C,this.canvas.height=u},constrain_rect:({x:M,y:R,width:C,height:u},m,y)=>{const v=this.x,T=this.y,k=this.width,L=this.height;return this.x=M,this.y=R,this.width=C,this.height=u,d(),h(),m===-1&&(M=Math.min(this.x,v+k-this.width)),y===-1&&(R=Math.min(this.y,T+L-this.height)),C=this.width,u=this.height,this.x=v,this.y=T,this.width=k,this.height=L,d(),{x:M,y:R,width:C,height:u}},get_ghost_offset_left:()=>parseFloat($canvas_area.css("padding-left"))+1,get_ghost_offset_top:()=>parseFloat($canvas_area.css("padding-top"))+1});let f,g;const x=M=>{const R=to_canvas_coords(M);this.x=Math.max(Math.min(R.x-f,main_canvas.width),-this.width),this.y=Math.max(Math.min(R.y-g,main_canvas.height),-this.height),this.position(),M.shiftKey};this.$el.on("pointerdown",M=>{if(M.target instanceof HTMLInputElement||M.target instanceof HTMLTextAreaElement||M.target.classList.contains("handle")||M.target.classList.contains("grab-region"))return;M.preventDefault();const R=this.$el[0].getBoundingClientRect(),C=M.clientX-R.left,u=M.clientY-R.top;f=~~(C/R.width*this.canvas.width),g=~~(u/R.height*this.canvas.height),this.dragging=!0,update_helper_layer(),$G$1.on("pointermove",x),$G$1.one("pointerup",()=>{$G$1.off("pointermove",x),this.dragging=!1,update_helper_layer()})}),$status_position.text(""),$status_size.text(""),$canvas_area.trigger("resize"),OnCanvasTextBox.$fontbox&&OnCanvasTextBox.$fontbox.closed&&(OnCanvasTextBox.$fontbox=null);const w=OnCanvasTextBox.$fontbox=OnCanvasTextBox.$fontbox||$FontBox(),S=()=>{const M=w[0].getBoundingClientRect(),R=this.$el[0].getBoundingClientRect();M.left<=R.right&&R.left<=M.right&&M.top<=R.bottom&&R.top<=M.bottom&&w.css({top:this.$el.position().top-w.height()}),w.applyBounds()};_(),S(),$(window).on("resize",this._on_window_resize=()=>{this.$editor[0].scrollIntoView({block:"nearest",inline:"nearest"}),S()})}position(){super.position(!0),update_helper_layer()}destroy(){super.destroy(),OnCanvasTextBox.$fontbox&&!OnCanvasTextBox.$fontbox.closed&&OnCanvasTextBox.$fontbox.close(),OnCanvasTextBox.$fontbox=null,$G$1.off("option-changed",this._on_option_changed),this.$editor.off("input",this._on_input),this.$editor.off("scroll",this._on_scroll),$(window).off("resize",this._on_window_resize),update_helper_layer()}}OnCanvasTextBox.$fontbox=null;console.log("JS 실행:","tool-options.js");const ChooserCanvas=(e,i,s,t,c,a,n,o,l,r,d,h,_)=>{const f=_(s,t);let g=ChooserCanvas.cache[e];g||(g=ChooserCanvas.cache[e]=E("img"),g.onerror=()=>{delete ChooserCanvas.cache[e]},g.src=e);const x=()=>{try{f.ctx.drawImage(g,c,a,n,o,l,r,d,h)}catch{}f.style.filter=i?"invert()":""};return $(g).on("load",x),x(),f};ChooserCanvas.cache={};const ChooserDiv=(e,i,s,t,c,a,n,o,l,r,d,h,_,f)=>{const g=_(s,t);g.classList.add(e),g.style.width=n+"px",g.style.height=o+"px";const x=()=>{const w=get_theme()==="modern.css"||get_theme()==="modern-dark.css"||get_theme()==="bubblegum.css",S=w?window.devicePixelRatio!==1:window.devicePixelRatio>=3||window.devicePixelRatio%1!==0;g.classList.toggle("use-svg",S),g.style.backgroundPosition=`${-c}px ${-a-(w&&f?1:0)}px`};return g._on_zoom_etc&&$G$1.off("theme-load resize",g._on_zoom_etc),$G$1.on("theme-load resize",x),g._on_zoom_etc=x,x(),g.style.borderColor="transparent",g.style.borderStyle="solid",g.style.borderLeftWidth=l+"px",g.style.borderTopWidth=r+"px",g.style.borderRightWidth=s-l-d+"px",g.style.borderBottomWidth=t-r-h+"px",g.style.backgroundClip="content-box",g.style.filter=i?"invert()":"",g},$Choose=(e,i,s,t,c)=>{const a=$(E("div")).addClass("chooser").css("touch-action","none"),n=o=>{t(o)||(s(o),$G$1.trigger("option-changed"))};return a.on("update",()=>{if(!a.is(":visible"))return;a.empty();for(let r=0;r<e.length;r++)(d=>{const h=$(E("div")).addClass("chooser-option").appendTo(a);h.data("thing",d);const _=(x,w)=>{let S=h.find("canvas")[0];return S?(S.width!==x&&(S.width=x),S.height!==w&&(S.height=w)):(S=make_canvas(x,w),h.append(S)),S},f=(x,w)=>{let S=h.find("div")[0];return S?(S.style.width!==x+"px"&&(S.style.width=x+"px"),S.style.height!==w+"px"&&(S.style.height=w+"px")):(S=E("div"),S.style.width=x+"px",S.style.height=w+"px",h.append(S)),S},g=()=>{const x=getComputedStyle(a[0]).getPropertyValue("--Hilight"),w=c?"rgb(192, 192, 192)":"";h.css({backgroundColor:t(d)?x:w}),i(d,t(d),_,f)};g(),$G$1.on("option-changed theme-load redraw-tool-options-because-webglcontextrestored",g)})(e[r]);const o=r=>{const d=r.target.closest(".chooser-option");d&&n($(d).data("thing"))},l=r=>{const d=r.originalEvent.changedTouches[0],_=document.elementFromPoint(d.clientX,d.clientY).closest(".chooser-option");_&&n($(_).data("thing")),r.preventDefault()};a.on("pointerdown click",r=>{const d=r.target.closest(".chooser-option");d&&n($(d).data("thing")),r.type==="pointerdown"&&(a.on("pointerover",o),a.on("touchmove",l))}),$G$1.on("pointerup pointercancel",()=>{a.off("pointerover",o),a.off("touchmove",l)})}),a},$ChooseShapeStyle=()=>{const e=$Choose([{stroke:!0,fill:!1},{stroke:!0,fill:!0},{stroke:!1,fill:!0}],({stroke:i,fill:s},t,c)=>{const a=c(39,21),n=a.ctx;let o=5;const l=getComputedStyle(a);return n.fillStyle=t?l.getPropertyValue("--HilightText"):l.getPropertyValue("--WindowText"),i&&n.fillRect(o,o,a.width-o*2,a.height-o*2),o+=1,n.fillStyle=l.getPropertyValue("--ButtonShadow"),s?n.fillRect(o,o,a.width-o*2,a.height-o*2):n.clearRect(o,o,a.width-o*2,a.height-o*2),a},({stroke:i,fill:s})=>{e.stroke=i,e.fill=s},({stroke:i,fill:s})=>e.stroke===i&&e.fill===s).addClass("choose-shape-style");return e.fill=!1,e.stroke=!0,e},$choose_brush=$Choose((()=>{const e=["circle","square","reverse_diagonal","diagonal"],i=[7,4,1],s=[8,5,2],t=[];return e.forEach(c=>{(c==="circle"?i:s).forEach(n=>{t.push({shape:c,size:n})})}),t})(),(e,i,s)=>{const t=s(10,10),c=getComputedStyle(t),a=e.shape,n=e.size,o=i?c.getPropertyValue("--HilightText"):c.getPropertyValue("--WindowText");return stamp_brush_canvas(t.ctx,5,5,a,n),replace_colors_with_swatch(t.ctx,o),t},({shape:e,size:i})=>{brush_shape=e,brush_size=i},({shape:e,size:i})=>brush_shape===e&&brush_size===i).addClass("choose-brush"),$choose_eraser_size=$Choose([4,6,8,10],(e,i,s)=>{const t=s(39,16),c=getComputedStyle(t);return t.ctx.fillStyle=i?c.getPropertyValue("--HilightText"):c.getPropertyValue("--WindowText"),render_brush(t.ctx,"square",e),t},e=>{eraser_size=e},e=>eraser_size===e).addClass("choose-eraser"),$choose_stroke_size=$Choose([1,2,3,4,5],(e,i,s)=>{const n=s(39,12),o=(12-e)/2,l=getComputedStyle(n);return n.ctx.fillStyle=i?l.getPropertyValue("--HilightText"):l.getPropertyValue("--WindowText"),n.ctx.fillRect(5,~~o,39-5*2,e),n},e=>{stroke_size=e},e=>stroke_size===e).addClass("choose-stroke-size"),magnifications=[1,2,6,8,10],$choose_magnification=$Choose(magnifications,(e,i,s,t)=>{const c=magnifications.indexOf(e),a=e===10,n=ChooserDiv("magnification-option",i,39,a?2:13,c*23,0,23,9,8,2,23,9,t);return a&&$(n).addClass("secret-option"),n},e=>{set_magnification(e)},e=>e===magnification,!0).addClass("choose-magnification").css({position:"relative"});$choose_magnification.on("update",()=>{$choose_magnification.find(".secret-option").parent().css({position:"absolute",bottom:"-2px",left:0,opacity:0,height:2,overflow:"hidden"})});const airbrush_sizes=[9,16,24],$choose_airbrush_size=$Choose(airbrush_sizes,(e,i,s)=>{const c=airbrush_sizes.indexOf(e),a=airbrush_sizes.length,o=c===2?0:4,l=72/a-o*2,r=23,d=72/a*c+o;return ChooserCanvas("images/options-airbrush-size.png",i,l,r,d,0,l,r,0,0,l,r,s)},e=>{airbrush_size=e},e=>e===airbrush_size,!0).addClass("choose-airbrush-size"),$choose_transparent_mode=$Choose([!1,!0],(e,i,s,t)=>ChooserDiv("transparent-mode-option",!1,39,27,0,e?22:0,35,23,2,2,35,23,t,e),e=>{tool_transparent_mode=e},e=>e===tool_transparent_mode,!0).addClass("choose-transparent-mode");console.log("JS 실행:","tools.js");const TOOL_FREE_FORM_SELECT="TOOL_FREE_FORM_SELECT",TOOL_SELECT="TOOL_SELECT",TOOL_ERASER="TOOL_ERASER",TOOL_FILL="TOOL_FILL",TOOL_PICK_COLOR="TOOL_PICK_COLOR",TOOL_MAGNIFIER="TOOL_MAGNIFIER",TOOL_PENCIL="TOOL_PENCIL",TOOL_BRUSH="TOOL_BRUSH",TOOL_AIRBRUSH="TOOL_AIRBRUSH",TOOL_TEXT="TOOL_TEXT",TOOL_LINE="TOOL_LINE",TOOL_CURVE="TOOL_CURVE",TOOL_RECTANGLE="TOOL_RECTANGLE",TOOL_POLYGON="TOOL_POLYGON",TOOL_ELLIPSE="TOOL_ELLIPSE",TOOL_ROUNDED_RECTANGLE="TOOL_ROUNDED_RECTANGLE",tools=[{id:TOOL_FREE_FORM_SELECT,name:localize("Free-Form Select"),speech_recognition:["lasso","select with lasso","select by lassoing","lassoing","lasso select","freeform select","free-form select","free form select","polygonal select","polygon select","shape select","outline select","select by outline","select by outlining","star select","shape select","select by shape","select by drawing a shape","select by drawing shape","lasso selection","freeform selection","free-form selection","free form selection","polygonal selection","polygon selection","shape selection","outline selection","selection by outline","selection by outlining","star selection","shape selection","selection by shape","selection by drawing a shape","selection by drawing shape","lasso selecting","freeform selecting","free-form selecting","free form selecting","polygonal selecting","polygon selecting","shape selecting","outline selecting","selecting by outline","selecting by outlining","star selecting","shape selecting","selecting by shape","selecting by drawing a shape","selecting by drawing shape","lasso selector","freeform selector","free-form selector","free form selector","polygonal selector","polygon selector","shape selector","outline selector","by outline selector","outlining selector","star selector","shape selector","by shape selector","by drawing a shape selector","by drawing shape selector"],help_icon:"p_free.gif",description:localize("Selects a free-form part of the picture to move, copy, or edit."),cursor:["precise",[16,16],"crosshair"],preview_canvas:null,points:[],x_min:1/0,x_max:-1/0,y_min:1/0,y_max:-1/0,pointerdown(){this.x_min=pointer.x,this.x_max=pointer.x+1,this.y_min=pointer.y,this.y_max=pointer.y+1,this.points=[],this.preview_canvas=make_canvas(main_canvas.width,main_canvas.height),deselect()},paint(e,i,s){pointer.x=Math.min(main_canvas.width,pointer.x),pointer.x=Math.max(0,pointer.x),pointer.y=Math.min(main_canvas.height,pointer.y),pointer.y=Math.max(0,pointer.y),this.points.push(pointer),this.x_min=Math.min(pointer.x,this.x_min),this.x_max=Math.max(pointer.x,this.x_max),this.y_min=Math.min(pointer.y,this.y_min),this.y_max=Math.max(pointer.y,this.y_max),bresenham_line(pointer_previous.x,pointer_previous.y,pointer.x,pointer.y,(t,c)=>{this.ffs_paint_iteration(t,c)}),$status_size.text(`${this.x_max-this.x_min}x${this.y_max-this.y_min}`)},ffs_paint_iteration(e,i){e=Math.min(main_canvas.width,e),e=Math.max(0,e),i=Math.min(main_canvas.height,i),i=Math.max(0,i);const s=2,t=~~(e-s/2),c=~~(i-s/2),a=s,n=s,o=this.preview_canvas.ctx,l=main_ctx.getImageData(t,c,a,n),r=o.getImageData(t,c,a,n);for(let d=0,h=r.data.length;d<h;d+=4)r.data[d+0]=255-l.data[d+0],r.data[d+1]=255-l.data[d+1],r.data[d+2]=255-l.data[d+2],r.data[d+3]=255;o.putImageData(r,t,c)},pointerup(){this.preview_canvas.width=1,this.preview_canvas.height=1;const e=copy_contents_within_polygon(main_canvas,this.points,this.x_min,this.y_min,this.x_max,this.y_max);selection&&(show_error_message$1("This isn't supposed to happen: Free-Form Select after Select in the tool chain?"),meld_selection_into_canvas()),undoable({name:localize("Free-Form Select"),icon:get_icon_for_tool(get_tool_by_id(TOOL_FREE_FORM_SELECT)),soft:!0},()=>{selection=new OnCanvasSelection(this.x_min,this.y_min,this.x_max-this.x_min,this.y_max-this.y_min,e),selection.cut_out_background()})},cancel(){this.preview_canvas&&(this.preview_canvas.width=1,this.preview_canvas.height=1)},drawPreviewUnderGrid(e,i,s,t,c,a,n){!pointer_active&&!pointer_over_canvas||this.preview_canvas&&(e.scale(c,c),e.translate(a,n),e.drawImage(this.preview_canvas,0,0))},$options:$choose_transparent_mode},{id:TOOL_SELECT,name:localize("Select"),speech_recognition:[],help_icon:"p_sel.gif",description:localize("Selects a rectangular part of the picture to move, copy, or edit."),cursor:["precise",[16,16],"crosshair"],selectBox(e,i,s,t){if(s>1&&t>1){var c=selection;if(selection&&meld_selection_into_canvas(),ctrl)undoable({name:"Crop"},()=>{var h=make_canvas(s,t);h.ctx.drawImage(main_canvas,-e,-i),main_ctx.copy(h),canvas_handles.show(),$canvas_area.trigger("resize")});else if(c){var a=Math.min(c.x,e),n=Math.min(c.y,i),o=Math.max(c.x+c.width,e+s),l=Math.max(c.y+c.height,i+t),r=make_canvas(o-a,l-n),d=make_canvas(o-a,l-n);d.ctx.drawImage(main_canvas,e,i,s,t,e-a,i-n,s,t),r.ctx.drawImage(c.canvas,c.x-a,c.y-n),r.ctx.globalCompositeOperation="xor",r.ctx.drawImage(d,0,0),undoable({name:`${localize("Free-Form Select")}⊕${localize("Select")}`,icon:get_icon_for_tools([get_tool_by_id(TOOL_FREE_FORM_SELECT),get_tool_by_id(TOOL_SELECT)]),soft:!0},()=>{selection=new OnCanvasSelection(a,n,o-a,l-n,r),selection.cut_out_background()})}else undoable({name:localize("Select"),icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{selection=new OnCanvasSelection(e,i,s,t)})}},$options:$choose_transparent_mode},{id:TOOL_ERASER,name:localize("Eraser/Color Eraser"),speech_recognition:[],help_icon:"p_erase.gif",description:localize("Erases a portion of the picture, using the selected eraser shape."),cursor:["precise",[16,16],"crosshair"],mask_canvas:null,get_rect(e,i){const s=Math.ceil(e-eraser_size/2),t=Math.ceil(i-eraser_size/2),c=eraser_size,a=eraser_size;return{rect_x:s,rect_y:t,rect_w:c,rect_h:a}},drawPreviewUnderGrid(e,i,s,t,c,a,n){if(!pointer_active&&!pointer_over_canvas)return;const{rect_x:o,rect_y:l,rect_w:r,rect_h:d}=this.get_rect(i,s);e.scale(c,c),e.translate(a,n),this.mask_canvas&&this.render_from_mask(e,!0),e.fillStyle=selected_colors.background,e.fillRect(o,l,r,d)},drawPreviewAboveGrid(e,i,s,t,c,a,n){if(!pointer_active&&!pointer_over_canvas)return;const{rect_x:o,rect_y:l,rect_w:r,rect_h:d}=this.get_rect(i,s);e.scale(c,c),e.translate(a,n);const h=1/c;e.strokeStyle="black",e.lineWidth=h,t?e.strokeRect(o+e.lineWidth/2,l+e.lineWidth/2,r,d):e.strokeRect(o+e.lineWidth/2,l+e.lineWidth/2,r-e.lineWidth,d-e.lineWidth)},pointerdown(){this.mask_canvas=make_canvas(main_canvas.width,main_canvas.height)},render_from_mask(e,i){e.save(),e.globalCompositeOperation="destination-out",e.drawImage(this.mask_canvas,0,0),e.restore();let s=selected_colors.background;get_rgba_from_color(s)[3]<1&&(s=i?"rgba(255, 0, 0, 0.3)":selected_colors.background);const c=make_canvas(this.mask_canvas);replace_colors_with_swatch(c.ctx,s,0,0),e.drawImage(c,0,0)},pointerup(){this.mask_canvas&&undoable({name:get_language().match(/^en\b/)?this.color_eraser_mode?"Color Eraser":"Eraser":localize("Eraser/Color Eraser"),icon:get_icon_for_tool(this)},()=>{this.render_from_mask(main_ctx),this.mask_canvas=null})},cancel(){this.mask_canvas=null},paint(e,i,s){bresenham_line(pointer_previous.x,pointer_previous.y,pointer.x,pointer.y,(t,c)=>{this.eraser_paint_iteration(e,t,c)})},eraser_paint_iteration(e,i,s){const{rect_x:t,rect_y:c,rect_w:a,rect_h:n}=this.get_rect(i,s);if(this.color_eraser_mode=button!==0,!this.color_eraser_mode)this.mask_canvas.ctx.fillStyle="white",this.mask_canvas.ctx.fillRect(t,c,a,n);else{const o=get_rgba_from_color(selected_colors.foreground),l=e.getImageData(t,c,a,n),r=this.mask_canvas.ctx.getImageData(t,c,a,n),d=1;for(let h=0,_=l.data.length;h<_;h+=4)Math.abs(l.data[h+0]-o[0])<=d&&Math.abs(l.data[h+1]-o[1])<=d&&Math.abs(l.data[h+2]-o[2])<=d&&Math.abs(l.data[h+3]-o[3])<=d&&(r.data[h+0]=255,r.data[h+1]=255,r.data[h+2]=255,r.data[h+3]=255);this.mask_canvas.ctx.putImageData(r,t,c)}},$options:$choose_eraser_size},{id:TOOL_FILL,name:localize("Fill With Color"),speech_recognition:[],help_icon:"p_paint.gif",description:"Fills an area with the selected drawing color.",cursor:["fill-bucket",[8,22],"crosshair"],pointerdown(e,i,s){shift?undoable({name:"Replace Color",icon:get_icon_for_tool(this)},()=>{draw_noncontiguous_fill(e,i,s,fill_color)}):undoable({name:localize("Fill With Color"),icon:get_icon_for_tool(this)},()=>{draw_fill(e,i,s,fill_color)})}},{id:TOOL_PICK_COLOR,name:localize("Pick Color"),speech_recognition:[],help_icon:"p_eye.gif",description:localize("Picks up a color from the picture for drawing."),cursor:["eye-dropper",[9,22],"crosshair"],deselect:!0,current_color:"",display_current_color(){this.$options.css({background:this.current_color})},pointerdown(){$G$1.one("pointerup",()=>{this.$options.css({background:""})})},paint(e,i,s){if(i>=0&&s>=0&&i<main_canvas.width&&s<main_canvas.height){const t=e.getImageData(~~i,~~s,1,1),[c,a,n,o]=t.data;this.current_color=`rgba(${c},${a},${n},${o/255})`}else this.current_color="white";this.display_current_color()},pointerup(){selected_colors[pick_color_slot]=this.current_color,$G$1.trigger("option-changed")},$options:$(E("div"))},{id:TOOL_MAGNIFIER,name:localize("Magnifier"),speech_recognition:[],help_icon:"p_zoom.gif",description:localize("Changes the magnification."),cursor:["magnifier",[16,16],"zoom-in"],deselect:!1,getProspectiveMagnification:(e=1)=>{const i={.125:.25,.25:.5,.5:1,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:8},s={8:7,7:6,6:5,5:4,4:3,3:2,2:1,1:.5,.5:.125,.125:.125};return e==2?s[magnification]:i[magnification]},drawPreviewAboveGrid(e,i,s,t,c,a,n){if(!pointer_active&&!pointer_over_canvas||pointer_active)return;const o=this.getProspectiveMagnification();if(o<magnification?$canvas.css({cursor:make_css_cursor("magnifier",[16,16],"zoom-out")}):$canvas.css({cursor:make_css_cursor("magnifier",[16,16],"zoom-in")}),o<magnification)return;const l=$canvas_area.width()/o,r=$canvas_area.height()/o;let d=~~(i-l/2),h=~~(s-r/2);d=Math.max(0,d),h=Math.max(0,h),d=Math.min(main_canvas.width-l,d),h=Math.min(main_canvas.height-r,h);let _=d+l,f=h+r;d=Math.max(0,d),h=Math.max(0,h),_=Math.min(main_canvas.width,_),f=Math.min(main_canvas.height,f);const g=_-d,x=f-h,w=d,S=h,M=main_canvas.ctx.getImageData(w,S,g+1,x+1),R=e.getImageData((w+a)*c,(S+n)*c,g*c+1,x*c+1);function C(u,m){const y=~~(u/c),v=~~(m/c),T=(y+v*M.width)*4,k=(u+m*R.width)*4;R.data[k+0]=255-M.data[T+0],R.data[k+1]=255-M.data[T+1],R.data[k+2]=255-M.data[T+2],R.data[k+3]=255}for(let u=0,m=R.width;u<m;u+=1)C(u,0),C(u,R.height-1);for(let u=1,m=R.height-1;u<m;u+=1)C(0,u),C(R.width-1,u);e.putImageData(R,(w+a)*c,(S+n)*c)},pointerdown(e,i,s){const t=magnification,c=this.getProspectiveMagnification(button);if(set_magnification(c),magnification>t){const a=$canvas_area.width()/magnification,n=$canvas_area.height()/magnification;$canvas_area.scrollLeft((i-a/2)*magnification),$canvas_area.scrollTop((s-n/2)*magnification),$canvas_area.trigger("scroll")}},$options:$choose_magnification},{id:TOOL_PENCIL,name:localize("Pencil"),speech_recognition:[],help_icon:"p_pencil.gif",description:localize("Draws a free-form line one pixel wide."),cursor:["pencil",[13,23],"crosshair"],stroke_only:!0,get_brush(){return{size:pencil_size,shape:"circle"}}},{id:TOOL_BRUSH,name:localize("Brush"),speech_recognition:[],help_icon:"p_brush.gif",description:localize("Draws using a brush with the selected shape and size."),cursor:["precise-dotted",[16,16],"crosshair"],dynamic_preview_cursor:!0,get_brush(){return{size:brush_size,shape:brush_shape}},$options:$choose_brush},{id:TOOL_AIRBRUSH,name:localize("Airbrush"),speech_recognition:[],help_icon:"p_airb.gif",description:localize("Draws using an airbrush of the selected size."),cursor:["airbrush",[7,22],"crosshair"],paint_on_time_interval:5,paint_mask(e,i,s){const t=airbrush_size/2;for(let c=0;c<6+t/5;c++){const a=(Math.random()*2-1)*t,n=(Math.random()*2-1)*t;a*a+n*n<=t*t&&e.fillRect(i+~~a,s+~~n,1,1)}update_helper_layer()},$options:$choose_airbrush_size},{id:TOOL_TEXT,name:localize("Text"),speech_recognition:["text","type","typography","write","writing","words","text box","text-box","textbox","word","lettering","font","fonts","texts"],help_icon:"p_txt.gif",description:localize("Inserts text into the picture."),cursor:["precise",[16,16],"crosshair"],preload(){setTimeout(FontDetective.preload,10)},selectBox(e,i,s,t){s>1&&t>1&&(textbox=new OnCanvasTextBox(e,i,s,t))},$options:$choose_transparent_mode},{id:TOOL_LINE,name:localize("Line"),speech_recognition:["line","line segment","straight line","lines","line segments","straight lines"],help_icon:"p_line.gif",description:localize("Draws a straight line with the selected line width."),cursor:["precise",[16,16],"crosshair"],stroke_only:!0,shape(e,i,s,t,c){update_brush_for_drawing_lines(stroke_size),draw_line(e,i,s,i+t,s+c,stroke_size)},$options:$choose_stroke_size},{id:TOOL_CURVE,name:localize("Curve"),speech_recognition:["curve","curved line","curvy","curvy line","Bezier","Bezier curve","spline","curves","splines","curved","curving","wave","wavy line","rounded line","round line","oscilloscope","sine wave","cosine","cosine wave"],help_icon:"p_curve.gif",description:localize("Draws a curved line with the selected line width."),cursor:["precise",[16,16],"crosshair"],stroke_only:!0,points:[],preview_canvas:null,pointerup(e,i,s){this.points.length>=4&&(undoable({name:localize("Curve"),icon:get_icon_for_tool(this)},()=>{e.drawImage(this.preview_canvas,0,0)}),this.points=[],$status_size.text(""))},pointerdown(e,i,s){this.points.length<1?(this.preview_canvas=make_canvas(main_canvas.width,main_canvas.height),this.points.push({x:i,y:s}),$("body").hasClass("eye-gaze-mode")||this.points.push({x:i,y:s})):this.points.push({x:i,y:s})},paint(e,i,s){if(this.points.length<1)return;update_brush_for_drawing_lines(stroke_size);const t=this.points.length-1;this.points[t].x=i,this.points[t].y=s,this.preview_canvas.ctx.clearRect(0,0,this.preview_canvas.width,this.preview_canvas.height),this.preview_canvas.ctx.strokeStyle=stroke_color,this.points.length===4?draw_bezier_curve(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[2].x,this.points[2].y,this.points[3].x,this.points[3].y,this.points[1].x,this.points[1].y,stroke_size):this.points.length===3?draw_quadratic_curve(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[2].x,this.points[2].y,this.points[1].x,this.points[1].y,stroke_size):this.points.length===2?draw_line(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[1].x,this.points[1].y,stroke_size):draw_line(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[0].x,this.points[0].y,stroke_size);const c=i-this.points[0].x||1,a=s-this.points[0].y||1;$status_size.text(`${c} x ${a}px`)},drawPreviewUnderGrid(e,i,s,t,c,a,n){this.preview_canvas&&(e.scale(c,c),e.translate(a,n),this.points.length>=1&&e.drawImage(this.preview_canvas,0,0))},cancel(){this.points=[],$status_size.text("")},end(){this.points=[],update_helper_layer(),$status_size.text("")},$options:$choose_stroke_size},{id:TOOL_RECTANGLE,name:localize("Rectangle"),speech_recognition:["rectangle","square","box","rect","sharp rectangle","sharp square","sharp box","sharp rect","sharp corners rectangle","sharp corners square","sharp corners box","sharp corners rect","sharp cornered rectangle","sharp cornered square","sharp cornered box","sharp cornered rect","rectangle with sharp corners","square with sharp corners","box with sharp corners","rect with sharp corners","rectangles","squares","boxes","rects","sharp rectangles","sharp squares","sharp boxes","sharp rects","sharp corners rectangles","sharp corners squares","sharp corners boxes","sharp corners rects","sharp cornered rectangles","sharp cornered squares","sharp cornered boxes","sharp cornered rects","rectangles with sharp corners","squares with sharp corners","boxes with sharp corners","rects with sharp corners"],help_icon:"p_rect.gif",description:localize("Draws a rectangle with the selected fill style."),cursor:["precise",[16,16],"crosshair"],shape(e,i,s,t,c){t<0&&(i+=t,t=-t),c<0&&(s+=c,c=-c),this.$options.fill&&e.fillRect(i,s,t,c),this.$options.stroke&&(t<stroke_size*2||c<stroke_size*2?(e.save(),e.fillStyle=e.strokeStyle,e.fillRect(i,s,t,c),e.restore()):(e.save(),e.fillStyle=e.strokeStyle,e.fillRect(i,s,stroke_size,c),e.fillRect(i+t-stroke_size,s,stroke_size,c),e.fillRect(i,s,t,stroke_size),e.fillRect(i,s+c-stroke_size,t,stroke_size),e.restore()))},$options:$ChooseShapeStyle()},{id:TOOL_POLYGON,name:localize("Polygon"),speech_recognition:["polygon","poly","shape","n-gon","free-form polygon","freeform polygon","free form polygon","triangle","quadrangle","pentagon","hexagon","heptagon","octagon","nonagon","decagon","undecagon","dodecagon","polygons","polys","shapes","n-gons","free-form polygons","freeform polygons","free form polygons","triangles","quadrangles","pentagons","hexagons","heptagons","octagons","nonagons","decagons","undecagons","dodecagons"],help_icon:"p_poly.gif",description:localize("Draws a polygon with the selected fill style."),cursor:["precise",[16,16],"crosshair"],last_click_pointerdown:{x:-1/0,y:-1/0,time:-1/0},last_click_pointerup:{x:-1/0,y:-1/0,time:-1/0},points:[],preview_canvas:null,pointerup(e,i,s){if(this.points.length<1)return;const t=this.points.length-1;this.points[t].x=i,this.points[t].y=s;const c=this.points[t].x-this.points[0].x,a=this.points[t].y-this.points[0].y,n=Math.sqrt(c*c+a*a);$("body").hasClass("eye-gaze-mode")?this.points.length>=3&&n<stroke_size*10+20&&this.complete(e):n<stroke_size*5.1010101&&this.complete(e),this.last_click_pointerup={x:i,y:s,time:+new Date},this.updateStatus()},pointerdown(e,i,s){if(this.points.length<1)this.preview_canvas=make_canvas(main_canvas.width,main_canvas.height),this.points.push({x:i,y:s}),$("body").hasClass("eye-gaze-mode")||this.points.push({x:i,y:s});else{const t=this.last_click_pointerdown.x,c=this.last_click_pointerdown.y,a=this.last_click_pointerdown.time,n=i-t,o=s-c,l=+new Date-a;Math.sqrt(n*n+o*o)<4.1010101&&l<250?this.complete(e):this.points.push({x:i,y:s})}this.last_click_pointerdown={x:i,y:s,time:+new Date}},paint(e,i,s){if(this.points.length<1)return;const t=this.points.length-1;if(this.points[t].x=i,this.points[t].y=s,this.preview_canvas.ctx.clearRect(0,0,this.preview_canvas.width,this.preview_canvas.height),this.$options.fill&&!this.$options.stroke){this.preview_canvas.ctx.drawImage(main_canvas,0,0),this.preview_canvas.ctx.strokeStyle="white",this.preview_canvas.ctx.globalCompositeOperation="difference";var c=stroke_size;stroke_size=2,draw_line_strip(this.preview_canvas.ctx,this.points),stroke_size=c}else this.points.length>1?(this.preview_canvas.ctx.strokeStyle=stroke_color,draw_line_strip(this.preview_canvas.ctx,this.points)):draw_line(this.preview_canvas.ctx,this.points[0].x,this.points[0].y,this.points[0].x,this.points[0].y,stroke_size);this.updateStatus()},drawPreviewUnderGrid(e,i,s,t,c,a,n){this.preview_canvas&&(e.scale(c,c),e.translate(a,n),e.drawImage(this.preview_canvas,0,0))},complete(e){this.points.length>=3&&undoable({name:localize("Polygon"),icon:get_icon_for_tool(this)},()=>{e.fillStyle=fill_color,e.strokeStyle=stroke_color;var i=stroke_size;this.$options.fill&&!this.$options.stroke&&(stroke_size=2,e.strokeStyle=fill_color),draw_polygon(e,this.points,this.$options.stroke||this.$options.fill&&!this.$options.stroke,this.$options.fill),stroke_size=i}),this.reset()},cancel(){this.reset()},end(e){this.complete(e),update_helper_layer()},updateStatus(){let e=1/0,i=-1/0,s=1/0,t=-1/0;for(const n of this.points)e=Math.min(n.x,e),i=Math.max(n.x,i),s=Math.min(n.y,s),t=Math.max(n.y,t);const c=i-e||1,a=t-s||1;$status_size.text(`${c} x ${a}px`)},reset(){$status_size.text(""),this.points=[],this.last_click_pointerdown={x:-1/0,y:-1/0,time:-1/0},this.last_click_pointerup={x:-1/0,y:-1/0,time:-1/0},this.preview_canvas&&(this.preview_canvas.width=1,this.preview_canvas.height=1)},shape_colors:!0,$options:$ChooseShapeStyle()},{id:TOOL_ELLIPSE,name:localize("Ellipse"),speech_recognition:["ellipse","circle","oval","ovoid","ovaloid","oviform","elliptical","oblong circle","stretched circle","ball","sphere","round tool","rounded tool","ellipses","circles","ovals","ovoids","ovaloids","oviforms","ellipticals","oblong circles","stretched circles","balls","spheres"],help_icon:"p_oval.gif",description:localize("Draws an ellipse with the selected fill style."),cursor:["precise",[16,16],"crosshair"],shape(e,i,s,t,c){t<0&&(i+=t,t=-t),c<0&&(s+=c,c=-c),t<stroke_size||c<stroke_size?(e.fillStyle=e.strokeStyle,draw_ellipse(e,i,s,t,c,!1,!0)):draw_ellipse(e,i+~~(stroke_size/2),s+~~(stroke_size/2),t-stroke_size,c-stroke_size,this.$options.stroke,this.$options.fill)},$options:$ChooseShapeStyle()},{id:TOOL_ROUNDED_RECTANGLE,name:localize("Rounded Rectangle"),speech_recognition:["rounded rectangle","rounded square","rounded box","round rectangle","round square","round box","rounded corners rectangle","rounded corners square","rounded corners box","round cornered rectangle","round cornered square","round cornered box","rounded cornered rectangle","rounded cornered square","rounded cornered box","rounded corner rectangle","rounded corner square","rounded corner box","rectangle with round corners","square with round corners","box with round corners","rectangle with rounded corners","square with rounded corners","box with rounded corners","soft rectangle","soft square","soft box","soft corners rectangle","soft corners square","soft corners box","soft cornered rectangle","soft cornered square","soft cornered box","soft corner rectangle","soft corner square","soft corner box","rectangle with soft corners","square with soft corners","box with soft corners","round rect","roundrect","rounded rectangles","rounded squares","rounded boxes","round rectangles","round squares","round boxes","rounded corners rectangles","rounded corners squares","rounded corners boxes","round cornered rectangles","round cornered squares","round cornered boxes","rounded cornered rectangles","rounded cornered squares","rounded cornered boxes","rounded corner rectangles","rounded corner squares","rounded corner boxes","rectangles with round corners","squares with round corners","boxes with round corners","rectangles with rounded corners","squares with rounded corners","boxes with rounded corners","soft rectangles","soft squares","soft boxes","soft corners rectangles","soft corners squares","soft corners boxes","soft cornered rectangles","soft cornered squares","soft cornered boxes","soft corner rectangles","soft corner squares","soft corner boxes","rectangles with soft corners","squares with soft corners","boxes with soft corners","round rects","roundrects"],help_icon:"p_rrect.gif",description:localize("Draws a rounded rectangle with the selected fill style."),cursor:["precise",[16,16],"crosshair"],shape(e,i,s,t,c){if(t<0&&(i+=t,t=-t),c<0&&(s+=c,c=-c),t<stroke_size||c<stroke_size){e.fillStyle=e.strokeStyle;const a=Math.min(8,t/2,c/2);draw_rounded_rectangle(e,i,s,t,c,a,a,!1,!0)}else{const a=Math.min(8,(t-stroke_size)/2,(c-stroke_size)/2);draw_rounded_rectangle(e,i+~~(stroke_size/2),s+~~(stroke_size/2),t-stroke_size,c-stroke_size,a,a,this.$options.stroke,this.$options.fill)}},$options:$ChooseShapeStyle()}];tools.forEach(e=>{if(e.selectBox){let i=0,s=0,t=!1,c=0,a=0,n=0,o=0;e.pointerdown=()=>{i=pointer.x,s=pointer.y,t=!1,$G$1.one("pointermove",()=>{t=!0}),selection&&meld_selection_into_canvas(),textbox&&meld_textbox_into_canvas(),canvas_handles.hide()},e.paint=()=>{c=~~Math.max(0,Math.min(i,pointer.x)),a=~~Math.max(0,Math.min(s,pointer.y)),n=~~Math.min(main_canvas.width,Math.max(i,pointer.x)+1)-c,o=~~Math.min(main_canvas.height,Math.max(s,pointer.y+1))-a,$status_size.text(`${n} x ${o}px`)},e.pointerup=()=>{canvas_handles.show(),e.selectBox(c,a,n,o)},e.cancel=()=>{canvas_handles.show()},e.drawPreviewUnderGrid=(l,r,d,h,_,f,g)=>{pointer_active&&t&&(l.scale(_,_),l.translate(f,g),l.drawImage(main_canvas,0,0))},e.drawPreviewAboveGrid=(l,r,d,h,_,f,g)=>{pointer_active&&t&&draw_selection_box(l,c,a,n,o,_,f,g)}}e.shape&&(e.shape_canvas=null,e.pointerdown=()=>{e.shape_canvas=make_canvas(main_canvas.width,main_canvas.height)},e.paint=()=>{e.shape_canvas.ctx.clearRect(0,0,e.shape_canvas.width,e.shape_canvas.height),e.shape_canvas.ctx.fillStyle=main_ctx.fillStyle,e.shape_canvas.ctx.strokeStyle=main_ctx.strokeStyle,e.shape_canvas.ctx.lineWidth=main_ctx.lineWidth,e.shape(e.shape_canvas.ctx,pointer_start.x,pointer_start.y,pointer.x-pointer_start.x,pointer.y-pointer_start.y);const i=pointer.x-pointer_start.x||1,s=pointer.y-pointer_start.y||1;$status_size.text(`${i} x ${s}px`)},e.pointerup=()=>{e.shape_canvas&&undoable({name:e.name,icon:get_icon_for_tool(e)},()=>{main_ctx.drawImage(e.shape_canvas,0,0),e.shape_canvas=null})},e.drawPreviewUnderGrid=(i,s,t,c,a,n,o)=>{pointer_active&&e.shape_canvas&&(i.scale(a,a),i.translate(n,o),i.drawImage(e.shape_canvas,0,0))}),e.paint_mask&&(e.mask_canvas=null,e.pointerdown=(i,s,t)=>{e.mask_canvas||(e.mask_canvas=make_canvas(main_canvas.width,main_canvas.height)),e.mask_canvas.width!==main_canvas.width&&(e.mask_canvas.width=main_canvas.width),e.mask_canvas.height!==main_canvas.height&&(e.mask_canvas.height=main_canvas.height),e.mask_canvas.ctx.disable_image_smoothing()},e.pointerup=()=>{e.mask_canvas&&undoable({name:e.name,icon:get_icon_for_tool(e)},()=>{e.render_from_mask(main_ctx),e.mask_canvas.width=1,e.mask_canvas.height=1})},e.paint=(i,s,t)=>{e.paint_mask(e.mask_canvas.ctx,s,t)},e.cancel=()=>{e.mask_canvas&&(e.mask_canvas.width=1,e.mask_canvas.height=1)},e.render_from_mask=(i,s)=>{i.save(),i.globalCompositeOperation="destination-out",i.drawImage(e.mask_canvas,0,0),i.restore();let t=stroke_color;const c=make_canvas(e.mask_canvas);return replace_colors_with_swatch(c.ctx,t,0,0),i.drawImage(c,0,0),!0},e.drawPreviewUnderGrid=(i,s,t,c,a,n,o)=>{!pointer_active&&!pointer_over_canvas||(i.scale(a,a),i.translate(n,o),e.mask_canvas&&e.render_from_mask(i,!0)&&requestAnimationFrame(()=>{update_helper_layer()}))}),e.get_brush&&(e.mask_canvas=null,e.init_mask_canvas=(i,s,t)=>{e.mask_canvas||(e.mask_canvas=make_canvas(main_canvas.width,main_canvas.height)),e.mask_canvas.width!==main_canvas.width&&(e.mask_canvas.width=main_canvas.width),e.mask_canvas.height!==main_canvas.height&&(e.mask_canvas.height=main_canvas.height),e.mask_canvas.ctx.disable_image_smoothing()},e.pointerdown=(i,s,t)=>{e.init_mask_canvas()},e.pointerup=()=>{undoable({name:e.name,icon:get_icon_for_tool(e)},()=>{e.render_from_mask(main_ctx),e.mask_canvas.width=1,e.mask_canvas.height=1})},e.paint=()=>{const i=e.get_brush(),s=get_circumference_points_for_brush(i.shape,i.size);e.mask_canvas.ctx.fillStyle=stroke_color,(i.size>1?bresenham_dense_line:bresenham_line)(pointer_previous.x,pointer_previous.y,pointer.x,pointer.y,(c,a)=>{for(const n of s)e.mask_canvas.ctx.fillStyle="white",e.mask_canvas.ctx.fillRect(c+n.x,a+n.y,1,1)})},e.cancel=()=>{e.mask_canvas&&(e.mask_canvas.width=1,e.mask_canvas.height=1)},e.render_from_mask=(i,s)=>{let t=stroke_color;const c=make_canvas(e.mask_canvas);if(s&&e.dynamic_preview_cursor){const a=e.get_brush();stamp_brush_canvas(c.ctx,pointer.x,pointer.y,a.shape,a.size)}return replace_colors_with_swatch(c.ctx,t,0,0),i.drawImage(c,0,0),!0},e.drawPreviewUnderGrid=(i,s,t,c,a,n,o)=>{if(!pointer_active&&!pointer_over_canvas)return;i.scale(a,a),i.translate(n,o),e.init_mask_canvas(),e.render_from_mask(i,!0)&&requestAnimationFrame(()=>{update_helper_layer()})})});window.TOOL_PENCIL=TOOL_PENCIL;console.log("JS 실행:","OnCanvasSelection.js");class OnCanvasSelection extends OnCanvasObject{constructor(i,s,t,c,a){super(i,s,t,c,!0),this.$el.addClass("selection");let n=tool_transparent_mode,o=selected_colors.background;this._on_option_changed=()=>{this.source_canvas&&(n!==tool_transparent_mode||o!==selected_colors.background)&&(n=tool_transparent_mode,o=selected_colors.background,this.update_tool_transparent_mode())},$G$1.on("option-changed",this._on_option_changed),this.instantiate(a)}position(){super.position(!0),update_helper_layer()}instantiate(i){this.$el.css({cursor:make_css_cursor("move",[8,8],"move"),touchAction:"none"}),this.position(),(()=>{i?(this.source_canvas=make_canvas(i),this.source_canvas.width!==this.width&&(this.source_canvas.width=this.width),this.source_canvas.height!==this.height&&(this.source_canvas.height=this.height),this.canvas=make_canvas(this.source_canvas)):(this.source_canvas=make_canvas(this.width,this.height),this.source_canvas.ctx.drawImage(main_canvas,this.x,this.y,this.width,this.height,0,0,this.width,this.height),this.canvas=make_canvas(this.source_canvas),this.cut_out_background()),this.$el.append(this.canvas),this.handles=new Handles({$handles_container:this.$el,$object_container:$canvas_area,outset:2,get_rect:()=>({x:this.x,y:this.y,width:this.width,height:this.height}),set_rect:({x:n,y:o,width:l,height:r})=>{undoable({name:"Resize Selection",icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{this.x=n,this.y=o,this.width=l,this.height=r,this.position(),this.resize()})},get_ghost_offset_left:()=>parseFloat($canvas_area.css("padding-left"))+1,get_ghost_offset_top:()=>parseFloat($canvas_area.css("padding-top"))+1});let t,c;const a=n=>{make_or_update_undoable({match:o=>n.shiftKey&&/^(Smear|Stamp|Move) Selection$/.test(o.name)||!n.shiftKey&&/^Move Selection$/.test(o.name),name:n.shiftKey?"Smear Selection":"Move Selection",update_name:!0,icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{const o=to_canvas_coords(n);this.x=Math.max(Math.min(o.x-t,main_canvas.width),-this.width),this.y=Math.max(Math.min(o.y-c,main_canvas.height),-this.height),this.position(),n.shiftKey&&this.draw()})};this.canvas_pointerdown=n=>{n.preventDefault();const o=this.canvas.getBoundingClientRect(),l=n.clientX-o.left,r=n.clientY-o.top;t=~~(l/o.width*this.canvas.width),c=~~(r/o.height*this.canvas.height),$G$1.on("pointermove",a),this.dragging=!0,update_helper_layer(),$G$1.one("pointerup",()=>{$G$1.off("pointermove",a),this.dragging=!1,update_helper_layer()}),n.shiftKey?undoable({name:"Stamp Selection",icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{this.draw()}):n.ctrlKey&&undoable({name:"Stamp Selection",icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{this.draw()})},$(this.canvas).on("pointerdown",this.canvas_pointerdown),$canvas_area.trigger("resize"),$status_position.text(""),$status_size.text("")})()}cut_out_background(){const i=this.canvas,s=main_ctx.getImageData(this.x,this.y,this.width,this.height),t=i.ctx.getImageData(0,0,this.width,this.height),c=make_canvas(i);replace_colors_with_swatch(c.ctx,selected_colors.background,this.x,this.y);for(let a=0;a<t.data.length;a+=4)t.data[a+3]>0?(t.data[a+0]=s.data[a+0],t.data[a+1]=s.data[a+1],t.data[a+2]=s.data[a+2],t.data[a+3]=s.data[a+3],s.data[a+0]=0,s.data[a+1]=0,s.data[a+2]=0,s.data[a+3]=0):(t.data[a+0]=0,t.data[a+1]=0,t.data[a+2]=0,t.data[a+3]=0);main_ctx.putImageData(s,this.x,this.y),i.ctx.putImageData(t,0,0),this.update_tool_transparent_mode(),(!transparency||tool_transparent_mode)&&main_ctx.drawImage(c,this.x,this.y),$G$1.triggerHandler("session-update"),update_helper_layer()}update_tool_transparent_mode(){const i=this.source_canvas.ctx.getImageData(0,0,this.width,this.height),s=this.canvas.ctx.createImageData(this.width,this.height),t=get_rgba_from_color(selected_colors.background),c=1;for(let a=0;a<s.data.length;a+=4){let n=i.data[a+3]>1;tool_transparent_mode&&Math.abs(i.data[a+0]-t[0])<=c&&Math.abs(i.data[a+1]-t[1])<=c&&Math.abs(i.data[a+2]-t[2])<=c&&Math.abs(i.data[a+3]-t[3])<=c&&(n=!1),n&&(s.data[a+0]=i.data[a+0],s.data[a+1]=i.data[a+1],s.data[a+2]=i.data[a+2],s.data[a+3]=i.data[a+3])}this.canvas.ctx.putImageData(s,0,0),update_helper_layer()}replace_source_canvas(i){this.source_canvas=i;const s=make_canvas(i);$(this.canvas).replaceWith(s),this.canvas=s;const t=this.x+this.width/2,c=this.y+this.height/2,a=s.width,n=s.height;this.x=~~(t-a/2),this.y=~~(c-n/2),this.width=a,this.height=n,this.position(),$(this.canvas).on("pointerdown",this.canvas_pointerdown),this.$el.triggerHandler("resize"),this.update_tool_transparent_mode()}resize(){const i=make_canvas(this.width,this.height);i.ctx.drawImage(this.source_canvas,0,0,this.width,this.height),this.replace_source_canvas(i)}scale(i){const s=Math.max(1,this.width*i),t=Math.max(1,this.height*i),c=make_canvas(s,t);c.ctx.drawImage(this.source_canvas,0,0,c.width,c.height),this.replace_source_canvas(c)}draw(){try{main_ctx.drawImage(this.canvas,this.x,this.y)}catch{}}destroy(){super.destroy(),$G$1.off("option-changed",this._on_option_changed),update_helper_layer()}}console.log("JS 실행:","color-data.js");const default_palette=["rgb(0,0,0)","rgb(128,128,128)","rgb(128,0,0)","rgb(128,128,0)","rgb(0,128,0)","rgb(0,128,128)","rgb(0,0,128)","rgb(128,0,128)","rgb(128,128,64)","rgb(0,64,64)","rgb(0,128,255)","rgb(0,64,128)","rgb(64,0,255)","rgb(128,64,0)","rgb(128,64,0,0.1)","rgb(128,64,0,0.2)","rgb(255,255,255)","rgb(192,192,192)","rgb(255,0,0)","rgb(255,255,0)","rgb(0,255,0)","rgb(0,255,255)","rgb(0,0,255)","rgb(255,0,255)","rgb(255,255,128)","rgb(0,255,128)","rgb(128,255,255)","rgb(128,128,255)","rgb(255,0,128)","rgb(255,128,64)","rgb(128,64,0,0.3)","rgb(128,64,0,0)"],basic_colors=["#FF8080","#FFFF80","#80FF80","#00FF80","#80FFFF","#0080FF","#FF80C0","#FF80FF","#FF0000","#FFFF00","#80FF00","#00FF40","#00FFFF","#0080C0","#8080C0","#FF00FF","#804040","#FF8040","#00FF00","#008080","#004080","#8080FF","#800040","#FF0080","#800000","#FF8000","#008000","#008040","#0000FF","#0000A0","#800080","#8000FF","#400000","#804000","#004000","#004040","#000080","#000040","#400040","#400080","#000000","#808000","#808040","#808080","#408080","#C0C0C0","#400040","#FFFFFF"],custom_colors=["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"],lerp=(e,i,s)=>e+(i-e)*s,color_ramp=(e,i,s)=>Array(e).fill().map((t,c,a)=>{const n=lerp(i[0],s[0],c/a.length),o=lerp(i[1],s[1],c/a.length),l=lerp(i[2],s[2],c/a.length),r=lerp(i[3],s[3],c/a.length);return`hsla(${n}deg, ${o}%, ${l}%, ${r})`}),get_winter_palette=()=>{const e=i=>[make_stripe_pattern(i,["hsl(166, 93%, 38%)","white"]),make_stripe_pattern(i,["white","hsl(355, 78%, 46%)"]),make_stripe_pattern(i,["hsl(355, 78%, 46%)","white","white","hsl(355, 78%, 46%)","hsl(355, 78%, 46%)","hsl(355, 78%, 46%)","white","white","hsl(355, 78%, 46%)","white"],2),make_stripe_pattern(i,["hsl(166, 93%, 38%)","white","white","hsl(166, 93%, 38%)","hsl(166, 93%, 38%)","hsl(166, 93%, 38%)","white","white","hsl(166, 93%, 38%)","white"],2),make_stripe_pattern(i,["hsl(166, 93%, 38%)","white","hsl(355, 78%, 46%)","white"],2)];return["black","hsl(91, 55%, 81%)","hsl(142, 57%, 64%)","hsl(166, 93%, 38%)","#04ce1f","hsl(159, 93%, 16%)","hsl(2, 77%, 27%)","hsl(350, 100%, 50%)","hsl(356, 97%, 64%)","#ad4632","#5b3b1d",...e(!1),...color_ramp(6,[200,100,100,100],[200,100,10,100]),"#fcbaf8","hsl(0, 0%, 90%)","hsl(22, 5%, 71%)","hsl(48, 82%, 54%)","hsl(49, 82%, 72%)",...e(!0)]};window.default_palette=default_palette;console.log("JS 실행:","file-format-data.js");let image_formats=[];const add_image_format=(e,i,s=image_formats)=>{const t={formatID:e,mimeType:e,name:localize(i).replace(/\s+\([^(]+$/,""),nameWithExtensions:localize(i),extensions:[]},c=/\*\.([^);,]+)/g;if(get_direction()==="rtl"){const n="‏",o="‎";t.nameWithExtensions=t.nameWithExtensions.replace(c,`${n}*.${o}$1${n}`)}let a;for(;a=c.exec(i);){const n=a[1];t.extensions.push(n)}s.push(t)};add_image_format("image/png","PNG (*.png)");add_image_format("image/webp","WebP (*.webp)");add_image_format("image/gif","GIF (*.gif)");add_image_format("image/tiff","TIFF (*.tif;*.tiff)");add_image_format("image/jpeg","JPEG (*.jpg;*.jpeg;*.jpe;*.jfif)");add_image_format("image/x-bmp-1bpp","Monochrome Bitmap (*.bmp;*.dib)");add_image_format("image/x-bmp-4bpp","16 Color Bitmap (*.bmp;*.dib)");add_image_format("image/x-bmp-8bpp","256 Color Bitmap (*.bmp;*.dib)");add_image_format("image/bmp","24-bit Bitmap (*.bmp;*.dib)");const formats_unique_per_file_extension=e=>(e=e.filter(i=>i.extensions.includes("bmp")?i.mimeType==="image/bmp":!0),e.filter((i,s)=>!i.extensions.some(t=>e.some((c,a)=>a<s&&c.extensions.includes(t))))),palette_formats=[];for(const[e,i]of Object.entries(AnyPalette$1.formats))if(i.write){const s=i.fileExtensions.map(t=>`*.${t}`).join(";");palette_formats.push({formatID:e,name:i.name,nameWithExtensions:`${i.name} (${s})`,extensions:i.fileExtensions})}palette_formats.sort((e,i)=>+(i.formatID==="RIFF_PALETTE")-+(e.formatID==="RIFF_PALETTE")||+(i.formatID==="GIMP_PALETTE")-+(e.formatID==="GIMP_PALETTE")||0);window.formats_unique_per_file_extension=formats_unique_per_file_extension;console.log("JS 실행:","storage.js");const localStore={get(e,i){let s;try{if(typeof e=="string"){const t=e,c=localStorage.getItem(t);c&&(s=JSON.parse(c))}else if(s={},Array.isArray(e)){const t=e;for(let c=0,a=t.length;c<a;c++){const n=t[c],o=localStorage.getItem(n);o&&(s[n]=JSON.parse(o))}}else{const t=e;for(const c in t){let a=t[c];const n=localStorage.getItem(c);n?s[c]=JSON.parse(n):s[c]=a}}}catch(t){i(t);return}i(null,s)},set(e,i,s){let t={};if(typeof e=="string")t={[e]:i};else{if(Array.isArray(e))throw new TypeError("Cannot set an array of keys (to what?)");t=e,s=i}for(const c in t){const a=t[c];try{localStorage.setItem(c,JSON.stringify(a))}catch(n){n.quotaExceeded=n.code===22||n.name==="NS_ERROR_DOM_QUOTA_REACHED"||n.number===-2147024882,s(n);return}}return s(null)}};console.log("JS 실행:","functions.js");const param_types={"eye-gaze-mode":"bool","vertical-color-box-mode":"bool","speech-recognition-mode":"bool",local:"string",session:"string",load:"string"},exclusive_params=["local","session","load"];function get_all_url_params(){const e={};location.hash.replace(/^#/,"").split(/,/).forEach(i=>{const s=i.indexOf(":");if(s===-1){const t=i;e[t]=!0}else{const t=i.slice(0,s),c=i.slice(s+1);e[t]=decodeURIComponent(c)}});for(const[i,s]of Object.entries(param_types))s==="bool"&&!e[i]&&(e[i]=!1);return e}function change_url_param(e,i,{replace_history_state:s=!1}={}){change_some_url_params({[e]:i},{replace_history_state:s})}function change_some_url_params(e,{replace_history_state:i=!1}={}){for(const s of exclusive_params)e[s]&&exclusive_params.forEach(t=>{t!==s&&(e[t]=null)});set_all_url_params(Object.assign({},get_all_url_params(),e),{replace_history_state:i})}function set_all_url_params(e,{replace_history_state:i=!1}={}){let s="";for(const[a,n]of Object.entries(param_types))e[a]&&(s.length&&(s+=","),s+=encodeURIComponent(a),n!=="bool"&&(s+=":"+encodeURIComponent(e[a])));let t=location.search;t.includes("frame_id")||(t="");const c=`${location.origin}${location.pathname}${t}#${s}`;try{i?history.replaceState(null,document.title,c):history.pushState(null,document.title,c)}catch{location.hash=s}$G$1.triggerHandler("change-url-params")}function update_magnified_canvas_size(){$canvas.css("width",main_canvas.width*magnification),$canvas.css("height",main_canvas.height*magnification),update_canvas_rect()}function update_canvas_rect(){window.canvas_bounding_client_rect=main_canvas.getBoundingClientRect(),update_helper_layer()}let helper_layer_update_queued=!1,info_for_updating_pointer;function update_helper_layer(e){e&&isFinite(e.clientX)&&(info_for_updating_pointer={clientX:e.clientX,clientY:e.clientY,devicePixelRatio}),!helper_layer_update_queued&&(helper_layer_update_queued=!0,requestAnimationFrame(()=>{helper_layer_update_queued=!1,update_helper_layer_immediately()}))}function update_helper_layer_immediately(){if(info_for_updating_pointer){const d=info_for_updating_pointer.devicePixelRatio/devicePixelRatio;info_for_updating_pointer.clientX*=d,info_for_updating_pointer.clientY*=d,info_for_updating_pointer.devicePixelRatio=devicePixelRatio,pointer=to_canvas_coords(info_for_updating_pointer)}const e=magnification*window.devicePixelRatio;helper_layer||(helper_layer=new OnCanvasHelperLayer(0,0,main_canvas.width,main_canvas.height,!1,e));const i=15,s=Math.floor(Math.max($canvas_area.scrollLeft()/magnification-i,0)),t=Math.floor(Math.max($canvas_area.scrollTop()/magnification-i,0)),c=Math.floor(Math.min(s+$canvas_area.width()/magnification+i*2,main_canvas.width)),a=Math.floor(Math.min(t+$canvas_area.height()/magnification+i*2,main_canvas.height)),n=c-s,o=a-t,l=n*e,r=o*e;if((helper_layer.canvas.width!==l||helper_layer.canvas.height!==r)&&(helper_layer.canvas.width=l,helper_layer.canvas.height=r,helper_layer.canvas.ctx.disable_image_smoothing(),helper_layer.width=n,helper_layer.height=o),helper_layer.x=s,helper_layer.y=t,helper_layer.position(),render_canvas_view(helper_layer.canvas,e,s,t,!0),thumbnail_canvas&&$thumbnail_window.is(":visible")){const d=parseFloat($canvas_area.css("padding-left")),h=parseFloat($canvas_area.css("padding-top")),_=main_canvas.clientWidth+d-$canvas_area[0].clientWidth,f=main_canvas.clientHeight+h-$canvas_area[0].clientHeight;let g=$canvas_area[0].scrollLeft/Math.max(1,_),x=$canvas_area[0].scrollTop/Math.max(1,f);g=Math.min(g,1),x=Math.min(x,1);let w=Math.floor(Math.max(g*(main_canvas.width-thumbnail_canvas.width),0)),S=Math.floor(Math.max(x*(main_canvas.height-thumbnail_canvas.height),0));render_canvas_view(thumbnail_canvas,1,w,S,!1)}}function render_canvas_view(e,i,s,t,c){update_fill_and_stroke_colors_and_lineWidth(selected_tool);const a=show_grid&&magnification>=4&&window.devicePixelRatio*magnification>=4&&c,n=e.ctx;n.clearRect(0,0,e.width,e.height),c||n.drawImage(main_canvas,s,t,e.width,e.height,0,0,e.width,e.height);var o=[...selected_tools];$("body").hasClass("dragging")&&!pointer_active&&(o=o.filter(r=>r.id===TOOL_CURVE||r.id===TOOL_POLYGON)),o.sort((r,d)=>r.selectBox&&!d.selectBox?-1:!r.selectBox&&d.selectBox?1:0);var l=o.findIndex(r=>r.selectBox);l>=0&&(o=o.filter((r,d)=>!r.selectBox||d==l)),o.forEach(r=>{r.drawPreviewUnderGrid&&pointer&&pointers.length<2&&(n.save(),r.drawPreviewUnderGrid(n,pointer.x,pointer.y,a,i,-s,-t),n.restore())}),selection&&(n.save(),n.scale(i,i),n.translate(-s,-t),n.drawImage(selection.canvas,selection.x,selection.y),n.restore(),!c&&!selection.dragging&&draw_selection_box(n,selection.x,selection.y,selection.width,selection.height,i,-s,-t)),textbox&&(n.save(),n.scale(i,i),n.translate(-s,-t),n.drawImage(textbox.canvas,textbox.x,textbox.y),n.restore(),!c&&!textbox.dragging&&draw_selection_box(n,textbox.x,textbox.y,textbox.width,textbox.height,i,-s,-t)),a&&draw_grid(n,i),o.forEach(r=>{r.drawPreviewAboveGrid&&pointer&&pointers.length<2&&(n.save(),r.drawPreviewAboveGrid(n,pointer.x,pointer.y,a,i,-s,-t),n.restore())})}function update_disable_aa(){const e=window.devicePixelRatio*magnification,i=Math.floor(e)===e;$canvas_area.toggleClass("disable-aa-for-things-at-main-canvas-scale",e>=3||i)}function set_magnification(e,i){window.$zoomText.text(e==.125?"12.50%":`${e*100}%`),i=i??{x:$canvas_area.scrollLeft()/magnification,y:$canvas_area.scrollTop()/magnification};const s=from_canvas_coords(i);magnification=e,e!==1&&(return_to_magnification=e),update_magnified_canvas_size();const t=from_canvas_coords(i);$canvas_area[0].scrollBy({left:t.clientX-s.clientX,top:t.clientY-s.clientY,behavior:"instant"}),$G$1.triggerHandler("resize"),$G$1.trigger("option-changed"),$G$1.trigger("magnification-changed")}function reset_selected_colors(){selected_colors={foreground:"#000000",background:"#ffffff",ternary:""},$G$1.trigger("option-changed")}function reset_file(){system_file_handle=null,file_name=localize("untitled"),file_format="image/png",saved=!0,update_title()}function reset_canvas_and_history(){undos.length=0,redos.length=0,current_history_node=root_history_node=make_history_node({name:localize("New"),icon:get_help_folder_icon("p_blank.png")}),history_node_to_cancel_to=null,main_canvas.width=Math.max(1,my_canvas_width),main_canvas.height=Math.max(1,my_canvas_height),main_ctx.disable_image_smoothing(),main_ctx.fillStyle=selected_colors.background,main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height),current_history_node.image_data=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height),$canvas_area.trigger("resize"),$G$1.triggerHandler("history-update")}function make_history_node({parent:e=null,futures:i=[],timestamp:s=Date.now(),soft:t=!1,image_data:c=null,selection_image_data:a=null,selection_x:n,selection_y:o,textbox_text:l,textbox_x:r,textbox_y:d,textbox_width:h,textbox_height:_,text_tool_font:f=null,tool_transparent_mode:g=!1,foreground_color:x,background_color:w,ternary_color:S,name:M,icon:R=null}){return{parent:e,futures:i,timestamp:s,soft:t,image_data:c,selection_image_data:a,selection_x:n,selection_y:o,textbox_text:l,textbox_x:r,textbox_y:d,textbox_width:h,textbox_height:_,text_tool_font:f,tool_transparent_mode:g,foreground_color:x,background_color:w,ternary_color:S,name:M,icon:R}}function update_title(){document.title=`${file_name} - ${is_pride_month?"June Solidarity ":""}${localize("Paint")}`,is_pride_month&&$("link[rel~='icon']").attr("href","./images/icons/gay-es-paint-16x16-light-outline.png"),window.setRepresentedFilename&&window.setRepresentedFilename(system_file_handle??""),window.setDocumentEdited&&window.setDocumentEdited(!saved)}function get_uris(e){const i=e.split(/[\n\r]+/).filter(t=>t[0]!=="#"&&t);if(i.length>15)return[];const s=[];for(let t=0;t<i.length;t++)try{const c=new URL(i[t]);s.push(c.href)}catch{}return s}async function load_image_from_uri(e){const i=e.match(/^blob:/i),s=!e.match(/^(blob|data|file):/i),t=e.match(/^(http|https):\/\/((127\.0\.0\.1|localhost)|.*(\.(local|localdomain|domain|lan|home|host|corp|invalid)))\b/i);if(i&&e.indexOf(`blob:${location.origin}`)===-1){const o=new Error("can't load blob: URI from another domain");throw o.code="cross-origin-blob-uri",o}const c=s&&!t?[e,`https://cors.bridged.cc/${e}`,`https://jspaint-cors-proxy.herokuapp.com/${e}`,`https://web.archive.org/${e}`]:[e],a=[];for(let o=0;o<c.length;o+=1){const l=c[o];try{const r=({loaded:g,total:x})=>{};s&&console.log(`Try loading image from URI (${o+1}/${c.length}): "${l}"`);const d=await fetch(l);let h=d;if(!d.ok){a.push({status:d.status,statusText:d.statusText,url:l});continue}if(!d.body)s&&console.log("ReadableStream not yet supported in this browser. Progress won't be shown for image requests.");else{const g=d.headers.get("content-encoding"),x=d.headers.get(g?"x-file-size":"content-length");if(x===null)s&&console.log("Response size header unavailable. Progress won't be shown for this image request.");else{const w=parseInt(x,10);let S=0;h=new Response(new ReadableStream({start(M){const R=d.body.getReader();C();function C(){R.read().then(({done:u,value:m})=>{if(u){M.close();return}S+=m.byteLength,r({loaded:S,total:w}),M.enqueue(m),C()}).catch(u=>{console.error(u),M.error(u)})}}}))}}const _=await h.blob();return s&&console.log("Download complete."),await new Promise((g,x)=>{read_image_file(_,(w,S)=>{w?x(w):g(S)})})}catch(r){a.push({url:l,error:r})}}const n=new Error(`failed to fetch image from any of ${c.length} URI(s):
  ${a.map(o=>(o.statusText?`${o.status} ${o.statusText} `:"")+o.url+(o.error?`
    ${o.error}`:"")).join(`
  `)}`);throw n.code="access-failure",n.fails=a,n}function open_from_image_info(e,i,s,t,c){are_you_sure$1(({canvas_modified_while_loading:a}={})=>{deselect(),cancel(),t||($G$1.triggerHandler("session-update"),new_local_session()),reset_file(),reset_selected_colors(),reset_canvas_and_history(),set_magnification(default_magnification),main_ctx.copy(e.image||e.image_data),apply_file_format_and_palette_info(e),transparency=has_any_transparency(main_ctx),$canvas_area.trigger("resize"),current_history_node.name=localize("Open"),current_history_node.image_data=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height),current_history_node.icon=get_help_folder_icon("p_open.png"),(a||!c)&&$G$1.triggerHandler("session-update"),$G$1.triggerHandler("history-update"),e.source_blob instanceof File&&(file_name=e.source_blob.name,system_file_handle=e.source_blob.path),e.source_file_handle&&(system_file_handle=e.source_file_handle),saved=!0,update_title(),i==null||i()},s,c)}function open_from_file(e,i){if(e instanceof File&&e.name.match(/\.theme(pack)?$/i)){e.text().then(load_theme_from_text,s=>{show_error_message$1(localize("Paint cannot open this file."),s)});return}read_image_file(e,(s,t)=>{if(s){AnyPalette$1.loadPalette(e,(c,a)=>{var n;if(c){show_file_format_errors({as_image_error:s,as_palette_error:c});return}palette=a.map(o=>o.toString()),$colorbox.rebuild_palette(),(n=window.console)==null||n.log(`Loaded palette: ${palette.map(()=>"%c█").join("")}`,...palette.map(o=>`color: ${o};`))});return}t.source_file_handle=i,open_from_image_info(t)})}function apply_file_format_and_palette_info(e){var i;file_format=e.file_format,enable_palette_loading_from_indexed_images&&(e.palette?((i=window.console)==null||i.log(`Loaded palette from image file: ${e.palette.map(()=>"%c█").join("")}`,...e.palette.map(s=>`color: ${s};`)),palette=e.palette,selected_colors.foreground=palette[0],selected_colors.background=palette.length===14*2?palette[14]:palette[1],$G$1.trigger("option-changed")):monochrome&&!e.monochrome&&(palette=default_palette,reset_selected_colors()),$colorbox.rebuild_palette(),monochrome=e.monochrome)}function load_theme_from_text(e){var i=parseThemeFileString(e);if(!i){show_error_message$1(localize("Paint cannot open this file."));return}applyCSSProperties(i,{recurseIntoIframes:!0}),window.themeCSSProperties=i,$G$1.triggerHandler("theme-load")}function file_new(){are_you_sure$1(()=>{deselect(),cancel(),$G$1.triggerHandler("session-update"),new_local_session(),reset_file(),reset_selected_colors(),reset_canvas_and_history(),set_magnification(default_magnification),$G$1.triggerHandler("session-update")})}async function file_open(){const{file:e,fileHandle:i}=await systemHooks.showOpenFileDialog({formats:image_formats});open_from_file(e,i)}let acknowledged_overwrite_capability=!1;const confirmed_overwrite_key="jspaint confirmed overwrite capable";try{acknowledged_overwrite_capability=localStorage[confirmed_overwrite_key]==="true"}catch(e){acknowledged_overwrite_capability=Date.now()>=2e12}async function confirm_overwrite_capability(){if(acknowledged_overwrite_capability)return!0;const{$window:e,promise:i}=showMessageBox$1({messageHTML:`
			<p>JS Paint can now save over existing files.</p>
			<p>Do you want to overwrite the file?</p>
			<p>
				<input type="checkbox" id="do-not-ask-me-again-checkbox"/>
				<label for="do-not-ask-me-again-checkbox">Don't ask me again</label>
			</p>
		`,buttons:[{label:localize("Yes"),value:"overwrite",default:!0},{label:localize("Cancel"),value:"cancel"}]});if(await i==="overwrite"){acknowledged_overwrite_capability=e.$content.find("#do-not-ask-me-again-checkbox").prop("checked");try{localStorage[confirmed_overwrite_key]=acknowledged_overwrite_capability}catch{}return!0}return!1}function file_save(e=()=>{},i=!0){deselect();const s=system_file_handle;if(!s||file_name.match(/\.(svg|pdf)$/i))return file_save_as(e,i);write_image_file(main_canvas,file_format,async t=>{const c=await systemHooks.writeBlobToHandle(s,t);c===!0&&(saved=!0,update_title()),c!==!1&&(i&&update_from_saved_file(t),e())})}function file_save_as(e=()=>{},i=!0){deselect(),systemHooks.showSaveFileDialog({dialogTitle:localize("Save As"),formats:image_formats,defaultFileName:file_name,defaultPath:typeof system_file_handle=="string"?system_file_handle:null,defaultFileFormatID:file_format,getBlob:s=>new Promise(t=>{write_image_file(main_canvas,s,c=>{t(c)})}),savedCallbackUnreliable:({newFileName:s,newFileFormatID:t,newFileHandle:c,newBlob:a})=>{saved=!0,system_file_handle=c,file_name=s,file_format=t,update_title(),e(),i&&update_from_saved_file(a)}})}function are_you_sure$1(e,i,s){saved?e():s?showMessageBox$1({message:localize(`You've modified the document while an existing document was loading.
Save the new document?`,file_name),buttons:[{label:localize("Yes"),value:"save",default:!0},{label:localize("No"),value:"discard"}]}).then(t=>{t==="save"?file_save(()=>{e()},!1):t==="discard"?e({canvas_modified_while_loading:!0}):e()}):showMessageBox$1({message:localize("Save changes to %1?",file_name),buttons:[{label:localize("Yes"),value:"save",default:!0},{label:localize("No"),value:"discard"},{label:localize("Cancel"),value:"cancel"}]}).then(t=>{t==="save"?file_save(()=>{e()},!1):t==="discard"?e():i==null||i()})}function please_enter_a_number(){showMessageBox$1({message:localize("Please enter a number.")})}function show_error_message$1(e,i){var t,c,a,n;const{$message:s}=showMessageBox$1({iconID:"error",message:e});if(i){const o=$("<details><summary><span>Details</span></summary></details>").appendTo(s),l=i;let r=l.stack;if(r)l.message&&r.indexOf(l.message)===-1?r=`${i.toString()}

${r}`:l.name&&r.indexOf(l.name)===-1&&(r=`${l.name}

${r}`);else if(r=i.toString(),r==="[object Object]")try{r=JSON.stringify(i,null,2)}catch(d){r="Error details could not be stringified: "+d}$(E("pre")).text(r).appendTo(o).css({background:"white",color:"#333",fontFamily:"monospace",width:"500px",maxWidth:"100%",overflow:"auto"})}i?(c=(t=window.console)==null?void 0:t.error)==null||c.call(t,e,i):(n=(a=window.console)==null?void 0:a.error)==null||n.call(a,e)}function show_resource_load_error_message(e){const{$window:i,$message:s}=showMessageBox$1({}),t=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;e.code==="cross-origin-blob-uri"?s.html(`
			<p>Can't load image from address starting with "blob:".</p>
			${t?'<p>Try "Copy Image" instead of "Copy Image Location".</p>':'<p>Try "Copy image" instead of "Copy image address".</p>'}
		`):e.code==="html-not-image"?s.html(`
			<p>Address points to a web page, not an image file.</p>
			<p>Try copying and pasting an image instead of a URL.</p>
		`):e.code==="decoding-failure"?s.html(`
			<p>Address doesn't point to an image file of a supported format.</p>
			<p>Try copying and pasting an image instead of a URL.</p>
		`):e.code==="access-failure"?navigator.onLine?(s.html(`
				<p>Failed to download image.</p>
				<p>Try copying and pasting an image instead of a URL.</p>
			`),e.fails&&$("<ul>").append(e.fails.map(({status:c,statusText:a,url:n})=>$("<li>").text(n).prepend($("<b>").text(`${c||""} ${a||"Failed"} `)))).appendTo(s)):s.html(`
				<p>Failed to download image.</p>
				<p>You're offline. Connect to the internet and try again.</p>
				<p>Or copy and paste an image instead of a URL, if possible.</p>
			`):s.html(`
			<p>Failed to load image from URL.</p>
			<p>Check your browser's devtools for details.</p>
		`),s.css({maxWidth:"500px"}),i.center()}function show_file_format_errors({as_image_error:e,as_palette_error:i}){let s=`
		<p>${localize("Paint cannot open this file.")}</p>
	`;e&&(s+=`
			<details>
				<summary>${localize("Bitmap Image")}</summary>
				<p>${localize("This is not a valid bitmap file, or its format is not currently supported.")}</p>
			</details>
		`);var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};const c=o=>String(o).replace(/[&<>"'`=/]/g,l=>t[l]),a=o=>o.charAt(0).toUpperCase()+o.slice(1),n=i&&!e;if(i){let o="";"errors"in i?o=`<ul dir="ltr">${i.errors.map(l=>{const r=l.__PATCHED_LIB_TO_ADD_THIS__format;return r&&l.error?`<li><b>${c(`${r.name}`)}</b>: ${c(a(l.error.message))}</li>`:`<li>${c(l.message||l)}</li>`}).join(`
`)}</ul>`:o=`<p>${c(i.message||i)}</p>`,s+=`
			<details>
				<summary>${n?"Details":localize("Palette|*.pal|").split("|")[0]}</summary>
				<p>${localize("Unexpected file format.")}</p>
				${o}
			</details>
		`}showMessageBox$1({messageHTML:s})}let $about_paint_window;const $about_paint_content=$("#about-paint"),$this_version_news=$("#news");let $latest_news=$this_version_news;location.origin!=="https://jspaint.app"&&$this_version_news.prepend($("<p>For the latest news, visit <a href='https://jspaint.app'>jspaint.app</a></p>").css({padding:"8px 15px"}));function show_about_paint(){$about_paint_window&&$about_paint_window.close(),$about_paint_window=$Window({title:localize("About Paint"),resizable:!1,maximizeButton:!1,minimizeButton:!1}),$about_paint_window.addClass("about-paint squish"),is_pride_month&&$("#about-paint-icon").attr("src","./images/icons/gay-es-paint-128x128.png"),$about_paint_window.$content.append($about_paint_content.show()).css({padding:"15px"}),$("#jspaint-update-status-area").removeAttr("hidden"),$("#failed-to-check-if-outdated").attr("hidden","hidden"),$("#outdated").attr("hidden","hidden"),$about_paint_window.$Button(localize("OK"),()=>{$about_paint_window.close()}).attr("id","close-about-paint").focus().css({float:"right",marginBottom:"10px"}),$("#refresh-to-update").on("click",i=>{i.preventDefault(),are_you_sure$1(()=>{exit_fullscreen_if_ios$1(),location.reload()})}),$about_paint_window.css({left:-innerWidth,top:-innerHeight}),$about_paint_window.center(),$("#checking-for-updates").removeAttr("hidden");const e="https://jspaint.app/?news";fetch(e).then(i=>i.text()).then(i=>{const t=new DOMParser().parseFromString(i,"text/html");$latest_news=$(t).find("#news");const c=$latest_news.find(".news-entry"),a=$this_version_news.find(".news-entry");if(!c.length)throw $latest_news=$this_version_news,new Error(`No news found at fetched site (${e})`);function n(r,d){return r.get().some(h=>d===h.id)}const o=c.get().filter(r=>!n(a,r.id)),l=a.get().filter(r=>!n(c,r.id));o.length>0?$("#outdated").removeAttr("hidden"):l.length>0&&($latest_news=$this_version_news),$("#checking-for-updates").attr("hidden","hidden"),update_css_classes_for_conditional_messages()}).catch(i=>{var s;$("#failed-to-check-if-outdated").removeAttr("hidden"),$("#checking-for-updates").attr("hidden","hidden"),update_css_classes_for_conditional_messages(),(s=window.console)==null||s.log("Couldn't check for updates.",i)})}function exit_fullscreen_if_ios$1(){if($("body").hasClass("ios"))try{document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}catch{}}function update_css_classes_for_conditional_messages(){$(".on-dev-host, .on-third-party-host, .on-official-host").hide(),location.hostname.match(/localhost|127.0.0.1/)?$(".on-dev-host").show():location.hostname.match(/jspaint.app/)?$(".on-official-host").show():$(".on-third-party-host").show(),$(".navigator-online, .navigator-offline").hide(),navigator.onLine?$(".navigator-online").show():$(".navigator-offline").show()}function paste_image_from_file(e){read_image_file(e,(i,s)=>{if(i){show_file_format_errors({as_image_error:i});return}paste(s.image||make_canvas(s.image_data))})}async function choose_file_to_paste(){const{file:e}=await systemHooks.showOpenFileDialog({formats:image_formats});if(e.type.match(/^image|application\/pdf/)){paste_image_from_file(e);return}show_error_message$1(localize("This is not a valid bitmap file, or its format is not currently supported."))}function paste(e){if(e.width>main_canvas.width||e.height>main_canvas.height){const s=localize("The image in the clipboard is larger than the bitmap.")+`
`+localize("Would you like the bitmap enlarged?");showMessageBox$1({message:s,iconID:"question",windowOptions:{icons:{16:"images/windows-16x16.png",32:"images/windows-32x32.png"}},buttons:[{label:localize("Yes"),value:"enlarge",default:!0},{label:localize("No"),value:"crop"},{label:localize("Cancel"),value:"cancel"}]}).then(t=>{t==="enlarge"?(resize_canvas_and_save_dimensions(Math.max(main_canvas.width,e.width),Math.max(main_canvas.height,e.height),{name:"Enlarge Canvas For Paste",icon:get_help_folder_icon("p_stretch_both.png")}),i(),$canvas_area.trigger("resize")):t==="crop"&&i()})}else i();function i(){deselect(),select_tool(get_tool_by_id(TOOL_SELECT));const s=Math.max(0,Math.ceil($canvas_area.scrollLeft()/magnification)),t=Math.max(0,Math.ceil($canvas_area.scrollTop()/magnification));undoable({name:localize("Paste"),icon:get_help_folder_icon("p_paste.png"),soft:!0},()=>{selection=new OnCanvasSelection(s,t,e.width,e.height,e)})}}function go_to_history_node(e,i){var n;const s=current_history_node;if(!e.image_data){i||(show_error_message$1("History entry has no image data."),(n=window.console)==null||n.log("Target history entry has no image data:",e));return}if(current_history_node=e,deselect(!0),i||cancel(!0),saved=!1,update_title(),main_ctx.copy(e.image_data),e.selection_image_data&&(selection&&selection.destroy(),e.name===localize("Free-Form Select")?select_tool(get_tool_by_id(TOOL_FREE_FORM_SELECT)):select_tool(get_tool_by_id(TOOL_SELECT)),selection=new OnCanvasSelection(e.selection_x,e.selection_y,e.selection_image_data.width,e.selection_image_data.height,e.selection_image_data)),e.textbox_text!=null){textbox&&textbox.destroy();for(const[o,l]of Object.entries(e.text_tool_font))text_tool_font[o]=l;selected_colors.foreground=e.foreground_color,selected_colors.background=e.background_color,tool_transparent_mode=e.tool_transparent_mode,$G$1.trigger("option-changed"),select_tool(get_tool_by_id(TOOL_TEXT)),textbox=new OnCanvasTextBox(e.textbox_x,e.textbox_y,e.textbox_width,e.textbox_height,e.textbox_text)}const t=get_history_ancestors(e);undos=[...t],undos.reverse();const c=redos.length>0?[redos[0],...get_history_ancestors(redos[0])]:[s,...get_history_ancestors(s)];redos.length=0;let a=e;for(;a.futures.length>0;){const o=[...a.futures];o.sort((l,r)=>c.indexOf(l)>-1?-1:c.indexOf(r)>-1?1:0),a=o[0],redos.unshift(a)}$canvas_area.trigger("resize"),$G$1.triggerHandler("session-update"),$G$1.triggerHandler("history-update")}function undoable({name:e,icon:i,use_loose_canvas_changes:s,soft:t,assume_saved:c},a){var r;c||(saved=!1,update_title());const n=current_history_node;a==null||a(),current_history_node!==n&&(show_error_message$1(`History node switched during undoable callback for ${e}. This shouldn't happen.`),(r=window.console)==null||r.log(`History node switched during undoable callback for ${e}, from`,n,"to",current_history_node));const o=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height);redos.length=0,undos.push(current_history_node);const l=make_history_node({image_data:o,selection_image_data:selection&&selection.canvas.ctx.getImageData(0,0,selection.canvas.width,selection.canvas.height),selection_x:selection&&selection.x,selection_y:selection&&selection.y,textbox_text:textbox&&textbox.$editor.val(),textbox_x:textbox&&textbox.x,textbox_y:textbox&&textbox.y,textbox_width:textbox&&textbox.width,textbox_height:textbox&&textbox.height,text_tool_font:JSON.parse(JSON.stringify(text_tool_font)),tool_transparent_mode,foreground_color:selected_colors.foreground,background_color:selected_colors.background,ternary_color:selected_colors.ternary,parent:current_history_node,name:e,icon:i,soft:t});current_history_node.futures.push(l),current_history_node=l,$G$1.triggerHandler("history-update"),$G$1.triggerHandler("session-update")}function make_or_update_undoable(e,i){current_history_node.futures.length===0&&e.match(current_history_node)?(i(),current_history_node.image_data=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height),current_history_node.selection_image_data=selection&&selection.canvas.ctx.getImageData(0,0,selection.canvas.width,selection.canvas.height),current_history_node.selection_x=selection&&selection.x,current_history_node.selection_y=selection&&selection.y,e.update_name&&(current_history_node.name=e.name),$G$1.triggerHandler("history-update")):undoable(e,i)}function undo(){if(undos.length<1)return!1;redos.push(current_history_node);let e=undos.pop();for(;e.soft&&undos.length;)redos.push(e),e=undos.pop();return go_to_history_node(e),!0}let $document_history_prompt_window;function redo(){if(redos.length<1)return $document_history_prompt_window&&$document_history_prompt_window.close(),(!$document_history_window||$document_history_window.closed)&&($document_history_prompt_window=showMessageBox$1({title:"Redo",messageHTML:"To view all branches of the history tree, click <b>Edit > History</b>.",iconID:"info"}).$window),!1;undos.push(current_history_node);let e=redos.pop();for(;e.soft&&redos.length;)undos.push(e),e=redos.pop();return go_to_history_node(e),!0}function get_history_ancestors(e){const i=[];for(e=e.parent;e;e=e.parent)i.push(e);return i}let $document_history_window;function show_document_history(){$document_history_prompt_window&&$document_history_prompt_window.close(),$document_history_window&&$document_history_window.close();const e=$document_history_window=$Window({title:"Document History",resizable:!1,maximizeButton:!1,minimizeButton:!1});e.addClass("history-window squish"),e.$content.html(`
		<label>
			<select id="history-view-mode" class="inset-deep">
				<option value="linear">Linear timeline</option>
				<option value="tree">Tree</option>
			</select>
		</label>
		<div class="history-view" tabIndex="0"></div>
	`);const i=e.$content.find(".history-view");i.focus();let s=0,t=[],c,a=e.$content.find("#history-view-mode");a.css({margin:"10px"});let n=a.val();a.on("change",()=>{n=a.val(),l()});function o(d){const h=$(`
			<div class="history-entry">
				<div class="history-entry-icon-area"></div>
				<div class="history-entry-name"></div>
			</div>
		`);if(h.find(".history-entry-name").text((d.name||"Unknown")+(d===root_history_node?" (Start of History)":"")),h.find(".history-entry-icon-area").append(d.icon),n==="tree"){let _=0;for(let f=d.parent;f;f=f.parent)_++;h.css({marginInlineStart:`${_*8}px`})}d===current_history_node?(h.addClass("current"),c=h,requestAnimationFrame(()=>{i[0].scrollTop=Math.min(h[0].offsetTop,Math.max(s,h[0].offsetTop-i[0].clientHeight+h.outerHeight()))})):get_history_ancestors(current_history_node).indexOf(d)>-1&&h.addClass("ancestor-of-current");for(const _ of d.futures)o(_);h.on("click",()=>{go_to_history_node(d)}),h.history_node=d,t.push(h)}const l=()=>{s=i.scrollTop(),i.empty(),t=[],o(root_history_node),n==="linear"?t.sort((d,h)=>d.history_node.timestamp<h.history_node.timestamp?-1:h.history_node.timestamp<d.history_node.timestamp?1:0):t.reverse(),t.forEach(d=>{i.append(d)})};l();const r=d=>{const _=t.indexOf(c)+d;t[_]&&t[_].click()};i.on("keydown",d=>{!d.ctrlKey&&!d.altKey&&!d.shiftKey&&!d.metaKey&&(d.key==="ArrowDown"||d.key==="Down"?(r(1),d.preventDefault()):(d.key==="ArrowUp"||d.key==="Up")&&(r(-1),d.preventDefault()))}),$G$1.on("history-update",l),e.on("close",()=>{$G$1.off("history-update",l)}),e.center()}function cancel(e,i){var t;if(!history_node_to_cancel_to)return;const s=i&&current_history_node.parent&&current_history_node!==history_node_to_cancel_to&&current_history_node.futures.length===0?current_history_node:null;$G$1.triggerHandler("pointerup",["canceling",i]);for(const c of selected_tools)(t=c.cancel)==null||t.call(c);if(!e&&(go_to_history_node(history_node_to_cancel_to,!0),s)){const c=s.parent.futures.indexOf(s);c===-1?(show_error_message$1("History node not found. Please report this bug."),console.log("history_node_to_discard",s),console.log("current_history_node",current_history_node),console.log("history_node_to_discard.parent",s.parent)):(s.parent.futures.splice(c,1),$G$1.triggerHandler("history-update"))}history_node_to_cancel_to=null,update_helper_layer()}function meld_selection_into_canvas(e){selection.draw(),selection.destroy(),selection=null,e||undoable({name:"Deselect",icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),use_loose_canvas_changes:!0},()=>{})}function meld_textbox_into_canvas(e){textbox.$editor.val()&&!e?(undoable({name:localize("Text"),icon:get_icon_for_tool(get_tool_by_id(TOOL_TEXT)),soft:!0},()=>{}),undoable({name:"Finish Text",icon:get_icon_for_tool(get_tool_by_id(TOOL_TEXT))},()=>{main_ctx.drawImage(textbox.canvas,textbox.x,textbox.y),textbox.destroy(),textbox=null})):(textbox.destroy(),textbox=null)}function deselect(e){var i;selection&&meld_selection_into_canvas(e),textbox&&meld_textbox_into_canvas(e);for(const s of selected_tools)(i=s.end)==null||i.call(s,main_ctx)}function delete_selection(e={}){selection&&undoable({name:e.name||localize("Clear Selection"),icon:e.icon||get_help_folder_icon("p_delete.png")},()=>{selection.destroy(),selection=null})}function select_all(){deselect(),select_tool(get_tool_by_id(TOOL_SELECT)),undoable({name:localize("Select All"),icon:get_icon_for_tool(get_tool_by_id(TOOL_SELECT)),soft:!0},()=>{selection=new OnCanvasSelection(0,0,main_canvas.width,main_canvas.height)})}const ctrlOrCmd=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)?"⌘":"Ctrl",recommendationForClipboardAccess=`Please use the keyboard: ${ctrlOrCmd}+C to copy, ${ctrlOrCmd}+X to cut, ${ctrlOrCmd}+V to paste. If keyboard is not an option, try using Chrome version 76 or higher.`;function try_exec_command(e){if(document.queryCommandEnabled(e)){if(document.execCommand(e),!navigator.userAgent.includes("Firefox")||e==="paste")return show_error_message$1(`That ${e} probably didn't work. ${recommendationForClipboardAccess}`)}else return show_error_message$1(`Cannot perform ${e}. ${recommendationForClipboardAccess}`)}function getSelectionText(){const e=document.activeElement,i=e?e.tagName.toLowerCase():null;if(i=="textarea"||i=="input"&&/^(?:text|search|password|tel|url)$/i.test(e.type)){const s=e;if(typeof s.selectionStart=="number")return s.value.slice(s.selectionStart,s.selectionEnd)}return window.getSelection?window.getSelection().toString():""}function edit_copy(e){const i=getSelectionText();if(i.length>0){if(!navigator.clipboard||!navigator.clipboard.writeText){if(e)return try_exec_command("copy");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}navigator.clipboard.writeText(i)}else if(selection&&selection.canvas){if(!navigator.clipboard||!navigator.clipboard.write){if(e)return try_exec_command("copy");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}selection.canvas.toBlob(s=>{sanity_check_blob(s,()=>{navigator.clipboard.write([new ClipboardItem(Object.defineProperty({},s.type,{value:s,enumerable:!0}))]).then(()=>{var t;(t=window.console)==null||t.log("Copied image to the clipboard.")},t=>{show_error_message$1("Failed to copy to the Clipboard.",t)})})})}}function edit_cut(e){if(!navigator.clipboard||!navigator.clipboard.write){if(e)return try_exec_command("cut");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}edit_copy(),delete_selection({name:localize("Cut"),icon:get_help_folder_icon("p_cut.png")})}async function edit_paste(e){if(document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement){if(!navigator.clipboard||!navigator.clipboard.readText){if(e)return try_exec_command("paste");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}const i=await navigator.clipboard.readText();document.execCommand("InsertText",!1,i);return}if(!navigator.clipboard||!navigator.clipboard.read){if(e)return try_exec_command("paste");show_error_message$1(`${localize("Error getting the Clipboard Data!")} ${recommendationForClipboardAccess}`);return}try{const s=await(await navigator.clipboard.read())[0].getType("image/png");paste_image_from_file(s)}catch(i){if(i.name==="NotFoundError")try{const s=await navigator.clipboard.readText();if(s){const t=get_uris(s);t.length>0?load_image_from_uri(t[0]).then(c=>{paste(c.image||make_canvas(c.image_data))},c=>{show_resource_load_error_message(c)}):show_error_message$1("The information on the Clipboard can't be inserted into Paint.")}else show_error_message$1("The information on the Clipboard can't be inserted into Paint.")}catch(s){show_error_message$1(localize("Error getting the Clipboard Data!"),s)}else show_error_message$1(localize("Error getting the Clipboard Data!"),i)}}function image_invert_colors(){apply_image_transformation({name:localize("Invert Colors"),icon:get_help_folder_icon("p_invert.png")},(e,i,s,t)=>{invert_rgb(i,t)})}function clear(){deselect(),cancel(),undoable({name:localize("Clear Image"),icon:get_help_folder_icon("p_blank.png")},()=>{saved=!1,update_title(),transparency?main_ctx.clearRect(0,0,main_canvas.width,main_canvas.height):(main_ctx.fillStyle=selected_colors.background,main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height))})}let cleanup_bitmap_view=()=>{};function view_bitmap(){cleanup_bitmap_view();const e=document.createElement("div");e.classList.add("bitmap-view","inset-deep"),document.body.appendChild(e),$(e).css({display:"flex",alignItems:"center",justifyContent:"center",position:"fixed",top:"0",left:"0",width:"100%",height:"100%",zIndex:"9999",background:"var(--Background)"}),e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen();let i,s=!1,t=setInterval(()=>{document.fullscreenElement===e||document.webkitFullscreenElement===e?s=!0:s&&cleanup_bitmap_view()},100);cleanup_bitmap_view=()=>{document.removeEventListener("fullscreenchange",c),document.removeEventListener("webkitfullscreenchange",c),document.removeEventListener("keydown",n),document.removeEventListener("mousedown",o),setTimeout(()=>{document.removeEventListener("contextmenu",l)},100),URL.revokeObjectURL(i),clearInterval(t),(document.fullscreenElement===e||document.webkitFullscreenElement===e)&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()),e.remove(),cleanup_bitmap_view=()=>{}},document.addEventListener("fullscreenchange",c,{once:!0}),document.addEventListener("webkitfullscreenchange",c,{once:!0}),document.addEventListener("keydown",n),document.addEventListener("mousedown",o),document.addEventListener("contextmenu",l);function c(){document.fullscreenElement!==e&&document.webkitFullscreenElement!==e&&cleanup_bitmap_view()}let a=!1;function n(r){if(a=a||r.repeat&&(r.key==="f"||r.key==="F"),!r.repeat){if(a&&(r.key==="f"||r.key==="F")){a=!1;return}r.preventDefault(),cleanup_bitmap_view()}}function o(r){cleanup_bitmap_view()}function l(r){r.preventDefault(),cleanup_bitmap_view()}main_canvas.toBlob(r=>{i=URL.createObjectURL(r);const d=document.createElement("img");d.src=i,e.appendChild(d)},"image/png")}function get_tool_by_id(e){for(let i=0;i<tools.length;i++)if(tools[i].id==e)return tools[i]}function select_tools(e){for(let i=0;i<e.length;i++)select_tool(e[i],i>0);update_helper_layer()}function select_tool(e,i){if(deselect(),selected_tools.length===1&&selected_tool.deselect||(return_to_tools=[...selected_tools]),i){const s=selected_tools.indexOf(e);s===-1?(selected_tools.push(e),selected_tools.sort((t,c)=>tools.indexOf(t)<tools.indexOf(c)?-1:tools.indexOf(t)>tools.indexOf(c)?1:0)):selected_tools.splice(s,1),selected_tools.length>0?selected_tool=selected_tools[selected_tools.length-1]:(selected_tool=default_tool,selected_tools=[selected_tool])}else selected_tool=e,selected_tools=[e];e.preload&&e.preload(),$toolbox.update_selected_tool()}function has_any_transparency(e){const i=e.getImageData(0,0,main_canvas.width,main_canvas.height);for(let s=0,t=i.data.length;s<t;s+=4)if(i.data[s+3]<253)return!0;return!1}function make_stripe_pattern(e,i,s=4){const t=i.map(get_rgba_from_color),c=document.createElement("canvas"),a=c.getContext("2d");c.width=i.length*s,c.height=i.length*s;const n=main_ctx.createImageData(c.width,c.height);for(let o=0;o<c.width;o+=1)for(let l=0;l<c.height;l+=1){const r=(l*n.width+o)*4,d=e?o-l:o+l,h=Math.floor((d+1e3)/s)%i.length,_=t[h];n.data[r+0]=_[0],n.data[r+1]=_[1],n.data[r+2]=_[2],n.data[r+3]=_[3]}return a.putImageData(n,0,0),main_ctx.createPattern(c,"repeat")}function make_opaque(){undoable({name:"Make Opaque",icon:get_help_folder_icon("p_make_opaque.png")},()=>{main_ctx.save(),main_ctx.globalCompositeOperation="destination-atop",main_ctx.fillStyle="white",main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height),main_ctx.restore()})}function resize_canvas_without_saving_dimensions(e,i,s={}){const t=Math.max(1,e),c=Math.max(1,i);(main_canvas.width!==t||main_canvas.height!==c)&&undoable({name:s.name||"Resize Canvas",icon:s.icon||get_help_folder_icon("p_stretch_both.png")},()=>{try{const a=main_ctx.getImageData(0,0,t,c);main_canvas.width=t,main_canvas.height=c,main_ctx.disable_image_smoothing(),transparency||(main_ctx.fillStyle=selected_colors.background,main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height));const n=make_canvas(a);main_ctx.drawImage(n,0,0)}catch(a){a.name==="NS_ERROR_FAILURE"?show_error_message$1(localize("Insufficient memory to perform operation."),a):show_error_message$1(localize("An unknown error has occurred."),a);return}$canvas_area.trigger("resize")})}function resize_canvas_and_save_dimensions(e,i,s={}){resize_canvas_without_saving_dimensions(e,i,s),localStore.set({width:main_canvas.width.toString(),height:main_canvas.height.toString()},t=>{})}function image_attributes(){image_attributes.$window&&image_attributes.$window.close();const e=image_attributes.$window=$DialogWindow(localize("Attributes"));e.addClass("attributes-window");const i=e.$main,s={[localize("File last saved:")]:localize("Not Available"),[localize("Size on disk:")]:localize("Not Available"),[localize("Resolution:")]:"72 x 72 dots per inch"},t=$(E("table")).appendTo(i);for(const x in s){const w=$(E("tr")).appendTo(t);$(E("td")).appendTo(w).text(x);const S=$(E("td")).appendTo(w).text(s[x]);s[x].indexOf("72")!==-1&&S.css("direction","ltr")}const c={px:1,in:72,cm:28.3465};let a=image_attributes.unit=image_attributes.unit||"px",n=main_canvas.width,o=main_canvas.height;const l=$(E("label")).appendTo(i).html(render_access_key(localize("&Width:"))),r=$(E("label")).appendTo(i).html(render_access_key(localize("&Height:"))),d=$(E("input")).attr({type:"number",min:1,"aria-keyshortcuts":"Alt+W W W"}).addClass("no-spinner inset-deep").appendTo(l),h=$(E("input")).attr({type:"number",min:1,"aria-keyshortcuts":"Alt+H H H"}).addClass("no-spinner inset-deep").appendTo(r);i.find("input").css({width:"40px"}).on("change keyup keydown keypress pointerdown pointermove paste drop",()=>{n=Number(d.val())*c[a],o=Number(h.val())*c[a]});const _=$(E("fieldset")).appendTo(i).append(`
		<legend>${localize("Units")}</legend>
		<div class="fieldset-body">
			<div class="radio-field"><input type="radio" name="units" id="unit-in" value="in" aria-keyshortcuts="Alt+I I"><label for="unit-in">${render_access_key(localize("&Inches"))}</label></div>
			<div class="radio-field"><input type="radio" name="units" id="unit-cm" value="cm" aria-keyshortcuts="Alt+M M"><label for="unit-cm">${render_access_key(localize("C&m"))}</label></div>
			<div class="radio-field"><input type="radio" name="units" id="unit-px" value="px" aria-keyshortcuts="Alt+P P"><label for="unit-px">${render_access_key(localize("&Pixels"))}</label></div>
		</div>
	`);_.find(`[value=${a}]`).attr({checked:!0}),_.on("change",()=>{const x=String(_.find(":checked").val());d.val(n/c[x]),h.val(o/c[x]),a=x}).triggerHandler("change");const f=$(E("fieldset")).appendTo(i).append(`
		<legend>${localize("Colors")}</legend>
		<div class="fieldset-body">
			<div class="radio-field"><input type="radio" name="colors" id="attribute-monochrome" value="monochrome" aria-keyshortcuts="Alt+B B"><label for="attribute-monochrome">${render_access_key(localize("&Black and white"))}</label></div>
			<div class="radio-field"><input type="radio" name="colors" id="attribute-polychrome" value="polychrome" aria-keyshortcuts="Alt+L L"><label for="attribute-polychrome">${render_access_key(localize("Co&lors"))}</label></div>
		</div>
	`);f.find(`[value=${monochrome?"monochrome":"polychrome"}]`).attr({checked:!0});const g=$(E("fieldset")).appendTo(i).append(`
		<legend>${localize("Transparency")}</legend>
		<div class="fieldset-body">
			<div class="radio-field"><input type="radio" name="transparency" id="attribute-transparent" value="transparent"><label for="attribute-transparent">${localize("Transparent")}</label></div>
			<div class="radio-field"><input type="radio" name="transparency" id="attribute-opaque" value="opaque"><label for="attribute-opaque">${localize("Opaque")}</label></div>
		</div>
	`);g.find(`[value=${transparency?"transparent":"opaque"}]`).attr({checked:!0}),e.$Button(localize("OK"),()=>{const x=g.find(":checked").val();f.find(":checked").val();const w=String(_.find(":checked").val());image_attributes.unit=w,transparency=x=="transparent",x=="transparent"&&(selected_colors.background="transparent");const S=c[w],M=Number(d.val())*S,R=Number(h.val())*S;resize_canvas_and_save_dimensions(~~M,~~R),!transparency&&has_any_transparency(main_ctx)&&make_opaque(),image_attributes.$window.close()},{type:"submit"}),e.$Button(localize("Cancel"),()=>{image_attributes.$window.close()}),e.$Button($.parseHTML(render_access_key(localize("&Default")))[0],()=>{n=default_canvas_width,o=default_canvas_height,d.val(n/c[a]),h.val(o/c[a])}).attr("aria-keyshortcuts","Alt+D D"),handle_keyshortcuts(e),d.select(),image_attributes.$window.center()}image_attributes.$window=null;image_attributes.unit="px";function image_flip_and_rotate(){const e=$DialogWindow(localize("Flip and Rotate"));e.addClass("flip-and-rotate");const i=$(E("fieldset")).appendTo(e.$main);i.append(`
		<legend>${localize("Flip or rotate")}</legend>
		<div class="radio-wrapper">
			<input
				type="radio"
				name="flip-or-rotate"
				id="flip-horizontal"
				value="flip-horizontal"
				aria-keyshortcuts="Alt+F"
				checked
			/><label for="flip-horizontal">${render_access_key(localize("&Flip horizontal"))}</label>
		</div>
		<div class="radio-wrapper">
			<input
				type="radio"
				name="flip-or-rotate"
				id="flip-vertical"
				value="flip-vertical"
				aria-keyshortcuts="Alt+V"
			/><label for="flip-vertical">${render_access_key(localize("Flip &vertical"))}</label>
		</div>
		<div class="radio-wrapper">
			<input
				type="radio"
				name="flip-or-rotate"
				id="rotate-by-angle"
				value="rotate-by-angle"
				aria-keyshortcuts="Alt+R"
			/><label for="rotate-by-angle">${render_access_key(localize("&Rotate by angle"))}</label>
		</div>
	`);const s=$(E("div")).appendTo(i);s.addClass("sub-options");for(const t of["&90°","&180°","&270°"]){const c=parseInt(AccessKeys.toText(t),10);s.append(`
			<div class="radio-wrapper">
				<input
					type="radio"
					name="rotate-by-angle"
					value="${c}"
					id="rotate-${c}"
					aria-keyshortcuts="Alt+${AccessKeys.get(t).toUpperCase()}"
				/><label
					for="rotate-${c}"
				>${render_access_key(t)}</label>
			</div>
		`)}s.append(`
		<div class="radio-wrapper">
			<input
				type="radio"
				name="rotate-by-angle"
				value="arbitrary"
			/><input
				type="number"
				min="-360"
				max="360"
				name="rotate-by-arbitrary-angle"
				id="custom-degrees"
				value=""
				class="no-spinner inset-deep"
				style="width: 50px"
			/>
			<label for="custom-degrees">${localize("Degrees")}</label>
		</div>
	`),s.find("#rotate-90").attr({checked:!0}),s.find("input").attr({disabled:!0}),i.find("input").on("change",()=>{const t=i.find("input[name='flip-or-rotate']:checked").val();s.find("input").attr({disabled:t!=="rotate-by-angle"})}),s.find(".radio-wrapper").on("click",t=>{i.find("input[value='rotate-by-angle']").prop("checked",!0),i.find("input").triggerHandler("change");const c=$(t.target).closest(".radio-wrapper"),a=c.find("input[type='number']")[0];a&&a.focus(),c.find("input[type='radio']").prop("checked",!0)}),i.find("input[name='rotate-by-arbitrary-angle']").on("input",()=>{i.find("input[value='rotate-by-angle']").prop("checked",!0),i.find("input[value='arbitrary']").prop("checked",!0)}),e.$Button(localize("OK"),()=>{switch(i.find("input[name='flip-or-rotate']:checked").val()){case"flip-horizontal":flip_horizontal();break;case"flip-vertical":flip_vertical();break;case"rotate-by-angle":{let c=i.find("input[name='rotate-by-angle']:checked").val();c==="arbitrary"&&(c=i.find("input[name='rotate-by-arbitrary-angle']").val());const n=Number(c)/360*TAU;if(isNaN(n)){please_enter_a_number();return}rotate(n);break}}e.close()},{type:"submit"}),e.$Button(localize("Cancel"),()=>{e.close()}),i.find("input[type='radio']").first().focus(),e.center(),handle_keyshortcuts(e)}function image_stretch_and_skew(){const e=$DialogWindow(localize("Stretch and Skew"));e.addClass("stretch-and-skew");const i=$(E("fieldset")).appendTo(e.$main);i.append(`<legend>${localize("Stretch")}</legend><table></table>`);const s=$(E("fieldset")).appendTo(e.$main);s.append(`<legend>${localize("Skew")}</legend><table></table>`);const t=(l,r,d,h,_,f,g)=>{const x=$(E("tr")).appendTo(l),w=$(E("img")).attr({src:`images/transforms/${r}.png`,width:32,height:32}).css({marginRight:"20px"}),S=("input"+Math.random()+Math.random()).replace(/\./,""),M=$(E("input")).attr({type:"number",min:f,max:g,value:h,id:S,"aria-keyshortcuts":`Alt+${AccessKeys.get(d).toUpperCase()}`}).css({width:"40px"}).addClass("no-spinner inset-deep");return $(E("td")).appendTo(x).append(w),$(E("td")).appendTo(x).append($(E("label")).html(render_access_key(d)).attr("for",S)),$(E("td")).appendTo(x).append(M),$(E("td")).appendTo(x).text(_),M},c=t(i.find("table"),"stretch-x",localize("&Horizontal:"),100,"%",1,5e3),a=t(i.find("table"),"stretch-y",localize("&Vertical:"),100,"%",1,5e3),n=t(s.find("table"),"skew-x",localize("H&orizontal:"),0,localize("Degrees"),-90,90),o=t(s.find("table"),"skew-y",localize("V&ertical:"),0,localize("Degrees"),-90,90);e.$Button(localize("OK"),()=>{const l=parseFloat(c.val())/100,r=parseFloat(a.val())/100,d=parseFloat(n.val())/360*TAU,h=parseFloat(o.val())/360*TAU;if(isNaN(l)||isNaN(r)||isNaN(d)||isNaN(h)){please_enter_a_number();return}try{stretch_and_skew(l,r,d,h)}catch(_){_.name==="NS_ERROR_FAILURE"?show_error_message$1(localize("Insufficient memory to perform operation."),_):show_error_message$1(localize("An unknown error has occurred."),_);return}e.close()},{type:"submit"}),e.$Button(localize("Cancel"),()=>{e.close()}),e.$main.find("input").first().focus().select(),e.center(),handle_keyshortcuts(e)}function handle_keyshortcuts(e){e.on("keydown",i=>{const s=e.find("[aria-keyshortcuts]");for(let t of s){const c=$(t).attr("aria-keyshortcuts").split(" ");for(const a of c)if(!!a.match(/Alt\+/i)===i.altKey&&!!a.match(/Ctrl\+/i)===i.ctrlKey&&!!a.match(/Meta\+/i)===i.metaKey&&!!a.match(/Shift\+/i)===i.shiftKey&&a.split("+").pop().toUpperCase()===i.key.toUpperCase()){i.preventDefault(),i.stopPropagation(),t.disabled&&(t=t.closest(".radio-wrapper")),t.click(),t.focus();return}}}),e.on("focusin focusout",i=>{if($(i.target).is('textarea, input:not([type="checkbox"]):not([type="radio"]):not([type="button"]):not([type="submit"]):not([type="reset"]):not([type="image"]):not([type="file"]):not([type="color"]):not([type="range"])'))for(const s of e.find("[aria-keyshortcuts]"))s._original_aria_keyshortcuts=s._original_aria_keyshortcuts??s.getAttribute("aria-keyshortcuts"),s.setAttribute("aria-keyshortcuts",s.getAttribute("aria-keyshortcuts").split(" ").filter(t=>t.match(/(Alt|Ctrl|Meta)\+/i)).join(" "));else for(const s of e.find("[aria-keyshortcuts]"))s._original_aria_keyshortcuts&&s.setAttribute("aria-keyshortcuts",s._original_aria_keyshortcuts)})}function save_as_prompt({dialogTitle:e=localize("Save As"),defaultFileName:i="",defaultFileFormatID:s,formats:t,promptForName:c=!0}){return new Promise(a=>{const n=$DialogWindow(e);n.addClass("save-as"),n.$content.attr("tabIndex",null),c&&n.$main.append(`
				<label>
					File name:
					<input type="text" class="file-name inset-deep"/>
				</label>
			`),n.$main.append(`
			<label>
				Save as type:
				<select class="file-type-select inset-deep"></select>
			</label>
		`);const o=n.$main.find(".file-type-select"),l=n.$main.find(".file-name");for(const f of t)o.append($("<option>").val(f.formatID).text(f.nameWithExtensions));c&&l.val(i);const r=()=>{const f=o.val();for(const g of t)if(g.formatID===f)return g},d=()=>{const f=(c?String(l.val()):i).match(/\.([\w\d]+)$/);if(f){const g=r(),x=f[1].toLowerCase();if(g&&g.extensions.includes(x))return;for(const w of t)w.extensions.includes(x)&&o.val(w.formatID)}};c&&l.on("input",d),s&&t.some(f=>f.formatID===s)?o.val(s):d();const h=f=>{if(!c)return;let g=l.val();const x=r();if(!x)return;const w=x.extensions,S=w[0],M=g.replace(/\.(\w{1,3}|apng|jpeg|jfif|tiff|webp|psppalette|sketchpalette|gimp|colors|scss|sass|less|styl|html|theme|themepack)$/i,""),R=M!==g,C=g.slice(M.length+1).toLowerCase();(f||R)&&w.indexOf(C)===-1&&(g=`${M}.${S}`,l.val(g))};o.on("change",()=>{h(!1)}),h(!1);const _=n.$Button(localize("Save"),()=>{n.close(),h(!0),a({newFileName:c?String(l.val()):i,newFileFormatID:String(o.val())})},{type:"submit"});n.$Button(localize("Cancel"),()=>{n.close()}),n.center(),(window.innerWidth<500||window.innerHeight<700)&&n.css({top:20}),c?l.focus().select():_.focus()})}function write_image_file(e,i,s){const t=e.getContext("2d"),c=i.match(/^image\/(?:x-)?bmp\s*(?:-(\d+)bpp)?/);if(c){const a=encodeBMP(t.getImageData(0,0,e.width,e.height),parseInt(c[1]||"24",10)),n=new Blob([a]);sanity_check_blob(n,()=>{s(n)})}else if(i==="image/png"){const a=t.getImageData(0,0,e.width,e.height),n=UPNG.encode([a.data.buffer],a.width,a.height),o=new Blob([n]);sanity_check_blob(o,()=>{s(o)})}else if(i==="image/tiff"){const a=t.getImageData(0,0,e.width,e.height),n={t305:["jspaint (UTIF.js)"]},o=UTIF.encodeImage(a.data.buffer,a.width,a.height,n),l=new Blob([o]);sanity_check_blob(l,()=>{s(l)})}else e.toBlob(a=>{sanity_check_blob(a,()=>{s(a)},[137,80,78,71,13,10,26,10],i==="image/png")},i)}function read_image_file(e,i){let s,t,c=!1;e.arrayBuffer().then(a=>{const n={png:[137,80,78,71,13,10,26,10],bmp:[66,77],jpeg:[255,216,255],gif:[71,73,70,56],webp:[87,69,66,80],tiff_be:[77,77,0,42],tiff_le:[73,73,42,0],ico:[0,0,1,0],cur:[0,0,2,0],icns:[105,99,110,115]},o=new Uint8Array(a);let l;for(const[M,R]of Object.entries(n))R.every((u,m)=>u===o[m])&&(l=M);if(l||String.fromCharCode(...o.slice(0,1024)).includes("%PDF")&&(l="pdf"),l==="bmp"){const{colorTable:M,bitsPerPixel:R,imageData:C}=decodeBMP(a);s=R===24?"image/bmp":`image/bmp;bpp=${R}`,M.length>=2&&(t=M.map(u=>`rgb(${u.r}, ${u.g}, ${u.b})`),c=!1),i(null,{file_format:s,monochrome:c,palette:t,image_data:C,source_blob:e})}else if(l==="png"){const M=UPNG.decode(a),R=UPNG.toRGBA8(M)[0],{width:C,height:u,tabs:m,ctype:y}=M;if(m.PLTE&&m.PLTE.length>=3*2&&y===3){t=new Array(m.PLTE.length/3);for(let T=0;T<t.length;T++)m.tRNS&&m.tRNS.length>=T+1?t[T]=`rgba(${m.PLTE[T*3+0]}, ${m.PLTE[T*3+1]}, ${m.PLTE[T*3+2]}, ${m.tRNS[T]/255})`:t[T]=`rgb(${m.PLTE[T*3+0]}, ${m.PLTE[T*3+1]}, ${m.PLTE[T*3+2]})`;c=!1}s="image/png";const v=new ImageData(new Uint8ClampedArray(R),C,u);i(null,{file_format:s,monochrome:c,palette:t,image_data:v,source_blob:e})}else if(l==="tiff_be"||l==="tiff_le"){var r=UTIF.decode(a),d=r,h=0,_=d[0];r[0].subIFD&&(d=d.concat(r[0].subIFD));for(var f=0;f<d.length;f++){var g=d[f];if(!(g.t258==null||g.t258.length<3)){var x=g.t256*g.t257;x>h&&(h=x,_=g)}}UTIF.decodeImage(a,_,r);var w=UTIF.toRGBA8(_),S=new ImageData(new Uint8ClampedArray(w.buffer),_.width,_.height);s="image/tiff",i(null,{file_format:s,monochrome:c,palette:t,image_data:S,source_blob:e})}else if(l==="pdf"){s="application/pdf",pdfjs$1.GlobalWorkerOptions.workerSrc="lib/pdf.js/build/pdf.worker.js";const M=new Uint8Array(a);pdfjs$1.getDocument({data:M,cMapUrl:"lib/pdf.js/web/cmaps/",cMapPacked:!0}).promise.then(C=>{console.log("PDF loaded");var u=1;C.getPage(u).then(m=>{console.log("Page loaded");var y=1.5,v=m.getViewport({scale:y}),T=make_canvas(v.width,v.height),k={canvasContext:T.ctx,viewport:v},L=m.render(k);L.promise.then(()=>{console.log("Page rendered");const A=T.ctx.getImageData(0,0,T.width,T.height);i(null,{file_format:s,monochrome:c,palette:t,image_data:A,source_blob:e})})})},C=>{i(new Error(`Failed to load PDF. ${C}`))})}else{c=!1,s={png:"image/png",webp:"image/webp",jpeg:"image/jpeg",gif:"image/gif",tiff_be:"image/tiff",tiff_le:"image/tiff",ico:"image/x-icon",cur:"image/x-win-bitmap",icns:"image/icns"}[l]||e.type;const M=URL.createObjectURL(e),R=new Image,C=()=>{URL.revokeObjectURL(M),e.text().then(u=>{const m=new Error("failed to decode blob as an image");m.code=u.match(/^\s*<!doctype\s+html/i)?"html-not-image":"decoding-failure",i(m)},u=>{const m=new Error("failed to decode blob as image or text");m.code="decoding-failure",i(m)})};R.onload=()=>{if(URL.revokeObjectURL(M),!R.complete||typeof R.naturalWidth>"u"||R.naturalWidth===0){C();return}i(null,{file_format:s,monochrome:c,palette:t,image:R,source_blob:e})},R.onerror=C,R.src=M}},a=>{i(a)})}function update_from_saved_file(e){read_image_file(e,(i,s)=>{if(i){show_error_message$1("The file has been saved, however... "+localize("Paint cannot read this file."),i);return}apply_file_format_and_palette_info(s);const t=image_formats.find(({mimeType:c})=>c===s.file_format);undoable({name:`${localize("Save As")} ${t?t.name:s.file_format}`,icon:get_help_folder_icon("p_save.png"),assume_saved:!0},()=>{main_ctx.copy(s.image||s.image_data)})})}function save_selection_to_file(){selection&&selection.canvas&&systemHooks.showSaveFileDialog({dialogTitle:localize("Save As"),defaultFileName:"selection.png",defaultFileFormatID:"image/png",formats:image_formats,getBlob:e=>new Promise(i=>{write_image_file(selection.canvas,e,s=>{i(s)})})})}function sanity_check_blob(e,i,s,t=!0){e.size>0?s?e.arrayBuffer().then(c=>{const a=new Uint8Array(c);s.every((o,l)=>o===a[l])===t?i():showMessageBox$1({message:window.is_electron_app?"Writing images in this file format is not supported.":"Your browser does not support writing images in this file format.",iconID:"error"})},c=>{show_error_message$1(localize("An unknown error has occurred."),c)}):i():show_error_message$1(localize("Failed to save document."))}window.make_history_node=make_history_node;window.open_from_file=open_from_file;window.are_you_sure=are_you_sure$1;window.show_error_message=show_error_message$1;window.show_about_paint=show_about_paint;window.exit_fullscreen_if_ios=exit_fullscreen_if_ios$1;window.get_tool_by_id=get_tool_by_id;window.sanity_check_blob=sanity_check_blob;console.log("JS 실행:","$Component.js");function get_segments(e,i,s){return $(e).find(".component").not(s).toArray().map(c=>{const a={element:c};return i==="top"?(a.pos=c.offsetTop,a.length=c.clientHeight):i==="left"?(a.pos=c.offsetLeft,a.length=c.clientWidth):i==="right"&&(a.pos=e.scrollWidth-c.offsetLeft,a.length=c.clientWidth),a})}function adjust_segments(e,i){e.sort((s,t)=>s.pos-t.pos);for(const s of e)s.pos=Math.max(s.pos,0),s.pos=Math.min(s.pos,i-s.length);for(let s=1;s<e.length;s++){const t=e[s],c=e[s-1],a=c.pos+c.length-t.pos;a>0&&(t.pos+=a)}for(const s of e)s.pos=Math.max(s.pos,0),s.pos=Math.min(s.pos,i-s.length);for(let s=e.length-2;s>=0;s--){const t=e[s],c=e[s+1],a=t.pos+t.length-c.pos;a>0&&(t.pos-=a)}}function apply_segments(e,i,s){let t=0;for(const c of s)c.margin_before=c.pos-t,t=c.length+c.pos;for(const c of s)e.appendChild(c.element),$(c.element).css(`margin-${i}`,c.margin_before)}function $Component(e,i,s,t){const c=$(E("div")).addClass("component");c.addClass(i),c.addClass(s),c.append(t),c.css("touch-action","none");const a=$ToolWindow(c);a.title(e),a.hide(),a.$content.addClass({tall:"vertical",wide:"horizontal"}[s]),i==="colors-component"&&s==="wide"&&(c.css("position","relative"),c.css(`margin-${get_direction()==="rtl"?"right":"left"}`,"3px"));let n;$("body").hasClass("eye-gaze-mode")&&(n=setInterval(()=>{c.css({transform:"scale(3)",transformOrigin:"0 0",marginRight:c[0].scrollWidth*2,marginBottom:c[0].scrollHeight*2})},200));let o,l,r,d,h,_,f=0,g,x,w,S,M;s==="tall"?g="top":get_direction()==="rtl"?g="right":g="left";const R=k=>{a.hide();const L=get_segments(k[0],g,c[0]);k.append(c),L.push({element:c[0],pos:f,length:c[0][g==="top"?"clientHeight":"clientWidth"]});const A=g==="top"?k.height():k.width();adjust_segments(L,A),apply_segments(k[0],g,L),w=k,x=f},C=(k,L)=>{const A=c.closest(".component-area")[0],F=get_segments(A,g,c[0]);c.css("position","relative"),c.css(`margin-${g}`,""),a.$content.append(c),a.show(),a.css({left:k,top:L});const K=g==="top"?$(A).height():$(A).width();adjust_segments(F,K),apply_segments(A,g,F)};a.on("window-drag-start",k=>{k.preventDefault()});const u=()=>{const k=a.is(":visible");a.show();let L,{offsetLeft:A,offsetTop:F}=c[0];if(c.closest(".tool-window").length==0){const Z=getComputedStyle(c[0]);L=$(E("div")).addClass("component").css({width:Z.width,height:Z.height}),a.append(L),{offsetLeft:A,offsetTop:F}=L[0]}const K=a[0].getBoundingClientRect();L&&L.remove(),k||a.hide();const Q=getComputedStyle(a[0]);return A+=parseFloat(Q.borderLeftWidth),F+=parseFloat(Q.borderTopWidth),{rect:K,offsetLeft:A,offsetTop:F}},m=(k=g==="top"?$left:$bottom)=>{if(c.closest(".tool-window").length==0)return{rect:c[0].getBoundingClientRect()};const L=getComputedStyle(c[0]),A=$(E("div")).addClass("component").css({width:L.width,height:L.height,flex:"0 0 auto"});k.prepend(A);const F=A[0].getBoundingClientRect();return A&&A.remove(),{rect:F}},y=k=>{const{rect:L}=S?m(S):u();h=~~(L.width/2)*2+1,_=~~(L.height/2)*2+1,M||(M=$(E("div")).addClass("component-ghost dock"),M.appendTo("body"));const A=S?0:3;M.css({position:"absolute",display:"block",width:h-A*2,height:_-A*2,left:k.clientX+(S?o:r)+A,top:k.clientY+(S?l:d)+A}),S?M.addClass("dock"):M.removeClass("dock")};c.add(a.$titlebar).on("pointerdown",k=>{if(k.button!==0||!(c.is(k.target)||$(k.target).closest(a.$titlebar).length>0&&$(k.target).closest("button").length===0)||$("body").hasClass("eye-gaze-mode"))return;const A=m(),F=c[0].getBoundingClientRect();o=F.left-k.clientX,l=F.top-k.clientY,o=-Math.min(Math.max(-o,0),A.rect.width),l=-Math.min(Math.max(-l,0),A.rect.height);const{offsetLeft:K,offsetTop:Q}=u();r=F.left-K-k.clientX,d=F.top-Q-k.clientY,$("body").addClass("dragging"),$("body").css({cursor:"default"}).addClass("cursor-bully"),$G$1.on("pointermove",v),$G$1.one("pointerup",Z=>{$G$1.off("pointermove",v),T(Z),$("body").removeClass("dragging"),$("body").css({cursor:""}).removeClass("cursor-bully"),$canvas.trigger("pointerleave")}),y(k),v(k),k.preventDefault()});const v=k=>{M.css({left:k.clientX+o,top:k.clientY+l}),S=null;const{width:L,height:A}=m().rect,F=k.clientX+o,K=k.clientY+l,Q=F+L,Z=K+A,B=5;if(s==="tall"?(g="top",F-B<$left[0].getBoundingClientRect().right&&(S=$left),Q+B>$right[0].getBoundingClientRect().left&&(S=$right)):(g=get_direction()==="rtl"?"right":"left",K-B<$top[0].getBoundingClientRect().bottom&&(S=$top),Z+B>$bottom[0].getBoundingClientRect().top&&(S=$bottom)),S){const z=S[0].getBoundingClientRect();f=(g==="top"?K:g==="right"?Q:F)-z[g],g==="right"&&(f*=-1)}y(k),k.preventDefault()},T=k=>{a.hide(),c.parent().is(".component-area")&&(w=c.parent(),S&&(x=f)),S?R(S):C(k.clientX+r,k.clientY+d),M==null||M.remove(),M=null,$G$1.trigger("resize")};return c.dock=k=>{f=x??0,R(k??w)},c.undock_to=C,c.show=()=>($(c[0]).show(),$.contains(a[0],c[0])&&a.show(),c),c.hide=()=>(c.add(a).hide(),c),c.toggle=()=>(c.is(":visible")?c.hide():c.show(),c),c.destroy=()=>{a.close(),c.remove(),clearInterval(n)},a.on("close",k=>{k.preventDefault(),a.hide()}),c}console.log("JS 실행:","error-handling-enhanced.js");var old_onerror=window.onerror;window.onerror=function(e,i,s,t,c){try{var a="";c?"stack"in c&&c.stack.indexOf(i)===-1?a=`${e}

URL: ${i}
Line: ${s}
Column: ${t}`:a=c:a=e,show_error_message$1(localize("Internal application error."),a)}catch(n){old_onerror(e,i,s,t,c),console.warn("Error in error handler:",n)}};var old_onunhandledrejection=window.onunhandledrejection,restore_new_onunhandledrejection_tid,new_onunhandledrejection=function(e){window.onunhandledrejection=old_onunhandledrejection,clearTimeout(restore_new_onunhandledrejection_tid),restore_new_onunhandledrejection_tid=setTimeout(function(){window.onunhandledrejection=new_onunhandledrejection},0);try{show_error_message$1(localize("Internal application error.")+`
Unhandled Rejection.`,e.reason)}catch(i){old_onunhandledrejection.call(window,e),console.warn("Error in unhandledrejection handler:",i)}};window.onunhandledrejection=new_onunhandledrejection;console.log("JS 실행:","$ToolBox.js");let theme_dev_blob_url;function $ToolBox(e,i){const s=$(E("div")).addClass("tools"),t=$(E("div")).addClass("tool-options");let c=!1;s.on("pointerleave",()=>{c=!1});const a=$($.map(e,(o,l)=>{const r=$(E("div")).addClass("tool");r.appendTo(s),o.$button=r,r.attr("title",o.name);const d=$(E("span")).addClass("tool-icon");d.appendTo(r);const h=()=>{const _=!theme_dev_blob_url&&((get_theme()==="modern.css"||get_theme()==="modern-dark.css"?window.devicePixelRatio!==1:window.devicePixelRatio>=3||window.devicePixelRatio%1!==0)||$("body").hasClass("eye-gaze-mode"));d.css({display:"block",position:"absolute",left:4,top:4,width:16,height:16,backgroundImage:theme_dev_blob_url?`url(${theme_dev_blob_url})`:"","--icon-index":l.toString()}),d.toggleClass("use-svg",_)};return h(),$G$1.on("theme-load resize",h),r.on("click",_=>{selected_tool===o&&o.deselect?select_tools(return_to_tools):select_tool(o)}),r.on("pointerenter",()=>{const _=()=>{c=!0};if(c)_();else{const f=setTimeout(_,300);r.on("pointerleave",()=>{clearTimeout(f)})}}),r[0]})),n=$Component(localize("Tools"),"tools-component","tall",s.add(t));return n.appendTo(get_direction()==="rtl"?$right:$left),n.update_selected_tool=()=>{a.removeClass("selected"),selected_tools.forEach(o=>{o.$button.addClass("selected")}),t.children().detach(),t.append(selected_tool.$options),t.children().trigger("update"),$canvas.css({cursor:make_css_cursor(...selected_tool.cursor)})},n.update_selected_tool(),n}let dev_theme_tool_icons=!1;try{dev_theme_tool_icons=localStorage.dev_theme_tool_icons==="true"}catch(e){}if(dev_theme_tool_icons){let e=0;$G$1.on("session-update",()=>{e+=1;const i=e;main_canvas.toBlob(s=>{i===e&&(URL.revokeObjectURL(theme_dev_blob_url),theme_dev_blob_url=URL.createObjectURL(s),$G$1.triggerHandler("theme-load"))})})}console.log("JS 실행:","edit-colors.js");let $edit_colors_window,dev_edit_colors=!1;try{dev_edit_colors=localStorage.dev_edit_colors==="true"}catch(e){}dev_edit_colors&&$(()=>{show_edit_colors_window(),$(".define-custom-colors-button").click(),$edit_colors_window.css({left:80,top:50,opacity:.5})});function show_edit_colors_window(e,i){e=e||$colorbox.data("$last_fg_color_button"),i=i||"foreground";const s=e.closest(".palette, .color-box"),t=s.find(".swatch").toArray().indexOf(e[0]),c=selected_colors[i];choose_color(c,a=>{var n;if(e=$(s.find(".swatch")[t]),!e.length){show_error_message$1("Swatch no longer exists.");return}palette[t]=a,update_$swatch(e,a),selected_colors[i]=a,$G$1.triggerHandler("option-changed"),(n=window.console)==null||n.log(`Updated palette: ${palette.map(()=>"%c█").join("")}`,...palette.map(o=>`color: ${o};`))})}function choose_color(e,i){$edit_colors_window&&$edit_colors_window.close();const s=$DialogWindow(localize("Edit Colors"));s.addClass("edit-colors-window"),$edit_colors_window=s;let t=0,c=50,a=50,n=0;const o=()=>`hsl(${t}deg, ${c}%, ${a}%)`,l=(b,N,U)=>{const[q,j,Y]=rgb_to_hsl(b,N,U);t=q*360,c=j*100,a=Y*100},r=b=>{const[N,U,q]=get_rgba_from_color(b);l(N,U,q)},d=b=>{s.$content.find(".swatch").removeClass("selected"),b.addClass("selected"),r(b[0].dataset.color),b.closest("#custom-colors")&&(n=Math.max(0,R.indexOf(S.find(".swatch.selected")[0]))),B("hslrgb")},h=(b,N)=>{const U=$('<div class="color-grid" tabindex="0">').attr({id:N});for(const J of b){const se=$Swatch(J);se.appendTo(U).addClass("inset-deep"),se.attr("tabindex",-1)}let q=U.find(".swatch:first-child");const j=8,Y=J=>{const se=U.find(".swatch:focus");if(!se.length)return;const pe=U.find(".swatch"),_e=pe.toArray().indexOf(se[0]);if(J===-1&&_e%j===0||J===1&&_e%j===j-1)return;const Ee=_e+J,X=$(pe.toArray()[Ee]);X.length&&X.focus()};return U.on("keydown",J=>{J.code==="ArrowRight"&&Y(1),J.code==="ArrowLeft"&&Y(-1),J.code==="ArrowDown"&&Y(+j),J.code==="ArrowUp"&&Y(-j),J.code==="Home"&&U.find(".swatch:first-child").focus(),J.code==="End"&&U.find(".swatch:last-child").focus(),(J.code==="Space"||J.code==="Enter")&&(d(U.find(".swatch:focus")),F())}),U.on("pointerdown",J=>{const se=$(J.target).closest(".swatch");se.length&&(d(se),F())}),U.on("dragstart",J=>{J.preventDefault()}),U.on("focusin",J=>{J.target.closest(".swatch")?q=$(J.target.closest(".swatch")):q.is(":focus")||q.focus(),U.attr("tabindex",-1)}),U.on("focusout",()=>{U.attr("tabindex",0)}),U},_=$('<div class="left-right-split">').appendTo(s.$main),f=$('<div class="left-side">').appendTo(_),g=$('<div class="right-side">').appendTo(_).hide();f.append(`<label for="basic-colors">${render_access_key("&Basic colors:")}</label>`);const x=h(basic_colors,"basic-colors").appendTo(f);f.append(`<label for="custom-colors">${render_access_key("&Custom colors:")}</label>`);const w=[];for(let b=0;b<custom_colors.length;b++){const N=b%2,U=Math.floor(b/2),q=N*8+U;w[q]=custom_colors[b]}const S=h(w,"custom-colors").appendTo(f),M=S.find(".swatch").toArray(),R=[];for(let b=0;b<M.length;b++){const N=Math.floor(b/8),q=b%8*2+N;R[q]=M[b]}const C=$('<button class="define-custom-colors-button" type="button">').html(render_access_key("&Define Custom Colors >>")).appendTo(f).on("click",b=>{b.preventDefault(),g.show(),s.addClass("defining-custom-colors"),C.attr("disabled","disabled"),s.width()>=300&&Z.h.focus(),u()}),u=()=>{(s.width()<300||document.body.classList.contains("eye-gaze-mode"))&&C.removeAttr("disabled")};$(window).on("resize",u);const m=$(`<label for="color-solid-canvas">${render_access_key("Color|S&olid")}</label>`);m.css({position:"absolute",left:10,top:244});const y=make_canvas(175,187),v=make_canvas(10,187),T=make_canvas(58,40),k=make_canvas(5,9);$(T).css({position:"absolute",left:10,top:198});let L=!1,A=!1;const F=()=>{if(!L||A){for(let b=0;b<y.height;b+=6)for(let N=-1;N<y.width;N+=3)y.ctx.fillStyle=`hsl(${N/y.width*360}deg, ${(1-b/y.height)*100}%, 50%)`,y.ctx.fillRect(N,b,3,6);if(!L){const b=~~(t/360*y.width),N=~~((1-c/100)*y.height);y.ctx.fillStyle="black",y.ctx.fillRect(b-1,N-9,3,5),y.ctx.fillRect(b-1,N+5,3,5),y.ctx.fillRect(b-9,N-1,5,3),y.ctx.fillRect(b+5,N-1,5,3)}A=!L}for(let b=-2;b<v.height;b+=6)v.ctx.fillStyle=`hsl(${t}deg, ${c}%, ${(1-b/v.height)*100}%)`,v.ctx.fillRect(0,b,v.width,6);k.ctx.fillStyle=getComputedStyle(s.$content[0]).getPropertyValue("--ButtonText");for(let b=0;b<k.width;b++)k.ctx.fillRect(b,k.width-b-1,1,1+b*2);k.style.position="absolute",k.style.left="215px",k.style.top=`${3+~~((1-a/100)*v.height)}px`,T.ctx.fillStyle=o(),T.ctx.fillRect(0,0,T.width,T.height)};F(),$(y).addClass("rainbow-canvas inset-shallow"),$(v).addClass("luminosity-canvas inset-shallow"),$(T).addClass("result-color-canvas inset-shallow").attr("id","color-solid-canvas");const K=b=>{t=Math.min(1,Math.max(0,b.offsetX/y.width))*360,c=Math.min(1,Math.max(0,1-b.offsetY/y.height))*100,B("hsrgb"),F(),b.preventDefault()};$(y).on("pointerdown",b=>{L=!0,K(b),$(y).on("pointermove",K),b.pointerId!==1234567890&&y.setPointerCapture(b.pointerId)}),$G$1.on("pointerup pointercancel",()=>{$(y).off("pointermove",K),L=!1,F()});const Q=b=>{a=Math.min(1,Math.max(0,1-b.offsetY/v.height))*100,B("lrgb"),F(),b.preventDefault()};$(v).on("pointerdown",b=>{Q(b),$(v).on("pointermove",Q),b.pointerId!==1234567890&&v.setPointerCapture(b.pointerId)}),$G$1.on("pointerup pointercancel",()=>{$(v).off("pointermove",Q)});const Z={};["hsl","rgb"].forEach((b,N)=>{[...b].forEach((U,q)=>{const j={h:"Hu&e:",s:"&Sat:",l:"&Lum:",r:"&Red:",g:"&Green:",b:"Bl&ue:"}[U],Y=document.createElement("input");Y.type="text",Y.classList.add("inset-deep"),Y.dataset.componentLetter=U,Y.dataset.min="0",Y.dataset.max={h:360,s:100,l:100,r:255,g:255,b:255}[U];const J=document.createElement("label");J.innerHTML=render_access_key(j);const se=22;$(J).css({position:"absolute",left:63+N*80,top:202+q*se,textAlign:"right",display:"inline-block",width:40,height:20,lineHeight:"20px"}),$(Y).css({position:"absolute",left:106+N*80,top:202+q*se+(q>1?1:0),width:21,height:14}),g.append(J,Y),Z[U]=Y})}),g.on("input","input",b=>{const N=b.target,U=N.dataset.componentLetter;if(U)if(N.value.match(/^\d+$/)){let q=Number(N.value);if(q<N.dataset.min?(q=N.dataset.min,N.value=q):q>N.dataset.max&&(q=N.dataset.max,N.value=q),"hsl".indexOf(U)>-1){switch(U){case"h":t=q;break;case"s":c=q;break;case"l":a=q;break}B("rgb")}else{let[j,Y,J]=get_rgba_from_color(o());const se={r:j,g:Y,b:J};se[U]=q,l(se.r,se.g,se.b),B("hsl")}F()}else N.value.length&&(B(U),N.select())}),g.on("focusout","input",b=>{const N=b.target,U=N.dataset.componentLetter;U&&(N.value.match(/^\d+$/)||(B(U),N.select()))}),s.on("keydown",b=>{if(b.code==="Enter"&&!b.altKey&&!b.ctrlKey&&!b.metaKey&&!b.shiftKey&&!b.target.closest("button")){i(o()),s.close(),b.preventDefault(),b.stopPropagation();return}if(b.altKey&&!b.ctrlKey&&!b.metaKey&&!b.shiftKey)switch(b.key){case"o":r(o()),B("hslrgb"),F();break;case"b":x.find(".swatch.selected, .swatch").focus();break;case"c":x.find(".swatch.selected, .swatch").focus();break;case"e":Z.h.focus();break;case"s":Z.s.focus();break;case"l":Z.l.focus();break;case"r":Z.r.focus();break;case"g":Z.g.focus();break;case"u":Z.b.focus();break;case"a":z.is(":visible")&&z.click();break;case"d":C.click();break;default:return}else return;b.preventDefault(),b.stopPropagation()});const B=b=>{for(const N of b){const U=Z[N],[q,j,Y]=get_rgba_from_color(o());U.value=Math.floor({h:t,s:c,l:a,r:q,g:j,b:Y}[N])}};g.append(y,v,T,m,k);const z=$('<button class="add-to-custom-colors-button" type="button">').html(render_access_key("&Add To Custom Colors")).appendTo(g).on("click",b=>{b.preventDefault();const N=o();custom_colors[n]=N,update_$swatch($(R[n]),N),n=(n+1)%custom_colors.length,s.removeClass("defining-custom-colors")});s.$Button(localize("OK"),()=>{i(o()),s.close()},{type:"submit"}),s.$Button(localize("Cancel"),()=>{s.close()}),f.append(s.$buttons);for(const b of f.find(".swatch").toArray())if(get_rgba_from_color(b.dataset.color).join(",")===get_rgba_from_color(e).join(",")){d($(b)),b.focus();break}n=Math.max(0,R.indexOf(S.find(".swatch.selected")[0])),s.find(".swatch:focus").length===0&&s.find(".swatch").first().focus(),r(e),B("hslrgb"),s.center()}console.log("JS 실행:","$ColorBox.js");function $Swatch(e){const i=$(E("div")).addClass("swatch"),s=make_canvas();return $(s).css({pointerEvents:"none"}).appendTo(i),$G$1.on("theme-load",()=>{update_$swatch(i)}),i.data("swatch",e),update_$swatch(i,e),i}function update_$swatch(e,i){if(i instanceof CanvasPattern)e.addClass("pattern"),e[0].dataset.color="";else if(typeof i=="string")e.removeClass("pattern"),e[0].dataset.color=i;else if(i!==void 0)throw new TypeError(`argument to update_$swatch must be CanvasPattern or string (or undefined); got type ${typeof i}`);i=i||e.data("swatch"),e.data("swatch",i);const s=e.find("canvas")[0];requestAnimationFrame(()=>{s.width=e.innerWidth(),s.height=e.innerHeight(),i&&(s.ctx.fillStyle=i,s.ctx.fillRect(0,0,s.width,s.height))})}function $ColorBox(e){const i=$(E("div")).addClass("color-box"),s=$Swatch(selected_colors.ternary).addClass("current-colors"),t=$(E("div")).addClass("palette");i.append(s,t);const c=$Swatch(selected_colors.foreground).addClass("color-selection foreground-color"),a=$Swatch(selected_colors.background).addClass("color-selection background-color");s.append(a,c),$G$1.on("option-changed",()=>{update_$swatch(c,selected_colors.foreground),update_$swatch(a,selected_colors.background),update_$swatch(s,selected_colors.ternary)}),s.on("pointerdown",()=>{const r=selected_colors.foreground;selected_colors.foreground=selected_colors.background,selected_colors.background=r,$G$1.triggerHandler("option-changed")});const n=r=>{const d=$Swatch(r).addClass("color-button");d.appendTo(t);const h=400;let _=!1,f=null,g;d.on("pointerdown",x=>{button===0&&l.data("$last_fg_color_button",d);const w=x.ctrlKey?"ternary":x.button===0?"foreground":x.button===2?"background":null;w&&(_&&x.button===f?show_edit_colors_window(d,w):(selected_colors[w]=d.data("swatch"),$G$1.trigger("option-changed")),clearTimeout(g),g=setTimeout(()=>{_=!1,f=null},h),_=!0,f=x.button)})},o=()=>{t.empty(),palette.forEach(n);const r=t.find(".color-button");if(e){const d=r.outerHeight()+parseFloat(getComputedStyle(r[0]).getPropertyValue("margin-top"))+parseFloat(getComputedStyle(r[0]).getPropertyValue("margin-bottom"));t.height(Math.ceil(palette.length/2)*d)}else{const d=r.outerWidth()+parseFloat(getComputedStyle(r[0]).getPropertyValue("margin-left"))+parseFloat(getComputedStyle(r[0]).getPropertyValue("margin-right"));t.width(Math.ceil(palette.length/2)*d)}l.data("$last_fg_color_button",t.find(".color-button:first-child"))};let l;return e?(l=$Component(localize("Colors"),"colors-component","tall",i),l.appendTo(get_direction()==="rtl"?$left:$right)):(l=$Component(localize("Colors"),"colors-component","wide",i),l.appendTo($bottom)),o(),$(window).on("theme-change",o),l=l,l.rebuild_palette=o,l}console.log("JS 실행:","menus.js");const looksLikeChrome=!!(window.chrome&&(window.chrome.loadTimes||window.chrome.csi)),menus={[localize("&File")]:[{label:localize("&New"),...shortcut(window.is_electron_app?"Ctrl+N":"Ctrl+Alt+N"),speech_recognition:[],action:()=>{file_new()},description:localize("Creates a new document.")},{label:localize("&Open"),...shortcut("Ctrl+O"),speech_recognition:[],action:()=>{file_open()},description:localize("Opens an existing document.")},{label:localize("&Save"),...shortcut("Ctrl+S"),speech_recognition:[],action:()=>{file_save()},description:localize("Saves the active document.")},{label:localize("Save &As"),...shortcut("Ctrl+Shift+S"),speech_recognition:[],action:()=>{file_save_as()},description:localize("Saves the active document with a new name.")},MENU_DIVIDER,{emoji_icon:"🌍",label:localize("&Language"),submenu:available_languages.map(e=>({emoji_icon:get_language_emoji(e),label:get_language_endonym(e),action:()=>{set_language(e)},enabled:()=>get_language()!=e,description:localize("Changes the language to %1.",get_iso_language_name(e))}))},{label:localize("&About Paint"),speech_recognition:[],action:()=>{show_about_paint()},description:localize("Displays information about this application.")},MENU_DIVIDER,{label:localize("E&xit"),...shortcut(window.is_electron_app?"Alt+F4":""),speech_recognition:[],action:()=>{are_you_sure$1(()=>{try{if(frameElement&&window.close&&!/\{\s*\[native code\]\s*\}/.test(window.close.toString())||window.is_electron_app){window.close();return}}catch{}window.location="https://98.js.org/"})},description:localize("Quits Paint.")}],[localize("&Edit")]:[{label:localize("&Undo"),...shortcut("Ctrl+Z"),speech_recognition:[],enabled:()=>undos.length>=1,action:()=>{undo()},description:localize("Undoes the last action.")},{label:localize("&Repeat"),...shortcut("F4"),speech_recognition:[],enabled:()=>redos.length>=1,action:()=>{redo()},description:localize("Redoes the previously undone action.")},MENU_DIVIDER,{label:localize("Cu&t"),...shortcut("Ctrl+X"),speech_recognition:[],enabled:()=>!!selection,action:()=>{edit_cut(!0)},description:localize("Cuts the selection and puts it on the Clipboard.")},{label:localize("&Copy"),...shortcut("Ctrl+C"),speech_recognition:[],enabled:()=>!!selection,action:()=>{edit_copy(!0)},description:localize("Copies the selection and puts it on the Clipboard.")},{label:localize("&Paste"),...shortcut("Ctrl+V"),speech_recognition:[],enabled:()=>!0,action:()=>{edit_paste(!0)},description:localize("Inserts the contents of the Clipboard.")},{label:localize("C&lear Selection"),...shortcut("Del"),speech_recognition:[],enabled:()=>!!selection,action:()=>{delete_selection()},description:localize("Deletes the selection.")},{label:localize("Select &All"),...shortcut("Ctrl+A"),speech_recognition:[],action:()=>{select_all()},description:localize("Selects everything.")},MENU_DIVIDER,{label:`${localize("C&opy To")}...`,speech_recognition:[],enabled:()=>!!selection,action:()=>{save_selection_to_file()},description:localize("Copies the selection to a file.")},{label:`${localize("Paste &From")}...`,speech_recognition:[],action:()=>{choose_file_to_paste()},description:localize("Pastes a file into the selection.")}],[localize("&View")]:[{label:localize("Zoom To &Window"),speech_recognition:[],description:localize("Zooms the picture to fit within the view."),action:()=>{const e=$canvas_area[0].getBoundingClientRect(),i=30;let s=Math.min((e.width-i)/main_canvas.width,(e.height-i)/main_canvas.height);s=Math.floor(100*s)/100,set_magnification(s)}},{label:localize("&View Bitmap"),...shortcut("Ctrl+F"),speech_recognition:[],action:()=>{view_bitmap()},description:localize("Displays the entire picture.")},{label:localize("&Fullscreen"),...shortcut("F11"),speech_recognition:[],enabled:()=>!!(document.fullscreenEnabled||document.webkitFullscreenEnabled),checkbox:{check:()=>!!(document.fullscreenElement||document.webkitFullscreenElement),toggle:()=>{document.fullscreenElement||document.webkitFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(),menu_bar.closeMenus()}},description:localize("Makes the application take up the entire screen.")}],[localize("&Image")]:[{label:`${localize("&Attributes")}...`,...shortcut("Ctrl+E"),speech_recognition:[],action:()=>{image_attributes()},description:localize("Changes the attributes of the picture.")},{label:localize("&Clear Image"),...shortcut(window.is_electron_app||!looksLikeChrome?"Ctrl+Shift+N":""),speech_recognition:[],action:()=>{selection||clear()},enabled:()=>!selection,description:localize("Clears the picture.")},{label:localize("&Draw Opaque"),speech_recognition:[],checkbox:{toggle:()=>{tool_transparent_mode=!tool_transparent_mode,$G$1.trigger("option-changed")},check:()=>!tool_transparent_mode},description:localize("Makes the current selection either opaque or transparent.")}]};function shortcut(e){if(!e)return{};const i=e.replace(/Ctrl/g,"Control").replace(/\bDel\b/,"Delete");return validateAriaKeyshortcuts(i)||console.error(`Invalid ARIA key shortcuts: ${JSON.stringify(i)} (from shortcut label: ${JSON.stringify(e)}) (or validator is incomplete)`),{shortcutLabel:e,ariaKeyShortcuts:i}}function validateAriaKeyshortcuts(e){const i=["Alt","Control","Shift","Meta","AltGraph"],s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","1","2","3","4","5","6","7","8","9","0","Delete","Enter","Tab","ArrowRight","ArrowLeft","ArrowUp","ArrowDown","PageUp","PageDown","End","Home","Escape","Space","Plus","Minus","Comma","Period","Slash","Backslash","Quote","Semicolon","BracketLeft","BracketRight","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"],t=e.split(" ");function c(a){const n=a.split("+");if(n.length===0)return!1;let o=!1;for(let l=0;l<n.length;l++){const r=n[l];if(i.includes(r)){if(o)return!1}else if(s.includes(r)){if(o)return!1;o=!0}else return!1}return o}for(let a=0;a<t.length;a++)if(!c(t[a]))return!1;return!0}const ariaKeyShortcutsTestCases=[["Control+A Shift+Alt+B",!0],["Control+Shift+1",!0],["Shift+Alt+T Control+5",!0],["T",!0],["ArrowLeft",!0],["Shift+T Alt+Control",!1],["T+Shift",!1],["Alt",!1],["IncredibleKey",!1],["Ctrl+Shift+A",!1]];for(const[e,i]of ariaKeyShortcutsTestCases){const s=validateAriaKeyshortcuts(e);s!==i&&console.error(`validateAriaKeyshortcuts("${e}") returned ${s} but expected ${i}`)}console.log("JS 실행:","app-state.js");const default_magnification$1=1,default_tool$1=window.get_tool_by_id(window.TOOL_PENCIL),default_canvas_width$1=683,default_canvas_height$1=384;let my_canvas_width$1=default_canvas_width$1,my_canvas_height$1=default_canvas_height$1,aliasing$1=!0,transparency$1=!1,magnification$1=default_magnification$1,return_to_magnification$1=4;const main_canvas$1=window.make_canvas();main_canvas$1.classList.add("main-canvas");const main_ctx$1=main_canvas$1.ctx;let palette$1=window.default_palette,polychrome_palette=palette$1,enable_palette_loading_from_indexed_images$1=!1,enable_fs_access_api$1=!1;const default_brush_shape$1="circle",default_brush_size$1=4,default_eraser_size$1=8,default_airbrush_size$1=9,default_pencil_size$1=1,default_stroke_size$1=1;let brush_shape$1=default_brush_shape$1,brush_size$1=default_brush_size$1,eraser_size$1=default_eraser_size$1,airbrush_size$1=default_airbrush_size$1,pencil_size$1=default_pencil_size$1,stroke_size$1=default_stroke_size$1,tool_transparent_mode$1=!1,stroke_color$1,fill_color$1,pick_color_slot$1="background",selected_tool$1=default_tool$1,selected_tools$1=[selected_tool$1],return_to_tools$1=[selected_tool$1],selected_colors$1={foreground:"",background:"",ternary:""},selection$1,textbox$1,helper_layer$1,$thumbnail_window$1,thumbnail_canvas$1,show_grid$1=!1,show_thumbnail=!1,text_tool_font$1={family:'"Arial"',size:12,line_scale:20/12,bold:!1,italic:!1,underline:!1,vertical:!1,color:"",background:""},root_history_node$1=window.make_history_node({name:"App Not Loaded Properly - Please send a bug report."}),current_history_node$1=root_history_node$1,history_node_to_cancel_to$1=null,undos$1=[],redos$1=[],file_name$1,file_format$1,system_file_handle$1,saved$1=!0,pointer$1,pointer_start$1,pointer_previous$1,pointer_active$1=!1,pointer_type$1,pointer_buttons$1,reverse$1,ctrl$1,shift$1,button$1,pointer_over_canvas$1=!1,update_helper_layer_on_pointermove_active$1=!1,pointers$1=[];const state={};state.default_magnification=default_magnification$1;state.default_tool=default_tool$1;state.default_canvas_width=default_canvas_width$1;state.default_canvas_height=default_canvas_height$1;state.my_canvas_width=my_canvas_width$1;state.my_canvas_height=my_canvas_height$1;state.aliasing=aliasing$1;state.transparency=transparency$1;state.magnification=magnification$1;state.return_to_magnification=return_to_magnification$1;state.main_canvas=main_canvas$1;state.main_ctx=main_ctx$1;state.palette=palette$1;state.polychrome_palette=polychrome_palette;state.enable_palette_loading_from_indexed_images=enable_palette_loading_from_indexed_images$1;state.enable_fs_access_api=enable_fs_access_api$1;state.brush_shape=brush_shape$1;state.brush_size=brush_size$1;state.eraser_size=eraser_size$1;state.airbrush_size=airbrush_size$1;state.pencil_size=pencil_size$1;state.stroke_size=stroke_size$1;state.tool_transparent_mode=tool_transparent_mode$1;state.stroke_color=stroke_color$1;state.fill_color=fill_color$1;state.pick_color_slot=pick_color_slot$1;state.selected_tool=selected_tool$1;state.selected_tools=selected_tools$1;state.return_to_tools=return_to_tools$1;state.selected_colors=selected_colors$1;state.selection=selection$1;state.textbox=textbox$1;state.helper_layer=helper_layer$1;state.$thumbnail_window=$thumbnail_window$1;state.thumbnail_canvas=thumbnail_canvas$1;state.show_grid=show_grid$1;state.show_thumbnail=show_thumbnail;state.text_tool_font=text_tool_font$1;state.root_history_node=root_history_node$1;state.current_history_node=current_history_node$1;state.history_node_to_cancel_to=history_node_to_cancel_to$1;state.undos=undos$1;state.redos=redos$1;state.file_name=file_name$1;state.file_format=file_format$1;state.system_file_handle=system_file_handle$1;state.saved=saved$1;state.pointer=pointer$1;state.pointer_start=pointer_start$1;state.pointer_previous=pointer_previous$1;state.pointer_active=pointer_active$1;state.pointer_type=pointer_type$1;state.pointer_buttons=pointer_buttons$1;state.reverse=reverse$1;state.ctrl=ctrl$1;state.shift=shift$1;state.button=button$1;state.pointer_over_canvas=pointer_over_canvas$1;state.update_helper_layer_on_pointermove_active=update_helper_layer_on_pointermove_active$1;state.pointers=pointers$1;Object.keys(state).forEach(e=>{window[e]=state[e]});console.log("JS 실행:","app.js");window.update_fill_and_stroke_colors_and_lineWidth=update_fill_and_stroke_colors_and_lineWidth$1;window.tool_go=tool_go;const prependDot=e=>`.${e}`,getMimeType=e=>"mimeType"in e?e.mimeType:`application/x-${e.formatID}`;window.systemHooks=window.systemHooks||{};window.systemHookDefaults={showSaveFileDialog:async({formats:e,defaultFileName:i,defaultPath:s,defaultFileFormatID:t,getBlob:c,savedCallbackUnreliable:a,dialogTitle:n})=>{if(window.showSaveFilePicker&&!window.untrusted_gesture&&enable_fs_access_api){const{newFileFormatID:o}=await save_as_prompt({dialogTitle:n,defaultFileName:i,defaultFileFormatID:t,formats:e,promptForName:!1}),l=e.find(_=>_.formatID===o),r=await c(l&&l.formatID);e=[l];let d,h;try{d=await showSaveFilePicker({types:e.map(x=>({description:x.name,accept:{[getMimeType(x)]:x.extensions.map(prependDot)}}))}),h=d.name;const _=get_file_extension(h),f=async x=>{const w=await showMessageBox$1({message:`${x}

Try adding .${l.extensions[0]} to the name. Sorry about this.`,iconID:"error",buttons:[{label:localize("Save As"),value:"show-save-as-dialog-again",default:!0},{label:localize("Save"),value:"save-without-extension"},{label:localize("Cancel"),value:"cancel"}]});if(w==="show-save-as-dialog-again")return window.systemHookDefaults.showSaveFileDialog({formats:e,defaultFileName:i,defaultPath:s,defaultFileFormatID:t,getBlob:c,savedCallbackUnreliable:a,dialogTitle:n});if(w==="save-without-extension"){const S=await d.createWritable();await S.write(r),await S.close(),a==null||a({newFileName:h,newFileFormatID:l&&l.formatID,newFileHandle:d,newBlob:r})}};if(!_)return await f(`'${h}' doesn't have an extension.`);if(!l.extensions.includes(_))return await f(`File extension '.${_}' does not match the selected file type ${l.name}.`);const g=await d.createWritable();await g.write(r),await g.close()}catch(_){if(_.name==="AbortError")return;if(_.message.match(/gesture|activation/)){show_error_message$1("Sorry, due to browser security measures, you must use the keyboard or mouse directly to save.");return}show_error_message$1(localize("Failed to save document."),_);return}a==null||a({newFileName:h,newFileFormatID:l&&l.formatID,newFileHandle:d,newBlob:r})}else{const{newFileName:o,newFileFormatID:l}=await save_as_prompt({dialogTitle:n,defaultFileName:i,defaultFileFormatID:t,formats:e}),r=await c(l);saveAs(r,o),a==null||a({newFileName:o,newFileFormatID:l,newFileHandle:null,newBlob:r})}},showOpenFileDialog:async({formats:e})=>{if(window.untrusted_gesture)throw show_error_message$1("Sorry, a file picker cannot be shown when using Speech Recognition or Eye Gaze Mode. You must click File > Open directly with the mouse, or press Ctrl+O on the keyboard."),new Error("can't show file picker reliably");if(window.showOpenFilePicker&&enable_fs_access_api){const[i]=await window.showOpenFilePicker({types:e.map(t=>({description:t.name,accept:{[getMimeType(t)]:t.extensions.map(prependDot)}}))});return{file:await i.getFile(),fileHandle:i}}else return new Promise(i=>{const s=$("<input type='file'>").on("change",()=>{i({file:s[0].files[0]}),s.remove()}).appendTo($app$1).hide().trigger("click")})},writeBlobToHandle:async(e,i)=>{if(e&&e.createWritable&&enable_fs_access_api){if(!await confirm_overwrite_capability())return!1;try{const t=await e.createWritable();return await t.write(i),await t.close(),!0}catch(t){if(t.name==="AbortError")return!1;if(t.name==="NotAllowedError")return show_error_message$1(localize("Save was interrupted, so your file has not been saved."),t),!1;if(t.name==="SecurityError"){saveAs(i,file_name);return}}}else{saveAs(i,file_name);return}},readBlobFromHandle:async e=>{if(e&&e.getFile)return await e.getFile();throw new Error(`Unknown file handle (${e})`)},setWallpaperTiled:e=>{const i=make_canvas(screen.width,screen.height),s=i.ctx.createPattern(e,"repeat");i.ctx.fillStyle=s,i.ctx.fillRect(0,0,i.width,i.height),systemHooks.setWallpaperCentered(i)},setWallpaperCentered:e=>{systemHooks.showSaveFileDialog({dialogTitle:localize("Save As"),defaultFileName:`${file_name.replace(/\.(bmp|dib|a?png|gif|jpe?g|jpe|jfif|tiff?|webp|raw)$/i,"")} wallpaper.png`,defaultFileFormatID:"image/png",formats:image_formats,getBlob:i=>new Promise(s=>{write_image_file(e,i,t=>{s(t)})})})}};for(const[e,i]of Object.entries(window.systemHookDefaults))window.systemHooks[e]=window.systemHooks[e]||i;const update_from_url_params=()=>{location.hash.match(/eye-gaze-mode/i)?$("body").hasClass("eye-gaze-mode")||($("body").addClass("eye-gaze-mode"),$G$1.triggerHandler("eye-gaze-mode-toggled"),$G$1.triggerHandler("theme-load")):$("body").hasClass("eye-gaze-mode")&&($("body").removeClass("eye-gaze-mode"),$G$1.triggerHandler("eye-gaze-mode-toggled"),$G$1.triggerHandler("theme-load")),location.hash.match(/vertical-color-box-mode|eye-gaze-mode/i)?$("body").hasClass("vertical-color-box-mode")||($("body").addClass("vertical-color-box-mode"),$G$1.triggerHandler("vertical-color-box-mode-toggled"),$G$1.triggerHandler("theme-load")):$("body").hasClass("vertical-color-box-mode")&&($("body").removeClass("vertical-color-box-mode"),$G$1.triggerHandler("vertical-color-box-mode-toggled"),$G$1.triggerHandler("theme-load")),$("body").toggleClass("compare-reference",!!location.hash.match(/compare-reference/i)),$("body").toggleClass("compare-reference-tool-windows",!!location.hash.match(/compare-reference-tool-windows/i)),setTimeout(()=>{if(location.hash.match(/compare-reference/i)){select_tool(get_tool_by_id(TOOL_SELECT));const e=576,i=432;(main_canvas.width!==e||main_canvas.height!==i)&&resize_canvas_without_saving_dimensions(e,i),location.hash.match(/compare-reference-tool-windows/i)||($toolbox$1.dock($left$1),$colorbox$1.dock($bottom$1),window.debugKeepMenusOpen=!1)}location.hash.match(/compare-reference-tool-windows/i)&&($toolbox$1.undock_to(84,35),$colorbox$1.undock_to(239,195),window.debugKeepMenusOpen=!0,$(".help-menu-button")[0].dispatchEvent(new Event("pointerdown")),$(".help-menu-button")[0].dispatchEvent(new Event("pointerup")),$("[aria-label='About Paint']")[0].dispatchEvent(new Event("pointerenter")))},500)};update_from_url_params();$G$1.on("hashchange popstate change-url-params",update_from_url_params);location.search.match(/eye-gaze-mode/)&&(change_url_param("eye-gaze-mode",!0,{replace_history_state:!0}),update_from_url_params());location.search.match(/vertical-colors?-box/)&&(change_url_param("vertical-color-box",!0,{replace_history_state:!0}),update_from_url_params());const $app$1=$(E("div")).addClass("jspaint").appendTo("body");window.$app=$app$1;const $V=$(E("div")).addClass("vertical").appendTo($app$1),$H=$(E("div")).addClass("horizontal").appendTo($V),$canvas_area$1=$(E("div")).addClass("canvas-area inset-deep").appendTo($H);window.$canvas_area=$canvas_area$1;const $canvas$1=$(main_canvas).appendTo($canvas_area$1);window.$canvas=$canvas$1;$canvas$1.css("touch-action","none");window.canvas_bounding_client_rect=main_canvas.getBoundingClientRect();const canvas_handles$1=new Handles({$handles_container:$canvas_area$1,$object_container:$canvas_area$1,get_rect:()=>({x:0,y:0,width:main_canvas.width,height:main_canvas.height}),set_rect:({width:e,height:i})=>resize_canvas_and_save_dimensions(e,i),outset:4,get_handles_offset_left:()=>parseFloat($canvas_area$1.css("padding-left"))+1,get_handles_offset_top:()=>parseFloat($canvas_area$1.css("padding-top"))+1,get_ghost_offset_left:()=>parseFloat($canvas_area$1.css("padding-left"))+1,get_ghost_offset_top:()=>parseFloat($canvas_area$1.css("padding-top"))+1,size_only:!0});window.canvas_handles=canvas_handles$1;const $top$1=$(E("div")).addClass("component-area top").prependTo($V);window.$top=$top$1;const $bottom$1=$(E("div")).addClass("component-area bottom").appendTo($V);window.$bottom=$bottom$1;const $left$1=$(E("div")).addClass("component-area left").prependTo($H);window.$left=$left$1;const $right$1=$(E("div")).addClass("component-area right").appendTo($H);window.$right=$right$1;get_direction()==="rtl"&&($left$1.appendTo($H),$right$1.prependTo($H));const $status_area=$(E("div")).addClass("status-area").appendTo($V);window.$status_area=$status_area;$(E("div")).addClass("cursor-position").appendTo($status_area);const $status_position$1=$(E("div")).addClass("status-coordinates status-field inset-shallow").appendTo($status_area);window.$status_position=$status_position$1;$(E("div")).addClass("status-divider start").appendTo($status_area);$(E("div")).addClass("shape-size").appendTo($status_area);const $status_size$1=$(E("div")).addClass("status-coordinates status-field inset-shallow").appendTo($status_area);window.$status_size=$status_size$1;$(E("div")).addClass("status-divider").appendTo($status_area);$(E("div")).addClass("screen-size").appendTo($status_area);const $window_Status=$(E("div")).addClass("status-coordinates status-field inset-shallow").appendTo($status_area);window.$window_Status=$window_Status;$(E("div")).addClass("status-divider").appendTo($status_area);$(E("div")).addClass("save-icon").appendTo($status_area);const $file_status=$(E("div")).addClass("status-coordinates status-field inset-shallow").appendTo($status_area);window.$file_status=$file_status;$(E("div")).addClass("status-divider").appendTo($status_area);$(E("div")).addClass("status-spacer").appendTo($status_area);$(E("div")).addClass("status-divider end").appendTo($status_area);const $zoomBox=$(E("div")).addClass("zoom-box").appendTo($status_area),$zoomText=$(E("div")).addClass("zoom-text status-field").text("100%").appendTo($zoomBox);window.$zoomText=$zoomText;const $decreaseButton=$(E("div")).addClass("zoom-button zoom-out").appendTo($zoomBox),$leftSlider=$(E("div")).addClass("added-slider left").appendTo($zoomBox);$(E("div")).addClass("added-slider-content left").appendTo($leftSlider);const sliderArea=$(E("div")).addClass("slider-area").appendTo($zoomBox),$zoomSlider=$(E("div")).appendTo(sliderArea),$rightSlider=$(E("div")).addClass("added-slider right").appendTo($zoomBox);$(E("div")).addClass("added-slider-content right").appendTo($rightSlider);const $increaseButton=$(E("div")).addClass("zoom-button zoom-in").appendTo($zoomBox);$(E("div")).addClass("status-divider end").appendTo($status_area);const values=[0,2,4,8,10,11,12,13,14,15,16],valuesToScale={0:.125,2:.25,4:.5,8:1,10:2,11:3,12:4,13:5,14:6,15:7,16:8};$decreaseButton.on("click",function(){const e=$zoomSlider.slider("value"),i=values.indexOf(e);let s=valuesToScale[e];i>0&&($zoomSlider.slider("value",values[i-1]),s=valuesToScale[values[i-1]]),set_magnification(s)});$increaseButton.on("click",function(){const e=$zoomSlider.slider("value"),i=values.indexOf(e);let s=valuesToScale[e];i<values.length-1&&($zoomSlider.slider("value",values[i+1]),s=valuesToScale[values[i+1]]),set_magnification(s)});$zoomSlider.slider({min:0,max:16,value:8,step:1,create:function(){$(this).find(".ui-slider-handle").html(`
			<svg width="10" height="17" viewBox="0 0 10 17">
				<polygon points="0,0 10,0 10,13 5,17 0,13" fill="#0078D7"></polygon>
			</svg>
		`).addClass("custom-handle")},slide:function(e,i){let s=i.value;if(values.includes(s)){const t=valuesToScale[s];return set_magnification(t),!0}else return!1}});let menu_bar_outside_frame=!1;if(frameElement)try{parent.MenuBar&&(MenuBar=parent.MenuBar,menu_bar_outside_frame=!0)}catch{}const menu_bar$1=MenuBar(menus);window.menu_bar=menu_bar$1;menu_bar_outside_frame?$(menu_bar$1.element).insertBefore(frameElement):$(menu_bar$1.element).prependTo($V);$(menu_bar$1.element).on("info",e=>{});$(menu_bar$1.element).on("default-info",()=>{});let $toolbox$1=$ToolBox(tools);window.$toolbox=$toolbox$1;let $colorbox$1=$ColorBox($("body").hasClass("vertical-color-box-mode"));window.$colorbox=$colorbox$1;$G$1.on("vertical-color-box-mode-toggled",()=>{$colorbox$1.destroy(),$colorbox$1=$ColorBox($("body").hasClass("vertical-color-box-mode")),window.$colorbox=$colorbox$1,prevent_selection($colorbox$1)});$G$1.on("eye-gaze-mode-toggled",()=>{$colorbox$1.destroy(),$colorbox$1=$ColorBox($("body").hasClass("vertical-color-box-mode")),window.$colorbox=$colorbox$1,prevent_selection($colorbox$1),$toolbox$1.destroy(),$toolbox$1=$ToolBox(tools),window.$toolbox=$toolbox$1,prevent_selection($toolbox$1)});$G$1.on("resize",()=>{update_canvas_rect(),update_disable_aa()});$canvas_area$1.on("scroll",()=>{update_canvas_rect()});$canvas_area$1.on("resize",()=>{update_magnified_canvas_size()});$G$1.on("scroll focusin",()=>{window.scrollTo(0,0)});$("body").on("dragover dragenter",e=>{const i=e.originalEvent.dataTransfer;i&&Array.from(i.types).includes("Files")&&e.preventDefault()}).on("drop",async e=>{if(e.isDefaultPrevented())return;const i=e.originalEvent.dataTransfer;if(i&&Array.from(i.types).includes("Files")){if(e.preventDefault(),window.FileSystemHandle&&!window.is_electron_app){for(const t of i.items)if(t.kind==="file"){let c;try{"getAsFileSystemHandle"in t&&(c=await t.getAsFileSystemHandle())}catch(a){show_error_message$1(localize("File not found."),a);return}if(!c||c.kind==="file"){let a;try{c&&c instanceof FileSystemFileHandle?a=await c.getFile():a=t.getAsFile()}catch(n){show_error_message$1(localize("File not found."),n);return}if(open_from_file(a,c),window._open_images_serially)await new Promise(n=>setTimeout(n,500));else return}}}else if(i.files&&i.files.length)if(window._open_images_serially){let t=0;const c=setInterval(()=>{console.log("opening",i.files[t].name),open_from_file(i.files[t]),t++,t>=i.files.length&&clearInterval(c)},1500)}else open_from_file(i.files[0])}});$G$1.on("keydown",e=>{var s;const i=e.target;if(!e.isDefaultPrevented()){if(e.key==="Escape"&&textbox&&textbox.$editor.is(i)&&deselect(),(e.ctrlKey||e.metaKey)&&e.shiftKey&&!e.altKey&&e.key.toUpperCase()==="Y"){show_document_history(),e.preventDefault();return}if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)){if(selection){const t=(c,a)=>{selection.x+=c,selection.y+=a,selection.position()};switch(e.key){case"ArrowLeft":t(-1,0),e.preventDefault();break;case"ArrowRight":t(1,0),e.preventDefault();break;case"ArrowDown":t(0,1),e.preventDefault();break;case"ArrowUp":t(0,-1),e.preventDefault();break}}if(e.key==="Escape")selection?deselect():cancel();else if(e.key==="Enter")selection&&deselect();else if(e.key==="F4")redo();else if(e.key==="Delete"||e.key==="Backspace")e.key==="Delete"&&e.shiftKey?edit_cut():e.key==="Backspace"&&e.altKey?undo():delete_selection(),e.preventDefault();else if(e.key==="Insert")e.ctrlKey?(edit_copy(),e.preventDefault()):e.shiftKey&&(edit_paste(),e.preventDefault());else if(e.code==="NumpadAdd"||e.code==="NumpadSubtract"||e.key==="+"||e.key==="-"||e.key==="="){const t=e.code==="NumpadAdd"||e.key==="+"||e.key==="=",c=e.code==="NumpadSubtract"||e.key==="-",a=Number(t)-Number(c);selection?selection.scale(2**a):(selected_tool.id===TOOL_BRUSH?brush_size=Math.max(1,Math.min(brush_size+a,500)):selected_tool.id===TOOL_ERASER?eraser_size=Math.max(1,Math.min(eraser_size+a,500)):selected_tool.id===TOOL_AIRBRUSH?airbrush_size=Math.max(1,Math.min(airbrush_size+a,500)):selected_tool.id===TOOL_PENCIL?pencil_size=Math.max(1,Math.min(pencil_size+a,50)):(selected_tool.id===TOOL_LINE||selected_tool.id===TOOL_CURVE||selected_tool.id===TOOL_RECTANGLE||selected_tool.id===TOOL_ROUNDED_RECTANGLE||selected_tool.id===TOOL_ELLIPSE||selected_tool.id===TOOL_POLYGON)&&(stroke_size=Math.max(1,Math.min(stroke_size+a,500))),$G$1.trigger("option-changed"),button!==void 0&&pointer&&selected_tools.forEach(n=>{tool_go(n)}),update_helper_layer()),e.preventDefault();return}else if(e.ctrlKey||e.metaKey){if(textbox)switch(e.key.toUpperCase()){case"A":case"Z":case"Y":case"I":case"B":case"U":return}if(e.key==="PageDown"){set_magnification(4),e.preventDefault();return}else if(e.key==="PageUp"){set_magnification(1),e.preventDefault();return}switch(e.key.toUpperCase()){case",":case"<":case"[":case"{":rotate(-TAU/4);break;case".":case">":case"]":case"}":rotate(+TAU/4);break;case"Z":e.shiftKey?redo():undo();break;case"Y":redo();break;case"G":break;case"F":!e.repeat&&!((s=e.originalEvent)!=null&&s.repeat)&&view_bitmap();break;case"O":file_open();break;case"S":e.shiftKey?file_save_as():file_save();break;case"A":select_all();break;case"I":image_invert_colors();break;case"E":image_attributes();break;case"N":e.shiftKey?clear():file_new();break;case"T":$toolbox$1.toggle();break;case"L":$colorbox$1.toggle();break;case"R":image_flip_and_rotate();break;case"W":image_stretch_and_skew();break;default:return}e.preventDefault()}}}});let alt_zooming=!1;addEventListener("keyup",e=>{e.key==="Alt"&&alt_zooming&&e.preventDefault(),e.altKey||(alt_zooming=!1)});addEventListener("wheel",e=>{if(e.altKey){e.preventDefault();let i=magnification;e.deltaY<0?i*=1.5:i/=1.5,i=Math.max(.5,Math.min(i,80)),set_magnification(i,to_canvas_coords(e)),alt_zooming=!0;return}if(!(e.ctrlKey||e.metaKey)&&location.hash.match(/compare-reference/i)){const i=Math.sign(e.deltaY)*-.2;let s=parseFloat($("body").attr("data-reference-opacity"));isFinite(s)||(s=.5);const t=Math.max(0,Math.min(1,s+i));$("body").attr("data-reference-opacity",t)}},{passive:!1});$G$1.on("cut copy paste",e=>{if(e.isDefaultPrevented()||document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement||!window.getSelection().isCollapsed)return;e.preventDefault();const i=e.originalEvent.clipboardData||window.clipboardData;if(i){if(e.type==="copy"||e.type==="cut"){if(selection&&selection.canvas){const s=()=>{const t=selection.canvas.toDataURL();i.setData("text/x-data-uri; type=image/png",t),i.setData("text/uri-list",t),i.setData("URL",t),e.type==="cut"&&delete_selection({name:localize("Cut"),icon:get_help_folder_icon("p_cut.png")})};if(!navigator.clipboard||!navigator.clipboard.write)return s();try{e.type==="cut"?edit_cut():edit_copy()}catch{s()}}}else if(e.type==="paste"){for(const s of i.items)if(s.type.match(/^text\/(?:x-data-uri|uri-list|plain)|URL$/)){s.getAsString(t=>{const c=get_uris(t);c.length>0?load_image_from_uri(c[0]).then(a=>{paste(a.image||make_canvas(a.image_data))},a=>{show_resource_load_error_message(a)}):show_error_message$1("The information on the Clipboard can't be inserted into Paint.")});break}else if(s.type.match(/^image\//)){paste_image_from_file(s.getAsFile());break}}}});reset_file();reset_selected_colors();reset_canvas_and_history();set_magnification(default_magnification);localStore.get({width:default_canvas_width,height:default_canvas_height},(e,i)=>{e||(my_canvas_width=Number(i.width),my_canvas_height=Number(i.height),make_or_update_undoable({match:s=>s.name===localize("New"),name:"Resize Canvas For New Document",icon:get_help_folder_icon("p_stretch_both.png")},()=>{main_canvas.width=Math.max(1,my_canvas_width),main_canvas.height=Math.max(1,my_canvas_height),main_ctx.disable_image_smoothing(),transparency||(main_ctx.fillStyle=selected_colors.background,main_ctx.fillRect(0,0,main_canvas.width,main_canvas.height)),$canvas_area$1.trigger("resize")}))});window.initial_system_file_handle&&systemHooks.readBlobFromHandle(window.initial_system_file_handle).then(e=>{e&&open_from_file(e,window.initial_system_file_handle)},e=>{show_error_message$1(`Failed to open file ${window.initial_system_file_handle}`,e)});const update_palette_from_theme=()=>{get_theme()==="winter.css"?(palette=get_winter_palette(),$colorbox$1.rebuild_palette()):(palette=default_palette,$colorbox$1.rebuild_palette())};$G$1.on("theme-load",update_palette_from_theme);update_palette_from_theme();function update_fill_and_stroke_colors_and_lineWidth$1(e){main_ctx.lineWidth=stroke_size;const i=!!(e.$options&&e.$options.fill&&!e.$options.stroke),s=ctrl&&selected_colors.ternary&&pointer_active?"ternary":reverse!==i?"background":"foreground";main_ctx.fillStyle=fill_color=main_ctx.strokeStyle=stroke_color=selected_colors[s];let t=ctrl?"ternary":reverse!==i?"background":"foreground",c=t;(e.shape||e.shape_colors)&&(e.stroke_only||(reverse!==i?(t="foreground",c="background"):(t="background",c="foreground")),main_ctx.fillStyle=fill_color=selected_colors[t],main_ctx.strokeStyle=stroke_color=selected_colors[c]),pick_color_slot=t}function tool_go(e,i){update_fill_and_stroke_colors_and_lineWidth$1(e),e[i]&&e[i](main_ctx,pointer.x,pointer.y),e.paint&&e.paint(main_ctx,pointer.x,pointer.y)}function canvas_pointer_move(e){if(ctrl=e.ctrlKey,shift=e.shiftKey,pointer=to_canvas_coords(e),pointers.length&&e.button!=-1&&(e.pointerType!=pointer_type||(e.buttons|4)!=(pointer_buttons|4))){cancel(),pointer_active=!1;return}if(e.shiftKey){if(selected_tool.id===TOOL_LINE||selected_tool.id===TOOL_CURVE){const i=Math.sqrt((pointer.y-pointer_start.y)*(pointer.y-pointer_start.y)+(pointer.x-pointer_start.x)*(pointer.x-pointer_start.x)),s=TAU/8,t=Math.atan2(pointer.y-pointer_start.y,pointer.x-pointer_start.x)/s,c=Math.round(t)*s;pointer.x=Math.round(pointer_start.x+Math.cos(c)*i),pointer.y=Math.round(pointer_start.y+Math.sin(c)*i)}else if(selected_tool.shape){const i=Math.abs(pointer.x-pointer_start.x),s=Math.abs(pointer.y-pointer_start.y);i<s?pointer.y>pointer_start.y?pointer.y=pointer_start.y+i:pointer.y=pointer_start.y-i:pointer.x>pointer_start.x?pointer.x=pointer_start.x+s:pointer.x=pointer_start.x-s}}selected_tools.forEach(i=>{tool_go(i)}),pointer_previous=pointer}$canvas$1.on("pointermove",e=>{pointer=to_canvas_coords(e),$status_position$1.text(`${pointer.x}, ${pointer.y} px`)});$canvas$1.on("pointerenter",e=>{pointer_over_canvas=!0,update_helper_layer(e),update_helper_layer_on_pointermove_active||($G$1.on("pointermove",update_helper_layer),update_helper_layer_on_pointermove_active=!0)});$canvas$1.on("pointerleave",e=>{pointer_over_canvas=!1,$status_position$1.text(""),update_helper_layer(e),!pointer_active&&update_helper_layer_on_pointermove_active&&($G$1.off("pointermove",update_helper_layer),update_helper_layer_on_pointermove_active=!1)});let last_zoom_pointer_distance,pan_last_pos,first_pointer_time;const discard_quick_undo_period=500;function average_points(e){const i={x:0,y:0};for(const s of e)i.x+=s.x,i.y+=s.y;return i.x/=e.length,i.y/=e.length,i}$canvas_area$1.on("pointerdown",e=>{if(document.activeElement instanceof HTMLElement&&document.activeElement!==document.body&&document.activeElement!==document.documentElement&&document.activeElement.blur(),pointers.every(i=>i.pointerId!==1234567890&&!(i.isPrimary&&(i.pointerType==="mouse"||i.pointerType==="pen")))&&pointers.push({pointerId:e.pointerId,pointerType:e.pointerType,isPrimary:e.originalEvent&&e.originalEvent.isPrimary||e.isPrimary,x:e.clientX,y:e.clientY}),pointers.length===1&&(first_pointer_time=performance.now()),pointers.length==2&&(last_zoom_pointer_distance=Math.hypot(pointers[0].x-pointers[1].x,pointers[0].y-pointers[1].y),pan_last_pos=average_points(pointers)),pointers.length>=2){const i=first_pointer_time&&performance.now()-first_pointer_time<discard_quick_undo_period;cancel(!1,i),pointer_active=!1;return}});$G$1.on("pointerup pointercancel",e=>{pointers=pointers.filter(i=>i.pointerId!==e.pointerId)});$G$1.on("pointermove",e=>{for(const i of pointers)i.pointerId===e.pointerId&&(i.x=e.clientX,i.y=e.clientY);if(pointers.length>=2){const i=average_points(pointers),s=Math.hypot(pointers[0].x-pointers[1].x,pointers[0].y-pointers[1].y),t=s-last_zoom_pointer_distance;let c=magnification;Math.abs(t)>60&&(last_zoom_pointer_distance=s,t>0?c*=1.5:c/=1.5),c=Math.max(.5,Math.min(c,40)),c!=magnification&&set_magnification(c,to_canvas_coords({clientX:i.x,clientY:i.y}));const a=i.x-pan_last_pos.x,n=i.y-pan_last_pos.y;$canvas_area$1.scrollLeft($canvas_area$1.scrollLeft()-a),$canvas_area$1.scrollTop($canvas_area$1.scrollTop()-n),pan_last_pos=i}});$canvas$1.on("pointerdown",e=>{if($status_size$1.text(""),update_canvas_rect(),pointers.length>=1){const s=first_pointer_time&&performance.now()-first_pointer_time<discard_quick_undo_period;cancel(!1,s),pointer_active=!1,pointers=pointers.filter(t=>t.pointerId!==1234567890);return}if(history_node_to_cancel_to=current_history_node,pointer_active=!!(e.buttons&3),pointer_type=e.pointerType,pointer_buttons=e.buttons,$G$1.one("pointerup",s=>{pointer_active=!1,update_helper_layer(s),!pointer_over_canvas&&update_helper_layer_on_pointermove_active&&($G$1.off("pointermove",update_helper_layer),update_helper_layer_on_pointermove_active=!1)}),e.button===0)reverse=!1;else if(e.button===2)reverse=!0;else return;button=e.button,ctrl=e.ctrlKey,shift=e.shiftKey,pointer_start=pointer_previous=pointer=to_canvas_coords(e),(()=>{let s=[];selected_tools.forEach(t=>{(t.paint||t.pointerdown)&&tool_go(t,"pointerdown"),t.paint_on_time_interval!=null&&s.push(setInterval(()=>{tool_go(t)},t.paint_on_time_interval))}),$G$1.on("pointermove",canvas_pointer_move),$G$1.one("pointerup",(t,c,a)=>{button=void 0,reverse=!1,t.clientX!==void 0&&(pointer=to_canvas_coords(t)),a||selected_tools.forEach(n=>{var o;(o=n.pointerup)==null||o.call(n,main_ctx,pointer.x,pointer.y)}),selected_tools.length===1&&selected_tool.deselect&&select_tools(return_to_tools),$G$1.off("pointermove",canvas_pointer_move);for(const n of s)clearInterval(n);c||(history_node_to_cancel_to=null)})})(),update_helper_layer(e)});$canvas_area$1.on("pointerdown",e=>{e.button===0&&$canvas_area$1.is(e.target)&&selection&&deselect()});function prevent_selection(e){e.on("mousedown selectstart contextmenu",i=>{i.isDefaultPrevented()||i.target instanceof HTMLSelectElement||i.target instanceof HTMLTextAreaElement||i.target instanceof HTMLLabelElement&&i.type!=="contextmenu"||i.target instanceof HTMLInputElement&&i.target.type!=="color"||i.button!==1&&(i.preventDefault(),window.getSelection().removeAllRanges())})}prevent_selection($app$1);prevent_selection($toolbox$1);prevent_selection($colorbox$1);$G$1.on("blur",()=>{$G$1.triggerHandler("pointerup")});function iOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}$("html").toggleClass("ios",iOS());$G$1.on("fullscreenchange webkitfullscreenchange",()=>{const e=!!(document.fullscreenElement||document.webkitFullscreenElement);$("html").toggleClass("fullscreen",e)});window.api_for_cypress_tests={reset_for_next_test(){selected_colors.foreground="#000",selected_colors.background="#fff",brush_shape=default_brush_shape,brush_size=default_brush_size,eraser_size=default_eraser_size,airbrush_size=default_airbrush_size,pencil_size=default_pencil_size,stroke_size=default_stroke_size,clear()},selected_colors,set_theme,$};init_webgl_stuff();console.log("JS 실행:","session.js");const log=(...e)=>{var i;(i=window.console)==null||i.log(...e)};let localStorageAvailable=!1;try{localStorage._available=!0,localStorageAvailable=localStorage._available,delete localStorage._available}catch(e){}const match_threshold=1,canvas_has_any_apparent_image_data=()=>main_canvas.ctx.getImageData(0,0,main_canvas.width,main_canvas.height).data.some(e=>e>match_threshold);let $recovery_window;function show_recovery_window(e){$recovery_window==null||$recovery_window.close();const i=$recovery_window=$DialogWindow();i.on("close",()=>{$recovery_window=null}),i.title("Recover Document");let s=!1;try{window.localStorage.getItem("bogus test key")}catch{s=!0}i.$main.append($(`
		<p>Woah! The canvas became empty.</p>
		<p>If this was on purpose, please ignore this message.</p>
		<p>
			If the canvas was cleared due to memory usage,<br>
			click Undo to recover the document.
		</p>
		<!--<p>Remember to save with <b>File > Save</b>!</p>-->
		${s?"<p><b>Note:</b> No automatic backup is possible unless you enable Cookies in your browser.</p>":e?`<hr>
					<p style="opacity: 0.8; font-size: 0.9em;">
						Auto-save is paused while this dialog is open.
					</p>
					<p style="opacity: 0.8; font-size: 0.9em;">
						(See <b>File &gt; Manage Storage</b> to view backups.)
					</p>`:""}
	`));const t=i.$Button("Undo",()=>{undo()}),c=i.$Button("Redo",()=>{redo()}),a=()=>{t.prop("disabled",undos.length<1),c.prop("disabled",redos.length<1)};$G$1.on("session-update.session-hook",a),a(),i.$Button(localize("Close"),()=>{i.close()}),i.center(),i.find("button:enabled").focus()}let last_undos_length=undos.length;function handle_data_loss(){const e=$recovery_window&&!$recovery_window.closed;let i=!1;return canvas_has_any_apparent_image_data()?e&&(undos.length>last_undos_length&&show_recovery_window(!0),i=!0):(e||show_recovery_window(),i=!0),last_undos_length=undos.length,i}class LocalSession{constructor(i){this.id=i;const s=`image#${i}`;log(`Local storage key: ${s}`),this.save_image_to_storage_immediately=()=>{handle_data_loss()||(log(`Saving image to storage: ${s}`),localStore.set(s,main_canvas.toDataURL("image/png"),c=>{}))},this.save_image_to_storage_soon=debounce(this.save_image_to_storage_immediately,100),localStore.get(s,(t,c)=>{t?localStorageAvailable?show_error_message$1("Failed to retrieve image from local storage.",t):showMessageBox$1({message:"Please enable local storage in your browser's settings for local backup. It may be called Cookies, Storage, or Site Data."}):c?load_image_from_uri(c).then(a=>{open_from_image_info(a,null,null,!0,!0)},a=>{show_error_message$1("Failed to open image from local storage.",a)}):this.save_image_to_storage_soon()}),$G$1.on("session-update.session-hook",()=>{this.save_image_to_storage_soon()})}end(){this.save_image_to_storage_soon.cancel(),this.save_image_to_storage_immediately(),$G$1.off(".session-hook")}}let user_id;const user={cursor:{x:0,y:0,away:!0},tool:localize("Pencil"),hue:~~(Math.random()*360),saturation:~~(Math.random()*50)+50,lightness:~~(Math.random()*40)+50};user.color=`hsla(${user.hue}, ${user.saturation}%, ${user.lightness}%, 1)`;user.color_transparent=`hsla(${user.hue}, ${user.saturation}%, ${user.lightness}%, 0.5)`;user.color_desaturated=`hsla(${user.hue}, ${~~(user.saturation*.4)}%, ${user.lightness}%, 0.8)`;const cursor_image=new Image;cursor_image.src="images/cursors/default.png";class FirebaseSession{constructor(i){this.id=i,this._fb_listeners=[],file_name=`[Loading ${this.id}]`,update_title();const s=()=>{file_name=`[${this.id}]`,update_title(),this.start()};if(FirebaseSession.fb_root)s();else{var t=document.createElement("script");t.addEventListener("load",()=>{const c={apiKey:"AIzaSyBgau8Vu9ZE8u_j0rp-Lc044gYTX5O3X9k",authDomain:"jspaint.firebaseapp.com",databaseURL:"https://jspaint.firebaseio.com",projectId:"firebase-jspaint",storageBucket:"",messagingSenderId:"63395010995"};firebase.initializeApp(c),FirebaseSession.fb_root=firebase.database().ref("/"),s()}),t.addEventListener("error",()=>{show_error_message$1("Failed to load Firebase; the document will not load, and changes will not be saved."),file_name=`[Failed to load ${this.id}]`,update_title()}),t.src="lib/firebase.js",document.head.appendChild(t)}}start(){showMessageBox$1({messageHTML:`
				<p>The document may not load. Changes may not save.</p>
				<p>Multiuser sessions are public. There is no security.</p>
			`});const i=(c,a,n,o)=>{this._fb_listeners.push({fb:c,event_type:a,callback:n,error_callback:o}),c.on(a,n,o)};this.fb=FirebaseSession.fb_root.child(this.id),this.fb_data=this.fb.child("data"),this.fb_users=this.fb.child("users"),user_id?this.fb_user=this.fb_users.child(user_id):(this.fb_user=this.fb_users.push(),user_id=this.fb_user.key),this.fb_user.onDisconnect().remove(),this.fb_user.set(user),i(this.fb_users,"child_added",c=>{if(c.key===user_id)return;const a=c.ref;let n=c.val();const o=make_canvas(32,32),l=$(o).addClass("user-cursor").appendTo($app);l.css({display:"none",position:"absolute",left:0,top:0,opacity:0,zIndex:5,pointerEvents:"none",transition:"opacity 0.5s"}),i(a,"value",r=>{if(n=r.val(),n==null)l.remove();else{const d=()=>{o.width=cursor_image.width,o.height=cursor_image.height;const _=o.ctx;_.fillStyle=n.color,_.fillRect(0,0,o.width,o.height),_.globalCompositeOperation="multiply",_.drawImage(cursor_image,0,0),_.globalCompositeOperation="destination-atop",_.drawImage(cursor_image,0,0)};cursor_image.complete?d():$(cursor_image).one("load",d);const h=window.canvas_bounding_client_rect;l.css({display:"block",position:"absolute",left:h.left+magnification*n.cursor.x,top:h.top+magnification*n.cursor.y,opacity:1-n.cursor.away})}})});let s;this.write_canvas_to_database_immediately=()=>{if(handle_data_loss())return;const a=main_canvas.toDataURL();s!==a?(log("Write canvas data to Firebase"),this.fb_data.set(a),s=a):log("(Don't write canvas data to Firebase; it hasn't changed)")},this.write_canvas_to_database_soon=debounce(this.write_canvas_to_database_immediately,100);let t=!1;$G$1.on("session-update.session-hook",()=>{if(t){log("(Ignore session-update from Sync Session undoable)");return}this.write_canvas_to_database_soon()}),i(this.fb_data,"value",c=>{log("Firebase data update");const a=c.val();if(a==null)this.write_canvas_to_database_soon();else{s=a;const n=new Image;n.onload=()=>{const o=make_canvas(n),l=o.ctx.getImageData(0,0,o.width,o.height),r=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height);image_data_match(l,r,5)||(t=!0,undoable({name:"Sync Session",icon:get_help_folder_icon("p_database.png")},()=>{main_ctx.copy(n),$canvas_area.trigger("resize")}),t=!1)},n.src=a}},c=>{show_error_message$1("Failed to retrieve data from Firebase. The document will not load, and changes will not be saved.",c),file_name=`[Failed to load ${this.id}]`,update_title()}),$G$1.on("pointermove.session-hook",c=>{const a=to_canvas_coords(c);this.fb_user.child("cursor").update({x:a.x,y:a.y,away:!1})}),$G$1.on("blur.session-hook",()=>{this.fb_user.child("cursor").update({away:!0})})}end(){this.write_canvas_to_database_soon.cancel(),this.write_canvas_to_database_immediately(),$G$1.off(".session-hook"),this._fb_listeners.forEach(({fb:i,event_type:s,callback:t,_error_callback:c})=>{log(`Remove listener for ${i.path.toString()} .on ${s}`),i.off(s,t)}),this._fb_listeners.length=0,this.fb_user.remove(),$app.find(".user-cursor").remove(),reset_file()}}FirebaseSession.fb_root=null;class RESTSession{constructor(i){this.id=i,file_name=`[Loading ${this.id}]`,update_title(),this.start(),this._previous_uri="",this._ignore_session_update=!1,this._poll_tid=-1,this._poll_fetch_start_time=-1,this._last_write_time=-1}async _write_canvas_to_server_immediately(){if(handle_data_loss())return;const s=main_canvas.toDataURL();this._previous_uri!==s?(log("Write canvas data to server"),this._previous_uri=s,this._last_write_time=performance.now(),await fetch(`/api/rooms/${this.id}/data`,{method:"PUT",body:s}),this._last_write_time=performance.now()):log("(Don't write canvas data to server; it hasn't changed)")}start(){this._write_canvas_to_server_soon=debounce(this._write_canvas_to_server_immediately,100),$G$1.on("session-update.session-hook",()=>{if(this._ignore_session_update){log("(Ignore session-update from Sync Session undoable)");return}this._write_canvas_to_server_soon(),this._last_write_time=performance.now()});const i=async()=>{let s;try{this._poll_fetch_start_time=performance.now();const t=await fetch(`/api/rooms/${this.id}/data`);t.status===404?s=null:s=await t.text()}catch(t){show_error_message$1("Failed to load image document from the server.",t),file_name=`[Failed to load ${this.id}]`,update_title();return}file_name=`[${this.id}]`,update_title(),this.handle_data_snapshot(s,this._poll_fetch_start_time),this._poll_tid=setTimeout(i,1e3)};i()}handle_data_snapshot(i,s){if(!i)this._write_canvas_to_server_soon(),this._last_write_time=performance.now();else{this._previous_uri=i;const t=new Image;t.onload=()=>{if(this._last_write_time>s){log("(Ignore stale image data)");return}const c=make_canvas(t),a=c.ctx.getImageData(0,0,c.width,c.height),n=main_ctx.getImageData(0,0,main_canvas.width,main_canvas.height);image_data_match(a,n,5)||(this._ignore_session_update=!0,undoable({name:"Sync Session",icon:get_help_folder_icon("p_database.png")},()=>{main_ctx.copy(t),$canvas_area.trigger("resize")}),this._ignore_session_update=!1)},t.onerror=()=>{show_error_message$1("Failed to load image document from the server. Invalid image data.",i)},t.src=i}}end(){clearTimeout(this._poll_tid),this._write_canvas_to_server_soon.cancel(),this._write_canvas_to_server_immediately(),$G$1.off(".session-hook"),$app.find(".user-cursor").remove(),reset_file()}}let current_session;const end_current_session=()=>{current_session&&(log("Ending current session"),current_session.end(),current_session=null)},generate_session_id=()=>(Math.random()*2**32).toString(16).replace(".",""),update_session_from_location_hash=()=>{const e=location.hash.match(/^#?(?:.*,)?(session|local):(.*)$/i),i=location.hash.match(/^#?(?:.*,)?(load):(.*)$/i);if(e){const s=e[1].toLowerCase()==="local",t=e[2];if(t==="")log("Invalid session ID; session ID cannot be empty"),end_current_session();else if(!s&&t.match(/[./[\]#$]/))log("Session ID is not a valid Firebase location; it cannot contain any of ./[]#$"),end_current_session();else if(!t.match(/[-0-9A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02af\u1d00-\u1d25\u1d62-\u1d65\u1d6b-\u1d77\u1d79-\u1d9a\u1e00-\u1eff\u2090-\u2094\u2184-\u2184\u2488-\u2490\u271d-\u271d\u2c60-\u2c7c\u2c7e-\u2c7f\ua722-\ua76f\ua771-\ua787\ua78b-\ua78c\ua7fb-\ua7ff\ufb00-\ufb06]+/))log("Invalid session ID; it must consist of 'alphanumeric-esque' characters"),end_current_session();else if(current_session&&current_session.id===t&&s===current_session instanceof LocalSession)log("Hash changed but the session ID and session type are the same");else{end_current_session();let c="FirebaseSession";try{c=localStorage.online_session_implementation||c}catch{}s?(log(`Starting a new LocalSession, ID: ${t}`),current_session=new LocalSession(t)):c==="RESTSession"?(log(`Starting a new RESTSession, ID: ${t}`),current_session=new RESTSession(t)):c==="FirebaseSession"?(log(`Starting a new FirebaseSession, ID: ${t}`),current_session=new FirebaseSession(t)):(show_error_message$1(`Invalid online session implementation '${c}'`),current_session=new LocalSession(t))}}else if(i){const s=decodeURIComponent(i[2]);if(get_uris(s).length===0){show_error_message$1("Invalid URL to load (after #load: in the address bar). It must include a protocol (https:// or http://)");return}log("Switching to new session from #load: URL (to #local: URL with session ID)"),end_current_session(),change_url_param("local",generate_session_id()),load_image_from_uri(s).then(c=>{open_from_image_info(c,null,null,!0,!0)},show_resource_load_error_message)}else{log("No session ID in hash");const s=location.hash;end_current_session(),change_url_param("local",generate_session_id(),{replace_history_state:!0}),log("After replaceState:",location.hash),s===location.hash?show_error_message$1("Autosave is disabled. Failed to update URL to start session."):update_session_from_location_hash()}};$G$1.on("hashchange popstate change-url-params",e=>{log(e.type,location.hash),update_session_from_location_hash()});const new_local_session$1=()=>{end_current_session(),log("Changing URL to start new session..."),change_url_param("local",generate_session_id())};log("Initializing with location hash:",location.hash);update_session_from_location_hash();window.new_local_session=new_local_session$1});export default er();
